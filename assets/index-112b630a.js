(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Hh(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const ut={},Xi=[],Xn=()=>{},Gb=()=>!1,yu=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Wh=n=>n.startsWith("onUpdate:"),sn=Object.assign,Qh=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},Kb=Object.prototype.hasOwnProperty,et=(n,e)=>Kb.call(n,e),Re=Array.isArray,Zi=n=>vu(n)==="[object Map]",G_=n=>vu(n)==="[object Set]",Ce=n=>typeof n=="function",Kt=n=>typeof n=="string",Vs=n=>typeof n=="symbol",At=n=>n!==null&&typeof n=="object",K_=n=>(At(n)||Ce(n))&&Ce(n.then)&&Ce(n.catch),H_=Object.prototype.toString,vu=n=>H_.call(n),Hb=n=>vu(n).slice(8,-1),W_=n=>vu(n)==="[object Object]",Jh=n=>Kt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Pa=Hh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),wu=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},Wb=/-(\w)/g,Gn=wu(n=>n.replace(Wb,(e,t)=>t?t.toUpperCase():"")),Qb=/\B([A-Z])/g,Ns=wu(n=>n.replace(Qb,"-$1").toLowerCase()),bu=wu(n=>n.charAt(0).toUpperCase()+n.slice(1)),Ed=wu(n=>n?`on${bu(n)}`:""),ys=(n,e)=>!Object.is(n,e),Ec=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},nh=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},rh=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let om;const Iu=()=>om||(om=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Yh(n){if(Re(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=Kt(r)?Zb(r):Yh(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(Kt(n)||At(n))return n}const Jb=/;(?![^(]*\))/g,Yb=/:([^]+)/,Xb=/\/\*[^]*?\*\//g;function Zb(n){const e={};return n.replace(Xb,"").split(Jb).forEach(t=>{if(t){const r=t.split(Yb);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Zn(n){let e="";if(Kt(n))e=n;else if(Re(n))for(let t=0;t<n.length;t++){const r=Zn(n[t]);r&&(e+=r+" ")}else if(At(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const eI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tI=Hh(eI);function Q_(n){return!!n||n===""}const J_=n=>!!(n&&n.__v_isRef===!0),pe=n=>Kt(n)?n:n==null?"":Re(n)||At(n)&&(n.toString===H_||!Ce(n.toString))?J_(n)?pe(n.value):JSON.stringify(n,Y_,2):String(n),Y_=(n,e)=>J_(e)?Y_(n,e.value):Zi(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[Td(r,i)+" =>"]=s,t),{})}:G_(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Td(t))}:Vs(e)?Td(e):At(e)&&!Re(e)&&!W_(e)?String(e):e,Td=(n,e="")=>{var t;return Vs(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rn;class nI{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Rn,!e&&Rn&&(this.index=(Rn.scopes||(Rn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Rn;try{return Rn=this,e()}finally{Rn=t}}}on(){++this._on===1&&(this.prevScope=Rn,Rn=this)}off(){this._on>0&&--this._on===0&&(Rn=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function rI(){return Rn}let ft;const Ad=new WeakSet;class X_{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Rn&&Rn.active&&Rn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ad.has(this)&&(Ad.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ey(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,am(this),ty(this);const e=ft,t=er;ft=this,er=!0;try{return this.fn()}finally{ny(this),ft=e,er=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)ef(e);this.deps=this.depsTail=void 0,am(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ad.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){sh(this)&&this.run()}get dirty(){return sh(this)}}let Z_=0,Sa,Ra;function ey(n,e=!1){if(n.flags|=8,e){n.next=Ra,Ra=n;return}n.next=Sa,Sa=n}function Xh(){Z_++}function Zh(){if(--Z_>0)return;if(Ra){let e=Ra;for(Ra=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Sa;){let e=Sa;for(Sa=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function ty(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function ny(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),ef(r),sI(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function sh(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ry(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function ry(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===qa)||(n.globalVersion=qa,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!sh(n))))return;n.flags|=2;const e=n.dep,t=ft,r=er;ft=n,er=!0;try{ty(n);const s=n.fn(n._value);(e.version===0||ys(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{ft=t,er=r,ny(n),n.flags&=-3}}function ef(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)ef(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function sI(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let er=!0;const sy=[];function Nr(){sy.push(er),er=!1}function Or(){const n=sy.pop();er=n===void 0?!0:n}function am(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=ft;ft=void 0;try{e()}finally{ft=t}}}let qa=0;class iI{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class tf{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ft||!er||ft===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==ft)t=this.activeLink=new iI(ft,this),ft.deps?(t.prevDep=ft.depsTail,ft.depsTail.nextDep=t,ft.depsTail=t):ft.deps=ft.depsTail=t,iy(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=ft.depsTail,t.nextDep=void 0,ft.depsTail.nextDep=t,ft.depsTail=t,ft.deps===t&&(ft.deps=r)}return t}trigger(e){this.version++,qa++,this.notify(e)}notify(e){Xh();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Zh()}}}function iy(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)iy(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const ih=new WeakMap,ai=Symbol(""),oh=Symbol(""),za=Symbol("");function _n(n,e,t){if(er&&ft){let r=ih.get(n);r||ih.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new tf),s.map=r,s.key=t),s.track()}}function Pr(n,e,t,r,s,i){const o=ih.get(n);if(!o){qa++;return}const a=c=>{c&&c.trigger()};if(Xh(),e==="clear")o.forEach(a);else{const c=Re(n),u=c&&Jh(t);if(c&&t==="length"){const d=Number(r);o.forEach((f,g)=>{(g==="length"||g===za||!Vs(g)&&g>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(za)),e){case"add":c?u&&a(o.get("length")):(a(o.get(ai)),Zi(n)&&a(o.get(oh)));break;case"delete":c||(a(o.get(ai)),Zi(n)&&a(o.get(oh)));break;case"set":Zi(n)&&a(o.get(ai));break}}Zh()}function Bi(n){const e=Ze(n);return e===n?e:(_n(e,"iterate",za),zn(n)?e:e.map(cn))}function Eu(n){return _n(n=Ze(n),"iterate",za),n}const oI={__proto__:null,[Symbol.iterator](){return xd(this,Symbol.iterator,cn)},concat(...n){return Bi(this).concat(...n.map(e=>Re(e)?Bi(e):e))},entries(){return xd(this,"entries",n=>(n[1]=cn(n[1]),n))},every(n,e){return Er(this,"every",n,e,void 0,arguments)},filter(n,e){return Er(this,"filter",n,e,t=>t.map(cn),arguments)},find(n,e){return Er(this,"find",n,e,cn,arguments)},findIndex(n,e){return Er(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Er(this,"findLast",n,e,cn,arguments)},findLastIndex(n,e){return Er(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Er(this,"forEach",n,e,void 0,arguments)},includes(...n){return Pd(this,"includes",n)},indexOf(...n){return Pd(this,"indexOf",n)},join(n){return Bi(this).join(n)},lastIndexOf(...n){return Pd(this,"lastIndexOf",n)},map(n,e){return Er(this,"map",n,e,void 0,arguments)},pop(){return la(this,"pop")},push(...n){return la(this,"push",n)},reduce(n,...e){return lm(this,"reduce",n,e)},reduceRight(n,...e){return lm(this,"reduceRight",n,e)},shift(){return la(this,"shift")},some(n,e){return Er(this,"some",n,e,void 0,arguments)},splice(...n){return la(this,"splice",n)},toReversed(){return Bi(this).toReversed()},toSorted(n){return Bi(this).toSorted(n)},toSpliced(...n){return Bi(this).toSpliced(...n)},unshift(...n){return la(this,"unshift",n)},values(){return xd(this,"values",cn)}};function xd(n,e,t){const r=Eu(n),s=r[e]();return r!==n&&!zn(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const aI=Array.prototype;function Er(n,e,t,r,s,i){const o=Eu(n),a=o!==n&&!zn(n),c=o[e];if(c!==aI[e]){const f=c.apply(n,i);return a?cn(f):f}let u=t;o!==n&&(a?u=function(f,g){return t.call(this,cn(f),g,n)}:t.length>2&&(u=function(f,g){return t.call(this,f,g,n)}));const d=c.call(o,u,r);return a&&s?s(d):d}function lm(n,e,t,r){const s=Eu(n);let i=t;return s!==n&&(zn(n)?t.length>3&&(i=function(o,a,c){return t.call(this,o,a,c,n)}):i=function(o,a,c){return t.call(this,o,cn(a),c,n)}),s[e](i,...r)}function Pd(n,e,t){const r=Ze(n);_n(r,"iterate",za);const s=r[e](...t);return(s===-1||s===!1)&&sf(t[0])?(t[0]=Ze(t[0]),r[e](...t)):s}function la(n,e,t=[]){Nr(),Xh();const r=Ze(n)[e].apply(n,t);return Zh(),Or(),r}const lI=Hh("__proto__,__v_isRef,__isVue"),oy=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Vs));function cI(n){Vs(n)||(n=String(n));const e=Ze(this);return _n(e,"has",n),e.hasOwnProperty(n)}class ay{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?vI:dy:i?uy:cy).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Re(e);if(!s){let c;if(o&&(c=oI[t]))return c;if(t==="hasOwnProperty")return cI}const a=Reflect.get(e,t,vn(e)?e:r);return(Vs(t)?oy.has(t):lI(t))||(s||_n(e,"get",t),i)?a:vn(a)?o&&Jh(t)?a:a.value:At(a)?s?fy(a):Tu(a):a}}class ly extends ay{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const c=Is(i);if(!zn(r)&&!Is(r)&&(i=Ze(i),r=Ze(r)),!Re(e)&&vn(i)&&!vn(r))return c?!1:(i.value=r,!0)}const o=Re(e)&&Jh(t)?Number(t)<e.length:et(e,t),a=Reflect.set(e,t,r,vn(e)?e:s);return e===Ze(s)&&(o?ys(r,i)&&Pr(e,"set",t,r):Pr(e,"add",t,r)),a}deleteProperty(e,t){const r=et(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&Pr(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!Vs(t)||!oy.has(t))&&_n(e,"has",t),r}ownKeys(e){return _n(e,"iterate",Re(e)?"length":ai),Reflect.ownKeys(e)}}class uI extends ay{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const dI=new ly,hI=new uI,fI=new ly(!0);const ah=n=>n,dc=n=>Reflect.getPrototypeOf(n);function pI(n,e,t){return function(...r){const s=this.__v_raw,i=Ze(s),o=Zi(i),a=n==="entries"||n===Symbol.iterator&&o,c=n==="keys"&&o,u=s[n](...r),d=t?ah:e?jc:cn;return!e&&_n(i,"iterate",c?oh:ai),{next(){const{value:f,done:g}=u.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function hc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function mI(n,e){const t={get(s){const i=this.__v_raw,o=Ze(i),a=Ze(s);n||(ys(s,a)&&_n(o,"get",s),_n(o,"get",a));const{has:c}=dc(o),u=e?ah:n?jc:cn;if(c.call(o,s))return u(i.get(s));if(c.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&_n(Ze(s),"iterate",ai),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=Ze(i),a=Ze(s);return n||(ys(s,a)&&_n(o,"has",s),_n(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,c=Ze(a),u=e?ah:n?jc:cn;return!n&&_n(c,"iterate",ai),a.forEach((d,f)=>s.call(i,u(d),u(f),o))}};return sn(t,n?{add:hc("add"),set:hc("set"),delete:hc("delete"),clear:hc("clear")}:{add(s){!e&&!zn(s)&&!Is(s)&&(s=Ze(s));const i=Ze(this);return dc(i).has.call(i,s)||(i.add(s),Pr(i,"add",s,s)),this},set(s,i){!e&&!zn(i)&&!Is(i)&&(i=Ze(i));const o=Ze(this),{has:a,get:c}=dc(o);let u=a.call(o,s);u||(s=Ze(s),u=a.call(o,s));const d=c.call(o,s);return o.set(s,i),u?ys(i,d)&&Pr(o,"set",s,i):Pr(o,"add",s,i),this},delete(s){const i=Ze(this),{has:o,get:a}=dc(i);let c=o.call(i,s);c||(s=Ze(s),c=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return c&&Pr(i,"delete",s,void 0),u},clear(){const s=Ze(this),i=s.size!==0,o=s.clear();return i&&Pr(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=pI(s,n,e)}),t}function nf(n,e){const t=mI(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(et(t,s)&&s in r?t:r,s,i)}const gI={get:nf(!1,!1)},_I={get:nf(!1,!0)},yI={get:nf(!0,!1)};const cy=new WeakMap,uy=new WeakMap,dy=new WeakMap,vI=new WeakMap;function wI(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function bI(n){return n.__v_skip||!Object.isExtensible(n)?0:wI(Hb(n))}function Tu(n){return Is(n)?n:rf(n,!1,dI,gI,cy)}function hy(n){return rf(n,!1,fI,_I,uy)}function fy(n){return rf(n,!0,hI,yI,dy)}function rf(n,e,t,r,s){if(!At(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=bI(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function eo(n){return Is(n)?eo(n.__v_raw):!!(n&&n.__v_isReactive)}function Is(n){return!!(n&&n.__v_isReadonly)}function zn(n){return!!(n&&n.__v_isShallow)}function sf(n){return n?!!n.__v_raw:!1}function Ze(n){const e=n&&n.__v_raw;return e?Ze(e):n}function II(n){return!et(n,"__v_skip")&&Object.isExtensible(n)&&nh(n,"__v_skip",!0),n}const cn=n=>At(n)?Tu(n):n,jc=n=>At(n)?fy(n):n;function vn(n){return n?n.__v_isRef===!0:!1}function G(n){return py(n,!1)}function EI(n){return py(n,!0)}function py(n,e){return vn(n)?n:new TI(n,e)}class TI{constructor(e,t){this.dep=new tf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Ze(e),this._value=t?e:cn(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||zn(e)||Is(e);e=r?e:Ze(e),ys(e,t)&&(this._rawValue=e,this._value=r?e:cn(e),this.dep.trigger())}}function to(n){return vn(n)?n.value:n}const AI={get:(n,e,t)=>e==="__v_raw"?n:to(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return vn(s)&&!vn(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function my(n){return eo(n)?n:new Proxy(n,AI)}class xI{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new tf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=qa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&ft!==this)return ey(this,!0),!0}get value(){const e=this.dep.track();return ry(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function PI(n,e,t=!1){let r,s;return Ce(n)?r=n:(r=n.get,s=n.set),new xI(r,s,t)}const fc={},qc=new WeakMap;let Ys;function SI(n,e=!1,t=Ys){if(t){let r=qc.get(t);r||qc.set(t,r=[]),r.push(n)}}function RI(n,e,t=ut){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:c}=t,u=O=>s?O:zn(O)||s===!1||s===0?Sr(O,1):Sr(O);let d,f,g,_,D=!1,T=!1;if(vn(n)?(f=()=>n.value,D=zn(n)):eo(n)?(f=()=>u(n),D=!0):Re(n)?(T=!0,D=n.some(O=>eo(O)||zn(O)),f=()=>n.map(O=>{if(vn(O))return O.value;if(eo(O))return u(O);if(Ce(O))return c?c(O,2):O()})):Ce(n)?e?f=c?()=>c(n,2):n:f=()=>{if(g){Nr();try{g()}finally{Or()}}const O=Ys;Ys=d;try{return c?c(n,3,[_]):n(_)}finally{Ys=O}}:f=Xn,e&&s){const O=f,q=s===!0?1/0:s;f=()=>Sr(O(),q)}const C=rI(),U=()=>{d.stop(),C&&C.active&&Qh(C.effects,d)};if(i&&e){const O=e;e=(...q)=>{O(...q),U()}}let B=T?new Array(n.length).fill(fc):fc;const L=O=>{if(!(!(d.flags&1)||!d.dirty&&!O))if(e){const q=d.run();if(s||D||(T?q.some((ie,x)=>ys(ie,B[x])):ys(q,B))){g&&g();const ie=Ys;Ys=d;try{const x=[q,B===fc?void 0:T&&B[0]===fc?[]:B,_];B=q,c?c(e,3,x):e(...x)}finally{Ys=ie}}}else d.run()};return a&&a(L),d=new X_(f),d.scheduler=o?()=>o(L,!1):L,_=O=>SI(O,!1,d),g=d.onStop=()=>{const O=qc.get(d);if(O){if(c)c(O,4);else for(const q of O)q();qc.delete(d)}},e?r?L(!0):B=d.run():o?o(L.bind(null,!0),!0):d.run(),U.pause=d.pause.bind(d),U.resume=d.resume.bind(d),U.stop=U,U}function Sr(n,e=1/0,t){if(e<=0||!At(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,vn(n))Sr(n.value,e,t);else if(Re(n))for(let r=0;r<n.length;r++)Sr(n[r],e,t);else if(G_(n)||Zi(n))n.forEach(r=>{Sr(r,e,t)});else if(W_(n)){for(const r in n)Sr(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&Sr(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function gl(n,e,t,r){try{return r?n(...r):n()}catch(s){Au(s,e,t)}}function gr(n,e,t,r){if(Ce(n)){const s=gl(n,e,t,r);return s&&K_(s)&&s.catch(i=>{Au(i,e,t)}),s}if(Re(n)){const s=[];for(let i=0;i<n.length;i++)s.push(gr(n[i],e,t,r));return s}}function Au(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||ut;if(e){let a=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,c,u)===!1)return}a=a.parent}if(i){Nr(),gl(i,null,10,[n,c,u]),Or();return}}CI(n,t,s,r,o)}function CI(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const xn=[];let lr=-1;const no=[];let os=null,Gi=0;const gy=Promise.resolve();let zc=null;function Es(n){const e=zc||gy;return n?e.then(this?n.bind(this):n):e}function kI(n){let e=lr+1,t=xn.length;for(;e<t;){const r=e+t>>>1,s=xn[r],i=Ga(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function of(n){if(!(n.flags&1)){const e=Ga(n),t=xn[xn.length-1];!t||!(n.flags&2)&&e>=Ga(t)?xn.push(n):xn.splice(kI(e),0,n),n.flags|=1,_y()}}function _y(){zc||(zc=gy.then(vy))}function DI(n){Re(n)?no.push(...n):os&&n.id===-1?os.splice(Gi+1,0,n):n.flags&1||(no.push(n),n.flags|=1),_y()}function cm(n,e,t=lr+1){for(;t<xn.length;t++){const r=xn[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;xn.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function yy(n){if(no.length){const e=[...new Set(no)].sort((t,r)=>Ga(t)-Ga(r));if(no.length=0,os){os.push(...e);return}for(os=e,Gi=0;Gi<os.length;Gi++){const t=os[Gi];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}os=null,Gi=0}}const Ga=n=>n.id==null?n.flags&2?-1:1/0:n.id;function vy(n){const e=Xn;try{for(lr=0;lr<xn.length;lr++){const t=xn[lr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),gl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;lr<xn.length;lr++){const t=xn[lr];t&&(t.flags&=-2)}lr=-1,xn.length=0,yy(),zc=null,(xn.length||no.length)&&vy()}}let Fn=null,wy=null;function Gc(n){const e=Fn;return Fn=n,wy=n&&n.type.__scopeId||null,e}function VI(n,e=Fn,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&ym(-1);const i=Gc(e);let o;try{o=n(...s)}finally{Gc(i),r._d&&ym(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function gt(n,e){if(Fn===null)return n;const t=Ru(Fn),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,c=ut]=e[s];i&&(Ce(i)&&(i={mounted:i,updated:i}),i.deep&&Sr(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:c}))}return n}function Ws(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Nr(),gr(c,t,8,[n.el,a,n,e]),Or())}}const NI=Symbol("_vte"),OI=n=>n.__isTeleport;function af(n,e){n.shapeFlag&6&&n.component?(n.transition=e,af(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function by(n,e){return Ce(n)?(()=>sn({name:n.name},e,{setup:n}))():n}function Iy(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Ca(n,e,t,r,s=!1){if(Re(n)){n.forEach((D,T)=>Ca(D,e&&(Re(e)?e[T]:e),t,r,s));return}if(ka(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Ca(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?Ru(r.component):r.el,o=s?null:i,{i:a,r:c}=n,u=e&&e.r,d=a.refs===ut?a.refs={}:a.refs,f=a.setupState,g=Ze(f),_=f===ut?()=>!1:D=>et(g,D);if(u!=null&&u!==c&&(Kt(u)?(d[u]=null,_(u)&&(f[u]=null)):vn(u)&&(u.value=null)),Ce(c))gl(c,a,12,[o,d]);else{const D=Kt(c),T=vn(c);if(D||T){const C=()=>{if(n.f){const U=D?_(c)?f[c]:d[c]:c.value;s?Re(U)&&Qh(U,i):Re(U)?U.includes(i)||U.push(i):D?(d[c]=[i],_(c)&&(f[c]=d[c])):(c.value=[i],n.k&&(d[n.k]=c.value))}else D?(d[c]=o,_(c)&&(f[c]=o)):T&&(c.value=o,n.k&&(d[n.k]=o))};o?(C.id=-1,Ln(C,t)):C()}}}Iu().requestIdleCallback;Iu().cancelIdleCallback;const ka=n=>!!n.type.__asyncLoader,Ey=n=>n.type.__isKeepAlive;function MI(n,e){Ty(n,"a",e)}function LI(n,e){Ty(n,"da",e)}function Ty(n,e,t=yn){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(xu(e,r,t),t){let s=t.parent;for(;s&&s.parent;)Ey(s.parent.vnode)&&FI(r,e,t,s),s=s.parent}}function FI(n,e,t,r){const s=xu(e,n,r,!0);lf(()=>{Qh(r[e],s)},t)}function xu(n,e,t=yn,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Nr();const a=yl(t),c=gr(e,t,n,o);return a(),Or(),c});return r?s.unshift(i):s.push(i),i}}const jr=n=>(e,t=yn)=>{(!Ha||n==="sp")&&xu(n,(...r)=>e(...r),t)},UI=jr("bm"),_l=jr("m"),BI=jr("bu"),$I=jr("u"),jI=jr("bum"),lf=jr("um"),qI=jr("sp"),zI=jr("rtg"),GI=jr("rtc");function KI(n,e=yn){xu("ec",n,e)}const Ay="components";function HI(n,e){return QI(Ay,n,!0,e)||n}const WI=Symbol.for("v-ndc");function QI(n,e,t=!0,r=!1){const s=Fn||yn;if(s){const i=s.type;if(n===Ay){const a=OE(i,!1);if(a&&(a===e||a===Gn(e)||a===bu(Gn(e))))return i}const o=um(s[n]||i[n],e)||um(s.appContext[n],e);return!o&&r?i:o}}function um(n,e){return n&&(n[e]||n[Gn(e)]||n[bu(Gn(e))])}function gs(n,e,t,r){let s;const i=t&&t[r],o=Re(n);if(o||Kt(n)){const a=o&&eo(n);let c=!1,u=!1;a&&(c=!zn(n),u=Is(n),n=Eu(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(c?u?jc(cn(n[d])):cn(n[d]):n[d],d,void 0,i&&i[d])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(At(n))if(n[Symbol.iterator])s=Array.from(n,(a,c)=>e(a,c,void 0,i&&i[c]));else{const a=Object.keys(n);s=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const d=a[c];s[c]=e(n[d],d,c,i&&i[c])}}else s=[];return t&&(t[r]=s),s}const lh=n=>n?Gy(n)?Ru(n):lh(n.parent):null,Da=sn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>lh(n.parent),$root:n=>lh(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>cf(n),$forceUpdate:n=>n.f||(n.f=()=>{of(n.update)}),$nextTick:n=>n.n||(n.n=Es.bind(n.proxy)),$watch:n=>gE.bind(n)}),Sd=(n,e)=>n!==ut&&!n.__isScriptSetup&&et(n,e),JI={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=n;let u;if(e[0]!=="$"){const _=o[e];if(_!==void 0)switch(_){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Sd(r,e))return o[e]=1,r[e];if(s!==ut&&et(s,e))return o[e]=2,s[e];if((u=n.propsOptions[0])&&et(u,e))return o[e]=3,i[e];if(t!==ut&&et(t,e))return o[e]=4,t[e];ch&&(o[e]=0)}}const d=Da[e];let f,g;if(d)return e==="$attrs"&&_n(n.attrs,"get",""),d(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==ut&&et(t,e))return o[e]=4,t[e];if(g=c.config.globalProperties,et(g,e))return g[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Sd(s,e)?(s[e]=t,!0):r!==ut&&et(r,e)?(r[e]=t,!0):et(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==ut&&et(n,o)||Sd(e,o)||(a=i[0])&&et(a,o)||et(r,o)||et(Da,o)||et(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:et(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function dm(n){return Re(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let ch=!0;function YI(n){const e=cf(n),t=n.proxy,r=n.ctx;ch=!1,e.beforeCreate&&hm(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:u,created:d,beforeMount:f,mounted:g,beforeUpdate:_,updated:D,activated:T,deactivated:C,beforeDestroy:U,beforeUnmount:B,destroyed:L,unmounted:O,render:q,renderTracked:ie,renderTriggered:x,errorCaptured:E,serverPrefetch:A,expose:R,inheritAttrs:w,components:S,directives:I,filters:Ne}=e;if(u&&XI(u,r,null),o)for(const $e in o){const Oe=o[$e];Ce(Oe)&&(r[$e]=Oe.bind(t))}if(s){const $e=s.call(t,t);At($e)&&(n.data=Tu($e))}if(ch=!0,i)for(const $e in i){const Oe=i[$e],Ht=Ce(Oe)?Oe.bind(t,t):Ce(Oe.get)?Oe.get.bind(t,t):Xn,hn=!Ce(Oe)&&Ce(Oe.set)?Oe.set.bind(t):Xn,on=tn({get:Ht,set:hn});Object.defineProperty(r,$e,{enumerable:!0,configurable:!0,get:()=>on.value,set:ot=>on.value=ot})}if(a)for(const $e in a)xy(a[$e],r,t,$e);if(c){const $e=Ce(c)?c.call(t):c;Reflect.ownKeys($e).forEach(Oe=>{Tc(Oe,$e[Oe])})}d&&hm(d,n,"c");function Ue($e,Oe){Re(Oe)?Oe.forEach(Ht=>$e(Ht.bind(t))):Oe&&$e(Oe.bind(t))}if(Ue(UI,f),Ue(_l,g),Ue(BI,_),Ue($I,D),Ue(MI,T),Ue(LI,C),Ue(KI,E),Ue(GI,ie),Ue(zI,x),Ue(jI,B),Ue(lf,O),Ue(qI,A),Re(R))if(R.length){const $e=n.exposed||(n.exposed={});R.forEach(Oe=>{Object.defineProperty($e,Oe,{get:()=>t[Oe],set:Ht=>t[Oe]=Ht})})}else n.exposed||(n.exposed={});q&&n.render===Xn&&(n.render=q),w!=null&&(n.inheritAttrs=w),S&&(n.components=S),I&&(n.directives=I),A&&Iy(n)}function XI(n,e,t=Xn){Re(n)&&(n=uh(n));for(const r in n){const s=n[r];let i;At(s)?"default"in s?i=tr(s.from||r,s.default,!0):i=tr(s.from||r):i=tr(s),vn(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function hm(n,e,t){gr(Re(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function xy(n,e,t,r){let s=r.includes(".")?Uy(t,r):()=>t[r];if(Kt(n)){const i=e[n];Ce(i)&&nr(s,i)}else if(Ce(n))nr(s,n.bind(t));else if(At(n))if(Re(n))n.forEach(i=>xy(i,e,t,r));else{const i=Ce(n.handler)?n.handler.bind(t):e[n.handler];Ce(i)&&nr(s,i,n)}}function cf(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!t&&!r?c=e:(c={},s.length&&s.forEach(u=>Kc(c,u,o,!0)),Kc(c,e,o)),At(e)&&i.set(e,c),c}function Kc(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Kc(n,i,t,!0),s&&s.forEach(o=>Kc(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=ZI[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const ZI={data:fm,props:pm,emits:pm,methods:va,computed:va,beforeCreate:Tn,created:Tn,beforeMount:Tn,mounted:Tn,beforeUpdate:Tn,updated:Tn,beforeDestroy:Tn,beforeUnmount:Tn,destroyed:Tn,unmounted:Tn,activated:Tn,deactivated:Tn,errorCaptured:Tn,serverPrefetch:Tn,components:va,directives:va,watch:tE,provide:fm,inject:eE};function fm(n,e){return e?n?function(){return sn(Ce(n)?n.call(this,this):n,Ce(e)?e.call(this,this):e)}:e:n}function eE(n,e){return va(uh(n),uh(e))}function uh(n){if(Re(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Tn(n,e){return n?[...new Set([].concat(n,e))]:e}function va(n,e){return n?sn(Object.create(null),n,e):e}function pm(n,e){return n?Re(n)&&Re(e)?[...new Set([...n,...e])]:sn(Object.create(null),dm(n),dm(e??{})):e}function tE(n,e){if(!n)return e;if(!e)return n;const t=sn(Object.create(null),n);for(const r in e)t[r]=Tn(n[r],e[r]);return t}function Py(){return{app:null,config:{isNativeTag:Gb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nE=0;function rE(n,e){return function(r,s=null){Ce(r)||(r=sn({},r)),s!=null&&!At(s)&&(s=null);const i=Py(),o=new WeakSet,a=[];let c=!1;const u=i.app={_uid:nE++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:LE,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&Ce(d.install)?(o.add(d),d.install(u,...f)):Ce(d)&&(o.add(d),d(u,...f))),u},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),u},component(d,f){return f?(i.components[d]=f,u):i.components[d]},directive(d,f){return f?(i.directives[d]=f,u):i.directives[d]},mount(d,f,g){if(!c){const _=u._ceVNode||Gt(r,s);return _.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),f&&e?e(_,d):n(_,d,g),c=!0,u._container=d,d.__vue_app__=u,Ru(_.component)}},onUnmount(d){a.push(d)},unmount(){c&&(gr(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(d,f){return i.provides[d]=f,u},runWithContext(d){const f=ro;ro=u;try{return d()}finally{ro=f}}};return u}}let ro=null;function Tc(n,e){if(yn){let t=yn.provides;const r=yn.parent&&yn.parent.provides;r===t&&(t=yn.provides=Object.create(r)),t[n]=e}}function tr(n,e,t=!1){const r=yn||Fn;if(r||ro){let s=ro?ro._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&Ce(e)?e.call(r&&r.proxy):e}}const Sy={},Ry=()=>Object.create(Sy),Cy=n=>Object.getPrototypeOf(n)===Sy;function sE(n,e,t,r=!1){const s={},i=Ry();n.propsDefaults=Object.create(null),ky(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:hy(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function iE(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=Ze(s),[c]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(Pu(n.emitsOptions,g))continue;const _=e[g];if(c)if(et(i,g))_!==i[g]&&(i[g]=_,u=!0);else{const D=Gn(g);s[D]=dh(c,a,D,_,n,!1)}else _!==i[g]&&(i[g]=_,u=!0)}}}else{ky(n,e,s,i)&&(u=!0);let d;for(const f in a)(!e||!et(e,f)&&((d=Ns(f))===f||!et(e,d)))&&(c?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=dh(c,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!et(e,f))&&(delete i[f],u=!0)}u&&Pr(n.attrs,"set","")}function ky(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let c in e){if(Pa(c))continue;const u=e[c];let d;s&&et(s,d=Gn(c))?!i||!i.includes(d)?t[d]=u:(a||(a={}))[d]=u:Pu(n.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,o=!0)}if(i){const c=Ze(t),u=a||ut;for(let d=0;d<i.length;d++){const f=i[d];t[f]=dh(s,c,f,u[f],n,!et(u,f))}}return o}function dh(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=et(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Ce(c)){const{propsDefaults:u}=s;if(t in u)r=u[t];else{const d=yl(s);r=u[t]=c.call(null,e),d()}}else r=c;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Ns(t))&&(r=!0))}return r}const oE=new WeakMap;function Dy(n,e,t=!1){const r=t?oE:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let c=!1;if(!Ce(n)){const d=f=>{c=!0;const[g,_]=Dy(f,e,!0);sn(o,g),_&&a.push(..._)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!c)return At(n)&&r.set(n,Xi),Xi;if(Re(i))for(let d=0;d<i.length;d++){const f=Gn(i[d]);mm(f)&&(o[f]=ut)}else if(i)for(const d in i){const f=Gn(d);if(mm(f)){const g=i[d],_=o[f]=Re(g)||Ce(g)?{type:g}:sn({},g),D=_.type;let T=!1,C=!0;if(Re(D))for(let U=0;U<D.length;++U){const B=D[U],L=Ce(B)&&B.name;if(L==="Boolean"){T=!0;break}else L==="String"&&(C=!1)}else T=Ce(D)&&D.name==="Boolean";_[0]=T,_[1]=C,(T||et(_,"default"))&&a.push(f)}}const u=[o,a];return At(n)&&r.set(n,u),u}function mm(n){return n[0]!=="$"&&!Pa(n)}const uf=n=>n[0]==="_"||n==="$stable",df=n=>Re(n)?n.map(cr):[cr(n)],aE=(n,e,t)=>{if(e._n)return e;const r=VI((...s)=>df(e(...s)),t);return r._c=!1,r},Vy=(n,e,t)=>{const r=n._ctx;for(const s in n){if(uf(s))continue;const i=n[s];if(Ce(i))e[s]=aE(s,i,r);else if(i!=null){const o=df(i);e[s]=()=>o}}},Ny=(n,e)=>{const t=df(e);n.slots.default=()=>t},Oy=(n,e,t)=>{for(const r in e)(t||!uf(r))&&(n[r]=e[r])},lE=(n,e,t)=>{const r=n.slots=Ry();if(n.vnode.shapeFlag&32){const s=e.__;s&&nh(r,"__",s,!0);const i=e._;i?(Oy(r,e,t),t&&nh(r,"_",i,!0)):Vy(e,r)}else e&&Ny(n,e)},cE=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=ut;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:Oy(s,e,t):(i=!e.$stable,Vy(e,s)),o=e}else e&&(Ny(n,e),o={default:1});if(i)for(const a in s)!uf(a)&&o[a]==null&&delete s[a]},Ln=EE;function uE(n){return dE(n)}function dE(n,e){const t=Iu();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:d,parentNode:f,nextSibling:g,setScopeId:_=Xn,insertStaticContent:D}=n,T=(b,P,M,W=null,z=null,ee=null,ae=void 0,H=null,Z=!!P.dynamicChildren)=>{if(b===P)return;b&&!ca(b,P)&&(W=j(b),ot(b,z,ee,!0),b=null),P.patchFlag===-2&&(Z=!1,P.dynamicChildren=null);const{type:te,ref:be,shapeFlag:ue}=P;switch(te){case Su:C(b,P,M,W);break;case Ts:U(b,P,M,W);break;case Ac:b==null&&B(P,M,W,ae);break;case zt:S(b,P,M,W,z,ee,ae,H,Z);break;default:ue&1?q(b,P,M,W,z,ee,ae,H,Z):ue&6?I(b,P,M,W,z,ee,ae,H,Z):(ue&64||ue&128)&&te.process(b,P,M,W,z,ee,ae,H,Z,ce)}be!=null&&z?Ca(be,b&&b.ref,ee,P||b,!P):be==null&&b&&b.ref!=null&&Ca(b.ref,null,ee,b,!0)},C=(b,P,M,W)=>{if(b==null)r(P.el=a(P.children),M,W);else{const z=P.el=b.el;P.children!==b.children&&u(z,P.children)}},U=(b,P,M,W)=>{b==null?r(P.el=c(P.children||""),M,W):P.el=b.el},B=(b,P,M,W)=>{[b.el,b.anchor]=D(b.children,P,M,W,b.el,b.anchor)},L=({el:b,anchor:P},M,W)=>{let z;for(;b&&b!==P;)z=g(b),r(b,M,W),b=z;r(P,M,W)},O=({el:b,anchor:P})=>{let M;for(;b&&b!==P;)M=g(b),s(b),b=M;s(P)},q=(b,P,M,W,z,ee,ae,H,Z)=>{P.type==="svg"?ae="svg":P.type==="math"&&(ae="mathml"),b==null?ie(P,M,W,z,ee,ae,H,Z):A(b,P,z,ee,ae,H,Z)},ie=(b,P,M,W,z,ee,ae,H)=>{let Z,te;const{props:be,shapeFlag:ue,transition:me,dirs:Te}=b;if(Z=b.el=o(b.type,ee,be&&be.is,be),ue&8?d(Z,b.children):ue&16&&E(b.children,Z,null,W,z,Rd(b,ee),ae,H),Te&&Ws(b,null,W,"created"),x(Z,b,b.scopeId,ae,W),be){for(const xe in be)xe!=="value"&&!Pa(xe)&&i(Z,xe,null,be[xe],ee,W);"value"in be&&i(Z,"value",null,be.value,ee),(te=be.onVnodeBeforeMount)&&ar(te,W,b)}Te&&Ws(b,null,W,"beforeMount");const Ie=hE(z,me);Ie&&me.beforeEnter(Z),r(Z,P,M),((te=be&&be.onVnodeMounted)||Ie||Te)&&Ln(()=>{te&&ar(te,W,b),Ie&&me.enter(Z),Te&&Ws(b,null,W,"mounted")},z)},x=(b,P,M,W,z)=>{if(M&&_(b,M),W)for(let ee=0;ee<W.length;ee++)_(b,W[ee]);if(z){let ee=z.subTree;if(P===ee||$y(ee.type)&&(ee.ssContent===P||ee.ssFallback===P)){const ae=z.vnode;x(b,ae,ae.scopeId,ae.slotScopeIds,z.parent)}}},E=(b,P,M,W,z,ee,ae,H,Z=0)=>{for(let te=Z;te<b.length;te++){const be=b[te]=H?as(b[te]):cr(b[te]);T(null,be,P,M,W,z,ee,ae,H)}},A=(b,P,M,W,z,ee,ae)=>{const H=P.el=b.el;let{patchFlag:Z,dynamicChildren:te,dirs:be}=P;Z|=b.patchFlag&16;const ue=b.props||ut,me=P.props||ut;let Te;if(M&&Qs(M,!1),(Te=me.onVnodeBeforeUpdate)&&ar(Te,M,P,b),be&&Ws(P,b,M,"beforeUpdate"),M&&Qs(M,!0),(ue.innerHTML&&me.innerHTML==null||ue.textContent&&me.textContent==null)&&d(H,""),te?R(b.dynamicChildren,te,H,M,W,Rd(P,z),ee):ae||Oe(b,P,H,null,M,W,Rd(P,z),ee,!1),Z>0){if(Z&16)w(H,ue,me,M,z);else if(Z&2&&ue.class!==me.class&&i(H,"class",null,me.class,z),Z&4&&i(H,"style",ue.style,me.style,z),Z&8){const Ie=P.dynamicProps;for(let xe=0;xe<Ie.length;xe++){const Me=Ie[xe],wt=ue[Me],mt=me[Me];(mt!==wt||Me==="value")&&i(H,Me,wt,mt,z,M)}}Z&1&&b.children!==P.children&&d(H,P.children)}else!ae&&te==null&&w(H,ue,me,M,z);((Te=me.onVnodeUpdated)||be)&&Ln(()=>{Te&&ar(Te,M,P,b),be&&Ws(P,b,M,"updated")},W)},R=(b,P,M,W,z,ee,ae)=>{for(let H=0;H<P.length;H++){const Z=b[H],te=P[H],be=Z.el&&(Z.type===zt||!ca(Z,te)||Z.shapeFlag&198)?f(Z.el):M;T(Z,te,be,null,W,z,ee,ae,!0)}},w=(b,P,M,W,z)=>{if(P!==M){if(P!==ut)for(const ee in P)!Pa(ee)&&!(ee in M)&&i(b,ee,P[ee],null,z,W);for(const ee in M){if(Pa(ee))continue;const ae=M[ee],H=P[ee];ae!==H&&ee!=="value"&&i(b,ee,H,ae,z,W)}"value"in M&&i(b,"value",P.value,M.value,z)}},S=(b,P,M,W,z,ee,ae,H,Z)=>{const te=P.el=b?b.el:a(""),be=P.anchor=b?b.anchor:a("");let{patchFlag:ue,dynamicChildren:me,slotScopeIds:Te}=P;Te&&(H=H?H.concat(Te):Te),b==null?(r(te,M,W),r(be,M,W),E(P.children||[],M,be,z,ee,ae,H,Z)):ue>0&&ue&64&&me&&b.dynamicChildren?(R(b.dynamicChildren,me,M,z,ee,ae,H),(P.key!=null||z&&P===z.subTree)&&My(b,P,!0)):Oe(b,P,M,be,z,ee,ae,H,Z)},I=(b,P,M,W,z,ee,ae,H,Z)=>{P.slotScopeIds=H,b==null?P.shapeFlag&512?z.ctx.activate(P,M,W,ae,Z):Ne(P,M,W,z,ee,ae,Z):nt(b,P,Z)},Ne=(b,P,M,W,z,ee,ae)=>{const H=b.component=CE(b,W,z);if(Ey(b)&&(H.ctx.renderer=ce),kE(H,!1,ae),H.asyncDep){if(z&&z.registerDep(H,Ue,ae),!b.el){const Z=H.subTree=Gt(Ts);U(null,Z,P,M)}}else Ue(H,b,P,M,z,ee,ae)},nt=(b,P,M)=>{const W=P.component=b.component;if(bE(b,P,M))if(W.asyncDep&&!W.asyncResolved){$e(W,P,M);return}else W.next=P,W.update();else P.el=b.el,W.vnode=P},Ue=(b,P,M,W,z,ee,ae)=>{const H=()=>{if(b.isMounted){let{next:ue,bu:me,u:Te,parent:Ie,vnode:xe}=b;{const Mt=Ly(b);if(Mt){ue&&(ue.el=xe.el,$e(b,ue,ae)),Mt.asyncDep.then(()=>{b.isUnmounted||H()});return}}let Me=ue,wt;Qs(b,!1),ue?(ue.el=xe.el,$e(b,ue,ae)):ue=xe,me&&Ec(me),(wt=ue.props&&ue.props.onVnodeBeforeUpdate)&&ar(wt,Ie,ue,xe),Qs(b,!0);const mt=Cd(b),Wt=b.subTree;b.subTree=mt,T(Wt,mt,f(Wt.el),j(Wt),b,z,ee),ue.el=mt.el,Me===null&&IE(b,mt.el),Te&&Ln(Te,z),(wt=ue.props&&ue.props.onVnodeUpdated)&&Ln(()=>ar(wt,Ie,ue,xe),z)}else{let ue;const{el:me,props:Te}=P,{bm:Ie,m:xe,parent:Me,root:wt,type:mt}=b,Wt=ka(P);if(Qs(b,!1),Ie&&Ec(Ie),!Wt&&(ue=Te&&Te.onVnodeBeforeMount)&&ar(ue,Me,P),Qs(b,!0),me&&Je){const Mt=()=>{b.subTree=Cd(b),Je(me,b.subTree,b,z,null)};Wt&&mt.__asyncHydrate?mt.__asyncHydrate(me,b,Mt):Mt()}else{wt.ce&&wt.ce._def.shadowRoot!==!1&&wt.ce._injectChildStyle(mt);const Mt=b.subTree=Cd(b);T(null,Mt,M,W,b,z,ee),P.el=Mt.el}if(xe&&Ln(xe,z),!Wt&&(ue=Te&&Te.onVnodeMounted)){const Mt=P;Ln(()=>ar(ue,Me,Mt),z)}(P.shapeFlag&256||Me&&ka(Me.vnode)&&Me.vnode.shapeFlag&256)&&b.a&&Ln(b.a,z),b.isMounted=!0,P=M=W=null}};b.scope.on();const Z=b.effect=new X_(H);b.scope.off();const te=b.update=Z.run.bind(Z),be=b.job=Z.runIfDirty.bind(Z);be.i=b,be.id=b.uid,Z.scheduler=()=>of(be),Qs(b,!0),te()},$e=(b,P,M)=>{P.component=b;const W=b.vnode.props;b.vnode=P,b.next=null,iE(b,P.props,W,M),cE(b,P.children,M),Nr(),cm(b),Or()},Oe=(b,P,M,W,z,ee,ae,H,Z=!1)=>{const te=b&&b.children,be=b?b.shapeFlag:0,ue=P.children,{patchFlag:me,shapeFlag:Te}=P;if(me>0){if(me&128){hn(te,ue,M,W,z,ee,ae,H,Z);return}else if(me&256){Ht(te,ue,M,W,z,ee,ae,H,Z);return}}Te&8?(be&16&&Ot(te,z,ee),ue!==te&&d(M,ue)):be&16?Te&16?hn(te,ue,M,W,z,ee,ae,H,Z):Ot(te,z,ee,!0):(be&8&&d(M,""),Te&16&&E(ue,M,W,z,ee,ae,H,Z))},Ht=(b,P,M,W,z,ee,ae,H,Z)=>{b=b||Xi,P=P||Xi;const te=b.length,be=P.length,ue=Math.min(te,be);let me;for(me=0;me<ue;me++){const Te=P[me]=Z?as(P[me]):cr(P[me]);T(b[me],Te,M,null,z,ee,ae,H,Z)}te>be?Ot(b,z,ee,!0,!1,ue):E(P,M,W,z,ee,ae,H,Z,ue)},hn=(b,P,M,W,z,ee,ae,H,Z)=>{let te=0;const be=P.length;let ue=b.length-1,me=be-1;for(;te<=ue&&te<=me;){const Te=b[te],Ie=P[te]=Z?as(P[te]):cr(P[te]);if(ca(Te,Ie))T(Te,Ie,M,null,z,ee,ae,H,Z);else break;te++}for(;te<=ue&&te<=me;){const Te=b[ue],Ie=P[me]=Z?as(P[me]):cr(P[me]);if(ca(Te,Ie))T(Te,Ie,M,null,z,ee,ae,H,Z);else break;ue--,me--}if(te>ue){if(te<=me){const Te=me+1,Ie=Te<be?P[Te].el:W;for(;te<=me;)T(null,P[te]=Z?as(P[te]):cr(P[te]),M,Ie,z,ee,ae,H,Z),te++}}else if(te>me)for(;te<=ue;)ot(b[te],z,ee,!0),te++;else{const Te=te,Ie=te,xe=new Map;for(te=Ie;te<=me;te++){const Qt=P[te]=Z?as(P[te]):cr(P[te]);Qt.key!=null&&xe.set(Qt.key,te)}let Me,wt=0;const mt=me-Ie+1;let Wt=!1,Mt=0;const sr=new Array(mt);for(te=0;te<mt;te++)sr[te]=0;for(te=Te;te<=ue;te++){const Qt=b[te];if(wt>=mt){ot(Qt,z,ee,!0);continue}let Ke;if(Qt.key!=null)Ke=xe.get(Qt.key);else for(Me=Ie;Me<=me;Me++)if(sr[Me-Ie]===0&&ca(Qt,P[Me])){Ke=Me;break}Ke===void 0?ot(Qt,z,ee,!0):(sr[Ke-Ie]=te+1,Ke>=Mt?Mt=Ke:Wt=!0,T(Qt,P[Ke],M,null,z,ee,ae,H,Z),wt++)}const Bs=Wt?fE(sr):Xi;for(Me=Bs.length-1,te=mt-1;te>=0;te--){const Qt=Ie+te,Ke=P[Qt],at=Qt+1<be?P[Qt+1].el:W;sr[te]===0?T(null,Ke,M,at,z,ee,ae,H,Z):Wt&&(Me<0||te!==Bs[Me]?on(Ke,M,at,2):Me--)}}},on=(b,P,M,W,z=null)=>{const{el:ee,type:ae,transition:H,children:Z,shapeFlag:te}=b;if(te&6){on(b.component.subTree,P,M,W);return}if(te&128){b.suspense.move(P,M,W);return}if(te&64){ae.move(b,P,M,ce);return}if(ae===zt){r(ee,P,M);for(let ue=0;ue<Z.length;ue++)on(Z[ue],P,M,W);r(b.anchor,P,M);return}if(ae===Ac){L(b,P,M);return}if(W!==2&&te&1&&H)if(W===0)H.beforeEnter(ee),r(ee,P,M),Ln(()=>H.enter(ee),z);else{const{leave:ue,delayLeave:me,afterLeave:Te}=H,Ie=()=>{b.ctx.isUnmounted?s(ee):r(ee,P,M)},xe=()=>{ue(ee,()=>{Ie(),Te&&Te()})};me?me(ee,Ie,xe):xe()}else r(ee,P,M)},ot=(b,P,M,W=!1,z=!1)=>{const{type:ee,props:ae,ref:H,children:Z,dynamicChildren:te,shapeFlag:be,patchFlag:ue,dirs:me,cacheIndex:Te}=b;if(ue===-2&&(z=!1),H!=null&&(Nr(),Ca(H,null,M,b,!0),Or()),Te!=null&&(P.renderCache[Te]=void 0),be&256){P.ctx.deactivate(b);return}const Ie=be&1&&me,xe=!ka(b);let Me;if(xe&&(Me=ae&&ae.onVnodeBeforeUnmount)&&ar(Me,P,b),be&6)En(b.component,M,W);else{if(be&128){b.suspense.unmount(M,W);return}Ie&&Ws(b,null,P,"beforeUnmount"),be&64?b.type.remove(b,P,M,ce,W):te&&!te.hasOnce&&(ee!==zt||ue>0&&ue&64)?Ot(te,P,M,!1,!0):(ee===zt&&ue&384||!z&&be&16)&&Ot(Z,P,M),W&&rt(b)}(xe&&(Me=ae&&ae.onVnodeUnmounted)||Ie)&&Ln(()=>{Me&&ar(Me,P,b),Ie&&Ws(b,null,P,"unmounted")},M)},rt=b=>{const{type:P,el:M,anchor:W,transition:z}=b;if(P===zt){On(M,W);return}if(P===Ac){O(b);return}const ee=()=>{s(M),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(b.shapeFlag&1&&z&&!z.persisted){const{leave:ae,delayLeave:H}=z,Z=()=>ae(M,ee);H?H(b.el,ee,Z):Z()}else ee()},On=(b,P)=>{let M;for(;b!==P;)M=g(b),s(b),b=M;s(P)},En=(b,P,M)=>{const{bum:W,scope:z,job:ee,subTree:ae,um:H,m:Z,a:te,parent:be,slots:{__:ue}}=b;gm(Z),gm(te),W&&Ec(W),be&&Re(ue)&&ue.forEach(me=>{be.renderCache[me]=void 0}),z.stop(),ee&&(ee.flags|=8,ot(ae,b,P,M)),H&&Ln(H,P),Ln(()=>{b.isUnmounted=!0},P),P&&P.pendingBranch&&!P.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===P.pendingId&&(P.deps--,P.deps===0&&P.resolve())},Ot=(b,P,M,W=!1,z=!1,ee=0)=>{for(let ae=ee;ae<b.length;ae++)ot(b[ae],P,M,W,z)},j=b=>{if(b.shapeFlag&6)return j(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const P=g(b.anchor||b.el),M=P&&P[NI];return M?g(M):P};let he=!1;const se=(b,P,M)=>{b==null?P._vnode&&ot(P._vnode,null,null,!0):T(P._vnode||null,b,P,null,null,null,M),P._vnode=b,he||(he=!0,cm(),yy(),he=!1)},ce={p:T,um:ot,m:on,r:rt,mt:Ne,mc:E,pc:Oe,pbc:R,n:j,o:n};let De,Je;return e&&([De,Je]=e(ce)),{render:se,hydrate:De,createApp:rE(se,De)}}function Rd({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Qs({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function hE(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function My(n,e,t=!1){const r=n.children,s=e.children;if(Re(r)&&Re(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=as(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&My(o,a)),a.type===Su&&(a.el=o.el),a.type===Ts&&!a.el&&(a.el=o.el)}}function fE(n){const e=n.slice(),t=[0];let r,s,i,o,a;const c=n.length;for(r=0;r<c;r++){const u=n[r];if(u!==0){if(s=t[t.length-1],n[s]<u){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<u?i=a+1:o=a;u<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function Ly(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Ly(e)}function gm(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const pE=Symbol.for("v-scx"),mE=()=>tr(pE);function nr(n,e,t){return Fy(n,e,t)}function Fy(n,e,t=ut){const{immediate:r,deep:s,flush:i,once:o}=t,a=sn({},t),c=e&&r||!e&&i!=="post";let u;if(Ha){if(i==="sync"){const _=mE();u=_.__watcherHandles||(_.__watcherHandles=[])}else if(!c){const _=()=>{};return _.stop=Xn,_.resume=Xn,_.pause=Xn,_}}const d=yn;a.call=(_,D,T)=>gr(_,d,D,T);let f=!1;i==="post"?a.scheduler=_=>{Ln(_,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(_,D)=>{D?_():of(_)}),a.augmentJob=_=>{e&&(_.flags|=4),f&&(_.flags|=2,d&&(_.id=d.uid,_.i=d))};const g=RI(n,e,a);return Ha&&(u?u.push(g):c&&g()),g}function gE(n,e,t){const r=this.proxy,s=Kt(n)?n.includes(".")?Uy(r,n):()=>r[n]:n.bind(r,r);let i;Ce(e)?i=e:(i=e.handler,t=e);const o=yl(this),a=Fy(s,i.bind(r),t);return o(),a}function Uy(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const _E=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${Gn(e)}Modifiers`]||n[`${Ns(e)}Modifiers`];function yE(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||ut;let s=t;const i=e.startsWith("update:"),o=i&&_E(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>Kt(d)?d.trim():d)),o.number&&(s=t.map(rh)));let a,c=r[a=Ed(e)]||r[a=Ed(Gn(e))];!c&&i&&(c=r[a=Ed(Ns(e))]),c&&gr(c,n,6,s);const u=r[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,gr(u,n,6,s)}}function By(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!Ce(n)){const c=u=>{const d=By(u,e,!0);d&&(a=!0,sn(o,d))};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}return!i&&!a?(At(n)&&r.set(n,null),null):(Re(i)?i.forEach(c=>o[c]=null):sn(o,i),At(n)&&r.set(n,o),o)}function Pu(n,e){return!n||!yu(e)?!1:(e=e.slice(2).replace(/Once$/,""),et(n,e[0].toLowerCase()+e.slice(1))||et(n,Ns(e))||et(n,e))}function Cd(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:c,render:u,renderCache:d,props:f,data:g,setupState:_,ctx:D,inheritAttrs:T}=n,C=Gc(n);let U,B;try{if(t.shapeFlag&4){const O=s||r,q=O;U=cr(u.call(q,O,d,f,_,g,D)),B=a}else{const O=e;U=cr(O.length>1?O(f,{attrs:a,slots:o,emit:c}):O(f,null)),B=e.props?a:vE(a)}}catch(O){Va.length=0,Au(O,n,1),U=Gt(Ts)}let L=U;if(B&&T!==!1){const O=Object.keys(B),{shapeFlag:q}=L;O.length&&q&7&&(i&&O.some(Wh)&&(B=wE(B,i)),L=ho(L,B,!1,!0))}return t.dirs&&(L=ho(L,null,!1,!0),L.dirs=L.dirs?L.dirs.concat(t.dirs):t.dirs),t.transition&&af(L,t.transition),U=L,Gc(C),U}const vE=n=>{let e;for(const t in n)(t==="class"||t==="style"||yu(t))&&((e||(e={}))[t]=n[t]);return e},wE=(n,e)=>{const t={};for(const r in n)(!Wh(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function bE(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&c>=0){if(c&1024)return!0;if(c&16)return r?_m(r,o,u):!!o;if(c&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(o[g]!==r[g]&&!Pu(u,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?_m(r,o,u):!0:!!o;return!1}function _m(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Pu(t,i))return!0}return!1}function IE({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const $y=n=>n.__isSuspense;function EE(n,e){e&&e.pendingBranch?Re(n)?e.effects.push(...n):e.effects.push(n):DI(n)}const zt=Symbol.for("v-fgt"),Su=Symbol.for("v-txt"),Ts=Symbol.for("v-cmt"),Ac=Symbol.for("v-stc"),Va=[];let Un=null;function Q(n=!1){Va.push(Un=n?null:[])}function TE(){Va.pop(),Un=Va[Va.length-1]||null}let Ka=1;function ym(n,e=!1){Ka+=n,n<0&&Un&&e&&(Un.hasOnce=!0)}function jy(n){return n.dynamicChildren=Ka>0?Un||Xi:null,TE(),Ka>0&&Un&&Un.push(n),n}function X(n,e,t,r,s,i){return jy(m(n,e,t,r,s,i,!0))}function qy(n,e,t,r,s){return jy(Gt(n,e,t,r,s,!0))}function Hc(n){return n?n.__v_isVNode===!0:!1}function ca(n,e){return n.type===e.type&&n.key===e.key}const zy=({key:n})=>n??null,xc=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Kt(n)||vn(n)||Ce(n)?{i:Fn,r:n,k:e,f:!!t}:n:null);function m(n,e=null,t=null,r=0,s=null,i=n===zt?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&zy(e),ref:e&&xc(e),scopeId:wy,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Fn};return a?(hf(c,t),i&128&&n.normalize(c)):t&&(c.shapeFlag|=Kt(t)?8:16),Ka>0&&!o&&Un&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&Un.push(c),c}const Gt=AE;function AE(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===WI)&&(n=Ts),Hc(n)){const a=ho(n,e,!0);return t&&hf(a,t),Ka>0&&!i&&Un&&(a.shapeFlag&6?Un[Un.indexOf(n)]=a:Un.push(a)),a.patchFlag=-2,a}if(ME(n)&&(n=n.__vccOpts),e){e=xE(e);let{class:a,style:c}=e;a&&!Kt(a)&&(e.class=Zn(a)),At(c)&&(sf(c)&&!Re(c)&&(c=sn({},c)),e.style=Yh(c))}const o=Kt(n)?1:$y(n)?128:OI(n)?64:At(n)?4:Ce(n)?2:0;return m(n,e,t,r,s,o,i,!0)}function xE(n){return n?sf(n)||Cy(n)?sn({},n):n:null}function ho(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:c}=n,u=e?PE(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&zy(u),ref:e&&e.ref?t&&i?Re(i)?i.concat(xc(e)):[i,xc(e)]:xc(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==zt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:c,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&ho(n.ssContent),ssFallback:n.ssFallback&&ho(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return c&&r&&af(d,c.clone(d)),d}function xr(n=" ",e=0){return Gt(Su,null,n,e)}function is(n,e){const t=Gt(Ac,null,n);return t.staticCount=e,t}function Ae(n="",e=!1){return e?(Q(),qy(Ts,null,n)):Gt(Ts,null,n)}function cr(n){return n==null||typeof n=="boolean"?Gt(Ts):Re(n)?Gt(zt,null,n.slice()):Hc(n)?as(n):Gt(Su,null,String(n))}function as(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:ho(n)}function hf(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Re(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),hf(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Cy(e)?e._ctx=Fn:s===3&&Fn&&(Fn.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Ce(e)?(e={default:e,_ctx:Fn},t=32):(e=String(e),r&64?(t=16,e=[xr(e)]):t=8);n.children=e,n.shapeFlag|=t}function PE(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Zn([e.class,r.class]));else if(s==="style")e.style=Yh([e.style,r.style]);else if(yu(s)){const i=e[s],o=r[s];o&&i!==o&&!(Re(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function ar(n,e,t,r=null){gr(n,e,7,[t,r])}const SE=Py();let RE=0;function CE(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||SE,i={uid:RE++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new nI(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Dy(r,s),emitsOptions:By(r,s),emit:null,emitted:null,propsDefaults:ut,inheritAttrs:r.inheritAttrs,ctx:ut,data:ut,props:ut,attrs:ut,slots:ut,refs:ut,setupState:ut,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=yE.bind(null,i),n.ce&&n.ce(i),i}let yn=null,Wc,hh;{const n=Iu(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Wc=e("__VUE_INSTANCE_SETTERS__",t=>yn=t),hh=e("__VUE_SSR_SETTERS__",t=>Ha=t)}const yl=n=>{const e=yn;return Wc(n),n.scope.on(),()=>{n.scope.off(),Wc(e)}},vm=()=>{yn&&yn.scope.off(),Wc(null)};function Gy(n){return n.vnode.shapeFlag&4}let Ha=!1;function kE(n,e=!1,t=!1){e&&hh(e);const{props:r,children:s}=n.vnode,i=Gy(n);sE(n,r,i,e),lE(n,s,t||e);const o=i?DE(n,e):void 0;return e&&hh(!1),o}function DE(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,JI);const{setup:r}=t;if(r){Nr();const s=n.setupContext=r.length>1?NE(n):null,i=yl(n),o=gl(r,n,0,[n.props,s]),a=K_(o);if(Or(),i(),(a||n.sp)&&!ka(n)&&Iy(n),a){if(o.then(vm,vm),e)return o.then(c=>{wm(n,c,e)}).catch(c=>{Au(c,n,0)});n.asyncDep=o}else wm(n,o,e)}else Ky(n,e)}function wm(n,e,t){Ce(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:At(e)&&(n.setupState=my(e)),Ky(n,t)}let bm;function Ky(n,e,t){const r=n.type;if(!n.render){if(!e&&bm&&!r.render){const s=r.template||cf(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:c}=r,u=sn(sn({isCustomElement:i,delimiters:a},o),c);r.render=bm(s,u)}}n.render=r.render||Xn}{const s=yl(n);Nr();try{YI(n)}finally{Or(),s()}}}const VE={get(n,e){return _n(n,"get",""),n[e]}};function NE(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,VE),slots:n.slots,emit:n.emit,expose:e}}function Ru(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(my(II(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Da)return Da[t](n)},has(e,t){return t in e||t in Da}})):n.proxy}function OE(n,e=!0){return Ce(n)?n.displayName||n.name:n.name||e&&n.__name}function ME(n){return Ce(n)&&"__vccOpts"in n}const tn=(n,e)=>PI(n,e,Ha);function Hy(n,e,t){const r=arguments.length;return r===2?At(e)&&!Re(e)?Hc(e)?Gt(n,null,[e]):Gt(n,e):Gt(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Hc(t)&&(t=[t]),Gt(n,e,t))}const LE="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fh;const Im=typeof window<"u"&&window.trustedTypes;if(Im)try{fh=Im.createPolicy("vue",{createHTML:n=>n})}catch{}const Wy=fh?n=>fh.createHTML(n):n=>n,FE="http://www.w3.org/2000/svg",UE="http://www.w3.org/1998/Math/MathML",Ar=typeof document<"u"?document:null,Em=Ar&&Ar.createElement("template"),BE={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?Ar.createElementNS(FE,n):e==="mathml"?Ar.createElementNS(UE,n):t?Ar.createElement(n,{is:t}):Ar.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>Ar.createTextNode(n),createComment:n=>Ar.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Ar.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Em.innerHTML=Wy(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Em.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},$E=Symbol("_vtc");function jE(n,e,t){const r=n[$E];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Qc=Symbol("_vod"),Qy=Symbol("_vsh"),Tm={beforeMount(n,{value:e},{transition:t}){n[Qc]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):ua(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),ua(n,!0),r.enter(n)):r.leave(n,()=>{ua(n,!1)}):ua(n,e))},beforeUnmount(n,{value:e}){ua(n,e)}};function ua(n,e){n.style.display=e?n[Qc]:"none",n[Qy]=!e}const qE=Symbol(""),zE=/(^|;)\s*display\s*:/;function GE(n,e,t){const r=n.style,s=Kt(t);let i=!1;if(t&&!s){if(e)if(Kt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Pc(r,a,"")}else for(const o in e)t[o]==null&&Pc(r,o,"");for(const o in t)o==="display"&&(i=!0),Pc(r,o,t[o])}else if(s){if(e!==t){const o=r[qE];o&&(t+=";"+o),r.cssText=t,i=zE.test(t)}}else e&&n.removeAttribute("style");Qc in n&&(n[Qc]=i?r.display:"",n[Qy]&&(r.display="none"))}const Am=/\s*!important$/;function Pc(n,e,t){if(Re(t))t.forEach(r=>Pc(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=KE(n,e);Am.test(t)?n.setProperty(Ns(r),t.replace(Am,""),"important"):n[r]=t}}const xm=["Webkit","Moz","ms"],kd={};function KE(n,e){const t=kd[e];if(t)return t;let r=Gn(e);if(r!=="filter"&&r in n)return kd[e]=r;r=bu(r);for(let s=0;s<xm.length;s++){const i=xm[s]+r;if(i in n)return kd[e]=i}return e}const Pm="http://www.w3.org/1999/xlink";function Sm(n,e,t,r,s,i=tI(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Pm,e.slice(6,e.length)):n.setAttributeNS(Pm,e,t):t==null||i&&!Q_(t)?n.removeAttribute(e):n.setAttribute(e,i?"":Vs(t)?String(t):t)}function Rm(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?Wy(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,c=t==null?n.type==="checkbox"?"on":"":String(t);(a!==c||!("_value"in n))&&(n.value=c),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=Q_(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function Ki(n,e,t,r){n.addEventListener(e,t,r)}function HE(n,e,t,r){n.removeEventListener(e,t,r)}const Cm=Symbol("_vei");function WE(n,e,t,r,s=null){const i=n[Cm]||(n[Cm]={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=QE(e);if(r){const u=i[e]=XE(r,s);Ki(n,a,u,c)}else o&&(HE(n,a,o,c),i[e]=void 0)}}const km=/(?:Once|Passive|Capture)$/;function QE(n){let e;if(km.test(n)){e={};let r;for(;r=n.match(km);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Ns(n.slice(2)),e]}let Dd=0;const JE=Promise.resolve(),YE=()=>Dd||(JE.then(()=>Dd=0),Dd=Date.now());function XE(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;gr(ZE(r,t.value),e,5,[r])};return t.value=n,t.attached=YE(),t}function ZE(n,e){if(Re(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Dm=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,eT=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?jE(n,r,o):e==="style"?GE(n,t,r):yu(e)?Wh(e)||WE(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):tT(n,e,r,o))?(Rm(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Sm(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Kt(r))?Rm(n,Gn(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Sm(n,e,r,o))};function tT(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Dm(e)&&Ce(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Dm(e)&&Kt(t)?!1:e in n}const Vm=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Re(e)?t=>Ec(e,t):e};function nT(n){n.target.composing=!0}function Nm(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Vd=Symbol("_assign"),Pt={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[Vd]=Vm(s);const i=r||s.props&&s.props.type==="number";Ki(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=rh(a)),n[Vd](a)}),t&&Ki(n,"change",()=>{n.value=n.value.trim()}),e||(Ki(n,"compositionstart",nT),Ki(n,"compositionend",Nm),Ki(n,"change",Nm))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[Vd]=Vm(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?rh(n.value):n.value,c=e??"";a!==c&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===c)||(n.value=c))}},rT=["ctrl","shift","alt","meta"],sT={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>rT.some(t=>n[`${t}Key`]&&!e.includes(t))},Yn=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=sT[e[o]];if(a&&a(s,e))return}return n(s,...i)})},iT={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},An=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Ns(s.key);if(e.some(o=>o===i||iT[o]===i))return n(s)})},oT=sn({patchProp:eT},BE);let Om;function aT(){return Om||(Om=uE(oT))}const lT=(...n)=>{const e=aT().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=uT(r);if(!s)return;const i=e._component;!Ce(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,cT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function cT(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function uT(n){return Kt(n)?document.querySelector(n):n}const dT={__name:"App",setup(n){return(e,t)=>{const r=HI("router-view");return Q(),qy(r)}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Hi=typeof document<"u";function Jy(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function hT(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&Jy(n.default)}const Xe=Object.assign;function Nd(n,e){const t={};for(const r in e){const s=e[r];t[r]=rr(s)?s.map(n):n(s)}return t}const Na=()=>{},rr=Array.isArray,Yy=/#/g,fT=/&/g,pT=/\//g,mT=/=/g,gT=/\?/g,Xy=/\+/g,_T=/%5B/g,yT=/%5D/g,Zy=/%5E/g,vT=/%60/g,ev=/%7B/g,wT=/%7C/g,tv=/%7D/g,bT=/%20/g;function ff(n){return encodeURI(""+n).replace(wT,"|").replace(_T,"[").replace(yT,"]")}function IT(n){return ff(n).replace(ev,"{").replace(tv,"}").replace(Zy,"^")}function ph(n){return ff(n).replace(Xy,"%2B").replace(bT,"+").replace(Yy,"%23").replace(fT,"%26").replace(vT,"`").replace(ev,"{").replace(tv,"}").replace(Zy,"^")}function ET(n){return ph(n).replace(mT,"%3D")}function TT(n){return ff(n).replace(Yy,"%23").replace(gT,"%3F")}function AT(n){return n==null?"":TT(n).replace(pT,"%2F")}function Wa(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const xT=/\/$/,PT=n=>n.replace(xT,"");function Od(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(r=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=kT(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Wa(o)}}function ST(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Mm(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function RT(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&fo(e.matched[r],t.matched[s])&&nv(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function fo(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function nv(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!CT(n[t],e[t]))return!1;return!0}function CT(n,e){return rr(n)?Lm(n,e):rr(e)?Lm(e,n):n===e}function Lm(n,e){return rr(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function kT(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const ts={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Qa;(function(n){n.pop="pop",n.push="push"})(Qa||(Qa={}));var Oa;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Oa||(Oa={}));function DT(n){if(!n)if(Hi){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),PT(n)}const VT=/^[^#]+#/;function NT(n,e){return n.replace(VT,"#")+e}function OT(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Cu=()=>({left:window.scrollX,top:window.scrollY});function MT(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=OT(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Fm(n,e){return(history.state?history.state.position-e:-1)+n}const mh=new Map;function LT(n,e){mh.set(n,e)}function FT(n){const e=mh.get(n);return mh.delete(n),e}let UT=()=>location.protocol+"//"+location.host;function rv(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,c=s.slice(a);return c[0]!=="/"&&(c="/"+c),Mm(c,"")}return Mm(t,n)+r+s}function BT(n,e,t,r){let s=[],i=[],o=null;const a=({state:g})=>{const _=rv(n,location),D=t.value,T=e.value;let C=0;if(g){if(t.value=_,e.value=g,o&&o===D){o=null;return}C=T?g.position-T.position:0}else r(_);s.forEach(U=>{U(t.value,D,{delta:C,type:Qa.pop,direction:C?C>0?Oa.forward:Oa.back:Oa.unknown})})};function c(){o=t.value}function u(g){s.push(g);const _=()=>{const D=s.indexOf(g);D>-1&&s.splice(D,1)};return i.push(_),_}function d(){const{history:g}=window;g.state&&g.replaceState(Xe({},g.state,{scroll:Cu()}),"")}function f(){for(const g of i)g();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:c,listen:u,destroy:f}}function Um(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?Cu():null}}function $T(n){const{history:e,location:t}=window,r={value:rv(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,d){const f=n.indexOf("#"),g=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+c:UT()+n+c;try{e[d?"replaceState":"pushState"](u,"",g),s.value=u}catch(_){console.error(_),t[d?"replace":"assign"](g)}}function o(c,u){const d=Xe({},e.state,Um(s.value.back,c,s.value.forward,!0),u,{position:s.value.position});i(c,d,!0),r.value=c}function a(c,u){const d=Xe({},s.value,e.state,{forward:c,scroll:Cu()});i(d.current,d,!0);const f=Xe({},Um(r.value,c,null),{position:d.position+1},u);i(c,f,!1),r.value=c}return{location:r,state:s,push:a,replace:o}}function jT(n){n=DT(n);const e=$T(n),t=BT(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=Xe({location:"",base:n,go:r,createHref:NT.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function qT(n){return typeof n=="string"||n&&typeof n=="object"}function sv(n){return typeof n=="string"||typeof n=="symbol"}const iv=Symbol("");var Bm;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Bm||(Bm={}));function po(n,e){return Xe(new Error,{type:n,[iv]:!0},e)}function Tr(n,e){return n instanceof Error&&iv in n&&(e==null||!!(n.type&e))}const $m="[^/]+?",zT={sensitive:!1,strict:!1,start:!0,end:!0},GT=/[.+*?^${}()[\]/\\]/g;function KT(n,e){const t=Xe({},zT,e),r=[];let s=t.start?"^":"";const i=[];for(const u of n){const d=u.length?[]:[90];t.strict&&!u.length&&(s+="/");for(let f=0;f<u.length;f++){const g=u[f];let _=40+(t.sensitive?.25:0);if(g.type===0)f||(s+="/"),s+=g.value.replace(GT,"\\$&"),_+=40;else if(g.type===1){const{value:D,repeatable:T,optional:C,regexp:U}=g;i.push({name:D,repeatable:T,optional:C});const B=U||$m;if(B!==$m){_+=10;try{new RegExp(`(${B})`)}catch(O){throw new Error(`Invalid custom RegExp for param "${D}" (${B}): `+O.message)}}let L=T?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;f||(L=C&&u.length<2?`(?:/${L})`:"/"+L),C&&(L+="?"),s+=L,_+=20,C&&(_+=-8),T&&(_+=-20),B===".*"&&(_+=-50)}d.push(_)}r.push(d)}if(t.strict&&t.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(u){const d=u.match(o),f={};if(!d)return null;for(let g=1;g<d.length;g++){const _=d[g]||"",D=i[g-1];f[D.name]=_&&D.repeatable?_.split("/"):_}return f}function c(u){let d="",f=!1;for(const g of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const _ of g)if(_.type===0)d+=_.value;else if(_.type===1){const{value:D,repeatable:T,optional:C}=_,U=D in u?u[D]:"";if(rr(U)&&!T)throw new Error(`Provided param "${D}" is an array but it is not repeatable (* or + modifiers)`);const B=rr(U)?U.join("/"):U;if(!B)if(C)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${D}"`);d+=B}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:c}}function HT(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function ov(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=HT(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(jm(r))return 1;if(jm(s))return-1}return s.length-r.length}function jm(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const WT={type:0,value:""},QT=/[a-zA-Z0-9_]/;function JT(n){if(!n)return[[]];if(n==="/")return[[WT]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(_){throw new Error(`ERR (${t})/"${u}": ${_}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,c,u="",d="";function f(){u&&(t===0?i.push({type:0,value:u}):t===1||t===2||t===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:d,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function g(){u+=c}for(;a<n.length;){if(c=n[a++],c==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:c==="/"?(u&&f(),o()):c===":"?(f(),t=1):g();break;case 4:g(),t=r;break;case 1:c==="("?t=2:QT.test(c)?g():(f(),t=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+c:t=3:d+=c;break;case 3:f(),t=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),s}function YT(n,e,t){const r=KT(JT(n.path),t),s=Xe(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function XT(n,e){const t=[],r=new Map;e=Km({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,g,_){const D=!_,T=zm(f);T.aliasOf=_&&_.record;const C=Km(e,f),U=[T];if("alias"in f){const O=typeof f.alias=="string"?[f.alias]:f.alias;for(const q of O)U.push(zm(Xe({},T,{components:_?_.record.components:T.components,path:q,aliasOf:_?_.record:T})))}let B,L;for(const O of U){const{path:q}=O;if(g&&q[0]!=="/"){const ie=g.record.path,x=ie[ie.length-1]==="/"?"":"/";O.path=g.record.path+(q&&x+q)}if(B=YT(O,g,C),_?_.alias.push(B):(L=L||B,L!==B&&L.alias.push(B),D&&f.name&&!Gm(B)&&o(f.name)),av(B)&&c(B),T.children){const ie=T.children;for(let x=0;x<ie.length;x++)i(ie[x],B,_&&_.children[x])}_=_||B}return L?()=>{o(L)}:Na}function o(f){if(sv(f)){const g=r.get(f);g&&(r.delete(f),t.splice(t.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=t.indexOf(f);g>-1&&(t.splice(g,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function c(f){const g=tA(f,t);t.splice(g,0,f),f.record.name&&!Gm(f)&&r.set(f.record.name,f)}function u(f,g){let _,D={},T,C;if("name"in f&&f.name){if(_=r.get(f.name),!_)throw po(1,{location:f});C=_.record.name,D=Xe(qm(g.params,_.keys.filter(L=>!L.optional).concat(_.parent?_.parent.keys.filter(L=>L.optional):[]).map(L=>L.name)),f.params&&qm(f.params,_.keys.map(L=>L.name))),T=_.stringify(D)}else if(f.path!=null)T=f.path,_=t.find(L=>L.re.test(T)),_&&(D=_.parse(T),C=_.record.name);else{if(_=g.name?r.get(g.name):t.find(L=>L.re.test(g.path)),!_)throw po(1,{location:f,currentLocation:g});C=_.record.name,D=Xe({},g.params,f.params),T=_.stringify(D)}const U=[];let B=_;for(;B;)U.unshift(B.record),B=B.parent;return{name:C,path:T,params:D,matched:U,meta:eA(U)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function qm(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function zm(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:ZT(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function ZT(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function Gm(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function eA(n){return n.reduce((e,t)=>Xe(e,t.meta),{})}function Km(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function tA(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;ov(n,e[i])<0?r=i:t=i+1}const s=nA(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function nA(n){let e=n;for(;e=e.parent;)if(av(e)&&ov(n,e)===0)return e}function av({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function rA(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(Xy," "),o=i.indexOf("="),a=Wa(o<0?i:i.slice(0,o)),c=o<0?null:Wa(i.slice(o+1));if(a in e){let u=e[a];rr(u)||(u=e[a]=[u]),u.push(c)}else e[a]=c}return e}function Hm(n){let e="";for(let t in n){const r=n[t];if(t=ET(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(rr(r)?r.map(i=>i&&ph(i)):[r&&ph(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function sA(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=rr(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const iA=Symbol(""),Wm=Symbol(""),ku=Symbol(""),pf=Symbol(""),gh=Symbol("");function da(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ls(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,c)=>{const u=g=>{g===!1?c(po(4,{from:t,to:e})):g instanceof Error?c(g):qT(g)?c(po(2,{from:e,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),a())},d=i(()=>n.call(r&&r.instances[s],e,t,u));let f=Promise.resolve(d);n.length<3&&(f=f.then(u)),f.catch(g=>c(g))})}function Md(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let c=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(Jy(c)){const d=(c.__vccOpts||c)[e];d&&i.push(ls(d,t,r,o,a,s))}else{let u=c();i.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=hT(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const _=(f.__vccOpts||f)[e];return _&&ls(_,t,r,o,a,s)()}))}}return i}function Qm(n){const e=tr(ku),t=tr(pf),r=tn(()=>{const c=to(n.to);return e.resolve(c)}),s=tn(()=>{const{matched:c}=r.value,{length:u}=c,d=c[u-1],f=t.matched;if(!d||!f.length)return-1;const g=f.findIndex(fo.bind(null,d));if(g>-1)return g;const _=Jm(c[u-2]);return u>1&&Jm(d)===_&&f[f.length-1].path!==_?f.findIndex(fo.bind(null,c[u-2])):g}),i=tn(()=>s.value>-1&&uA(t.params,r.value.params)),o=tn(()=>s.value>-1&&s.value===t.matched.length-1&&nv(t.params,r.value.params));function a(c={}){if(cA(c)){const u=e[to(n.replace)?"replace":"push"](to(n.to)).catch(Na);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:tn(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function oA(n){return n.length===1?n[0]:n}const aA=by({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Qm,setup(n,{slots:e}){const t=Tu(Qm(n)),{options:r}=tr(ku),s=tn(()=>({[Ym(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Ym(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&oA(e.default(t));return n.custom?i:Hy("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),lA=aA;function cA(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function uA(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!rr(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Jm(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Ym=(n,e,t)=>n??e??t,dA=by({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=tr(gh),s=tn(()=>n.route||r.value),i=tr(Wm,0),o=tn(()=>{let u=to(i);const{matched:d}=s.value;let f;for(;(f=d[u])&&!f.components;)u++;return u}),a=tn(()=>s.value.matched[o.value]);Tc(Wm,tn(()=>o.value+1)),Tc(iA,a),Tc(gh,s);const c=G();return nr(()=>[c.value,a.value,n.name],([u,d,f],[g,_,D])=>{d&&(d.instances[f]=u,_&&_!==d&&u&&u===g&&(d.leaveGuards.size||(d.leaveGuards=_.leaveGuards),d.updateGuards.size||(d.updateGuards=_.updateGuards))),u&&d&&(!_||!fo(d,_)||!g)&&(d.enterCallbacks[f]||[]).forEach(T=>T(u))},{flush:"post"}),()=>{const u=s.value,d=n.name,f=a.value,g=f&&f.components[d];if(!g)return Xm(t.default,{Component:g,route:u});const _=f.props[d],D=_?_===!0?u.params:typeof _=="function"?_(u):_:null,C=Hy(g,Xe({},D,e,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(f.instances[d]=null)},ref:c}));return Xm(t.default,{Component:C,route:u})||C}}});function Xm(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const hA=dA;function fA(n){const e=XT(n.routes,n),t=n.parseQuery||rA,r=n.stringifyQuery||Hm,s=n.history,i=da(),o=da(),a=da(),c=EI(ts);let u=ts;Hi&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Nd.bind(null,j=>""+j),f=Nd.bind(null,AT),g=Nd.bind(null,Wa);function _(j,he){let se,ce;return sv(j)?(se=e.getRecordMatcher(j),ce=he):ce=j,e.addRoute(ce,se)}function D(j){const he=e.getRecordMatcher(j);he&&e.removeRoute(he)}function T(){return e.getRoutes().map(j=>j.record)}function C(j){return!!e.getRecordMatcher(j)}function U(j,he){if(he=Xe({},he||c.value),typeof j=="string"){const P=Od(t,j,he.path),M=e.resolve({path:P.path},he),W=s.createHref(P.fullPath);return Xe(P,M,{params:g(M.params),hash:Wa(P.hash),redirectedFrom:void 0,href:W})}let se;if(j.path!=null)se=Xe({},j,{path:Od(t,j.path,he.path).path});else{const P=Xe({},j.params);for(const M in P)P[M]==null&&delete P[M];se=Xe({},j,{params:f(P)}),he.params=f(he.params)}const ce=e.resolve(se,he),De=j.hash||"";ce.params=d(g(ce.params));const Je=ST(r,Xe({},j,{hash:IT(De),path:ce.path})),b=s.createHref(Je);return Xe({fullPath:Je,hash:De,query:r===Hm?sA(j.query):j.query||{}},ce,{redirectedFrom:void 0,href:b})}function B(j){return typeof j=="string"?Od(t,j,c.value.path):Xe({},j)}function L(j,he){if(u!==j)return po(8,{from:he,to:j})}function O(j){return x(j)}function q(j){return O(Xe(B(j),{replace:!0}))}function ie(j){const he=j.matched[j.matched.length-1];if(he&&he.redirect){const{redirect:se}=he;let ce=typeof se=="function"?se(j):se;return typeof ce=="string"&&(ce=ce.includes("?")||ce.includes("#")?ce=B(ce):{path:ce},ce.params={}),Xe({query:j.query,hash:j.hash,params:ce.path!=null?{}:j.params},ce)}}function x(j,he){const se=u=U(j),ce=c.value,De=j.state,Je=j.force,b=j.replace===!0,P=ie(se);if(P)return x(Xe(B(P),{state:typeof P=="object"?Xe({},De,P.state):De,force:Je,replace:b}),he||se);const M=se;M.redirectedFrom=he;let W;return!Je&&RT(r,ce,se)&&(W=po(16,{to:M,from:ce}),on(ce,ce,!0,!1)),(W?Promise.resolve(W):R(M,ce)).catch(z=>Tr(z)?Tr(z,2)?z:hn(z):Oe(z,M,ce)).then(z=>{if(z){if(Tr(z,2))return x(Xe({replace:b},B(z.to),{state:typeof z.to=="object"?Xe({},De,z.to.state):De,force:Je}),he||M)}else z=S(M,ce,!0,b,De);return w(M,ce,z),z})}function E(j,he){const se=L(j,he);return se?Promise.reject(se):Promise.resolve()}function A(j){const he=On.values().next().value;return he&&typeof he.runWithContext=="function"?he.runWithContext(j):j()}function R(j,he){let se;const[ce,De,Je]=pA(j,he);se=Md(ce.reverse(),"beforeRouteLeave",j,he);for(const P of ce)P.leaveGuards.forEach(M=>{se.push(ls(M,j,he))});const b=E.bind(null,j,he);return se.push(b),Ot(se).then(()=>{se=[];for(const P of i.list())se.push(ls(P,j,he));return se.push(b),Ot(se)}).then(()=>{se=Md(De,"beforeRouteUpdate",j,he);for(const P of De)P.updateGuards.forEach(M=>{se.push(ls(M,j,he))});return se.push(b),Ot(se)}).then(()=>{se=[];for(const P of Je)if(P.beforeEnter)if(rr(P.beforeEnter))for(const M of P.beforeEnter)se.push(ls(M,j,he));else se.push(ls(P.beforeEnter,j,he));return se.push(b),Ot(se)}).then(()=>(j.matched.forEach(P=>P.enterCallbacks={}),se=Md(Je,"beforeRouteEnter",j,he,A),se.push(b),Ot(se))).then(()=>{se=[];for(const P of o.list())se.push(ls(P,j,he));return se.push(b),Ot(se)}).catch(P=>Tr(P,8)?P:Promise.reject(P))}function w(j,he,se){a.list().forEach(ce=>A(()=>ce(j,he,se)))}function S(j,he,se,ce,De){const Je=L(j,he);if(Je)return Je;const b=he===ts,P=Hi?history.state:{};se&&(ce||b?s.replace(j.fullPath,Xe({scroll:b&&P&&P.scroll},De)):s.push(j.fullPath,De)),c.value=j,on(j,he,se,b),hn()}let I;function Ne(){I||(I=s.listen((j,he,se)=>{if(!En.listening)return;const ce=U(j),De=ie(ce);if(De){x(Xe(De,{replace:!0,force:!0}),ce).catch(Na);return}u=ce;const Je=c.value;Hi&&LT(Fm(Je.fullPath,se.delta),Cu()),R(ce,Je).catch(b=>Tr(b,12)?b:Tr(b,2)?(x(Xe(B(b.to),{force:!0}),ce).then(P=>{Tr(P,20)&&!se.delta&&se.type===Qa.pop&&s.go(-1,!1)}).catch(Na),Promise.reject()):(se.delta&&s.go(-se.delta,!1),Oe(b,ce,Je))).then(b=>{b=b||S(ce,Je,!1),b&&(se.delta&&!Tr(b,8)?s.go(-se.delta,!1):se.type===Qa.pop&&Tr(b,20)&&s.go(-1,!1)),w(ce,Je,b)}).catch(Na)}))}let nt=da(),Ue=da(),$e;function Oe(j,he,se){hn(j);const ce=Ue.list();return ce.length?ce.forEach(De=>De(j,he,se)):console.error(j),Promise.reject(j)}function Ht(){return $e&&c.value!==ts?Promise.resolve():new Promise((j,he)=>{nt.add([j,he])})}function hn(j){return $e||($e=!j,Ne(),nt.list().forEach(([he,se])=>j?se(j):he()),nt.reset()),j}function on(j,he,se,ce){const{scrollBehavior:De}=n;if(!Hi||!De)return Promise.resolve();const Je=!se&&FT(Fm(j.fullPath,0))||(ce||!se)&&history.state&&history.state.scroll||null;return Es().then(()=>De(j,he,Je)).then(b=>b&&MT(b)).catch(b=>Oe(b,j,he))}const ot=j=>s.go(j);let rt;const On=new Set,En={currentRoute:c,listening:!0,addRoute:_,removeRoute:D,clearRoutes:e.clearRoutes,hasRoute:C,getRoutes:T,resolve:U,options:n,push:O,replace:q,go:ot,back:()=>ot(-1),forward:()=>ot(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Ue.add,isReady:Ht,install(j){const he=this;j.component("RouterLink",lA),j.component("RouterView",hA),j.config.globalProperties.$router=he,Object.defineProperty(j.config.globalProperties,"$route",{enumerable:!0,get:()=>to(c)}),Hi&&!rt&&c.value===ts&&(rt=!0,O(s.location).catch(De=>{}));const se={};for(const De in ts)Object.defineProperty(se,De,{get:()=>c.value[De],enumerable:!0});j.provide(ku,he),j.provide(pf,hy(se)),j.provide(gh,c);const ce=j.unmount;On.add(j),j.unmount=function(){On.delete(j),On.size<1&&(u=ts,I&&I(),I=null,c.value=ts,rt=!1,$e=!1),ce()}}};function Ot(j){return j.reduce((he,se)=>he.then(()=>A(se)),Promise.resolve())}return En}function pA(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(u=>fo(u,a))?r.push(a):t.push(a));const c=n.matched[o];c&&(e.matched.find(u=>fo(u,c))||s.push(c))}return[t,r,s]}function Du(){return tr(ku)}function lv(n){return tr(pf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},mA=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},uv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,c=s+2<n.length,u=c?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let g=(a&15)<<2|u>>6,_=u&63;c||(_=64,o||(g=64)),r.push(t[d],t[f],t[g],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(cv(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||u==null||f==null)throw new gA;const g=i<<2|a>>4;if(r.push(g),u!==64){const _=a<<4&240|u>>2;if(r.push(_),f!==64){const D=u<<6&192|f;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _A=function(n){const e=cv(n);return uv.encodeByteArray(e,!0)},Jc=function(n){return _A(n).replace(/\./g,"")},dv=function(n){try{return uv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=()=>yA().__FIREBASE_DEFAULTS__,wA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},bA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&dv(n[1]);return e&&JSON.parse(e)},Vu=()=>{try{return vA()||wA()||bA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},hv=n=>{var e,t;return(t=(e=Vu())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},IA=n=>{const e=hv(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},fv=()=>{var n;return(n=Vu())===null||n===void 0?void 0:n.config},pv=n=>{var e;return(e=Vu())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Jc(JSON.stringify(t)),Jc(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yt())}function xA(){var n;const e=(n=Vu())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function PA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function SA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function RA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function CA(){const n=Yt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mv(){return!xA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gv(){try{return typeof indexedDB=="object"}catch{return!1}}function kA(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="FirebaseError";class qr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=DA,Object.setPrototypeOf(this,qr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vl.prototype.create)}}class vl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?VA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new qr(s,a,r)}}function VA(n,e){return n.replace(NA,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const NA=/\{\$([^}]+)}/g;function OA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function As(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Zm(i)&&Zm(o)){if(!As(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Zm(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function wa(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ba(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function MA(n,e){const t=new LA(n,e);return t.subscribe.bind(t)}class LA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");FA(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Ld),s.error===void 0&&(s.error=Ld),s.complete===void 0&&(s.complete=Ld);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ld(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n){return n&&n._delegate?n._delegate:n}class di{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new EA;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($A(e))try{this.getOrInitializeService({instanceIdentifier:Xs})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xs){return this.instances.has(e)}getOptions(e=Xs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:BA(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xs){return this.component?this.component.multipleInstances?e:Xs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function BA(n){return n===Xs?void 0:n}function $A(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new UA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(qe||(qe={}));const qA={debug:qe.DEBUG,verbose:qe.VERBOSE,info:qe.INFO,warn:qe.WARN,error:qe.ERROR,silent:qe.SILENT},zA=qe.INFO,GA={[qe.DEBUG]:"log",[qe.VERBOSE]:"log",[qe.INFO]:"info",[qe.WARN]:"warn",[qe.ERROR]:"error"},KA=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=GA[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mf{constructor(e){this.name=e,this._logLevel=zA,this._logHandler=KA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qe.DEBUG,...e),this._logHandler(this,qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qe.VERBOSE,...e),this._logHandler(this,qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qe.INFO,...e),this._logHandler(this,qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qe.WARN,...e),this._logHandler(this,qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qe.ERROR,...e),this._logHandler(this,qe.ERROR,...e)}}const HA=(n,e)=>e.some(t=>n instanceof t);let eg,tg;function WA(){return eg||(eg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QA(){return tg||(tg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _v=new WeakMap,_h=new WeakMap,yv=new WeakMap,Fd=new WeakMap,gf=new WeakMap;function JA(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(vs(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&_v.set(t,n)}).catch(()=>{}),gf.set(e,n),e}function YA(n){if(_h.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});_h.set(n,e)}let yh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _h.get(n);if(e==="objectStoreNames")return n.objectStoreNames||yv.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return vs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function XA(n){yh=n(yh)}function ZA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ud(this),e,...t);return yv.set(r,e.sort?e.sort():[e]),vs(r)}:QA().includes(n)?function(...e){return n.apply(Ud(this),e),vs(_v.get(this))}:function(...e){return vs(n.apply(Ud(this),e))}}function ex(n){return typeof n=="function"?ZA(n):(n instanceof IDBTransaction&&YA(n),HA(n,WA())?new Proxy(n,yh):n)}function vs(n){if(n instanceof IDBRequest)return JA(n);if(Fd.has(n))return Fd.get(n);const e=ex(n);return e!==n&&(Fd.set(n,e),gf.set(e,n)),e}const Ud=n=>gf.get(n);function tx(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=vs(o);return r&&o.addEventListener("upgradeneeded",c=>{r(vs(o.result),c.oldVersion,c.newVersion,vs(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const nx=["get","getKey","getAll","getAllKeys","count"],rx=["put","add","delete","clear"],Bd=new Map;function ng(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bd.get(e))return Bd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=rx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||nx.includes(t)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),s&&c.done]))[0]};return Bd.set(e,i),i}XA(n=>({...n,get:(e,t,r)=>ng(e,t)||n.get(e,t,r),has:(e,t)=>!!ng(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ix(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ix(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const vh="@firebase/app",rg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr=new mf("@firebase/app"),ox="@firebase/app-compat",ax="@firebase/analytics-compat",lx="@firebase/analytics",cx="@firebase/app-check-compat",ux="@firebase/app-check",dx="@firebase/auth",hx="@firebase/auth-compat",fx="@firebase/database",px="@firebase/data-connect",mx="@firebase/database-compat",gx="@firebase/functions",_x="@firebase/functions-compat",yx="@firebase/installations",vx="@firebase/installations-compat",wx="@firebase/messaging",bx="@firebase/messaging-compat",Ix="@firebase/performance",Ex="@firebase/performance-compat",Tx="@firebase/remote-config",Ax="@firebase/remote-config-compat",xx="@firebase/storage",Px="@firebase/storage-compat",Sx="@firebase/firestore",Rx="@firebase/vertexai-preview",Cx="@firebase/firestore-compat",kx="firebase",Dx="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc="[DEFAULT]",Vx={[vh]:"fire-core",[ox]:"fire-core-compat",[lx]:"fire-analytics",[ax]:"fire-analytics-compat",[ux]:"fire-app-check",[cx]:"fire-app-check-compat",[dx]:"fire-auth",[hx]:"fire-auth-compat",[fx]:"fire-rtdb",[px]:"fire-data-connect",[mx]:"fire-rtdb-compat",[gx]:"fire-fn",[_x]:"fire-fn-compat",[yx]:"fire-iid",[vx]:"fire-iid-compat",[wx]:"fire-fcm",[bx]:"fire-fcm-compat",[Ix]:"fire-perf",[Ex]:"fire-perf-compat",[Tx]:"fire-rc",[Ax]:"fire-rc-compat",[xx]:"fire-gcs",[Px]:"fire-gcs-compat",[Sx]:"fire-fst",[Cx]:"fire-fst-compat",[Rx]:"fire-vertex","fire-js":"fire-js",[kx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Map,Nx=new Map,wh=new Map;function sg(n,e){try{n.container.addComponent(e)}catch(t){Mr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function mo(n){const e=n.name;if(wh.has(e))return Mr.debug(`There were multiple attempts to register component ${e}.`),!1;wh.set(e,n);for(const t of Xc.values())sg(t,n);for(const t of Nx.values())sg(t,n);return!0}function wl(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ox(n,e,t=Yc){wl(n,e).clearInstance(t)}function Ft(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ws=new vl("app","Firebase",Mx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ws.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo=Dx;function vv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Yc,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw ws.create("bad-app-name",{appName:String(s)});if(t||(t=fv()),!t)throw ws.create("no-options");const i=Xc.get(s);if(i){if(As(t,i.options)&&As(r,i.config))return i;throw ws.create("duplicate-app",{appName:s})}const o=new jA(s);for(const c of wh.values())o.addComponent(c);const a=new Lx(t,r,o);return Xc.set(s,a),a}function wv(n=Yc){const e=Xc.get(n);if(!e&&n===Yc&&fv())return vv();if(!e)throw ws.create("no-app",{appName:n});return e}function bs(n,e,t){var r;let s=(r=Vx[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Mr.warn(a.join(" "));return}mo(new di(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="firebase-heartbeat-database",Ux=1,Ja="firebase-heartbeat-store";let $d=null;function bv(){return $d||($d=tx(Fx,Ux,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ja)}catch(t){console.warn(t)}}}}).catch(n=>{throw ws.create("idb-open",{originalErrorMessage:n.message})})),$d}async function Bx(n){try{const t=(await bv()).transaction(Ja),r=await t.objectStore(Ja).get(Iv(n));return await t.done,r}catch(e){if(e instanceof qr)Mr.warn(e.message);else{const t=ws.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Mr.warn(t.message)}}}async function ig(n,e){try{const r=(await bv()).transaction(Ja,"readwrite");await r.objectStore(Ja).put(e,Iv(n)),await r.done}catch(t){if(t instanceof qr)Mr.warn(t.message);else{const r=ws.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Mr.warn(r.message)}}}function Iv(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=1024,jx=30*24*60*60*1e3;class qx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Gx(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=og();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=jx}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Mr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=og(),{heartbeatsToSend:r,unsentEntries:s}=zx(this._heartbeatsCache.heartbeats),i=Jc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Mr.warn(t),""}}}function og(){return new Date().toISOString().substring(0,10)}function zx(n,e=$x){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),ag(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),ag(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Gx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gv()?kA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Bx(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return ig(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return ig(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ag(n){return Jc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(n){mo(new di("platform-logger",e=>new sx(e),"PRIVATE")),mo(new di("heartbeat",e=>new qx(e),"PRIVATE")),bs(vh,rg,n),bs(vh,rg,"esm2017"),bs("fire-js","")}Kx("");var Hx="firebase",Wx="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bs(Hx,Wx,"app");var lg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var li,Ev;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,E){function A(){}A.prototype=E.prototype,x.D=E.prototype,x.prototype=new A,x.prototype.constructor=x,x.C=function(R,w,S){for(var I=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)I[Ne-2]=arguments[Ne];return E.prototype[w].apply(R,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,E,A){A||(A=0);var R=Array(16);if(typeof E=="string")for(var w=0;16>w;++w)R[w]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(w=0;16>w;++w)R[w]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=x.g[0],A=x.g[1],w=x.g[2];var S=x.g[3],I=E+(S^A&(w^S))+R[0]+3614090360&4294967295;E=A+(I<<7&4294967295|I>>>25),I=S+(w^E&(A^w))+R[1]+3905402710&4294967295,S=E+(I<<12&4294967295|I>>>20),I=w+(A^S&(E^A))+R[2]+606105819&4294967295,w=S+(I<<17&4294967295|I>>>15),I=A+(E^w&(S^E))+R[3]+3250441966&4294967295,A=w+(I<<22&4294967295|I>>>10),I=E+(S^A&(w^S))+R[4]+4118548399&4294967295,E=A+(I<<7&4294967295|I>>>25),I=S+(w^E&(A^w))+R[5]+1200080426&4294967295,S=E+(I<<12&4294967295|I>>>20),I=w+(A^S&(E^A))+R[6]+2821735955&4294967295,w=S+(I<<17&4294967295|I>>>15),I=A+(E^w&(S^E))+R[7]+4249261313&4294967295,A=w+(I<<22&4294967295|I>>>10),I=E+(S^A&(w^S))+R[8]+1770035416&4294967295,E=A+(I<<7&4294967295|I>>>25),I=S+(w^E&(A^w))+R[9]+2336552879&4294967295,S=E+(I<<12&4294967295|I>>>20),I=w+(A^S&(E^A))+R[10]+4294925233&4294967295,w=S+(I<<17&4294967295|I>>>15),I=A+(E^w&(S^E))+R[11]+2304563134&4294967295,A=w+(I<<22&4294967295|I>>>10),I=E+(S^A&(w^S))+R[12]+1804603682&4294967295,E=A+(I<<7&4294967295|I>>>25),I=S+(w^E&(A^w))+R[13]+4254626195&4294967295,S=E+(I<<12&4294967295|I>>>20),I=w+(A^S&(E^A))+R[14]+2792965006&4294967295,w=S+(I<<17&4294967295|I>>>15),I=A+(E^w&(S^E))+R[15]+1236535329&4294967295,A=w+(I<<22&4294967295|I>>>10),I=E+(w^S&(A^w))+R[1]+4129170786&4294967295,E=A+(I<<5&4294967295|I>>>27),I=S+(A^w&(E^A))+R[6]+3225465664&4294967295,S=E+(I<<9&4294967295|I>>>23),I=w+(E^A&(S^E))+R[11]+643717713&4294967295,w=S+(I<<14&4294967295|I>>>18),I=A+(S^E&(w^S))+R[0]+3921069994&4294967295,A=w+(I<<20&4294967295|I>>>12),I=E+(w^S&(A^w))+R[5]+3593408605&4294967295,E=A+(I<<5&4294967295|I>>>27),I=S+(A^w&(E^A))+R[10]+38016083&4294967295,S=E+(I<<9&4294967295|I>>>23),I=w+(E^A&(S^E))+R[15]+3634488961&4294967295,w=S+(I<<14&4294967295|I>>>18),I=A+(S^E&(w^S))+R[4]+3889429448&4294967295,A=w+(I<<20&4294967295|I>>>12),I=E+(w^S&(A^w))+R[9]+568446438&4294967295,E=A+(I<<5&4294967295|I>>>27),I=S+(A^w&(E^A))+R[14]+3275163606&4294967295,S=E+(I<<9&4294967295|I>>>23),I=w+(E^A&(S^E))+R[3]+4107603335&4294967295,w=S+(I<<14&4294967295|I>>>18),I=A+(S^E&(w^S))+R[8]+1163531501&4294967295,A=w+(I<<20&4294967295|I>>>12),I=E+(w^S&(A^w))+R[13]+2850285829&4294967295,E=A+(I<<5&4294967295|I>>>27),I=S+(A^w&(E^A))+R[2]+4243563512&4294967295,S=E+(I<<9&4294967295|I>>>23),I=w+(E^A&(S^E))+R[7]+1735328473&4294967295,w=S+(I<<14&4294967295|I>>>18),I=A+(S^E&(w^S))+R[12]+2368359562&4294967295,A=w+(I<<20&4294967295|I>>>12),I=E+(A^w^S)+R[5]+4294588738&4294967295,E=A+(I<<4&4294967295|I>>>28),I=S+(E^A^w)+R[8]+2272392833&4294967295,S=E+(I<<11&4294967295|I>>>21),I=w+(S^E^A)+R[11]+1839030562&4294967295,w=S+(I<<16&4294967295|I>>>16),I=A+(w^S^E)+R[14]+4259657740&4294967295,A=w+(I<<23&4294967295|I>>>9),I=E+(A^w^S)+R[1]+2763975236&4294967295,E=A+(I<<4&4294967295|I>>>28),I=S+(E^A^w)+R[4]+1272893353&4294967295,S=E+(I<<11&4294967295|I>>>21),I=w+(S^E^A)+R[7]+4139469664&4294967295,w=S+(I<<16&4294967295|I>>>16),I=A+(w^S^E)+R[10]+3200236656&4294967295,A=w+(I<<23&4294967295|I>>>9),I=E+(A^w^S)+R[13]+681279174&4294967295,E=A+(I<<4&4294967295|I>>>28),I=S+(E^A^w)+R[0]+3936430074&4294967295,S=E+(I<<11&4294967295|I>>>21),I=w+(S^E^A)+R[3]+3572445317&4294967295,w=S+(I<<16&4294967295|I>>>16),I=A+(w^S^E)+R[6]+76029189&4294967295,A=w+(I<<23&4294967295|I>>>9),I=E+(A^w^S)+R[9]+3654602809&4294967295,E=A+(I<<4&4294967295|I>>>28),I=S+(E^A^w)+R[12]+3873151461&4294967295,S=E+(I<<11&4294967295|I>>>21),I=w+(S^E^A)+R[15]+530742520&4294967295,w=S+(I<<16&4294967295|I>>>16),I=A+(w^S^E)+R[2]+3299628645&4294967295,A=w+(I<<23&4294967295|I>>>9),I=E+(w^(A|~S))+R[0]+4096336452&4294967295,E=A+(I<<6&4294967295|I>>>26),I=S+(A^(E|~w))+R[7]+1126891415&4294967295,S=E+(I<<10&4294967295|I>>>22),I=w+(E^(S|~A))+R[14]+2878612391&4294967295,w=S+(I<<15&4294967295|I>>>17),I=A+(S^(w|~E))+R[5]+4237533241&4294967295,A=w+(I<<21&4294967295|I>>>11),I=E+(w^(A|~S))+R[12]+1700485571&4294967295,E=A+(I<<6&4294967295|I>>>26),I=S+(A^(E|~w))+R[3]+2399980690&4294967295,S=E+(I<<10&4294967295|I>>>22),I=w+(E^(S|~A))+R[10]+4293915773&4294967295,w=S+(I<<15&4294967295|I>>>17),I=A+(S^(w|~E))+R[1]+2240044497&4294967295,A=w+(I<<21&4294967295|I>>>11),I=E+(w^(A|~S))+R[8]+1873313359&4294967295,E=A+(I<<6&4294967295|I>>>26),I=S+(A^(E|~w))+R[15]+4264355552&4294967295,S=E+(I<<10&4294967295|I>>>22),I=w+(E^(S|~A))+R[6]+2734768916&4294967295,w=S+(I<<15&4294967295|I>>>17),I=A+(S^(w|~E))+R[13]+1309151649&4294967295,A=w+(I<<21&4294967295|I>>>11),I=E+(w^(A|~S))+R[4]+4149444226&4294967295,E=A+(I<<6&4294967295|I>>>26),I=S+(A^(E|~w))+R[11]+3174756917&4294967295,S=E+(I<<10&4294967295|I>>>22),I=w+(E^(S|~A))+R[2]+718787259&4294967295,w=S+(I<<15&4294967295|I>>>17),I=A+(S^(w|~E))+R[9]+3951481745&4294967295,x.g[0]=x.g[0]+E&4294967295,x.g[1]=x.g[1]+(w+(I<<21&4294967295|I>>>11))&4294967295,x.g[2]=x.g[2]+w&4294967295,x.g[3]=x.g[3]+S&4294967295}r.prototype.u=function(x,E){E===void 0&&(E=x.length);for(var A=E-this.blockSize,R=this.B,w=this.h,S=0;S<E;){if(w==0)for(;S<=A;)s(this,x,S),S+=this.blockSize;if(typeof x=="string"){for(;S<E;)if(R[w++]=x.charCodeAt(S++),w==this.blockSize){s(this,R),w=0;break}}else for(;S<E;)if(R[w++]=x[S++],w==this.blockSize){s(this,R),w=0;break}}this.h=w,this.o+=E},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var E=1;E<x.length-8;++E)x[E]=0;var A=8*this.o;for(E=x.length-8;E<x.length;++E)x[E]=A&255,A/=256;for(this.u(x),x=Array(16),E=A=0;4>E;++E)for(var R=0;32>R;R+=8)x[A++]=this.g[E]>>>R&255;return x};function i(x,E){var A=a;return Object.prototype.hasOwnProperty.call(A,x)?A[x]:A[x]=E(x)}function o(x,E){this.h=E;for(var A=[],R=!0,w=x.length-1;0<=w;w--){var S=x[w]|0;R&&S==E||(A[w]=S,R=!1)}this.g=A}var a={};function c(x){return-128<=x&&128>x?i(x,function(E){return new o([E|0],0>E?-1:0)}):new o([x|0],0>x?-1:0)}function u(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return C(u(-x));for(var E=[],A=1,R=0;x>=A;R++)E[R]=x/A|0,A*=4294967296;return new o(E,0)}function d(x,E){if(x.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x.charAt(0)=="-")return C(d(x.substring(1),E));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=u(Math.pow(E,8)),R=f,w=0;w<x.length;w+=8){var S=Math.min(8,x.length-w),I=parseInt(x.substring(w,w+S),E);8>S?(S=u(Math.pow(E,S)),R=R.j(S).add(u(I))):(R=R.j(A),R=R.add(u(I)))}return R}var f=c(0),g=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(T(this))return-C(this).m();for(var x=0,E=1,A=0;A<this.g.length;A++){var R=this.i(A);x+=(0<=R?R:4294967296+R)*E,E*=4294967296}return x},n.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(D(this))return"0";if(T(this))return"-"+C(this).toString(x);for(var E=u(Math.pow(x,6)),A=this,R="";;){var w=O(A,E).g;A=U(A,w.j(E));var S=((0<A.g.length?A.g[0]:A.h)>>>0).toString(x);if(A=w,D(A))return S+R;for(;6>S.length;)S="0"+S;R=S+R}},n.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function D(x){if(x.h!=0)return!1;for(var E=0;E<x.g.length;E++)if(x.g[E]!=0)return!1;return!0}function T(x){return x.h==-1}n.l=function(x){return x=U(this,x),T(x)?-1:D(x)?0:1};function C(x){for(var E=x.g.length,A=[],R=0;R<E;R++)A[R]=~x.g[R];return new o(A,~x.h).add(g)}n.abs=function(){return T(this)?C(this):this},n.add=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],R=0,w=0;w<=E;w++){var S=R+(this.i(w)&65535)+(x.i(w)&65535),I=(S>>>16)+(this.i(w)>>>16)+(x.i(w)>>>16);R=I>>>16,S&=65535,I&=65535,A[w]=I<<16|S}return new o(A,A[A.length-1]&-2147483648?-1:0)};function U(x,E){return x.add(C(E))}n.j=function(x){if(D(this)||D(x))return f;if(T(this))return T(x)?C(this).j(C(x)):C(C(this).j(x));if(T(x))return C(this.j(C(x)));if(0>this.l(_)&&0>x.l(_))return u(this.m()*x.m());for(var E=this.g.length+x.g.length,A=[],R=0;R<2*E;R++)A[R]=0;for(R=0;R<this.g.length;R++)for(var w=0;w<x.g.length;w++){var S=this.i(R)>>>16,I=this.i(R)&65535,Ne=x.i(w)>>>16,nt=x.i(w)&65535;A[2*R+2*w]+=I*nt,B(A,2*R+2*w),A[2*R+2*w+1]+=S*nt,B(A,2*R+2*w+1),A[2*R+2*w+1]+=I*Ne,B(A,2*R+2*w+1),A[2*R+2*w+2]+=S*Ne,B(A,2*R+2*w+2)}for(R=0;R<E;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=E;R<2*E;R++)A[R]=0;return new o(A,0)};function B(x,E){for(;(x[E]&65535)!=x[E];)x[E+1]+=x[E]>>>16,x[E]&=65535,E++}function L(x,E){this.g=x,this.h=E}function O(x,E){if(D(E))throw Error("division by zero");if(D(x))return new L(f,f);if(T(x))return E=O(C(x),E),new L(C(E.g),C(E.h));if(T(E))return E=O(x,C(E)),new L(C(E.g),E.h);if(30<x.g.length){if(T(x)||T(E))throw Error("slowDivide_ only works with positive integers.");for(var A=g,R=E;0>=R.l(x);)A=q(A),R=q(R);var w=ie(A,1),S=ie(R,1);for(R=ie(R,2),A=ie(A,2);!D(R);){var I=S.add(R);0>=I.l(x)&&(w=w.add(A),S=I),R=ie(R,1),A=ie(A,1)}return E=U(x,w.j(E)),new L(w,E)}for(w=f;0<=x.l(E);){for(A=Math.max(1,Math.floor(x.m()/E.m())),R=Math.ceil(Math.log(A)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),S=u(A),I=S.j(E);T(I)||0<I.l(x);)A-=R,S=u(A),I=S.j(E);D(S)&&(S=g),w=w.add(S),x=U(x,I)}return new L(w,x)}n.A=function(x){return O(this,x).h},n.and=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],R=0;R<E;R++)A[R]=this.i(R)&x.i(R);return new o(A,this.h&x.h)},n.or=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],R=0;R<E;R++)A[R]=this.i(R)|x.i(R);return new o(A,this.h|x.h)},n.xor=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],R=0;R<E;R++)A[R]=this.i(R)^x.i(R);return new o(A,this.h^x.h)};function q(x){for(var E=x.g.length+1,A=[],R=0;R<E;R++)A[R]=x.i(R)<<1|x.i(R-1)>>>31;return new o(A,x.h)}function ie(x,E){var A=E>>5;E%=32;for(var R=x.g.length-A,w=[],S=0;S<R;S++)w[S]=0<E?x.i(S+A)>>>E|x.i(S+A+1)<<32-E:x.i(S+A);return new o(w,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ev=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,li=o}).apply(typeof lg<"u"?lg:typeof self<"u"?self:typeof window<"u"?window:{});var pc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Tv,Ia,Av,Sc,bh,xv,Pv,Sv;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof pc=="object"&&pc];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var V=l[y];if(!(V in p))break e;p=p[V]}l=l[l.length-1],y=p[l],h=h(y),h!=y&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,y=!1,V={next:function(){if(!y&&p<l.length){var $=p++;return{value:h($,l[$]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),l.apply(h,V)}}return function(){return l.apply(h,arguments)}}function g(l,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function _(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function D(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(y,V,$){for(var le=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)le[ct-2]=arguments[ct];return h.prototype[V].apply(y,le)}}function T(l){const h=l.length;if(0<h){const p=Array(h);for(let y=0;y<h;y++)p[y]=l[y];return p}return[]}function C(l,h){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(c(y)){const V=l.length||0,$=y.length||0;l.length=V+$;for(let le=0;le<$;le++)l[V+le]=y[le]}else l.push(y)}}class U{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function B(l){return/^[\s\xa0]*$/.test(l)}function L(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function O(l){return O[" "](l),l}O[" "]=function(){};var q=L().indexOf("Gecko")!=-1&&!(L().toLowerCase().indexOf("webkit")!=-1&&L().indexOf("Edge")==-1)&&!(L().indexOf("Trident")!=-1||L().indexOf("MSIE")!=-1)&&L().indexOf("Edge")==-1;function ie(l,h,p){for(const y in l)h.call(p,l[y],y,l)}function x(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function E(l){const h={};for(const p in l)h[p]=l[p];return h}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(l,h){let p,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(p in y)l[p]=y[p];for(let $=0;$<A.length;$++)p=A[$],Object.prototype.hasOwnProperty.call(y,p)&&(l[p]=y[p])}}function w(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function S(l){a.setTimeout(()=>{throw l},0)}function I(){var l=Ht;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class Ne{constructor(){this.h=this.g=null}add(h,p){const y=nt.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var nt=new U(()=>new Ue,l=>l.reset());class Ue{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let $e,Oe=!1,Ht=new Ne,hn=()=>{const l=a.Promise.resolve(void 0);$e=()=>{l.then(on)}};var on=()=>{for(var l;l=I();){try{l.h.call(l.g)}catch(p){S(p)}var h=nt;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}Oe=!1};function ot(){this.s=this.s,this.C=this.C}ot.prototype.s=!1,ot.prototype.ma=function(){this.s||(this.s=!0,this.N())},ot.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function rt(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}rt.prototype.h=function(){this.defaultPrevented=!0};var On=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function En(l,h){if(rt.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(q){e:{try{O(h.nodeName);var V=!0;break e}catch{}V=!1}V||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Ot[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&En.aa.h.call(this)}}D(En,rt);var Ot={2:"touch",3:"pen",4:"mouse"};En.prototype.h=function(){En.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),he=0;function se(l,h,p,y,V){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=V,this.key=++he,this.da=this.fa=!1}function ce(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function De(l){this.src=l,this.g={},this.h=0}De.prototype.add=function(l,h,p,y,V){var $=l.toString();l=this.g[$],l||(l=this.g[$]=[],this.h++);var le=b(l,h,y,V);return-1<le?(h=l[le],p||(h.fa=!1)):(h=new se(h,this.src,$,!!y,V),h.fa=p,l.push(h)),h};function Je(l,h){var p=h.type;if(p in l.g){var y=l.g[p],V=Array.prototype.indexOf.call(y,h,void 0),$;($=0<=V)&&Array.prototype.splice.call(y,V,1),$&&(ce(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function b(l,h,p,y){for(var V=0;V<l.length;++V){var $=l[V];if(!$.da&&$.listener==h&&$.capture==!!p&&$.ha==y)return V}return-1}var P="closure_lm_"+(1e6*Math.random()|0),M={};function W(l,h,p,y,V){if(y&&y.once)return ae(l,h,p,y,V);if(Array.isArray(h)){for(var $=0;$<h.length;$++)W(l,h[$],p,y,V);return null}return p=Te(p),l&&l[j]?l.K(h,p,u(y)?!!y.capture:!!y,V):z(l,h,p,!1,y,V)}function z(l,h,p,y,V,$){if(!h)throw Error("Invalid event type");var le=u(V)?!!V.capture:!!V,ct=ue(l);if(ct||(l[P]=ct=new De(l)),p=ct.add(h,p,y,le,$),p.proxy)return p;if(y=ee(),p.proxy=y,y.src=l,y.listener=p,l.addEventListener)On||(V=le),V===void 0&&(V=!1),l.addEventListener(h.toString(),y,V);else if(l.attachEvent)l.attachEvent(te(h.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function ee(){function l(p){return h.call(l.src,l.listener,p)}const h=be;return l}function ae(l,h,p,y,V){if(Array.isArray(h)){for(var $=0;$<h.length;$++)ae(l,h[$],p,y,V);return null}return p=Te(p),l&&l[j]?l.L(h,p,u(y)?!!y.capture:!!y,V):z(l,h,p,!0,y,V)}function H(l,h,p,y,V){if(Array.isArray(h))for(var $=0;$<h.length;$++)H(l,h[$],p,y,V);else y=u(y)?!!y.capture:!!y,p=Te(p),l&&l[j]?(l=l.i,h=String(h).toString(),h in l.g&&($=l.g[h],p=b($,p,y,V),-1<p&&(ce($[p]),Array.prototype.splice.call($,p,1),$.length==0&&(delete l.g[h],l.h--)))):l&&(l=ue(l))&&(h=l.g[h.toString()],l=-1,h&&(l=b(h,p,y,V)),(p=-1<l?h[l]:null)&&Z(p))}function Z(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[j])Je(h.i,l);else{var p=l.type,y=l.proxy;h.removeEventListener?h.removeEventListener(p,y,l.capture):h.detachEvent?h.detachEvent(te(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=ue(h))?(Je(p,l),p.h==0&&(p.src=null,h[P]=null)):ce(l)}}}function te(l){return l in M?M[l]:M[l]="on"+l}function be(l,h){if(l.da)l=!0;else{h=new En(h,this);var p=l.listener,y=l.ha||l.src;l.fa&&Z(l),l=p.call(y,h)}return l}function ue(l){return l=l[P],l instanceof De?l:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function Te(l){return typeof l=="function"?l:(l[me]||(l[me]=function(h){return l.handleEvent(h)}),l[me])}function Ie(){ot.call(this),this.i=new De(this),this.M=this,this.F=null}D(Ie,ot),Ie.prototype[j]=!0,Ie.prototype.removeEventListener=function(l,h,p,y){H(this,l,h,p,y)};function xe(l,h){var p,y=l.F;if(y)for(p=[];y;y=y.F)p.push(y);if(l=l.M,y=h.type||h,typeof h=="string")h=new rt(h,l);else if(h instanceof rt)h.target=h.target||l;else{var V=h;h=new rt(y,l),R(h,V)}if(V=!0,p)for(var $=p.length-1;0<=$;$--){var le=h.g=p[$];V=Me(le,y,!0,h)&&V}if(le=h.g=l,V=Me(le,y,!0,h)&&V,V=Me(le,y,!1,h)&&V,p)for($=0;$<p.length;$++)le=h.g=p[$],V=Me(le,y,!1,h)&&V}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],y=0;y<p.length;y++)ce(p[y]);delete l.g[h],l.h--}}this.F=null},Ie.prototype.K=function(l,h,p,y){return this.i.add(String(l),h,!1,p,y)},Ie.prototype.L=function(l,h,p,y){return this.i.add(String(l),h,!0,p,y)};function Me(l,h,p,y){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var V=!0,$=0;$<h.length;++$){var le=h[$];if(le&&!le.da&&le.capture==p){var ct=le.listener,an=le.ha||le.src;le.fa&&Je(l.i,le),V=ct.call(an,y)!==!1&&V}}return V&&!y.defaultPrevented}function wt(l,h,p){if(typeof l=="function")p&&(l=g(l,p));else if(l&&typeof l.handleEvent=="function")l=g(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function mt(l){l.g=wt(()=>{l.g=null,l.i&&(l.i=!1,mt(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Wt extends ot{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(l){ot.call(this),this.h=l,this.g={}}D(Mt,ot);var sr=[];function Bs(l){ie(l.g,function(h,p){this.g.hasOwnProperty(p)&&Z(h)},l),l.g={}}Mt.prototype.N=function(){Mt.aa.N.call(this),Bs(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qt=a.JSON.stringify,Ke=a.JSON.parse,at=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function xt(){}xt.prototype.h=null;function ht(l){return l.h||(l.h=l.i())}function ql(){}var Jr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ko(){rt.call(this,"d")}D(Ko,rt);function $s(){rt.call(this,"c")}D($s,rt);var Jt={},Ho=null;function ki(){return Ho=Ho||new Ie}Jt.La="serverreachability";function Wo(l){rt.call(this,Jt.La,l)}D(Wo,rt);function js(l){const h=ki();xe(h,new Wo(h))}Jt.STAT_EVENT="statevent";function Di(l,h){rt.call(this,Jt.STAT_EVENT,l),this.stat=h}D(Di,rt);function kt(l){const h=ki();xe(h,new Di(h,l))}Jt.Ma="timingevent";function Vi(l,h){rt.call(this,Jt.Ma,l),this.size=h}D(Vi,rt);function ir(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Yr(){this.g=!0}Yr.prototype.xa=function(){this.g=!1};function hd(l,h,p,y,V,$){l.info(function(){if(l.g)if($)for(var le="",ct=$.split("&"),an=0;an<ct.length;an++){var Qe=ct[an].split("=");if(1<Qe.length){var fn=Qe[0];Qe=Qe[1];var pn=fn.split("_");le=2<=pn.length&&pn[1]=="type"?le+(fn+"="+Qe+"&"):le+(fn+"=redacted&")}}else le=null;else le=$;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+h+`
`+p+`
`+le})}function fd(l,h,p,y,V,$,le){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+h+`
`+p+`
`+$+" "+le})}function yr(l,h,p,y){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Ni(l,p)+(y?" "+y:"")})}function zl(l,h){l.info(function(){return"TIMEOUT: "+h})}Yr.prototype.info=function(){};function Ni(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var y=p[l];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var $=V[0];if($!="noop"&&$!="stop"&&$!="close")for(var le=1;le<V.length;le++)V[le]=""}}}}return Qt(p)}catch{return h}}var vr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Qo;function Oi(){}D(Oi,xt),Oi.prototype.g=function(){return new XMLHttpRequest},Oi.prototype.i=function(){return{}},Qo=new Oi;function or(l,h,p,y){this.j=l,this.i=h,this.l=p,this.R=y||1,this.U=new Mt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gl}function Gl(){this.i=null,this.g="",this.h=!1}var Kl={},Jo={};function Xr(l,h,p){l.L=1,l.v=zs($n(h)),l.m=p,l.P=!0,Hl(l,null)}function Hl(l,h){l.F=Date.now(),Mi(l),l.A=$n(l.v);var p=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),bt(p.i,"t",y),l.C=0,p=l.j.J,l.h=new Gl,l.g=nm(l.j,p?h:null,!l.m),0<l.O&&(l.M=new Wt(g(l.Y,l,l.g),l.O)),h=l.U,p=l.g,y=l.ca;var V="readystatechange";Array.isArray(V)||(V&&(sr[0]=V.toString()),V=sr);for(var $=0;$<V.length;$++){var le=W(p,V[$],y||h.handleEvent,!1,h.h||h);if(!le)break;h.g[le.key]=le}h=l.H?E(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),js(),hd(l.i,l.u,l.A,l.l,l.R,l.m)}or.prototype.ca=function(l){l=l.target;const h=this.M;h&&Ir(l)==3?h.j():this.Y(l)},or.prototype.Y=function(l){try{if(l==this.g)e:{const pn=Ir(this.g);var h=this.g.Ba();const Ui=this.g.Z();if(!(3>pn)&&(pn!=3||this.g&&(this.h.h||this.g.oa()||Gp(this.g)))){this.J||pn!=4||h==7||(h==8||0>=Ui?js(3):js(2)),Xo(this);var p=this.g.Z();this.X=p;t:if(Wl(this)){var y=Gp(this.g);l="";var V=y.length,$=Ir(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wr(this),Zr(this);var le="";break t}this.h.i=new a.TextDecoder}for(h=0;h<V;h++)this.h.h=!0,l+=this.h.i.decode(y[h],{stream:!($&&h==V-1)});y.length=0,this.h.g+=l,this.C=0,le=this.h.g}else le=this.g.oa();if(this.o=p==200,fd(this.i,this.u,this.A,this.l,this.R,pn,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ct,an=this.g;if((ct=an.g?an.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(ct)){var Qe=ct;break t}}Qe=null}if(p=Qe)yr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zo(this,p);else{this.o=!1,this.s=3,kt(12),wr(this),Zr(this);break e}}if(this.P){p=!0;let Jn;for(;!this.J&&this.C<le.length;)if(Jn=pd(this,le),Jn==Jo){pn==4&&(this.s=4,kt(14),p=!1),yr(this.i,this.l,null,"[Incomplete Response]");break}else if(Jn==Kl){this.s=4,kt(15),yr(this.i,this.l,le,"[Invalid Chunk]"),p=!1;break}else yr(this.i,this.l,Jn,null),Zo(this,Jn);if(Wl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pn!=4||le.length!=0||this.h.h||(this.s=1,kt(16),p=!1),this.o=this.o&&p,!p)yr(this.i,this.l,le,"[Invalid Chunked Response]"),wr(this),Zr(this);else if(0<le.length&&!this.W){this.W=!0;var fn=this.j;fn.g==this&&fn.ba&&!fn.M&&(fn.j.info("Great, no buffering proxy detected. Bytes received: "+le.length),bd(fn),fn.M=!0,kt(11))}}else yr(this.i,this.l,le,null),Zo(this,le);pn==4&&wr(this),this.o&&!this.J&&(pn==4?Xp(this.j,this):(this.o=!1,Mi(this)))}else qb(this.g),p==400&&0<le.indexOf("Unknown SID")?(this.s=3,kt(12)):(this.s=0,kt(13)),wr(this),Zr(this)}}}catch{}finally{}};function Wl(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function pd(l,h){var p=l.C,y=h.indexOf(`
`,p);return y==-1?Jo:(p=Number(h.substring(p,y)),isNaN(p)?Kl:(y+=1,y+p>h.length?Jo:(h=h.slice(y,y+p),l.C=y+p,h)))}or.prototype.cancel=function(){this.J=!0,wr(this)};function Mi(l){l.S=Date.now()+l.I,Yo(l,l.I)}function Yo(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ir(g(l.ba,l),h)}function Xo(l){l.B&&(a.clearTimeout(l.B),l.B=null)}or.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(zl(this.i,this.A),this.L!=2&&(js(),kt(17)),wr(this),this.s=2,Zr(this)):Yo(this,this.S-l)};function Zr(l){l.j.G==0||l.J||Xp(l.j,l)}function wr(l){Xo(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Bs(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Zo(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||ea(p.h,l))){if(!l.K&&ea(p.h,l)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)lc(p),oc(p);else break e;wd(p),kt(18)}}else p.za=V[1],0<p.za-p.T&&37500>V[2]&&p.F&&p.v==0&&!p.C&&(p.C=ir(g(p.Za,p),6e3));if(1>=Jl(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Hs(p,11)}else if((l.K||p.g==l)&&lc(p),!B(h))for(V=p.Da.g.parse(h),h=0;h<V.length;h++){let Qe=V[h];if(p.T=Qe[0],Qe=Qe[1],p.G==2)if(Qe[0]=="c"){p.K=Qe[1],p.ia=Qe[2];const fn=Qe[3];fn!=null&&(p.la=fn,p.j.info("VER="+p.la));const pn=Qe[4];pn!=null&&(p.Aa=pn,p.j.info("SVER="+p.Aa));const Ui=Qe[5];Ui!=null&&typeof Ui=="number"&&0<Ui&&(y=1.5*Ui,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const Jn=l.g;if(Jn){const uc=Jn.g?Jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(uc){var $=y.h;$.g||uc.indexOf("spdy")==-1&&uc.indexOf("quic")==-1&&uc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(ta($,$.h),$.h=null))}if(y.D){const Id=Jn.g?Jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Id&&(y.ya=Id,st(y.I,y.D,Id))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var le=l;if(y.qa=tm(y,y.J?y.ia:null,y.W),le.K){Yl(y.h,le);var ct=le,an=y.L;an&&(ct.I=an),ct.B&&(Xo(ct),Mi(ct)),y.g=le}else Jp(y);0<p.i.length&&ac(p)}else Qe[0]!="stop"&&Qe[0]!="close"||Hs(p,7);else p.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?Hs(p,7):vd(p):Qe[0]!="noop"&&p.l&&p.l.ta(Qe),p.v=0)}}js(4)}catch{}}var md=class{constructor(l,h){this.g=l,this.map=h}};function Ql(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Jl(l){return l.h?1:l.g?l.g.size:0}function ea(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function ta(l,h){l.g?l.g.add(h):l.h=h}function Yl(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Ql.prototype.cancel=function(){if(this.i=Xl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Xl(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return T(l.i)}function Zl(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,y=0;y<p;y++)h.push(l[y]);return h}h=[],p=0;for(y in l)h[p++]=l[y];return h}function gd(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const y in l)h[p++]=y;return h}}}function ec(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=gd(l),y=Zl(l),V=y.length,$=0;$<V;$++)h.call(void 0,y[$],p&&p[$],l)}var tc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function na(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var y=l[p].indexOf("="),V=null;if(0<=y){var $=l[p].substring(0,y);V=l[p].substring(y+1)}else $=l[p];h($,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function br(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof br){this.h=l.h,es(this,l.j),this.o=l.o,this.g=l.g,Li(this,l.s),this.l=l.l;var h=l.i,p=new Pe;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),nc(this,p),this.m=l.m}else l&&(h=String(l).match(tc))?(this.h=!1,es(this,h[1]||"",!0),this.o=Gs(h[2]||""),this.g=Gs(h[3]||"",!0),Li(this,h[4]),this.l=Gs(h[5]||"",!0),nc(this,h[6]||"",!0),this.m=Gs(h[7]||"")):(this.h=!1,this.i=new Pe(null,this.h))}br.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Ks(h,v,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Ks(h,v,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(Ks(p,p.charAt(0)=="/"?_e:K,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",Ks(p,Le)),l.join("")};function $n(l){return new br(l)}function es(l,h,p){l.j=p?Gs(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Li(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function nc(l,h,p){h instanceof Pe?(l.i=h,re(l.i,l.h)):(p||(h=Ks(h,Ee)),l.i=new Pe(h,l.h))}function st(l,h,p){l.i.set(h,p)}function zs(l){return st(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Gs(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ks(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,k),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function k(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var v=/[#\/\?@]/g,K=/[#\?:]/g,_e=/[#\?]/g,Ee=/[#\?@]/g,Le=/#/g;function Pe(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Fe(l){l.g||(l.g=new Map,l.h=0,l.i&&na(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Pe.prototype,n.add=function(l,h){Fe(this),this.i=null,l=Ye(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function je(l,h){Fe(l),h=Ye(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function $t(l,h){return Fe(l),h=Ye(l,h),l.g.has(h)}n.forEach=function(l,h){Fe(this),this.g.forEach(function(p,y){p.forEach(function(V){l.call(h,V,y,this)},this)},this)},n.na=function(){Fe(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){const V=l[y];for(let $=0;$<V.length;$++)p.push(h[y])}return p},n.V=function(l){Fe(this);let h=[];if(typeof l=="string")$t(this,l)&&(h=h.concat(this.g.get(Ye(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Fe(this),this.i=null,l=Ye(this,l),$t(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function bt(l,h,p){je(l,h),0<p.length&&(l.i=null,l.g.set(Ye(l,h),T(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];const $=encodeURIComponent(String(y)),le=this.V(y);for(y=0;y<le.length;y++){var V=$;le[y]!==""&&(V+="="+encodeURIComponent(String(le[y]))),l.push(V)}}return this.i=l.join("&")};function Ye(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function re(l,h){h&&!l.j&&(Fe(l),l.i=null,l.g.forEach(function(p,y){var V=y.toLowerCase();y!=V&&(je(this,y),bt(this,V,p))},l)),l.j=h}function He(l,h){const p=new Yr;if(a.Image){const y=new Image;y.onload=_(jn,p,"TestLoadImage: loaded",!0,h,y),y.onerror=_(jn,p,"TestLoadImage: error",!1,h,y),y.onabort=_(jn,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=_(jn,p,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else h(!1)}function Qn(l,h){const p=new Yr,y=new AbortController,V=setTimeout(()=>{y.abort(),jn(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:y.signal}).then($=>{clearTimeout(V),$.ok?jn(p,"TestPingServer: ok",!0,h):jn(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(V),jn(p,"TestPingServer: error",!1,h)})}function jn(l,h,p,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(p)}catch{}}function ra(){this.g=new at}function _d(l,h,p){const y=p||"";try{ec(l,function(V,$){let le=V;u(V)&&(le=Qt(V)),h.push(y+$+"="+encodeURIComponent(le))})}catch(V){throw h.push(y+"type="+encodeURIComponent("_badmap")),V}}function rc(l){this.l=l.Ub||null,this.j=l.eb||!1}D(rc,xt),rc.prototype.g=function(){return new sc(this.l,this.j)},rc.prototype.i=function(l){return function(){return l}}({});function sc(l,h){Ie.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(sc,Ie),n=sc.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ia(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,sa(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ia(this)),this.g&&(this.readyState=3,ia(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Up(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Up(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?sa(this):ia(this),this.readyState==3&&Up(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,sa(this))},n.Qa=function(l){this.g&&(this.response=l,sa(this))},n.ga=function(){this.g&&sa(this)};function sa(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ia(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function ia(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(sc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Bp(l){let h="";return ie(l,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function yd(l,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Bp(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):st(l,h,p))}function Dt(l){Ie.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(Dt,Ie);var $b=/^https?$/i,jb=["POST","PUT"];n=Dt.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Qo.g(),this.v=this.o?ht(this.o):ht(Qo),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch($){$p(this,$);return}if(l=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)p.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const $ of y.keys())p.set($,y.get($));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find($=>$.toLowerCase()=="content-type"),V=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(jb,h,void 0))||y||V||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,le]of p)this.g.setRequestHeader($,le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zp(this),this.u=!0,this.g.send(l),this.u=!1}catch($){$p(this,$)}};function $p(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,jp(l),ic(l)}function jp(l){l.A||(l.A=!0,xe(l,"complete"),xe(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,xe(this,"complete"),xe(this,"abort"),ic(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ic(this,!0)),Dt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?qp(this):this.bb())},n.bb=function(){qp(this)};function qp(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Ir(l)!=4||l.Z()!=2)){if(l.u&&Ir(l)==4)wt(l.Ea,0,l);else if(xe(l,"readystatechange"),Ir(l)==4){l.h=!1;try{const le=l.Z();e:switch(le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=le===0){var V=String(l.D).match(tc)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),y=!$b.test(V?V.toLowerCase():"")}p=y}if(p)xe(l,"complete"),xe(l,"success");else{l.m=6;try{var $=2<Ir(l)?l.g.statusText:""}catch{$=""}l.l=$+" ["+l.Z()+"]",jp(l)}}finally{ic(l)}}}}function ic(l,h){if(l.g){zp(l);const p=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||xe(l,"ready");try{p.onreadystatechange=y}catch{}}}function zp(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function Ir(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<Ir(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Ke(h)}};function Gp(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function qb(l){const h={};l=(l.g&&2<=Ir(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(B(l[y]))continue;var p=w(l[y]);const V=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const $=h[V]||[];h[V]=$,$.push(p)}x(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function oa(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Kp(l){this.Aa=0,this.i=[],this.j=new Yr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=oa("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=oa("baseRetryDelayMs",5e3,l),this.cb=oa("retryDelaySeedMs",1e4,l),this.Wa=oa("forwardChannelMaxRetries",2,l),this.wa=oa("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ql(l&&l.concurrentRequestLimit),this.Da=new ra,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Kp.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,y){kt(0),this.W=l,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=tm(this,null,this.W),ac(this)};function vd(l){if(Hp(l),l.G==3){var h=l.U++,p=$n(l.I);if(st(p,"SID",l.K),st(p,"RID",h),st(p,"TYPE","terminate"),aa(l,p),h=new or(l,l.j,h),h.L=2,h.v=zs($n(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=nm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Mi(h)}em(l)}function oc(l){l.g&&(bd(l),l.g.cancel(),l.g=null)}function Hp(l){oc(l),l.u&&(a.clearTimeout(l.u),l.u=null),lc(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function ac(l){if(!Wn(l.h)&&!l.s){l.s=!0;var h=l.Ga;$e||hn(),Oe||($e(),Oe=!0),Ht.add(h,l),l.B=0}}function zb(l,h){return Jl(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ir(g(l.Ga,l,h),Zp(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const V=new or(this,this.j,l);let $=this.o;if(this.S&&($?($=E($),R($,this.S)):$=this.S),this.m!==null||this.O||(V.H=$,$=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Qp(this,V,h),p=$n(this.I),st(p,"RID",l),st(p,"CVER",22),this.D&&st(p,"X-HTTP-Session-Id",this.D),aa(this,p),$&&(this.O?h="headers="+encodeURIComponent(String(Bp($)))+"&"+h:this.m&&yd(p,this.m,$)),ta(this.h,V),this.Ua&&st(p,"TYPE","init"),this.P?(st(p,"$req",h),st(p,"SID","null"),V.T=!0,Xr(V,p,null)):Xr(V,p,h),this.G=2}}else this.G==3&&(l?Wp(this,l):this.i.length==0||Wn(this.h)||Wp(this))};function Wp(l,h){var p;h?p=h.l:p=l.U++;const y=$n(l.I);st(y,"SID",l.K),st(y,"RID",p),st(y,"AID",l.T),aa(l,y),l.m&&l.o&&yd(y,l.m,l.o),p=new or(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Qp(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),ta(l.h,p),Xr(p,y,h)}function aa(l,h){l.H&&ie(l.H,function(p,y){st(h,y,p)}),l.l&&ec({},function(p,y){st(h,y,p)})}function Qp(l,h,p){p=Math.min(l.i.length,p);var y=l.l?g(l.l.Na,l.l,l):null;e:{var V=l.i;let $=-1;for(;;){const le=["count="+p];$==-1?0<p?($=V[0].g,le.push("ofs="+$)):$=0:le.push("ofs="+$);let ct=!0;for(let an=0;an<p;an++){let Qe=V[an].g;const fn=V[an].map;if(Qe-=$,0>Qe)$=Math.max(0,V[an].g-100),ct=!1;else try{_d(fn,le,"req"+Qe+"_")}catch{y&&y(fn)}}if(ct){y=le.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,y}function Jp(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;$e||hn(),Oe||($e(),Oe=!0),Ht.add(h,l),l.v=0}}function wd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ir(g(l.Fa,l),Zp(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,Yp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ir(g(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,kt(10),oc(this),Yp(this))};function bd(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Yp(l){l.g=new or(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=$n(l.qa);st(h,"RID","rpc"),st(h,"SID",l.K),st(h,"AID",l.T),st(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&st(h,"TO",l.ja),st(h,"TYPE","xmlhttp"),aa(l,h),l.m&&l.o&&yd(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=zs($n(h)),p.m=null,p.P=!0,Hl(p,l)}n.Za=function(){this.C!=null&&(this.C=null,oc(this),wd(this),kt(19))};function lc(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Xp(l,h){var p=null;if(l.g==h){lc(l),bd(l),l.g=null;var y=2}else if(ea(l.h,h))p=h.D,Yl(l.h,h),y=1;else return;if(l.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var V=l.B;y=ki(),xe(y,new Vi(y,p)),ac(l)}else Jp(l);else if(V=h.s,V==3||V==0&&0<h.X||!(y==1&&zb(l,h)||y==2&&wd(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),V){case 1:Hs(l,5);break;case 4:Hs(l,10);break;case 3:Hs(l,6);break;default:Hs(l,2)}}}function Zp(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Hs(l,h){if(l.j.info("Error code "+h),h==2){var p=g(l.fb,l),y=l.Xa;const V=!y;y=new br(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||es(y,"https"),zs(y),V?He(y.toString(),p):Qn(y.toString(),p)}else kt(2);l.G=0,l.l&&l.l.sa(h),em(l),Hp(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),kt(2)):(this.j.info("Failed to ping google.com"),kt(1))};function em(l){if(l.G=0,l.ka=[],l.l){const h=Xl(l.h);(h.length!=0||l.i.length!=0)&&(C(l.ka,h),C(l.ka,l.i),l.h.i.length=0,T(l.i),l.i.length=0),l.l.ra()}}function tm(l,h,p){var y=p instanceof br?$n(p):new br(p);if(y.g!="")h&&(y.g=h+"."+y.g),Li(y,y.s);else{var V=a.location;y=V.protocol,h=h?h+"."+V.hostname:V.hostname,V=+V.port;var $=new br(null);y&&es($,y),h&&($.g=h),V&&Li($,V),p&&($.l=p),y=$}return p=l.D,h=l.ya,p&&h&&st(y,p,h),st(y,"VER",l.la),aa(l,y),y}function nm(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new Dt(new rc({eb:p})):new Dt(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rm(){}n=rm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function cc(){}cc.prototype.g=function(l,h){return new Mn(l,h)};function Mn(l,h){Ie.call(this),this.g=new Kp(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!B(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!B(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Fi(this)}D(Mn,Ie),Mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mn.prototype.close=function(){vd(this.g)},Mn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Qt(l),l=p);h.i.push(new md(h.Ya++,l)),h.G==3&&ac(h)},Mn.prototype.N=function(){this.g.l=null,delete this.j,vd(this.g),delete this.g,Mn.aa.N.call(this)};function sm(l){Ko.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}D(sm,Ko);function im(){$s.call(this),this.status=1}D(im,$s);function Fi(l){this.g=l}D(Fi,rm),Fi.prototype.ua=function(){xe(this.g,"a")},Fi.prototype.ta=function(l){xe(this.g,new sm(l))},Fi.prototype.sa=function(l){xe(this.g,new im)},Fi.prototype.ra=function(){xe(this.g,"b")},cc.prototype.createWebChannel=cc.prototype.g,Mn.prototype.send=Mn.prototype.o,Mn.prototype.open=Mn.prototype.m,Mn.prototype.close=Mn.prototype.close,Sv=function(){return new cc},Pv=function(){return ki()},xv=Jt,bh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},vr.NO_ERROR=0,vr.TIMEOUT=8,vr.HTTP_ERROR=6,Sc=vr,qs.COMPLETE="complete",Av=qs,ql.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,Ia=ql,Dt.prototype.listenOnce=Dt.prototype.L,Dt.prototype.getLastError=Dt.prototype.Ka,Dt.prototype.getLastErrorCode=Dt.prototype.Ba,Dt.prototype.getStatus=Dt.prototype.Z,Dt.prototype.getResponseJson=Dt.prototype.Oa,Dt.prototype.getResponseText=Dt.prototype.oa,Dt.prototype.send=Dt.prototype.ea,Dt.prototype.setWithCredentials=Dt.prototype.Ha,Tv=Dt}).apply(typeof pc<"u"?pc:typeof self<"u"?self:typeof window<"u"?window:{});const cg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let No="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs=new mf("@firebase/firestore");function Wi(){return xs.logLevel}function sL(n){xs.setLogLevel(n)}function J(n,...e){if(xs.logLevel<=qe.DEBUG){const t=e.map(_f);xs.debug(`Firestore (${No}): ${n}`,...t)}}function Lt(n,...e){if(xs.logLevel<=qe.ERROR){const t=e.map(_f);xs.error(`Firestore (${No}): ${n}`,...t)}}function Kn(n,...e){if(xs.logLevel<=qe.WARN){const t=e.map(_f);xs.warn(`Firestore (${No}): ${n}`,...t)}}function _f(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(n="Unexpected state"){const e=`FIRESTORE (${No}) INTERNAL ASSERTION FAILED: `+n;throw Lt(e),new Error(e)}function ge(n,e){n||fe()}function iL(n,e){n||fe()}function oe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends qr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Qx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(en.UNAUTHENTICATED))}shutdown(){}}class Jx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Yx{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ge(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let i=new nn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new nn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new nn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string"),new Rv(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string"),new en(e)}}class Xx{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Zx{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Xx(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(en.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Cv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ge(this.o===void 0);const r=i=>{i.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ge(typeof t.token=="string"),this.R=t.token,new Cv(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class oL{getToken(){return Promise.resolve(new Cv(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=tP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function Se(n,e){return n<e?-1:n>e?1:0}function go(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Dv(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Y(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Y(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Y(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Rt.fromMillis(Date.now())}static fromDate(e){return Rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Rt(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Se(this.nanoseconds,e.nanoseconds):Se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new Rt(0,0))}static max(){return new ve(new Rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t,r){t===void 0?t=0:t>e.length&&fe(),r===void 0?r=e.length-t:r>e.length-t&&fe(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ya.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ya?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ze extends Ya{construct(e,t,r){return new ze(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new ze(t)}static emptyPath(){return new ze([])}}const nP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends Ya{construct(e,t,r){return new Et(e,t,r)}static isValidIdentifier(e){return nP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Et(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Y(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Y(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Y(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Y(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(t)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.path=e}static fromPath(e){return new de(ze.fromString(e))}static fromName(e){return new de(ze.fromString(e).popFirst(5))}static empty(){return new de(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new ze(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Ih(n){return n.fields.find(e=>e.kind===2)}function Zs(n){return n.fields.filter(e=>e.kind!==2)}function rP(n,e){let t=Se(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=sP(n.fields[r],e.fields[r]),t!==0)return t;return Se(n.fields.length,e.fields.length)}_o.UNKNOWN_ID=-1;class ci{constructor(e,t){this.fieldPath=e,this.kind=t}}function sP(n,e){const t=Et.comparator(n.fieldPath,e.fieldPath);return t!==0?t:Se(n.kind,e.kind)}class yo{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new yo(0,Bn.min())}}function Vv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new Rt(t+1,0):new Rt(t,r));return new Bn(s,de.empty(),e)}function Nv(n){return new Bn(n.readTime,n.key,-1)}class Bn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Bn(ve.min(),de.empty(),-1)}static max(){return new Bn(ve.max(),de.empty(),-1)}}function yf(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=de.comparator(n.documentKey,e.documentKey),t!==0?t:Se(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Mv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Os(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==Ov)throw n;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new N((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof N?t:N.resolve(t)}catch(t){return N.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):N.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):N.reject(t)}static resolve(e){return new N((t,r)=>{t(e)})}static reject(e){return new N((t,r)=>{r(e)})}static waitFor(e){return new N((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},c=>r(c))}),o=!0,i===s&&t()})}static or(e){let t=N.resolve(!1);for(const r of e)t=t.next(s=>s?N.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new N((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;t(e[u]).next(d=>{o[u]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new N((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new nn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ma(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=vf(r.target.error);this.V.reject(new Ma(e,s))}}static open(e,t,r,s){try{return new Nu(t,e.transaction(s,r))}catch(i){throw new Ma(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(J("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new oP(t)}}class fr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,fr.S(Yt())===12.2&&Lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return J("SimpleDb","Removing database:",e),ei(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!gv())return!1;if(fr.v())return!0;const e=Yt(),t=fr.S(e),r=0<t&&t<10,s=Lv(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(J("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Ma(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Y(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Y(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ma(e,o))},s.onupgradeneeded=i=>{J("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{J("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Nu.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),N.reject(u))).toPromise();return c.catch(()=>{}),await a.m,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(J("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Lv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class iP{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ei(this.B.delete())}}class Ma extends Y{constructor(e,t){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ms(n){return n.name==="IndexedDbTransactionError"}class oP{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(J("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(J("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ei(r)}add(e){return J("SimpleDb","ADD",this.store.name,e,e),ei(this.store.add(e))}get(e){return ei(this.store.get(e)).next(t=>(t===void 0&&(t=null),J("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return J("SimpleDb","DELETE",this.store.name,e),ei(this.store.delete(e))}count(){return J("SimpleDb","COUNT",this.store.name),ei(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new N((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new N((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){J("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new N((r,s)=>{t.onerror=i=>{const o=vf(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new N((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new iP(a),u=t(a.primaryKey,a.value,c);if(u instanceof N){const d=u.catch(f=>(c.done(),N.reject(f)));r.push(d)}c.isDone?s():c.K===null?a.continue():a.continue(c.K)}}).next(()=>N.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ei(n){return new N((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=vf(r.target.error);t(s)}})}let ug=!1;function vf(n){const e=fr.S(Yt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Y("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ug||(ug=!0,setTimeout(()=>{throw r},0)),r}}return n}class aP{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){J("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{J("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Ms(t)?J("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Os(t)}await this.X(6e4)})}}class lP{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return N.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return J("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(J("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=Nv(i);yf(o,r)>0&&(r=o)}),new Bn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}kn.oe=-1;function bl(n){return n==null}function Xa(n){return n===0&&1/n==-1/0}function Fv(n){return typeof n=="number"&&Number.isInteger(n)&&!Xa(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=dg(e)),e=cP(n.get(t),e);return dg(e)}function cP(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function dg(n){return n+""}function ur(n){const e=n.length;if(ge(e>=2),e===2)return ge(n.charAt(0)===""&&n.charAt(1)===""),ze.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&fe(),n.charAt(o+1)){case"":const a=n.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:fe()}i=o+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hg=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(n,e){return[n,wn(e)]}function Uv(n,e,t){return[n,wn(e),t]}const uP={},dP=["prefixPath","collectionGroup","readTime","documentId"],hP=["prefixPath","collectionGroup","documentId"],fP=["collectionGroup","readTime","prefixPath","documentId"],pP=["canonicalId","targetId"],mP=["targetId","path"],gP=["path","targetId"],_P=["collectionId","parent"],yP=["indexId","uid"],vP=["uid","sequenceNumber"],wP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],bP=["indexId","uid","orderedDocumentKey"],IP=["userId","collectionPath","documentId"],EP=["userId","collectionPath","largestBatchId"],TP=["userId","collectionGroup","largestBatchId"],Bv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],AP=[...Bv,"documentOverlays"],$v=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],jv=$v,wf=[...jv,"indexConfiguration","indexState","indexEntries"],xP=wf,PP=[...wf,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh extends Mv{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Xt(n,e){const t=oe(n);return fr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ls(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function qv(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function zv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mc(this.root,e,this.comparator,!0)}}class mc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??ln.RED,this.left=s??ln.EMPTY,this.right=i??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new ln(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ln.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw fe();const e=this.left.check();if(e!==this.right.check())throw fe();return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw fe()}get value(){throw fe()}get color(){throw fe()}get left(){throw fe()}get right(){throw fe()}copy(e,t,r,s,i){return this}insert(e,t,r){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pg(this.data.getIterator())}getIteratorFrom(e){return new pg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new lt(this.comparator);return t.data=e,t}}class pg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $i(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new Dn([])}unionWith(e){let t=new lt(Et.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Dn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return go(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lL(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Gv("Invalid base64 string: "+i):i}}(e);return new Vt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Vt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const SP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lr(n){if(ge(!!n),typeof n=="string"){let e=0;const t=SP.exec(n);if(ge(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fr(n){return typeof n=="string"?Vt.fromBase64String(n):Vt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Mu(n){const e=n.mapValue.fields.__previous_value__;return Ou(e)?Mu(e):e}function Za(n){const e=Lr(n.mapValue.fields.__local_write_time__.timestampValue);return new Rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e,t,r,s,i,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}}class hi{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new hi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Cc={nullValue:"NULL_VALUE"};function Ps(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ou(n)?4:Kv(n)?9007199254740991:Lu(n)?10:11:fe()}function _r(n,e){if(n===e)return!0;const t=Ps(n);if(t!==Ps(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Za(n).isEqual(Za(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Lr(s.timestampValue),a=Lr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Fr(s.bytesValue).isEqual(Fr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return It(s.geoPointValue.latitude)===It(i.geoPointValue.latitude)&&It(s.geoPointValue.longitude)===It(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return It(s.integerValue)===It(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=It(s.doubleValue),a=It(i.doubleValue);return o===a?Xa(o)===Xa(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return go(n.arrayValue.values||[],e.arrayValue.values||[],_r);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(fg(o)!==fg(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!_r(o[c],a[c])))return!1;return!0}(n,e);default:return fe()}}function el(n,e){return(n.values||[]).find(t=>_r(t,e))!==void 0}function Ss(n,e){if(n===e)return 0;const t=Ps(n),r=Ps(e);if(t!==r)return Se(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Se(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=It(i.integerValue||i.doubleValue),c=It(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return mg(n.timestampValue,e.timestampValue);case 4:return mg(Za(n),Za(e));case 5:return Se(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Fr(i),c=Fr(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const d=Se(a[u],c[u]);if(d!==0)return d}return Se(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Se(It(i.latitude),It(o.latitude));return a!==0?a:Se(It(i.longitude),It(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return gg(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,c,u,d;const f=i.fields||{},g=o.fields||{},_=(a=f.value)===null||a===void 0?void 0:a.arrayValue,D=(c=g.value)===null||c===void 0?void 0:c.arrayValue,T=Se(((u=_==null?void 0:_.values)===null||u===void 0?void 0:u.length)||0,((d=D==null?void 0:D.values)===null||d===void 0?void 0:d.length)||0);return T!==0?T:gg(_,D)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===_s.mapValue&&o===_s.mapValue)return 0;if(i===_s.mapValue)return 1;if(o===_s.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const g=Se(c[f],d[f]);if(g!==0)return g;const _=Ss(a[c[f]],u[d[f]]);if(_!==0)return _}return Se(c.length,d.length)}(n.mapValue,e.mapValue);default:throw fe()}}function mg(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Se(n,e);const t=Lr(n),r=Lr(e),s=Se(t.seconds,r.seconds);return s!==0?s:Se(t.nanos,r.nanos)}function gg(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Ss(t[s],r[s]);if(i)return i}return Se(t.length,r.length)}function vo(n){return Th(n)}function Th(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Lr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Fr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return de.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Th(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Th(t.fields[o])}`;return s+"}"}(n.mapValue):fe()}function kc(n){switch(Ps(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mu(n);return e?16+kc(e):16;case 5:return 2*n.stringValue.length;case 6:return Fr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+kc(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ls(r.fields,(i,o)=>{s+=i.length+kc(o)}),s}(n.mapValue);default:throw fe()}}function fi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ah(n){return!!n&&"integerValue"in n}function tl(n){return!!n&&"arrayValue"in n}function _g(n){return!!n&&"nullValue"in n}function yg(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Dc(n){return!!n&&"mapValue"in n}function Lu(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function La(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ls(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=La(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=La(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Kv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const Hv={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function CP(n){return"nullValue"in n?Cc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?fi(hi.empty(),de.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Lu(n)?Hv:{mapValue:{}}:fe()}function kP(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?fi(hi.empty(),de.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Hv:"mapValue"in n?Lu(n)?{mapValue:{}}:_s:fe()}function vg(n,e){const t=Ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function wg(n,e){const t=Ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Dc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=La(t)}setAll(e){let t=Et.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=La(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Dc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _r(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Dc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ls(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new un(La(this.value))}}function Wv(n){const e=[];return Ls(n.fields,(t,r)=>{const s=new Et([t]);if(Dc(r)){const i=Wv(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new _t(e,0,ve.min(),ve.min(),ve.min(),un.empty(),0)}static newFoundDocument(e,t,r,s){return new _t(e,1,t,ve.min(),r,s,0)}static newNoDocument(e,t){return new _t(e,2,t,ve.min(),ve.min(),un.empty(),0)}static newUnknownDocument(e,t){return new _t(e,3,t,ve.min(),ve.min(),un.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,t){this.position=e,this.inclusive=t}}function bg(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=de.comparator(de.fromName(o.referenceValue),t.key):r=Ss(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ig(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!_r(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t="asc"){this.field=e,this.dir=t}}function DP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{}class Ge extends Qv{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new VP(e,t,r):t==="array-contains"?new MP(e,r):t==="in"?new t0(e,r):t==="not-in"?new LP(e,r):t==="array-contains-any"?new FP(e,r):new Ge(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new NP(e,r):new OP(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ss(t,this.value)):t!==null&&Ps(this.value)===Ps(t)&&this.matchesComparison(Ss(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class it extends Qv{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new it(e,t)}matches(e){return wo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function wo(n){return n.op==="and"}function xh(n){return n.op==="or"}function bf(n){return Jv(n)&&wo(n)}function Jv(n){for(const e of n.filters)if(e instanceof it)return!1;return!0}function Ph(n){if(n instanceof Ge)return n.field.canonicalString()+n.op.toString()+vo(n.value);if(bf(n))return n.filters.map(e=>Ph(e)).join(",");{const e=n.filters.map(t=>Ph(t)).join(",");return`${n.op}(${e})`}}function Yv(n,e){return n instanceof Ge?function(r,s){return s instanceof Ge&&r.op===s.op&&r.field.isEqual(s.field)&&_r(r.value,s.value)}(n,e):n instanceof it?function(r,s){return s instanceof it&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Yv(o,s.filters[a]),!0):!1}(n,e):void fe()}function Xv(n,e){const t=n.filters.concat(e);return it.create(t,n.op)}function Zv(n){return n instanceof Ge?function(t){return`${t.field.canonicalString()} ${t.op} ${vo(t.value)}`}(n):n instanceof it?function(t){return t.op.toString()+" {"+t.getFilters().map(Zv).join(" ,")+"}"}(n):"Filter"}class VP extends Ge{constructor(e,t,r){super(e,t,r),this.key=de.fromName(r.referenceValue)}matches(e){const t=de.comparator(e.key,this.key);return this.matchesComparison(t)}}class NP extends Ge{constructor(e,t){super(e,"in",t),this.keys=e0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class OP extends Ge{constructor(e,t){super(e,"not-in",t),this.keys=e0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function e0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>de.fromName(r.referenceValue))}class MP extends Ge{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tl(t)&&el(t.arrayValue,this.value)}}class t0 extends Ge{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&el(this.value.arrayValue,t)}}class LP extends Ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(el(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!el(this.value.arrayValue,t)}}class FP extends Ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>el(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Sh(n,e=null,t=[],r=[],s=null,i=null,o=null){return new UP(n,e,t,r,s,i,o)}function pi(n){const e=oe(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ph(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),bl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>vo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>vo(r)).join(",")),e.ue=t}return e.ue}function Il(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!DP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Yv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ig(n.startAt,e.startAt)&&Ig(n.endAt,e.endAt)}function Zc(n){return de.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function eu(n,e){return n.filters.filter(t=>t instanceof Ge&&t.field.isEqual(e))}function Eg(n,e,t){let r=Cc,s=!0;for(const i of eu(n,e)){let o=Cc,a=!0;switch(i.op){case"<":case"<=":o=CP(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Cc}vg({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];vg({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Tg(n,e,t){let r=_s,s=!0;for(const i of eu(n,e)){let o=_s,a=!0;switch(i.op){case">=":case">":o=kP(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=_s}wg({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];wg({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function n0(n,e,t,r,s,i,o,a){return new zr(n,e,t,r,s,i,o,a)}function Oo(n){return new zr(n)}function Ag(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function If(n){return n.collectionGroup!==null}function so(n){const e=oe(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new lt(Et.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new nl(i,r))}),t.has(Et.keyField().canonicalString())||e.ce.push(new nl(Et.keyField(),r))}return e.ce}function bn(n){const e=oe(n);return e.le||(e.le=s0(e,so(n))),e.le}function r0(n){const e=oe(n);return e.he||(e.he=s0(e,n.explicitOrderBy)),e.he}function s0(n,e){if(n.limitType==="F")return Sh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new nl(s.field,i)});const t=n.endAt?new Rs(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Rs(n.startAt.position,n.startAt.inclusive):null;return Sh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Rh(n,e){const t=n.filters.concat([e]);return new zr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function tu(n,e,t){return new zr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function El(n,e){return Il(bn(n),bn(e))&&n.limitType===e.limitType}function i0(n){return`${pi(bn(n))}|lt:${n.limitType}`}function Qi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>Zv(s)).join(", ")}]`),bl(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>vo(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>vo(s)).join(",")),`Target(${r})`}(bn(n))}; limitType=${n.limitType})`}function Tl(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):de.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of so(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const u=bg(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,so(r),s)||r.endAt&&!function(o,a,c){const u=bg(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,so(r),s))}(n,e)}function o0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function a0(n){return(e,t)=>{let r=!1;for(const s of so(n)){const i=BP(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function BP(n,e,t){const r=n.field.isKeyField()?de.comparator(e.key,t.key):function(i,o,a){const c=o.data.field(i),u=a.data.field(i);return c!==null&&u!==null?Ss(c,u):fe()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return fe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ls(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return zv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=new pt(de.comparator);function Vn(){return $P}const l0=new pt(de.comparator);function Ea(...n){let e=l0;for(const t of n)e=e.insert(t.key,t);return e}function c0(n){let e=l0;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function dr(){return Fa()}function u0(){return Fa()}function Fa(){return new Gr(n=>n.toString(),(n,e)=>n.isEqual(e))}const jP=new pt(de.comparator),qP=new lt(de.comparator);function Ve(...n){let e=qP;for(const t of n)e=e.add(t);return e}const zP=new lt(Se);function Ef(){return zP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xa(e)?"-0":e}}function d0(n){return{integerValue:""+n}}function h0(n,e){return Fv(e)?d0(e):Tf(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(){this._=void 0}}function GP(n,e,t){return n instanceof bo?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ou(i)&&(i=Mu(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof mi?p0(n,e):n instanceof gi?m0(n,e):function(s,i){const o=f0(s,i),a=xg(o)+xg(s.Pe);return Ah(o)&&Ah(s.Pe)?d0(a):Tf(s.serializer,a)}(n,e)}function KP(n,e,t){return n instanceof mi?p0(n,e):n instanceof gi?m0(n,e):t}function f0(n,e){return n instanceof Io?function(r){return Ah(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class bo extends Fu{}class mi extends Fu{constructor(e){super(),this.elements=e}}function p0(n,e){const t=g0(e);for(const r of n.elements)t.some(s=>_r(s,r))||t.push(r);return{arrayValue:{values:t}}}class gi extends Fu{constructor(e){super(),this.elements=e}}function m0(n,e){let t=g0(e);for(const r of n.elements)t=t.filter(s=>!_r(s,r));return{arrayValue:{values:t}}}class Io extends Fu{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function xg(n){return It(n.integerValue||n.doubleValue)}function g0(n){return tl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,t){this.field=e,this.transform=t}}function HP(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof mi&&s instanceof mi||r instanceof gi&&s instanceof gi?go(r.elements,s.elements,_r):r instanceof Io&&s instanceof Io?_r(r.Pe,s.Pe):r instanceof bo&&s instanceof bo}(n.transform,e.transform)}class WP{constructor(e,t){this.version=e,this.transformResults=t}}class Tt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tt}static exists(e){return new Tt(void 0,e)}static updateTime(e){return new Tt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Uu{}function _0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Lo(n.key,Tt.none()):new Mo(n.key,n.data,Tt.none());{const t=n.data,r=un.empty();let s=new lt(Et.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Kr(n.key,r,new Dn(s.toArray()),Tt.none())}}function QP(n,e,t){n instanceof Mo?function(s,i,o){const a=s.value.clone(),c=Sg(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Kr?function(s,i,o){if(!Vc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Sg(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(y0(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ua(n,e,t,r){return n instanceof Mo?function(i,o,a,c){if(!Vc(i.precondition,o))return a;const u=i.value.clone(),d=Rg(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Kr?function(i,o,a,c){if(!Vc(i.precondition,o))return a;const u=Rg(i.fieldTransforms,c,o),d=o.data;return d.setAll(y0(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return Vc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function JP(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=f0(r.transform,s||null);i!=null&&(t===null&&(t=un.empty()),t.set(r.field,i))}return t||null}function Pg(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&go(r,s,(i,o)=>HP(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Mo extends Uu{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kr extends Uu{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function y0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Sg(n,e,t){const r=new Map;ge(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,KP(o,a,t[s]))}return r}function Rg(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,GP(i,o,e))}return r}class Lo extends Uu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Af extends Uu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&QP(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ua(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ua(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=u0();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const c=_0(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ve())}isEqual(e){return this.batchId===e.batchId&&go(this.mutations,e.mutations,(t,r)=>Pg(t,r))&&go(this.baseMutations,e.baseMutations,(t,r)=>Pg(t,r))}}class Pf{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ge(e.mutations.length===r.length);let s=function(){return jP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Pf(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt,We;function w0(n){switch(n){default:return fe();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function b0(n){if(n===void 0)return Lt("GRPC error has no .code"),F.UNKNOWN;switch(n){case jt.OK:return F.OK;case jt.CANCELLED:return F.CANCELLED;case jt.UNKNOWN:return F.UNKNOWN;case jt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case jt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case jt.INTERNAL:return F.INTERNAL;case jt.UNAVAILABLE:return F.UNAVAILABLE;case jt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case jt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case jt.NOT_FOUND:return F.NOT_FOUND;case jt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case jt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case jt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case jt.ABORTED:return F.ABORTED;case jt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case jt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case jt.DATA_LOSS:return F.DATA_LOSS;default:return fe()}}(We=jt||(jt={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nu=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=new li([4294967295,4294967295],0);function Cg(n){const e=I0().encode(n),t=new Ev;return t.update(e),new Uint8Array(t.digest())}function kg(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new li([t,r],0),new li([s,i],0)]}class Rf{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ta(`Invalid padding: ${t}`);if(r<0)throw new Ta(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ta(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ta(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=li.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(li.fromNumber(r)));return s.compare(XP)===1&&(s=new li([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Cg(e),[r,s]=kg(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Rf(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=Cg(e),[r,s]=kg(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ta extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Pl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new xl(ve.min(),s,new pt(Se),Vn(),Ve())}}class Pl{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Pl(r,t,Ve(),Ve(),Ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class E0{constructor(e,t){this.targetId=e,this.me=t}}class T0{constructor(e,t,r=Vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Dg{constructor(){this.fe=0,this.ge=Ng(),this.pe=Vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ve(),t=Ve(),r=Ve();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:fe()}}),new Pl(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Ng()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ZP{constructor(e){this.Le=e,this.Be=new Map,this.ke=Vn(),this.qe=Vg(),this.Qe=new pt(Se)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:fe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Zc(i))if(r===0){const o=new de(i.path);this.Ue(t,o,_t.newNoDocument(o,ve.min()))}else ge(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}nu==null||nu.et(function(d,f,g,_,D){var T,C,U,B,L,O;const q={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},ie=f.unchangedNames;return ie&&(q.bloomFilter={applied:D===0,hashCount:(T=ie==null?void 0:ie.hashCount)!==null&&T!==void 0?T:0,bitmapLength:(B=(U=(C=ie==null?void 0:ie.bits)===null||C===void 0?void 0:C.bitmap)===null||U===void 0?void 0:U.length)!==null&&B!==void 0?B:0,padding:(O=(L=ie==null?void 0:ie.bits)===null||L===void 0?void 0:L.padding)!==null&&O!==void 0?O:0,mightContain:x=>{var E;return(E=_==null?void 0:_.mightContain(x))!==null&&E!==void 0&&E}}),q}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Fr(r).toUint8Array()}catch(c){if(c instanceof Gv)return Kn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Rf(o,s,i)}catch(c){return Kn(c instanceof Ta?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Zc(a.target)){const c=new de(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,_t.newNoDocument(c,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=Ve();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new xl(e,t,this.Qe,this.ke,r);return this.ke=Vn(),this.qe=Vg(),this.Qe=new pt(Se),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Dg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new lt(Se),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||J("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Dg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Vg(){return new pt(de.comparator)}function Ng(){return new pt(de.comparator)}const eS=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),tS=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),nS=(()=>({and:"AND",or:"OR"}))();class rS{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ch(n,e){return n.useProto3Json||bl(e)?e:{value:e}}function Eo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function sS(n,e){return Eo(n,e.toTimestamp())}function Ut(n){return ge(!!n),ve.fromTimestamp(function(t){const r=Lr(t);return new Rt(r.seconds,r.nanos)}(n))}function Cf(n,e){return kh(n,e).canonicalString()}function kh(n,e){const t=function(s){return new ze(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function x0(n){const e=ze.fromString(n);return ge(M0(e)),e}function rl(n,e){return Cf(n.databaseId,e.path)}function pr(n,e){const t=x0(e);if(t.get(1)!==n.databaseId.projectId)throw new Y(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Y(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new de(R0(t))}function P0(n,e){return Cf(n.databaseId,e)}function S0(n){const e=x0(n);return e.length===4?ze.emptyPath():R0(e)}function Dh(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function R0(n){return ge(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Og(n,e,t){return{name:rl(n,e),fields:t.value.mapValue.fields}}function C0(n,e,t){const r=pr(n,e.name),s=Ut(e.updateTime),i=e.createTime?Ut(e.createTime):ve.min(),o=new un({mapValue:{fields:e.fields}}),a=_t.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function iS(n,e){return"found"in e?function(r,s){ge(!!s.found),s.found.name,s.found.updateTime;const i=pr(r,s.found.name),o=Ut(s.found.updateTime),a=s.found.createTime?Ut(s.found.createTime):ve.min(),c=new un({mapValue:{fields:s.found.fields}});return _t.newFoundDocument(i,o,a,c)}(n,e):"missing"in e?function(r,s){ge(!!s.missing),ge(!!s.readTime);const i=pr(r,s.missing),o=Ut(s.readTime);return _t.newNoDocument(i,o)}(n,e):fe()}function oS(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:fe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(ge(d===void 0||typeof d=="string"),Vt.fromBase64String(d||"")):(ge(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Vt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?F.UNKNOWN:b0(u.code);return new Y(d,u.message||"")}(o);t=new T0(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=pr(n,r.document.name),i=Ut(r.document.updateTime),o=r.document.createTime?Ut(r.document.createTime):ve.min(),a=new un({mapValue:{fields:r.document.fields}}),c=_t.newFoundDocument(s,i,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Nc(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=pr(n,r.document),i=r.readTime?Ut(r.readTime):ve.min(),o=_t.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Nc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=pr(n,r.document),i=r.removedTargetIds||[];t=new Nc([],i,s,null)}else{if(!("filter"in e))return fe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new YP(s,i),a=r.targetId;t=new E0(a,o)}}return t}function sl(n,e){let t;if(e instanceof Mo)t={update:Og(n,e.key,e.value)};else if(e instanceof Lo)t={delete:rl(n,e.key)};else if(e instanceof Kr)t={update:Og(n,e.key,e.data),updateMask:hS(e.fieldMask)};else{if(!(e instanceof Af))return fe();t={verify:rl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof bo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof mi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof gi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Io)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw fe()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:sS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:fe()}(n,e.precondition)),t}function Vh(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Tt.updateTime(Ut(i.updateTime)):i.exists!==void 0?Tt.exists(i.exists):Tt.none()}(e.currentDocument):Tt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)ge(a.setToServerValue==="REQUEST_TIME"),c=new bo;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];c=new mi(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];c=new gi(d)}else"increment"in a?c=new Io(o,a.increment):fe();const u=Et.fromServerFormat(a.fieldPath);return new Al(u,c)}(n,s)):[];if(e.update){e.update.name;const s=pr(n,e.update.name),i=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new Dn(u.map(d=>Et.fromServerFormat(d)))}(e.updateMask);return new Kr(s,i,o,t,r)}return new Mo(s,i,t,r)}if(e.delete){const s=pr(n,e.delete);return new Lo(s,t)}if(e.verify){const s=pr(n,e.verify);return new Af(s,t)}return fe()}function aS(n,e){return n&&n.length>0?(ge(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Ut(s.updateTime):Ut(i);return o.isEqual(ve.min())&&(o=Ut(i)),new WP(o,s.transformResults||[])}(t,e))):[]}function k0(n,e){return{documents:[P0(n,e.path)]}}function Bu(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=P0(n,s);const i=function(u){if(u.length!==0)return O0(it.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:cs(g.field),direction:cS(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ch(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:s}}function D0(n,e,t,r){const{_t:s,parent:i}=Bu(n,e),o={},a=[];let c=0;return t.forEach(u=>{const d=r?u.alias:"aggregate_"+c++;o[d]=u.alias,u.aggregateType==="count"?a.push({alias:d,count:{}}):u.aggregateType==="avg"?a.push({alias:d,avg:{field:cs(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:d,sum:{field:cs(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function V0(n){let e=S0(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ge(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const g=N0(f);return g instanceof it&&bf(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(D){return new nl(Ji(D.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,bl(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(f){const g=!!f.before,_=f.values||[];return new Rs(_,g)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const g=!f.before,_=f.values||[];return new Rs(_,g)}(t.endAt)),n0(e,s,o,i,a,"F",c,u)}function lS(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function N0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ji(t.unaryFilter.field);return Ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ji(t.unaryFilter.field);return Ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ji(t.unaryFilter.field);return Ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ji(t.unaryFilter.field);return Ge.create(o,"!=",{nullValue:"NULL_VALUE"});default:return fe()}}(n):n.fieldFilter!==void 0?function(t){return Ge.create(Ji(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return fe()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return it.create(t.compositeFilter.filters.map(r=>N0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return fe()}}(t.compositeFilter.op))}(n):fe()}function cS(n){return eS[n]}function uS(n){return tS[n]}function dS(n){return nS[n]}function cs(n){return{fieldPath:n.canonicalString()}}function Ji(n){return Et.fromServerFormat(n.fieldPath)}function O0(n){return n instanceof Ge?function(t){if(t.op==="=="){if(yg(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(_g(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yg(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(_g(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:uS(t.op),value:t.value}}}(n):n instanceof it?function(t){const r=t.getFilters().map(s=>O0(s));return r.length===1?r[0]:{compositeFilter:{op:dS(t.op),filters:r}}}(n):fe()}function hS(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function M0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t,r,s,i=ve.min(),o=ve.min(),a=Vt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Rr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this.ct=e}}function fS(n,e){let t;if(e.document)t=C0(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=de.fromSegments(e.noDocument.path),s=yi(e.noDocument.readTime);t=_t.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return fe();{const r=de.fromSegments(e.unknownDocument.path),s=yi(e.unknownDocument.version);t=_t.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Rt(s[0],s[1]);return ve.fromTimestamp(i)}(e.readTime)),t}function Mg(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ru(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:rl(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Eo(i,o.version.toTimestamp()),createTime:Eo(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:_i(e.version)};else{if(!e.isUnknownDocument())return fe();r.unknownDocument={path:t.path.toArray(),version:_i(e.version)}}return r}function ru(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function _i(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yi(n){const e=new Rt(n.seconds,n.nanoseconds);return ve.fromTimestamp(e)}function ti(n,e){const t=(e.baseMutations||[]).map(i=>Vh(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Vh(n.ct,i)),s=Rt.fromMillis(e.localWriteTimeMs);return new xf(e.batchId,s,t,r)}function Aa(n){const e=yi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?yi(n.lastLimboFreeSnapshotVersion):ve.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return ge(i.documents.length===1),bn(Oo(S0(i.documents[0])))}(n.query):function(i){return bn(V0(i))}(n.query),new Rr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Vt.fromBase64String(n.resumeToken))}function F0(n,e){const t=_i(e.snapshotVersion),r=_i(e.lastLimboFreeSnapshotVersion);let s;s=Zc(e.target)?k0(n.ct,e.target):Bu(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pi(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function kf(n){const e=V0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?tu(e,e.limit,"L"):e}function jd(n,e){return new Sf(e.largestBatchId,Vh(n.ct,e.overlayMutation))}function Lg(n,e){const t=e.path.lastSegment();return[n,wn(e.path.popLast()),t]}function Fg(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:_i(r.readTime),documentKey:wn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{getBundleMetadata(e,t){return Ug(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:yi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return Ug(e).put(function(s){return{bundleId:s.id,createTime:_i(Ut(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return Bg(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:kf(i.bundledQuery),readTime:yi(i.readTime)}}(r)})}saveNamedQuery(e,t){return Bg(e).put(function(s){return{name:s.name,readTime:_i(Ut(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function Ug(n){return Xt(n,"bundles")}function Bg(n){return Xt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new $u(e,r)}getOverlay(e,t){return ha(e).get(Lg(this.userId,t)).next(r=>r?jd(this.serializer,r):null)}getOverlays(e,t){const r=dr();return N.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Sf(t,o);s.push(this.ht(e,a))}),N.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(wn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(ha(e).j("collectionPathOverlayIndex",a))}),N.waitFor(i)}getOverlaysForCollection(e,t,r){const s=dr(),i=wn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ha(e).U("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const u=jd(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=dr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ha(e).J({index:"collectionGroupOverlayIndex",range:a},(c,u,d)=>{const f=jd(this.serializer,u);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return ha(e).put(function(s,i,o){const[a,c,u]=Lg(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:sl(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function ha(n){return Xt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{Pt(e){return Xt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Vt.fromUint8Array(r):Vt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(It(e.integerValue));else if("doubleValue"in e){const r=It(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Xa(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Lr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Fr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Kv(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Lu(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):fe()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(It(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),de.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ni.vt=new ni;function gS(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function $g(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=gS(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class _S{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=$g(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=$g(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class yS{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class vS{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class fa{constructor(){this.jt=new _S,this.Ht=new yS(this.jt),this.Jt=new vS(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new ri(this.indexId,this.documentKey,this.arrayValue,r)}}function ns(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=jg(n.arrayValue,e.arrayValue),t!==0?t:(t=jg(n.directionalValue,e.directionalValue),t!==0?t:de.comparator(n.documentKey,e.documentKey)))}function jg(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e){this.Xt=new lt((t,r)=>Et.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ge(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Ih(e);if(t!==void 0&&!this.sn(t))return!1;const r=Zs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new lt(Et.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ci(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ci(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ci(r.field,r.dir==="asc"?0:1)));return new _o(_o.UNKNOWN_ID,this.collectionId,t,yo.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(n){var e,t;if(ge(n instanceof Ge||n instanceof it),n instanceof Ge){if(n instanceof t0){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>Ge.create(n.field,"==",i)))||[];return it.create(s,"or")}return n}const r=n.filters.map(s=>U0(s));return it.create(r,n.op)}function wS(n){if(n.getFilters().length===0)return[];const e=Mh(U0(n));return ge(B0(e)),Nh(e)||Oh(e)?[e]:e.getFilters()}function Nh(n){return n instanceof Ge}function Oh(n){return n instanceof it&&bf(n)}function B0(n){return Nh(n)||Oh(n)||function(t){if(t instanceof it&&xh(t)){for(const r of t.getFilters())if(!Nh(r)&&!Oh(r))return!1;return!0}return!1}(n)}function Mh(n){if(ge(n instanceof Ge||n instanceof it),n instanceof Ge)return n;if(n.filters.length===1)return Mh(n.filters[0]);const e=n.filters.map(r=>Mh(r));let t=it.create(e,n.op);return t=su(t),B0(t)?t:(ge(t instanceof it),ge(wo(t)),ge(t.filters.length>1),t.filters.reduce((r,s)=>Df(r,s)))}function Df(n,e){let t;return ge(n instanceof Ge||n instanceof it),ge(e instanceof Ge||e instanceof it),t=n instanceof Ge?e instanceof Ge?function(s,i){return it.create([s,i],"and")}(n,e):zg(n,e):e instanceof Ge?zg(e,n):function(s,i){if(ge(s.filters.length>0&&i.filters.length>0),wo(s)&&wo(i))return Xv(s,i.getFilters());const o=xh(s)?s:i,a=xh(s)?i:s,c=o.filters.map(u=>Df(u,a));return it.create(c,"or")}(n,e),su(t)}function zg(n,e){if(wo(e))return Xv(e,n.getFilters());{const t=e.filters.map(r=>Df(n,r));return it.create(t,"or")}}function su(n){if(ge(n instanceof Ge||n instanceof it),n instanceof Ge)return n;const e=n.getFilters();if(e.length===1)return su(e[0]);if(Jv(n))return n;const t=e.map(s=>su(s)),r=[];return t.forEach(s=>{s instanceof Ge?r.push(s):s instanceof it&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:it.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(){this.un=new Vf}addToCollectionParentIndex(e,t){return this.un.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(Bn.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(Bn.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}}class Vf{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new lt(ze.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new lt(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=new Uint8Array(0);class IS{constructor(e,t){this.databaseId=t,this.cn=new Vf,this.ln=new Gr(r=>pi(r),(r,s)=>Il(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:wn(s)};return Gg(e).put(i)}return N.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Dv(t),""],!1,!0);return Gg(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(ur(o.parent))}return r})}addFieldIndex(e,t){const r=pa(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=qi(e);return i.next(a=>{o.put(Fg(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=pa(e),s=qi(e),i=ji(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=pa(e),r=ji(e),s=qi(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return N.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new qg(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=ji(e);let s=!0;const i=new Map;return N.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ve();const a=[];return N.forEach(i,(c,u)=>{J("IndexedDbIndexManager",`Using index ${function(L){return`id=${L.indexId}|cg=${L.collectionGroup}|f=${L.fields.map(O=>`${O.fieldPath}:${O.kind}`).join(",")}`}(c)} to execute ${pi(t)}`);const d=function(L,O){const q=Ih(O);if(q===void 0)return null;for(const ie of eu(L,q.fieldPath))switch(ie.op){case"array-contains-any":return ie.value.arrayValue.values||[];case"array-contains":return[ie.value]}return null}(u,c),f=function(L,O){const q=new Map;for(const ie of Zs(O))for(const x of eu(L,ie.fieldPath))switch(x.op){case"==":case"in":q.set(ie.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return q.set(ie.fieldPath.canonicalString(),x.value),Array.from(q.values())}return null}(u,c),g=function(L,O){const q=[];let ie=!0;for(const x of Zs(O)){const E=x.kind===0?Eg(L,x.fieldPath,L.startAt):Tg(L,x.fieldPath,L.startAt);q.push(E.value),ie&&(ie=E.inclusive)}return new Rs(q,ie)}(u,c),_=function(L,O){const q=[];let ie=!0;for(const x of Zs(O)){const E=x.kind===0?Tg(L,x.fieldPath,L.endAt):Eg(L,x.fieldPath,L.endAt);q.push(E.value),ie&&(ie=E.inclusive)}return new Rs(q,ie)}(u,c),D=this.In(c,u,g),T=this.In(c,u,_),C=this.Tn(c,u,f),U=this.En(c.indexId,d,D,g.inclusive,T,_.inclusive,C);return N.forEach(U,B=>r.G(B,t.limit).next(L=>{L.forEach(O=>{const q=de.fromSegments(O.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return N.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=wS(it.create(e.filters,"and")).map(r=>Sh(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const c=(t!=null?t.length:1)*Math.max(r.length,i.length),u=c/(t!=null?t.length:1),d=[];for(let f=0;f<c;++f){const g=t?this.dn(t[f/u]):gc,_=this.An(e,g,r[f%u],s),D=this.Rn(e,g,i[f%u],o),T=a.map(C=>this.An(e,g,C,!0));d.push(...this.createRange(_,D,T))}return d}An(e,t,r,s){const i=new ri(e,de.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new ri(e,de.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new qg(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return N.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new lt(Et.comparator),d=!1;for(const f of c.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:u=u.add(g.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new fa;for(const s of Zs(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);ni.vt.It(i,o)}return r.zt()}dn(e){const t=new fa;return ni.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new fa;return ni.vt.It(fi(this.databaseId,t),r.Yt(function(i){const o=Zs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new fa);let i=0;for(const o of Zs(e)){const a=r[i++];for(const c of s)if(this.fn(t,o.fieldPath)&&tl(a))s=this.gn(s,o,a);else{const u=c.Yt(o.kind);ni.vt.It(a,u)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new fa;c.seed(a.zt()),ni.vt.It(o,c.Yt(t.kind)),i.push(c)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof Ge&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=pa(e),s=qi(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return N.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(d,f){const g=f?new yo(f.sequenceNumber,new Bn(yi(f.readTime),new de(ur(f.documentKey)),f.largestBatchId)):yo.empty(),_=d.fields.map(([D,T])=>new ci(Et.fromServerFormat(D),T));return new _o(d.indexId,d.collectionGroup,_,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Se(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=pa(e),i=qi(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>N.forEach(a,c=>i.put(Fg(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return N.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),N.forEach(a,c=>this.wn(e,s,c).next(u=>{const d=this.Sn(i,c);return u.isEqual(d)?N.resolve():this.bn(e,i,c,u,d)}))))})}Dn(e,t,r,s){return ji(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return ji(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=ji(e);let i=new lt(ns);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new ri(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new lt(ns);const s=this.Vn(t,e);if(s==null)return r;const i=Ih(t);if(i!=null){const o=e.data.field(i.fieldPath);if(tl(o))for(const a of o.arrayValue.values||[])r=r.add(new ri(t.indexId,e.key,this.dn(a),s))}else r=r.add(new ri(t.indexId,e.key,gc,s));return r}bn(e,t,r,s,i){J("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(c,u,d,f,g){const _=c.getIterator(),D=u.getIterator();let T=$i(_),C=$i(D);for(;T||C;){let U=!1,B=!1;if(T&&C){const L=d(T,C);L<0?B=!0:L>0&&(U=!0)}else T!=null?B=!0:U=!0;U?(f(C),C=$i(D)):B?(g(T),T=$i(_)):(T=$i(_),C=$i(D))}}(s,i,ns,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),N.waitFor(o)}yn(e){let t=1;return qi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ns(o,a)).filter((o,a,c)=>!a||ns(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ns(o,e),c=ns(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,gc,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,gc,[]];i.push(IDBKeyRange.bound(a,c))}return i}Cn(e,t){return ns(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Kg)}getMinOffset(e,t){return N.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||fe())).next(Kg)}}function Gg(n){return Xt(n,"collectionParents")}function ji(n){return Xt(n,"indexEntries")}function pa(n){return Xt(n,"indexConfiguration")}function qi(n){return Xt(n,"indexState")}function Kg(n){ge(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;yf(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Bn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class gn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=r.J({range:o},(d,f,g)=>(a++,g.delete()));i.push(c.next(()=>{ge(a===1)}));const u=[];for(const d of t.mutations){const f=Uv(e,d.key.path,t.batchId);i.push(s.delete(f)),u.push(d.key)}return N.waitFor(i).next(()=>u)}function iu(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw fe();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(41943040,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);class ju{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){ge(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new ju(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return rs(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=Yi(e),o=rs(e);return o.add({}).next(a=>{ge(typeof a=="number");const c=new xf(a,t,r,s),u=function(_,D,T){const C=T.baseMutations.map(B=>sl(_.ct,B)),U=T.mutations.map(B=>sl(_.ct,B));return{userId:D,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:C,mutations:U}}(this.serializer,this.userId,c),d=[];let f=new lt((g,_)=>Se(g.canonicalString(),_.canonicalString()));for(const g of s){const _=Uv(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(u)),d.push(i.put(_,uP))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),N.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return rs(e).get(t).next(r=>r?(ge(r.userId===this.userId),ti(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?N.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return rs(e).J({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(ge(a.batchId>=r),i=ti(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return rs(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return rs(e).U("userMutationsIndex",t).next(r=>r.map(s=>ti(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Rc(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return Yi(e).J({range:s},(o,a,c)=>{const[u,d,f]=o,g=ur(d);if(u===this.userId&&t.path.isEqual(g))return rs(e).get(f).next(_=>{if(!_)throw fe();ge(_.userId===this.userId),i.push(ti(this.serializer,_))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new lt(Se);const s=[];return t.forEach(i=>{const o=Rc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Yi(e).J({range:a},(u,d,f)=>{const[g,_,D]=u,T=ur(_);g===this.userId&&i.path.isEqual(T)?r=r.add(D):f.done()});s.push(c)}),N.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Rc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new lt(Se);return Yi(e).J({range:o},(c,u,d)=>{const[f,g,_]=c,D=ur(g);f===this.userId&&r.isPrefixOf(D)?D.length===s&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(rs(e).get(i).next(o=>{if(o===null)throw fe();ge(o.userId===this.userId),r.push(ti(this.serializer,o))}))}),N.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return $0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),N.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return N.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Yi(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=ur(i[1]);s.push(c)}else a.done()}).next(()=>{ge(s.length===0)})})}containsKey(e,t){return j0(e,this.userId,t)}Nn(e){return q0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function j0(n,e,t){const r=Rc(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Yi(n).J({range:i,H:!0},(a,c,u)=>{const[d,f,g]=a;d===e&&f===s&&(o=!0),u.done()}).next(()=>o)}function rs(n){return Xt(n,"mutations")}function Yi(n){return Xt(n,"documentMutations")}function q0(n){return Xt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new vi(0)}static kn(){return new vi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new vi(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ve.fromTimestamp(new Rt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>zi(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(ge(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return zi(e).J((o,a)=>{const c=Aa(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>N.waitFor(i)).next(()=>s)}forEachTarget(e,t){return zi(e).J((r,s)=>{const i=Aa(s);t(i)})}qn(e){return Wg(e).get("targetGlobalKey").next(t=>(ge(t!==null),t))}Qn(e,t){return Wg(e).put("targetGlobalKey",t)}Kn(e,t){return zi(e).put(F0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=pi(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return zi(e).J({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const u=Aa(a);Il(t,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=us(e);return t.forEach(o=>{const a=wn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(s)}removeMatchingKeys(e,t,r){const s=us(e);return N.forEach(t,i=>{const o=wn(i.path);return N.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=us(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=us(e);let i=Ve();return s.J({range:r,H:!0},(o,a,c)=>{const u=ur(o[1]),d=new de(u);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=wn(t.path),s=IDBKeyRange.bound([r],[Dv(r)],!1,!0);let i=0;return us(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ot(e,t){return zi(e).get(t).next(r=>r?Aa(r):null)}}function zi(n){return Xt(n,"targets")}function Wg(n){return Xt(n,"targetGlobal")}function us(n){return Xt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg([n,e],[t,r]){const s=Se(n,t);return s===0?Se(e,r):s}class TS{constructor(e){this.Un=e,this.buffer=new lt(Qg),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Qg(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class z0{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){J("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ms(t)?J("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Os(t)}await this.Hn(3e5)})}}class AS{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return N.resolve(kn.oe);const r=new TS(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(Hg)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hg):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),Wi()<=qe.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function G0(n,e){return new AS(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,t){this.db=e,this.garbageCollector=G0(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return _c(e,r)}removeReference(e,t,r){return _c(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return _c(e,t)}nr(e,t){return function(s,i){let o=!1;return q0(s).Y(a=>j0(s,a,i).next(c=>(c&&(o=!0),N.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const c=this.nr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ve.min()),us(e).delete(function(f){return[0,wn(f.path)]}(o))))});s.push(c)}}).next(()=>N.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return _c(e,t)}tr(e,t){const r=us(e);let s,i=kn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(i!==kn.oe&&t(new de(ur(s)),i),i=u,s=c):i=kn.oe}).next(()=>{i!==kn.oe&&t(new de(ur(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function _c(n,e){return us(n).put(function(r,s){return{targetId:0,path:wn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(){this.changes=new Gr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_t.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Js(e).put(r)}removeEntry(e,t,r){return Js(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ru(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=_t.newInvalidDocument(t);return Js(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ma(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:_t.newInvalidDocument(t)};return Js(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ma(t))},(s,i)=>{r={document:this.ir(t,i),size:iu(i)}}).next(()=>r)}getEntries(e,t){let r=Vn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=Vn(),s=new pt(de.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,iu(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return N.resolve();let s=new lt(Xg);t.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(ma(s.first()),ma(s.last())),o=s.getIterator();let a=o.getNext();return Js(e).J({index:"documentKeyIndex",range:i},(c,u,d)=>{const f=de.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Xg(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(ma(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),ru(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Js(e).U(IDBKeyRange.bound(a,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Vn();for(const f of u){const g=this.ir(de.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Tl(t,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=Vn();const o=Yg(t,r),a=Yg(t,Bn.max());return Js(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{const f=this.ir(de.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new SS(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Jg(e).get("remoteDocumentGlobalKey").next(t=>(ge(!!t),t))}rr(e,t){return Jg(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=fS(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ve.min())))return r}return _t.newInvalidDocument(e)}}function H0(n){return new PS(n)}class SS extends K0{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Gr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new lt((i,o)=>Se(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=Mg(this.cr.serializer,o);s=s.add(i.path.popLast());const u=iu(c);r+=u-a.size,t.push(this.cr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=Mg(this.cr.serializer,o.convertToNoDocument(ve.min()));t.push(this.cr.addEntry(e,i,c))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),N.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Jg(n){return Xt(n,"remoteDocumentGlobal")}function Js(n){return Xt(n,"remoteDocumentsV14")}function ma(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Yg(n,e){const t=e.documentKey.path.toArray();return[n,ru(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Xg(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=Se(t[i],r[i]),s)return s;return s=Se(t.length,r.length),s||(s=Se(t[t.length-2],r[r.length-2]),s||Se(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Ua(r.mutation,s,Dn.empty(),Rt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ve()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ve()){const s=dr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Ea();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=dr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ve()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Vn();const o=Fa(),a=function(){return Fa()}();return t.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Kr)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Ua(d.mutation,u,d.mutation.getFieldMask(),Rt.now())):o.set(u.key,Dn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new RS(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Fa();let s=new pt((o,a)=>o-a),i=Ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=t.get(c);if(u===null)return;let d=r.get(c)||Dn.empty();d=a.applyToLocalView(u,d),r.set(c,d);const f=(s.get(a.batchId)||Ve()).add(c);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,d=c.value,f=u0();d.forEach(g=>{if(!i.has(g)){const _=_0(t.get(g),r.get(g));_!==null&&f.set(g,_),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return de.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):If(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):N.resolve(dr());let a=-1,c=i;return o.next(u=>N.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ve())).next(d=>({batchId:a,changes:c0(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new de(t)).next(r=>{let s=Ea();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Ea();return this.indexManager.getCollectionParents(e,i).next(a=>N.forEach(a,c=>{const u=function(f,g){return new zr(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,_t.newInvalidDocument(d)))});let a=Ea();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Ua(d.mutation,u,Dn.empty(),Rt.now()),Tl(t,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return N.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Ut(s.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:kf(s.bundledQuery),readTime:Ut(s.readTime)}}(t)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(){this.overlays=new pt(de.comparator),this.Ir=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){const r=dr();return N.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),N.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){const s=dr(),i=t.length+1,o=new de(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return N.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new pt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=dr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=dr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=s)););return N.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Sf(t,r));let i=this.Ir.get(t);i===void 0&&(i=Ve(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this.Tr=new lt(Zt.Er),this.dr=new lt(Zt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new Zt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Zt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new de(new ze([])),r=new Zt(t,e),s=new Zt(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new de(new ze([])),r=new Zt(t,e),s=new Zt(t,e+1);let i=Ve();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Zt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Zt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return de.comparator(e.key,t.key)||Se(e.wr,t.wr)}static Ar(e,t){return Se(e.wr,t.wr)||de.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new lt(Zt.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xf(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new Zt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return N.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Zt(t,0),s=new Zt(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),N.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new lt(Se);return t.forEach(s=>{const i=new Zt(s,0),o=new Zt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;de.isDocumentKey(i)||(i=i.child(""));const o=new Zt(new de(i),0);let a=new lt(Se);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(c.wr)),!0)},o),N.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ge(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(t.mutations,s=>{const i=new Zt(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new Zt(t,0),s=this.br.firstAfterOrEqual(r);return N.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e){this.Mr=e,this.docs=function(){return new pt(de.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():_t.newInvalidDocument(t))}getEntries(e,t){let r=Vn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():_t.newInvalidDocument(s))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Vn();const o=t.path,a=new de(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||yf(Nv(d),r)<=0||(s.has(d.key)||Tl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return N.resolve(i)}getAllFromCollectionGroup(e,t,r,s){fe()}Or(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new OS(this)}getSize(e){return N.resolve(this.size)}}class OS extends K0{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e){this.persistence=e,this.Nr=new Gr(t=>pi(t),Il),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Nf,this.targetCount=0,this.kr=vi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),N.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new vi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Kn(t),N.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),N.waitFor(i).next(()=>s)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),N.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),N.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t){this.qr={},this.overlays={},this.Qr=new kn(0),this.Kr=!1,this.Kr=!0,this.$r=new DS,this.referenceDelegate=e(this),this.Ur=new MS(this),this.indexManager=new bS,this.remoteDocumentCache=function(s){return new NS(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new L0(t),this.Gr=new CS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new VS(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){J("MemoryPersistence","Starting transaction:",e);const s=new LS(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class LS extends Mv{constructor(e){super(),this.currentSequenceNumber=e}}class qu{constructor(e){this.persistence=e,this.Jr=new Nf,this.Yr=null}static Zr(e){return new qu(e)}get Xr(){if(this.Yr)return this.Yr;throw fe()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),N.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{const s=de.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,ve.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return N.or([()=>N.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class ou{constructor(e,t){this.persistence=e,this.ti=new Gr(r=>wn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=G0(this,t)}static Zr(e,t){return new ou(e,t)}zr(){}jr(e){return N.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return N.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?N.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,ve.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),N.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),N.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),N.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=kc(e.data.value)),t}nr(e,t,r){return N.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ti.get(t);return N.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e){this.serializer=e}O(e,t,r,s){const i=new Nu("createOrUpgrade",t);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",hg,{unique:!0}),c.createObjectStore("documentMutations")}(e),Zg(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=N.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Zg(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ve.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",hg,{unique:!0});const f=u.store("mutations"),g=d.map(_=>f.put(_));return N.waitFor(g)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:IP});u.createIndex("collectionPathOverlayIndex",EP,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",TP,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:dP});u.createIndex("documentKeyIndex",hP),u.createIndex("collectionGroupIndex",fP)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:yP}).createIndex("sequenceNumberIndex",vP,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:wP}).createIndex("documentKeyIndex",bP,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=iu(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>N.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>N.forEach(a,c=>{ge(c.userId===i.userId);const u=ti(this.serializer,c);return $0(e,i.userId,u).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const c=new ze(o),u=function(f){return[0,wn(f)]}(c);i.push(t.get(u).next(d=>d?N.resolve():(f=>t.put({targetId:0,path:wn(f),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>N.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:_P});const r=t.store("collectionParents"),s=new Vf,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:wn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new ze(o);return i(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],u)=>{const d=ur(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Aa(s),o=F0(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),c=function(f){return f.document?new de(ze.fromString(f.document.name).popFirst(5)):f.noDocument?de.fromSegments(f.noDocument.path):f.unknownDocument?de.fromSegments(f.unknownDocument.path):fe()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>N.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=H0(this.serializer),i=new Of(qu.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:Ve();ti(this.serializer,c).keys().forEach(f=>d=d.add(f)),a.set(c.userId,d)}),N.forEach(a,(c,u)=>{const d=new en(u),f=$u.lt(this.serializer,d),g=i.getIndexManager(d),_=ju.lt(d,this.serializer,g,i.referenceDelegate);return new W0(s,_,f,g).recalculateAndSaveOverlaysForDocumentKeys(new Eh(t,kn.oe),c).next()})})}}function Zg(n){n.createObjectStore("targetDocuments",{keyPath:mP}).createIndex("documentTargetsIndex",gP,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",pP,{unique:!0}),n.createObjectStore("targetGlobal")}const qd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Mf{constructor(e,t,r,s,i,o,a,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!Mf.D())throw new Y(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xS(this,s),this.Ai=t+"main",this.serializer=new L0(c),this.Ri=new fr(this.Ai,this.hi,new FS(this.serializer)),this.$r=new mS,this.Ur=new ES(this.referenceDelegate,this.serializer),this.remoteDocumentCache=H0(this.serializer),this.Gr=new pS,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Lt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Y(F.FAILED_PRECONDITION,qd);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new kn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>yc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Ms(e))return J("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return J("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ga(e).get("owner").next(t=>N.resolve(this.vi(t)))}Ci(e){return yc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Xt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return N.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?N.resolve(!0):ga(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new Y(F.FAILED_PRECONDITION,qd);return!1}}return!(!this.networkEnabled||!this.inForeground)||yc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&J("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Eh(e,kn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>yc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return ju.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new IS(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return $u.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){J("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(c){return c===17?PP:c===16?xP:c===15?wf:c===14?jv:c===13?$v:c===12?AP:c===11?Bv:void fe()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new Eh(a,this.Qr?this.Qr.next():kn.oe),t==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Lt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Y(F.FAILED_PRECONDITION,Ov);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return ga(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Y(F.FAILED_PRECONDITION,qd)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ga(e).put("owner",t)}static D(){return fr.D()}bi(e){const t=ga(e);return t.get("owner").next(r=>this.vi(r)?(J("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):N.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Lt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;mv()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return J("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Lt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Lt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ga(n){return Xt(n,"owner")}function yc(n){return Xt(n,"clientMetadata")}function Lf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Ve(),s=Ve();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ff(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return mv()?8:Lv(Yt())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new US;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Wi()<=qe.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Qi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(Wi()<=qe.DEBUG&&J("QueryEngine","Query:",Qi(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Wi()<=qe.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Qi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bn(t))):N.resolve())}Yi(e,t){if(Ag(t))return N.resolve(null);let r=bn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=tu(t,null,"F"),r=bn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ve(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(t,a);return this.ns(t,u,o,c.readTime)?this.Yi(e,tu(t,null,"F")):this.rs(e,u,t,c)}))})))}Zi(e,t,r,s){return Ag(t)||s.isEqual(ve.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?N.resolve(null):(Wi()<=qe.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qi(t)),this.rs(e,o,t,Vv(s,-1)).next(a=>a))})}ts(e,t){let r=new lt(a0(e));return t.forEach((s,i)=>{Tl(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return Wi()<=qe.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Qi(t)),this.Ji.getDocumentsMatchingQuery(e,t,Bn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new pt(Se),this._s=new Gr(i=>pi(i),Il),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new W0(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function J0(n,e,t,r){return new BS(n,e,t,r)}async function Y0(n,e){const t=oe(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=Ve();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){a.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function $S(n,e){const t=oe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){const f=u.batch,g=f.keys();let _=N.resolve();return g.forEach(D=>{_=_.next(()=>d.getEntry(c,D)).next(T=>{const C=u.docVersions.get(D);ge(C!==null),T.version.compareTo(C)<0&&(f.applyToRemoteDocument(T,u),T.isValidDocument()&&(T.setReadTime(u.commitVersion),d.addEntry(T)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=Ve();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function X0(n){const e=oe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function jS(n,e){const t=oe(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let _=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Vt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(f,_),function(T,C,U){return T.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(g,_,d)&&a.push(t.Ur.updateTargetData(i,_))});let c=Vn(),u=Ve();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(Z0(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ve.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return N.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(t.os=s,i))}function Z0(n,e,t){let r=Ve(),s=Ve();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Vn();return t.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ve.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):J("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function qS(n,e){const t=oe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function To(n,e){const t=oe(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,N.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new Rr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Ao(n,e,t){const r=oe(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ms(o))throw o;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function au(n,e,t){const r=oe(n);let s=ve.min(),i=Ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=oe(c),g=f._s.get(d);return g!==void 0?N.resolve(f.os.get(g)):f.Ur.getTargetData(u,d)}(r,o,bn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:ve.min(),t?i:Ve())).next(a=>(nw(r,o0(e),a),{documents:a,Ts:i})))}function ew(n,e){const t=oe(n),r=oe(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function tw(n,e){const t=oe(n),r=t.us.get(e)||ve.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,Vv(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(nw(t,e,s),s))}function nw(n,e,t){let r=n.us.get(e)||ve.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function zS(n,e,t,r){const s=oe(n);let i=Ve(),o=Vn();for(const u of t){const d=e.Es(u.metadata.name);u.document&&(i=i.add(d));const f=e.ds(u);f.setReadTime(e.As(u.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),c=await To(s,function(d){return bn(Oo(ze.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>Z0(u,a,o).next(d=>(a.apply(u),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.Ur.addMatchingKeys(u,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))}async function GS(n,e,t=Ve()){const r=await To(n,bn(kf(e.bundledQuery))),s=oe(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Ut(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(Vt.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function e_(n,e){return`firestore_clients_${n}_${e}`}function t_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function zd(n,e){return`firestore_targets_${n}_${e}`}class lu{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new Y(s.error.code,s.error.message))),o?new lu(e,t,s.state,i):(Lt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ba{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new Y(r.error.code,r.error.message))),i?new Ba(e,r.state,s):(Lt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class cu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Ef();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=Fv(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new cu(e,i):(Lt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Uf{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Uf(t.clientId,t.onlineState):(Lt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Lh{constructor(){this.activeTargetIds=Ef()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gd{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new pt(Se),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=e_(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Lh),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(e_(this.persistenceKey,r));if(s){const i=cu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(zd(this.persistenceKey,e));if(s){const i=Ba.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(zd(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return J("SharedClientState","READ",e,t),t}setItem(e,t){J("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){J("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(J("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=kn.oe;if(i!=null)try{const a=JSON.parse(i);ge(typeof a=="number"),o=a}catch(a){Lt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==kn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new lu(this.currentUser,e,t,r),i=t_(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=t_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=zd(this.persistenceKey,e),i=new Ba(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return cu.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return lu.Rs(new en(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return Ba.Rs(s,t)}Ls(e){return Uf.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);J("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Ef();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class rw{constructor(){this.so=new Lh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Lh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vc=null;function Kd(){return vc===null?vc=function(){return 268435456+Math.round(2147483648*Math.random())}():vc++,"0x"+vc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn="WebChannelConnection";class QS extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Kd(),c=this.xo(t,r.toUriEncodedString());J("RestConnection",`Sending RPC '${t}' ${a}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(t,c,u,s).then(d=>(J("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Kn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+No}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=HS[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Kd();return new Promise((o,a)=>{const c=new Tv;c.setWithCredentials(!0),c.listenOnce(Av.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sc.NO_ERROR:const d=c.getResponseJson();J(mn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Sc.TIMEOUT:J(mn,`RPC '${e}' ${i} timed out`),a(new Y(F.DEADLINE_EXCEEDED,"Request time out"));break;case Sc.HTTP_ERROR:const f=c.getStatus();if(J(mn,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const D=function(C){const U=C.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(U)>=0?U:F.UNKNOWN}(_.status);a(new Y(D,_.message))}else a(new Y(F.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Y(F.UNAVAILABLE,"Connection failed."));break;default:fe()}}finally{J(mn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);J(mn,`RPC '${e}' ${i} sending request:`,s),c.send(t,"POST",u,r,15)})}Bo(e,t,r){const s=Kd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Sv(),a=Pv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const d=i.join("");J(mn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const f=o.createWebChannel(d,c);let g=!1,_=!1;const D=new WS({Io:C=>{_?J(mn,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(g||(J(mn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),J(mn,`RPC '${e}' stream ${s} sending:`,C),f.send(C))},To:()=>f.close()}),T=(C,U,B)=>{C.listen(U,L=>{try{B(L)}catch(O){setTimeout(()=>{throw O},0)}})};return T(f,Ia.EventType.OPEN,()=>{_||(J(mn,`RPC '${e}' stream ${s} transport opened.`),D.yo())}),T(f,Ia.EventType.CLOSE,()=>{_||(_=!0,J(mn,`RPC '${e}' stream ${s} transport closed`),D.So())}),T(f,Ia.EventType.ERROR,C=>{_||(_=!0,Kn(mn,`RPC '${e}' stream ${s} transport errored:`,C),D.So(new Y(F.UNAVAILABLE,"The operation could not be completed")))}),T(f,Ia.EventType.MESSAGE,C=>{var U;if(!_){const B=C.data[0];ge(!!B);const L=B,O=L.error||((U=L[0])===null||U===void 0?void 0:U.error);if(O){J(mn,`RPC '${e}' stream ${s} received error:`,O);const q=O.status;let ie=function(A){const R=jt[A];if(R!==void 0)return b0(R)}(q),x=O.message;ie===void 0&&(ie=F.INTERNAL,x="Unknown error status: "+q+" with message "+O.message),_=!0,D.So(new Y(ie,x)),f.close()}else J(mn,`RPC '${e}' stream ${s} received:`,B),D.bo(B)}}),T(a,xv.STAT_EVENT,C=>{C.stat===bh.PROXY?J(mn,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===bh.NOPROXY&&J(mn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{D.wo()},0),D}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(){return typeof window<"u"?window:null}function Oc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sl(n){return new rS(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&J("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t,r,s,i,o,a,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Bf(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Lt(t.toString()),Lt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new Y(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class JS extends iw{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=oS(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Ut(o.readTime):ve.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Dh(this.serializer),t.addTarget=function(i,o){let a;const c=o.target;if(a=Zc(c)?{documents:k0(i,c)}:{query:Bu(i,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=A0(i,o.resumeToken);const u=Ch(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Eo(i,o.snapshotVersion.toTimestamp());const u=Ch(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=lS(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Dh(this.serializer),t.removeTarget=e,this.a_(t)}}class YS extends iw{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ge(!!e.streamToken),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=aS(e.writeResults,e.commitTime),r=Ut(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Dh(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>sl(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Y(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,kh(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y(F.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,kh(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Y(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class ZS{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Lt(t),this.D_=!1):J("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Fs(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=oe(c);u.L_.add(4),await Fo(u),u.q_.set("Unknown"),u.L_.delete(4),await Rl(u)}(this))})}),this.q_=new ZS(r,s)}}async function Rl(n){if(Fs(n))for(const e of n.B_)await e(!0)}async function Fo(n){for(const e of n.B_)await e(!1)}function zu(n,e){const t=oe(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),qf(t)?jf(t):Bo(t).r_()&&$f(t,e))}function xo(n,e){const t=oe(n),r=Bo(t);t.N_.delete(e),r.r_()&&ow(t,e),t.N_.size===0&&(r.r_()?r.o_():Fs(t)&&t.q_.set("Unknown"))}function $f(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Bo(n).A_(e)}function ow(n,e){n.Q_.xe(e),Bo(n).R_(e)}function jf(n){n.Q_=new ZP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Bo(n).start(),n.q_.v_()}function qf(n){return Fs(n)&&!Bo(n).n_()&&n.N_.size>0}function Fs(n){return oe(n).L_.size===0}function aw(n){n.Q_=void 0}async function tR(n){n.q_.set("Online")}async function nR(n){n.N_.forEach((e,t)=>{$f(n,e)})}async function rR(n,e){aw(n),qf(n)?(n.q_.M_(e),jf(n)):n.q_.set("Unknown")}async function sR(n,e,t){if(n.q_.set("Online"),e instanceof T0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await uu(n,r)}else if(e instanceof Nc?n.Q_.Ke(e):e instanceof E0?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ve.min()))try{const r=await X0(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(Vt.EMPTY_BYTE_STRING,d.snapshotVersion)),ow(i,c);const f=new Rr(d.target,c,u,d.sequenceNumber);$f(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await uu(n,r)}}async function uu(n,e,t){if(!Ms(e))throw e;n.L_.add(1),await Fo(n),n.q_.set("Offline"),t||(t=()=>X0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Rl(n)})}function lw(n,e){return e().catch(t=>uu(n,t,e))}async function Uo(n){const e=oe(n),t=Cs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;iR(e);)try{const s=await qS(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,oR(e,s)}catch(s){await uu(e,s)}cw(e)&&uw(e)}function iR(n){return Fs(n)&&n.O_.length<10}function oR(n,e){n.O_.push(e);const t=Cs(n);t.r_()&&t.V_&&t.m_(e.mutations)}function cw(n){return Fs(n)&&!Cs(n).n_()&&n.O_.length>0}function uw(n){Cs(n).start()}async function aR(n){Cs(n).p_()}async function lR(n){const e=Cs(n);for(const t of n.O_)e.m_(t.mutations)}async function cR(n,e,t){const r=n.O_.shift(),s=Pf.from(r,e,t);await lw(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Uo(n)}async function uR(n,e){e&&Cs(n).V_&&await async function(r,s){if(function(o){return w0(o)&&o!==F.ABORTED}(s.code)){const i=r.O_.shift();Cs(r).s_(),await lw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Uo(r)}}(n,e),cw(n)&&uw(n)}async function r_(n,e){const t=oe(n);t.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=Fs(t);t.L_.add(3),await Fo(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Rl(t)}async function Fh(n,e){const t=oe(n);e?(t.L_.delete(2),await Rl(t)):e||(t.L_.add(2),await Fo(t),t.q_.set("Unknown"))}function Bo(n){return n.K_||(n.K_=function(t,r,s){const i=oe(t);return i.w_(),new JS(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:tR.bind(null,n),Ro:nR.bind(null,n),mo:rR.bind(null,n),d_:sR.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),qf(n)?jf(n):n.q_.set("Unknown")):(await n.K_.stop(),aw(n))})),n.K_}function Cs(n){return n.U_||(n.U_=function(t,r,s){const i=oe(t);return i.w_(),new YS(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:aR.bind(null,n),mo:uR.bind(null,n),f_:lR.bind(null,n),g_:cR.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Uo(n)):(await n.U_.stop(),n.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new nn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new zf(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $o(n,e){if(Lt("AsyncQueue",`${e}: ${n}`),Ms(n))return new Y(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.comparator=e?(t,r)=>e(t,r)||de.comparator(t.key,r.key):(t,r)=>de.comparator(t.key,r.key),this.keyedMap=Ea(),this.sortedSet=new pt(this.comparator)}static emptySet(e){return new io(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof io)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new io;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(){this.W_=new pt(de.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):fe():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Po{constructor(e,t,r,s,i,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Po(e,t,io.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&El(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class hR{constructor(){this.queries=i_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=oe(t),i=s.queries;s.queries=i_(),i.forEach((o,a)=>{for(const c of a.j_)c.onError(r)})})(this,new Y(F.ABORTED,"Firestore shutting down"))}}function i_(){return new Gr(n=>i0(n),El)}async function Gf(n,e){const t=oe(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new dR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=$o(o,`Initialization of query '${Qi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&Hf(t)}async function Kf(n,e){const t=oe(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function fR(n,e){const t=oe(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&Hf(t)}function pR(n,e,t){const r=oe(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function Hf(n){n.Y_.forEach(e=>{e.next()})}var Uh,o_;(o_=Uh||(Uh={})).ea="default",o_.Cache="cache";class Wf{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Po(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Po.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Uh.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e){this.serializer=e}Es(e){return pr(this.serializer,e)}ds(e){return e.metadata.exists?C0(this.serializer,e.document,!1):_t.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ut(e)}}class gR{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=dw(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=ze.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new a_(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||Ve()).add(i);t.set(o,a)}}return t}async complete(){const e=await zS(this.localStore,new a_(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await GS(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function dw(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e){this.key=e}}class fw{constructor(e){this.key=e}}class pw{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ve(),this.mutatedKeys=Ve(),this.Aa=a0(e),this.Ra=new io(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new s_,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),_=Tl(this.query,f)?f:null,D=!!g&&this.mutatedKeys.has(g.key),T=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let C=!1;g&&_?g.data.isEqual(_.data)?D!==T&&(r.track({type:3,doc:_}),C=!0):this.ga(g,_)||(r.track({type:2,doc:_}),C=!0,(c&&this.Aa(_,c)>0||u&&this.Aa(_,u)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),C=!0):g&&!_&&(r.track({type:1,doc:g}),C=!0,(c||u)&&(a=!0)),C&&(_?(o=o.add(_),i=T?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(_,D){const T=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe()}};return T(_)-T(D)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Po(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new s_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ve(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new fw(r))}),this.da.forEach(r=>{e.has(r)||t.push(new hw(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ve();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Po.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class _R{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class yR{constructor(e){this.key=e,this.va=!1}}class vR{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Gr(a=>i0(a),El),this.Ma=new Map,this.xa=new Set,this.Oa=new pt(de.comparator),this.Na=new Map,this.La=new Nf,this.Ba={},this.ka=new Map,this.qa=vi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function wR(n,e,t=!0){const r=Gu(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await mw(r,e,t,!0),s}async function bR(n,e){const t=Gu(n);await mw(t,e,!0,!1)}async function mw(n,e,t,r){const s=await To(n.localStore,bn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Qf(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&zu(n.remoteStore,s),a}async function Qf(n,e,t,r,s){n.Ka=(f,g,_)=>async function(T,C,U,B){let L=C.view.ma(U);L.ns&&(L=await au(T.localStore,C.query,!1).then(({documents:x})=>C.view.ma(x,L)));const O=B&&B.targetChanges.get(C.targetId),q=B&&B.targetMismatches.get(C.targetId)!=null,ie=C.view.applyChanges(L,T.isPrimaryClient,O,q);return Bh(T,C.targetId,ie.wa),ie.snapshot}(n,f,g,_);const i=await au(n.localStore,e,!0),o=new pw(e,i.Ts),a=o.ma(i.documents),c=Pl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,c);Bh(n,t,u.wa);const d=new _R(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function IR(n,e,t){const r=oe(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!El(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Ao(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&xo(r.remoteStore,s.targetId),So(r,s.targetId)}).catch(Os)):(So(r,s.targetId),await Ao(r.localStore,s.targetId,!0))}async function ER(n,e){const t=oe(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),xo(t.remoteStore,r.targetId))}async function TR(n,e,t){const r=Zf(n);try{const s=await function(o,a){const c=oe(o),u=Rt.now(),d=a.reduce((_,D)=>_.add(D.key),Ve());let f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let D=Vn(),T=Ve();return c.cs.getEntries(_,d).next(C=>{D=C,D.forEach((U,B)=>{B.isValidDocument()||(T=T.add(U))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,D)).next(C=>{f=C;const U=[];for(const B of a){const L=JP(B,f.get(B.key).overlayedDocument);L!=null&&U.push(new Kr(B.key,L,Wv(L.value.mapValue),Tt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,U,a)}).next(C=>{g=C;const U=C.applyToLocalDocumentSet(f,T);return c.documentOverlayCache.saveOverlays(_,C.batchId,U)})}).then(()=>({batchId:g.batchId,changes:c0(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new pt(Se)),u=u.insert(a,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,t),await Hr(r,s.changes),await Uo(r.remoteStore)}catch(s){const i=$o(s,"Failed to persist write");t.reject(i)}}async function gw(n,e){const t=oe(n);try{const r=await jS(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(ge(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ge(o.va):s.removedDocuments.size>0&&(ge(o.va),o.va=!1))}),await Hr(t,r,e)}catch(r){await Os(r)}}function l_(n,e,t){const r=oe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=oe(o);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(a)&&(u=!0)}),u&&Hf(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function AR(n,e,t){const r=oe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new pt(de.comparator);o=o.insert(i,_t.newNoDocument(i,ve.min()));const a=Ve().add(i),c=new xl(ve.min(),new Map,new pt(Se),o,a);await gw(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Xf(r)}else await Ao(r.localStore,e,!1).then(()=>So(r,e,t)).catch(Os)}async function xR(n,e){const t=oe(n),r=e.batch.batchId;try{const s=await $S(t.localStore,e);Yf(t,r,null),Jf(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Hr(t,s)}catch(s){await Os(s)}}async function PR(n,e,t){const r=oe(n);try{const s=await function(o,a){const c=oe(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(ge(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Yf(r,e,t),Jf(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Hr(r,s)}catch(s){await Os(s)}}async function SR(n,e){const t=oe(n);Fs(t.remoteStore)||J("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=oe(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=$o(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Jf(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Yf(n,e,t){const r=oe(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function So(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||_w(n,r)})}function _w(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(xo(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Xf(n))}function Bh(n,e,t){for(const r of t)r instanceof hw?(n.La.addReference(r.key,e),RR(n,r)):r instanceof fw?(J("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||_w(n,r.key)):fe()}function RR(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(J("SyncEngine","New document in limbo: "+t),n.xa.add(r),Xf(n))}function Xf(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new de(ze.fromString(e)),r=n.qa.next();n.Na.set(r,new yR(t)),n.Oa=n.Oa.insert(t,r),zu(n.remoteStore,new Rr(bn(Oo(t.path)),r,"TargetPurposeLimboResolution",kn.oe))}}async function Hr(n,e,t){const r=oe(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=Ff.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=oe(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>N.forEach(u,g=>N.forEach(g.$i,_=>d.persistence.referenceDelegate.addReference(f,g.targetId,_)).next(()=>N.forEach(g.Ui,_=>d.persistence.referenceDelegate.removeReference(f,g.targetId,_)))))}catch(f){if(!Ms(f))throw f;J("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const _=d.os.get(g),D=_.snapshotVersion,T=_.withLastLimboFreeSnapshotVersion(D);d.os=d.os.insert(g,T)}}}(r.localStore,i))}async function CR(n,e){const t=oe(n);if(!t.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await Y0(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(c=>{c.reject(new Y(F.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Hr(t,r.hs)}}function kR(n,e){const t=oe(n),r=t.Na.get(e);if(r&&r.va)return Ve().add(r.key);{let s=Ve();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function DR(n,e){const t=oe(n),r=await au(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&Bh(t,e.targetId,s.wa),s}async function VR(n,e){const t=oe(n);return tw(t.localStore,e).then(r=>Hr(t,r))}async function NR(n,e,t,r){const s=oe(n),i=await function(a,c){const u=oe(a),d=oe(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,c).next(g=>g?u.localDocuments.getDocuments(f,g):N.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await Uo(s.remoteStore):t==="acknowledged"||t==="rejected"?(Yf(s,e,r||null),Jf(s,e),function(a,c){oe(oe(a).mutationQueue).On(c)}(s.localStore,e)):fe(),await Hr(s,i)):J("SyncEngine","Cannot apply mutation batch with id: "+e)}async function OR(n,e){const t=oe(n);if(Gu(t),Zf(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await c_(t,r.toArray());t.Qa=!0,await Fh(t.remoteStore,!0);for(const i of s)zu(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(So(t,o),Ao(t.localStore,o,!0))),xo(t.remoteStore,o)}),await s,await c_(t,r),function(o){const a=oe(o);a.Na.forEach((c,u)=>{xo(a.remoteStore,u)}),a.La.pr(),a.Na=new Map,a.Oa=new pt(de.comparator)}(t),t.Qa=!1,await Fh(t.remoteStore,!1)}}async function c_(n,e,t){const r=oe(n),s=[],i=[];for(const o of e){let a;const c=r.Ma.get(o);if(c&&c.length!==0){a=await To(r.localStore,bn(c[0]));for(const u of c){const d=r.Fa.get(u),f=await DR(r,d);f.snapshot&&i.push(f.snapshot)}}else{const u=await ew(r.localStore,o);a=await To(r.localStore,u),await Qf(r,yw(u),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function yw(n){return n0(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function MR(n){return function(t){return oe(oe(t).persistence).Qi()}(oe(n).localStore)}async function LR(n,e,t,r){const s=oe(n);if(s.Qa)return void J("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await tw(s.localStore,o0(i[0])),a=xl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Vt.EMPTY_BYTE_STRING);await Hr(s,o,a);break}case"rejected":await Ao(s.localStore,e,!0),So(s,e,r);break;default:fe()}}async function FR(n,e,t){const r=Gu(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){J("SyncEngine","Adding an already active target "+s);continue}const i=await ew(r.localStore,s),o=await To(r.localStore,i);await Qf(r,yw(i),o.targetId,!1,o.resumeToken),zu(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await Ao(r.localStore,s,!1).then(()=>{xo(r.remoteStore,s),So(r,s)}).catch(Os)}}function Gu(n){const e=oe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=gw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AR.bind(null,e),e.Ca.d_=fR.bind(null,e.eventManager),e.Ca.$a=pR.bind(null,e.eventManager),e}function Zf(n){const e=oe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PR.bind(null,e),e}function UR(n,e,t){const r=oe(n);(async function(i,o,a){try{const c=await o.getMetadata();if(await function(_,D){const T=oe(_),C=Ut(D.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",U=>T.Gr.getBundleMetadata(U,D.id)).then(U=>!!U&&U.createTime.compareTo(C)>=0)}(i.localStore,c))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(dw(c));const u=new gR(c,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await u.la(d);g&&a._updateProgress(g),d=await o.Ua()}const f=await u.complete();return await Hr(i,f.Ia,void 0),await function(_,D){const T=oe(_);return T.persistence.runTransaction("Save bundle","readwrite",C=>T.Gr.saveBundleMetadata(C,D))}(i.localStore,c),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(c){return Kn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class ks{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return J0(this.persistence,new Q0,e.initialUser,this.serializer)}Ga(e){return new Of(qu.Zr,this.serializer)}Wa(e){return new rw}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ks.provider={build:()=>new ks};class BR extends ks{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){ge(this.persistence.referenceDelegate instanceof ou);const r=this.persistence.referenceDelegate.garbageCollector;return new z0(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Of(r=>ou.Zr(r,t),this.serializer)}}class ep extends ks{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Zf(this.Ja.syncEngine),await Uo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return J0(this.persistence,new Q0,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new z0(r,e.asyncQueue,t)}Ha(e,t){const r=new lP(t,this.persistence);return new aP(e.asyncQueue,r)}Ga(e){const t=Lf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Mf(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,sw(),Oc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new rw}}class vw extends ep{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Gd&&(this.sharedClientState.syncEngine={no:NR.bind(null,t),ro:LR.bind(null,t),io:FR.bind(null,t),Qi:MR.bind(null,t),eo:VR.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await OR(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=sw();if(!Gd.D(t))throw new Y(F.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Lf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Gd(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ds{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>l_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=CR.bind(null,this.syncEngine),await Fh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new hR}()}createDatastore(e){const t=Sl(e.databaseInfo.databaseId),r=function(i){return new QS(i)}(e.databaseInfo);return function(i,o,a,c){return new XS(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new eR(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>l_(this.syncEngine,t,0),function(){return n_.D()?new n_:new KS}())}createSyncEngine(e,t){return function(s,i,o,a,c,u,d){const f=new vR(s,i,o,a,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=oe(s);J("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Fo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ds.provider={build:()=>new Ds};function u_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Lt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new nn,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new mR(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Y(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=oe(s),a={documents:i.map(f=>rl(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,ze.emptyPath(),a,i.length),u=new Map;c.forEach(f=>{const g=iS(o.serializer,f);u.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=u.get(f.toString());ge(!!g),d.push(g)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Lo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=de.fromPath(r);this.mutations.push(new Af(s,this.precondition(s)))}),await async function(r,s){const i=oe(r),o={writes:s.map(a=>sl(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,ze.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw fe();t=ve.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Y(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ve.min())?Tt.exists(!1):Tt.updateTime(t):Tt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ve.min()))throw new Y(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Tt.updateTime(t)}return Tt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new Bf(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new jR(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!bl(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!w0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=en.UNAUTHENTICATED,this.clientId=kv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{J("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new nn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=$o(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Hd(n,e){n.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Y0(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function d_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await tp(n);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>r_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>r_(e.remoteStore,s)),n._onlineComponents=e}async function tp(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await Hd(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Kn("Error using user provided cache. Falling back to memory cache: "+t),await Hd(n,new ks)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await Hd(n,new ks);return n._offlineComponents}async function Hu(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await d_(n,n._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await d_(n,new Ds))),n._onlineComponents}function ww(n){return tp(n).then(e=>e.persistence)}function jo(n){return tp(n).then(e=>e.localStore)}function bw(n){return Hu(n).then(e=>e.remoteStore)}function np(n){return Hu(n).then(e=>e.syncEngine)}function Iw(n){return Hu(n).then(e=>e.datastore)}async function Ro(n){const e=await Hu(n),t=e.eventManager;return t.onListen=wR.bind(null,e.syncEngine),t.onUnlisten=IR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=bR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ER.bind(null,e.syncEngine),t}function GR(n){return n.asyncQueue.enqueue(async()=>{const e=await ww(n),t=await bw(n);return e.setNetworkEnabled(!0),function(s){const i=oe(s);return i.L_.delete(0),Rl(i)}(t)})}function KR(n){return n.asyncQueue.enqueue(async()=>{const e=await ww(n),t=await bw(n);return e.setNetworkEnabled(!1),async function(s){const i=oe(s);i.L_.add(0),await Fo(i),i.q_.set("Offline")}(t)})}function HR(n,e){const t=new nn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(u,d){const f=oe(u);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new Y(F.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=$o(a,`Failed to get document '${i} from cache`);o.reject(c)}}(await jo(n),e,t)),t.promise}function Ew(n,e,t={}){const r=new nn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const d=new Ku({next:g=>{d.Za(),o.enqueueAndForget(()=>Kf(i,f));const _=g.docs.has(a);!_&&g.fromCache?u.reject(new Y(F.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&c&&c.source==="server"?u.reject(new Y(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Wf(Oo(a.path),d,{includeMetadataChanges:!0,_a:!0});return Gf(i,f)}(await Ro(n),n.asyncQueue,e,t,r)),r.promise}function WR(n,e){const t=new nn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await au(s,i,!0),c=new pw(i,a.Ts),u=c.ma(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){const c=$o(a,`Failed to execute query '${i} against cache`);o.reject(c)}}(await jo(n),e,t)),t.promise}function Tw(n,e,t={}){const r=new nn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const d=new Ku({next:g=>{d.Za(),o.enqueueAndForget(()=>Kf(i,f)),g.fromCache&&c.source==="server"?u.reject(new Y(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Wf(a,d,{includeMetadataChanges:!0,_a:!0});return Gf(i,f)}(await Ro(n),n.asyncQueue,e,t,r)),r.promise}function QR(n,e,t){const r=new nn;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await Iw(n);r.resolve(async function(o,a,c){var u;const d=oe(o),{request:f,ut:g,parent:_}=D0(d.serializer,r0(a),c);d.connection.Fo||delete f.parent;const D=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,_,f,1)).filter(C=>!!C.result);ge(D.length===1);const T=(u=D[0].result)===null||u===void 0?void 0:u.aggregateFields;return Object.keys(T).reduce((C,U)=>(C[g[U]]=T[U],C),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function JR(n,e){const t=new Ku(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){oe(s).Y_.add(i),i.next()}(await Ro(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){oe(s).Y_.delete(i)}(await Ro(n),t))}}function YR(n,e,t,r){const s=function(o,a){let c;return c=typeof o=="string"?I0().encode(o):o,function(d,f){return new $R(d,f)}(function(d,f){if(d instanceof Uint8Array)return u_(d,f);if(d instanceof ArrayBuffer)return u_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Sl(e));n.asyncQueue.enqueueAndForget(async()=>{UR(await np(n),s,r)})}function XR(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=oe(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await jo(n),e))}function ZR(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=oe(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",c=>o.getFieldIndexes(c).next(u=>function(f,g,_,D,T){f=[...f],g=[...g],f.sort(_),g.sort(_);const C=f.length,U=g.length;let B=0,L=0;for(;B<U&&L<C;){const O=_(f[L],g[B]);O<0?T(f[L++]):O>0?D(g[B++]):(B++,L++)}for(;B<U;)D(g[B++]);for(;L<C;)T(f[L++])}(u,s,rP,d=>{a.push(o.addFieldIndex(c,d))},d=>{a.push(o.deleteFieldIndex(c,d))})).next(()=>N.waitFor(a)))}(await jo(n),e))}function eC(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){oe(r).ss.zi=s}(await jo(n),e))}function tC(n){return n.asyncQueue.enqueue(async()=>function(t){const r=oe(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await jo(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(n,e,t){if(!t)throw new Y(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nC(n,e,t,r){if(e===!0&&r===!0)throw new Y(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function f_(n){if(!de.isDocumentKey(n))throw new Y(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function p_(n){if(de.isDocumentKey(n))throw new Y(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Wu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":fe()}function Be(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Y(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Wu(n);throw new Y(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function xw(n,e){if(e<=0)throw new Y(F.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Y(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Aw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Y(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Y(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Y(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cl{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new m_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new m_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Qx;switch(r.type){case"firstParty":return new Zx(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=h_.get(t);r&&(J("ComponentProvider","Removing Datastore"),h_.delete(t),r.terminate())}(this),Promise.resolve()}}function rC(n,e,t,r={}){var s;const i=(n=Be(n,Cl))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Kn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=en.MOCK_USER;else{a=TA(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Y(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new en(u)}n._authCredentials=new Jx(new Rv(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dn(this.firestore,e,this._query)}}class Bt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Bt(this.firestore,e,this._key)}}class mr extends dn{constructor(e,t,r){super(e,t,Oo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Bt(this.firestore,null,new de(e))}withConverter(e){return new mr(this.firestore,e,this._path)}}function tt(n,e,...t){if(n=we(n),rp("collection","path",e),n instanceof Cl){const r=ze.fromString(e,...t);return p_(r),new mr(n,null,r)}{if(!(n instanceof Bt||n instanceof mr))throw new Y(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return p_(r),new mr(n.firestore,null,r)}}function dL(n,e){if(n=Be(n,Cl),rp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Y(F.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dn(n,null,function(r){return new zr(ze.emptyPath(),r)}(e))}function ke(n,e,...t){if(n=we(n),arguments.length===1&&(e=kv.newId()),rp("doc","path",e),n instanceof Cl){const r=ze.fromString(e,...t);return f_(r),new Bt(n,null,new de(r))}{if(!(n instanceof Bt||n instanceof mr))throw new Y(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return f_(r),new Bt(n.firestore,n instanceof mr?n.converter:null,new de(r))}}function hL(n,e){return n=we(n),e=we(e),(n instanceof Bt||n instanceof mr)&&(e instanceof Bt||e instanceof mr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Pw(n,e){return n=we(n),e=we(e),n instanceof dn&&e instanceof dn&&n.firestore===e.firestore&&El(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Bf(this,"async_queue_retry"),this.Vu=()=>{const r=Oc();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Oc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Oc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new nn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ms(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Lt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=zf.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&fe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function $h(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class sC{constructor(){this._progressObserver={},this._taskCompletionResolver=new nn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=-1;class dt extends Cl{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new g_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new g_(e),this._firestoreClient=void 0,await e}}}function pL(n,e,t){t||(t="(default)");const r=wl(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(As(i,e))return s;throw new Y(F.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Y(F.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function iC(n,e){const t=typeof n=="object"?n:wv(),r=typeof n=="string"?n:e||"(default)",s=wl(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=IA("firestore");i&&rC(s,...i)}return s}function Ct(n){if(n._terminated)throw new Y(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Sw(n),n._firestoreClient}function Sw(n){var e,t,r;const s=n._freezeSettings(),i=function(a,c,u,d){return new RP(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Aw(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new zR(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(n._componentsProvider))}function mL(n,e){Kn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Rw(n,Ds.provider,{build:r=>new ep(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function gL(n){Kn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Rw(n,Ds.provider,{build:t=>new vw(t,e.cacheSizeBytes)})}function Rw(n,e,t){if((n=Be(n,dt))._firestoreClient||n._terminated)throw new Y(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Y(F.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Sw(n)}function _L(n){if(n._initialized&&!n._terminated)throw new Y(F.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new nn;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!fr.D())return Promise.resolve();const s=r+"main";await fr.delete(s)}(Lf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function yL(n){return function(t){const r=new nn;return t.asyncQueue.enqueueAndForget(async()=>SR(await np(t),r)),r.promise}(Ct(n=Be(n,dt)))}function vL(n){return GR(Ct(n=Be(n,dt)))}function wL(n){return KR(Ct(n=Be(n,dt)))}function bL(n){return Ox(n.app,"firestore",n._databaseId.database),n._delete()}function IL(n,e){const t=Ct(n=Be(n,dt)),r=new sC;return YR(t,n._databaseId,e,r),r}function EL(n,e){return XR(Ct(n=Be(n,dt)),e).then(t=>t?new dn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class oC{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wi(Vt.fromBase64String(e))}catch(t){throw new Y(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new wi(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Y(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function TL(){return new Ei("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Y(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Y(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Se(this._lat,e._lat)||Se(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC=/^__.*__$/;class lC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Kr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mo(e,this.data,t,this.fieldTransforms)}}class Cw{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Kr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function kw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe()}}class Ju{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ju(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return du(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(kw(this.Cu)&&aC.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class cC{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Sl(e)}Qu(e,t,r,s=!1){return new Ju({Cu:e,methodName:t,qu:r,path:Et.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ai(n){const e=n._freezeSettings(),t=Sl(n._databaseId);return new cC(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Yu(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);dp("Data must be an object, but it was:",o,r);const a=Nw(r,o);let c,u;if(i.merge)c=new Dn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=ol(e,f,t);if(!o.contains(g))throw new Y(F.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Mw(d,g)||d.push(g)}c=new Dn(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new lC(new un(a),c,u)}class kl extends Ti{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof kl}}function Dw(n,e,t){return new Ju({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ip extends Ti{_toFieldTransform(e){return new Al(e.path,new bo)}isEqual(e){return e instanceof ip}}class op extends Ti{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Dw(this,e,!0),r=this.Ku.map(i=>xi(i,t)),s=new mi(r);return new Al(e.path,s)}isEqual(e){return e instanceof op&&As(this.Ku,e.Ku)}}class ap extends Ti{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Dw(this,e,!0),r=this.Ku.map(i=>xi(i,t)),s=new gi(r);return new Al(e.path,s)}isEqual(e){return e instanceof ap&&As(this.Ku,e.Ku)}}class lp extends Ti{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Io(e.serializer,h0(e.serializer,this.$u));return new Al(e.path,t)}isEqual(e){return e instanceof lp&&this.$u===e.$u}}function cp(n,e,t,r){const s=n.Qu(1,e,t);dp("Data must be an object, but it was:",s,r);const i=[],o=un.empty();Ls(r,(c,u)=>{const d=Xu(e,c,t);u=we(u);const f=s.Nu(d);if(u instanceof kl)i.push(d);else{const g=xi(u,f);g!=null&&(i.push(d),o.set(d,g))}});const a=new Dn(i);return new Cw(o,a,s.fieldTransforms)}function up(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[ol(e,r,t)],c=[s];if(i.length%2!=0)throw new Y(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(ol(e,i[g])),c.push(i[g+1]);const u=[],d=un.empty();for(let g=a.length-1;g>=0;--g)if(!Mw(u,a[g])){const _=a[g];let D=c[g];D=we(D);const T=o.Nu(_);if(D instanceof kl)u.push(_);else{const C=xi(D,T);C!=null&&(u.push(_),d.set(_,C))}}const f=new Dn(u);return new Cw(d,f,o.fieldTransforms)}function Vw(n,e,t,r=!1){return xi(t,n.Qu(r?4:3,e))}function xi(n,e){if(Ow(n=we(n)))return dp("Unsupported field value:",e,n),Nw(n,e);if(n instanceof Ti)return function(r,s){if(!kw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=xi(a,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return h0(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Rt.fromDate(r);return{timestampValue:Eo(s.serializer,i)}}if(r instanceof Rt){const i=new Rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Eo(s.serializer,i)}}if(r instanceof sp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wi)return{bytesValue:A0(s.serializer,r._byteString)};if(r instanceof Bt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Cf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Qu)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return Tf(a.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Wu(r)}`)}(n,e)}function Nw(n,e){const t={};return zv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ls(n,(r,s)=>{const i=xi(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function Ow(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Rt||n instanceof sp||n instanceof wi||n instanceof Bt||n instanceof Ti||n instanceof Qu)}function dp(n,e,t){if(!Ow(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Wu(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function ol(n,e,t){if((e=we(e))instanceof Ei)return e._internalPath;if(typeof e=="string")return Xu(n,e);throw du("Field path arguments must be of type string or ",n,!1,void 0,t)}const uC=new RegExp("[~\\*/\\[\\]]");function Xu(n,e,t){if(e.search(uC)>=0)throw du(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ei(...e.split("."))._internalPath}catch{throw du(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function du(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Y(F.INVALID_ARGUMENT,a+n+c)}function Mw(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Zu("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class dC extends al{data(){return super.data()}}function Zu(n,e){return typeof e=="string"?Xu(n,e):e instanceof Ei?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Y(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hp{}class Dl extends hp{}function Fw(n,e,...t){let r=[];e instanceof hp&&r.push(e),r=r.concat(t),function(i){const o=i.filter(c=>c instanceof qo).length,a=i.filter(c=>c instanceof Vl).length;if(o>1||o>0&&a>0)throw new Y(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class Vl extends Dl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Vl(e,t,r)}_apply(e){const t=this._parse(e);return Bw(e._query,t),new dn(e.firestore,e.converter,Rh(e._query,t))}_parse(e){const t=Ai(e.firestore);return function(i,o,a,c,u,d,f){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Y(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){y_(f,d);const _=[];for(const D of f)_.push(__(c,i,D));g={arrayValue:{values:_}}}else g=__(c,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||y_(f,d),g=Vw(a,o,f,d==="in"||d==="not-in");return Ge.create(u,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hC(n,e,t){const r=e,s=Zu("where",n);return Vl._create(s,r,t)}class qo extends hp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qo(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:it.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)Bw(o,c),o=Rh(o,c)}(e._query,t),new dn(e.firestore,e.converter,Rh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function AL(...n){return n.forEach(e=>$w("or",e)),qo._create("or",n)}function xL(...n){return n.forEach(e=>$w("and",e)),qo._create("and",n)}class fp extends Dl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new fp(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new Y(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Y(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nl(i,o)}(e._query,this._field,this._direction);return new dn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new zr(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function fC(n,e="asc"){const t=e,r=Zu("orderBy",n);return fp._create(r,t)}class ed extends Dl{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new ed(e,t,r)}_apply(e){return new dn(e.firestore,e.converter,tu(e._query,this._limit,this._limitType))}}function PL(n){return xw("limit",n),ed._create("limit",n,"F")}function SL(n){return xw("limitToLast",n),ed._create("limitToLast",n,"L")}class td extends Dl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new td(e,t,r)}_apply(e){const t=Uw(e,this.type,this._docOrFields,this._inclusive);return new dn(e.firestore,e.converter,function(s,i){return new zr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function RL(...n){return td._create("startAt",n,!0)}function CL(...n){return td._create("startAfter",n,!1)}class nd extends Dl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new nd(e,t,r)}_apply(e){const t=Uw(e,this.type,this._docOrFields,this._inclusive);return new dn(e.firestore,e.converter,function(s,i){return new zr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function kL(...n){return nd._create("endBefore",n,!1)}function DL(...n){return nd._create("endAt",n,!0)}function Uw(n,e,t,r){if(t[0]=we(t[0]),t[0]instanceof al)return function(i,o,a,c,u){if(!c)throw new Y(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of so(i))if(f.field.isKeyField())d.push(fi(o,c.key));else{const g=c.data.field(f.field);if(Ou(g))throw new Y(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const _=f.field.canonicalString();throw new Y(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(g)}return new Rs(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Ai(n.firestore);return function(o,a,c,u,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new Y(F.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let D=0;D<d.length;D++){const T=d[D];if(g[D].field.isKeyField()){if(typeof T!="string")throw new Y(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof T}`);if(!If(o)&&T.indexOf("/")!==-1)throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${T}' contains a slash.`);const C=o.path.child(ze.fromString(T));if(!de.isDocumentKey(C))throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${C}' is not because it contains an odd number of segments.`);const U=new de(C);_.push(fi(a,U))}else{const C=Vw(c,u,T);_.push(C)}}return new Rs(_,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function __(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!If(e)&&t.indexOf("/")!==-1)throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ze.fromString(t));if(!de.isDocumentKey(r))throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fi(n,new de(r))}if(t instanceof Bt)return fi(n,t._key);throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wu(t)}.`)}function y_(n,e){if(!Array.isArray(n)||n.length===0)throw new Y(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Bw(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Y(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function $w(n,e){if(!(e instanceof Vl||e instanceof qo))throw new Y(F.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class jw{convertValue(e,t="none"){switch(Ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw fe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ls(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>It(o.doubleValue));return new Qu(i)}convertGeoPoint(e){return new sp(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Mu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Za(e));default:return null}}convertTimestamp(e){const t=Lr(e);return new Rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ze.fromString(e);ge(M0(r));const s=new hi(r.get(1),r.get(3)),i=new de(r.popFirst(5));return s.isEqual(t)||Lt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class pC extends jw{constructor(e){super(),this.firestore=e}convertBytes(e){return new wi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Bt(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(n){return new il("sum",ol("sum",n))}function NL(n){return new il("avg",ol("average",n))}function mC(){return new il("count")}function OL(n,e){var t,r;return n instanceof il&&e instanceof il&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function ML(n,e){return Pw(n.query,e.query)&&As(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Co extends al{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Mc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Zu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Mc extends Co{data(e={}){return super.data(e)}}class ko{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new si(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Mc(this._firestore,this._userDataWriter,r.key,r,new si(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Y(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Mc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new si(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Mc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new si(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:gC(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function gC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe()}}function LL(n,e){return n instanceof Co&&e instanceof Co?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ko&&e instanceof ko&&n._firestore===e._firestore&&Pw(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pi(n){n=Be(n,Bt);const e=Be(n.firestore,dt);return Ew(Ct(e),n._key).then(t=>pp(e,n,t))}class Us extends jw{constructor(e){super(),this.firestore=e}convertBytes(e){return new wi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Bt(this.firestore,null,t)}}function FL(n){n=Be(n,Bt);const e=Be(n.firestore,dt),t=Ct(e),r=new Us(e);return HR(t,n._key).then(s=>new Co(e,r,n._key,s,new si(s!==null&&s.hasLocalMutations,!0),n.converter))}function UL(n){n=Be(n,Bt);const e=Be(n.firestore,dt);return Ew(Ct(e),n._key,{source:"server"}).then(t=>pp(e,n,t))}function St(n){n=Be(n,dn);const e=Be(n.firestore,dt),t=Ct(e),r=new Us(e);return Lw(n._query),Tw(t,n._query).then(s=>new ko(e,r,n,s))}function BL(n){n=Be(n,dn);const e=Be(n.firestore,dt),t=Ct(e),r=new Us(e);return WR(t,n._query).then(s=>new ko(e,r,n,s))}function $L(n){n=Be(n,dn);const e=Be(n.firestore,dt),t=Ct(e),r=new Us(e);return Tw(t,n._query,{source:"server"}).then(s=>new ko(e,r,n,s))}function Pn(n,e,t){n=Be(n,Bt);const r=Be(n.firestore,dt),s=rd(n.converter,e,t);return Nl(r,[Yu(Ai(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Tt.none())])}function jL(n,e,t,...r){n=Be(n,Bt);const s=Be(n.firestore,dt),i=Ai(s);let o;return o=typeof(e=we(e))=="string"||e instanceof Ei?up(i,"updateDoc",n._key,e,t,r):cp(i,"updateDoc",n._key,e),Nl(s,[o.toMutation(n._key,Tt.exists(!0))])}function ll(n){return Nl(Be(n.firestore,dt),[new Lo(n._key,Tt.none())])}function qw(n,e){const t=Be(n.firestore,dt),r=ke(n),s=rd(n.converter,e);return Nl(t,[Yu(Ai(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Tt.exists(!1))]).then(()=>r)}function qL(n,...e){var t,r,s;n=we(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||$h(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if($h(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let c,u,d;if(n instanceof Bt)u=Be(n.firestore,dt),d=Oo(n._key.path),c={next:f=>{e[o]&&e[o](pp(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Be(n,dn);u=Be(f.firestore,dt),d=f._query;const g=new Us(u);c={next:_=>{e[o]&&e[o](new ko(u,g,f,_))},error:e[o+1],complete:e[o+2]},Lw(n._query)}return function(g,_,D,T){const C=new Ku(T),U=new Wf(_,C,D);return g.asyncQueue.enqueueAndForget(async()=>Gf(await Ro(g),U)),()=>{C.Za(),g.asyncQueue.enqueueAndForget(async()=>Kf(await Ro(g),U))}}(Ct(u),d,a,c)}function zL(n,e){return JR(Ct(n=Be(n,dt)),$h(e)?e:{next:e})}function Nl(n,e){return function(r,s){const i=new nn;return r.asyncQueue.enqueueAndForget(async()=>TR(await np(r),s,i)),i.promise}(Ct(n),e)}function pp(n,e,t){const r=t.docs.get(e._key),s=new Us(n);return new Co(n,s,e._key,r,new si(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(n){return _C(n,{count:mC()})}function _C(n,e){const t=Be(n.firestore,dt),r=Ct(t),s=qv(e,(i,o)=>new v0(o,i.aggregateType,i._internalFieldPath));return QR(r,n._query,s).then(i=>function(a,c,u){const d=new Us(a);return new oC(c,d,u)}(t,n,i))}class yC{constructor(e){this.kind="memory",this._onlineComponentProvider=Ds.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=ks.provider}toJSON(){return{kind:this.kind}}}class vC{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=TC(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class wC{constructor(){this.kind="memoryEager",this._offlineComponentProvider=ks.provider}toJSON(){return{kind:this.kind}}}class bC{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new BR(e)}}toJSON(){return{kind:this.kind}}}function KL(){return new wC}function HL(n){return new bC(n==null?void 0:n.cacheSizeBytes)}function WL(n){return new yC(n)}function QL(n){return new vC(n)}class IC{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ds.provider,this._offlineComponentProvider={build:t=>new ep(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class EC{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ds.provider,this._offlineComponentProvider={build:t=>new vw(t,e==null?void 0:e.cacheSizeBytes)}}}function TC(n){return new IC(n==null?void 0:n.forceOwnership)}function JL(){return new EC}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ai(e)}set(e,t,r){this._verifyNotCommitted();const s=ds(e,this._firestore),i=rd(s.converter,t,r),o=Yu(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Tt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=ds(e,this._firestore);let o;return o=typeof(t=we(t))=="string"||t instanceof Ei?up(this._dataReader,"WriteBatch.update",i._key,t,r,s):cp(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Tt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ds(e,this._firestore);return this._mutations=this._mutations.concat(new Lo(t._key,Tt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Y(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ds(n,e){if((n=we(n)).firestore!==e)throw new Y(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ai(t)}get(t){const r=ds(t,this._firestore),s=new pC(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return fe();const o=i[0];if(o.isFoundDocument())return new al(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new al(this._firestore,s,r._key,null,r.converter);throw fe()})}set(t,r,s){const i=ds(t,this._firestore),o=rd(i.converter,r,s),a=Yu(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=ds(t,this._firestore);let a;return a=typeof(r=we(r))=="string"||r instanceof Ei?up(this._dataReader,"Transaction.update",o._key,r,s,i):cp(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=ds(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ds(e,this._firestore),r=new Us(this._firestore);return super.get(e).then(s=>new Co(this._firestore,r,t._key,s._document,new si(!1,!1),t.converter))}}function XL(n,e,t){n=Be(n,dt);const r=Object.assign(Object.assign({},AC),t);return function(i){if(i.maxAttempts<1)throw new Y(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const c=new nn;return i.asyncQueue.enqueueAndForget(async()=>{const u=await Iw(i);new qR(i.asyncQueue,u,a,o,c).au()}),c.promise}(Ct(n),s=>e(new PC(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(){return new kl("deleteField")}function mp(){return new ip("serverTimestamp")}function eF(...n){return new op("arrayUnion",n)}function tF(...n){return new ap("arrayRemove",n)}function nF(n){return new lp("increment",n)}function rF(n){return new Qu(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(n){return Ct(n=Be(n,dt)),new xC(n,e=>Nl(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(n,e){const t=Ct(n=Be(n,dt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Kn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(u){try{return JSON.parse(u)}catch(d){throw new Y(F.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const c of o.indexes){const u=v_(c,"collectionGroup"),d=[];if(Array.isArray(c.fields))for(const f of c.fields){const g=Xu("setIndexConfiguration",v_(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new ci(g,2)):f.order==="ASCENDING"?d.push(new ci(g,0)):f.order==="DESCENDING"&&d.push(new ci(g,1))}a.push(new _o(_o.UNKNOWN_ID,u,d,yo.empty()))}return a}(e);return ZR(t,r)}function v_(n,e){if(typeof n[e]!="string")throw new Y(F.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function iF(n){var e;n=Be(n,dt);const t=w_.get(n);if(t)return t;if(((e=Ct(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new SC(n);return w_.set(n,r),r}function oF(n){Gw(n,!0)}function aF(n){Gw(n,!1)}function lF(n){tC(Ct(n._firestore)).then(e=>J("deleting all persistent cache indexes succeeded")).catch(e=>Kn("deleting all persistent cache indexes failed",e))}function Gw(n,e){eC(Ct(n._firestore),e).then(t=>J(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>Kn(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const w_=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(n){var e;const t=(e=Ct(Be(n.firestore,dt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Bu(t,bn(n._query))._t}function uF(n,e){var t;const r=qv(e,(i,o)=>new v0(o,i.aggregateType,i._internalFieldPath)),s=(t=Ct(Be(n.firestore,dt))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:D0(s,r0(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return gp.instance.onExistenceFilterMismatch(e)}}class gp{constructor(){this.Uu=new Map}static get instance(){return wc||(wc=new gp,function(t){if(nu)throw new Error("a TestingHooksSpi instance is already set");nu=t}(wc)),wc}et(e){this.Uu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let wc=null;(function(e,t=!0){(function(s){No=s})(Vo),mo(new di("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new dt(new Yx(r.getProvider("auth-internal")),new eP(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Y(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hi(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),bs(cg,"4.7.3",e),bs(cg,"4.7.3","esm2017")})();function _p(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF={PHONE:"phone",TOTP:"totp"},fF={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},pF={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},mF={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},gF={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function Kw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _F=RC,CC=Kw,Hw=new vl("auth","Firebase",Kw()),yF={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=new mf("@firebase/auth");function kC(n,...e){hu.logLevel<=qe.WARN&&hu.warn(`Auth (${Vo}): ${n}`,...e)}function Lc(n,...e){hu.logLevel<=qe.ERROR&&hu.error(`Auth (${Vo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(n,...e){throw vp(n,...e)}function Sn(n,...e){return vp(n,...e)}function yp(n,e,t){const r=Object.assign(Object.assign({},CC()),{[e]:t});return new vl("auth","Firebase",r).create(e,{appName:n.name})}function rn(n){return yp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zo(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Nn(n,"argument-error"),yp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function vp(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Hw.create(n,...e)}function ne(n,e,...t){if(!n)throw vp(e,...t)}function hr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Lc(e),new Error(e)}function Ur(n,e){n||hr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function wp(){return b_()==="http:"||b_()==="https:"}function b_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wp()||SA()||"connection"in navigator)?navigator.onLine:!0}function VC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ur(t>e,"Short delay should be less than long delay!"),this.isMobile=AA()||RA()}get(){return DC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(n,e){Ur(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new Ol(3e4,6e4);function yt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function vt(n,e,t,r,s={}){return Qw(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Do(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:c},i);return PA()||(u.referrerPolicy="no-referrer"),Ww.fetch()(Jw(n,n.config.apiHost,t,a),u)})}async function Qw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},NC),e);try{const s=new LC(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw xa(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw xa(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw xa(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw xa(n,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw yp(n,d,u);Nn(n,d)}}catch(s){if(s instanceof qr)throw s;Nn(n,"network-request-failed",{message:String(s)})}}async function Wr(n,e,t,r,s={}){const i=await vt(n,e,t,r,s);return"mfaPendingCredential"in i&&Nn(n,"multi-factor-auth-required",{_serverResponse:i}),i}function Jw(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?bp(n.config,s):`${n.config.apiScheme}://${s}`}function MC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Sn(this.auth,"network-request-failed")),OC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function xa(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Sn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(n){return n!==void 0&&n.getResponse!==void 0}function E_(n){return n!==void 0&&n.enterprise!==void 0}class Yw{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return MC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FC(n){return(await vt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Xw(n,e){return vt(n,"GET","/v2/recaptchaConfig",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(n,e){return vt(n,"POST","/v1/accounts:delete",e)}async function BC(n,e){return vt(n,"POST","/v1/accounts:update",e)}async function Zw(n,e){return vt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(n,e=!1){return we(n).getIdToken(e)}async function $C(n,e=!1){const t=we(n),r=await t.getIdToken(e),s=sd(r);ne(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:$a(Wd(s.auth_time)),issuedAtTime:$a(Wd(s.iat)),expirationTime:$a(Wd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Wd(n){return Number(n)*1e3}function sd(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Lc("JWT malformed, contained fewer than 3 sections"),null;try{const s=dv(t);return s?JSON.parse(s):(Lc("Failed to decode base64 JWT payload"),null)}catch(s){return Lc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function T_(n){const e=sd(n);return ne(e,"internal-error"),ne(typeof e.exp<"u","internal-error"),ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Br(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof qr&&jC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function jC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$a(this.lastLoginAt),this.creationTime=$a(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ul(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Br(n,Zw(t,{idToken:r}));ne(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?eb(i.providerUserInfo):[],a=GC(n.providerData,o),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new jh(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function zC(n){const e=we(n);await ul(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GC(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function eb(n){return n.map(e=>{var{providerId:t}=e,r=_p(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KC(n,e){const t=await Qw(n,{},async()=>{const r=Do({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Jw(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Ww.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function HC(n,e){return vt(n,"POST","/v2/accounts:revokeToken",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ne(e.idToken,"internal-error"),ne(typeof e.idToken<"u","internal-error"),ne(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):T_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ne(e.length!==0,"internal-error");const t=T_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await KC(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new oo;return r&&(ne(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ne(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ne(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new oo,this.toJSON())}_performRefresh(){return hr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(n,e){ne(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Cr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=_p(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new qC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new jh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Br(this,this.stsTokenManager.getToken(this.auth,e));return ne(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return $C(this,e)}reload(){return zC(this)}_assign(e){this!==e&&(ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Cr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ul(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ft(this.auth.app))return Promise.reject(rn(this.auth));const e=await this.getIdToken();return await Br(this,UC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,c,u,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(s=t.email)!==null&&s!==void 0?s:void 0,_=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,D=(o=t.photoURL)!==null&&o!==void 0?o:void 0,T=(a=t.tenantId)!==null&&a!==void 0?a:void 0,C=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,U=(u=t.createdAt)!==null&&u!==void 0?u:void 0,B=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:L,emailVerified:O,isAnonymous:q,providerData:ie,stsTokenManager:x}=t;ne(L&&x,e,"internal-error");const E=oo.fromJSON(this.name,x);ne(typeof L=="string",e,"internal-error"),ss(f,e.name),ss(g,e.name),ne(typeof O=="boolean",e,"internal-error"),ne(typeof q=="boolean",e,"internal-error"),ss(_,e.name),ss(D,e.name),ss(T,e.name),ss(C,e.name),ss(U,e.name),ss(B,e.name);const A=new Cr({uid:L,auth:e,email:g,emailVerified:O,displayName:f,isAnonymous:q,photoURL:D,phoneNumber:_,tenantId:T,stsTokenManager:E,createdAt:U,lastLoginAt:B});return ie&&Array.isArray(ie)&&(A.providerData=ie.map(R=>Object.assign({},R))),C&&(A._redirectEventId=C),A}static async _fromIdTokenResponse(e,t,r=!1){const s=new oo;s.updateFromServerResponse(t);const i=new Cr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ul(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ne(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?eb(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new oo;a.updateFromIdToken(r);const c=new Cr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new jh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=new Map;function kr(n){Ur(n instanceof Function,"Expected a class definition");let e=A_.get(n);return e?(Ur(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,A_.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}tb.type="NONE";const x_=tb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(n,e,t){return`firebase:${n}:${e}:${t}`}class ao{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Fc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Fc("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Cr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ao(kr(x_),e,r);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||kr(x_);const o=Fc(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){const f=Cr._fromJSON(e,d);u!==i&&(a=f),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ao(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new ao(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ib(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ab(e))return"Blackberry";if(lb(e))return"Webos";if(rb(e))return"Safari";if((e.includes("chrome/")||sb(e))&&!e.includes("edge/"))return"Chrome";if(ob(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function nb(n=Yt()){return/firefox\//i.test(n)}function rb(n=Yt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sb(n=Yt()){return/crios\//i.test(n)}function ib(n=Yt()){return/iemobile/i.test(n)}function ob(n=Yt()){return/android/i.test(n)}function ab(n=Yt()){return/blackberry/i.test(n)}function lb(n=Yt()){return/webos/i.test(n)}function Ip(n=Yt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function WC(n=Yt()){var e;return Ip(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function QC(){return CA()&&document.documentMode===10}function cb(n=Yt()){return Ip(n)||ob(n)||lb(n)||ab(n)||/windows phone/i.test(n)||ib(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(n,e=[]){let t;switch(n){case"Browser":t=P_(Yt());break;case"Worker":t=`${P_(Yt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YC(n,e={}){return vt(n,"GET","/v2/passwordPolicy",yt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC=6;class ZC{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:XC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new S_(this),this.idTokenSubscription=new S_(this),this.beforeStateQueue=new JC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Hw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=kr(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ao.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Zw(this,{idToken:e}),r=await Cr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ft(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ul(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ft(this.app))return Promise.reject(rn(this));const t=e?we(e):null;return t&&ne(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ft(this.app)?Promise.reject(rn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ft(this.app)?Promise.reject(rn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(kr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YC(this),t=new ZC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new vl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await HC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&kr(e)||this._popupRedirectResolver;ne(t,this,"argument-error"),this.redirectPersistenceManager=await ao.create(this,[kr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ne(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ub(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&kC(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Nt(n){return we(n)}class S_{constructor(e){this.auth=e,this.observer=null,this.addObserver=MA(t=>this.observer=t)}get next(){return ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ml={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function t1(n){Ml=n}function Ep(n){return Ml.loadJS(n)}function n1(){return Ml.recaptchaV2Script}function r1(){return Ml.recaptchaEnterpriseScript}function s1(){return Ml.gapiScript}function db(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const i1="recaptcha-enterprise",o1="NO_RECAPTCHA";class hb{constructor(e){this.type=i1,this.auth=Nt(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Xw(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new Yw(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;E_(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(o1)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&E_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=r1();c.length!==0&&(c+=a),Ep(c).then(()=>{s(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function R_(n,e,t,r=!1){const s=new hb(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function dl(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await R_(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await R_(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}async function a1(n){const e=Nt(n),t=await Xw(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Yw(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new hb(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(n,e){const t=wl(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(As(i,e??{}))return s;Nn(s,"already-initialized")}return t.initialize({options:e})}function c1(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(kr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function u1(n,e,t){const r=Nt(n);ne(r._canInitEmulator,r,"emulator-config-failed"),ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=fb(e),{host:o,port:a}=d1(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||h1()}function fb(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function d1(n){const e=fb(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:C_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:C_(o)}}}function C_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function h1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return hr("not implemented")}_getIdTokenResponse(e){return hr("not implemented")}_linkToIdToken(e,t){return hr("not implemented")}_getReauthenticationResolver(e){return hr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pb(n,e){return vt(n,"POST","/v1/accounts:resetPassword",yt(n,e))}async function f1(n,e){return vt(n,"POST","/v1/accounts:update",e)}async function p1(n,e){return vt(n,"POST","/v1/accounts:signUp",e)}async function m1(n,e){return vt(n,"POST","/v1/accounts:update",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g1(n,e){return Wr(n,"POST","/v1/accounts:signInWithPassword",yt(n,e))}async function id(n,e){return vt(n,"POST","/v1/accounts:sendOobCode",yt(n,e))}async function _1(n,e){return id(n,e)}async function y1(n,e){return id(n,e)}async function v1(n,e){return id(n,e)}async function w1(n,e){return id(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b1(n,e){return Wr(n,"POST","/v1/accounts:signInWithEmailLink",yt(n,e))}async function I1(n,e){return Wr(n,"POST","/v1/accounts:signInWithEmailLink",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl extends Ll{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new hl(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new hl(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dl(e,t,"signInWithPassword",g1);case"emailLink":return b1(e,{email:this._email,oobCode:this._password});default:Nn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dl(e,r,"signUpPassword",p1);case"emailLink":return I1(e,{idToken:t,email:this._email,oobCode:this._password});default:Nn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vr(n,e){return Wr(n,"POST","/v1/accounts:signInWithIdp",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="http://localhost";class $r extends Ll{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $r(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Nn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=_p(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new $r(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Vr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Vr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vr(e,t)}buildRequest(){const e={requestUri:E1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Do(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T1(n,e){return vt(n,"POST","/v1/accounts:sendVerificationCode",yt(n,e))}async function A1(n,e){return Wr(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,e))}async function x1(n,e){const t=await Wr(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,e));if(t.temporaryProof)throw xa(n,"account-exists-with-different-credential",t);return t}const P1={USER_NOT_FOUND:"user-not-found"};async function S1(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Wr(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,t),P1)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui extends Ll{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ui({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ui({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return A1(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return x1(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return S1(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new ui({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function C1(n){const e=wa(ba(n)).link,t=e?wa(ba(e)).deep_link_id:null,r=wa(ba(n)).deep_link_id;return(r?wa(ba(r)).link:null)||r||t||e||n}class Fl{constructor(e){var t,r,s,i,o,a;const c=wa(ba(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,f=R1((s=c.mode)!==null&&s!==void 0?s:null);ne(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=C1(e);try{return new Fl(t)}catch{return null}}}function wF(n){return Fl.parseLink(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(){this.providerId=Si.PROVIDER_ID}static credential(e,t){return hl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Fl.parseLink(t);return ne(r,"argument-error"),hl._fromEmailAndCode(e,r.code,r.tenantId)}}Si.PROVIDER_ID="password";Si.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Si.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends Qr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uc extends Go{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ne("providerId"in t&&"signInMethod"in t,"argument-error"),$r._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ne(e.idToken||e.accessToken,"argument-error"),$r._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Uc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Uc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new Uc(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends Go{constructor(){super("facebook.com")}static credential(e){return $r._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hs.credential(e.oauthAccessToken)}catch{return null}}}hs.FACEBOOK_SIGN_IN_METHOD="facebook.com";hs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends Go{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $r._fromParams({providerId:fs.PROVIDER_ID,signInMethod:fs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return fs.credentialFromTaggedObject(e)}static credentialFromError(e){return fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return fs.credential(t,r)}catch{return null}}}fs.GOOGLE_SIGN_IN_METHOD="google.com";fs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps extends Go{constructor(){super("github.com")}static credential(e){return $r._fromParams({providerId:ps.PROVIDER_ID,signInMethod:ps.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ps.credentialFromTaggedObject(e)}static credentialFromError(e){return ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ps.credential(e.oauthAccessToken)}catch{return null}}}ps.GITHUB_SIGN_IN_METHOD="github.com";ps.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="http://localhost";class fl extends Ll{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Vr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Vr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vr(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new fl(r,i)}static _create(e,t){return new fl(e,t)}buildRequest(){return{requestUri:k1,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="saml.";class qh extends Qr{constructor(e){ne(e.startsWith(D1),"argument-error"),super(e)}static credentialFromResult(e){return qh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return qh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=fl.fromJSON(e);return ne(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return fl._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms extends Go{constructor(){super("twitter.com")}static credential(e,t){return $r._fromParams({providerId:ms.PROVIDER_ID,signInMethod:ms.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ms.credentialFromTaggedObject(e)}static credentialFromError(e){return ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ms.credential(t,r)}catch{return null}}}ms.TWITTER_SIGN_IN_METHOD="twitter.com";ms.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mb(n,e){return Wr(n,"POST","/v1/accounts:signUp",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Cr._fromIdTokenResponse(e,r,s),o=k_(r);return new Hn({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=k_(r);return new Hn({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function k_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V1(n){var e;if(Ft(n.app))return Promise.reject(rn(n));const t=Nt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Hn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await mb(t,{returnSecureToken:!0}),s=await Hn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu extends qr{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,fu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new fu(e,t,r,s)}}function gb(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?fu._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _b(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bF(n,e){const t=we(n);await od(!0,t,e);const{providerUserInfo:r}=await BC(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=_b(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Tp(n,e,t=!1){const r=await Br(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Hn._forOperation(n,"link",r)}async function od(n,e,t){await ul(e);const r=_b(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ne(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yb(n,e,t=!1){const{auth:r}=n;if(Ft(r.app))return Promise.reject(rn(r));const s="reauthenticate";try{const i=await Br(n,gb(r,s,e,n),t);ne(i.idToken,r,"internal-error");const o=sd(i.idToken);ne(o,r,"internal-error");const{sub:a}=o;return ne(n.uid===a,r,"user-mismatch"),Hn._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Nn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(n,e,t=!1){if(Ft(n.app))return Promise.reject(rn(n));const r="signIn",s=await gb(n,r,e),i=await Hn._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function Ap(n,e){return vb(Nt(n),e)}async function N1(n,e){const t=we(n);return await od(!1,t,e.providerId),Tp(t,e)}async function O1(n,e){return yb(we(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(n,e){return Wr(n,"POST","/v1/accounts:signInWithCustomToken",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IF(n,e){if(Ft(n.app))return Promise.reject(rn(n));const t=Nt(n),r=await M1(t,{token:e,returnSecureToken:!0}),s=await Hn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?xp._fromServerResponse(e,t):"totpInfo"in t?Pp._fromServerResponse(e,t):Nn(e,"internal-error")}}class xp extends Ul{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new xp(t)}}class Pp extends Ul{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Pp(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ad(n,e,t){var r;ne(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),ne(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ne(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ne(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sp(n){const e=Nt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function L1(n,e,t){const r=Nt(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&ad(r,s,t),await dl(r,s,"getOobCode",y1)}async function F1(n,e,t){await pb(we(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Sp(n),r})}async function EF(n,e){await m1(we(n),{oobCode:e})}async function U1(n,e){const t=we(n),r=await pb(t,{oobCode:e}),s=r.requestType;switch(ne(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ne(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ne(r.mfaInfo,t,"internal-error");default:ne(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=Ul._fromServerResponse(Nt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function TF(n,e){const{data:t}=await U1(we(n),e);return t.email}async function B1(n,e,t){if(Ft(n.app))return Promise.reject(rn(n));const r=Nt(n),o=await dl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mb).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Sp(n),c}),a=await Hn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function $1(n,e,t){return Ft(n.app)?Promise.reject(rn(n)):Ap(we(n),Si.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Sp(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AF(n,e,t){const r=Nt(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){ne(a.handleCodeInApp,r,"argument-error"),a&&ad(r,o,a)}i(s,t),await dl(r,s,"getOobCode",v1)}function xF(n,e){const t=Fl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function PF(n,e,t){if(Ft(n.app))return Promise.reject(rn(n));const r=we(n),s=Si.credentialWithLink(e,t||cl());return ne(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ap(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j1(n,e){return vt(n,"POST","/v1/accounts:createAuthUri",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SF(n,e){const t=wp()?cl():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await j1(we(n),r);return s||[]}async function RF(n,e){const t=we(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&ad(t.auth,s,e);const{email:i}=await _1(t.auth,s);i!==n.email&&await n.reload()}async function CF(n,e,t){const r=we(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&ad(r.auth,i,t);const{email:o}=await w1(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q1(n,e){return vt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kF(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=we(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Br(r,q1(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function DF(n,e){const t=we(n);return Ft(t.auth.app)?Promise.reject(rn(t.auth)):wb(t,e,null)}function z1(n,e){return wb(we(n),null,e)}async function wb(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await Br(n,f1(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(n){var e,t;if(!n)return null;const{providerId:r}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=sd(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new lo(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new K1(i,s);case"github.com":return new H1(i,s);case"google.com":return new W1(i,s);case"twitter.com":return new Q1(i,s,n.screenName||null);case"custom":case"anonymous":return new lo(i,null);default:return new lo(i,r,s)}}class lo{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class bb extends lo{constructor(e,t,r,s){super(e,t,r),this.username=s}}class K1 extends lo{constructor(e,t){super(e,"facebook.com",t)}}class H1 extends bb{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class W1 extends lo{constructor(e,t){super(e,"google.com",t)}}class Q1 extends bb{constructor(e,t,r){super(e,"twitter.com",t,r)}}function VF(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:G1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(n,e){return we(n).setPersistence(e)}function OF(n){return a1(n)}async function MF(n,e){return Nt(n).validatePassword(e)}function J1(n,e,t,r){return we(n).onIdTokenChanged(e,t,r)}function Y1(n,e,t){return we(n).beforeAuthStateChanged(e,t)}function LF(n,e,t,r){return we(n).onAuthStateChanged(e,t,r)}function FF(n){we(n).useDeviceLanguage()}function UF(n,e){return we(n).updateCurrentUser(e)}function BF(n){return we(n).signOut()}function $F(n,e){return Nt(n).revokeAccessToken(e)}async function jF(n){return we(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new ii("enroll",e,t)}static _fromMfaPendingCredential(e){return new ii("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return ii._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return ii._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Nt(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>Ul._fromServerResponse(r,a));ne(s.mfaPendingCredential,r,"internal-error");const o=ii._fromMfaPendingCredential(s.mfaPendingCredential);return new Rp(o,i,async a=>{const c=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const u=Object.assign(Object.assign({},s),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":const d=await Hn._fromIdTokenResponse(r,t.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return ne(t.user,r,"internal-error"),Hn._forOperation(t.user,t.operationType,u);default:Nn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function qF(n,e){var t;const r=we(n),s=e;return ne(e.customData.operationType,r,"argument-error"),ne((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Rp._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:start",yt(n,e))}function Z1(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:finalize",yt(n,e))}function ek(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:start",yt(n,e))}function tk(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:finalize",yt(n,e))}function nk(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",yt(n,e))}class Cp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Ul._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Cp(e)}async getSession(){return ii._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await Br(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Br(this.user,nk(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const Qd=new WeakMap;function zF(n){const e=we(n);return Qd.has(e)||Qd.set(e,Cp._fromUser(e)),Qd.get(e)}const pu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(pu,"1"),this.storage.removeItem(pu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk=1e3,sk=10;class Eb extends Ib{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);QC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,sk):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},rk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Eb.type="LOCAL";const ik=Eb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb extends Ib{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Tb.type="SESSION";const Ab=Tb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new ld(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(t.origin,i)),c=await ok(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ld.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const u=cd("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(){return window}function lk(n){qt().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(){return typeof qt().WorkerGlobalScope<"u"&&typeof qt().importScripts=="function"}async function ck(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uk(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function dk(){return kp()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb="firebaseLocalStorageDb",hk=1,mu="firebaseLocalStorage",Pb="fbase_key";class Bl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ud(n,e){return n.transaction([mu],e?"readwrite":"readonly").objectStore(mu)}function fk(){const n=indexedDB.deleteDatabase(xb);return new Bl(n).toPromise()}function zh(){const n=indexedDB.open(xb,hk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(mu,{keyPath:Pb})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(mu)?e(r):(r.close(),await fk(),e(await zh()))})})}async function D_(n,e,t){const r=ud(n,!0).put({[Pb]:e,value:t});return new Bl(r).toPromise()}async function pk(n,e){const t=ud(n,!1).get(e),r=await new Bl(t).toPromise();return r===void 0?null:r.value}function V_(n,e){const t=ud(n,!0).delete(e);return new Bl(t).toPromise()}const mk=800,gk=3;class Sb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zh(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>gk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return kp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ld._getInstance(dk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await ck(),!this.activeServiceWorker)return;this.sender=new ak(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zh();return await D_(e,pu,"1"),await V_(e,pu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>D_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>pk(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>V_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=ud(s,!1).getAll();return new Bl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Sb.type="LOCAL";const _k=Sb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(n,e){return vt(n,"POST","/v2/accounts/mfaSignIn:start",yt(n,e))}function vk(n,e){return vt(n,"POST","/v2/accounts/mfaSignIn:finalize",yt(n,e))}function wk(n,e){return vt(n,"POST","/v2/accounts/mfaSignIn:finalize",yt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk=500,Ik=6e4,bc=1e12;class Ek{constructor(e){this.auth=e,this.counter=bc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new Tk(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||bc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||bc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||bc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class Tk{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ne(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Ak(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},Ik)},bk))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Ak(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=db("rcb"),xk=new Ol(3e4,6e4);class Pk{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=qt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return ne(Sk(t),e,"argument-error"),this.shouldResolveImmediately(t)&&I_(qt().grecaptcha)?Promise.resolve(qt().grecaptcha):new Promise((r,s)=>{const i=qt().setTimeout(()=>{s(Sn(e,"network-request-failed"))},xk.get());qt()[Jd]=()=>{qt().clearTimeout(i),delete qt()[Jd];const a=qt().grecaptcha;if(!a||!I_(a)){s(Sn(e,"internal-error"));return}const c=a.render;a.render=(u,d)=>{const f=c(u,d);return this.counter++,f},this.hostLanguage=t,r(a)};const o=`${n1()}?${Do({onload:Jd,render:"explicit",hl:t})}`;Ep(o).catch(()=>{clearTimeout(i),s(Sn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=qt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Sk(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class Rk{async load(e){return new Ek(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb="recaptcha",Ck={theme:"light",type:"image"};class GF{constructor(e,t,r=Object.assign({},Ck)){this.parameters=r,this.type=Rb,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Nt(e),this.isInvisible=this.parameters.size==="invisible",ne(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ne(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Rk:new Pk,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ne(!this.parameters.sitekey,this.auth,"argument-error"),ne(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ne(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=qt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ne(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ne(wp()&&!kp(),this.auth,"internal-error"),await kk(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await FC(this.auth);ne(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ne(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function kk(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ui._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function KF(n,e,t){if(Ft(n.app))return Promise.reject(rn(n));const r=Nt(n),s=await dd(r,e,we(t));return new Dp(s,i=>Ap(r,i))}async function HF(n,e,t){const r=we(n);await od(!1,r,"phone");const s=await dd(r.auth,e,we(t));return new Dp(s,i=>N1(r,i))}async function WF(n,e,t){const r=we(n);if(Ft(r.auth.app))return Promise.reject(rn(r.auth));const s=await dd(r.auth,e,we(t));return new Dp(s,i=>O1(r,i))}async function dd(n,e,t){var r;const s=await t.verify();try{ne(typeof s=="string",n,"argument-error"),ne(t.type===Rb,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return ne(o.type==="enroll",n,"internal-error"),(await X1(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{ne(o.type==="signin",n,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return ne(a,n,"missing-multi-factor-info"),(await yk(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await T1(n,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{t._reset()}}async function QF(n,e){const t=we(n);if(Ft(t.auth.app))return Promise.reject(rn(t.auth));await Tp(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.providerId=co.PROVIDER_ID,this.auth=Nt(e)}verifyPhoneNumber(e,t){return dd(this.auth,e,we(t))}static credential(e,t){return ui._fromVerification(e,t)}static credentialFromResult(e){const t=e;return co.credentialFromTaggedObject(t)}static credentialFromError(e){return co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?ui._fromTokenResponse(t,r):null}}co.PROVIDER_ID="phone";co.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(n,e){return e?kr(e):(ne(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp extends Ll{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Dk(n){return vb(n.auth,new Vp(n),n.bypassAuthState)}function Vk(n){const{auth:e,user:t}=n;return ne(t,e,"internal-error"),yb(t,new Vp(n),n.bypassAuthState)}async function Nk(n){const{auth:e,user:t}=n;return ne(t,e,"internal-error"),Tp(t,new Vp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Dk;case"linkViaPopup":case"linkViaRedirect":return Nk;case"reauthViaPopup":case"reauthViaRedirect":return Vk;default:Nn(this.auth,"internal-error")}}resolve(e){Ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok=new Ol(2e3,1e4);async function JF(n,e,t){if(Ft(n.app))return Promise.reject(Sn(n,"operation-not-supported-in-this-environment"));const r=Nt(n);zo(n,e,Qr);const s=Ri(r,t);return new Dr(r,"signInViaPopup",e,s).executeNotNull()}async function YF(n,e,t){const r=we(n);if(Ft(r.auth.app))return Promise.reject(Sn(r.auth,"operation-not-supported-in-this-environment"));zo(r.auth,e,Qr);const s=Ri(r.auth,t);return new Dr(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function XF(n,e,t){const r=we(n);zo(r.auth,e,Qr);const s=Ri(r.auth,t);return new Dr(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Dr extends Cb{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Dr.currentPopupAction&&Dr.currentPopupAction.cancel(),Dr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ne(e,this.auth,"internal-error"),e}async onExecution(){Ur(this.filter.length===1,"Popup operations only handle one event");const e=cd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Sn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Sn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Sn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Ok.get())};e()}}Dr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk="pendingRedirect",Bc=new Map;class Lk extends Cb{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Bc.get(this.auth._key());if(!e){try{const r=await Fk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Bc.set(this.auth._key(),e)}return this.bypassAuthState||Bc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Fk(n,e){const t=Db(e),r=kb(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function Np(n,e){return kb(n)._set(Db(e),"true")}function Uk(n,e){Bc.set(n._key(),e)}function kb(n){return kr(n._redirectPersistence)}function Db(n){return Fc(Mk,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZF(n,e,t){return Bk(n,e,t)}async function Bk(n,e,t){if(Ft(n.app))return Promise.reject(rn(n));const r=Nt(n);zo(n,e,Qr),await r._initializationPromise;const s=Ri(r,t);return await Np(s,r),s._openRedirect(r,e,"signInViaRedirect")}function eU(n,e,t){return $k(n,e,t)}async function $k(n,e,t){const r=we(n);if(zo(r.auth,e,Qr),Ft(r.auth.app))return Promise.reject(rn(r.auth));await r.auth._initializationPromise;const s=Ri(r.auth,t);await Np(s,r.auth);const i=await Nb(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function tU(n,e,t){return jk(n,e,t)}async function jk(n,e,t){const r=we(n);zo(r.auth,e,Qr),await r.auth._initializationPromise;const s=Ri(r.auth,t);await od(!1,r,e.providerId),await Np(s,r.auth);const i=await Nb(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function nU(n,e){return await Nt(n)._initializationPromise,Vb(n,e,!1)}async function Vb(n,e,t=!1){if(Ft(n.app))return Promise.reject(rn(n));const r=Nt(n),s=Ri(r,e),o=await new Lk(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function Nb(n){const e=cd(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk=10*60*1e3;class zk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Gk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Ob(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Sn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qk&&this.cachedEventUids.clear(),this.cachedEventUids.has(N_(e))}saveEventToCache(e){this.cachedEventUids.add(N_(e)),this.lastProcessedEventTime=Date.now()}}function N_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Ob({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Gk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ob(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(n,e={}){return vt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wk=/^https?/;async function Qk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Kk(n);for(const t of e)try{if(Jk(t))return}catch{}Nn(n,"unauthorized-domain")}function Jk(n){const e=cl(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Wk.test(t))return!1;if(Hk.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=new Ol(3e4,6e4);function O_(){const n=qt().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Xk(n){return new Promise((e,t)=>{var r,s,i;function o(){O_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{O_(),t(Sn(n,"network-request-failed"))},timeout:Yk.get()})}if(!((s=(r=qt().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=qt().gapi)===null||i===void 0)&&i.load)o();else{const a=db("iframefcb");return qt()[a]=()=>{gapi.load?o():t(Sn(n,"network-request-failed"))},Ep(`${s1()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw $c=null,e})}let $c=null;function Zk(n){return $c=$c||Xk(n),$c}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=new Ol(5e3,15e3),tD="__/auth/iframe",nD="emulator/auth/iframe",rD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iD(n){const e=n.config;ne(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?bp(e,nD):`https://${n.config.authDomain}/${tD}`,r={apiKey:e.apiKey,appName:n.name,v:Vo},s=sD.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Do(r).slice(1)}`}async function oD(n){const e=await Zk(n),t=qt().gapi;return ne(t,n,"internal-error"),e.open({where:document.body,url:iD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rD,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Sn(n,"network-request-failed"),a=qt().setTimeout(()=>{i(o)},eD.get());function c(){qt().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lD=500,cD=600,uD="_blank",dD="http://localhost";class M_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hD(n,e,t,r=lD,s=cD){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},aD),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Yt().toLowerCase();t&&(a=sb(u)?uD:t),nb(u)&&(e=e||dD,c.scrollbars="yes");const d=Object.entries(c).reduce((g,[_,D])=>`${g}${_}=${D},`,"");if(WC(u)&&a!=="_self")return fD(e||"",a),new M_(null);const f=window.open(e||"",a,d);ne(f,n,"popup-blocked");try{f.focus()}catch{}return new M_(f)}function fD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD="__/auth/handler",mD="emulator/auth/handler",gD=encodeURIComponent("fac");async function L_(n,e,t,r,s,i){ne(n.config.authDomain,n,"auth-domain-config-required"),ne(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Vo,eventId:s};if(e instanceof Qr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",OA(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof Go){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await n._getAppCheckToken(),u=c?`#${gD}=${encodeURIComponent(c)}`:"";return`${_D(n)}?${Do(a).slice(1)}${u}`}function _D({config:n}){return n.emulator?bp(n,mD):`https://${n.authDomain}/${pD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="webStorageSupport";class yD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ab,this._completeRedirectFn=Vb,this._overrideRedirectResult=Uk}async _openPopup(e,t,r,s){var i;Ur((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await L_(e,t,r,cl(),s);return hD(e,o,cd())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await L_(e,t,r,cl(),s);return lk(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Ur(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await oD(e),r=new zk(e);return t.register("authEvent",s=>(ne(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yd,{type:Yd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Yd];o!==void 0&&t(!!o),Nn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Qk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cb()||rb()||Ip()}}const vD=yD;class Mb{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return hr("unexpected MultiFactorSessionType")}}}class Op extends Mb{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Op(e)}_finalizeEnroll(e,t,r){return Z1(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return vk(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class wD{constructor(){}static assertion(e){return Op._fromCredential(e)}}wD.FACTOR_ID="phone";class bD{static assertionForEnrollment(e,t){return pl._fromSecret(e,t)}static assertionForSignIn(e,t){return pl._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const r=e;ne(typeof((t=r.user)===null||t===void 0?void 0:t.auth)<"u","internal-error");const s=await ek(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return Mp._fromStartTotpMfaEnrollmentResponse(s,r.user.auth)}}bD.FACTOR_ID="totp";class pl extends Mb{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new pl(t,void 0,e)}static _fromEnrollmentId(e,t){return new pl(t,e)}async _finalizeEnroll(e,t,r){return ne(typeof this.secret<"u",e,"argument-error"),tk(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){ne(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return wk(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class Mp{constructor(e,t,r,s,i,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new Mp(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let s=!1;return(Ic(e)||Ic(t))&&(s=!0),s&&(Ic(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),Ic(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Ic(n){return typeof n>"u"||(n==null?void 0:n.length)===0}var F_="@firebase/auth",U_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ED(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TD(n){mo(new di("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ne(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ub(n)},u=new e1(r,s,i,c);return c1(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),mo(new di("auth-internal",e=>{const t=Nt(e.getProvider("auth").getImmediate());return(r=>new ID(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),bs(F_,U_,ED(n)),bs(F_,U_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=5*60,xD=pv("authIdTokenMaxAge")||AD;let B_=null;const PD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>xD)return;const s=t==null?void 0:t.token;B_!==s&&(B_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function SD(n=wv()){const e=wl(n,"auth");if(e.isInitialized())return e.getImmediate();const t=l1(n,{popupRedirectResolver:vD,persistence:[_k,ik,Ab]}),r=pv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=PD(i.toString());Y1(t,o,()=>o(t.currentUser)),J1(t,a=>o(a))}}const s=hv("auth");return s&&u1(t,`http://${s}`),t}function RD(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}t1({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Sn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",RD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TD("Browser");const CD={apiKey:"AIzaSyDCqJRmxKiIzuAhgXsmXICCx_O65aujNa0",authDomain:"impro-selector.firebaseapp.com",projectId:"impro-selector",storageBucket:"impro-selector.appspot.com",messagingSenderId:"730278491306",appId:"1:730278491306:web:c966af1179221e91118cd3",measurementId:"G-3NB062D088"},Lb=vv(CD),ye=iC(Lb),Ci=SD(Lb);V1(Ci);async function kD(n,e){try{return(await B1(Ci,n,e)).user}catch(t){throw t}}async function DD(n,e){try{return(await $1(Ci,n,e)).user}catch(t){throw t}}async function VD(n){try{await L1(Ci,n)}catch(e){throw e}}async function ND(n){try{const e=Ci.currentUser;if(e)await z1(e,n);else throw new Error("Aucun utilisateur connecté")}catch(e){throw e}}const uo=Object.freeze(Object.defineProperty({__proto__:null,auth:Ci,createPlayerAccount:kD,db:ye,resetPlayerPassword:VD,signInPlayer:DD,updatePlayerPassword:ND},Symbol.toStringTag,{value:"Module"})),$l="seasons";async function OD(n,e,t){return await qw(tt(ye,$l),{name:n,slug:e,pinCode:t,createdAt:mp()})}async function MD(n){return await ll(ke(ye,$l,n))}async function Xd(){const n=Fw(tt(ye,$l),fC("createdAt","desc"));return(await St(n)).docs.map(t=>({id:t.id,...t.data()}))}async function gu(n,e){const t=await Pi(ke(ye,$l,n));return t.exists()?t.data().pinCode===e:!1}async function Gh(n){const e=await Pi(ke(ye,$l,n));return e.exists()?e.data().pinCode:null}const Zd=10*60*1e3,eh="impro_selector_pin_session";class LD{constructor(){this.sessionData=this.loadSession()}loadSession(){try{const e=localStorage.getItem(eh);if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<Zd)return t;this.clearSession()}}catch(e){console.error("Erreur lors du chargement de la session PIN:",e)}return null}saveSession(e,t){try{const r={seasonId:e,pinCode:t,timestamp:Date.now()};localStorage.setItem(eh,JSON.stringify(r)),this.sessionData=r}catch(r){console.error("Erreur lors de la sauvegarde de la session PIN:",r)}}isPinCached(e){return this.sessionData?this.sessionData.seasonId===e&&this.sessionData.timestamp&&Date.now()-this.sessionData.timestamp<Zd:!1}getCachedPin(e){return this.isPinCached(e)?this.sessionData.pinCode:null}clearSession(){try{localStorage.removeItem(eh),this.sessionData=null}catch(e){console.error("Erreur lors de la suppression de la session PIN:",e)}}getTimeRemaining(){if(!this.sessionData||!this.sessionData.timestamp)return 0;const e=Date.now()-this.sessionData.timestamp,t=Zd-e;return Math.max(0,Math.ceil(t/(60*1e3)))}isExpiringSoon(){return this.getTimeRemaining()<=2}}const Cn=new LD,FD={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},UD={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},BD={class:"text-center mb-6"},$D={class:"text-gray-300"},jD={key:0,class:"mt-2 p-2 bg-green-900/20 border border-green-500/30 rounded-lg"},qD={class:"text-sm text-green-400"},zD={class:"mb-4 flex justify-center"},GD={class:"flex bg-gray-800 rounded-lg p-1"},KD={key:0,class:"mb-6"},HD={class:"mb-4"},WD={key:1,class:"mb-6"},QD={class:"flex justify-center space-x-3 mb-4"},JD={class:"grid grid-cols-3 gap-3 mb-4"},YD=["onClick"],XD={key:2,class:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-center"},ZD={class:"flex justify-end space-x-3"},eV=["disabled"],Fb={__name:"PinModal",props:{show:{type:Boolean,default:!1},message:{type:String,default:"Veuillez saisir le code PIN à 4 chiffres"},error:{type:String,default:""},sessionInfo:{type:Object,default:null}},emits:["submit","cancel"],setup(n,{emit:e}){const t=n,r=e,s=G(""),i=G(""),o=G("direct"),a=G(null);nr(()=>t.show,T=>{T&&(s.value="",i.value="",o.value==="direct"&&Es(()=>{var C;(C=a.value)==null||C.focus()}))}),nr(o,T=>{T==="direct"&&t.show&&Es(()=>{var C;(C=a.value)==null||C.focus()})});function c(){s.value=s.value.replace(/[^0-9]/g,""),s.value.length>4&&(s.value=s.value.slice(0,4))}function u(T){s.value.length<4&&(s.value+=T.toString())}function d(){s.value=s.value.slice(0,-1)}function f(){s.value="",i.value=""}function g(){s.value.length===4&&r("submit",s.value)}function _(){r("cancel")}const D=T=>{t.show&&(T.key>="0"&&T.key<="9"?o.value==="keypad"&&u(parseInt(T.key)):T.key==="Backspace"?o.value==="keypad"&&d():T.key==="Enter"?g():T.key==="Escape"&&_())};return typeof window<"u"&&window.addEventListener("keydown",D),(T,C)=>n.show?(Q(),X("div",FD,[m("div",UD,[m("div",BD,[C[4]||(C[4]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"🔒")],-1)),C[5]||(C[5]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Code d'accès requis",-1)),m("p",$D,pe(n.message),1),n.sessionInfo?(Q(),X("div",jD,[m("p",qD," Session active : "+pe(n.sessionInfo.timeRemaining)+" min restantes ",1)])):Ae("",!0)]),m("div",zD,[m("div",GD,[m("button",{onClick:C[0]||(C[0]=U=>o.value="direct"),class:Zn(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",o.value==="direct"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"])}," Saisie directe ",2),m("button",{onClick:C[1]||(C[1]=U=>o.value="keypad"),class:Zn(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",o.value==="keypad"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"])}," Pavé numérique ",2)])]),o.value==="direct"?(Q(),X("div",KD,[m("div",HD,[C[6]||(C[6]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN",-1)),gt(m("input",{"onUpdate:modelValue":C[2]||(C[2]=U=>s.value=U),type:"password",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-center text-2xl font-mono tracking-widest",placeholder:"••••",onInput:c,onKeydown:[An(g,["enter"]),An(_,["escape"])],ref_key:"pinInput",ref:a},null,544),[[Pt,s.value]])]),C[7]||(C[7]=m("p",{class:"text-xs text-gray-400 text-center"},"Tapez directement votre code PIN à 4 chiffres",-1))])):(Q(),X("div",WD,[m("div",QD,[(Q(),X(zt,null,gs(4,(U,B)=>m("div",{key:B,class:Zn(["w-12 h-12 border-2 border-gray-600 rounded-lg flex items-center justify-center text-2xl font-bold text-white bg-gray-800",{"border-purple-500 bg-purple-900/20":s.value.length>B}])},pe(s.value[B]||"•"),3)),64))]),m("div",JD,[(Q(),X(zt,null,gs([1,2,3,4,5,6,7,8,9],U=>m("button",{key:U,onClick:B=>u(U),class:"w-12 h-12 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold text-xl transition-all duration-200 hover:scale-105"},pe(U),9,YD)),64)),m("button",{onClick:f,class:"w-12 h-12 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold text-lg transition-all duration-200 hover:scale-105"}," C "),m("button",{onClick:C[3]||(C[3]=U=>u(0)),class:"w-12 h-12 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold text-xl transition-all duration-200 hover:scale-105"}," 0 "),m("button",{onClick:d,class:"w-12 h-12 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-bold text-lg transition-all duration-200 hover:scale-105"}," ← ")])])),i.value||t.error?(Q(),X("div",XD,pe(i.value||t.error),1)):Ae("",!0),m("div",ZD,[m("button",{onClick:_,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:g,disabled:s.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Valider ",8,eV)])])])):Ae("",!0)}},tV={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},nV={class:"container mx-auto px-4 pb-16"},rV={class:"flex justify-center mb-12"},sV={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto"},iV=["onClick"],oV={class:"text-2xl font-bold text-white mb-4 group-hover:text-purple-300 transition-colors"},aV=["onClick"],lV={key:0,class:"text-center py-16"},cV={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},uV={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},dV={class:"mb-6"},hV={class:"mb-6"},fV={class:"mb-6"},pV={class:"flex justify-end space-x-3"},mV=["disabled"],gV={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},_V={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},yV={class:"text-center mb-6"},vV={class:"text-gray-300"},wV={__name:"Home",setup(n){const e=G([]),t=Du(),r=G(!1),s=G(!1),i=G(""),o=G(""),a=G(""),c=G(null),u=G(!1),d=G(null),f=G("");_l(async()=>{e.value=await Xd(),console.log("Saisons chargées:",e.value)});function g(R){t.push(`/season/${R}`)}function _(){i.value&&(o.value=i.value.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}function D(){a.value=a.value.replace(/[^0-9]/g,""),a.value.length>4&&(a.value=a.value.slice(0,4))}async function T(){if(!i.value.trim()||!o.value.trim()||!a.value.trim()){alert("Veuillez remplir tous les champs, y compris le code PIN à 4 chiffres");return}if(a.value.length!==4){alert("Le code PIN doit contenir exactement 4 chiffres");return}try{await OD(i.value.trim(),o.value.trim(),a.value.trim()),e.value=await Xd(),C()}catch(R){console.error("Erreur lors de la création de la saison:",R),alert("Erreur lors de la création de la saison. Veuillez réessayer.")}}function C(){r.value=!1,i.value="",o.value="",a.value=""}function U(R){c.value=R,s.value=!0}async function B(){s.value=!1,await q({type:"deleteSeason",data:{seasonId:c.value.id,seasonName:c.value.name}})}function L(){s.value=!1,c.value=null}function O(){return d.value?{deleteSeason:"Suppression de saison - Code PIN requis"}[d.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function q(R){if(Cn.isPinCached(c.value.id)){const w=Cn.getCachedPin(c.value.id);if(console.log("PIN en cache trouvé, utilisation automatique"),await gu(c.value.id,w)){await A(R);return}else Cn.clearSession()}d.value=R,u.value=!0}async function ie(R){var w,S,I;console.log("PIN soumis:",R,"pour l'opération:",d.value);try{const Ne=((S=(w=d.value)==null?void 0:w.data)==null?void 0:S.seasonId)||((I=c.value)==null?void 0:I.id),nt=await gu(Ne,R);if(console.log("PIN valide:",nt),nt){Cn.saveSession(Ne,R),console.log("PIN correct, fermeture de la modal et exécution de l'opération"),u.value=!1;const Ue=d.value;d.value=null,console.log("Appel de executePendingOperation avec:",Ue),await A(Ue)}else f.value="Code PIN incorrect",setTimeout(()=>{f.value=""},3e3)}catch(Ne){console.error("Erreur lors de la vérification du PIN:",Ne),f.value="Erreur lors de la vérification du code PIN"}}function x(){u.value=!1,d.value=null,f.value=""}function E(){return c.value&&Cn.isPinCached(c.value.id)?{timeRemaining:Cn.getTimeRemaining(),isExpiringSoon:Cn.isExpiringSoon()}:null}async function A(R){if(console.log("executePendingOperation appelé avec:",R),!R){console.log("Aucune opération à exécuter");return}const{type:w,data:S}=R;console.log("Exécution de l'opération:",w,"avec données:",S);try{switch(w){case"deleteSeason":console.log("Suppression de la saison ID:",S.seasonId),await MD(S.seasonId),console.log("Saison supprimée, rechargement de la liste..."),e.value=await Xd(),console.log("Nouvelle liste des saisons:",e.value);break;default:console.log("Type d'opération non reconnu:",w)}}catch(I){console.error("Erreur lors de l'exécution de l'opération:",I),alert("Erreur lors de l'opération. Veuillez réessayer.")}}return(R,w)=>{var S;return Q(),X("div",tV,[w[20]||(w[20]=m("div",{class:"text-center py-16 px-4"},[m("h1",{class:"text-6xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent animate-pulse"}," Sélections Spectacle "),m("p",{class:"text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed"}," Gérez facilement les sélections pour vos spectacles. ")],-1)),m("div",nV,[m("div",rV,[m("button",{onClick:w[0]||(w[0]=I=>r.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-2xl hover:shadow-pink-500/25 transition-all duration-300 transform hover:scale-105"}," ✨ Nouvelle saison ")]),m("div",sV,[(Q(!0),X(zt,null,gs(e.value,I=>(Q(),X("div",{key:I.id,class:"group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm border border-white/20 rounded-2xl p-8 cursor-pointer hover:scale-105 transition-all duration-300 hover:shadow-2xl hover:shadow-purple-500/20"},[m("div",{onClick:Ne=>g(I.slug),class:"text-center"},[w[5]||(w[5]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg"},[m("span",{class:"text-2xl"},"🎭")],-1)),m("h2",oV,pe(I.name),1),w[6]||(w[6]=m("div",{class:"w-full bg-gradient-to-r from-transparent via-white/20 to-transparent h-px mb-4"},null,-1)),w[7]||(w[7]=m("p",{class:"text-gray-300 text-sm"}," Cliquez pour accéder ",-1))],8,iV),m("button",{onClick:Yn(Ne=>U(I),["stop"]),class:"absolute top-4 right-4 text-red-400 hover:text-red-300 hover:scale-110 transition-all duration-200 opacity-0 group-hover:opacity-100",title:"Supprimer cette saison"},w[8]||(w[8]=[m("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,aV)]))),128))]),e.value.length===0?(Q(),X("div",lV,[w[9]||(w[9]=m("div",{class:"w-24 h-24 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[m("span",{class:"text-4xl"},"🎪")],-1)),w[10]||(w[10]=m("h3",{class:"text-2xl font-bold text-white mb-4"},"Aucune saison créée",-1)),w[11]||(w[11]=m("p",{class:"text-gray-300 mb-8"},"Commencez par créer votre première saison de spectacles !",-1)),m("button",{onClick:w[1]||(w[1]=I=>r.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-xl hover:shadow-pink-500/25 transition-all duration-300"}," Créer ma première saison ")])):Ae("",!0)]),r.value?(Q(),X("div",cV,[m("div",uV,[w[16]||(w[16]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvelle saison",-1)),m("div",dV,[w[12]||(w[12]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom de la saison",-1)),gt(m("input",{"onUpdate:modelValue":w[2]||(w[2]=I=>i.value=I),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: La Malice 2025-2026",onInput:_},null,544),[[Pt,i.value]])]),m("div",hV,[w[13]||(w[13]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Slug (URL)",-1)),gt(m("input",{"onUpdate:modelValue":w[3]||(w[3]=I=>o.value=I),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: malice-2025-2026"},null,512),[[Pt,o.value]])]),m("div",fV,[w[14]||(w[14]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN (4 chiffres)",-1)),gt(m("input",{"onUpdate:modelValue":w[4]||(w[4]=I=>a.value=I),type:"text",inputmode:"numeric",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"1234",onInput:D},null,544),[[Pt,a.value]]),w[15]||(w[15]=m("p",{class:"text-xs text-gray-400 mt-1"},"Ce code protégera les opérations sensibles (suppressions, sélections)",-1))]),m("div",pV,[m("button",{onClick:C,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:T,disabled:!i.value.trim()||!o.value.trim()||!a.value.trim()||a.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Créer ",8,mV)])])])):Ae("",!0),s.value?(Q(),X("div",gV,[m("div",_V,[m("div",yV,[w[17]||(w[17]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"⚠️")],-1)),w[18]||(w[18]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Confirmation",-1)),m("p",vV,'Êtes-vous sûr de vouloir supprimer la saison "'+pe((S=c.value)==null?void 0:S.name)+'" ?',1)]),w[19]||(w[19]=m("p",{class:"mb-6 text-sm text-red-400 bg-red-900/20 p-3 rounded-lg border border-red-500/20"}," ⚠️ Cette action est irréversible et supprimera toutes les données de cette saison. ",-1)),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:L,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:B,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):Ae("",!0),Gt(Fb,{show:u.value,message:O(),error:f.value,"session-info":E(),onSubmit:ie,onCancel:x},null,8,["show","message","error","session-info"])])}}};let In="mock",bi=[{id:"p1",name:"Alice"},{id:"p2",name:"Bob"},{id:"p3",name:"Charlie"},{id:"p4",name:"David"},{id:"p5",name:"Eva"},{id:"p6",name:"Fanny"},{id:"p7",name:"Georges"},{id:"p8",name:"Hélène"},{id:"p9",name:"Ismaël"},{id:"p10",name:"Jade"},{id:"p11",name:"Karim"},{id:"p12",name:"Léa"},{id:"p13",name:"Marc"},{id:"p14",name:"Nina"},{id:"p15",name:"Oscar"}],Ii=[{id:"event1",title:"Apérock Septembre",date:"2025-09-08",description:"Soirée apéro-rock avec ambiance festive"},{id:"event2",title:"Match à Cambo",date:"2025-11-25",description:"Match d'improvisation compétitif à Cambo-les-Bains"},{id:"event3",title:"Impro des Familles",date:"2025-12-02",description:"Spectacle d'improvisation pour toute la famille"},{id:"event4",title:"Cabaret Surprise",date:"2026-01-20",description:"Cabaret avec des surprises et des performances uniques"},{id:"event5",title:"Impro Plage",date:"2026-03-10",description:"Improvisation en plein air avec vue sur la plage"}];function bV(n){In=n}async function IV(){if(In!=="firebase"||!(await St(tt(ye,"seasons"))).empty)return;const e=ke(tt(ye,"seasons"));await Pn(e,{name:"Malice 2025-2026",slug:"malice-2025-2026",createdAt:mp()});const t=await St(tt(ye,"players"));for(const o of t.docs)await Pn(ke(e,"players",o.id),o.data());const r=await St(tt(ye,"events"));for(const o of r.docs)await Pn(ke(e,"events",o.id),o.data());const s=await St(tt(ye,"availability"));for(const o of s.docs)await Pn(ke(e,"availability",o.id),o.data());const i=await St(tt(ye,"selections"));for(const o of i.docs)await Pn(ke(e,"selections",o.id),o.data())}async function EV(){In==="firebase"&&await IV()}async function $_(n=null){return(In==="firebase"?n?(await St(tt(ye,"seasons",n,"events"))).docs.map(t=>({id:t.id,...t.data()})):(await St(tt(ye,"events"))).docs.map(t=>({id:t.id,...t.data()})):Ii).sort((t,r)=>{const s=new Date(t.date),i=new Date(r.date);return s<i?-1:s>i?1:t.title.localeCompare(r.title)})}async function th(n=null){return(In==="firebase"?n?(await St(tt(ye,"seasons",n,"players"))).docs.map(t=>({id:t.id,...t.data()})):(await St(tt(ye,"players"))).docs.map(t=>({id:t.id,...t.data()})):bi).sort((t,r)=>t.order<r.order?-1:t.order>r.order?1:t.name.localeCompare(r.name))}async function TV(n,e=null){if(In==="firebase"){const t=ke(e?tt(ye,"seasons",e,"players"):tt(ye,"players"));return await Pn(t,{name:n}),t.id}else{const t=`p${bi.length+1}`;return bi.push({id:t,name:n}),t}}async function AV(n,e=null){if(In==="firebase"){const t=e?ke(ye,"seasons",e,"players",n):ke(ye,"players",n);await ll(t);const r=e?await St(tt(ye,"seasons",e,"availability")):await St(tt(ye,"availability")),s=zw(ye);r.forEach(i=>{const o=i.data();if(o[n]!==void 0){const a={...o};delete a[n],s.update(i.ref,a)}}),await s.commit()}else bi=bi.filter(t=>t.id!==n)}async function xV(n,e,t=null){if(In==="firebase"){const r=t?ke(ye,"seasons",t,"players",n):ke(ye,"players",n);await Pn(r,{name:e})}else{const r=bi.findIndex(s=>s.id===n);r!==-1&&(bi[r]=e)}}async function _a(n,e,t=null){if(In==="firebase"){const r=t?await St(tt(ye,"seasons",t,"availability")):await St(tt(ye,"availability")),s={};return r.forEach(i=>{s[i.id]=i.data()}),s}else{const r={};return n.forEach(s=>{r[s.name]={},e.forEach(i=>{r[s.name][i.id]=void 0})}),e.forEach(s=>{const i=[...n].sort(()=>.5-Math.random());i.slice(0,4).forEach(o=>{r[o.name][s.id]=!0}),i.slice(4).forEach(o=>{const a=Math.random();r[o.name][s.id]=a<.4?!0:a<.8?!1:void 0})}),r}}async function ya(n=null){if(In==="firebase"){const e=n?await St(tt(ye,"seasons",n,"selections")):await St(tt(ye,"selections")),t={};return e.forEach(r=>{t[r.id]=r.data().players||[]}),t}else return{}}async function j_(n,e,t=null){if(In==="firebase"){const r=t?ke(ye,"seasons",t,"availability",n):ke(ye,"availability",n);await Pn(r,e)}}async function PV({seasonId:n,playerName:e,eventId:t,value:r}){if(In!=="firebase")return;const s=n?ke(ye,"seasons",n,"availability",e):ke(ye,"availability",e),i=await Pi(s),a={...i.exists()?i.data():{}};r===void 0?delete a[t]:a[t]=r,await Pn(s,a)}async function SV(n,e,t=null){if(In==="firebase"){const r=t?ke(ye,"seasons",t,"selections",n):ke(ye,"selections",n);await Pn(r,{players:e})}}async function RV(n,e=null){if(console.log("Suppression de l'événement:",n),In==="firebase")try{console.log("Suppression de l'événement dans Firestore");const t=e?ke(ye,"seasons",e,"events",n):ke(ye,"events",n);await ll(t),console.log("Suppression de la sélection associée");const r=e?ke(ye,"seasons",e,"selections",n):ke(ye,"selections",n);await ll(r),console.log("Suppression des disponibilités");const s=e?await St(tt(ye,"seasons",e,"availability")):await St(tt(ye,"availability")),i=zw(ye);s.forEach(o=>{const a=o.data();if(a[n]!==void 0){console.log("Mise à jour de la disponibilité pour:",o.id);const c={...a};delete c[n],i.update(o.ref,c)}}),await i.commit(),console.log("Opérations de suppression terminées avec succès")}catch(t){throw console.error("Erreur lors de la suppression:",t),t}else Ii=Ii.filter(t=>t.id!==n)}async function CV(n,e=null){if(In==="firebase"){const t=ke(e?tt(ye,"seasons",e,"events"):tt(ye,"events"));return await Pn(t,n),t.id}else{const t=`event${Ii.length+1}`;return Ii.push({id:t,...n}),t}}async function kV(n,e,t=null){if(In==="firebase"){const r=t?ke(ye,"seasons",t,"events",n):ke(ye,"events",n);await Pn(r,e)}else{const r=Ii.findIndex(s=>s.id===n);r!==-1&&(Ii[r]={id:n,...e})}}class DV{constructor(){this.sessions=new Map,this.sessionDuration=10*60*1e3}isPasswordCached(e){const t=this.sessions.get(e);return t?Date.now()-t.timestamp>this.sessionDuration?(this.sessions.delete(e),!1):!0:!1}getCachedPassword(e){const t=this.sessions.get(e);return t?Date.now()-t.timestamp>this.sessionDuration?(this.sessions.delete(e),null):t.password:null}saveSession(e,t){this.sessions.set(e,{password:t,timestamp:Date.now()})}clearSession(e){this.sessions.delete(e)}clearExpiredSessions(){const e=Date.now();for(const[t,r]of this.sessions.entries())e-r.timestamp>this.sessionDuration&&this.sessions.delete(t)}clearAllSessions(){this.sessions.clear()}}const ml=new DV,VV="modulepreload",NV=function(n){return"/impro-selector/"+n},q_={},qn=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=NV(i),i in q_)return;q_[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":VV,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function Ub(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return e.toString()}async function OV(n,e,t,r=null){try{console.log("🔍 [DEBUG] Début protectPlayer:",{playerId:n,email:e,seasonId:r});const s=await jl(n,r);if(s&&s.isProtected)throw new Error("Ce joueur est déjà protégé");const{collection:i,query:o,where:a,getDocs:c}=await qn(()=>import("./index.esm-5ae823cc.js"),[]),{db:u}=await qn(()=>Promise.resolve().then(()=>uo),void 0),d=r?i(u,"seasons",r,"playerProtection"):i(u,"playerProtection"),f=o(d,a("email","==",e)),g=await c(f);if(!g.empty&&g.docs.find(L=>L.id!==n))throw new Error("Cette adresse email est déjà utilisée par un autre joueur");console.log("🔍 [DEBUG] Création du compte Firebase Auth...");const{createUserWithEmailAndPassword:_}=await qn(()=>import("./index.esm-fa5ae89e.js"),[]),{auth:D}=await qn(()=>Promise.resolve().then(()=>uo),void 0),T=await _(D,e,t);console.log("🔍 [DEBUG] Compte Firebase Auth créé:",T.user.uid);const C=Ub(t),U=r?ke(u,"seasons",r,"playerProtection",n):ke(u,"playerProtection",n);return await Pn(U,{playerId:n,email:e,passwordHash:C,firebaseUid:T.user.uid,isProtected:!0,createdAt:new Date}),console.log("🔍 [DEBUG] Protection sauvegardée dans Firestore"),{success:!0}}catch(s){throw console.error("❌ [ERROR] Erreur lors de la protection du joueur:",s),s}}async function MV(n,e=null){try{const t=e?ke(ye,"seasons",e,"playerProtection",n):ke(ye,"playerProtection",n),r=await jl(n,e),s=(r==null?void 0:r.email)||"";return await Pn(t,{playerId:n,email:s,isProtected:!1,updatedAt:new Date}),{success:!0,email:s}}catch(t){throw console.error("Erreur lors de la suppression de la protection:",t),t}}async function oi(n,e=null){try{const t=e?ke(ye,"seasons",e,"playerProtection",n):ke(ye,"playerProtection",n),r=await Pi(t);return r.exists()?r.data().isProtected===!0:!1}catch(t){return console.error("Erreur lors de la vérification de protection:",t),!1}}async function jl(n,e=null){try{const t=e?ke(ye,"seasons",e,"playerProtection",n):ke(ye,"playerProtection",n),r=await Pi(t);return r.exists()?r.data():null}catch(t){return console.error("Erreur lors de la récupération des données de protection:",t),null}}async function Bb(n,e=null){try{const t=await jl(n,e);return(t==null?void 0:t.email)||""}catch(t){return console.error("Erreur lors de la récupération de l'email:",t),""}}async function _u(n,e,t=null){try{const r=await jl(n,t);if(!r||!r.isProtected)return!1;if(r.firebaseUid){console.log("🔍 [DEBUG] Vérification avec Firebase Auth");try{const{signInWithEmailAndPassword:s}=await qn(()=>import("./index.esm-fa5ae89e.js"),[]),{auth:i}=await qn(()=>Promise.resolve().then(()=>uo),void 0);return await s(i,r.email,e),console.log("🔍 [DEBUG] Mot de passe Firebase Auth valide"),ml.saveSession(n,e),!0}catch(s){return console.log("🔍 [DEBUG] Mot de passe Firebase Auth invalide:",s.code),!1}}else{console.log("🔍 [DEBUG] Vérification avec hash local");const s=Ub(e),i=r.passwordHash===s;return i&&ml.saveSession(n,e),i}}catch(r){return console.error("Erreur lors de la vérification du mot de passe:",r),!1}}function ja(n){return ml.isPasswordCached(n)}async function Kh(n,e=null){try{console.log("🔍 [DEBUG] Début sendPasswordResetEmail:",{playerId:n,seasonId:e});const t=await jl(n,e);if(console.log("🔍 [DEBUG] Protection data:",t),!t||!t.isProtected)throw new Error("Joueur non protégé");if(console.log("🔍 [DEBUG] Email à utiliser:",t.email),t.firebaseUid){console.log("🔍 [DEBUG] Utilisation du compte Firebase Auth existant");const{sendPasswordResetEmail:r}=await qn(()=>import("./index.esm-fa5ae89e.js"),[]),{auth:s}=await qn(()=>Promise.resolve().then(()=>uo),void 0);console.log("🔍 [DEBUG] Tentative d'envoi d'email à:",t.email),await r(s,t.email),console.log("🔍 [DEBUG] Email envoyé avec succès via Firebase Auth!"),console.log("🔍 [DEBUG] Vérifiez votre boîte mail:",t.email)}else{console.log("🔍 [DEBUG] Pas de compte Firebase Auth, création temporaire...");const{createUserWithEmailAndPassword:r,sendPasswordResetEmail:s}=await qn(()=>import("./index.esm-fa5ae89e.js"),[]),{auth:i}=await qn(()=>Promise.resolve().then(()=>uo),void 0),o=Math.random().toString(36).slice(-8)+"A1!";try{const a=await r(i,t.email,o);console.log("🔍 [DEBUG] Compte temporaire créé:",a.user.uid),await s(i,t.email),console.log("🔍 [DEBUG] Email envoyé avec succès!");const{updateDoc:c}=await qn(()=>import("./index.esm-5ae823cc.js"),[]),{db:u}=await qn(()=>Promise.resolve().then(()=>uo),void 0),d=e?ke(u,"seasons",e,"playerProtection",n):ke(u,"playerProtection",n);await c(d,{firebaseUid:a.user.uid})}catch(a){if(a.code==="auth/email-already-in-use")console.log("🔍 [DEBUG] Email déjà utilisé, tentative d'envoi direct..."),await s(i,t.email),console.log("🔍 [DEBUG] Email envoyé avec succès!");else throw a}}return{success:!0,message:"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}}catch(t){throw console.error("❌ [ERROR] Erreur lors de l'envoi de l'email de réinitialisation:",t),console.error("❌ [ERROR] Code d'erreur:",t.code),console.error("❌ [ERROR] Message d'erreur:",t.message),t.code==="auth/user-not-found"?new Error("Aucun compte trouvé avec cette adresse email"):t.code==="auth/too-many-requests"?new Error("Trop de tentatives. Veuillez réessayer plus tard"):t.code==="auth/invalid-email"?new Error("Adresse email invalide"):new Error(`Erreur lors de l'envoi de l'email: ${t.message}`)}}const Lp="magicLinks";function Fp({seasonId:n,playerId:e,eventId:t}){return`${n}__${e}__${t}`}function LV(n=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let r=0;r<n;r++)t+=e[Math.floor(Math.random()*e.length)];return t}async function z_({seasonId:n,playerId:e,eventId:t,action:r}){const s=Fp({seasonId:n,playerId:e,eventId:t}),i=LV(40),o=ke(ye,Lp,s),a=Date.now()+1e3*60*60*24*7;await Pn(o,{seasonId:n,playerId:e,eventId:t,token:i,action:r,expiresAt:a});const u=`${window.location.origin+"/impro-selector/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&eid=${encodeURIComponent(t)}&t=${encodeURIComponent(i)}&a=${encodeURIComponent(r)}`;return{id:s,token:i,url:u}}async function FV({seasonId:n,playerId:e,eventId:t,token:r,action:s}){const i=Fp({seasonId:n,playerId:e,eventId:t}),o=ke(ye,Lp,i),a=await Pi(o);if(!a.exists())return{valid:!1,reason:"not_found"};const c=a.data();return c.token!==r?{valid:!1,reason:"token_mismatch"}:c.action!==s?{valid:!1,reason:"action_mismatch"}:typeof c.expiresAt=="number"&&Date.now()>c.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:c}}async function UV({seasonId:n,playerId:e,eventId:t}){const r=Fp({seasonId:n,playerId:e,eventId:t}),s=ke(ye,Lp,r);await ll(s)}async function BV({toEmail:n,playerName:e,eventTitle:t,eventDate:r,yesUrl:s,noUrl:i,reason:o="new_event",fromEmail:a=void 0}){const c=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>Disponibilité demandée</h2>
      <p>Bonjour ${e},</p>
      <p>Peux-tu indiquer ta disponibilité pour <strong>${t}</strong> (${r}) ?</p>
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;margin-right:8px;background:#16a34a;color:#fff;border-radius:8px;text-decoration:none;">Je suis dispo ✅</a>
        <a href="${i}" style="display:inline-block;padding:10px 16px;background:#dc2626;color:#fff;border-radius:8px;text-decoration:none;">Pas dispo ❌</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Motif: ${o}</p>
    </div>
  `,u=`Disponibilité demandée · ${t}`,d={to:n,message:{subject:u,html:c},createdAt:mp(),meta:{reason:o,eventTitle:t,eventDate:r,playerName:e}};return a&&(d.from=a,d.replyTo=a),await qw(tt(ye,"mail"),d),{success:!0}}const $V={class:"text-center mb-6"},jV={class:"text-lg text-gray-300"},qV={class:"mb-6"},zV={class:"flex items-center space-x-3"},GV={class:"text-2xl"},KV={class:"font-semibold text-white"},HV={class:"text-sm text-gray-300"},WV={class:"mb-6"},QV={key:0,class:"mt-2 p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg text-sm text-gray-300 space-y-1"},JV={key:0,class:"mb-6"},YV={class:"space-y-4"},XV=["disabled"],ZV={key:0,class:"animate-spin"},eN={key:1},tN={key:1,class:"mb-6"},nN={key:0,class:"space-y-4 mb-4"},rN=["disabled"],sN={key:0,class:"animate-spin"},iN={key:1},oN=["disabled"],aN={key:2,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},lN={class:"text-red-300 text-sm"},cN={key:3,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},uN={class:"text-green-300 text-sm"},dN={__name:"PlayerProtectionModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","update"],setup(n,{emit:e}){const t=n,r=e,s=G(!1),i=G(""),o=G(""),a=G(""),c=G(!1),u=G(""),d=G(""),f=G(!1),g=G(!1),_=G(""),D=tn(()=>i.value&&o.value&&a.value&&o.value===a.value&&o.value.length>=6&&i.value.includes("@"));async function T(){var O;if((O=t.player)!=null&&O.id&&(s.value=await oi(t.player.id,t.seasonId),!s.value)){const q=await Bb(t.player.id,t.seasonId);q&&(i.value=q)}}async function C(){if(D.value){c.value=!0,u.value="",d.value="";try{await OV(t.player.id,i.value,o.value,t.seasonId),d.value="Protection activée avec succès !",s.value=!0,i.value="",o.value="",a.value="",r("update")}catch(O){console.error("Erreur lors de l'activation de la protection:",O),O.message&&O.message.includes("email")?u.value="Cette adresse email est déjà utilisée par un autre joueur.":u.value="Erreur lors de l'activation de la protection. Veuillez réessayer."}finally{c.value=!1}}}function U(){g.value=!0,_.value="",u.value=""}async function B(){if(_.value){c.value=!0,u.value="",d.value="";try{if(!await _u(t.player.id,_.value,t.seasonId)){u.value="Mot de passe incorrect. Veuillez réessayer.";return}const q=await MV(t.player.id,t.seasonId);d.value="Protection désactivée avec succès !",s.value=!1,g.value=!1,_.value="",q.email&&(i.value=q.email),r("update")}catch(O){console.error("Erreur lors de la désactivation de la protection:",O),u.value="Erreur lors de la désactivation de la protection. Veuillez réessayer."}finally{c.value=!1}}}function L(){r("close")}return nr(()=>t.player,()=>{t.show&&t.player&&T()},{immediate:!0}),nr(()=>t.show,O=>{O&&t.player&&(o.value="",a.value="",u.value="",d.value="",f.value=!1,g.value=!1,_.value="",T())}),(O,q)=>{var ie;return n.show?(Q(),X("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4",onClick:L},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:q[6]||(q[6]=Yn(()=>{},["stop"]))},[m("div",$V,[q[7]||(q[7]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"🔒")],-1)),q[8]||(q[8]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Protection du joueur",-1)),m("p",jV,pe((ie=n.player)==null?void 0:ie.name),1)]),m("div",qV,[m("div",{class:Zn(["flex items-center justify-between p-4 rounded-lg",s.value?"bg-green-500/20 border border-green-500/30":"bg-gray-500/20 border border-gray-500/30"])},[m("div",zV,[m("span",GV,pe(s.value?"🔒":"🔓"),1),m("div",null,[m("div",KV,pe(s.value?"Protégé":"Non protégé"),1),m("div",HV,pe(s.value?"Modifications sécurisées":"Modifications libres"),1)])])],2)]),m("div",WV,[m("button",{onClick:q[0]||(q[0]=x=>f.value=!f.value),class:"w-full p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-all duration-200 flex items-center justify-between"},[q[9]||(q[9]=m("h3",{class:"text-sm font-semibold text-blue-300"},"💡 Pourquoi protéger son joueur ?",-1)),m("span",{class:Zn(["text-blue-300 transition-transform duration-200",{"rotate-180":f.value}])},"▼",2)]),f.value?(Q(),X("div",QV,q[10]||(q[10]=[m("div",null,[xr("• "),m("span",{class:"text-blue-300"},"Protection des disponibilités :"),xr(" Seul vous pouvez modifier vos disponibilités")],-1),m("div",null,[xr("• "),m("span",{class:"text-blue-300"},"Protection du nom :"),xr(" Seul vous pouvez changer votre nom de joueur")],-1),m("div",null,[xr("• "),m("span",{class:"text-blue-300"},"Email requis :"),xr(" Permet de réinitialiser le mot de passe en cas d'oubli")],-1)]))):Ae("",!0)]),s.value?Ae("",!0):(Q(),X("div",JV,[q[14]||(q[14]=m("h3",{class:"text-lg font-semibold text-white mb-4"},"🔐 Activer la protection",-1)),m("div",YV,[m("div",null,[q[11]||(q[11]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Adresse email",-1)),gt(m("input",{"onUpdate:modelValue":q[1]||(q[1]=x=>i.value=x),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[Pt,i.value]])]),m("div",null,[q[12]||(q[12]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":q[2]||(q[2]=x=>o.value=x),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe sécurisé"},null,512),[[Pt,o.value]])]),m("div",null,[q[13]||(q[13]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":q[3]||(q[3]=x=>a.value=x),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe"},null,512),[[Pt,a.value]])])]),m("button",{onClick:C,disabled:!D.value||c.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(Q(),X("span",ZV,"⏳")):(Q(),X("span",eN,"🔒")),m("span",null,pe(c.value?"Activation...":"Activer la protection"),1)],8,XV)])),s.value?(Q(),X("div",tN,[q[17]||(q[17]=m("h3",{class:"text-lg font-semibold text-white mb-4"},"🔓 Désactiver la protection",-1)),q[18]||(q[18]=m("p",{class:"text-sm text-gray-300 mb-4"}," Attention : désactiver la protection supprimera définitivement le mot de passe et l'email associés. ",-1)),g.value?(Q(),X("div",nN,[m("div",null,[q[15]||(q[15]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe de confirmation",-1)),gt(m("input",{"onUpdate:modelValue":q[4]||(q[4]=x=>_.value=x),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe pour confirmer"},null,512),[[Pt,_.value]])]),m("button",{onClick:B,disabled:!_.value||c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(Q(),X("span",sN,"⏳")):(Q(),X("span",iN,"🔓")),m("span",null,pe(c.value?"Désactivation...":"Confirmer la désactivation"),1)],8,rN),m("button",{onClick:q[5]||(q[5]=x=>g.value=!1),class:"w-full px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])):Ae("",!0),g.value?Ae("",!0):(Q(),X("button",{key:1,onClick:U,disabled:c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},q[16]||(q[16]=[m("span",null,"🔓",-1),m("span",null,"Désactiver la protection",-1)]),8,oN))])):Ae("",!0),u.value?(Q(),X("div",aN,[m("div",lN,pe(u.value),1)])):Ae("",!0),d.value?(Q(),X("div",cN,[m("div",uN,pe(d.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:L,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0)}}},hN={class:"text-center mb-6"},fN={class:"text-lg text-gray-300"},pN={class:"mb-6"},mN={class:"space-y-4"},gN=["disabled"],_N={key:0,class:"animate-spin"},yN={key:1},vN={class:"mb-6 text-center"},wN={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},bN={class:"text-red-300 text-sm"},IN={class:"text-center mb-6"},EN={class:"text-lg text-gray-300"},TN={class:"mb-6"},AN=["disabled"],xN={key:0,class:"animate-spin"},PN={key:1},SN={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},RN={class:"text-red-300 text-sm"},CN={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},kN={class:"text-green-300 text-sm"},DN={class:"flex justify-center"},VN={__name:"PasswordVerificationModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","verified"],setup(n,{emit:e}){const t=n,r=e,s=G(""),i=G(!1),o=G(""),a=G(!1),c=G(""),u=G(""),d=G(null);async function f(){if(s.value){i.value=!0,o.value="";try{const D=await Gh(t.seasonId);if(s.value===D){r("verified",{type:"season_pin"}),_();return}await _u(t.player.id,s.value,t.seasonId)?(r("verified",{type:"player_password"}),_()):o.value="Mot de passe incorrect. Veuillez réessayer."}catch(D){console.error("Erreur lors de la vérification:",D),o.value="Erreur lors de la vérification. Veuillez réessayer."}finally{i.value=!1}}}async function g(){i.value=!0,c.value="",u.value="";try{const D=await Kh(t.player.id,t.seasonId);u.value=D.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(D){console.error("Erreur lors de l'envoi de l'email:",D),c.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{i.value=!1}}function _(){r("close"),s.value="",o.value="",a.value=!1,c.value="",u.value=""}return nr(()=>t.show,D=>{D&&Es(()=>{d.value&&d.value.focus()})}),(D,T)=>{var C,U;return Q(),X(zt,null,[n.show?(Q(),X("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4",onClick:_},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:T[2]||(T[2]=Yn(()=>{},["stop"]))},[m("div",hN,[T[6]||(T[6]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"🔐")],-1)),T[7]||(T[7]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Vérification requise",-1)),m("p",fN,pe((C=n.player)==null?void 0:C.name),1),T[8]||(T[8]=m("p",{class:"text-sm text-gray-400 mt-2"},"Ce joueur est protégé par mot de passe",-1))]),m("div",pN,[m("div",mN,[m("div",null,[T[9]||(T[9]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),gt(m("input",{"onUpdate:modelValue":T[0]||(T[0]=B=>s.value=B),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:An(f,["enter"]),ref_key:"passwordInput",ref:d},null,544),[[Pt,s.value]])])]),m("button",{onClick:f,disabled:!s.value||i.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(Q(),X("span",_N,"⏳")):(Q(),X("span",yN,"🔓")),m("span",null,pe(i.value?"Vérification...":"Vérifier"),1)],8,gN)]),m("div",vN,[m("button",{onClick:T[1]||(T[1]=B=>a.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),o.value?(Q(),X("div",wN,[m("div",bN,pe(o.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:_,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):Ae("",!0),a.value?(Q(),X("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:T[5]||(T[5]=B=>a.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:T[4]||(T[4]=Yn(()=>{},["stop"]))},[m("div",IN,[T[10]||(T[10]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"📧")],-1)),T[11]||(T[11]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Mot de passe oublié",-1)),m("p",EN,pe((U=n.player)==null?void 0:U.name),1)]),m("div",TN,[T[12]||(T[12]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),m("button",{onClick:g,disabled:i.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(Q(),X("span",xN,"⏳")):(Q(),X("span",PN,"📧")),m("span",null,pe(i.value?"Envoi...":"Envoyer l'email"),1)],8,AN)]),c.value?(Q(),X("div",SN,[m("div",RN,pe(c.value),1)])):Ae("",!0),u.value?(Q(),X("div",CN,[m("div",kN,pe(u.value),1)])):Ae("",!0),m("div",DN,[m("button",{onClick:T[3]||(T[3]=B=>a.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0)],64)}}},NN={class:"text-center mb-6"},ON={class:"text-3xl font-bold text-white mb-2"},MN={class:"mb-8"},LN={class:"grid grid-cols-2 gap-4"},FN={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-500/30"},UN={class:"text-2xl font-bold text-white"},BN={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-4 rounded-lg border border-cyan-500/30"},$N={class:"text-2xl font-bold text-white"},jN={class:"mt-4 bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-500/30"},qN={class:"text-xl font-bold text-white"},zN={class:"flex justify-center space-x-3"},GN={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},KN={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},HN={class:"mb-6"},WN={__name:"PlayerModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},stats:{type:Object,default:()=>({availability:0,selection:0,ratio:0})},seasonId:{type:String,default:null}},emits:["close","update","delete","refresh"],setup(n,{emit:e}){const t=n,r=e,s=G(!1),i=G(""),o=G(null),a=G(!1),c=G(!1),u=G(null);function d(){r("close")}function f(){var L;i.value=((L=t.player)==null?void 0:L.name)||"",s.value=!0,Es(()=>{o.value&&o.value.focus()})}function g(){s.value=!1,i.value=""}async function _(){var O,q;if(!i.value.trim())return;if(await oi((O=t.player)==null?void 0:O.id,t.seasonId)){ja((q=t.player)==null?void 0:q.id)?D():(u.value="update",c.value=!0);return}D()}function D(){var L;r("update",{playerId:(L=t.player)==null?void 0:L.id,newName:i.value.trim()}),s.value=!1,i.value=""}async function T(){var O,q;if(await oi((O=t.player)==null?void 0:O.id,t.seasonId)){ja((q=t.player)==null?void 0:q.id)?C():(u.value="delete",c.value=!0);return}C()}function C(){var L;r("delete",(L=t.player)==null?void 0:L.id)}function U(){r("refresh")}function B(L){u.value==="update"?D():u.value==="delete"&&C(),u.value=null}return nr(()=>t.show,L=>{L||(s.value=!1,i.value="",u.value=null)}),(L,O)=>{var q;return Q(),X(zt,null,[n.show?(Q(),X("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[80] p-4",onClick:d},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-2xl",onClick:O[1]||(O[1]=Yn(()=>{},["stop"]))},[m("div",NN,[O[5]||(O[5]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"👤")],-1)),m("h2",ON,pe((q=n.player)==null?void 0:q.name),1),O[6]||(O[6]=m("p",{class:"text-xl text-purple-300"},"Détails du joueur",-1))]),m("div",MN,[O[10]||(O[10]=m("h3",{class:"text-lg font-semibold text-white mb-4"},"📊 Statistiques",-1)),m("div",LN,[m("div",FN,[m("div",UN,pe(t.stats.availability),1),O[7]||(O[7]=m("div",{class:"text-sm text-gray-300"},"Disponibilités",-1))]),m("div",BN,[m("div",$N,pe(t.stats.selection),1),O[8]||(O[8]=m("div",{class:"text-sm text-gray-300"},"Sélections",-1))])]),m("div",jN,[m("div",qN,pe(t.stats.ratio)+"%",1),O[9]||(O[9]=m("div",{class:"text-sm text-gray-300"},"Taux de sélection",-1))])]),m("div",zN,[m("button",{onClick:f,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center space-x-2"},O[11]||(O[11]=[m("span",null,"✏️",-1),m("span",null,"Modifier",-1)])),m("button",{onClick:O[0]||(O[0]=ie=>a.value=!0),class:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex items-center space-x-2"},O[12]||(O[12]=[m("span",null,"🔒",-1),m("span",null,"Protection",-1)])),m("button",{onClick:T,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center space-x-2"},O[13]||(O[13]=[m("span",null,"🗑️",-1),m("span",null,"Supprimer",-1)])),m("button",{onClick:d,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0),s.value?(Q(),X("div",GN,[m("div",KN,[O[15]||(O[15]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Modifier le joueur",-1)),m("div",HN,[O[14]||(O[14]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),gt(m("input",{"onUpdate:modelValue":O[2]||(O[2]=ie=>i.value=ie),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[An(g,["esc"]),An(_,["enter"])],ref_key:"editNameInput",ref:o},null,544),[[Pt,i.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:g,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:_,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):Ae("",!0),Gt(dN,{show:a.value,player:n.player,seasonId:n.seasonId,onClose:O[3]||(O[3]=ie=>a.value=!1),onUpdate:U},null,8,["show","player","seasonId"]),Gt(VN,{show:c.value,player:n.player,seasonId:n.seasonId,onClose:O[4]||(O[4]=ie=>c.value=!1),onVerified:B},null,8,["show","player","seasonId"])],64)}}},QN={class:"text-center mb-6"},JN={class:"text-3xl font-bold text-white mb-2"},YN={class:"text-xl text-purple-300"},XN={class:"mb-6"},ZN={class:"grid grid-cols-3 gap-4"},eO={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-500/30"},tO={class:"text-2xl font-bold text-white"},nO={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-500/30"},rO={class:"text-2xl font-bold text-white"},sO={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-4 rounded-lg border border-cyan-500/30"},iO={class:"text-2xl font-bold text-white"},oO={key:0,class:"mb-6"},aO={class:"flex items-center space-x-3 p-3 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20"},lO={class:"flex-1"},cO={class:"text-blue-300 text-sm font-medium"},uO={key:1,class:"mb-6"},dO={class:"flex items-center space-x-3 p-4 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 rounded-lg border border-yellow-500/20"},hO={class:"flex-1"},fO={class:"text-yellow-200 text-sm"},pO={key:2,class:"mb-6"},mO={class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4"},gO={class:"text-white font-medium"},_O={key:0,class:"text-purple-400 mr-2"},yO={key:1,class:"text-green-400 mr-2"},vO={key:2,class:"text-red-400 mr-2"},wO={key:3,class:"text-gray-400 mr-2"},bO={class:"mb-4"},IO={class:"relative"},EO=["value"],TO=["title"],AO={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xO={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},PO={key:3,class:"mb-6"},SO={class:"text-center p-6 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/20"},RO={class:"text-4xl mb-4"},CO={class:"text-xl font-semibold text-white mb-2"},kO={class:"text-gray-300"},DO={class:"flex justify-center space-x-3"},VO=["disabled","title"],NO={__name:"SelectionModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},currentSelection:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},selectedCount:{type:Number,default:0},playerAvailability:{type:Object,default:()=>({})}},emits:["close","selection","perfect"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=G(!1),o=G("Copier le message"),a=G(!1),c=G(""),u=G(!1),d=tn(()=>r.currentSelection&&r.currentSelection.length>0),f=tn(()=>{var Ne;if(!d.value)return!1;const w=r.currentSelection.some(nt=>!L(nt)),S=((Ne=r.event)==null?void 0:Ne.playerCount)||6,I=r.availableCount<S;return w||I}),g=tn(()=>{var I;if(!f.value)return"";const w=r.currentSelection.filter(Ne=>!L(Ne)),S=((I=r.event)==null?void 0:I.playerCount)||6;return w.length>0?w.length===1?`${w[0]} n'est plus disponible. Veuillez relancer la sélection.`:`${w.length} joueurs ne sont plus disponibles. Veuillez relancer la sélection.`:r.availableCount<S?`Seulement ${r.availableCount} joueurs disponibles pour ${S} requis. Veuillez attendre plus de disponibilités ou ajuster le nombre de joueurs à sélectionner.`:"Sélection incomplète"}),_=tn(()=>{if(!r.event||!d.value)return"";const w=D(r.event.date),S=r.currentSelection.join(", ");return`Sélection pour ${r.event.title} du ${w} : ${S}`});nr(()=>r.show,w=>{w&&(i.value=!1,o.value="Copier le message",a.value=!1,c.value="",u.value=!1)});function D(w){var I;return w?(typeof w=="string"?new Date(w):((I=w.toDate)==null?void 0:I.call(w))||w).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function T(){const w=_.value;navigator.clipboard.writeText(w).then(()=>{i.value=!0,o.value="Copié !",setTimeout(()=>{i.value=!1,o.value="Copier le message"},2e3)}).catch(S=>{console.error("Erreur lors de la copie du texte:",S),alert("Impossible de copier le message.")})}function C(){s("selection")}function U(){s("perfect")}function B(){s("close")}function L(w){return r.playerAvailability[w]===!0}function O(w){return r.playerAvailability[w]===!1}function q(w){return r.currentSelection.includes(w)&&L(w)}function ie(){var S;const w=((S=r.event)==null?void 0:S.playerCount)||6;return r.availableCount===0||r.availableCount<w?"⚠️":"🎲"}function x(){var S;const w=((S=r.event)==null?void 0:S.playerCount)||6;return r.availableCount===0?"Aucun joueur disponible":r.availableCount<w?"Pas assez de joueurs disponibles":"Aucune sélection effectuée"}function E(){var S;const w=((S=r.event)==null?void 0:S.playerCount)||6;return r.availableCount===0?"Aucun joueur n'est disponible pour cet événement. Veuillez d'abord indiquer les disponibilités.":r.availableCount<w?`Seulement ${r.availableCount} joueurs disponibles pour ${w} requis. Veuillez attendre plus de disponibilités ou ajuster le nombre de joueurs à sélectionner.`:'Cliquez sur "Sélection Auto" pour lancer le tirage automatique des joueurs'}function A(w=!1,S=!1){if(u.value=w,w){const I=D(r.event.date),Ne=r.currentSelection.join(", ");S?c.value=`Sélection mise à jour pour ${r.event.title} du ${I} : ${Ne}`:c.value=`Nouvelle sélection pour ${r.event.title} du ${I} : ${Ne}`}else c.value="Sélection effectuée avec succès !";a.value=!0,setTimeout(()=>{a.value=!1},8e3)}function R(){a.value=!1}return e({showSuccess:A}),(w,S)=>{var I,Ne,nt;return n.show?(Q(),X("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[80] p-4",onClick:B},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-2xl",onClick:S[0]||(S[0]=Yn(()=>{},["stop"]))},[m("div",QN,[S[1]||(S[1]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"🎭")],-1)),m("h2",JN,"Sélection pour "+pe((I=n.event)==null?void 0:I.title),1),m("p",YN,pe(D((Ne=n.event)==null?void 0:Ne.date)),1)]),m("div",XN,[m("div",ZN,[m("div",eO,[m("div",tO,pe(((nt=n.event)==null?void 0:nt.playerCount)||6),1),S[2]||(S[2]=m("div",{class:"text-sm text-gray-300"},"À sélectionner",-1))]),m("div",nO,[m("div",rO,pe(n.availableCount),1),S[3]||(S[3]=m("div",{class:"text-sm text-gray-300"},"Disponibles",-1))]),m("div",sO,[m("div",iO,pe(n.selectedCount),1),S[4]||(S[4]=m("div",{class:"text-sm text-gray-300"},"Sélectionnés",-1))])])]),a.value?(Q(),X("div",oO,[m("div",aO,[S[6]||(S[6]=m("div",{class:"text-blue-400 text-xl"},"✨",-1)),m("div",lO,[m("p",cO,pe(c.value),1)]),m("button",{onClick:R,class:"text-blue-400 hover:text-blue-300 transition-colors",title:"Fermer le message"},S[5]||(S[5]=[m("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):Ae("",!0),f.value?(Q(),X("div",uO,[m("div",dO,[S[8]||(S[8]=m("div",{class:"text-yellow-400 text-xl"},"⚠️",-1)),m("div",hO,[S[7]||(S[7]=m("h3",{class:"text-yellow-300 text-sm font-semibold mb-1"},"Sélection incomplète",-1)),m("p",fO,pe(g.value),1)])])])):Ae("",!0),d.value?(Q(),X("div",pO,[S[12]||(S[12]=m("h3",{class:"text-lg font-semibold text-white mb-3"},"Joueurs sélectionnés :",-1)),m("div",mO,[(Q(!0),X(zt,null,gs(n.currentSelection,Ue=>(Q(),X("div",{key:Ue,class:Zn(["bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 rounded-lg border border-green-500/30 text-center",{"from-red-500/20 to-red-600/20 border-red-500/30":!L(Ue),"from-yellow-500/20 to-orange-500/20 border-yellow-500/30":O(Ue)}])},[m("span",gO,[q(Ue)?(Q(),X("span",_O,"🎭")):L(Ue)?(Q(),X("span",yO,"✅")):O(Ue)?(Q(),X("span",vO,"❌")):(Q(),X("span",wO,"–")),xr(" "+pe(Ue),1)])],2))),128))]),m("div",bO,[S[11]||(S[11]=m("h4",{class:"text-md font-semibold text-white mb-2"},"Message à envoyer :",-1)),m("div",IO,[m("textarea",{value:_.value,class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400 resize-none",rows:"3",readonly:""},null,8,EO),m("button",{onClick:T,class:"absolute top-2 right-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg p-2 hover:from-purple-600 hover:to-pink-700 transition-all duration-300",title:o.value},[i.value?(Q(),X("svg",xO,S[10]||(S[10]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(Q(),X("svg",AO,S[9]||(S[9]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])))],8,TO)])])])):(Q(),X("div",PO,[m("div",SO,[m("div",RO,pe(ie()),1),m("h3",CO,pe(x()),1),m("p",kO,pe(E()),1)])])),m("div",DO,[m("button",{onClick:C,disabled:n.availableCount===0,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",title:n.availableCount===0?"Aucun joueur disponible":d.value?"Relancer la sélection automatique":"Lancer la sélection automatique"},S[13]||(S[13]=[m("span",null,"✨",-1),m("span",null,"Sélection Auto",-1)]),8,VO),d.value?(Q(),X("button",{key:0,onClick:U,class:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex items-center space-x-2"},S[14]||(S[14]=[m("span",null,"👍",-1),m("span",null,"Parfait",-1)]))):Ae("",!0)])])])):Ae("",!0)}}};const OO={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},MO={class:"text-center py-8 px-4 relative"},LO={class:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},FO={class:"w-full px-2 md:px-4 pb-4"},UO={class:"table-auto border-collapse table-fixed w-full min-w-max"},BO={class:"text-white"},$O={class:"p-3 md:p-4 text-left sticky top-0 left-0 z-50 bg-gray-900"},jO={class:"flex flex-col items-center space-y-2"},qO=["onClick"],zO={class:"flex flex-col items-center gap-1"},GO=["title"],KO=["title"],HO=["title","onClick"],WO=["title","onClick"],QO=["data-player-id"],JO={class:"p-4 md:p-5 font-medium text-white relative group text-xl md:text-2xl sticky left-0 z-40 bg-gray-900"},YO={class:"font-bold text-xl md:text-2xl whitespace-pre-wrap flex items-center"},XO={key:0,class:"text-yellow-400 mr-1 text-sm",title:"Joueur protégé par mot de passe"},ZO=["onClick","title"],e2=["onClick"],t2={class:"flex items-center justify-center"},n2=["title"],r2=["title"],s2=["title"],i2=["title"],o2={class:"pointer-events-none absolute inset-y-0 left-2 w-6 flex items-center justify-center z-[60]"},a2={class:"pointer-events-none absolute inset-y-0 right-2 w-6 flex items-center justify-center z-[60]"},l2={key:0,class:"fixed bottom-4 left-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-2xl border border-green-400/30 backdrop-blur-sm z-50"},c2={class:"flex items-center space-x-2"},u2={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},d2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},h2={class:"mb-6"},f2={class:"mb-6"},p2={class:"mb-6"},m2={class:"mb-6"},g2={key:2,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},_2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},y2={class:"mb-6"},v2={class:"flex justify-end space-x-3"},w2={key:3,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},b2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},I2={class:"flex justify-end space-x-3"},E2={key:4,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},T2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},A2={class:"flex justify-end space-x-3"},x2={key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[95] p-4"},P2={class:"text-center mb-6"},S2={class:"text-3xl font-bold text-white mb-2"},R2={class:"text-xl text-purple-300"},C2={key:0,class:"mb-6"},k2={class:"text-gray-300 bg-gray-800/50 p-4 rounded-lg border border-gray-600/50"},D2={class:"mb-6"},V2={class:"grid grid-cols-3 gap-4"},N2={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-500/30"},O2={class:"text-2xl font-bold text-white"},M2={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-4 rounded-lg border border-cyan-500/30"},L2={class:"text-2xl font-bold text-white"},F2={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-500/30"},U2={class:"text-2xl font-bold text-white"},B2={class:"flex justify-center space-x-3"},$2={key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},j2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},q2={class:"mb-6"},z2={class:"mb-6"},G2={class:"mb-6"},K2={class:"mb-6"},H2={key:8,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},W2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},Q2={class:"mb-6"},J2={class:"space-y-4"},Y2=["disabled"],X2={key:0,class:"animate-spin"},Z2={key:1},eM={class:"mb-6 text-center"},tM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},nM={class:"text-red-300 text-sm"},rM={key:9,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},sM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},iM={class:"mb-6"},oM={class:"space-y-4"},aM=["disabled"],lM={key:0,class:"animate-spin"},cM={key:1},uM={class:"mb-6 text-center"},dM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},hM={class:"text-red-300 text-sm"},fM={class:"mb-6"},pM=["disabled"],mM={key:0,class:"animate-spin"},gM={key:1},_M={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},yM={class:"text-red-300 text-sm"},vM={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},wM={class:"text-green-300 text-sm"},bM={class:"flex justify-center"},IM={class:"mb-6"},EM=["disabled"],TM={key:0,class:"animate-spin"},AM={key:1},xM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},PM={class:"text-red-300 text-sm"},SM={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},RM={class:"text-green-300 text-sm"},CM={class:"flex justify-center"},kM={__name:"GridBoard",props:{slug:{type:String,required:!0}},setup(n){const e=n,t=Du(),r=e.slug,s=G(""),i=G(""),o=G(!1),a=G(null),c=G(null),u=G(""),d=G(""),f=G(6),g=G(!1),_=G(""),D=G(null),T=G(!1),C=G(null),U=G(!1),B=G(null),L=G(!1),O=G(null),q=G(""),ie=G(!1),x=G(null),E=G(""),A=G(""),R=G(!1),w=G(null),S=G(!1),I=G(null),Ne=G(""),nt=G(""),Ue=G(!1),$e=G(null),Oe=G(!1),Ht=G(!1),hn=G(""),on=G(""),ot=G(!1),rt=G(!1),On=G(""),En=G(""),Ot=G(!1),j=G(null),he=G(""),se=G(!1),ce=G(null),De=G(null),Je=G(new Set),b=G(null),P=G(!1),M=G(!1);function W(){const k=b.value;if(!k)return;const{scrollLeft:v,scrollWidth:K,clientWidth:_e}=k;P.value=v>2,M.value=v<K-_e-2}function z(k){D.value=k;const v=document.querySelector(`[data-player-id="${k}"]`);v&&v.scrollIntoView({behavior:"smooth",block:"center"}),H.value=!0,Z.value="Nouveau joueur ajouté !",setTimeout(()=>{H.value=!1},3e3)}function ee(k){return Je.value.has(k)}async function ae(){if(!i.value)return;const k=new Set;for(const v of at.value)await oi(v.id,i.value)&&k.add(v.id);Je.value=k}const H=G(!1),Z=G("");async function te(k){await Xr({type:"deleteEvent",data:{eventId:k}})}async function be(k=null){const v=k||a.value;if(console.log("deleteEventConfirmed - eventId param:",k),console.log("deleteEventConfirmed - eventToDelete.value:",a.value),console.log("deleteEventConfirmed - eventIdToDelete:",v),console.log("deleteEventConfirmed - type de eventIdToDelete:",typeof v),!v){console.error("Aucun événement à supprimer");return}try{await RV(v,i.value),Ke.value=Ke.value.filter(K=>K.id!==v),await Promise.all([$_(i.value),_a(at.value,Ke.value,i.value),ya(i.value)]).then(([K,_e,Ee])=>{Ke.value=K,xt.value=_e,ht.value=Ee}),o.value=!1,a.value=null,H.value=!0,Z.value="Événement supprimé avec succès !",setTimeout(()=>{H.value=!1},3e3)}catch(K){console.error("Erreur lors de la suppression de l'événement:",K),alert("Erreur lors de la suppression de l'événement. Veuillez réessayer.")}}function ue(){o.value=!1,a.value=null}async function me(){if(!c.value||!u.value.trim()||!d.value)return;const k=parseInt(f.value);if(isNaN(k)||k<1||k>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}try{const v={title:u.value.trim(),date:d.value,description:he.value.trim()||"",playerCount:k};await kV(c.value,v,i.value),await es({eventId:c.value,eventData:v,reason:"updated"}),await Promise.all([$_(i.value),_a(at.value,Ke.value,i.value),ya(i.value)]).then(([K,_e,Ee])=>{Ke.value=K,xt.value=_e,ht.value=Ee}),c.value=null,u.value="",d.value="",he.value="",f.value=6,H.value=!0,Z.value="Événement mis à jour avec succès !",setTimeout(()=>{H.value=!1},3e3)}catch(v){console.error("Erreur lors de l'édition de l'événement:",v),alert("Erreur lors de l'édition de l'événement. Veuillez réessayer.")}}async function Te(){if(_.value.trim())try{const k=_.value.trim(),v=await TV(k,i.value);await Promise.all([th(i.value),_a(at.value,Ke.value,i.value),ya(i.value)]).then(([K,_e,Ee])=>{at.value=K,xt.value=_e,ht.value=Ee,ae();const Le=at.value.find(Fe=>Fe.id===v);z(v);const Pe=document.querySelector(`[data-player-id="${v}"]`);Pe&&Pe.scrollIntoView({behavior:"smooth",block:"center"}),H.value=!0,Z.value="Joueur ajouté avec succès ! Vous pouvez maintenant indiquer sa disponibilité.",setTimeout(()=>{H.value=!1},3e3),setTimeout(()=>{H.value=!1,Z.value=""},5e3)}),g.value=!1,_.value=""}catch(k){console.error("Erreur lors de l'ajout du joueur:",k),alert("Erreur lors de l'ajout du joueur. Veuillez réessayer.")}}function Ie(){c.value=null,u.value="",d.value="",he.value="",f.value=6}G(null);const xe=G(!1),Me=G(""),wt=G(""),mt=G(""),Wt=G(6);async function Mt(){if(!Me.value.trim()||!wt.value){alert("Veuillez remplir le titre et la date de l'événement");return}const k=parseInt(Wt.value);if(isNaN(k)||k<1||k>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}const v={title:Me.value.trim(),date:wt.value,description:mt.value.trim()||"",playerCount:k};await sr(v)}async function sr(k){try{const v=await CV(k,i.value);Ke.value=[...Ke.value,{id:v,...k}];const K={};for(const _e of at.value)K[_e.name]=xt.value[_e.name]||{},K[_e.name][v]=null,await j_(_e.name,K[_e.name],i.value);Me.value="",wt.value="",mt.value="",Wt.value=6,xe.value=!1,await Promise.resolve(),H.value=!0,Z.value="Événement créé avec succès !";try{await es({eventId:v,eventData:k,reason:"created"})}catch(_e){console.warn("Envoi des emails partiellement en échec:",_e)}setTimeout(()=>{H.value=!1},3e3)}catch(v){console.error("Erreur lors de la création de l'événement:",(v==null?void 0:v.message)||v),alert("Erreur lors de la création de l'événement. Veuillez réessayer.")}}function Bs(){Me.value="",wt.value="",mt.value="",Wt.value=6,xe.value=!1}async function Qt(){await Xr({type:"addEvent",data:{}})}const Ke=G([]),at=G([]),xt=G({}),ht=G({}),ql=G({}),Jr=G({});_l(async()=>{bV("firebase"),await EV();const k=Fw(tt(ye,"seasons"),hC("slug","==",e.slug)),v=await St(k);if(!v.empty){const K=v.docs[0];i.value=K.id,s.value=K.data().name,document.title=`Saison : ${s.value}`}if(i.value){const K=await St(tt(ye,"seasons",i.value,"players"));at.value=K.docs.map(je=>({id:je.id,...je.data()})),await ae();const _e=await St(tt(ye,"seasons",i.value,"events"));Ke.value=_e.docs.map(je=>({id:je.id,...je.data(),playerCount:je.data().playerCount||6}));const Ee=await St(tt(ye,"seasons",i.value,"availability")),Le={};Ee.docs.forEach(je=>{const $t=je.data(),bt={};Object.keys($t).forEach(Ye=>{const re=$t[Ye];re==="oui"?bt[Ye]=!0:re==="non"?bt[Ye]=!1:bt[Ye]=re}),Le[je.id]=bt}),xt.value=Le;const Pe=await St(tt(ye,"seasons",i.value,"selections")),Fe={};Pe.docs.forEach(je=>{Fe[je.id]=je.data().players||[]}),ht.value=Fe}yr(),zl(),console.log("players (deduplicated):",at.value.map(K=>({id:K.id,name:K.name}))),console.log("availability loaded:",xt.value),Es(()=>{W();const K=b.value;K&&(K.addEventListener("scroll",W,{passive:!0}),window.addEventListener("resize",W))})});async function Ko(k,v){const K=at.value.find(Le=>Le.name===k);if(!K){console.error("Joueur non trouvé:",k);return}if(!Ke.value.find(Le=>Le.id===v)){console.error("Événement non trouvé:",v);return}if(await oi(K.id,i.value)){ja(K.id)?$s(K,v):await Wl({type:"toggleAvailability",data:{player:K,eventId:v}});return}$s(K,v)}function $s(k,v){var Ee;const K=(Ee=xt.value[k.name])==null?void 0:Ee[v];console.log(`toggleAvailability - ${k.name} pour ${v}:`,K);let _e;K===!0?_e=!1:K===!1?_e=void 0:_e=!0,_e===void 0?xt.value[k.name]&&delete xt.value[k.name][v]:(xt.value[k.name]||(xt.value[k.name]={}),xt.value[k.name][v]=_e),j_(k.name,xt.value[k.name],i.value).then(()=>{H.value=!0,Z.value="Disponibilité mise à jour avec succès !",setTimeout(()=>{H.value=!1},3e3)}).catch(Le=>{console.error("Erreur lors de la mise à jour de la disponibilité:",Le),alert("Erreur lors de la mise à jour de la disponibilité. Veuillez réessayer.")})}function Jt(k,v){var K;return(K=xt.value[k])==null?void 0:K[v]}function Ho(k,v){var Ee;const K=ht.value[v]||[],_e=(Ee=xt.value[k])==null?void 0:Ee[v];return K.includes(k)&&_e===!0}async function ki(k,v=6){const K=Ke.value.find(Pe=>Pe.id===k),_e=(K==null?void 0:K.playerCount)||6,Ee=ht.value[k]||[];if(Ee.length>0&&Ee.every(Pe=>Jt(Pe,k))){console.log("Tous les joueurs sélectionnés sont disponibles, nouveau tirage complet");const Fe=at.value.filter(bt=>Jt(bt.name,k)).map(bt=>{const Ye=kt(bt.name);return{name:bt.name,weight:1/(1+Ye)}}),je=[],$t=[...Fe];for(;je.length<_e&&$t.length>0;){const bt=$t.reduce((He,Qn)=>He+Qn.weight,0);let Ye=Math.random()*bt;const re=$t.findIndex(He=>(Ye-=He.weight,Ye<=0));re>=0&&(je.push($t[re].name),$t.splice(re,1))}ht.value[k]=je}else{const Pe=Ee.filter(je=>Jt(je,k)),Fe=_e-Pe.length;if(Fe<=0)ht.value[k]=Pe;else{const je=new Set(Pe),bt=at.value.filter(He=>Jt(He.name,k)&&!je.has(He.name)).map(He=>{const Qn=kt(He.name);return{name:He.name,weight:1/(1+Qn)}}),Ye=[],re=[...bt];for(;Ye.length<Fe&&re.length>0;){const He=re.reduce((ra,_d)=>ra+_d.weight,0);let Qn=Math.random()*He;const jn=re.findIndex(ra=>(Qn-=ra.weight,Qn<=0));jn>=0&&(Ye.push(re[jn].name),re.splice(jn,1))}ht.value[k]=[...Pe,...Ye]}}await SV(k,ht.value[k],i.value),yr(),zl()}async function Wo(k,v=6){var Pe,Fe,je,$t,bt;console.log("tirerProtected appelé avec eventId:",k),console.log("showSelectionModal.value AVANT:",se.value),console.log("selectionModalEvent.value?.id AVANT:",(Pe=ce.value)==null?void 0:Pe.id);const K=se.value,_e=(Fe=ce.value)==null?void 0:Fe.id,Ee=ht.value[k]&&ht.value[k].length>0,Le=Ee?[...ht.value[k]]:[];if(await ki(k,v),console.log("showSelectionModal.value APRÈS tirage:",se.value),console.log("selectionModalEvent.value?.id APRÈS tirage:",(je=ce.value)==null?void 0:je.id),K&&!se.value&&(console.log("Restauration de la popin de sélection..."),se.value=!0,ce.value=Ke.value.find(Ye=>Ye.id===_e)),se.value&&(($t=ce.value)==null?void 0:$t.id)===k)if(console.log("Popin de sélection ouverte, mise à jour..."),await Es(),De.value&&De.value.showSuccess){console.log("Appel de showSuccess sur la popin de sélection");const Ye=ht.value[k]||[],re=Le.filter(Qn=>Ye.includes(Qn)),He=re.length>0&&re.length<Le.length;De.value.showSuccess(Ee,He)}else console.log("selectionModalRef.value:",De.value),console.log("showSuccess disponible:",(bt=De.value)==null?void 0:bt.showSuccess);else console.log("Popin de sélection fermée, affichage message global"),H.value=!0,Ke.value.find(Ye=>Ye.id===k),ht.value[k],Ee?Z.value="Sélection mise à jour avec succès !":Z.value="Sélection effectuée avec succès !",setTimeout(()=>{H.value=!1},3e3)}function js(k){var K;return k?(typeof k=="string"?new Date(k):((K=k.toDate)==null?void 0:K.call(k))||k).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):""}function Di(k){var K;return k?(typeof k=="string"?new Date(k):((K=k.toDate)==null?void 0:K.call(k))||k).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function kt(k){return Object.values(ht.value).filter(v=>v.includes(k)).length}function Vi(k){const v=xt.value[k]||{};return Object.values(v).filter(K=>K===!0).length}function ir(k){return k?Object.values(xt.value).filter(v=>v[k]===!0).length:0}function Yr(k){return k?(ht.value[k]||[]).length:0}function hd(k){const v=Vi(k),K=kt(k);return v===0?0:K/v}function fd(k){ql.value[k]={availability:Vi(k),selection:kt(k),ratio:hd(k)}}function yr(){at.value.forEach(k=>fd(k.name))}function zl(){const k={};Ke.value.forEach(v=>{const K=v.playerCount||6,Ee=at.value.filter(Pe=>Jt(Pe.name,v.id)===!0).map(Pe=>{const Fe=kt(Pe.name);return{name:Pe.name,weight:1/(1+Fe)}}),Le=Ee.reduce((Pe,Fe)=>Pe+Fe.weight,0);Ee.forEach(Pe=>{const Fe=Math.min(1,Pe.weight/Le*K);k[Pe.name]||(k[Pe.name]={}),k[Pe.name][v.id]=Math.round(Fe*100)})}),Jr.value=k}function Ni(k,v){var Pe,Fe;const K=k.name,_e=Jt(K,v),Ee=Ho(K,v),Le=((Fe=(Pe=Jr.value)==null?void 0:Pe[K])==null?void 0:Fe[v])??0;return _e===!1?"Non disponible – cliquez pour changer":Ee?`Sélectionné · Chance estimée : ${Le}%`:_e===!0?`Disponible · Chance estimée : ${Le}%`:"Cliquez pour indiquer votre disponibilité"}const vr=G(null),qs=G(!1);async function Qo(k=null){const v=k||vr.value;if(!v){console.error("Aucun joueur à supprimer");return}try{await AV(v,i.value),at.value=at.value.filter(K=>K.id!==v),qs.value=!1,vr.value=null,H.value=!0,Z.value="Joueur supprimé avec succès !",setTimeout(()=>{H.value=!1},3e3)}catch(K){console.error("Erreur lors de la suppression du joueur :",K),alert("Erreur lors de la suppression du joueur. Veuillez réessayer.")}}function Oi(){qs.value=!1,vr.value=null}async function or(k){Zl(),await oi(k,i.value)?await Hl({type:"deletePlayer",data:{playerId:k}}):await Xr({type:"deletePlayer",data:{playerId:k}})}async function Gl(){if(C.value){const k=Ke.value.find(K=>K.id===C.value),v=(k==null?void 0:k.playerCount)||6;await Wo(C.value,v),T.value=!1,C.value=null}}function Kl(){T.value=!1,C.value=null}function Jo(){return O.value?{deleteEvent:"Suppression d'événement - Code PIN requis",addEvent:"Ajout d'événement - Code PIN requis",deletePlayer:"Suppression de joueur - Code PIN requis",launchSelection:"Lancement de sélection - Code PIN requis"}[O.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function Xr(k){if(Cn.isPinCached(i.value)){const v=Cn.getCachedPin(i.value);if(console.log("PIN en cache trouvé, utilisation automatique"),await gu(i.value,v)){await Wn(k);return}else Cn.clearSession()}O.value=k,L.value=!0}async function Hl(k){const v=k.data.playerId;if(ja(v)){console.log("Mot de passe du joueur en cache trouvé, utilisation automatique"),await Wn(k);return}x.value=k,ie.value=!0}async function Wl(k){const v=k.data.player.id;if(ja(v)){console.log("Mot de passe du joueur en cache trouvé, utilisation automatique"),await Wn(k);return}I.value=k,S.value=!0}async function pd(k){try{if(await gu(i.value,k)){Cn.saveSession(i.value,k),L.value=!1;const K=O.value;O.value=null,await Wn(K)}else q.value="Code PIN incorrect",setTimeout(()=>{q.value=""},3e3)}catch(v){console.error("Erreur lors de la vérification du PIN:",v),q.value="Erreur lors de la vérification du code PIN"}}function Mi(){L.value=!1,O.value=null,q.value=""}async function Yo(k){if(k){R.value=!0,E.value="";try{const v=x.value.data.playerId,K=await Gh(i.value);if(k===K){try{ml.saveSession(x.value.data.playerId,k)}catch{}ie.value=!1;const Ee=x.value;x.value=null,A.value="",await Wn(Ee);return}if(await _u(v,k,i.value)){ie.value=!1;const Ee=x.value;x.value=null,A.value="",await Wn(Ee)}else E.value="Mot de passe incorrect",setTimeout(()=>{E.value=""},3e3)}catch(v){console.error("Erreur lors de la vérification du mot de passe:",v),E.value="Erreur lors de la vérification du mot de passe"}finally{R.value=!1}}}function Xo(){ie.value=!1,x.value=null,E.value="",A.value="",R.value=!1}async function Zr(k){if(k){Ue.value=!0,Ne.value="";try{const v=I.value.data.player,K=await Gh(i.value);if(k===K){try{ml.saveSession(I.value.data.player.id,k)}catch{}S.value=!1;const Ee=I.value;I.value=null,nt.value="",await Wn(Ee);return}if(await _u(v.id,k,i.value)){S.value=!1;const Ee=I.value;I.value=null,nt.value="",await Wn(Ee)}else Ne.value="Mot de passe incorrect",setTimeout(()=>{Ne.value=""},3e3)}catch(v){console.error("Erreur lors de la vérification du mot de passe:",v),Ne.value="Erreur lors de la vérification du mot de passe"}finally{Ue.value=!1}}}function wr(){S.value=!1,I.value=null,Ne.value="",nt.value="",Ue.value=!1}async function Zo(){Ht.value=!0,hn.value="",on.value="";try{const k=I.value.data.player,v=await Kh(k.id,i.value);on.value=v.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(k){console.error("Erreur lors de l'envoi de l'email:",k),hn.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{Ht.value=!1}}async function md(){rt.value=!0,On.value="",En.value="";try{const k=x.value.data.playerId,v=await Kh(k,i.value);En.value=v.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(k){console.error("Erreur lors de l'envoi de l'email:",k),On.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{rt.value=!1}}function Ql(){return Cn.isPinCached(i.value)?{timeRemaining:Cn.getTimeRemaining(),isExpiringSoon:Cn.isExpiringSoon()}:null}async function Wn(k){if(!k)return;const{type:v,data:K}=k;try{switch(v){case"deleteEvent":console.log("executePendingOperation - data.eventId:",K.eventId),console.log("executePendingOperation - type de data.eventId:",typeof K.eventId),a.value=K.eventId,o.value=!0;break;case"addEvent":xe.value=!0;break;case"deletePlayer":vr.value=K.playerId,qs.value=!0;break;case"launchSelection":ht.value[K.eventId]&&ht.value[K.eventId].length>0?(C.value=K.eventId,T.value=!0,Ot.value=!1):(await Wo(K.eventId,K.count),Ot.value=!1);break;case"toggleAvailability":$s(K.player,K.eventId);break}}catch(_e){console.error("Erreur lors de l'exécution de l'opération:",_e),H.value=!0,Z.value="Erreur lors de l'opération. Veuillez réessayer.",setTimeout(()=>{H.value=!1},3e3)}}function Jl(){t.push("/")}lf(()=>{const k=b.value;k&&k.removeEventListener("scroll",W),window.removeEventListener("resize",W)});function ea(k){j.value=k,he.value=k.description||"",Ot.value=!0}function ta(){Ot.value=!1,j.value=null,he.value=""}function Yl(){c.value=j.value.id,u.value=j.value.title,d.value=j.value.date,he.value=j.value.description||"",f.value=j.value.playerCount||6,Ot.value=!1}function Xl(k){B.value=k,U.value=!0}function Zl(){U.value=!1,B.value=null}async function gd({playerId:k,newName:v}){try{await xV(k,v,i.value),await Promise.all([th(i.value),_a(at.value,Ke.value,i.value),ya(i.value)]).then(([K,_e,Ee])=>{if(at.value=K,xt.value=_e,ht.value=Ee,ae(),B.value&&B.value.id===k){const Le=K.find(Pe=>Pe.id===k);Le&&(B.value=Le)}}),H.value=!0,Z.value="Joueur mis à jour avec succès !",setTimeout(()=>{H.value=!1},3e3)}catch(K){console.error("Erreur lors de l'édition du joueur:",K),alert("Erreur lors de l'édition du joueur. Veuillez réessayer.")}}async function ec(){try{await Promise.all([th(i.value),_a(at.value,Ke.value,i.value),ya(i.value)]).then(([k,v,K])=>{if(at.value=k,xt.value=v,ht.value=K,ae(),B.value){const _e=k.find(Ee=>Ee.id===B.value.id);_e&&(B.value=_e)}}),H.value=!0,Z.value="Données mises à jour !",setTimeout(()=>{H.value=!1},3e3)}catch(k){console.error("Erreur lors du rafraîchissement:",k)}}function tc(k){if(!k)return{availability:0,selection:0,ratio:0};const v=Vi(k.name),K=kt(k.name),_e=v===0?0:Math.round(K/v*100);return{availability:v,selection:K,ratio:_e}}function na(k){const v=ht.value[k]||[],K=Ke.value.find(Le=>Le.id===k),_e=(K==null?void 0:K.playerCount)||6,Ee=ir(k);if(v.length>0){const Le=v.some(Fe=>!Jt(Fe,k)),Pe=Ee<_e;if(Le||Pe)return{type:"incomplete",hasUnavailablePlayers:Le,hasInsufficientPlayers:Pe,unavailablePlayers:v.filter(Fe=>!Jt(Fe,k)),availableCount:Ee,requiredCount:_e}}return Ee<_e?{type:"insufficient",availableCount:Ee,requiredCount:_e}:v.length===0?{type:"ready",availableCount:Ee,requiredCount:_e}:{type:"complete",availableCount:Ee,requiredCount:_e}}function br(k){const v=na(k);return v.type==="incomplete"||v.type==="insufficient"}function $n(k){const v=na(k);switch(v.type){case"incomplete":return v.hasUnavailablePlayers?v.unavailablePlayers.length===1?`Sélection incomplète : ${v.unavailablePlayers[0]} n'est plus disponible`:`Sélection incomplète : ${v.unavailablePlayers.length} joueurs ne sont plus disponibles`:`Sélection incomplète : ${v.availableCount} joueurs disponibles pour ${v.requiredCount} requis`;case"insufficient":return`Pas assez de joueurs : ${v.availableCount} disponibles pour ${v.requiredCount} requis`;case"ready":return`Prêt pour la sélection : ${v.availableCount} joueurs disponibles`;case"complete":return`Sélection complète : ${v.availableCount} joueurs disponibles`;default:return""}}async function es({eventId:k,eventData:v,reason:K}){if(!i.value)return;const _e={id:k,...v},Ee=[];for(const Le of at.value){if(!await oi(Le.id,i.value))continue;const Fe=await Bb(Le.id,i.value);if(Fe)try{const je=await z_({seasonId:i.value,playerId:Le.id,eventId:_e.id,action:"yes"}),$t=await z_({seasonId:i.value,playerId:Le.id,eventId:_e.id,action:"no"}),bt=`${je.url}&slug=${encodeURIComponent(r)}`,Ye=`${$t.url}&slug=${encodeURIComponent(r)}`;await BV({toEmail:Fe,playerName:Le.name,eventTitle:_e.title,eventDate:Di(_e.date),yesUrl:bt,noUrl:Ye,reason:K})}catch(je){console.error("Email non envoyé pour",Le.name,(je==null?void 0:je.message)||je),Ee.push(Le.id)}}H.value=!0,Z.value=Ee.length>0?`Emails envoyés (avec ${Ee.length} échec(s))`:"Emails envoyés aux joueurs protégés.",setTimeout(()=>{H.value=!1},3e3)}async function Li(k){await es({eventId:k.id,eventData:k,reason:"manual"})}function nc(k){if(!k)return{};const v={};return at.value.forEach(K=>{v[K.name]=Jt(K.name,k)}),v}function st(k){ce.value=k,se.value=!0}function zs(){se.value=!1,ce.value=null}async function Gs(){if(!ce.value)return;const k=ce.value.id,v=ce.value.playerCount||6;if(ir(k)===0){H.value=!0,Z.value="Aucun joueur disponible pour cet événement",setTimeout(()=>{H.value=!1},3e3);return}await Xr({type:"launchSelection",data:{eventId:k,count:v}})}function Ks(){zs(),H.value=!0,Z.value="Sélection validée !",setTimeout(()=>{H.value=!1},3e3)}return(k,v)=>{var K,_e,Ee,Le,Pe,Fe,je,$t,bt,Ye;return Q(),X(zt,null,[m("div",OO,[m("div",MO,[m("button",{onClick:Jl,class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Retour à l'accueil"},v[31]||(v[31]=[m("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),m("h1",LO,pe(s.value?s.value:"Chargement..."),1),v[32]||(v[32]=m("p",{class:"text-gray-300"},"Gestion des sélections et disponibilités",-1))]),m("div",FO,[m("div",{ref_key:"gridboardRef",ref:b,class:"gridboard relative overflow-x-auto bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-sm border border-white/20 rounded-2xl"},[m("table",UO,[m("colgroup",null,[v[33]||(v[33]=m("col",{class:"col-left"},null,-1)),(Q(!0),X(zt,null,gs(Ke.value,(re,He)=>(Q(),X("col",{key:"c"+He,class:"col-event"}))),128)),v[34]||(v[34]=m("col",{class:"col-right"},null,-1))]),m("thead",null,[m("tr",BO,[m("th",$O,[m("div",jO,[v[36]||(v[36]=m("span",{class:"font-bold text-lg relative group"},[m("span",{class:"border-b-2 border-dashed border-purple-400"}," Joueurs ")],-1)),m("button",{onClick:v[0]||(v[0]=re=>g.value=!0),class:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 cursor-pointer text-sm font-medium",title:"Ajouter un nouveau joueur"},v[35]||(v[35]=[m("span",{class:"text-lg"},"➕",-1),m("span",null,"S'ajouter",-1)]))])]),(Q(!0),X(zt,null,gs(Ke.value,re=>(Q(),X("th",{key:re.id,class:"p-3 text-center align-top cursor-pointer sticky top-0 bg-gray-900",onClick:He=>ea(re)},[m("div",zO,[m("div",{class:"header-date text-[16px] md:text-base text-gray-300",title:Di(re.date)},pe(js(re.date)),9,GO),m("div",{class:"header-title text-[22px] md:text-2xl leading-snug text-white text-center clamp-2",title:re.title},pe(re.title||"Sans titre"),9,KO),br(re.id)?(Q(),X("div",{key:0,class:"mt-1 w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center hover:bg-yellow-400 transition-colors duration-200",title:$n(re.id)+" - Cliquez pour ouvrir la sélection",onClick:Yn(He=>st(re),["stop"])},v[37]||(v[37]=[m("span",{class:"text-xs text-white font-bold"},"⚠️",-1)]),8,HO)):na(re.id).type==="ready"?(Q(),X("div",{key:1,class:"mt-1 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center hover:bg-green-400 transition-colors duration-200",title:$n(re.id)+" - Cliquez pour ouvrir la sélection",onClick:Yn(He=>st(re),["stop"])},v[38]||(v[38]=[m("span",{class:"text-xs text-white font-bold"},"🎲",-1)]),8,WO)):Ae("",!0)])],8,qO))),128)),m("th",{class:"p-3 text-center align-top sticky top-0 bg-gray-900"},[m("button",{onClick:Qt,class:"text-3xl sm:text-2xl text-purple-400 hover:text-pink-400 hover:scale-110 transition-all duration-200",title:"Ajouter un nouvel événement"}," ✨ ")])])]),m("tbody",null,[(Q(!0),X(zt,null,gs(at.value,re=>(Q(),X("tr",{key:re.id,class:Zn(["border-b border-white/10 hover:bg-white/5 transition-all duration-200",{"highlighted-player":re.id===D.value}]),"data-player-id":re.id},[m("td",JO,[m("div",YO,[ee(re.id)?(Q(),X("span",XO," 🔒 ")):Ae("",!0),m("span",{onClick:He=>Xl(re),class:"player-name hover:border-b-2 hover:border-dashed hover:border-purple-400 cursor-pointer transition-colors duration-200 text-[22px] md:text-2xl leading-tight",title:"Cliquez pour voir les détails : "+re.name},pe(re.name),9,ZO)])]),(Q(!0),X(zt,null,gs(Ke.value,He=>(Q(),X("td",{key:He.id,class:"p-3 md:p-5 text-center cursor-pointer hover:bg-white/10 transition-all duration-200 min-h-20",onClick:Qn=>Ko(re.name,He.id)},[m("div",t2,[Ho(re.name,He.id)?(Q(),X("span",{key:0,class:"text-2xl md:text-3xl hover:scale-110 transition-transform duration-200",title:Ni(re,He.id)}," 🎭 ",8,n2)):Jt(re.name,He.id)?(Q(),X("span",{key:1,class:"text-2xl md:text-3xl hover:scale-110 transition-transform duration-200",title:Ni(re,He.id)}," ✅ ",8,r2)):Jt(re.name,He.id)===!1?(Q(),X("span",{key:2,class:"text-2xl md:text-3xl hover:scale-110 transition-transform duration-200",title:Ni(re,He.id)}," ❌ ",8,s2)):(Q(),X("span",{key:3,class:"text-gray-500 hover:text-white transition-colors duration-200 text-xl",title:Ni(re,He.id)}," – ",8,i2))])],8,e2))),128)),v[39]||(v[39]=m("td",{class:"p-3 md:p-4"},null,-1))],10,QO))),128))])])],512),gt(m("div",o2,v[40]||(v[40]=[m("div",{class:"h-[80%] w-6 bg-gradient-to-r from-black/40 to-transparent rounded-r-lg"},null,-1),m("div",{class:"absolute text-white/80"},"‹",-1)]),512),[[Tm,P.value]]),gt(m("div",a2,v[41]||(v[41]=[m("div",{class:"h-[80%] w-6 bg-gradient-to-l from-black/40 to-transparent rounded-l-lg"},null,-1),m("div",{class:"absolute text-white/80"},"›",-1)]),512),[[Tm,M.value]])])]),H.value?(Q(),X("div",l2,[m("div",c2,[v[42]||(v[42]=m("span",{class:"text-xl"},"✨",-1)),m("span",null,pe(Z.value),1)])])):Ae("",!0),xe.value?(Q(),X("div",u2,[m("div",d2,[v[47]||(v[47]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvel événement",-1)),m("div",h2,[v[43]||(v[43]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),gt(m("input",{"onUpdate:modelValue":v[1]||(v[1]=re=>Me.value=re),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Titre de l'événement"},null,512),[[Pt,Me.value]])]),m("div",f2,[v[44]||(v[44]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),gt(m("input",{"onUpdate:modelValue":v[2]||(v[2]=re=>wt.value=re),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white"},null,512),[[Pt,wt.value]])]),m("div",p2,[v[45]||(v[45]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),gt(m("textarea",{"onUpdate:modelValue":v[3]||(v[3]=re=>mt.value=re),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)"},null,512),[[Pt,mt.value]])]),m("div",m2,[v[46]||(v[46]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),gt(m("input",{"onUpdate:modelValue":v[4]||(v[4]=re=>Wt.value=re),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",placeholder:"6"},null,512),[[Pt,Wt.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Bs,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:Mt,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Créer ")])])])):Ae("",!0),g.value?(Q(),X("div",g2,[m("div",_2,[v[49]||(v[49]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouveau joueur",-1)),m("div",y2,[v[48]||(v[48]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),gt(m("input",{"onUpdate:modelValue":v[5]||(v[5]=re=>_.value=re),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nom du joueur"},null,512),[[Pt,_.value]])]),m("div",v2,[m("button",{onClick:v[6]||(v[6]=re=>g.value=!1),class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:Te,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ajouter ")])])])):Ae("",!0),o.value?(Q(),X("div",w2,[m("div",b2,[v[50]||(v[50]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer cet événement ?</p></div>',1)),m("div",I2,[m("button",{onClick:ue,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:v[7]||(v[7]=()=>be()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):Ae("",!0),qs.value?(Q(),X("div",E2,[m("div",T2,[v[51]||(v[51]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer ce joueur ?</p></div>',1)),m("div",A2,[m("button",{onClick:Oi,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),m("button",{onClick:v[8]||(v[8]=()=>Qo()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"Supprimer")])])])):Ae("",!0),T.value?(Q(),X("div",x2,[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},[v[52]||(v[52]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🎭</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Attention, toute la sélection sera refaite en fonction des disponibilités actuelles.</p></div><p class="mb-6 text-sm text-yellow-400 bg-yellow-900/20 p-3 rounded-lg border border-yellow-500/20"> ⚠️ Pensez à prévenir les gens du changement ! </p>',2)),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Kl,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),m("button",{onClick:Gl,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"},"Confirmer")])])])):Ae("",!0),Ot.value?(Q(),X("div",{key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[80] p-4",onClick:ta},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-2xl",onClick:v[12]||(v[12]=Yn(()=>{},["stop"]))},[m("div",P2,[v[53]||(v[53]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"🎭")],-1)),m("h2",S2,pe((K=j.value)==null?void 0:K.title),1),m("p",R2,pe(Di((_e=j.value)==null?void 0:_e.date)),1)]),(Ee=j.value)!=null&&Ee.description?(Q(),X("div",C2,[v[54]||(v[54]=m("h3",{class:"text-lg font-semibold text-white mb-3"},"Description",-1)),m("p",k2,pe(j.value.description),1)])):Ae("",!0),m("div",D2,[v[58]||(v[58]=m("h3",{class:"text-lg font-semibold text-white mb-3"},"Statistiques",-1)),m("div",V2,[m("div",N2,[m("div",O2,pe(ir((Le=j.value)==null?void 0:Le.id)),1),v[55]||(v[55]=m("div",{class:"text-sm text-gray-300"},"Disponibles",-1))]),m("div",M2,[m("div",L2,pe(Yr((Pe=j.value)==null?void 0:Pe.id)),1),v[56]||(v[56]=m("div",{class:"text-sm text-gray-300"},"Sélectionnés",-1))]),m("div",F2,[m("div",U2,pe(((Fe=j.value)==null?void 0:Fe.playerCount)||6),1),v[57]||(v[57]=m("div",{class:"text-sm text-gray-300"},"À sélectionner",-1))])])]),m("div",B2,[m("button",{onClick:Yl,class:"px-4 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center space-x-2"},v[59]||(v[59]=[m("span",null,"✏️",-1),m("span",null,"Modifier",-1)])),m("button",{onClick:v[9]||(v[9]=re=>Li(j.value)),class:"px-4 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-lg hover:from-amber-600 hover:to-orange-700 transition-all duration-300 flex items-center space-x-2",title:"Envoyer un email aux joueurs protégés pour indiquer leur disponibilité"},v[60]||(v[60]=[m("span",null,"📧",-1),m("span",null,"Relancer",-1)])),m("button",{onClick:v[10]||(v[10]=re=>st(j.value)),class:"px-4 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center space-x-2",title:"Gérer la sélection"},v[61]||(v[61]=[m("span",null,"🎭",-1),m("span",null,"Sélection",-1)])),m("button",{onClick:v[11]||(v[11]=re=>{var He;return te((He=j.value)==null?void 0:He.id)}),class:"px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center space-x-2"},v[62]||(v[62]=[m("span",null,"🗑️",-1),m("span",null,"Supprimer",-1)]))])])])):Ae("",!0),c.value?(Q(),X("div",$2,[m("div",j2,[v[67]||(v[67]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Modifier l'événement",-1)),m("div",q2,[v[63]||(v[63]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),gt(m("input",{"onUpdate:modelValue":v[13]||(v[13]=re=>u.value=re),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[An(Ie,["esc"]),An(me,["enter"])],ref:"editTitleInput"},null,544),[[Pt,u.value]])]),m("div",z2,[v[64]||(v[64]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),gt(m("input",{"onUpdate:modelValue":v[14]||(v[14]=re=>d.value=re),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:[An(Ie,["esc"]),An(me,["enter"])]},null,544),[[Pt,d.value]])]),m("div",G2,[v[65]||(v[65]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),gt(m("textarea",{"onUpdate:modelValue":v[15]||(v[15]=re=>he.value=re),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)",onKeydown:An(Ie,["esc"])},null,544),[[Pt,he.value]])]),m("div",K2,[v[66]||(v[66]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),gt(m("input",{"onUpdate:modelValue":v[16]||(v[16]=re=>f.value=re),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:An(Ie,["esc"])},null,544),[[Pt,f.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Ie,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:me,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):Ae("",!0),Gt(Fb,{show:L.value,message:Jo(),error:q.value,"session-info":Ql(),onSubmit:pd,onCancel:Mi},null,8,["show","message","error","session-info"]),ie.value?(Q(),X("div",H2,[m("div",W2,[v[69]||(v[69]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-2">Vérification requise</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protégé par mot de passe</p></div>',1)),m("div",Q2,[m("div",J2,[m("div",null,[v[68]||(v[68]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),gt(m("input",{"onUpdate:modelValue":v[17]||(v[17]=re=>A.value=re),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:v[18]||(v[18]=An(re=>Yo(A.value),["enter"])),ref_key:"playerPasswordInputRef",ref:w},null,544),[[Pt,A.value]])])]),m("button",{onClick:v[19]||(v[19]=re=>Yo(A.value)),disabled:!A.value||R.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[R.value?(Q(),X("span",X2,"⏳")):(Q(),X("span",Z2,"🔓")),m("span",null,pe(R.value?"Vérification...":"Vérifier et supprimer"),1)],8,Y2)]),m("div",eM,[m("button",{onClick:v[20]||(v[20]=re=>ot.value=!0),class:"text-sm text-red-400 hover:text-red-300 transition-colors underline"}," Mot de passe oublié ? ")]),E.value?(Q(),X("div",tM,[m("div",nM,pe(E.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:Xo,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):Ae("",!0),S.value?(Q(),X("div",rM,[m("div",sM,[v[71]||(v[71]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-2">Vérification requise</h2><p class="text-lg text-gray-300">Modification de disponibilité</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protégé par mot de passe</p></div>',1)),m("div",iM,[m("div",oM,[m("div",null,[v[70]||(v[70]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),gt(m("input",{"onUpdate:modelValue":v[21]||(v[21]=re=>nt.value=re),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:v[22]||(v[22]=An(re=>Zr(nt.value),["enter"])),ref_key:"availabilityPasswordInputRef",ref:$e},null,544),[[Pt,nt.value]])])]),m("button",{onClick:v[23]||(v[23]=re=>Zr(nt.value)),disabled:!nt.value||Ue.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Ue.value?(Q(),X("span",lM,"⏳")):(Q(),X("span",cM,"🔓")),m("span",null,pe(Ue.value?"Vérification...":"Vérifier et modifier"),1)],8,aM)]),m("div",uM,[m("button",{onClick:v[24]||(v[24]=re=>Oe.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),Ne.value?(Q(),X("div",dM,[m("div",hM,pe(Ne.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:wr,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):Ae("",!0),Oe.value?(Q(),X("div",{key:10,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:v[27]||(v[27]=re=>Oe.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:v[26]||(v[26]=Yn(()=>{},["stop"]))},[v[73]||(v[73]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Modification de disponibilité</p></div>',1)),m("div",fM,[v[72]||(v[72]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),m("button",{onClick:Zo,disabled:Ht.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Ht.value?(Q(),X("span",mM,"⏳")):(Q(),X("span",gM,"📧")),m("span",null,pe(Ht.value?"Envoi...":"Envoyer l'email"),1)],8,pM)]),hn.value?(Q(),X("div",_M,[m("div",yM,pe(hn.value),1)])):Ae("",!0),on.value?(Q(),X("div",vM,[m("div",wM,pe(on.value),1)])):Ae("",!0),m("div",bM,[m("button",{onClick:v[25]||(v[25]=re=>Oe.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0),ot.value?(Q(),X("div",{key:11,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:v[30]||(v[30]=re=>ot.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:v[29]||(v[29]=Yn(()=>{},["stop"]))},[v[75]||(v[75]=is('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p></div>',1)),m("div",IM,[v[74]||(v[74]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),m("button",{onClick:md,disabled:rt.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[rt.value?(Q(),X("span",TM,"⏳")):(Q(),X("span",AM,"📧")),m("span",null,pe(rt.value?"Envoi...":"Envoyer l'email"),1)],8,EM)]),On.value?(Q(),X("div",xM,[m("div",PM,pe(On.value),1)])):Ae("",!0),En.value?(Q(),X("div",SM,[m("div",RM,pe(En.value),1)])):Ae("",!0),m("div",CM,[m("button",{onClick:v[28]||(v[28]=re=>ot.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0),Gt(WN,{show:U.value,player:B.value,stats:tc(B.value),seasonId:i.value,onClose:Zl,onUpdate:gd,onDelete:or,onRefresh:ec},null,8,["show","player","stats","seasonId"]),Gt(NO,{ref_key:"selectionModalRef",ref:De,show:se.value,event:ce.value,"current-selection":ht.value[(je=ce.value)==null?void 0:je.id]||[],"available-count":ir(($t=ce.value)==null?void 0:$t.id),"selected-count":Yr((bt=ce.value)==null?void 0:bt.id),"player-availability":nc((Ye=ce.value)==null?void 0:Ye.id),onClose:zs,onSelection:Gs,onPerfect:Ks},null,8,["show","event","current-selection","available-count","selected-count","player-availability"])],64)}}},DM={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},VM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},NM={key:0,class:"text-center py-8"},OM={key:1,class:"text-center py-8"},MM={class:"text-gray-300 mb-6"},LM={key:2,class:"space-y-6"},FM={class:"text-center"},UM={class:"text-gray-300"},BM={class:"font-semibold text-white"},$M={class:"space-y-4"},jM=["disabled"],qM={key:0,class:"animate-spin"},zM={key:1},GM={key:0,class:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},KM={class:"text-red-300 text-sm"},HM={key:1,class:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},WM={class:"text-green-300 text-sm"},QM={__name:"PasswordReset",setup(n){const e=lv(),t=Du(),r=G(!0),s=G(""),i=G(""),o=G(""),a=G(""),c=G(""),u=G(!1),d=G(""),f=G(""),g=tn(()=>a.value&&c.value&&a.value===c.value&&a.value.length>=6);_l(async()=>{try{const{oobCode:T}=e.query;if(console.log("🔍 [DEBUG] Token reçu:",T),!T){s.value="Lien de réinitialisation incomplet",r.value=!1;return}o.value=T,i.value="patrice.lamarque+ron@gmail.com",r.value=!1}catch(T){console.error("Erreur lors de la vérification du lien:",T),s.value="Erreur lors de la vérification du lien",r.value=!1}});async function _(){if(g.value){u.value=!0,d.value="",f.value="";try{console.log("🔍 [DEBUG] Début réinitialisation avec token:",o.value),await F1(Ci,o.value,a.value),console.log("🔍 [DEBUG] Mot de passe Firebase Auth mis à jour"),console.log("🔍 [DEBUG] Réinitialisation terminée avec Firebase Auth"),f.value="Mot de passe réinitialisé avec succès ! Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.",setTimeout(()=>{D()},3e3)}catch(T){console.error("❌ [ERROR] Erreur lors de la réinitialisation:",T),T.code==="auth/weak-password"?d.value="Le mot de passe doit contenir au moins 6 caractères":T.code==="auth/invalid-action-code"?d.value="Lien de réinitialisation invalide ou expiré":d.value="Erreur lors de la réinitialisation. Veuillez réessayer."}finally{u.value=!1}}}function D(){t.push("/")}return(T,C)=>(Q(),X("div",DM,[m("div",VM,[C[8]||(C[8]=is('<div class="text-center mb-6"><div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-3xl">🔑</span></div><h1 class="text-3xl font-bold text-white mb-2">Réinitialisation</h1><p class="text-lg text-gray-300">Nouveau mot de passe</p></div>',1)),r.value?(Q(),X("div",NM,C[2]||(C[2]=[m("div",{class:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),m("p",{class:"text-gray-300"},"Vérification du lien...",-1)]))):s.value?(Q(),X("div",OM,[C[3]||(C[3]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"❌")],-1)),C[4]||(C[4]=m("h2",{class:"text-xl font-bold text-white mb-2"},"Lien invalide",-1)),m("p",MM,pe(s.value),1),m("button",{onClick:D,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300"}," Retour à l'accueil ")])):i.value?(Q(),X("div",LM,[m("div",FM,[m("p",UM,[C[5]||(C[5]=xr("Email : ")),m("span",BM,pe(i.value),1)])]),m("div",$M,[m("div",null,[C[6]||(C[6]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nouveau mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":C[0]||(C[0]=U=>a.value=U),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nouveau mot de passe",onKeydown:An(_,["enter"])},null,544),[[Pt,a.value]])]),m("div",null,[C[7]||(C[7]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":C[1]||(C[1]=U=>c.value=U),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe",onKeydown:An(_,["enter"])},null,544),[[Pt,c.value]])])]),m("button",{onClick:_,disabled:!g.value||u.value,class:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[u.value?(Q(),X("span",qM,"⏳")):(Q(),X("span",zM,"🔑")),m("span",null,pe(u.value?"Réinitialisation...":"Réinitialiser le mot de passe"),1)],8,jM),d.value?(Q(),X("div",GM,[m("div",KM,pe(d.value),1)])):Ae("",!0),f.value?(Q(),X("div",HM,[m("div",WM,pe(f.value),1)])):Ae("",!0)])):Ae("",!0)])]))}},JM={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},YM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center"},XM={class:"text-3xl"},ZM={class:"text-2xl font-bold text-white mb-2"},eL={class:"text-gray-300 mb-6"},tL={__name:"MagicLink",setup(n){const e=lv(),t=Du(),r=G("loading"),s=G("Traitement en cours..."),i=G("Merci de patienter pendant la validation du lien."),o=tn(()=>r.value==="loading"?"⏳":r.value==="ok"?"✅":"❌");function a(){const c=e.query.slug;c?t.push(`/season/${c}`):t.push("/")}return _l(async()=>{try{const c=String(e.query.sid||""),u=String(e.query.pid||""),d=String(e.query.eid||""),f=String(e.query.t||""),g=String(e.query.a||""),_=String(e.query.slug||"");if(!c||!u||!d||!f||!g){r.value="error",s.value="Lien invalide",i.value="Paramètres manquants.";return}if(!(await FV({seasonId:c,playerId:u,eventId:d,token:f,action:g})).valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expiré.";return}const T=ke(ye,"seasons",c,"players",u),C=await Pi(T),U=C.exists()&&C.data().name||"";if(!U){r.value="error",s.value="Lien invalide",i.value="Joueur introuvable.";return}await PV({seasonId:c,playerName:U,eventId:d,value:g==="yes"}),await UV({seasonId:c,playerId:u,eventId:d}),r.value="ok",s.value="Merci !",i.value=g==="yes"?"Votre disponibilité a été enregistrée: Disponible.":"Votre disponibilité a été enregistrée: Non disponible.",setTimeout(()=>a(),2e3)}catch(c){console.error("Magic link error:",c),r.value="error",s.value="Erreur",i.value="Impossible de traiter votre lien."}}),(c,u)=>(Q(),X("div",JM,[m("div",YM,[m("div",{class:Zn(["w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center",r.value==="ok"?"bg-green-500":r.value==="loading"?"bg-blue-500":"bg-red-500"])},[m("span",XM,pe(o.value),1)],2),m("h1",ZM,pe(s.value),1),m("p",eL,pe(i.value),1),m("button",{onClick:a,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ouvrir la saison ")])]))}},nL=[{path:"/",component:wV},{path:"/season/:slug",component:kM,props:!0},{path:"/reset-password",component:QM},{path:"/magic",component:tL}],rL=fA({history:jT("/impro-selector/"),routes:nL});lT(dT).use(rL).mount("#app");export{tt as $,jw as A,wi as B,mr as C,Bt as D,uF as E,Ei as F,sp as G,cF as H,lL as I,Kn as J,nC as K,sC as L,qw as M,OL as N,ML as O,SC as P,dn as Q,xL as R,fL as S,Rt as T,tF as U,Qu as V,xC as W,eF as X,NL as Y,_L as Z,kv as _,il as a,Fl as a$,dL as a0,rC as a1,mC as a2,lF as a3,ll as a4,ZL as a5,wL as a6,aF as a7,ke as a8,TL as a9,EL as aA,qL as aB,zL as aC,AL as aD,fC as aE,QL as aF,JL as aG,TC as aH,Fw as aI,Pw as aJ,hL as aK,XL as aL,mp as aM,Pn as aN,sF as aO,sL as aP,LL as aQ,CL as aR,RL as aS,VL as aT,bL as aU,jL as aV,rF as aW,yL as aX,hC as aY,zw as aZ,gF as a_,mL as aa,gL as ab,vL as ac,oF as ad,DL as ae,kL as af,Ct as ag,Nl as ah,_C as ai,GL as aj,Pi as ak,FL as al,UL as am,St as an,BL as ao,$L as ap,iC as aq,iF as ar,nF as as,pL as at,PL as au,SL as av,IL as aw,KL as ax,WL as ay,HL as az,oC as b,V1 as b$,Ll as b0,yF as b1,hl as b2,Si as b3,hs as b4,hF as b5,ps as b6,fs as b7,$r as b8,Uc as b9,$C as bA,qF as bB,nU as bC,x_ as bD,_k as bE,l1 as bF,OF as bG,xF as bH,N1 as bI,HF as bJ,XF as bK,tU as bL,zF as bM,LF as bN,J1 as bO,wF as bP,CC as bQ,O1 as bR,WF as bS,YF as bT,eU as bU,zC as bV,$F as bW,RF as bX,L1 as bY,AF as bZ,NF as b_,mF as ba,ui as bb,co as bc,wD as bd,fF as be,GF as bf,qh as bg,pF as bh,bD as bi,Mp as bj,ms as bk,EF as bl,Y1 as bm,ik as bn,vD as bo,Ab as bp,U1 as bq,F1 as br,u1 as bs,B1 as bt,_F as bu,jF as bv,SF as bw,VF as bx,SD as by,vF as bz,Co as c,Ap as c0,IF as c1,$1 as c2,PF as c3,KF as c4,JF as c5,ZF as c6,BF as c7,bF as c8,UF as c9,DF as ca,z1 as cb,QF as cc,kF as cd,FF as ce,MF as cf,CF as cg,TF as ch,Ti as d,dt as e,Y as f,qo as g,Dl as h,Mc as i,nd as j,Vl as k,ed as l,fp as m,ko as n,td as o,si as p,PC as q,Vt as r,hi as s,de as t,oL as u,Qx as v,Et as w,dF as x,Be as y,iL as z};
