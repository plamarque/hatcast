(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function qp(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Pt={},ba=[],Or=()=>{},ax=()=>!1,eh=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),zp=n=>n.startsWith("onUpdate:"),Tn=Object.assign,Kp=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},lx=Object.prototype.hasOwnProperty,_t=(n,e)=>lx.call(n,e),Ue=Array.isArray,wa=n=>zu(n)==="[object Map]",Xa=n=>zu(n)==="[object Set]",ov=n=>zu(n)==="[object Date]",Qe=n=>typeof n=="function",ln=n=>typeof n=="string",ns=n=>typeof n=="symbol",Vt=n=>n!==null&&typeof n=="object",c0=n=>(Vt(n)||Qe(n))&&Qe(n.then)&&Qe(n.catch),d0=Object.prototype.toString,zu=n=>d0.call(n),ux=n=>zu(n).slice(8,-1),h0=n=>zu(n)==="[object Object]",Gp=n=>ln(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Zl=qp(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),th=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},cx=/-(\w)/g,Tr=th(n=>n.replace(cx,(e,t)=>t?t.toUpperCase():"")),dx=/\B([A-Z])/g,Oi=th(n=>n.replace(dx,"-$1").toLowerCase()),nh=th(n=>n.charAt(0).toUpperCase()+n.slice(1)),uf=th(n=>n?`on${nh(n)}`:""),_i=(n,e)=>!Object.is(n,e),Zc=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Gf=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},bd=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let av;const rh=()=>av||(av=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ys(n){if(Ue(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=ln(r)?mx(r):ys(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(ln(n)||Vt(n))return n}const hx=/;(?![^(]*\))/g,fx=/:([^]+)/,px=/\/\*[^]*?\*\//g;function mx(n){const e={};return n.replace(px,"").split(hx).forEach(t=>{if(t){const r=t.split(fx);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Tt(n){let e="";if(ln(n))e=n;else if(Ue(n))for(let t=0;t<n.length;t++){const r=Tt(n[t]);r&&(e+=r+" ")}else if(Vt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const gx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vx=qp(gx);function f0(n){return!!n||n===""}function yx(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=Ku(n[r],e[r]);return t}function Ku(n,e){if(n===e)return!0;let t=ov(n),r=ov(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=ns(n),r=ns(e),t||r)return n===e;if(t=Ue(n),r=Ue(e),t||r)return t&&r?yx(n,e):!1;if(t=Vt(n),r=Vt(e),t||r){if(!t||!r)return!1;const s=Object.keys(n).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Ku(n[o],e[o]))return!1}}return String(n)===String(e)}function Hp(n,e){return n.findIndex(t=>Ku(t,e))}const p0=n=>!!(n&&n.__v_isRef===!0),le=n=>ln(n)?n:n==null?"":Ue(n)||Vt(n)&&(n.toString===d0||!Qe(n.toString))?p0(n)?le(n.value):JSON.stringify(n,m0,2):String(n),m0=(n,e)=>p0(e)?m0(n,e.value):wa(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[cf(r,i)+" =>"]=s,t),{})}:Xa(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>cf(t))}:ns(e)?cf(e):Vt(e)&&!Ue(e)&&!h0(e)?String(e):e,cf=(n,e="")=>{var t;return ns(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let sr;class _x{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=sr,!e&&sr&&(this.index=(sr.scopes||(sr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=sr;try{return sr=this,e()}finally{sr=t}}}on(){++this._on===1&&(this.prevScope=sr,sr=this)}off(){this._on>0&&--this._on===0&&(sr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function bx(){return sr}let Ct;const df=new WeakSet;class g0{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,sr&&sr.active&&sr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,df.has(this)&&(df.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||y0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,lv(this),_0(this);const e=Ct,t=Mr;Ct=this,Mr=!0;try{return this.fn()}finally{b0(this),Ct=e,Mr=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Jp(e);this.deps=this.depsTail=void 0,lv(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?df.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Hf(this)&&this.run()}get dirty(){return Hf(this)}}let v0=0,eu,tu;function y0(n,e=!1){if(n.flags|=8,e){n.next=tu,tu=n;return}n.next=eu,eu=n}function Wp(){v0++}function Qp(){if(--v0>0)return;if(tu){let e=tu;for(tu=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;eu;){let e=eu;for(eu=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function _0(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function b0(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),Jp(r),wx(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function Hf(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(w0(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function w0(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===mu)||(n.globalVersion=mu,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Hf(n))))return;n.flags|=2;const e=n.dep,t=Ct,r=Mr;Ct=n,Mr=!0;try{_0(n);const s=n.fn(n._value);(e.version===0||_i(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{Ct=t,Mr=r,b0(n),n.flags&=-3}}function Jp(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Jp(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function wx(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let Mr=!0;const I0=[];function Ps(){I0.push(Mr),Mr=!1}function Rs(){const n=I0.pop();Mr=n===void 0?!0:n}function lv(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Ct;Ct=void 0;try{e()}finally{Ct=t}}}let mu=0;class Ix{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Yp{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ct||!Mr||Ct===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Ct)t=this.activeLink=new Ix(Ct,this),Ct.deps?(t.prevDep=Ct.depsTail,Ct.depsTail.nextDep=t,Ct.depsTail=t):Ct.deps=Ct.depsTail=t,E0(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Ct.depsTail,t.nextDep=void 0,Ct.depsTail.nextDep=t,Ct.depsTail=t,Ct.deps===t&&(Ct.deps=r)}return t}trigger(e){this.version++,mu++,this.notify(e)}notify(e){Wp();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Qp()}}}function E0(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)E0(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Wf=new WeakMap,bo=Symbol(""),Qf=Symbol(""),gu=Symbol("");function Fn(n,e,t){if(Mr&&Ct){let r=Wf.get(n);r||Wf.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new Yp),s.map=r,s.key=t),s.track()}}function _s(n,e,t,r,s,i){const o=Wf.get(n);if(!o){mu++;return}const a=l=>{l&&l.trigger()};if(Wp(),e==="clear")o.forEach(a);else{const l=Ue(n),c=l&&Gp(t);if(l&&t==="length"){const d=Number(r);o.forEach((f,g)=>{(g==="length"||g===gu||!ns(g)&&g>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(gu)),e){case"add":l?c&&a(o.get("length")):(a(o.get(bo)),wa(n)&&a(o.get(Qf)));break;case"delete":l||(a(o.get(bo)),wa(n)&&a(o.get(Qf)));break;case"set":wa(n)&&a(o.get(bo));break}}Qp()}function la(n){const e=yt(n);return e===n?e:(Fn(e,"iterate",gu),Ir(n)?e:e.map(Sn))}function sh(n){return Fn(n=yt(n),"iterate",gu),n}const Ex={__proto__:null,[Symbol.iterator](){return hf(this,Symbol.iterator,Sn)},concat(...n){return la(this).concat(...n.map(e=>Ue(e)?la(e):e))},entries(){return hf(this,"entries",n=>(n[1]=Sn(n[1]),n))},every(n,e){return ps(this,"every",n,e,void 0,arguments)},filter(n,e){return ps(this,"filter",n,e,t=>t.map(Sn),arguments)},find(n,e){return ps(this,"find",n,e,Sn,arguments)},findIndex(n,e){return ps(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return ps(this,"findLast",n,e,Sn,arguments)},findLastIndex(n,e){return ps(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return ps(this,"forEach",n,e,void 0,arguments)},includes(...n){return ff(this,"includes",n)},indexOf(...n){return ff(this,"indexOf",n)},join(n){return la(this).join(n)},lastIndexOf(...n){return ff(this,"lastIndexOf",n)},map(n,e){return ps(this,"map",n,e,void 0,arguments)},pop(){return Vl(this,"pop")},push(...n){return Vl(this,"push",n)},reduce(n,...e){return uv(this,"reduce",n,e)},reduceRight(n,...e){return uv(this,"reduceRight",n,e)},shift(){return Vl(this,"shift")},some(n,e){return ps(this,"some",n,e,void 0,arguments)},splice(...n){return Vl(this,"splice",n)},toReversed(){return la(this).toReversed()},toSorted(n){return la(this).toSorted(n)},toSpliced(...n){return la(this).toSpliced(...n)},unshift(...n){return Vl(this,"unshift",n)},values(){return hf(this,"values",Sn)}};function hf(n,e,t){const r=sh(n),s=r[e]();return r!==n&&!Ir(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const Tx=Array.prototype;function ps(n,e,t,r,s,i){const o=sh(n),a=o!==n&&!Ir(n),l=o[e];if(l!==Tx[e]){const f=l.apply(n,i);return a?Sn(f):f}let c=t;o!==n&&(a?c=function(f,g){return t.call(this,Sn(f),g,n)}:t.length>2&&(c=function(f,g){return t.call(this,f,g,n)}));const d=l.call(o,c,r);return a&&s?s(d):d}function uv(n,e,t,r){const s=sh(n);let i=t;return s!==n&&(Ir(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,Sn(a),l,n)}),s[e](i,...r)}function ff(n,e,t){const r=yt(n);Fn(r,"iterate",gu);const s=r[e](...t);return(s===-1||s===!1)&&em(t[0])?(t[0]=yt(t[0]),r[e](...t)):s}function Vl(n,e,t=[]){Ps(),Wp();const r=yt(n)[e].apply(n,t);return Qp(),Rs(),r}const xx=qp("__proto__,__v_isRef,__isVue"),T0=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(ns));function Ax(n){ns(n)||(n=String(n));const e=yt(this);return Fn(e,"has",n),e.hasOwnProperty(n)}class x0{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?Mx:R0:i?P0:S0).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Ue(e);if(!s){let l;if(o&&(l=Ex[t]))return l;if(t==="hasOwnProperty")return Ax}const a=Reflect.get(e,t,Un(e)?e:r);return(ns(t)?T0.has(t):xx(t))||(s||Fn(e,"get",t),i)?a:Un(a)?o&&Gp(t)?a:a.value:Vt(a)?s?k0(a):ih(a):a}}class A0 extends x0{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=Ti(i);if(!Ir(r)&&!Ti(r)&&(i=yt(i),r=yt(r)),!Ue(e)&&Un(i)&&!Un(r))return l?!1:(i.value=r,!0)}const o=Ue(e)&&Gp(t)?Number(t)<e.length:_t(e,t),a=Reflect.set(e,t,r,Un(e)?e:s);return e===yt(s)&&(o?_i(r,i)&&_s(e,"set",t,r):_s(e,"add",t,r)),a}deleteProperty(e,t){const r=_t(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&_s(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!ns(t)||!T0.has(t))&&Fn(e,"has",t),r}ownKeys(e){return Fn(e,"iterate",Ue(e)?"length":bo),Reflect.ownKeys(e)}}class Sx extends x0{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Px=new A0,Rx=new Sx,Cx=new A0(!0);const Jf=n=>n,$c=n=>Reflect.getPrototypeOf(n);function kx(n,e,t){return function(...r){const s=this.__v_raw,i=yt(s),o=wa(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),d=t?Jf:e?wd:Sn;return!e&&Fn(i,"iterate",l?Qf:bo),{next(){const{value:f,done:g}=c.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function Uc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function Dx(n,e){const t={get(s){const i=this.__v_raw,o=yt(i),a=yt(s);n||(_i(s,a)&&Fn(o,"get",s),Fn(o,"get",a));const{has:l}=$c(o),c=e?Jf:n?wd:Sn;if(l.call(o,s))return c(i.get(s));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&Fn(yt(s),"iterate",bo),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=yt(i),a=yt(s);return n||(_i(s,a)&&Fn(o,"has",s),Fn(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=yt(a),c=e?Jf:n?wd:Sn;return!n&&Fn(l,"iterate",bo),a.forEach((d,f)=>s.call(i,c(d),c(f),o))}};return Tn(t,n?{add:Uc("add"),set:Uc("set"),delete:Uc("delete"),clear:Uc("clear")}:{add(s){!e&&!Ir(s)&&!Ti(s)&&(s=yt(s));const i=yt(this);return $c(i).has.call(i,s)||(i.add(s),_s(i,"add",s,s)),this},set(s,i){!e&&!Ir(i)&&!Ti(i)&&(i=yt(i));const o=yt(this),{has:a,get:l}=$c(o);let c=a.call(o,s);c||(s=yt(s),c=a.call(o,s));const d=l.call(o,s);return o.set(s,i),c?_i(i,d)&&_s(o,"set",s,i):_s(o,"add",s,i),this},delete(s){const i=yt(this),{has:o,get:a}=$c(i);let l=o.call(i,s);l||(s=yt(s),l=o.call(i,s)),a&&a.call(i,s);const c=i.delete(s);return l&&_s(i,"delete",s,void 0),c},clear(){const s=yt(this),i=s.size!==0,o=s.clear();return i&&_s(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=kx(s,n,e)}),t}function Xp(n,e){const t=Dx(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(_t(t,s)&&s in r?t:r,s,i)}const Nx={get:Xp(!1,!1)},Vx={get:Xp(!1,!0)},Ox={get:Xp(!0,!1)};const S0=new WeakMap,P0=new WeakMap,R0=new WeakMap,Mx=new WeakMap;function Lx(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Fx(n){return n.__v_skip||!Object.isExtensible(n)?0:Lx(ux(n))}function ih(n){return Ti(n)?n:Zp(n,!1,Px,Nx,S0)}function C0(n){return Zp(n,!1,Cx,Vx,P0)}function k0(n){return Zp(n,!0,Rx,Ox,R0)}function Zp(n,e,t,r,s){if(!Vt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=Fx(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function Ia(n){return Ti(n)?Ia(n.__v_raw):!!(n&&n.__v_isReactive)}function Ti(n){return!!(n&&n.__v_isReadonly)}function Ir(n){return!!(n&&n.__v_isShallow)}function em(n){return n?!!n.__v_raw:!1}function yt(n){const e=n&&n.__v_raw;return e?yt(e):n}function $x(n){return!_t(n,"__v_skip")&&Object.isExtensible(n)&&Gf(n,"__v_skip",!0),n}const Sn=n=>Vt(n)?ih(n):n,wd=n=>Vt(n)?k0(n):n;function Un(n){return n?n.__v_isRef===!0:!1}function k(n){return D0(n,!1)}function Ux(n){return D0(n,!0)}function D0(n,e){return Un(n)?n:new jx(n,e)}class jx{constructor(e,t){this.dep=new Yp,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:yt(e),this._value=t?e:Sn(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Ir(e)||Ti(e);e=r?e:yt(e),_i(e,t)&&(this._rawValue=e,this._value=r?e:Sn(e),this.dep.trigger())}}function Xr(n){return Un(n)?n.value:n}const Bx={get:(n,e,t)=>e==="__v_raw"?n:Xr(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return Un(s)&&!Un(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function N0(n){return Ia(n)?n:new Proxy(n,Bx)}class qx{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Yp(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=mu-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Ct!==this)return y0(this,!0),!0}get value(){const e=this.dep.track();return w0(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function zx(n,e,t=!1){let r,s;return Qe(n)?r=n:(r=n.get,s=n.set),new qx(r,s,t)}const jc={},Id=new WeakMap;let ao;function Kx(n,e=!1,t=ao){if(t){let r=Id.get(t);r||Id.set(t,r=[]),r.push(n)}}function Gx(n,e,t=Pt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,c=z=>s?z:Ir(z)||s===!1||s===0?bs(z,1):bs(z);let d,f,g,y,T=!1,A=!1;if(Un(n)?(f=()=>n.value,T=Ir(n)):Ia(n)?(f=()=>c(n),T=!0):Ue(n)?(A=!0,T=n.some(z=>Ia(z)||Ir(z)),f=()=>n.map(z=>{if(Un(z))return z.value;if(Ia(z))return c(z);if(Qe(z))return l?l(z,2):z()})):Qe(n)?e?f=l?()=>l(n,2):n:f=()=>{if(g){Ps();try{g()}finally{Rs()}}const z=ao;ao=d;try{return l?l(n,3,[y]):n(y)}finally{ao=z}}:f=Or,e&&s){const z=f,he=s===!0?1/0:s;f=()=>bs(z(),he)}const P=bx(),U=()=>{d.stop(),P&&P.active&&Kp(P.effects,d)};if(i&&e){const z=e;e=(...he)=>{z(...he),U()}}let q=A?new Array(n.length).fill(jc):jc;const M=z=>{if(!(!(d.flags&1)||!d.dirty&&!z))if(e){const he=d.run();if(s||T||(A?he.some((pe,x)=>_i(pe,q[x])):_i(he,q))){g&&g();const pe=ao;ao=d;try{const x=[he,q===jc?void 0:A&&q[0]===jc?[]:q,y];q=he,l?l(e,3,x):e(...x)}finally{ao=pe}}}else d.run()};return a&&a(M),d=new g0(f),d.scheduler=o?()=>o(M,!1):M,y=z=>Kx(z,!1,d),g=d.onStop=()=>{const z=Id.get(d);if(z){if(l)l(z,4);else for(const he of z)he();Id.delete(d)}},e?r?M(!0):q=d.run():o?o(M.bind(null,!0),!0):d.run(),U.pause=d.pause.bind(d),U.resume=d.resume.bind(d),U.stop=U,U}function bs(n,e=1/0,t){if(e<=0||!Vt(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Un(n))bs(n.value,e,t);else if(Ue(n))for(let r=0;r<n.length;r++)bs(n[r],e,t);else if(Xa(n)||wa(n))n.forEach(r=>{bs(r,e,t)});else if(h0(n)){for(const r in n)bs(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&bs(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Gu(n,e,t,r){try{return r?n(...r):n()}catch(s){oh(s,e,t)}}function rs(n,e,t,r){if(Qe(n)){const s=Gu(n,e,t,r);return s&&c0(s)&&s.catch(i=>{oh(i,e,t)}),s}if(Ue(n)){const s=[];for(let i=0;i<n.length;i++)s.push(rs(n[i],e,t,r));return s}}function oh(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Pt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,l,c)===!1)return}a=a.parent}if(i){Ps(),Gu(i,null,10,[n,l,c]),Rs();return}}Hx(n,t,s,r,o)}function Hx(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Yn=[];let Hr=-1;const Ea=[];let oi=null,fa=0;const V0=Promise.resolve();let Ed=null;function fn(n){const e=Ed||V0;return n?e.then(this?n.bind(this):n):e}function Wx(n){let e=Hr+1,t=Yn.length;for(;e<t;){const r=e+t>>>1,s=Yn[r],i=vu(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function tm(n){if(!(n.flags&1)){const e=vu(n),t=Yn[Yn.length-1];!t||!(n.flags&2)&&e>=vu(t)?Yn.push(n):Yn.splice(Wx(e),0,n),n.flags|=1,O0()}}function O0(){Ed||(Ed=V0.then(L0))}function Qx(n){Ue(n)?Ea.push(...n):oi&&n.id===-1?oi.splice(fa+1,0,n):n.flags&1||(Ea.push(n),n.flags|=1),O0()}function cv(n,e,t=Hr+1){for(;t<Yn.length;t++){const r=Yn[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Yn.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function M0(n){if(Ea.length){const e=[...new Set(Ea)].sort((t,r)=>vu(t)-vu(r));if(Ea.length=0,oi){oi.push(...e);return}for(oi=e,fa=0;fa<oi.length;fa++){const t=oi[fa];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}oi=null,fa=0}}const vu=n=>n.id==null?n.flags&2?-1:1/0:n.id;function L0(n){const e=Or;try{for(Hr=0;Hr<Yn.length;Hr++){const t=Yn[Hr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Gu(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Hr<Yn.length;Hr++){const t=Yn[Hr];t&&(t.flags&=-2)}Hr=-1,Yn.length=0,M0(),Ed=null,(Yn.length||Ea.length)&&L0()}}let hr=null,F0=null;function Td(n){const e=hr;return hr=n,F0=n&&n.type.__scopeId||null,e}function Jx(n,e=hr,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&Iv(-1);const i=Td(e);let o;try{o=n(...s)}finally{Td(i),r._d&&Iv(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function nt(n,e){if(hr===null)return n;const t=ch(hr),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Pt]=e[s];i&&(Qe(i)&&(i={mounted:i,updated:i}),i.deep&&bs(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function so(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(Ps(),rs(l,t,8,[n.el,a,n,e]),Rs())}}const $0=Symbol("_vte"),Yx=n=>n.__isTeleport,nu=n=>n&&(n.disabled||n.disabled===""),dv=n=>n&&(n.defer||n.defer===""),hv=n=>typeof SVGElement<"u"&&n instanceof SVGElement,fv=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,Yf=(n,e)=>{const t=n&&n.to;return ln(t)?e?e(t):null:t},U0={name:"Teleport",__isTeleport:!0,process(n,e,t,r,s,i,o,a,l,c){const{mc:d,pc:f,pbc:g,o:{insert:y,querySelector:T,createText:A,createComment:P}}=c,U=nu(e.props);let{shapeFlag:q,children:M,dynamicChildren:z}=e;if(n==null){const he=e.el=A(""),pe=e.anchor=A("");y(he,t,r),y(pe,t,r);const x=(w,C)=>{q&16&&(s&&s.isCE&&(s.ce._teleportTarget=w),d(M,w,C,s,i,o,a,l))},I=()=>{const w=e.target=Yf(e.props,T),C=j0(w,e,A,y);w&&(o!=="svg"&&hv(w)?o="svg":o!=="mathml"&&fv(w)&&(o="mathml"),U||(x(w,C),ed(e,!1)))};U&&(x(t,pe),ed(e,!0)),dv(e.props)?(e.el.__isMounted=!1,Qn(()=>{I(),delete e.el.__isMounted},i)):I()}else{if(dv(e.props)&&n.el.__isMounted===!1){Qn(()=>{U0.process(n,e,t,r,s,i,o,a,l,c)},i);return}e.el=n.el,e.targetStart=n.targetStart;const he=e.anchor=n.anchor,pe=e.target=n.target,x=e.targetAnchor=n.targetAnchor,I=nu(n.props),w=I?t:pe,C=I?he:x;if(o==="svg"||hv(pe)?o="svg":(o==="mathml"||fv(pe))&&(o="mathml"),z?(g(n.dynamicChildren,z,w,s,i,o,a),om(n,e,!0)):l||f(n,e,w,C,s,i,o,a,!1),U)I?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Bc(e,t,he,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const V=e.target=Yf(e.props,T);V&&Bc(e,V,null,c,0)}else I&&Bc(e,pe,x,c,1);ed(e,U)}},remove(n,e,t,{um:r,o:{remove:s}},i){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:d,target:f,props:g}=n;if(f&&(s(c),s(d)),i&&s(l),o&16){const y=i||!nu(g);for(let T=0;T<a.length;T++){const A=a[T];r(A,e,t,y,!!A.dynamicChildren)}}},move:Bc,hydrate:Xx};function Bc(n,e,t,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:d}=n,f=i===2;if(f&&r(o,e,t),(!f||nu(d))&&l&16)for(let g=0;g<c.length;g++)s(c[g],e,t,2);f&&r(a,e,t)}function Xx(n,e,t,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:d}},f){const g=e.target=Yf(e.props,l);if(g){const y=nu(e.props),T=g._lpa||g.firstChild;if(e.shapeFlag&16)if(y)e.anchor=f(o(n),e,a(n),t,r,s,i),e.targetStart=T,e.targetAnchor=T&&o(T);else{e.anchor=o(n);let A=T;for(;A;){if(A&&A.nodeType===8){if(A.data==="teleport start anchor")e.targetStart=A;else if(A.data==="teleport anchor"){e.targetAnchor=A,g._lpa=e.targetAnchor&&o(e.targetAnchor);break}}A=o(A)}e.targetAnchor||j0(g,e,d,c),f(T&&o(T),e,g,t,r,s,i)}ed(e,y)}return e.anchor&&o(e.anchor)}const Zx=U0;function ed(n,e){const t=n.ctx;if(t&&t.ut){let r,s;for(e?(r=n.el,s=n.anchor):(r=n.targetStart,s=n.targetAnchor);r&&r!==s;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function j0(n,e,t,r){const s=e.targetStart=t(""),i=e.targetAnchor=t("");return s[$0]=i,n&&(r(s,n),r(i,n)),i}function nm(n,e){n.shapeFlag&6&&n.component?(n.transition=e,nm(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function B0(n,e){return Qe(n)?(()=>Tn({name:n.name},e,{setup:n}))():n}function q0(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function ru(n,e,t,r,s=!1){if(Ue(n)){n.forEach((T,A)=>ru(T,e&&(Ue(e)?e[A]:e),t,r,s));return}if(su(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&ru(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?ch(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,d=a.refs===Pt?a.refs={}:a.refs,f=a.setupState,g=yt(f),y=f===Pt?()=>!1:T=>_t(g,T);if(c!=null&&c!==l&&(ln(c)?(d[c]=null,y(c)&&(f[c]=null)):Un(c)&&(c.value=null)),Qe(l))Gu(l,a,12,[o,d]);else{const T=ln(l),A=Un(l);if(T||A){const P=()=>{if(n.f){const U=T?y(l)?f[l]:d[l]:l.value;s?Ue(U)&&Kp(U,i):Ue(U)?U.includes(i)||U.push(i):T?(d[l]=[i],y(l)&&(f[l]=d[l])):(l.value=[i],n.k&&(d[n.k]=l.value))}else T?(d[l]=o,y(l)&&(f[l]=o)):A&&(l.value=o,n.k&&(d[n.k]=o))};o?(P.id=-1,Qn(P,t)):P()}}}rh().requestIdleCallback;rh().cancelIdleCallback;const su=n=>!!n.type.__asyncLoader,z0=n=>n.type.__isKeepAlive;function eA(n,e){K0(n,"a",e)}function tA(n,e){K0(n,"da",e)}function K0(n,e,t=$n){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(ah(e,r,t),t){let s=t.parent;for(;s&&s.parent;)z0(s.parent.vnode)&&nA(r,e,t,s),s=s.parent}}function nA(n,e,t,r){const s=ah(e,n,r,!0);_a(()=>{Kp(r[e],s)},t)}function ah(n,e,t=$n,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Ps();const a=Hu(t),l=rs(e,t,n,o);return a(),Rs(),l});return r?s.unshift(i):s.push(i),i}}const Ms=n=>(e,t=$n)=>{(!_u||n==="sp")&&ah(n,(...r)=>e(...r),t)},rA=Ms("bm"),ir=Ms("m"),sA=Ms("bu"),iA=Ms("u"),G0=Ms("bum"),_a=Ms("um"),oA=Ms("sp"),aA=Ms("rtg"),lA=Ms("rtc");function uA(n,e=$n){ah("ec",n,e)}const H0="components";function cA(n,e){return hA(H0,n,!0,e)||n}const dA=Symbol.for("v-ndc");function hA(n,e,t=!0,r=!1){const s=hr||$n;if(s){const i=s.type;if(n===H0){const a=XA(i,!1);if(a&&(a===e||a===Tr(e)||a===nh(Tr(e))))return i}const o=pv(s[n]||i[n],e)||pv(s.appContext[n],e);return!o&&r?i:o}}function pv(n,e){return n&&(n[e]||n[Tr(e)]||n[nh(Tr(e))])}function wr(n,e,t,r){let s;const i=t&&t[r],o=Ue(n);if(o||ln(n)){const a=o&&Ia(n);let l=!1,c=!1;a&&(l=!Ir(n),c=Ti(n),n=sh(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(l?c?wd(Sn(n[d])):Sn(n[d]):n[d],d,void 0,i&&i[d])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(Vt(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i&&i[l]));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const d=a[l];s[l]=e(n[d],d,l,i&&i[l])}}else s=[];return t&&(t[r]=s),s}const Xf=n=>n?db(n)?ch(n):Xf(n.parent):null,iu=Tn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Xf(n.parent),$root:n=>Xf(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>rm(n),$forceUpdate:n=>n.f||(n.f=()=>{tm(n.update)}),$nextTick:n=>n.n||(n.n=fn.bind(n.proxy)),$watch:n=>NA.bind(n)}),pf=(n,e)=>n!==Pt&&!n.__isScriptSetup&&_t(n,e),fA={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(pf(r,e))return o[e]=1,r[e];if(s!==Pt&&_t(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&_t(c,e))return o[e]=3,i[e];if(t!==Pt&&_t(t,e))return o[e]=4,t[e];Zf&&(o[e]=0)}}const d=iu[e];let f,g;if(d)return e==="$attrs"&&Fn(n.attrs,"get",""),d(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==Pt&&_t(t,e))return o[e]=4,t[e];if(g=l.config.globalProperties,_t(g,e))return g[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return pf(s,e)?(s[e]=t,!0):r!==Pt&&_t(r,e)?(r[e]=t,!0):_t(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==Pt&&_t(n,o)||pf(e,o)||(a=i[0])&&_t(a,o)||_t(r,o)||_t(iu,o)||_t(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:_t(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function mv(n){return Ue(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Zf=!0;function pA(n){const e=rm(n),t=n.proxy,r=n.ctx;Zf=!1,e.beforeCreate&&gv(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:f,mounted:g,beforeUpdate:y,updated:T,activated:A,deactivated:P,beforeDestroy:U,beforeUnmount:q,destroyed:M,unmounted:z,render:he,renderTracked:pe,renderTriggered:x,errorCaptured:I,serverPrefetch:w,expose:C,inheritAttrs:V,components:B,directives:R,filters:wt}=e;if(c&&mA(c,r,null),o)for(const j in o){const ne=o[j];Qe(ne)&&(r[j]=ne.bind(t))}if(s){const j=s.call(t,t);Vt(j)&&(n.data=ih(j))}if(Zf=!0,i)for(const j in i){const ne=i[j],Ke=Qe(ne)?ne.bind(t,t):Qe(ne.get)?ne.get.bind(t,t):Or,Be=!Qe(ne)&&Qe(ne.set)?ne.set.bind(t):Or,Ge=Oe({get:Ke,set:Be});Object.defineProperty(r,j,{enumerable:!0,configurable:!0,get:()=>Ge.value,set:re=>Ge.value=re})}if(a)for(const j in a)W0(a[j],r,t,j);if(l){const j=Qe(l)?l.call(t):l;Reflect.ownKeys(j).forEach(ne=>{td(ne,j[ne])})}d&&gv(d,n,"c");function Y(j,ne){Ue(ne)?ne.forEach(Ke=>j(Ke.bind(t))):ne&&j(ne.bind(t))}if(Y(rA,f),Y(ir,g),Y(sA,y),Y(iA,T),Y(eA,A),Y(tA,P),Y(uA,I),Y(lA,pe),Y(aA,x),Y(G0,q),Y(_a,z),Y(oA,w),Ue(C))if(C.length){const j=n.exposed||(n.exposed={});C.forEach(ne=>{Object.defineProperty(j,ne,{get:()=>t[ne],set:Ke=>t[ne]=Ke})})}else n.exposed||(n.exposed={});he&&n.render===Or&&(n.render=he),V!=null&&(n.inheritAttrs=V),B&&(n.components=B),R&&(n.directives=R),w&&q0(n)}function mA(n,e,t=Or){Ue(n)&&(n=ep(n));for(const r in n){const s=n[r];let i;Vt(s)?"default"in s?i=Lr(s.from||r,s.default,!0):i=Lr(s.from||r):i=Lr(s),Un(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function gv(n,e,t){rs(Ue(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function W0(n,e,t,r){let s=r.includes(".")?ob(t,r):()=>t[r];if(ln(n)){const i=e[n];Qe(i)&&xt(s,i)}else if(Qe(n))xt(s,n.bind(t));else if(Vt(n))if(Ue(n))n.forEach(i=>W0(i,e,t,r));else{const i=Qe(n.handler)?n.handler.bind(t):e[n.handler];Qe(i)&&xt(s,i,n)}}function rm(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>xd(l,c,o,!0)),xd(l,e,o)),Vt(e)&&i.set(e,l),l}function xd(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&xd(n,i,t,!0),s&&s.forEach(o=>xd(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=gA[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const gA={data:vv,props:yv,emits:yv,methods:Kl,computed:Kl,beforeCreate:Wn,created:Wn,beforeMount:Wn,mounted:Wn,beforeUpdate:Wn,updated:Wn,beforeDestroy:Wn,beforeUnmount:Wn,destroyed:Wn,unmounted:Wn,activated:Wn,deactivated:Wn,errorCaptured:Wn,serverPrefetch:Wn,components:Kl,directives:Kl,watch:yA,provide:vv,inject:vA};function vv(n,e){return e?n?function(){return Tn(Qe(n)?n.call(this,this):n,Qe(e)?e.call(this,this):e)}:e:n}function vA(n,e){return Kl(ep(n),ep(e))}function ep(n){if(Ue(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Wn(n,e){return n?[...new Set([].concat(n,e))]:e}function Kl(n,e){return n?Tn(Object.create(null),n,e):e}function yv(n,e){return n?Ue(n)&&Ue(e)?[...new Set([...n,...e])]:Tn(Object.create(null),mv(n),mv(e??{})):e}function yA(n,e){if(!n)return e;if(!e)return n;const t=Tn(Object.create(null),n);for(const r in e)t[r]=Wn(n[r],e[r]);return t}function Q0(){return{app:null,config:{isNativeTag:ax,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let _A=0;function bA(n,e){return function(r,s=null){Qe(r)||(r=Tn({},r)),s!=null&&!Vt(s)&&(s=null);const i=Q0(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:_A++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:eS,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&Qe(d.install)?(o.add(d),d.install(c,...f)):Qe(d)&&(o.add(d),d(c,...f))),c},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),c},component(d,f){return f?(i.components[d]=f,c):i.components[d]},directive(d,f){return f?(i.directives[d]=f,c):i.directives[d]},mount(d,f,g){if(!l){const y=c._ceVNode||ct(r,s);return y.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),f&&e?e(y,d):n(y,d,g),l=!0,c._container=d,d.__vue_app__=c,ch(y.component)}},onUnmount(d){a.push(d)},unmount(){l&&(rs(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(d,f){return i.provides[d]=f,c},runWithContext(d){const f=Ta;Ta=c;try{return d()}finally{Ta=f}}};return c}}let Ta=null;function td(n,e){if($n){let t=$n.provides;const r=$n.parent&&$n.parent.provides;r===t&&(t=$n.provides=Object.create(r)),t[n]=e}}function Lr(n,e,t=!1){const r=$n||hr;if(r||Ta){let s=Ta?Ta._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&Qe(e)?e.call(r&&r.proxy):e}}const J0={},Y0=()=>Object.create(J0),X0=n=>Object.getPrototypeOf(n)===J0;function wA(n,e,t,r=!1){const s={},i=Y0();n.propsDefaults=Object.create(null),Z0(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:C0(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function IA(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=yt(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(lh(n.emitsOptions,g))continue;const y=e[g];if(l)if(_t(i,g))y!==i[g]&&(i[g]=y,c=!0);else{const T=Tr(g);s[T]=tp(l,a,T,y,n,!1)}else y!==i[g]&&(i[g]=y,c=!0)}}}else{Z0(n,e,s,i)&&(c=!0);let d;for(const f in a)(!e||!_t(e,f)&&((d=Oi(f))===f||!_t(e,d)))&&(l?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=tp(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!_t(e,f))&&(delete i[f],c=!0)}c&&_s(n.attrs,"set","")}function Z0(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Zl(l))continue;const c=e[l];let d;s&&_t(s,d=Tr(l))?!i||!i.includes(d)?t[d]=c:(a||(a={}))[d]=c:lh(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=yt(t),c=a||Pt;for(let d=0;d<i.length;d++){const f=i[d];t[f]=tp(s,l,f,c[f],n,!_t(c,f))}}return o}function tp(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=_t(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Qe(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const d=Hu(s);r=c[t]=l.call(null,e),d()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Oi(t))&&(r=!0))}return r}const EA=new WeakMap;function eb(n,e,t=!1){const r=t?EA:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!Qe(n)){const d=f=>{l=!0;const[g,y]=eb(f,e,!0);Tn(o,g),y&&a.push(...y)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!l)return Vt(n)&&r.set(n,ba),ba;if(Ue(i))for(let d=0;d<i.length;d++){const f=Tr(i[d]);_v(f)&&(o[f]=Pt)}else if(i)for(const d in i){const f=Tr(d);if(_v(f)){const g=i[d],y=o[f]=Ue(g)||Qe(g)?{type:g}:Tn({},g),T=y.type;let A=!1,P=!0;if(Ue(T))for(let U=0;U<T.length;++U){const q=T[U],M=Qe(q)&&q.name;if(M==="Boolean"){A=!0;break}else M==="String"&&(P=!1)}else A=Qe(T)&&T.name==="Boolean";y[0]=A,y[1]=P,(A||_t(y,"default"))&&a.push(f)}}const c=[o,a];return Vt(n)&&r.set(n,c),c}function _v(n){return n[0]!=="$"&&!Zl(n)}const sm=n=>n[0]==="_"||n==="$stable",im=n=>Ue(n)?n.map(Wr):[Wr(n)],TA=(n,e,t)=>{if(e._n)return e;const r=Jx((...s)=>im(e(...s)),t);return r._c=!1,r},tb=(n,e,t)=>{const r=n._ctx;for(const s in n){if(sm(s))continue;const i=n[s];if(Qe(i))e[s]=TA(s,i,r);else if(i!=null){const o=im(i);e[s]=()=>o}}},nb=(n,e)=>{const t=im(e);n.slots.default=()=>t},rb=(n,e,t)=>{for(const r in e)(t||!sm(r))&&(n[r]=e[r])},xA=(n,e,t)=>{const r=n.slots=Y0();if(n.vnode.shapeFlag&32){const s=e.__;s&&Gf(r,"__",s,!0);const i=e._;i?(rb(r,e,t),t&&Gf(r,"_",i,!0)):tb(e,r)}else e&&nb(n,e)},AA=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=Pt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:rb(s,e,t):(i=!e.$stable,tb(e,s)),o=e}else e&&(nb(n,e),o={default:1});if(i)for(const a in s)!sm(a)&&o[a]==null&&delete s[a]},Qn=UA;function SA(n){return PA(n)}function PA(n,e){const t=rh();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:f,nextSibling:g,setScopeId:y=Or,insertStaticContent:T}=n,A=(E,S,O,oe=null,Z=null,ae=null,be=void 0,ve=null,ye=!!S.dynamicChildren)=>{if(E===S)return;E&&!Ol(E,S)&&(oe=D(E),re(E,Z,ae,!0),E=null),S.patchFlag===-2&&(ye=!1,S.dynamicChildren=null);const{type:fe,ref:Ae,shapeFlag:Te}=S;switch(fe){case uh:P(E,S,O,oe);break;case xi:U(E,S,O,oe);break;case nd:E==null&&q(S,O,oe,be);break;case dt:B(E,S,O,oe,Z,ae,be,ve,ye);break;default:Te&1?he(E,S,O,oe,Z,ae,be,ve,ye):Te&6?R(E,S,O,oe,Z,ae,be,ve,ye):(Te&64||Te&128)&&fe.process(E,S,O,oe,Z,ae,be,ve,ye,se)}Ae!=null&&Z?ru(Ae,E&&E.ref,ae,S||E,!S):Ae==null&&E&&E.ref!=null&&ru(E.ref,null,ae,E,!0)},P=(E,S,O,oe)=>{if(E==null)r(S.el=a(S.children),O,oe);else{const Z=S.el=E.el;S.children!==E.children&&c(Z,S.children)}},U=(E,S,O,oe)=>{E==null?r(S.el=l(S.children||""),O,oe):S.el=E.el},q=(E,S,O,oe)=>{[E.el,E.anchor]=T(E.children,S,O,oe,E.el,E.anchor)},M=({el:E,anchor:S},O,oe)=>{let Z;for(;E&&E!==S;)Z=g(E),r(E,O,oe),E=Z;r(S,O,oe)},z=({el:E,anchor:S})=>{let O;for(;E&&E!==S;)O=g(E),s(E),E=O;s(S)},he=(E,S,O,oe,Z,ae,be,ve,ye)=>{S.type==="svg"?be="svg":S.type==="math"&&(be="mathml"),E==null?pe(S,O,oe,Z,ae,be,ve,ye):w(E,S,Z,ae,be,ve,ye)},pe=(E,S,O,oe,Z,ae,be,ve)=>{let ye,fe;const{props:Ae,shapeFlag:Te,transition:Pe,dirs:De}=E;if(ye=E.el=o(E.type,ae,Ae&&Ae.is,Ae),Te&8?d(ye,E.children):Te&16&&I(E.children,ye,null,oe,Z,mf(E,ae),be,ve),De&&so(E,null,oe,"created"),x(ye,E,E.scopeId,be,oe),Ae){for(const He in Ae)He!=="value"&&!Zl(He)&&i(ye,He,null,Ae[He],ae,oe);"value"in Ae&&i(ye,"value",null,Ae.value,ae),(fe=Ae.onVnodeBeforeMount)&&Gr(fe,oe,E)}De&&so(E,null,oe,"beforeMount");const Le=RA(Z,Pe);Le&&Pe.beforeEnter(ye),r(ye,S,O),((fe=Ae&&Ae.onVnodeMounted)||Le||De)&&Qn(()=>{fe&&Gr(fe,oe,E),Le&&Pe.enter(ye),De&&so(E,null,oe,"mounted")},Z)},x=(E,S,O,oe,Z)=>{if(O&&y(E,O),oe)for(let ae=0;ae<oe.length;ae++)y(E,oe[ae]);if(Z){let ae=Z.subTree;if(S===ae||lb(ae.type)&&(ae.ssContent===S||ae.ssFallback===S)){const be=Z.vnode;x(E,be,be.scopeId,be.slotScopeIds,Z.parent)}}},I=(E,S,O,oe,Z,ae,be,ve,ye=0)=>{for(let fe=ye;fe<E.length;fe++){const Ae=E[fe]=ve?ai(E[fe]):Wr(E[fe]);A(null,Ae,S,O,oe,Z,ae,be,ve)}},w=(E,S,O,oe,Z,ae,be)=>{const ve=S.el=E.el;let{patchFlag:ye,dynamicChildren:fe,dirs:Ae}=S;ye|=E.patchFlag&16;const Te=E.props||Pt,Pe=S.props||Pt;let De;if(O&&io(O,!1),(De=Pe.onVnodeBeforeUpdate)&&Gr(De,O,S,E),Ae&&so(S,E,O,"beforeUpdate"),O&&io(O,!0),(Te.innerHTML&&Pe.innerHTML==null||Te.textContent&&Pe.textContent==null)&&d(ve,""),fe?C(E.dynamicChildren,fe,ve,O,oe,mf(S,Z),ae):be||ne(E,S,ve,null,O,oe,mf(S,Z),ae,!1),ye>0){if(ye&16)V(ve,Te,Pe,O,Z);else if(ye&2&&Te.class!==Pe.class&&i(ve,"class",null,Pe.class,Z),ye&4&&i(ve,"style",Te.style,Pe.style,Z),ye&8){const Le=S.dynamicProps;for(let He=0;He<Le.length;He++){const Ze=Le[He],Yt=Te[Ze],Bt=Pe[Ze];(Bt!==Yt||Ze==="value")&&i(ve,Ze,Yt,Bt,Z,O)}}ye&1&&E.children!==S.children&&d(ve,S.children)}else!be&&fe==null&&V(ve,Te,Pe,O,Z);((De=Pe.onVnodeUpdated)||Ae)&&Qn(()=>{De&&Gr(De,O,S,E),Ae&&so(S,E,O,"updated")},oe)},C=(E,S,O,oe,Z,ae,be)=>{for(let ve=0;ve<S.length;ve++){const ye=E[ve],fe=S[ve],Ae=ye.el&&(ye.type===dt||!Ol(ye,fe)||ye.shapeFlag&198)?f(ye.el):O;A(ye,fe,Ae,null,oe,Z,ae,be,!0)}},V=(E,S,O,oe,Z)=>{if(S!==O){if(S!==Pt)for(const ae in S)!Zl(ae)&&!(ae in O)&&i(E,ae,S[ae],null,Z,oe);for(const ae in O){if(Zl(ae))continue;const be=O[ae],ve=S[ae];be!==ve&&ae!=="value"&&i(E,ae,ve,be,Z,oe)}"value"in O&&i(E,"value",S.value,O.value,Z)}},B=(E,S,O,oe,Z,ae,be,ve,ye)=>{const fe=S.el=E?E.el:a(""),Ae=S.anchor=E?E.anchor:a("");let{patchFlag:Te,dynamicChildren:Pe,slotScopeIds:De}=S;De&&(ve=ve?ve.concat(De):De),E==null?(r(fe,O,oe),r(Ae,O,oe),I(S.children||[],O,Ae,Z,ae,be,ve,ye)):Te>0&&Te&64&&Pe&&E.dynamicChildren?(C(E.dynamicChildren,Pe,O,Z,ae,be,ve),(S.key!=null||Z&&S===Z.subTree)&&om(E,S,!0)):ne(E,S,O,Ae,Z,ae,be,ve,ye)},R=(E,S,O,oe,Z,ae,be,ve,ye)=>{S.slotScopeIds=ve,E==null?S.shapeFlag&512?Z.ctx.activate(S,O,oe,be,ye):wt(S,O,oe,Z,ae,be,ye):gt(E,S,ye)},wt=(E,S,O,oe,Z,ae,be)=>{const ve=E.component=HA(E,oe,Z);if(z0(E)&&(ve.ctx.renderer=se),WA(ve,!1,be),ve.asyncDep){if(Z&&Z.registerDep(ve,Y,be),!E.el){const ye=ve.subTree=ct(xi);U(null,ye,S,O)}}else Y(ve,E,S,O,Z,ae,be)},gt=(E,S,O)=>{const oe=S.component=E.component;if(FA(E,S,O))if(oe.asyncDep&&!oe.asyncResolved){j(oe,S,O);return}else oe.next=S,oe.update();else S.el=E.el,oe.vnode=S},Y=(E,S,O,oe,Z,ae,be)=>{const ve=()=>{if(E.isMounted){let{next:Te,bu:Pe,u:De,parent:Le,vnode:He}=E;{const Mt=sb(E);if(Mt){Te&&(Te.el=He.el,j(E,Te,be)),Mt.asyncDep.then(()=>{E.isUnmounted||ve()});return}}let Ze=Te,Yt;io(E,!1),Te?(Te.el=He.el,j(E,Te,be)):Te=He,Pe&&Zc(Pe),(Yt=Te.props&&Te.props.onVnodeBeforeUpdate)&&Gr(Yt,Le,Te,He),io(E,!0);const Bt=gf(E),_n=E.subTree;E.subTree=Bt,A(_n,Bt,f(_n.el),D(_n),E,Z,ae),Te.el=Bt.el,Ze===null&&$A(E,Bt.el),De&&Qn(De,Z),(Yt=Te.props&&Te.props.onVnodeUpdated)&&Qn(()=>Gr(Yt,Le,Te,He),Z)}else{let Te;const{el:Pe,props:De}=S,{bm:Le,m:He,parent:Ze,root:Yt,type:Bt}=E,_n=su(S);if(io(E,!1),Le&&Zc(Le),!_n&&(Te=De&&De.onVnodeBeforeMount)&&Gr(Te,Ze,S),io(E,!0),Pe&&$e){const Mt=()=>{E.subTree=gf(E),$e(Pe,E.subTree,E,Z,null)};_n&&Bt.__asyncHydrate?Bt.__asyncHydrate(Pe,E,Mt):Mt()}else{Yt.ce&&Yt.ce._def.shadowRoot!==!1&&Yt.ce._injectChildStyle(Bt);const Mt=E.subTree=gf(E);A(null,Mt,O,oe,E,Z,ae),S.el=Mt.el}if(He&&Qn(He,Z),!_n&&(Te=De&&De.onVnodeMounted)){const Mt=S;Qn(()=>Gr(Te,Ze,Mt),Z)}(S.shapeFlag&256||Ze&&su(Ze.vnode)&&Ze.vnode.shapeFlag&256)&&E.a&&Qn(E.a,Z),E.isMounted=!0,S=O=oe=null}};E.scope.on();const ye=E.effect=new g0(ve);E.scope.off();const fe=E.update=ye.run.bind(ye),Ae=E.job=ye.runIfDirty.bind(ye);Ae.i=E,Ae.id=E.uid,ye.scheduler=()=>tm(Ae),io(E,!0),fe()},j=(E,S,O)=>{S.component=E;const oe=E.vnode.props;E.vnode=S,E.next=null,IA(E,S.props,oe,O),AA(E,S.children,O),Ps(),cv(E),Rs()},ne=(E,S,O,oe,Z,ae,be,ve,ye=!1)=>{const fe=E&&E.children,Ae=E?E.shapeFlag:0,Te=S.children,{patchFlag:Pe,shapeFlag:De}=S;if(Pe>0){if(Pe&128){Be(fe,Te,O,oe,Z,ae,be,ve,ye);return}else if(Pe&256){Ke(fe,Te,O,oe,Z,ae,be,ve,ye);return}}De&8?(Ae&16&&ht(fe,Z,ae),Te!==fe&&d(O,Te)):Ae&16?De&16?Be(fe,Te,O,oe,Z,ae,be,ve,ye):ht(fe,Z,ae,!0):(Ae&8&&d(O,""),De&16&&I(Te,O,oe,Z,ae,be,ve,ye))},Ke=(E,S,O,oe,Z,ae,be,ve,ye)=>{E=E||ba,S=S||ba;const fe=E.length,Ae=S.length,Te=Math.min(fe,Ae);let Pe;for(Pe=0;Pe<Te;Pe++){const De=S[Pe]=ye?ai(S[Pe]):Wr(S[Pe]);A(E[Pe],De,O,null,Z,ae,be,ve,ye)}fe>Ae?ht(E,Z,ae,!0,!1,Te):I(S,O,oe,Z,ae,be,ve,ye,Te)},Be=(E,S,O,oe,Z,ae,be,ve,ye)=>{let fe=0;const Ae=S.length;let Te=E.length-1,Pe=Ae-1;for(;fe<=Te&&fe<=Pe;){const De=E[fe],Le=S[fe]=ye?ai(S[fe]):Wr(S[fe]);if(Ol(De,Le))A(De,Le,O,null,Z,ae,be,ve,ye);else break;fe++}for(;fe<=Te&&fe<=Pe;){const De=E[Te],Le=S[Pe]=ye?ai(S[Pe]):Wr(S[Pe]);if(Ol(De,Le))A(De,Le,O,null,Z,ae,be,ve,ye);else break;Te--,Pe--}if(fe>Te){if(fe<=Pe){const De=Pe+1,Le=De<Ae?S[De].el:oe;for(;fe<=Pe;)A(null,S[fe]=ye?ai(S[fe]):Wr(S[fe]),O,Le,Z,ae,be,ve,ye),fe++}}else if(fe>Pe)for(;fe<=Te;)re(E[fe],Z,ae,!0),fe++;else{const De=fe,Le=fe,He=new Map;for(fe=Le;fe<=Pe;fe++){const un=S[fe]=ye?ai(S[fe]):Wr(S[fe]);un.key!=null&&He.set(un.key,fe)}let Ze,Yt=0;const Bt=Pe-Le+1;let _n=!1,Mt=0;const mr=new Array(Bt);for(fe=0;fe<Bt;fe++)mr[fe]=0;for(fe=De;fe<=Te;fe++){const un=E[fe];if(Yt>=Bt){re(un,Z,ae,!0);continue}let Cn;if(un.key!=null)Cn=He.get(un.key);else for(Ze=Le;Ze<=Pe;Ze++)if(mr[Ze-Le]===0&&Ol(un,S[Ze])){Cn=Ze;break}Cn===void 0?re(un,Z,ae,!0):(mr[Cn-Le]=fe+1,Cn>=Mt?Mt=Cn:_n=!0,A(un,S[Cn],O,null,Z,ae,be,ve,ye),Yt++)}const Ur=_n?CA(mr):ba;for(Ze=Ur.length-1,fe=Bt-1;fe>=0;fe--){const un=Le+fe,Cn=S[un],qi=un+1<Ae?S[un+1].el:oe;mr[fe]===0?A(null,Cn,O,qi,Z,ae,be,ve,ye):_n&&(Ze<0||fe!==Ur[Ze]?Ge(Cn,O,qi,2):Ze--)}}},Ge=(E,S,O,oe,Z=null)=>{const{el:ae,type:be,transition:ve,children:ye,shapeFlag:fe}=E;if(fe&6){Ge(E.component.subTree,S,O,oe);return}if(fe&128){E.suspense.move(S,O,oe);return}if(fe&64){be.move(E,S,O,se);return}if(be===dt){r(ae,S,O);for(let Te=0;Te<ye.length;Te++)Ge(ye[Te],S,O,oe);r(E.anchor,S,O);return}if(be===nd){M(E,S,O);return}if(oe!==2&&fe&1&&ve)if(oe===0)ve.beforeEnter(ae),r(ae,S,O),Qn(()=>ve.enter(ae),Z);else{const{leave:Te,delayLeave:Pe,afterLeave:De}=ve,Le=()=>{E.ctx.isUnmounted?s(ae):r(ae,S,O)},He=()=>{Te(ae,()=>{Le(),De&&De()})};Pe?Pe(ae,Le,He):He()}else r(ae,S,O)},re=(E,S,O,oe=!1,Z=!1)=>{const{type:ae,props:be,ref:ve,children:ye,dynamicChildren:fe,shapeFlag:Ae,patchFlag:Te,dirs:Pe,cacheIndex:De}=E;if(Te===-2&&(Z=!1),ve!=null&&(Ps(),ru(ve,null,O,E,!0),Rs()),De!=null&&(S.renderCache[De]=void 0),Ae&256){S.ctx.deactivate(E);return}const Le=Ae&1&&Pe,He=!su(E);let Ze;if(He&&(Ze=be&&be.onVnodeBeforeUnmount)&&Gr(Ze,S,E),Ae&6)Xe(E.component,O,oe);else{if(Ae&128){E.suspense.unmount(O,oe);return}Le&&so(E,null,S,"beforeUnmount"),Ae&64?E.type.remove(E,S,O,se,oe):fe&&!fe.hasOnce&&(ae!==dt||Te>0&&Te&64)?ht(fe,S,O,!1,!0):(ae===dt&&Te&384||!Z&&Ae&16)&&ht(ye,S,O),oe&&ee(E)}(He&&(Ze=be&&be.onVnodeUnmounted)||Le)&&Qn(()=>{Ze&&Gr(Ze,S,E),Le&&so(E,null,S,"unmounted")},O)},ee=E=>{const{type:S,el:O,anchor:oe,transition:Z}=E;if(S===dt){je(O,oe);return}if(S===nd){z(E);return}const ae=()=>{s(O),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(E.shapeFlag&1&&Z&&!Z.persisted){const{leave:be,delayLeave:ve}=Z,ye=()=>be(O,ae);ve?ve(E.el,ae,ye):ye()}else ae()},je=(E,S)=>{let O;for(;E!==S;)O=g(E),s(E),E=O;s(S)},Xe=(E,S,O)=>{const{bum:oe,scope:Z,job:ae,subTree:be,um:ve,m:ye,a:fe,parent:Ae,slots:{__:Te}}=E;bv(ye),bv(fe),oe&&Zc(oe),Ae&&Ue(Te)&&Te.forEach(Pe=>{Ae.renderCache[Pe]=void 0}),Z.stop(),ae&&(ae.flags|=8,re(be,E,S,O)),ve&&Qn(ve,S),Qn(()=>{E.isUnmounted=!0},S),S&&S.pendingBranch&&!S.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===S.pendingId&&(S.deps--,S.deps===0&&S.resolve())},ht=(E,S,O,oe=!1,Z=!1,ae=0)=>{for(let be=ae;be<E.length;be++)re(E[be],S,O,oe,Z)},D=E=>{if(E.shapeFlag&6)return D(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const S=g(E.anchor||E.el),O=S&&S[$0];return O?g(O):S};let $=!1;const X=(E,S,O)=>{E==null?S._vnode&&re(S._vnode,null,null,!0):A(S._vnode||null,E,S,null,null,null,O),S._vnode=E,$||($=!0,cv(),M0(),$=!1)},se={p:A,um:re,m:Ge,r:ee,mt:wt,mc:I,pc:ne,pbc:C,n:D,o:n};let ke,$e;return e&&([ke,$e]=e(se)),{render:X,hydrate:ke,createApp:bA(X,ke)}}function mf({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function io({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function RA(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function om(n,e,t=!1){const r=n.children,s=e.children;if(Ue(r)&&Ue(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=ai(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&om(o,a)),a.type===uh&&(a.el=o.el),a.type===xi&&!a.el&&(a.el=o.el)}}function CA(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function sb(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:sb(e)}function bv(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const kA=Symbol.for("v-scx"),DA=()=>Lr(kA);function xt(n,e,t){return ib(n,e,t)}function ib(n,e,t=Pt){const{immediate:r,deep:s,flush:i,once:o}=t,a=Tn({},t),l=e&&r||!e&&i!=="post";let c;if(_u){if(i==="sync"){const y=DA();c=y.__watcherHandles||(y.__watcherHandles=[])}else if(!l){const y=()=>{};return y.stop=Or,y.resume=Or,y.pause=Or,y}}const d=$n;a.call=(y,T,A)=>rs(y,d,T,A);let f=!1;i==="post"?a.scheduler=y=>{Qn(y,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(y,T)=>{T?y():tm(y)}),a.augmentJob=y=>{e&&(y.flags|=4),f&&(y.flags|=2,d&&(y.id=d.uid,y.i=d))};const g=Gx(n,e,a);return _u&&(c?c.push(g):l&&g()),g}function NA(n,e,t){const r=this.proxy,s=ln(n)?n.includes(".")?ob(r,n):()=>r[n]:n.bind(r,r);let i;Qe(e)?i=e:(i=e.handler,t=e);const o=Hu(this),a=ib(s,i.bind(r),t);return o(),a}function ob(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const VA=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${Tr(e)}Modifiers`]||n[`${Oi(e)}Modifiers`];function OA(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Pt;let s=t;const i=e.startsWith("update:"),o=i&&VA(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>ln(d)?d.trim():d)),o.number&&(s=t.map(bd)));let a,l=r[a=uf(e)]||r[a=uf(Tr(e))];!l&&i&&(l=r[a=uf(Oi(e))]),l&&rs(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,rs(c,n,6,s)}}function ab(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!Qe(n)){const l=c=>{const d=ab(c,e,!0);d&&(a=!0,Tn(o,d))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(Vt(n)&&r.set(n,null),null):(Ue(i)?i.forEach(l=>o[l]=null):Tn(o,i),Vt(n)&&r.set(n,o),o)}function lh(n,e){return!n||!eh(e)?!1:(e=e.slice(2).replace(/Once$/,""),_t(n,e[0].toLowerCase()+e.slice(1))||_t(n,Oi(e))||_t(n,e))}function gf(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:d,props:f,data:g,setupState:y,ctx:T,inheritAttrs:A}=n,P=Td(n);let U,q;try{if(t.shapeFlag&4){const z=s||r,he=z;U=Wr(c.call(he,z,d,f,y,g,T)),q=a}else{const z=e;U=Wr(z.length>1?z(f,{attrs:a,slots:o,emit:l}):z(f,null)),q=e.props?a:MA(a)}}catch(z){ou.length=0,oh(z,n,1),U=ct(xi)}let M=U;if(q&&A!==!1){const z=Object.keys(q),{shapeFlag:he}=M;z.length&&he&7&&(i&&z.some(zp)&&(q=LA(q,i)),M=ka(M,q,!1,!0))}return t.dirs&&(M=ka(M,null,!1,!0),M.dirs=M.dirs?M.dirs.concat(t.dirs):t.dirs),t.transition&&nm(M,t.transition),U=M,Td(P),U}const MA=n=>{let e;for(const t in n)(t==="class"||t==="style"||eh(t))&&((e||(e={}))[t]=n[t]);return e},LA=(n,e)=>{const t={};for(const r in n)(!zp(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function FA(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?wv(r,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(o[g]!==r[g]&&!lh(c,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?wv(r,o,c):!0:!!o;return!1}function wv(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!lh(t,i))return!0}return!1}function $A({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const lb=n=>n.__isSuspense;function UA(n,e){e&&e.pendingBranch?Ue(n)?e.effects.push(...n):e.effects.push(n):Qx(n)}const dt=Symbol.for("v-fgt"),uh=Symbol.for("v-txt"),xi=Symbol.for("v-cmt"),nd=Symbol.for("v-stc"),ou=[];let fr=null;function L(n=!1){ou.push(fr=n?null:[])}function jA(){ou.pop(),fr=ou[ou.length-1]||null}let yu=1;function Iv(n,e=!1){yu+=n,n<0&&fr&&e&&(fr.hasOnce=!0)}function ub(n){return n.dynamicChildren=yu>0?fr||ba:null,jA(),yu>0&&fr&&fr.push(n),n}function F(n,e,t,r,s,i){return ub(h(n,e,t,r,s,i,!0))}function Ad(n,e,t,r,s){return ub(ct(n,e,t,r,s,!0))}function Sd(n){return n?n.__v_isVNode===!0:!1}function Ol(n,e){return n.type===e.type&&n.key===e.key}const cb=({key:n})=>n??null,rd=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?ln(n)||Un(n)||Qe(n)?{i:hr,r:n,k:e,f:!!t}:n:null);function h(n,e=null,t=null,r=0,s=null,i=n===dt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&cb(e),ref:e&&rd(e),scopeId:F0,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:hr};return a?(am(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=ln(t)?8:16),yu>0&&!o&&fr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&fr.push(l),l}const ct=BA;function BA(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===dA)&&(n=xi),Sd(n)){const a=ka(n,e,!0);return t&&am(a,t),yu>0&&!i&&fr&&(a.shapeFlag&6?fr[fr.indexOf(n)]=a:fr.push(a)),a.patchFlag=-2,a}if(ZA(n)&&(n=n.__vccOpts),e){e=qA(e);let{class:a,style:l}=e;a&&!ln(a)&&(e.class=Tt(a)),Vt(l)&&(em(l)&&!Ue(l)&&(l=Tn({},l)),e.style=ys(l))}const o=ln(n)?1:lb(n)?128:Yx(n)?64:Vt(n)?4:Qe(n)?2:0;return h(n,e,t,r,s,o,i,!0)}function qA(n){return n?em(n)||X0(n)?Tn({},n):n:null}function ka(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?zA(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&cb(c),ref:e&&e.ref?t&&i?Ue(i)?i.concat(rd(e)):[i,rd(e)]:rd(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==dt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&ka(n.ssContent),ssFallback:n.ssFallback&&ka(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&nm(d,l.clone(d)),d}function Dt(n=" ",e=0){return ct(uh,null,n,e)}function Jn(n,e){const t=ct(nd,null,n);return t.staticCount=e,t}function ge(n="",e=!1){return e?(L(),Ad(xi,null,n)):ct(xi,null,n)}function Wr(n){return n==null||typeof n=="boolean"?ct(xi):Ue(n)?ct(dt,null,n.slice()):Sd(n)?ai(n):ct(uh,null,String(n))}function ai(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:ka(n)}function am(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Ue(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),am(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!X0(e)?e._ctx=hr:s===3&&hr&&(hr.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Qe(e)?(e={default:e,_ctx:hr},t=32):(e=String(e),r&64?(t=16,e=[Dt(e)]):t=8);n.children=e,n.shapeFlag|=t}function zA(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Tt([e.class,r.class]));else if(s==="style")e.style=ys([e.style,r.style]);else if(eh(s)){const i=e[s],o=r[s];o&&i!==o&&!(Ue(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Gr(n,e,t,r=null){rs(n,e,7,[t,r])}const KA=Q0();let GA=0;function HA(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||KA,i={uid:GA++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new _x(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eb(r,s),emitsOptions:ab(r,s),emit:null,emitted:null,propsDefaults:Pt,inheritAttrs:r.inheritAttrs,ctx:Pt,data:Pt,props:Pt,attrs:Pt,slots:Pt,refs:Pt,setupState:Pt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=OA.bind(null,i),n.ce&&n.ce(i),i}let $n=null,Pd,np;{const n=rh(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Pd=e("__VUE_INSTANCE_SETTERS__",t=>$n=t),np=e("__VUE_SSR_SETTERS__",t=>_u=t)}const Hu=n=>{const e=$n;return Pd(n),n.scope.on(),()=>{n.scope.off(),Pd(e)}},Ev=()=>{$n&&$n.scope.off(),Pd(null)};function db(n){return n.vnode.shapeFlag&4}let _u=!1;function WA(n,e=!1,t=!1){e&&np(e);const{props:r,children:s}=n.vnode,i=db(n);wA(n,r,i,e),xA(n,s,t||e);const o=i?QA(n,e):void 0;return e&&np(!1),o}function QA(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,fA);const{setup:r}=t;if(r){Ps();const s=n.setupContext=r.length>1?YA(n):null,i=Hu(n),o=Gu(r,n,0,[n.props,s]),a=c0(o);if(Rs(),i(),(a||n.sp)&&!su(n)&&q0(n),a){if(o.then(Ev,Ev),e)return o.then(l=>{Tv(n,l,e)}).catch(l=>{oh(l,n,0)});n.asyncDep=o}else Tv(n,o,e)}else hb(n,e)}function Tv(n,e,t){Qe(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Vt(e)&&(n.setupState=N0(e)),hb(n,t)}let xv;function hb(n,e,t){const r=n.type;if(!n.render){if(!e&&xv&&!r.render){const s=r.template||rm(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=Tn(Tn({isCustomElement:i,delimiters:a},o),l);r.render=xv(s,c)}}n.render=r.render||Or}{const s=Hu(n);Ps();try{pA(n)}finally{Rs(),s()}}}const JA={get(n,e){return Fn(n,"get",""),n[e]}};function YA(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,JA),slots:n.slots,emit:n.emit,expose:e}}function ch(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(N0($x(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in iu)return iu[t](n)},has(e,t){return t in e||t in iu}})):n.proxy}function XA(n,e=!0){return Qe(n)?n.displayName||n.name:n.name||e&&n.__name}function ZA(n){return Qe(n)&&"__vccOpts"in n}const Oe=(n,e)=>zx(n,e,_u);function fb(n,e,t){const r=arguments.length;return r===2?Vt(e)&&!Ue(e)?Sd(e)?ct(n,null,[e]):ct(n,e):ct(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Sd(t)&&(t=[t]),ct(n,e,t))}const eS="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rp;const Av=typeof window<"u"&&window.trustedTypes;if(Av)try{rp=Av.createPolicy("vue",{createHTML:n=>n})}catch{}const pb=rp?n=>rp.createHTML(n):n=>n,tS="http://www.w3.org/2000/svg",nS="http://www.w3.org/1998/Math/MathML",gs=typeof document<"u"?document:null,Sv=gs&&gs.createElement("template"),rS={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?gs.createElementNS(tS,n):e==="mathml"?gs.createElementNS(nS,n):t?gs.createElement(n,{is:t}):gs.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>gs.createTextNode(n),createComment:n=>gs.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>gs.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Sv.innerHTML=pb(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Sv.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},sS=Symbol("_vtc");function iS(n,e,t){const r=n[sS];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Rd=Symbol("_vod"),mb=Symbol("_vsh"),vf={beforeMount(n,{value:e},{transition:t}){n[Rd]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Ml(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),Ml(n,!0),r.enter(n)):r.leave(n,()=>{Ml(n,!1)}):Ml(n,e))},beforeUnmount(n,{value:e}){Ml(n,e)}};function Ml(n,e){n.style.display=e?n[Rd]:"none",n[mb]=!e}const oS=Symbol(""),aS=/(^|;)\s*display\s*:/;function lS(n,e,t){const r=n.style,s=ln(t);let i=!1;if(t&&!s){if(e)if(ln(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&sd(r,a,"")}else for(const o in e)t[o]==null&&sd(r,o,"");for(const o in t)o==="display"&&(i=!0),sd(r,o,t[o])}else if(s){if(e!==t){const o=r[oS];o&&(t+=";"+o),r.cssText=t,i=aS.test(t)}}else e&&n.removeAttribute("style");Rd in n&&(n[Rd]=i?r.display:"",n[mb]&&(r.display="none"))}const Pv=/\s*!important$/;function sd(n,e,t){if(Ue(t))t.forEach(r=>sd(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=uS(n,e);Pv.test(t)?n.setProperty(Oi(r),t.replace(Pv,""),"important"):n[r]=t}}const Rv=["Webkit","Moz","ms"],yf={};function uS(n,e){const t=yf[e];if(t)return t;let r=Tr(e);if(r!=="filter"&&r in n)return yf[e]=r;r=nh(r);for(let s=0;s<Rv.length;s++){const i=Rv[s]+r;if(i in n)return yf[e]=i}return e}const Cv="http://www.w3.org/1999/xlink";function kv(n,e,t,r,s,i=vx(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Cv,e.slice(6,e.length)):n.setAttributeNS(Cv,e,t):t==null||i&&!f0(t)?n.removeAttribute(e):n.setAttribute(e,i?"":ns(t)?String(t):t)}function Dv(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?pb(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=f0(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function ui(n,e,t,r){n.addEventListener(e,t,r)}function cS(n,e,t,r){n.removeEventListener(e,t,r)}const Nv=Symbol("_vei");function dS(n,e,t,r,s=null){const i=n[Nv]||(n[Nv]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=hS(e);if(r){const c=i[e]=mS(r,s);ui(n,a,c,l)}else o&&(cS(n,a,o,l),i[e]=void 0)}}const Vv=/(?:Once|Passive|Capture)$/;function hS(n){let e;if(Vv.test(n)){e={};let r;for(;r=n.match(Vv);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Oi(n.slice(2)),e]}let _f=0;const fS=Promise.resolve(),pS=()=>_f||(fS.then(()=>_f=0),_f=Date.now());function mS(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;rs(gS(r,t.value),e,5,[r])};return t.value=n,t.attached=pS(),t}function gS(n,e){if(Ue(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Ov=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,vS=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?iS(n,r,o):e==="style"?lS(n,t,r):eh(e)?zp(e)||dS(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):yS(n,e,r,o))?(Dv(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&kv(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!ln(r))?Dv(n,Tr(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),kv(n,e,r,o))};function yS(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Ov(e)&&Qe(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Ov(e)&&ln(t)?!1:e in n}const Da=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Ue(e)?t=>Zc(e,t):e};function _S(n){n.target.composing=!0}function Mv(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const xs=Symbol("_assign"),kt={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[xs]=Da(s);const i=r||s.props&&s.props.type==="number";ui(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=bd(a)),n[xs](a)}),t&&ui(n,"change",()=>{n.value=n.value.trim()}),e||(ui(n,"compositionstart",_S),ui(n,"compositionend",Mv),ui(n,"change",Mv))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[xs]=Da(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?bd(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},vi={deep:!0,created(n,e,t){n[xs]=Da(t),ui(n,"change",()=>{const r=n._modelValue,s=bu(n),i=n.checked,o=n[xs];if(Ue(r)){const a=Hp(r,s),l=a!==-1;if(i&&!l)o(r.concat(s));else if(!i&&l){const c=[...r];c.splice(a,1),o(c)}}else if(Xa(r)){const a=new Set(r);i?a.add(s):a.delete(s),o(a)}else o(gb(n,i))})},mounted:Lv,beforeUpdate(n,e,t){n[xs]=Da(t),Lv(n,e,t)}};function Lv(n,{value:e,oldValue:t},r){n._modelValue=e;let s;if(Ue(e))s=Hp(e,r.props.value)>-1;else if(Xa(e))s=e.has(r.props.value);else{if(e===t)return;s=Ku(e,gb(n,!0))}n.checked!==s&&(n.checked=s)}const bS={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const s=Xa(e);ui(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?bd(bu(o)):bu(o));n[xs](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,fn(()=>{n._assigning=!1})}),n[xs]=Da(r)},mounted(n,{value:e}){Fv(n,e)},beforeUpdate(n,e,t){n[xs]=Da(t)},updated(n,{value:e}){n._assigning||Fv(n,e)}};function Fv(n,e){const t=n.multiple,r=Ue(e);if(!(t&&!r&&!Xa(e))){for(let s=0,i=n.options.length;s<i;s++){const o=n.options[s],a=bu(o);if(t)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=Hp(e,a)>-1}else o.selected=e.has(a);else if(Ku(bu(o),e)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function bu(n){return"_value"in n?n._value:n.value}function gb(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const wS=["ctrl","shift","alt","meta"],IS={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>wS.some(t=>n[`${t}Key`]&&!e.includes(t))},Ft=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=IS[e[o]];if(a&&a(s,e))return}return n(s,...i)})},ES={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Mn=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Oi(s.key);if(e.some(o=>o===i||ES[o]===i))return n(s)})},TS=Tn({patchProp:vS},rS);let $v;function xS(){return $v||($v=SA(TS))}const AS=(...n)=>{const e=xS().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=PS(r);if(!s)return;const i=e._component;!Qe(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,SS(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function SS(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function PS(n){return ln(n)?document.querySelector(n):n}const RS={__name:"App",setup(n){const e=k(null),t=k(!1);function r(o){o.preventDefault(),e.value=o,t.value=!0}async function s(){e.value&&(e.value.prompt(),await e.value.userChoice,t.value=!1,e.value=null)}function i(){t.value=!1,e.value=null}return ir(()=>{window.addEventListener("beforeinstallprompt",r),window.addEventListener("appinstalled",i)}),G0(()=>{window.removeEventListener("beforeinstallprompt",r),window.removeEventListener("appinstalled",i)}),(o,a)=>{const l=cA("router-view");return L(),F(dt,null,[ct(l),t.value?(L(),F("button",{key:0,class:"fixed bottom-4 right-4 z-50 rounded-full bg-sky-600 text-white px-4 py-2 shadow-lg hover:bg-sky-700 active:bg-sky-800",onClick:s}," Installer l’app ")):ge("",!0)],64)}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const pa=typeof document<"u";function vb(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function CS(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&vb(n.default)}const vt=Object.assign;function bf(n,e){const t={};for(const r in e){const s=e[r];t[r]=Fr(s)?s.map(n):n(s)}return t}const au=()=>{},Fr=Array.isArray,yb=/#/g,kS=/&/g,DS=/\//g,NS=/=/g,VS=/\?/g,_b=/\+/g,OS=/%5B/g,MS=/%5D/g,bb=/%5E/g,LS=/%60/g,wb=/%7B/g,FS=/%7C/g,Ib=/%7D/g,$S=/%20/g;function lm(n){return encodeURI(""+n).replace(FS,"|").replace(OS,"[").replace(MS,"]")}function US(n){return lm(n).replace(wb,"{").replace(Ib,"}").replace(bb,"^")}function sp(n){return lm(n).replace(_b,"%2B").replace($S,"+").replace(yb,"%23").replace(kS,"%26").replace(LS,"`").replace(wb,"{").replace(Ib,"}").replace(bb,"^")}function jS(n){return sp(n).replace(NS,"%3D")}function BS(n){return lm(n).replace(yb,"%23").replace(VS,"%3F")}function qS(n){return n==null?"":BS(n).replace(DS,"%2F")}function wu(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const zS=/\/$/,KS=n=>n.replace(zS,"");function wf(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=QS(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:wu(o)}}function GS(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Uv(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function HS(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&Na(e.matched[r],t.matched[s])&&Eb(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Na(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function Eb(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!WS(n[t],e[t]))return!1;return!0}function WS(n,e){return Fr(n)?jv(n,e):Fr(e)?jv(e,n):n===e}function jv(n,e){return Fr(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function QS(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const ni={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Iu;(function(n){n.pop="pop",n.push="push"})(Iu||(Iu={}));var lu;(function(n){n.back="back",n.forward="forward",n.unknown=""})(lu||(lu={}));function JS(n){if(!n)if(pa){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),KS(n)}const YS=/^[^#]+#/;function XS(n,e){return n.replace(YS,"#")+e}function ZS(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const dh=()=>({left:window.scrollX,top:window.scrollY});function e1(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=ZS(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Bv(n,e){return(history.state?history.state.position-e:-1)+n}const ip=new Map;function t1(n,e){ip.set(n,e)}function n1(n){const e=ip.get(n);return ip.delete(n),e}let r1=()=>location.protocol+"//"+location.host;function Tb(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),Uv(l,"")}return Uv(t,n)+r+s}function s1(n,e,t,r){let s=[],i=[],o=null;const a=({state:g})=>{const y=Tb(n,location),T=t.value,A=e.value;let P=0;if(g){if(t.value=y,e.value=g,o&&o===T){o=null;return}P=A?g.position-A.position:0}else r(y);s.forEach(U=>{U(t.value,T,{delta:P,type:Iu.pop,direction:P?P>0?lu.forward:lu.back:lu.unknown})})};function l(){o=t.value}function c(g){s.push(g);const y=()=>{const T=s.indexOf(g);T>-1&&s.splice(T,1)};return i.push(y),y}function d(){const{history:g}=window;g.state&&g.replaceState(vt({},g.state,{scroll:dh()}),"")}function f(){for(const g of i)g();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function qv(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?dh():null}}function i1(n){const{history:e,location:t}=window,r={value:Tb(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,d){const f=n.indexOf("#"),g=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:r1()+n+l;try{e[d?"replaceState":"pushState"](c,"",g),s.value=c}catch(y){console.error(y),t[d?"replace":"assign"](g)}}function o(l,c){const d=vt({},e.state,qv(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,d,!0),r.value=l}function a(l,c){const d=vt({},s.value,e.state,{forward:l,scroll:dh()});i(d.current,d,!0);const f=vt({},qv(r.value,l,null),{position:d.position+1},c);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function o1(n){n=JS(n);const e=i1(n),t=s1(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=vt({location:"",base:n,go:r,createHref:XS.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function a1(n){return typeof n=="string"||n&&typeof n=="object"}function xb(n){return typeof n=="string"||typeof n=="symbol"}const Ab=Symbol("");var zv;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(zv||(zv={}));function Va(n,e){return vt(new Error,{type:n,[Ab]:!0},e)}function ms(n,e){return n instanceof Error&&Ab in n&&(e==null||!!(n.type&e))}const Kv="[^/]+?",l1={sensitive:!1,strict:!1,start:!0,end:!0},u1=/[.+*?^${}()[\]/\\]/g;function c1(n,e){const t=vt({},l1,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const d=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const g=c[f];let y=40+(t.sensitive?.25:0);if(g.type===0)f||(s+="/"),s+=g.value.replace(u1,"\\$&"),y+=40;else if(g.type===1){const{value:T,repeatable:A,optional:P,regexp:U}=g;i.push({name:T,repeatable:A,optional:P});const q=U||Kv;if(q!==Kv){y+=10;try{new RegExp(`(${q})`)}catch(z){throw new Error(`Invalid custom RegExp for param "${T}" (${q}): `+z.message)}}let M=A?`((?:${q})(?:/(?:${q}))*)`:`(${q})`;f||(M=P&&c.length<2?`(?:/${M})`:"/"+M),P&&(M+="?"),s+=M,y+=20,P&&(y+=-8),A&&(y+=-20),q===".*"&&(y+=-50)}d.push(y)}r.push(d)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const d=c.match(o),f={};if(!d)return null;for(let g=1;g<d.length;g++){const y=d[g]||"",T=i[g-1];f[T.name]=y&&T.repeatable?y.split("/"):y}return f}function l(c){let d="",f=!1;for(const g of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const y of g)if(y.type===0)d+=y.value;else if(y.type===1){const{value:T,repeatable:A,optional:P}=y,U=T in c?c[T]:"";if(Fr(U)&&!A)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const q=Fr(U)?U.join("/"):U;if(!q)if(P)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${T}"`);d+=q}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function d1(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Sb(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=d1(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(Gv(r))return 1;if(Gv(s))return-1}return s.length-r.length}function Gv(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const h1={type:0,value:""},f1=/[a-zA-Z0-9_]/;function p1(n){if(!n)return[[]];if(n==="/")return[[h1]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(y){throw new Error(`ERR (${t})/"${c}": ${y}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",d="";function f(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function g(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&f(),o()):l===":"?(f(),t=1):g();break;case 4:g(),t=r;break;case 1:l==="("?t=2:f1.test(l)?g():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:t=3:d+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),s}function m1(n,e,t){const r=c1(p1(n.path),t),s=vt(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function g1(n,e){const t=[],r=new Map;e=Jv({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,g,y){const T=!y,A=Wv(f);A.aliasOf=y&&y.record;const P=Jv(e,f),U=[A];if("alias"in f){const z=typeof f.alias=="string"?[f.alias]:f.alias;for(const he of z)U.push(Wv(vt({},A,{components:y?y.record.components:A.components,path:he,aliasOf:y?y.record:A})))}let q,M;for(const z of U){const{path:he}=z;if(g&&he[0]!=="/"){const pe=g.record.path,x=pe[pe.length-1]==="/"?"":"/";z.path=g.record.path+(he&&x+he)}if(q=m1(z,g,P),y?y.alias.push(q):(M=M||q,M!==q&&M.alias.push(q),T&&f.name&&!Qv(q)&&o(f.name)),Pb(q)&&l(q),A.children){const pe=A.children;for(let x=0;x<pe.length;x++)i(pe[x],q,y&&y.children[x])}y=y||q}return M?()=>{o(M)}:au}function o(f){if(xb(f)){const g=r.get(f);g&&(r.delete(f),t.splice(t.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=t.indexOf(f);g>-1&&(t.splice(g,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const g=_1(f,t);t.splice(g,0,f),f.record.name&&!Qv(f)&&r.set(f.record.name,f)}function c(f,g){let y,T={},A,P;if("name"in f&&f.name){if(y=r.get(f.name),!y)throw Va(1,{location:f});P=y.record.name,T=vt(Hv(g.params,y.keys.filter(M=>!M.optional).concat(y.parent?y.parent.keys.filter(M=>M.optional):[]).map(M=>M.name)),f.params&&Hv(f.params,y.keys.map(M=>M.name))),A=y.stringify(T)}else if(f.path!=null)A=f.path,y=t.find(M=>M.re.test(A)),y&&(T=y.parse(A),P=y.record.name);else{if(y=g.name?r.get(g.name):t.find(M=>M.re.test(g.path)),!y)throw Va(1,{location:f,currentLocation:g});P=y.record.name,T=vt({},g.params,f.params),A=y.stringify(T)}const U=[];let q=y;for(;q;)U.unshift(q.record),q=q.parent;return{name:P,path:A,params:T,matched:U,meta:y1(U)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function Hv(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function Wv(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:v1(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function v1(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function Qv(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function y1(n){return n.reduce((e,t)=>vt(e,t.meta),{})}function Jv(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function _1(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;Sb(n,e[i])<0?r=i:t=i+1}const s=b1(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function b1(n){let e=n;for(;e=e.parent;)if(Pb(e)&&Sb(n,e)===0)return e}function Pb({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function w1(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(_b," "),o=i.indexOf("="),a=wu(o<0?i:i.slice(0,o)),l=o<0?null:wu(i.slice(o+1));if(a in e){let c=e[a];Fr(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function Yv(n){let e="";for(let t in n){const r=n[t];if(t=jS(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Fr(r)?r.map(i=>i&&sp(i)):[r&&sp(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function I1(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Fr(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const E1=Symbol(""),Xv=Symbol(""),hh=Symbol(""),um=Symbol(""),op=Symbol("");function Ll(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function li(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=g=>{g===!1?l(Va(4,{from:t,to:e})):g instanceof Error?l(g):a1(g)?l(Va(2,{from:e,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),a())},d=i(()=>n.call(r&&r.instances[s],e,t,c));let f=Promise.resolve(d);n.length<3&&(f=f.then(c)),f.catch(g=>l(g))})}function If(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(vb(l)){const d=(l.__vccOpts||l)[e];d&&i.push(li(d,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=CS(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const y=(f.__vccOpts||f)[e];return y&&li(y,t,r,o,a,s)()}))}}return i}function Zv(n){const e=Lr(hh),t=Lr(um),r=Oe(()=>{const l=Xr(n.to);return e.resolve(l)}),s=Oe(()=>{const{matched:l}=r.value,{length:c}=l,d=l[c-1],f=t.matched;if(!d||!f.length)return-1;const g=f.findIndex(Na.bind(null,d));if(g>-1)return g;const y=ey(l[c-2]);return c>1&&ey(d)===y&&f[f.length-1].path!==y?f.findIndex(Na.bind(null,l[c-2])):g}),i=Oe(()=>s.value>-1&&P1(t.params,r.value.params)),o=Oe(()=>s.value>-1&&s.value===t.matched.length-1&&Eb(t.params,r.value.params));function a(l={}){if(S1(l)){const c=e[Xr(n.replace)?"replace":"push"](Xr(n.to)).catch(au);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:Oe(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function T1(n){return n.length===1?n[0]:n}const x1=B0({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Zv,setup(n,{slots:e}){const t=ih(Zv(n)),{options:r}=Lr(hh),s=Oe(()=>({[ty(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[ty(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&T1(e.default(t));return n.custom?i:fb("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),A1=x1;function S1(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function P1(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Fr(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function ey(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const ty=(n,e,t)=>n??e??t,R1=B0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Lr(op),s=Oe(()=>n.route||r.value),i=Lr(Xv,0),o=Oe(()=>{let c=Xr(i);const{matched:d}=s.value;let f;for(;(f=d[c])&&!f.components;)c++;return c}),a=Oe(()=>s.value.matched[o.value]);td(Xv,Oe(()=>o.value+1)),td(E1,a),td(op,s);const l=k();return xt(()=>[l.value,a.value,n.name],([c,d,f],[g,y,T])=>{d&&(d.instances[f]=c,y&&y!==d&&c&&c===g&&(d.leaveGuards.size||(d.leaveGuards=y.leaveGuards),d.updateGuards.size||(d.updateGuards=y.updateGuards))),c&&d&&(!y||!Na(d,y)||!g)&&(d.enterCallbacks[f]||[]).forEach(A=>A(c))},{flush:"post"}),()=>{const c=s.value,d=n.name,f=a.value,g=f&&f.components[d];if(!g)return ny(t.default,{Component:g,route:c});const y=f.props[d],T=y?y===!0?c.params:typeof y=="function"?y(c):y:null,P=fb(g,vt({},T,e,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(f.instances[d]=null)},ref:l}));return ny(t.default,{Component:P,route:c})||P}}});function ny(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const C1=R1;function k1(n){const e=g1(n.routes,n),t=n.parseQuery||w1,r=n.stringifyQuery||Yv,s=n.history,i=Ll(),o=Ll(),a=Ll(),l=Ux(ni);let c=ni;pa&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=bf.bind(null,D=>""+D),f=bf.bind(null,qS),g=bf.bind(null,wu);function y(D,$){let X,se;return xb(D)?(X=e.getRecordMatcher(D),se=$):se=D,e.addRoute(se,X)}function T(D){const $=e.getRecordMatcher(D);$&&e.removeRoute($)}function A(){return e.getRoutes().map(D=>D.record)}function P(D){return!!e.getRecordMatcher(D)}function U(D,$){if($=vt({},$||l.value),typeof D=="string"){const S=wf(t,D,$.path),O=e.resolve({path:S.path},$),oe=s.createHref(S.fullPath);return vt(S,O,{params:g(O.params),hash:wu(S.hash),redirectedFrom:void 0,href:oe})}let X;if(D.path!=null)X=vt({},D,{path:wf(t,D.path,$.path).path});else{const S=vt({},D.params);for(const O in S)S[O]==null&&delete S[O];X=vt({},D,{params:f(S)}),$.params=f($.params)}const se=e.resolve(X,$),ke=D.hash||"";se.params=d(g(se.params));const $e=GS(r,vt({},D,{hash:US(ke),path:se.path})),E=s.createHref($e);return vt({fullPath:$e,hash:ke,query:r===Yv?I1(D.query):D.query||{}},se,{redirectedFrom:void 0,href:E})}function q(D){return typeof D=="string"?wf(t,D,l.value.path):vt({},D)}function M(D,$){if(c!==D)return Va(8,{from:$,to:D})}function z(D){return x(D)}function he(D){return z(vt(q(D),{replace:!0}))}function pe(D){const $=D.matched[D.matched.length-1];if($&&$.redirect){const{redirect:X}=$;let se=typeof X=="function"?X(D):X;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=q(se):{path:se},se.params={}),vt({query:D.query,hash:D.hash,params:se.path!=null?{}:D.params},se)}}function x(D,$){const X=c=U(D),se=l.value,ke=D.state,$e=D.force,E=D.replace===!0,S=pe(X);if(S)return x(vt(q(S),{state:typeof S=="object"?vt({},ke,S.state):ke,force:$e,replace:E}),$||X);const O=X;O.redirectedFrom=$;let oe;return!$e&&HS(r,se,X)&&(oe=Va(16,{to:O,from:se}),Ge(se,se,!0,!1)),(oe?Promise.resolve(oe):C(O,se)).catch(Z=>ms(Z)?ms(Z,2)?Z:Be(Z):ne(Z,O,se)).then(Z=>{if(Z){if(ms(Z,2))return x(vt({replace:E},q(Z.to),{state:typeof Z.to=="object"?vt({},ke,Z.to.state):ke,force:$e}),$||O)}else Z=B(O,se,!0,E,ke);return V(O,se,Z),Z})}function I(D,$){const X=M(D,$);return X?Promise.reject(X):Promise.resolve()}function w(D){const $=je.values().next().value;return $&&typeof $.runWithContext=="function"?$.runWithContext(D):D()}function C(D,$){let X;const[se,ke,$e]=D1(D,$);X=If(se.reverse(),"beforeRouteLeave",D,$);for(const S of se)S.leaveGuards.forEach(O=>{X.push(li(O,D,$))});const E=I.bind(null,D,$);return X.push(E),ht(X).then(()=>{X=[];for(const S of i.list())X.push(li(S,D,$));return X.push(E),ht(X)}).then(()=>{X=If(ke,"beforeRouteUpdate",D,$);for(const S of ke)S.updateGuards.forEach(O=>{X.push(li(O,D,$))});return X.push(E),ht(X)}).then(()=>{X=[];for(const S of $e)if(S.beforeEnter)if(Fr(S.beforeEnter))for(const O of S.beforeEnter)X.push(li(O,D,$));else X.push(li(S.beforeEnter,D,$));return X.push(E),ht(X)}).then(()=>(D.matched.forEach(S=>S.enterCallbacks={}),X=If($e,"beforeRouteEnter",D,$,w),X.push(E),ht(X))).then(()=>{X=[];for(const S of o.list())X.push(li(S,D,$));return X.push(E),ht(X)}).catch(S=>ms(S,8)?S:Promise.reject(S))}function V(D,$,X){a.list().forEach(se=>w(()=>se(D,$,X)))}function B(D,$,X,se,ke){const $e=M(D,$);if($e)return $e;const E=$===ni,S=pa?history.state:{};X&&(se||E?s.replace(D.fullPath,vt({scroll:E&&S&&S.scroll},ke)):s.push(D.fullPath,ke)),l.value=D,Ge(D,$,X,E),Be()}let R;function wt(){R||(R=s.listen((D,$,X)=>{if(!Xe.listening)return;const se=U(D),ke=pe(se);if(ke){x(vt(ke,{replace:!0,force:!0}),se).catch(au);return}c=se;const $e=l.value;pa&&t1(Bv($e.fullPath,X.delta),dh()),C(se,$e).catch(E=>ms(E,12)?E:ms(E,2)?(x(vt(q(E.to),{force:!0}),se).then(S=>{ms(S,20)&&!X.delta&&X.type===Iu.pop&&s.go(-1,!1)}).catch(au),Promise.reject()):(X.delta&&s.go(-X.delta,!1),ne(E,se,$e))).then(E=>{E=E||B(se,$e,!1),E&&(X.delta&&!ms(E,8)?s.go(-X.delta,!1):X.type===Iu.pop&&ms(E,20)&&s.go(-1,!1)),V(se,$e,E)}).catch(au)}))}let gt=Ll(),Y=Ll(),j;function ne(D,$,X){Be(D);const se=Y.list();return se.length?se.forEach(ke=>ke(D,$,X)):console.error(D),Promise.reject(D)}function Ke(){return j&&l.value!==ni?Promise.resolve():new Promise((D,$)=>{gt.add([D,$])})}function Be(D){return j||(j=!D,wt(),gt.list().forEach(([$,X])=>D?X(D):$()),gt.reset()),D}function Ge(D,$,X,se){const{scrollBehavior:ke}=n;if(!pa||!ke)return Promise.resolve();const $e=!X&&n1(Bv(D.fullPath,0))||(se||!X)&&history.state&&history.state.scroll||null;return fn().then(()=>ke(D,$,$e)).then(E=>E&&e1(E)).catch(E=>ne(E,D,$))}const re=D=>s.go(D);let ee;const je=new Set,Xe={currentRoute:l,listening:!0,addRoute:y,removeRoute:T,clearRoutes:e.clearRoutes,hasRoute:P,getRoutes:A,resolve:U,options:n,push:z,replace:he,go:re,back:()=>re(-1),forward:()=>re(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Y.add,isReady:Ke,install(D){const $=this;D.component("RouterLink",A1),D.component("RouterView",C1),D.config.globalProperties.$router=$,Object.defineProperty(D.config.globalProperties,"$route",{enumerable:!0,get:()=>Xr(l)}),pa&&!ee&&l.value===ni&&(ee=!0,z(s.location).catch(ke=>{}));const X={};for(const ke in ni)Object.defineProperty(X,ke,{get:()=>l.value[ke],enumerable:!0});D.provide(hh,$),D.provide(um,C0(X)),D.provide(op,l);const se=D.unmount;je.add(D),D.unmount=function(){je.delete(D),je.size<1&&(c=ni,R&&R(),R=null,l.value=ni,ee=!1,j=!1),se()}}};function ht(D){return D.reduce(($,X)=>$.then(()=>w(X)),Promise.resolve())}return Xe}function D1(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>Na(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>Na(c,l))||s.push(l))}return[t,r,s]}function Wu(){return Lr(hh)}function Za(n){return Lr(um)}const N1="modulepreload",V1=function(n){return"/"+n},ry={},Xt=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=V1(i),i in ry)return;ry[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":N1,o||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),o)return new Promise((d,f)=>{c.addEventListener("load",d),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function O1(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=n;let a,l;const c=async(f=!0)=>{await l};async function d(){if("serviceWorker"in navigator){const{Workbox:f}=await Xt(()=>import("./workbox-window.prod.es5-5ffdab76.js"),[]);a=new f("/service-worker.js",{scope:"/",type:"classic"}),a.addEventListener("activated",g=>{(g.isUpdate||g.isExternal)&&window.location.reload()}),a.addEventListener("installed",g=>{g.isUpdate||r==null||r()}),a.register({immediate:e}).then(g=>{i?i("/service-worker.js",g):s==null||s(g)}).catch(g=>{o==null||o(g)})}}return l=d(),c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},M1=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Cb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let g=(a&15)<<2|c>>6,y=c&63;l||(y=64,o||(g=64)),r.push(t[d],t[f],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Rb(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):M1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new L1;const g=i<<2|a>>4;if(r.push(g),c!==64){const y=a<<4&240|c>>2;if(r.push(y),f!==64){const T=c<<6&192|f;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class L1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F1=function(n){const e=Rb(n);return Cb.encodeByteArray(e,!0)},Cd=function(n){return F1(n).replace(/\./g,"")},kb=function(n){try{return Cb.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1=()=>$1().__FIREBASE_DEFAULTS__,j1=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},B1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&kb(n[1]);return e&&JSON.parse(e)},fh=()=>{try{return U1()||j1()||B1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Db=n=>{var e,t;return(t=(e=fh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},q1=n=>{const e=Db(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Nb=()=>{var n;return(n=fh())===null||n===void 0?void 0:n.config},Vb=n=>{var e;return(e=fh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Cd(JSON.stringify(t)),Cd(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function G1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vn())}function H1(){var n;const e=(n=fh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function W1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q1(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function J1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y1(){const n=vn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Ob(){return!H1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cm(){try{return typeof indexedDB=="object"}catch{return!1}}function Mb(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}function X1(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="FirebaseError";class os extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Z1,Object.setPrototypeOf(this,os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lo.prototype.create)}}class Lo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?eP(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new os(s,a,r)}}function eP(n,e){return n.replace(tP,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const tP=/\{\$([^}]+)}/g;function nP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ai(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(sy(i)&&sy(o)){if(!Ai(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function sy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Gl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Hl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function rP(n,e){const t=new sP(n,e);return t.subscribe.bind(t)}class sP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");iP(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Ef),s.error===void 0&&(s.error=Ef),s.complete===void 0&&(s.complete=Ef);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function iP(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ef(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(n){return n&&n._delegate?n._delegate:n}class $r{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new z1;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lP(e))try{this.getOrInitializeService({instanceIdentifier:lo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=lo){return this.instances.has(e)}getOptions(e=lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aP(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=lo){return this.component?this.component.multipleInstances?e:lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aP(n){return n===lo?void 0:n}function lP(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(st||(st={}));const cP={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},dP=st.INFO,hP={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},fP=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=hP[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dm{constructor(e){this.name=e,this._logLevel=dP,this._logHandler=fP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in st))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...e),this._logHandler(this,st.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...e),this._logHandler(this,st.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,st.INFO,...e),this._logHandler(this,st.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,st.WARN,...e),this._logHandler(this,st.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...e),this._logHandler(this,st.ERROR,...e)}}const pP=(n,e)=>e.some(t=>n instanceof t);let iy,oy;function mP(){return iy||(iy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gP(){return oy||(oy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lb=new WeakMap,ap=new WeakMap,Fb=new WeakMap,Tf=new WeakMap,hm=new WeakMap;function vP(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(As(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Lb.set(t,n)}).catch(()=>{}),hm.set(e,n),e}function yP(n){if(ap.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});ap.set(n,e)}let lp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ap.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Fb.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return As(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _P(n){lp=n(lp)}function bP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(xf(this),e,...t);return Fb.set(r,e.sort?e.sort():[e]),As(r)}:gP().includes(n)?function(...e){return n.apply(xf(this),e),As(Lb.get(this))}:function(...e){return As(n.apply(xf(this),e))}}function wP(n){return typeof n=="function"?bP(n):(n instanceof IDBTransaction&&yP(n),pP(n,mP())?new Proxy(n,lp):n)}function As(n){if(n instanceof IDBRequest)return vP(n);if(Tf.has(n))return Tf.get(n);const e=wP(n);return e!==n&&(Tf.set(n,e),hm.set(e,n)),e}const xf=n=>hm.get(n);function ph(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=As(o);return r&&o.addEventListener("upgradeneeded",l=>{r(As(o.result),l.oldVersion,l.newVersion,As(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function Af(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),As(t).then(()=>{})}const IP=["get","getKey","getAll","getAllKeys","count"],EP=["put","add","delete","clear"],Sf=new Map;function ay(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Sf.get(e))return Sf.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=EP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||IP.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Sf.set(e,i),i}_P(n=>({...n,get:(e,t,r)=>ay(e,t)||n.get(e,t,r),has:(e,t)=>!!ay(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(xP(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function xP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const up="@firebase/app",ly="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new dm("@firebase/app"),AP="@firebase/app-compat",SP="@firebase/analytics-compat",PP="@firebase/analytics",RP="@firebase/app-check-compat",CP="@firebase/app-check",kP="@firebase/auth",DP="@firebase/auth-compat",NP="@firebase/database",VP="@firebase/data-connect",OP="@firebase/database-compat",MP="@firebase/functions",LP="@firebase/functions-compat",FP="@firebase/installations",$P="@firebase/installations-compat",UP="@firebase/messaging",jP="@firebase/messaging-compat",BP="@firebase/performance",qP="@firebase/performance-compat",zP="@firebase/remote-config",KP="@firebase/remote-config-compat",GP="@firebase/storage",HP="@firebase/storage-compat",WP="@firebase/firestore",QP="@firebase/vertexai-preview",JP="@firebase/firestore-compat",YP="firebase",XP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd="[DEFAULT]",ZP={[up]:"fire-core",[AP]:"fire-core-compat",[PP]:"fire-analytics",[SP]:"fire-analytics-compat",[CP]:"fire-app-check",[RP]:"fire-app-check-compat",[kP]:"fire-auth",[DP]:"fire-auth-compat",[NP]:"fire-rtdb",[VP]:"fire-data-connect",[OP]:"fire-rtdb-compat",[MP]:"fire-fn",[LP]:"fire-fn-compat",[FP]:"fire-iid",[$P]:"fire-iid-compat",[UP]:"fire-fcm",[jP]:"fire-fcm-compat",[BP]:"fire-perf",[qP]:"fire-perf-compat",[zP]:"fire-rc",[KP]:"fire-rc-compat",[GP]:"fire-gcs",[HP]:"fire-gcs-compat",[WP]:"fire-fst",[JP]:"fire-fst-compat",[QP]:"fire-vertex","fire-js":"fire-js",[YP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd=new Map,eR=new Map,cp=new Map;function uy(n,e){try{n.container.addComponent(e)}catch(t){Cs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ss(n){const e=n.name;if(cp.has(e))return Cs.debug(`There were multiple attempts to register component ${e}.`),!1;cp.set(e,n);for(const t of Dd.values())uy(t,n);for(const t of eR.values())uy(t,n);return!0}function Mi(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function tR(n,e,t=kd){Mi(n,e).clearInstance(t)}function sn(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bi=new Lo("app","Firebase",nR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=XP;function $b(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:kd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw bi.create("bad-app-name",{appName:String(s)});if(t||(t=Nb()),!t)throw bi.create("no-options");const i=Dd.get(s);if(i){if(Ai(t,i.options)&&Ai(r,i.config))return i;throw bi.create("duplicate-app",{appName:s})}const o=new uP(s);for(const l of cp.values())o.addComponent(l);const a=new rR(t,r,o);return Dd.set(s,a),a}function fm(n=kd){const e=Dd.get(n);if(!e&&n===kd&&Nb())return $b();if(!e)throw bi.create("no-app",{appName:n});return e}function Er(n,e,t){var r;let s=(r=ZP[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cs.warn(a.join(" "));return}ss(new $r(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR="firebase-heartbeat-database",iR=1,Eu="firebase-heartbeat-store";let Pf=null;function Ub(){return Pf||(Pf=ph(sR,iR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Eu)}catch(t){console.warn(t)}}}}).catch(n=>{throw bi.create("idb-open",{originalErrorMessage:n.message})})),Pf}async function oR(n){try{const t=(await Ub()).transaction(Eu),r=await t.objectStore(Eu).get(jb(n));return await t.done,r}catch(e){if(e instanceof os)Cs.warn(e.message);else{const t=bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cs.warn(t.message)}}}async function cy(n,e){try{const r=(await Ub()).transaction(Eu,"readwrite");await r.objectStore(Eu).put(e,jb(n)),await r.done}catch(t){if(t instanceof os)Cs.warn(t.message);else{const r=bi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Cs.warn(r.message)}}}function jb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=1024,lR=30*24*60*60*1e3;class uR{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new dR(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=dy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=lR}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Cs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=dy(),{heartbeatsToSend:r,unsentEntries:s}=cR(this._heartbeatsCache.heartbeats),i=Cd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Cs.warn(t),""}}}function dy(){return new Date().toISOString().substring(0,10)}function cR(n,e=aR){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),hy(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),hy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class dR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cm()?Mb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oR(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return cy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return cy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function hy(n){return Cd(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){ss(new $r("platform-logger",e=>new TP(e),"PRIVATE")),ss(new $r("heartbeat",e=>new uR(e),"PRIVATE")),Er(up,ly,n),Er(up,ly,"esm2017"),Er("fire-js","")}hR("");var fR="firebase",pR="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er(fR,pR,"app");var fy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wo,Bb;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,I){function w(){}w.prototype=I.prototype,x.D=I.prototype,x.prototype=new w,x.prototype.constructor=x,x.C=function(C,V,B){for(var R=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)R[wt-2]=arguments[wt];return I.prototype[V].apply(C,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,I,w){w||(w=0);var C=Array(16);if(typeof I=="string")for(var V=0;16>V;++V)C[V]=I.charCodeAt(w++)|I.charCodeAt(w++)<<8|I.charCodeAt(w++)<<16|I.charCodeAt(w++)<<24;else for(V=0;16>V;++V)C[V]=I[w++]|I[w++]<<8|I[w++]<<16|I[w++]<<24;I=x.g[0],w=x.g[1],V=x.g[2];var B=x.g[3],R=I+(B^w&(V^B))+C[0]+3614090360&4294967295;I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[1]+3905402710&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[2]+606105819&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[3]+3250441966&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(B^w&(V^B))+C[4]+4118548399&4294967295,I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[5]+1200080426&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[6]+2821735955&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[7]+4249261313&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(B^w&(V^B))+C[8]+1770035416&4294967295,I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[9]+2336552879&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[10]+4294925233&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[11]+2304563134&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(B^w&(V^B))+C[12]+1804603682&4294967295,I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[13]+4254626195&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[14]+2792965006&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[15]+1236535329&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(V^B&(w^V))+C[1]+4129170786&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[6]+3225465664&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[11]+643717713&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[0]+3921069994&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(V^B&(w^V))+C[5]+3593408605&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[10]+38016083&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[15]+3634488961&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[4]+3889429448&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(V^B&(w^V))+C[9]+568446438&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[14]+3275163606&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[3]+4107603335&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[8]+1163531501&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(V^B&(w^V))+C[13]+2850285829&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[2]+4243563512&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[7]+1735328473&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[12]+2368359562&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(w^V^B)+C[5]+4294588738&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[8]+2272392833&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[11]+1839030562&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[14]+4259657740&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(w^V^B)+C[1]+2763975236&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[4]+1272893353&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[7]+4139469664&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[10]+3200236656&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(w^V^B)+C[13]+681279174&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[0]+3936430074&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[3]+3572445317&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[6]+76029189&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(w^V^B)+C[9]+3654602809&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[12]+3873151461&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[15]+530742520&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[2]+3299628645&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(V^(w|~B))+C[0]+4096336452&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[7]+1126891415&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[14]+2878612391&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[5]+4237533241&4294967295,w=V+(R<<21&4294967295|R>>>11),R=I+(V^(w|~B))+C[12]+1700485571&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[3]+2399980690&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[10]+4293915773&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[1]+2240044497&4294967295,w=V+(R<<21&4294967295|R>>>11),R=I+(V^(w|~B))+C[8]+1873313359&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[15]+4264355552&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[6]+2734768916&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[13]+1309151649&4294967295,w=V+(R<<21&4294967295|R>>>11),R=I+(V^(w|~B))+C[4]+4149444226&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[11]+3174756917&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[2]+718787259&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+I&4294967295,x.g[1]=x.g[1]+(V+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+V&4294967295,x.g[3]=x.g[3]+B&4294967295}r.prototype.u=function(x,I){I===void 0&&(I=x.length);for(var w=I-this.blockSize,C=this.B,V=this.h,B=0;B<I;){if(V==0)for(;B<=w;)s(this,x,B),B+=this.blockSize;if(typeof x=="string"){for(;B<I;)if(C[V++]=x.charCodeAt(B++),V==this.blockSize){s(this,C),V=0;break}}else for(;B<I;)if(C[V++]=x[B++],V==this.blockSize){s(this,C),V=0;break}}this.h=V,this.o+=I},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var I=1;I<x.length-8;++I)x[I]=0;var w=8*this.o;for(I=x.length-8;I<x.length;++I)x[I]=w&255,w/=256;for(this.u(x),x=Array(16),I=w=0;4>I;++I)for(var C=0;32>C;C+=8)x[w++]=this.g[I]>>>C&255;return x};function i(x,I){var w=a;return Object.prototype.hasOwnProperty.call(w,x)?w[x]:w[x]=I(x)}function o(x,I){this.h=I;for(var w=[],C=!0,V=x.length-1;0<=V;V--){var B=x[V]|0;C&&B==I||(w[V]=B,C=!1)}this.g=w}var a={};function l(x){return-128<=x&&128>x?i(x,function(I){return new o([I|0],0>I?-1:0)}):new o([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return P(c(-x));for(var I=[],w=1,C=0;x>=w;C++)I[C]=x/w|0,w*=4294967296;return new o(I,0)}function d(x,I){if(x.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(x.charAt(0)=="-")return P(d(x.substring(1),I));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(I,8)),C=f,V=0;V<x.length;V+=8){var B=Math.min(8,x.length-V),R=parseInt(x.substring(V,V+B),I);8>B?(B=c(Math.pow(I,B)),C=C.j(B).add(c(R))):(C=C.j(w),C=C.add(c(R)))}return C}var f=l(0),g=l(1),y=l(16777216);n=o.prototype,n.m=function(){if(A(this))return-P(this).m();for(var x=0,I=1,w=0;w<this.g.length;w++){var C=this.i(w);x+=(0<=C?C:4294967296+C)*I,I*=4294967296}return x},n.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(T(this))return"0";if(A(this))return"-"+P(this).toString(x);for(var I=c(Math.pow(x,6)),w=this,C="";;){var V=z(w,I).g;w=U(w,V.j(I));var B=((0<w.g.length?w.g[0]:w.h)>>>0).toString(x);if(w=V,T(w))return B+C;for(;6>B.length;)B="0"+B;C=B+C}},n.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function T(x){if(x.h!=0)return!1;for(var I=0;I<x.g.length;I++)if(x.g[I]!=0)return!1;return!0}function A(x){return x.h==-1}n.l=function(x){return x=U(this,x),A(x)?-1:T(x)?0:1};function P(x){for(var I=x.g.length,w=[],C=0;C<I;C++)w[C]=~x.g[C];return new o(w,~x.h).add(g)}n.abs=function(){return A(this)?P(this):this},n.add=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0,V=0;V<=I;V++){var B=C+(this.i(V)&65535)+(x.i(V)&65535),R=(B>>>16)+(this.i(V)>>>16)+(x.i(V)>>>16);C=R>>>16,B&=65535,R&=65535,w[V]=R<<16|B}return new o(w,w[w.length-1]&-2147483648?-1:0)};function U(x,I){return x.add(P(I))}n.j=function(x){if(T(this)||T(x))return f;if(A(this))return A(x)?P(this).j(P(x)):P(P(this).j(x));if(A(x))return P(this.j(P(x)));if(0>this.l(y)&&0>x.l(y))return c(this.m()*x.m());for(var I=this.g.length+x.g.length,w=[],C=0;C<2*I;C++)w[C]=0;for(C=0;C<this.g.length;C++)for(var V=0;V<x.g.length;V++){var B=this.i(C)>>>16,R=this.i(C)&65535,wt=x.i(V)>>>16,gt=x.i(V)&65535;w[2*C+2*V]+=R*gt,q(w,2*C+2*V),w[2*C+2*V+1]+=B*gt,q(w,2*C+2*V+1),w[2*C+2*V+1]+=R*wt,q(w,2*C+2*V+1),w[2*C+2*V+2]+=B*wt,q(w,2*C+2*V+2)}for(C=0;C<I;C++)w[C]=w[2*C+1]<<16|w[2*C];for(C=I;C<2*I;C++)w[C]=0;return new o(w,0)};function q(x,I){for(;(x[I]&65535)!=x[I];)x[I+1]+=x[I]>>>16,x[I]&=65535,I++}function M(x,I){this.g=x,this.h=I}function z(x,I){if(T(I))throw Error("division by zero");if(T(x))return new M(f,f);if(A(x))return I=z(P(x),I),new M(P(I.g),P(I.h));if(A(I))return I=z(x,P(I)),new M(P(I.g),I.h);if(30<x.g.length){if(A(x)||A(I))throw Error("slowDivide_ only works with positive integers.");for(var w=g,C=I;0>=C.l(x);)w=he(w),C=he(C);var V=pe(w,1),B=pe(C,1);for(C=pe(C,2),w=pe(w,2);!T(C);){var R=B.add(C);0>=R.l(x)&&(V=V.add(w),B=R),C=pe(C,1),w=pe(w,1)}return I=U(x,V.j(I)),new M(V,I)}for(V=f;0<=x.l(I);){for(w=Math.max(1,Math.floor(x.m()/I.m())),C=Math.ceil(Math.log(w)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),B=c(w),R=B.j(I);A(R)||0<R.l(x);)w-=C,B=c(w),R=B.j(I);T(B)&&(B=g),V=V.add(B),x=U(x,R)}return new M(V,x)}n.A=function(x){return z(this,x).h},n.and=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0;C<I;C++)w[C]=this.i(C)&x.i(C);return new o(w,this.h&x.h)},n.or=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0;C<I;C++)w[C]=this.i(C)|x.i(C);return new o(w,this.h|x.h)},n.xor=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0;C<I;C++)w[C]=this.i(C)^x.i(C);return new o(w,this.h^x.h)};function he(x){for(var I=x.g.length+1,w=[],C=0;C<I;C++)w[C]=x.i(C)<<1|x.i(C-1)>>>31;return new o(w,x.h)}function pe(x,I){var w=I>>5;I%=32;for(var C=x.g.length-w,V=[],B=0;B<C;B++)V[B]=0<I?x.i(B+w)>>>I|x.i(B+w+1)<<32-I:x.i(B+w);return new o(V,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Bb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,wo=o}).apply(typeof fy<"u"?fy:typeof self<"u"?self:typeof window<"u"?window:{});var qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qb,Wl,zb,id,dp,Kb,Gb,Hb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,v){return u==Array.prototype||u==Object.prototype||(u[p]=v.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof qc=="object"&&qc];for(var p=0;p<u.length;++p){var v=u[p];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=t(this);function s(u,p){if(p)e:{var v=r;u=u.split(".");for(var b=0;b<u.length-1;b++){var K=u[b];if(!(K in v))break e;v=v[K]}u=u[u.length-1],b=v[u],p=p(b),p!=b&&p!=null&&e(v,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var v=0,b=!1,K={next:function(){if(!b&&v<u.length){var W=v++;return{value:p(W,u[W]),done:!1}}return b=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function d(u,p,v){return u.call.apply(u.bind,arguments)}function f(u,p,v){if(!u)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,b),u.apply(p,K)}}return function(){return u.apply(p,arguments)}}function g(u,p,v){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function y(u,p){var v=Array.prototype.slice.call(arguments,1);return function(){var b=v.slice();return b.push.apply(b,arguments),u.apply(this,b)}}function T(u,p){function v(){}v.prototype=p.prototype,u.aa=p.prototype,u.prototype=new v,u.prototype.constructor=u,u.Qb=function(b,K,W){for(var Ie=Array(arguments.length-2),It=2;It<arguments.length;It++)Ie[It-2]=arguments[It];return p.prototype[K].apply(b,Ie)}}function A(u){const p=u.length;if(0<p){const v=Array(p);for(let b=0;b<p;b++)v[b]=u[b];return v}return[]}function P(u,p){for(let v=1;v<arguments.length;v++){const b=arguments[v];if(l(b)){const K=u.length||0,W=b.length||0;u.length=K+W;for(let Ie=0;Ie<W;Ie++)u[K+Ie]=b[Ie]}else u.push(b)}}class U{constructor(p,v){this.i=p,this.j=v,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function q(u){return/^[\s\xa0]*$/.test(u)}function M(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function z(u){return z[" "](u),u}z[" "]=function(){};var he=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function pe(u,p,v){for(const b in u)p.call(v,u[b],b,u)}function x(u,p){for(const v in u)p.call(void 0,u[v],v,u)}function I(u){const p={};for(const v in u)p[v]=u[v];return p}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let v,b;for(let K=1;K<arguments.length;K++){b=arguments[K];for(v in b)u[v]=b[v];for(let W=0;W<w.length;W++)v=w[W],Object.prototype.hasOwnProperty.call(b,v)&&(u[v]=b[v])}}function V(u){var p=1;u=u.split(":");const v=[];for(;0<p&&u.length;)v.push(u.shift()),p--;return u.length&&v.push(u.join(":")),v}function B(u){a.setTimeout(()=>{throw u},0)}function R(){var u=Ke;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class wt{constructor(){this.h=this.g=null}add(p,v){const b=gt.get();b.set(p,v),this.h?this.h.next=b:this.g=b,this.h=b}}var gt=new U(()=>new Y,u=>u.reset());class Y{constructor(){this.next=this.g=this.h=null}set(p,v){this.h=p,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let j,ne=!1,Ke=new wt,Be=()=>{const u=a.Promise.resolve(void 0);j=()=>{u.then(Ge)}};var Ge=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(v){B(v)}var p=gt;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ne=!1};function re(){this.s=this.s,this.C=this.C}re.prototype.s=!1,re.prototype.ma=function(){this.s||(this.s=!0,this.N())},re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var je=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const v=()=>{};a.addEventListener("test",v,p),a.removeEventListener("test",v,p)}catch{}return u}();function Xe(u,p){if(ee.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var v=this.type=u.type,b=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(he){e:{try{z(p.nodeName);var K=!0;break e}catch{}K=!1}K||(p=null)}}else v=="mouseover"?p=u.fromElement:v=="mouseout"&&(p=u.toElement);this.relatedTarget=p,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ht[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Xe.aa.h.call(this)}}T(Xe,ee);var ht={2:"touch",3:"pen",4:"mouse"};Xe.prototype.h=function(){Xe.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var D="closure_listenable_"+(1e6*Math.random()|0),$=0;function X(u,p,v,b,K){this.listener=u,this.proxy=null,this.src=p,this.type=v,this.capture=!!b,this.ha=K,this.key=++$,this.da=this.fa=!1}function se(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ke(u){this.src=u,this.g={},this.h=0}ke.prototype.add=function(u,p,v,b,K){var W=u.toString();u=this.g[W],u||(u=this.g[W]=[],this.h++);var Ie=E(u,p,b,K);return-1<Ie?(p=u[Ie],v||(p.fa=!1)):(p=new X(p,this.src,W,!!b,K),p.fa=v,u.push(p)),p};function $e(u,p){var v=p.type;if(v in u.g){var b=u.g[v],K=Array.prototype.indexOf.call(b,p,void 0),W;(W=0<=K)&&Array.prototype.splice.call(b,K,1),W&&(se(p),u.g[v].length==0&&(delete u.g[v],u.h--))}}function E(u,p,v,b){for(var K=0;K<u.length;++K){var W=u[K];if(!W.da&&W.listener==p&&W.capture==!!v&&W.ha==b)return K}return-1}var S="closure_lm_"+(1e6*Math.random()|0),O={};function oe(u,p,v,b,K){if(b&&b.once)return be(u,p,v,b,K);if(Array.isArray(p)){for(var W=0;W<p.length;W++)oe(u,p[W],v,b,K);return null}return v=De(v),u&&u[D]?u.K(p,v,c(b)?!!b.capture:!!b,K):Z(u,p,v,!1,b,K)}function Z(u,p,v,b,K,W){if(!p)throw Error("Invalid event type");var Ie=c(K)?!!K.capture:!!K,It=Te(u);if(It||(u[S]=It=new ke(u)),v=It.add(p,v,b,Ie,W),v.proxy)return v;if(b=ae(),v.proxy=b,b.src=u,b.listener=v,u.addEventListener)je||(K=Ie),K===void 0&&(K=!1),u.addEventListener(p.toString(),b,K);else if(u.attachEvent)u.attachEvent(fe(p.toString()),b);else if(u.addListener&&u.removeListener)u.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return v}function ae(){function u(v){return p.call(u.src,u.listener,v)}const p=Ae;return u}function be(u,p,v,b,K){if(Array.isArray(p)){for(var W=0;W<p.length;W++)be(u,p[W],v,b,K);return null}return v=De(v),u&&u[D]?u.L(p,v,c(b)?!!b.capture:!!b,K):Z(u,p,v,!0,b,K)}function ve(u,p,v,b,K){if(Array.isArray(p))for(var W=0;W<p.length;W++)ve(u,p[W],v,b,K);else b=c(b)?!!b.capture:!!b,v=De(v),u&&u[D]?(u=u.i,p=String(p).toString(),p in u.g&&(W=u.g[p],v=E(W,v,b,K),-1<v&&(se(W[v]),Array.prototype.splice.call(W,v,1),W.length==0&&(delete u.g[p],u.h--)))):u&&(u=Te(u))&&(p=u.g[p.toString()],u=-1,p&&(u=E(p,v,b,K)),(v=-1<u?p[u]:null)&&ye(v))}function ye(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[D])$e(p.i,u);else{var v=u.type,b=u.proxy;p.removeEventListener?p.removeEventListener(v,b,u.capture):p.detachEvent?p.detachEvent(fe(v),b):p.addListener&&p.removeListener&&p.removeListener(b),(v=Te(p))?($e(v,u),v.h==0&&(v.src=null,p[S]=null)):se(u)}}}function fe(u){return u in O?O[u]:O[u]="on"+u}function Ae(u,p){if(u.da)u=!0;else{p=new Xe(p,this);var v=u.listener,b=u.ha||u.src;u.fa&&ye(u),u=v.call(b,p)}return u}function Te(u){return u=u[S],u instanceof ke?u:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(u){return typeof u=="function"?u:(u[Pe]||(u[Pe]=function(p){return u.handleEvent(p)}),u[Pe])}function Le(){re.call(this),this.i=new ke(this),this.M=this,this.F=null}T(Le,re),Le.prototype[D]=!0,Le.prototype.removeEventListener=function(u,p,v,b){ve(this,u,p,v,b)};function He(u,p){var v,b=u.F;if(b)for(v=[];b;b=b.F)v.push(b);if(u=u.M,b=p.type||p,typeof p=="string")p=new ee(p,u);else if(p instanceof ee)p.target=p.target||u;else{var K=p;p=new ee(b,u),C(p,K)}if(K=!0,v)for(var W=v.length-1;0<=W;W--){var Ie=p.g=v[W];K=Ze(Ie,b,!0,p)&&K}if(Ie=p.g=u,K=Ze(Ie,b,!0,p)&&K,K=Ze(Ie,b,!1,p)&&K,v)for(W=0;W<v.length;W++)Ie=p.g=v[W],K=Ze(Ie,b,!1,p)&&K}Le.prototype.N=function(){if(Le.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var v=u.g[p],b=0;b<v.length;b++)se(v[b]);delete u.g[p],u.h--}}this.F=null},Le.prototype.K=function(u,p,v,b){return this.i.add(String(u),p,!1,v,b)},Le.prototype.L=function(u,p,v,b){return this.i.add(String(u),p,!0,v,b)};function Ze(u,p,v,b){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var K=!0,W=0;W<p.length;++W){var Ie=p[W];if(Ie&&!Ie.da&&Ie.capture==v){var It=Ie.listener,cn=Ie.ha||Ie.src;Ie.fa&&$e(u.i,Ie),K=It.call(cn,b)!==!1&&K}}return K&&!b.defaultPrevented}function Yt(u,p,v){if(typeof u=="function")v&&(u=g(u,v));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function Bt(u){u.g=Yt(()=>{u.g=null,u.i&&(u.i=!1,Bt(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class _n extends re{constructor(p,v){super(),this.m=p,this.l=v,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Bt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(u){re.call(this),this.h=u,this.g={}}T(Mt,re);var mr=[];function Ur(u){pe(u.g,function(p,v){this.g.hasOwnProperty(v)&&ye(p)},u),u.g={}}Mt.prototype.N=function(){Mt.aa.N.call(this),Ur(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var un=a.JSON.stringify,Cn=a.JSON.parse,qi=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function yl(){}yl.prototype.h=null;function vc(u){return u.h||(u.h=u.i())}function yc(){}var zi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _l(){ee.call(this,"d")}T(_l,ee);function Sr(){ee.call(this,"c")}T(Sr,ee);var er={},Pr=null;function Rr(){return Pr=Pr||new Le}er.La="serverreachability";function Cr(u){ee.call(this,er.La,u)}T(Cr,ee);function qs(u){const p=Rr();He(p,new Cr(p))}er.STAT_EVENT="statevent";function Ki(u,p){ee.call(this,er.STAT_EVENT,u),this.stat=p}T(Ki,ee);function tn(u){const p=Rr();He(p,new Ki(p,u))}er.Ma="timingevent";function _c(u,p){ee.call(this,er.Ma,u),this.size=p}T(_c,ee);function kn(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function zs(){this.g=!0}zs.prototype.xa=function(){this.g=!1};function bc(u,p,v,b,K,W){u.info(function(){if(u.g)if(W)for(var Ie="",It=W.split("&"),cn=0;cn<It.length;cn++){var lt=It[cn].split("=");if(1<lt.length){var dn=lt[0];lt=lt[1];var gn=dn.split("_");Ie=2<=gn.length&&gn[1]=="type"?Ie+(dn+"="+lt+"&"):Ie+(dn+"=redacted&")}}else Ie=null;else Ie=W;return"XMLHTTP REQ ("+b+") [attempt "+K+"]: "+p+`
`+v+`
`+Ie})}function bl(u,p,v,b,K,W,Ie){u.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+K+"]: "+p+`
`+v+`
`+W+" "+Ie})}function Ks(u,p,v,b){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+zo(u,v)+(b?" "+b:"")})}function zn(u,p){u.info(function(){return"TIMEOUT: "+p})}zs.prototype.info=function(){};function zo(u,p){if(!u.g)return p;if(!p)return null;try{var v=JSON.parse(p);if(v){for(u=0;u<v.length;u++)if(Array.isArray(v[u])){var b=v[u];if(!(2>b.length)){var K=b[1];if(Array.isArray(K)&&!(1>K.length)){var W=K[0];if(W!="noop"&&W!="stop"&&W!="close")for(var Ie=1;Ie<K.length;Ie++)K[Ie]=""}}}}return un(v)}catch{return p}}var Kn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},wl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ko;function jr(){}T(jr,yl),jr.prototype.g=function(){return new XMLHttpRequest},jr.prototype.i=function(){return{}},Ko=new jr;function tr(u,p,v,b){this.j=u,this.i=p,this.l=v,this.R=b||1,this.U=new Mt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gi}function Gi(){this.i=null,this.g="",this.h=!1}var as={},Go={};function Gs(u,p,v){u.L=1,u.v=qr(_r(p)),u.m=v,u.P=!0,gr(u,null)}function gr(u,p){u.F=Date.now(),Ho(u),u.A=_r(u.v);var v=u.A,b=u.R;Array.isArray(b)||(b=[String(b)]),Gt(v.i,"t",b),u.C=0,v=u.j.J,u.h=new Gi,u.g=Dl(u.j,v?p:null,!u.m),0<u.O&&(u.M=new _n(g(u.Y,u,u.g),u.O)),p=u.U,v=u.g,b=u.ca;var K="readystatechange";Array.isArray(K)||(K&&(mr[0]=K.toString()),K=mr);for(var W=0;W<K.length;W++){var Ie=oe(v,K[W],b||p.handleEvent,!1,p.h||p);if(!Ie)break;p.g[Ie.key]=Ie}p=u.H?I(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),qs(),bc(u.i,u.u,u.A,u.l,u.R,u.m)}tr.prototype.ca=function(u){u=u.target;const p=this.M;p&&Nr(u)==3?p.j():this.Y(u)},tr.prototype.Y=function(u){try{if(u==this.g)e:{const gn=Nr(this.g);var p=this.g.Ba();const ei=this.g.Z();if(!(3>gn)&&(gn!=3||this.g&&(this.h.h||this.g.oa()||Rl(this.g)))){this.J||gn!=4||p==7||(p==8||0>=ei?qs(3):qs(2)),vr(this);var v=this.g.Z();this.X=v;t:if(wc(this)){var b=Rl(this.g);u="";var K=b.length,W=Nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Br(this),ls(this);var Ie="";break t}this.h.i=new a.TextDecoder}for(p=0;p<K;p++)this.h.h=!0,u+=this.h.i.decode(b[p],{stream:!(W&&p==K-1)});b.length=0,this.h.g+=u,this.C=0,Ie=this.h.g}else Ie=this.g.oa();if(this.o=v==200,bl(this.i,this.u,this.A,this.l,this.R,gn,v),this.o){if(this.T&&!this.K){t:{if(this.g){var It,cn=this.g;if((It=cn.g?cn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(It)){var lt=It;break t}}lt=null}if(v=lt)Ks(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wo(this,v);else{this.o=!1,this.s=3,tn(12),Br(this),ls(this);break e}}if(this.P){v=!0;let cr;for(;!this.J&&this.C<Ie.length;)if(cr=Zh(this,Ie),cr==Go){gn==4&&(this.s=4,tn(14),v=!1),Ks(this.i,this.l,null,"[Incomplete Response]");break}else if(cr==as){this.s=4,tn(15),Ks(this.i,this.l,Ie,"[Invalid Chunk]"),v=!1;break}else Ks(this.i,this.l,cr,null),Wo(this,cr);if(wc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gn!=4||Ie.length!=0||this.h.h||(this.s=1,tn(16),v=!1),this.o=this.o&&v,!v)Ks(this.i,this.l,Ie,"[Invalid Chunked Response]"),Br(this),ls(this);else if(0<Ie.length&&!this.W){this.W=!0;var dn=this.j;dn.g==this&&dn.ba&&!dn.M&&(dn.j.info("Great, no buffering proxy detected. Bytes received: "+Ie.length),kl(dn),dn.M=!0,tn(11))}}else Ks(this.i,this.l,Ie,null),Wo(this,Ie);gn==4&&Br(this),this.o&&!this.J&&(gn==4?Dc(this.j,this):(this.o=!1,Ho(this)))}else Js(this.g),v==400&&0<Ie.indexOf("Unknown SID")?(this.s=3,tn(12)):(this.s=0,tn(13)),Br(this),ls(this)}}}catch{}finally{}};function wc(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Zh(u,p){var v=u.C,b=p.indexOf(`
`,v);return b==-1?Go:(v=Number(p.substring(v,b)),isNaN(v)?as:(b+=1,b+v>p.length?Go:(p=p.slice(b,b+v),u.C=b+v,p)))}tr.prototype.cancel=function(){this.J=!0,Br(this)};function Ho(u){u.S=Date.now()+u.I,Il(u,u.I)}function Il(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=kn(g(u.ba,u),p)}function vr(u){u.B&&(a.clearTimeout(u.B),u.B=null)}tr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(zn(this.i,this.A),this.L!=2&&(qs(),tn(17)),Br(this),this.s=2,ls(this)):Il(this,this.S-u)};function ls(u){u.j.G==0||u.J||Dc(u.j,u)}function Br(u){vr(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Ur(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Wo(u,p){try{var v=u.j;if(v.G!=0&&(v.g==u||Jo(v.h,u))){if(!u.K&&Jo(v.h,u)&&v.G==3){try{var b=v.Da.g.parse(p)}catch{b=null}if(Array.isArray(b)&&b.length==3){var K=b;if(K[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<u.F)oa(v),to(v);else break e;Cl(v),tn(18)}}else v.za=K[1],0<v.za-v.T&&37500>K[2]&&v.F&&v.v==0&&!v.C&&(v.C=kn(g(v.Za,v),6e3));if(1>=Tl(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else hs(v,11)}else if((u.K||v.g==u)&&oa(v),!q(p))for(K=v.Da.g.parse(p),p=0;p<K.length;p++){let lt=K[p];if(v.T=lt[0],lt=lt[1],v.G==2)if(lt[0]=="c"){v.K=lt[1],v.ia=lt[2];const dn=lt[3];dn!=null&&(v.la=dn,v.j.info("VER="+v.la));const gn=lt[4];gn!=null&&(v.Aa=gn,v.j.info("SVER="+v.Aa));const ei=lt[5];ei!=null&&typeof ei=="number"&&0<ei&&(b=1.5*ei,v.L=b,v.j.info("backChannelRequestTimeoutMs_="+b)),b=v;const cr=u.g;if(cr){const aa=cr.g?cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(aa){var W=b.h;W.g||aa.indexOf("spdy")==-1&&aa.indexOf("quic")==-1&&aa.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Hs(W,W.h),W.h=null))}if(b.D){const fs=cr.g?cr.g.getResponseHeader("X-HTTP-Session-Id"):null;fs&&(b.ya=fs,St(b.I,b.D,fs))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-u.F,v.j.info("Handshake RTT: "+v.R+"ms")),b=v;var Ie=u;if(b.qa=Vc(b,b.J?b.ia:null,b.W),Ie.K){Hi(b.h,Ie);var It=Ie,cn=b.L;cn&&(It.I=cn),It.B&&(vr(It),Ho(It)),b.g=Ie}else Cc(b);0<v.i.length&&sa(v)}else lt[0]!="stop"&&lt[0]!="close"||hs(v,7);else v.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?hs(v,7):Ys(v):lt[0]!="noop"&&v.l&&v.l.ta(lt),v.v=0)}}qs(4)}catch{}}var El=class{constructor(u,p){this.g=u,this.map=p}};function Ic(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qo(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Tl(u){return u.h?1:u.g?u.g.size:0}function Jo(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Hs(u,p){u.g?u.g.add(p):u.h=p}function Hi(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Ic.prototype.cancel=function(){if(this.i=Wi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Wi(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const v of u.g.values())p=p.concat(v.D);return p}return A(u.i)}function xl(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],v=u.length,b=0;b<v;b++)p.push(u[b]);return p}p=[],v=0;for(b in u)p[v++]=u[b];return p}function Fe(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var v=0;v<u;v++)p.push(v);return p}p=[],v=0;for(const b in u)p[v++]=b;return p}}}function pt(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var v=Fe(u),b=xl(u),K=b.length,W=0;W<K;W++)p.call(void 0,b[W],v&&v[W],u)}var yr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qi(u,p){if(u){u=u.split("&");for(var v=0;v<u.length;v++){var b=u[v].indexOf("="),K=null;if(0<=b){var W=u[v].substring(0,b);K=u[v].substring(b+1)}else W=u[v];p(W,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function us(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof us){this.h=u.h,Yo(this,u.j),this.o=u.o,this.g=u.g,Xo(this,u.s),this.l=u.l;var p=u.i,v=new Yi;v.i=p.i,p.g&&(v.g=new Map(p.g),v.h=p.h),Zo(this,v),this.m=u.m}else u&&(p=String(u).match(yr))?(this.h=!1,Yo(this,p[1]||"",!0),this.o=zr(p[2]||""),this.g=zr(p[3]||"",!0),Xo(this,p[4]),this.l=zr(p[5]||"",!0),Zo(this,p[6]||"",!0),this.m=zr(p[7]||"")):(this.h=!1,this.i=new Yi(null,this.h))}us.prototype.toString=function(){var u=[],p=this.j;p&&u.push(br(p,Qs,!0),":");var v=this.g;return(v||p=="file")&&(u.push("//"),(p=this.o)&&u.push(br(p,Qs,!0),"@"),u.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&u.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&u.push("/"),u.push(br(v,v.charAt(0)=="/"?ea:Ji,!0))),(v=this.i.toString())&&u.push("?",v),(v=this.m)&&u.push("#",br(v,tf)),u.join("")};function _r(u){return new us(u)}function Yo(u,p,v){u.j=v?zr(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Xo(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Zo(u,p,v){p instanceof Yi?(u.i=p,nf(u.i,u.h)):(v||(p=br(p,ef)),u.i=new Yi(p,u.h))}function St(u,p,v){u.i.set(p,v)}function qr(u){return St(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function zr(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function br(u,p,v){return typeof u=="string"?(u=encodeURI(u).replace(p,Ws),v&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Ws(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Qs=/[#\/\?@]/g,Ji=/[#\?:]/g,ea=/[#\?]/g,ef=/[#\?@]/g,tf=/#/g;function Yi(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function kr(u){u.g||(u.g=new Map,u.h=0,u.i&&Qi(u.i,function(p,v){u.add(decodeURIComponent(p.replace(/\+/g," ")),v)}))}n=Yi.prototype,n.add=function(u,p){kr(this),this.i=null,u=at(this,u);var v=this.g.get(u);return v||this.g.set(u,v=[]),v.push(p),this.h+=1,this};function qe(u,p){kr(u),p=at(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function et(u,p){return kr(u),p=at(u,p),u.g.has(p)}n.forEach=function(u,p){kr(this),this.g.forEach(function(v,b){v.forEach(function(K){u.call(p,K,b,this)},this)},this)},n.na=function(){kr(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),v=[];for(let b=0;b<p.length;b++){const K=u[b];for(let W=0;W<K.length;W++)v.push(p[b])}return v},n.V=function(u){kr(this);let p=[];if(typeof u=="string")et(this,u)&&(p=p.concat(this.g.get(at(this,u))));else{u=Array.from(this.g.values());for(let v=0;v<u.length;v++)p=p.concat(u[v])}return p},n.set=function(u,p){return kr(this),this.i=null,u=at(this,u),et(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Gt(u,p,v){qe(u,p),0<v.length&&(u.i=null,u.g.set(at(u,p),A(v)),u.h+=v.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var v=0;v<p.length;v++){var b=p[v];const W=encodeURIComponent(String(b)),Ie=this.V(b);for(b=0;b<Ie.length;b++){var K=W;Ie[b]!==""&&(K+="="+encodeURIComponent(String(Ie[b]))),u.push(K)}}return this.i=u.join("&")};function at(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function nf(u,p){p&&!u.j&&(kr(u),u.i=null,u.g.forEach(function(v,b){var K=b.toLowerCase();b!=K&&(qe(this,b),Gt(this,K,v))},u)),u.j=p}function Al(u,p){const v=new zs;if(a.Image){const b=new Image;b.onload=y(Gn,v,"TestLoadImage: loaded",!0,p,b),b.onerror=y(Gn,v,"TestLoadImage: error",!1,p,b),b.onabort=y(Gn,v,"TestLoadImage: abort",!1,p,b),b.ontimeout=y(Gn,v,"TestLoadImage: timeout",!1,p,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=u}else p(!1)}function Ec(u,p){const v=new zs,b=new AbortController,K=setTimeout(()=>{b.abort(),Gn(v,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:b.signal}).then(W=>{clearTimeout(K),W.ok?Gn(v,"TestPingServer: ok",!0,p):Gn(v,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(K),Gn(v,"TestPingServer: error",!1,p)})}function Gn(u,p,v,b,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),b(v)}catch{}}function ta(){this.g=new qi}function rf(u,p,v){const b=v||"";try{pt(u,function(K,W){let Ie=K;c(K)&&(Ie=un(K)),p.push(b+W+"="+encodeURIComponent(Ie))})}catch(K){throw p.push(b+"type="+encodeURIComponent("_badmap")),K}}function Dr(u){this.l=u.Ub||null,this.j=u.eb||!1}T(Dr,yl),Dr.prototype.g=function(){return new Dn(this.l,this.j)},Dr.prototype.i=function(u){return function(){return u}}({});function Dn(u,p){Le.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Dn,Le),n=Dn.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,Xi(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,cs(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Xi(this)),this.g&&(this.readyState=3,Xi(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Tc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?cs(this):Xi(this),this.readyState==3&&Tc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,cs(this))},n.Qa=function(u){this.g&&(this.response=u,cs(this))},n.ga=function(){this.g&&cs(this)};function cs(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Xi(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var v=p.next();!v.done;)v=v.value,u.push(v[0]+": "+v[1]),v=p.next();return u.join(`\r
`)};function Xi(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Dn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function xc(u){let p="";return pe(u,function(v,b){p+=b,p+=":",p+=v,p+=`\r
`}),p}function Sl(u,p,v){e:{for(b in v){var b=!1;break e}b=!0}b||(v=xc(v),typeof u=="string"?v!=null&&encodeURIComponent(String(v)):St(u,p,v))}function Lt(u){Le.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(Lt,Le);var na=/^https?$/i,Pl=["POST","PUT"];n=Lt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,v,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ko.g(),this.v=this.o?vc(this.o):vc(Ko),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(W){nr(this,W);return}if(u=v||"",v=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var K in b)v.set(K,b[K]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const W of b.keys())v.set(W,b.get(W));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(v.keys()).find(W=>W.toLowerCase()=="content-type"),K=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Pl,p,void 0))||b||K||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,Ie]of v)this.g.setRequestHeader(W,Ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ra(this),this.u=!0,this.g.send(u),this.u=!1}catch(W){nr(this,W)}};function nr(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,Ac(u),Zi(u)}function Ac(u){u.A||(u.A=!0,He(u,"complete"),He(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,He(this,"complete"),He(this,"abort"),Zi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zi(this,!0)),Lt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Sc(this):this.bb())},n.bb=function(){Sc(this)};function Sc(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Nr(u)!=4||u.Z()!=2)){if(u.u&&Nr(u)==4)Yt(u.Ea,0,u);else if(He(u,"readystatechange"),Nr(u)==4){u.h=!1;try{const Ie=u.Z();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var v;if(!(v=p)){var b;if(b=Ie===0){var K=String(u.D).match(yr)[1]||null;!K&&a.self&&a.self.location&&(K=a.self.location.protocol.slice(0,-1)),b=!na.test(K?K.toLowerCase():"")}v=b}if(v)He(u,"complete"),He(u,"success");else{u.m=6;try{var W=2<Nr(u)?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.Z()+"]",Ac(u)}}finally{Zi(u)}}}}function Zi(u,p){if(u.g){ra(u);const v=u.g,b=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||He(u,"ready");try{v.onreadystatechange=b}catch{}}}function ra(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Nr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Nr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Cn(p)}};function Rl(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Js(u){const p={};u=(u.g&&2<=Nr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<u.length;b++){if(q(u[b]))continue;var v=V(u[b]);const K=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const W=p[K]||[];p[K]=W,W.push(v)}x(p,function(b){return b.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ds(u,p,v){return v&&v.internalChannelParams&&v.internalChannelParams[u]||p}function eo(u){this.Aa=0,this.i=[],this.j=new zs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ds("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ds("baseRetryDelayMs",5e3,u),this.cb=ds("retryDelaySeedMs",1e4,u),this.Wa=ds("forwardChannelMaxRetries",2,u),this.wa=ds("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ic(u&&u.concurrentRequestLimit),this.Da=new ta,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=eo.prototype,n.la=8,n.G=1,n.connect=function(u,p,v,b){tn(0),this.W=u,this.H=p||{},v&&b!==void 0&&(this.H.OSID=v,this.H.OAID=b),this.F=this.X,this.I=Vc(this,null,this.W),sa(this)};function Ys(u){if(Pc(u),u.G==3){var p=u.U++,v=_r(u.I);if(St(v,"SID",u.K),St(v,"RID",p),St(v,"TYPE","terminate"),Kr(u,v),p=new tr(u,u.j,p),p.L=2,p.v=qr(_r(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!v&&a.Image&&(new Image().src=p.v,v=!0),v||(p.g=Dl(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Ho(p)}Nc(u)}function to(u){u.g&&(kl(u),u.g.cancel(),u.g=null)}function Pc(u){to(u),u.u&&(a.clearTimeout(u.u),u.u=null),oa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function sa(u){if(!Qo(u.h)&&!u.s){u.s=!0;var p=u.Ga;j||Be(),ne||(j(),ne=!0),Ke.add(p,u),u.B=0}}function Rc(u,p){return Tl(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=kn(g(u.Ga,u,p),Xs(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const K=new tr(this,this.j,u);let W=this.o;if(this.S&&(W?(W=I(W),C(W,this.S)):W=this.S),this.m!==null||this.O||(K.H=W,W=null),this.P)e:{for(var p=0,v=0;v<this.i.length;v++){t:{var b=this.i[v];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(p+=b,4096<p){p=v;break e}if(p===4096||v===this.i.length-1){p=v+1;break e}}p=1e3}else p=1e3;p=no(this,K,p),v=_r(this.I),St(v,"RID",u),St(v,"CVER",22),this.D&&St(v,"X-HTTP-Session-Id",this.D),Kr(this,v),W&&(this.O?p="headers="+encodeURIComponent(String(xc(W)))+"&"+p:this.m&&Sl(v,this.m,W)),Hs(this.h,K),this.Ua&&St(v,"TYPE","init"),this.P?(St(v,"$req",p),St(v,"SID","null"),K.T=!0,Gs(K,v,null)):Gs(K,v,p),this.G=2}}else this.G==3&&(u?ia(this,u):this.i.length==0||Qo(this.h)||ia(this))};function ia(u,p){var v;p?v=p.l:v=u.U++;const b=_r(u.I);St(b,"SID",u.K),St(b,"RID",v),St(b,"AID",u.T),Kr(u,b),u.m&&u.o&&Sl(b,u.m,u.o),v=new tr(u,u.j,v,u.B+1),u.m===null&&(v.H=u.o),p&&(u.i=p.D.concat(u.i)),p=no(u,v,1e3),v.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Hs(u.h,v),Gs(v,b,p)}function Kr(u,p){u.H&&pe(u.H,function(v,b){St(p,b,v)}),u.l&&pt({},function(v,b){St(p,b,v)})}function no(u,p,v){v=Math.min(u.i.length,v);var b=u.l?g(u.l.Na,u.l,u):null;e:{var K=u.i;let W=-1;for(;;){const Ie=["count="+v];W==-1?0<v?(W=K[0].g,Ie.push("ofs="+W)):W=0:Ie.push("ofs="+W);let It=!0;for(let cn=0;cn<v;cn++){let lt=K[cn].g;const dn=K[cn].map;if(lt-=W,0>lt)W=Math.max(0,K[cn].g-100),It=!1;else try{rf(dn,Ie,"req"+lt+"_")}catch{b&&b(dn)}}if(It){b=Ie.join("&");break e}}}return u=u.i.splice(0,v),p.D=u,b}function Cc(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;j||Be(),ne||(j(),ne=!0),Ke.add(p,u),u.v=0}}function Cl(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=kn(g(u.Fa,u),Xs(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,kc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=kn(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tn(10),to(this),kc(this))};function kl(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function kc(u){u.g=new tr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=_r(u.qa);St(p,"RID","rpc"),St(p,"SID",u.K),St(p,"AID",u.T),St(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&St(p,"TO",u.ja),St(p,"TYPE","xmlhttp"),Kr(u,p),u.m&&u.o&&Sl(p,u.m,u.o),u.L&&(u.g.I=u.L);var v=u.g;u=u.ia,v.L=1,v.v=qr(_r(p)),v.m=null,v.P=!0,gr(v,u)}n.Za=function(){this.C!=null&&(this.C=null,to(this),Cl(this),tn(19))};function oa(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Dc(u,p){var v=null;if(u.g==p){oa(u),kl(u),u.g=null;var b=2}else if(Jo(u.h,p))v=p.D,Hi(u.h,p),b=1;else return;if(u.G!=0){if(p.o)if(b==1){v=p.m?p.m.length:0,p=Date.now()-p.F;var K=u.B;b=Rr(),He(b,new _c(b,v)),sa(u)}else Cc(u);else if(K=p.s,K==3||K==0&&0<p.X||!(b==1&&Rc(u,p)||b==2&&Cl(u)))switch(v&&0<v.length&&(p=u.h,p.i=p.i.concat(v)),K){case 1:hs(u,5);break;case 4:hs(u,10);break;case 3:hs(u,6);break;default:hs(u,2)}}}function Xs(u,p){let v=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(v*=2),v*p}function hs(u,p){if(u.j.info("Error code "+p),p==2){var v=g(u.fb,u),b=u.Xa;const K=!b;b=new us(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Yo(b,"https"),qr(b),K?Al(b.toString(),v):Ec(b.toString(),v)}else tn(2);u.G=0,u.l&&u.l.sa(p),Nc(u),Pc(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),tn(2)):(this.j.info("Failed to ping google.com"),tn(1))};function Nc(u){if(u.G=0,u.ka=[],u.l){const p=Wi(u.h);(p.length!=0||u.i.length!=0)&&(P(u.ka,p),P(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function Vc(u,p,v){var b=v instanceof us?_r(v):new us(v);if(b.g!="")p&&(b.g=p+"."+b.g),Xo(b,b.s);else{var K=a.location;b=K.protocol,p=p?p+"."+K.hostname:K.hostname,K=+K.port;var W=new us(null);b&&Yo(W,b),p&&(W.g=p),K&&Xo(W,K),v&&(W.l=v),b=W}return v=u.D,p=u.ya,v&&p&&St(b,v,p),St(b,"VER",u.la),Kr(u,b),b}function Dl(u,p,v){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Lt(new Dr({eb:v})):new Lt(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Oc(){}n=Oc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ro(){}ro.prototype.g=function(u,p){return new Hn(u,p)};function Hn(u,p){Le.call(this),this.g=new eo(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!q(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!q(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Zs(this)}T(Hn,Le),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){Ys(this.g)},Hn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var v={};v.__data__=u,u=v}else this.u&&(v={},v.__data__=un(u),u=v);p.i.push(new El(p.Ya++,u)),p.G==3&&sa(p)},Hn.prototype.N=function(){this.g.l=null,delete this.j,Ys(this.g),delete this.g,Hn.aa.N.call(this)};function Mc(u){_l.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const v in p){u=v;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}T(Mc,_l);function Lc(){Sr.call(this),this.status=1}T(Lc,Sr);function Zs(u){this.g=u}T(Zs,Oc),Zs.prototype.ua=function(){He(this.g,"a")},Zs.prototype.ta=function(u){He(this.g,new Mc(u))},Zs.prototype.sa=function(u){He(this.g,new Lc)},Zs.prototype.ra=function(){He(this.g,"b")},ro.prototype.createWebChannel=ro.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,Hb=function(){return new ro},Gb=function(){return Rr()},Kb=er,dp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kn.NO_ERROR=0,Kn.TIMEOUT=8,Kn.HTTP_ERROR=6,id=Kn,wl.COMPLETE="complete",zb=wl,yc.EventType=zi,zi.OPEN="a",zi.CLOSE="b",zi.ERROR="c",zi.MESSAGE="d",Le.prototype.listen=Le.prototype.K,Wl=yc,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,qb=Lt}).apply(typeof qc<"u"?qc:typeof self<"u"?self:typeof window<"u"?window:{});const py="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new dm("@firebase/firestore");function ma(){return Si.logLevel}function ej(n){Si.setLogLevel(n)}function ce(n,...e){if(Si.logLevel<=st.DEBUG){const t=e.map(pm);Si.debug(`Firestore (${nl}): ${n}`,...t)}}function rn(n,...e){if(Si.logLevel<=st.ERROR){const t=e.map(pm);Si.error(`Firestore (${nl}): ${n}`,...t)}}function xr(n,...e){if(Si.logLevel<=st.WARN){const t=e.map(pm);Si.warn(`Firestore (${nl}): ${n}`,...t)}}function pm(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(n="Unexpected state"){const e=`FIRESTORE (${nl}) INTERNAL ASSERTION FAILED: `+n;throw rn(e),new Error(e)}function Ce(n,e){n||Re()}function tj(n,e){n||Re()}function Ee(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends os{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(wn.UNAUTHENTICATED))}shutdown(){}}class gR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vR{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ce(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new In;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new In,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new In)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ce(typeof r.accessToken=="string"),new Wb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string"),new wn(e)}}class yR{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class _R{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new yR(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ce(this.o===void 0);const r=i=>{i.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ce(typeof t.token=="string"),this.R=t.token,new Qb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class nj{getToken(){return Promise.resolve(new Qb(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=wR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function ze(n,e){return n<e?-1:n>e?1:0}function Oa(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Yb(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new de(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Wt.fromMillis(Date.now())}static fromDate(e){return Wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Wt(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Me(e)}static min(){return new Me(new Wt(0,0))}static max(){return new Me(new Wt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,t,r){t===void 0?t=0:t>e.length&&Re(),r===void 0?r=e.length-t:r>e.length-t&&Re(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Tu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Tu?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class it extends Tu{construct(e,t,r){return new it(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new de(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new it(t)}static emptyPath(){return new it([])}}const IR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Tu{construct(e,t,r){return new zt(e,t,r)}static isValidIdentifier(e){return IR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new de(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new de(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new de(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new de(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.path=e}static fromPath(e){return new xe(it.fromString(e))}static fromName(e){return new xe(it.fromString(e).popFirst(5))}static empty(){return new xe(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return it.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xe(new it(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function hp(n){return n.fields.find(e=>e.kind===2)}function uo(n){return n.fields.filter(e=>e.kind!==2)}function ER(n,e){let t=ze(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=TR(n.fields[r],e.fields[r]),t!==0)return t;return ze(n.fields.length,e.fields.length)}Ma.UNKNOWN_ID=-1;class Io{constructor(e,t){this.fieldPath=e,this.kind=t}}function TR(n,e){const t=zt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:ze(n.kind,e.kind)}class La{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new La(0,pr.min())}}function Xb(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Me.fromTimestamp(r===1e9?new Wt(t+1,0):new Wt(t,r));return new pr(s,xe.empty(),e)}function Zb(n){return new pr(n.readTime,n.key,-1)}class pr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new pr(Me.min(),xe.empty(),-1)}static max(){return new pr(Me.max(),xe.empty(),-1)}}function mm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=xe.comparator(n.documentKey,e.documentKey),t!==0?t:ze(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(n){if(n.code!==H.FAILED_PRECONDITION||n.message!==ew)throw n;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new G((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof G?t:G.resolve(t)}catch(t){return G.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):G.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):G.reject(t)}static resolve(e){return new G((t,r)=>{t(e)})}static reject(e){return new G((t,r)=>{r(e)})}static waitFor(e){return new G((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=G.resolve(!1);for(const r of e)t=t.next(s=>s?G.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new G((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new G((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new In,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new uu(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=gm(r.target.error);this.V.reject(new uu(e,s))}}static open(e,t,r,s){try{return new mh(t,e.transaction(s,r))}catch(i){throw new uu(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ce("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new AR(t)}}class Zr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Zr.S(vn())===12.2&&rn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ce("SimpleDb","Removing database:",e),fo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!cm())return!1;if(Zr.v())return!0;const e=vn(),t=Zr.S(e),r=0<t&&t<10,s=nw(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(ce("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new uu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new de(H.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new de(H.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new uu(e,o))},s.onupgradeneeded=i=>{ce("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{ce("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=mh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),G.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(ce("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function nw(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class xR{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return fo(this.B.delete())}}class uu extends de{constructor(e,t){super(H.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fi(n){return n.name==="IndexedDbTransactionError"}class AR{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(ce("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(ce("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),fo(r)}add(e){return ce("SimpleDb","ADD",this.store.name,e,e),fo(this.store.add(e))}get(e){return fo(this.store.get(e)).next(t=>(t===void 0&&(t=null),ce("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return ce("SimpleDb","DELETE",this.store.name,e),fo(this.store.delete(e))}count(){return ce("SimpleDb","COUNT",this.store.name),fo(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new G((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new G((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){ce("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new G((r,s)=>{t.onerror=i=>{const o=gm(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new G((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new xR(a),c=t(a.primaryKey,a.value,l);if(c instanceof G){const d=c.catch(f=>(l.done(),G.reject(f)));r.push(d)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>G.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function fo(n){return new G((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=gm(r.target.error);t(s)}})}let my=!1;function gm(n){const e=Zr.S(vn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new de("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return my||(my=!0,setTimeout(()=>{throw r},0)),r}}return n}class SR{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){ce("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{ce("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Fi(t)?ce("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Li(t)}await this.X(6e4)})}}class PR{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return G.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ce("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(ce("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=Zb(i);mm(o,r)>0&&(r=o)}),new pr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}or.oe=-1;function Qu(n){return n==null}function xu(n){return n===0&&1/n==-1/0}function rw(n){return typeof n=="number"&&Number.isInteger(n)&&!xu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=gy(e)),e=RR(n.get(t),e);return gy(e)}function RR(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function gy(n){return n+""}function Qr(n){const e=n.length;if(Ce(e>=2),e===2)return Ce(n.charAt(0)===""&&n.charAt(1)===""),it.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&Re(),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:Re()}i=o+2}return new it(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function od(n,e){return[n,jn(e)]}function sw(n,e,t){return[n,jn(e),t]}const CR={},kR=["prefixPath","collectionGroup","readTime","documentId"],DR=["prefixPath","collectionGroup","documentId"],NR=["collectionGroup","readTime","prefixPath","documentId"],VR=["canonicalId","targetId"],OR=["targetId","path"],MR=["path","targetId"],LR=["collectionId","parent"],FR=["indexId","uid"],$R=["uid","sequenceNumber"],UR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jR=["indexId","uid","orderedDocumentKey"],BR=["userId","collectionPath","documentId"],qR=["userId","collectionPath","largestBatchId"],zR=["userId","collectionGroup","largestBatchId"],iw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],KR=[...iw,"documentOverlays"],ow=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],aw=ow,vm=[...aw,"indexConfiguration","indexState","indexEntries"],GR=vm,HR=[...vm,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp extends tw{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function yn(n,e){const t=Ee(n);return Zr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function $i(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lw(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function uw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,t){this.comparator=e,this.root=t||An.EMPTY}insert(e,t){return new Ot(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,An.BLACK,null,null))}remove(e){return new Ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,An.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zc(this.root,e,this.comparator,!1)}getReverseIterator(){return new zc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zc(this.root,e,this.comparator,!0)}}class zc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class An{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??An.RED,this.left=s??An.EMPTY,this.right=i??An.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new An(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return An.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return An.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,An.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,An.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Re();const e=this.left.check();if(e!==this.right.check())throw Re();return e+(this.isRed()?0:1)}}An.EMPTY=null,An.RED=!0,An.BLACK=!1;An.EMPTY=new class{constructor(){this.size=0}get key(){throw Re()}get value(){throw Re()}get color(){throw Re()}get left(){throw Re()}get right(){throw Re()}copy(e,t,r,s,i){return this}insert(e,t,r){return new An(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.comparator=e,this.data=new Ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _y(this.data.getIterator())}getIteratorFrom(e){return new _y(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof At)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new At(this.comparator);return t.data=e,t}}class _y{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ua(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new ar([])}unionWith(e){let t=new At(zt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ar(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new cw("Invalid base64 string: "+i):i}}(e);return new Zt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Zt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zt.EMPTY_BYTE_STRING=new Zt("");const WR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(n){if(Ce(!!n),typeof n=="string"){let e=0;const t=WR.exec(n);if(Ce(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qt(n.seconds),nanos:qt(n.nanos)}}function qt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ds(n){return typeof n=="string"?Zt.fromBase64String(n):Zt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function vh(n){const e=n.mapValue.fields.__previous_value__;return gh(e)?vh(e):e}function Au(n){const e=ks(n.mapValue.fields.__local_write_time__.timestampValue);return new Wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class xo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new xo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof xo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ad={nullValue:"NULL_VALUE"};function Pi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gh(n)?4:dw(n)?9007199254740991:yh(n)?10:11:Re()}function is(n,e){if(n===e)return!0;const t=Pi(n);if(t!==Pi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Au(n).isEqual(Au(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ks(s.timestampValue),a=ks(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Ds(s.bytesValue).isEqual(Ds(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return qt(s.geoPointValue.latitude)===qt(i.geoPointValue.latitude)&&qt(s.geoPointValue.longitude)===qt(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return qt(s.integerValue)===qt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=qt(s.doubleValue),a=qt(i.doubleValue);return o===a?xu(o)===xu(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Oa(n.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(yy(o)!==yy(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!is(o[l],a[l])))return!1;return!0}(n,e);default:return Re()}}function Su(n,e){return(n.values||[]).find(t=>is(t,e))!==void 0}function Ri(n,e){if(n===e)return 0;const t=Pi(n),r=Pi(e);if(t!==r)return ze(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=qt(i.integerValue||i.doubleValue),l=qt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return by(n.timestampValue,e.timestampValue);case 4:return by(Au(n),Au(e));case 5:return ze(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Ds(i),l=Ds(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=ze(a[c],l[c]);if(d!==0)return d}return ze(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ze(qt(i.latitude),qt(o.latitude));return a!==0?a:ze(qt(i.longitude),qt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return wy(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,d;const f=i.fields||{},g=o.fields||{},y=(a=f.value)===null||a===void 0?void 0:a.arrayValue,T=(l=g.value)===null||l===void 0?void 0:l.arrayValue,A=ze(((c=y==null?void 0:y.values)===null||c===void 0?void 0:c.length)||0,((d=T==null?void 0:T.values)===null||d===void 0?void 0:d.length)||0);return A!==0?A:wy(y,T)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===yi.mapValue&&o===yi.mapValue)return 0;if(i===yi.mapValue)return 1;if(o===yi.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const g=ze(l[f],d[f]);if(g!==0)return g;const y=Ri(a[l[f]],c[d[f]]);if(y!==0)return y}return ze(l.length,d.length)}(n.mapValue,e.mapValue);default:throw Re()}}function by(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ze(n,e);const t=ks(n),r=ks(e),s=ze(t.seconds,r.seconds);return s!==0?s:ze(t.nanos,r.nanos)}function wy(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Ri(t[s],r[s]);if(i)return i}return ze(t.length,r.length)}function Fa(n){return pp(n)}function pp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=ks(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ds(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return xe.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=pp(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${pp(t.fields[o])}`;return s+"}"}(n.mapValue):Re()}function ld(n){switch(Pi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=vh(n);return e?16+ld(e):16;case 5:return 2*n.stringValue.length;case 6:return Ds(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ld(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return $i(r.fields,(i,o)=>{s+=i.length+ld(o)}),s}(n.mapValue);default:throw Re()}}function Ao(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function mp(n){return!!n&&"integerValue"in n}function Pu(n){return!!n&&"arrayValue"in n}function Iy(n){return!!n&&"nullValue"in n}function Ey(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ud(n){return!!n&&"mapValue"in n}function yh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function cu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return $i(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=cu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function dw(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const hw={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function JR(n){return"nullValue"in n?ad:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ao(xo.empty(),xe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?yh(n)?hw:{mapValue:{}}:Re()}function YR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ao(xo.empty(),xe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?hw:"mapValue"in n?yh(n)?{mapValue:{}}:yi:Re()}function Ty(n,e){const t=Ri(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function xy(n,e){const t=Ri(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ud(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cu(t)}setAll(e){let t=zt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=cu(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ud(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ud(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){$i(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Pn(cu(this.value))}}function fw(n){const e=[];return $i(n.fields,(t,r)=>{const s=new zt([t]);if(ud(r)){const i=fw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ar(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new $t(e,0,Me.min(),Me.min(),Me.min(),Pn.empty(),0)}static newFoundDocument(e,t,r,s){return new $t(e,1,t,Me.min(),r,s,0)}static newNoDocument(e,t){return new $t(e,2,t,Me.min(),Me.min(),Pn.empty(),0)}static newUnknownDocument(e,t){return new $t(e,3,t,Me.min(),Me.min(),Pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,t){this.position=e,this.inclusive=t}}function Ay(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=xe.comparator(xe.fromName(o.referenceValue),t.key):r=Ri(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Sy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!is(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,t="asc"){this.field=e,this.dir=t}}function XR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{}class ot extends pw{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ZR(e,t,r):t==="array-contains"?new nC(e,r):t==="in"?new bw(e,r):t==="not-in"?new rC(e,r):t==="array-contains-any"?new sC(e,r):new ot(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new eC(e,r):new tC(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ri(t,this.value)):t!==null&&Pi(this.value)===Pi(t)&&this.matchesComparison(Ri(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Et extends pw{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Et(e,t)}matches(e){return $a(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function $a(n){return n.op==="and"}function gp(n){return n.op==="or"}function ym(n){return mw(n)&&$a(n)}function mw(n){for(const e of n.filters)if(e instanceof Et)return!1;return!0}function vp(n){if(n instanceof ot)return n.field.canonicalString()+n.op.toString()+Fa(n.value);if(ym(n))return n.filters.map(e=>vp(e)).join(",");{const e=n.filters.map(t=>vp(t)).join(",");return`${n.op}(${e})`}}function gw(n,e){return n instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.field.isEqual(s.field)&&is(r.value,s.value)}(n,e):n instanceof Et?function(r,s){return s instanceof Et&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&gw(o,s.filters[a]),!0):!1}(n,e):void Re()}function vw(n,e){const t=n.filters.concat(e);return Et.create(t,n.op)}function yw(n){return n instanceof ot?function(t){return`${t.field.canonicalString()} ${t.op} ${Fa(t.value)}`}(n):n instanceof Et?function(t){return t.op.toString()+" {"+t.getFilters().map(yw).join(" ,")+"}"}(n):"Filter"}class ZR extends ot{constructor(e,t,r){super(e,t,r),this.key=xe.fromName(r.referenceValue)}matches(e){const t=xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class eC extends ot{constructor(e,t){super(e,"in",t),this.keys=_w("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class tC extends ot{constructor(e,t){super(e,"not-in",t),this.keys=_w("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _w(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>xe.fromName(r.referenceValue))}class nC extends ot{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Pu(t)&&Su(t.arrayValue,this.value)}}class bw extends ot{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Su(this.value.arrayValue,t)}}class rC extends ot{constructor(e,t){super(e,"not-in",t)}matches(e){if(Su(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Su(this.value.arrayValue,t)}}class sC extends ot{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Pu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Su(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function yp(n,e=null,t=[],r=[],s=null,i=null,o=null){return new iC(n,e,t,r,s,i,o)}function So(n){const e=Ee(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>vp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Qu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Fa(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Fa(r)).join(",")),e.ue=t}return e.ue}function Ju(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!XR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Sy(n.startAt,e.startAt)&&Sy(n.endAt,e.endAt)}function Nd(n){return xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Vd(n,e){return n.filters.filter(t=>t instanceof ot&&t.field.isEqual(e))}function Py(n,e,t){let r=ad,s=!0;for(const i of Vd(n,e)){let o=ad,a=!0;switch(i.op){case"<":case"<=":o=JR(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=ad}Ty({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Ty({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Ry(n,e,t){let r=yi,s=!0;for(const i of Vd(n,e)){let o=yi,a=!0;switch(i.op){case">=":case">":o=YR(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=yi}xy({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];xy({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ww(n,e,t,r,s,i,o,a){return new Ls(n,e,t,r,s,i,o,a)}function rl(n){return new Ls(n)}function Cy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _m(n){return n.collectionGroup!==null}function xa(n){const e=Ee(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new At(zt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Ru(i,r))}),t.has(zt.keyField().canonicalString())||e.ce.push(new Ru(zt.keyField(),r))}return e.ce}function Bn(n){const e=Ee(n);return e.le||(e.le=Ew(e,xa(n))),e.le}function Iw(n){const e=Ee(n);return e.he||(e.he=Ew(e,n.explicitOrderBy)),e.he}function Ew(n,e){if(n.limitType==="F")return yp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ru(s.field,i)});const t=n.endAt?new Ci(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ci(n.startAt.position,n.startAt.inclusive):null;return yp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function _p(n,e){const t=n.filters.concat([e]);return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Od(n,e,t){return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yu(n,e){return Ju(Bn(n),Bn(e))&&n.limitType===e.limitType}function Tw(n){return`${So(Bn(n))}|lt:${n.limitType}`}function ga(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>yw(s)).join(", ")}]`),Qu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Fa(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Fa(s)).join(",")),`Target(${r})`}(Bn(n))}; limitType=${n.limitType})`}function Xu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):xe.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of xa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=Ay(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,xa(r),s)||r.endAt&&!function(o,a,l){const c=Ay(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,xa(r),s))}(n,e)}function xw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Aw(n){return(e,t)=>{let r=!1;for(const s of xa(n)){const i=oC(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function oC(n,e,t){const r=n.field.isKeyField()?xe.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ri(l,c):Re()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){$i(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return uw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC=new Ot(xe.comparator);function lr(){return aC}const Sw=new Ot(xe.comparator);function Ql(...n){let e=Sw;for(const t of n)e=e.insert(t.key,t);return e}function Pw(n){let e=Sw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Jr(){return du()}function Rw(){return du()}function du(){return new Fs(n=>n.toString(),(n,e)=>n.isEqual(e))}const lC=new Ot(xe.comparator),uC=new At(xe.comparator);function Ye(...n){let e=uC;for(const t of n)e=e.add(t);return e}const cC=new At(ze);function bm(){return cC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wm(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xu(e)?"-0":e}}function Cw(n){return{integerValue:""+n}}function kw(n,e){return rw(e)?Cw(e):wm(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(){this._=void 0}}function dC(n,e,t){return n instanceof Ua?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&gh(i)&&(i=vh(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Po?Nw(n,e):n instanceof Ro?Vw(n,e):function(s,i){const o=Dw(s,i),a=ky(o)+ky(s.Pe);return mp(o)&&mp(s.Pe)?Cw(a):wm(s.serializer,a)}(n,e)}function hC(n,e,t){return n instanceof Po?Nw(n,e):n instanceof Ro?Vw(n,e):t}function Dw(n,e){return n instanceof ja?function(r){return mp(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ua extends _h{}class Po extends _h{constructor(e){super(),this.elements=e}}function Nw(n,e){const t=Ow(e);for(const r of n.elements)t.some(s=>is(s,r))||t.push(r);return{arrayValue:{values:t}}}class Ro extends _h{constructor(e){super(),this.elements=e}}function Vw(n,e){let t=Ow(e);for(const r of n.elements)t=t.filter(s=>!is(s,r));return{arrayValue:{values:t}}}class ja extends _h{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function ky(n){return qt(n.integerValue||n.doubleValue)}function Ow(n){return Pu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,t){this.field=e,this.transform=t}}function fC(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Po&&s instanceof Po||r instanceof Ro&&s instanceof Ro?Oa(r.elements,s.elements,is):r instanceof ja&&s instanceof ja?is(r.Pe,s.Pe):r instanceof Ua&&s instanceof Ua}(n.transform,e.transform)}class pC{constructor(e,t){this.version=e,this.transformResults=t}}class Kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kt}static exists(e){return new Kt(void 0,e)}static updateTime(e){return new Kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class bh{}function Mw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new il(n.key,Kt.none()):new sl(n.key,n.data,Kt.none());{const t=n.data,r=Pn.empty();let s=new At(zt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new $s(n.key,r,new ar(s.toArray()),Kt.none())}}function mC(n,e,t){n instanceof sl?function(s,i,o){const a=s.value.clone(),l=Ny(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof $s?function(s,i,o){if(!cd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Ny(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Lw(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function hu(n,e,t,r){return n instanceof sl?function(i,o,a,l){if(!cd(i.precondition,o))return a;const c=i.value.clone(),d=Vy(i.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof $s?function(i,o,a,l){if(!cd(i.precondition,o))return a;const c=Vy(i.fieldTransforms,l,o),d=o.data;return d.setAll(Lw(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return cd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function gC(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Dw(r.transform,s||null);i!=null&&(t===null&&(t=Pn.empty()),t.set(r.field,i))}return t||null}function Dy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Oa(r,s,(i,o)=>fC(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class sl extends bh{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class $s extends bh{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Lw(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Ny(n,e,t){const r=new Map;Ce(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,hC(o,a,t[s]))}return r}function Vy(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,dC(i,o,e))}return r}class il extends bh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Im extends bh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&mC(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=hu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=hu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Rw();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=Mw(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Me.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(t,r)=>Dy(t,r))&&Oa(this.baseMutations,e.baseMutations,(t,r)=>Dy(t,r))}}class Tm{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ce(e.mutations.length===r.length);let s=function(){return lC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Tm(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn,ft;function $w(n){switch(n){default:return Re();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function Uw(n){if(n===void 0)return rn("GRPC error has no .code"),H.UNKNOWN;switch(n){case hn.OK:return H.OK;case hn.CANCELLED:return H.CANCELLED;case hn.UNKNOWN:return H.UNKNOWN;case hn.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case hn.INTERNAL:return H.INTERNAL;case hn.UNAVAILABLE:return H.UNAVAILABLE;case hn.UNAUTHENTICATED:return H.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case hn.NOT_FOUND:return H.NOT_FOUND;case hn.ALREADY_EXISTS:return H.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return H.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case hn.ABORTED:return H.ABORTED;case hn.OUT_OF_RANGE:return H.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return H.UNIMPLEMENTED;case hn.DATA_LOSS:return H.DATA_LOSS;default:return Re()}}(ft=hn||(hn={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Md=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=new wo([4294967295,4294967295],0);function Oy(n){const e=jw().encode(n),t=new Bb;return t.update(e),new Uint8Array(t.digest())}function My(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new wo([t,r],0),new wo([s,i],0)]}class Am{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Jl(`Invalid padding: ${t}`);if(r<0)throw new Jl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jl(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Jl(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=wo.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(wo.fromNumber(r)));return s.compare(yC)===1&&(s=new wo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Oy(e),[r,s]=My(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Am(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=Oy(e),[r,s]=My(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Jl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,tc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ec(Me.min(),s,new Ot(ze),lr(),Ye())}}class tc{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new tc(r,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class Bw{constructor(e,t){this.targetId=e,this.me=t}}class qw{constructor(e,t,r=Zt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Ly{constructor(){this.fe=0,this.ge=$y(),this.pe=Zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ye(),t=Ye(),r=Ye();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Re()}}),new tc(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=$y()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ce(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _C{constructor(e){this.Le=e,this.Be=new Map,this.ke=lr(),this.qe=Fy(),this.Qe=new Ot(ze)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Re()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Nd(i))if(r===0){const o=new xe(i.path);this.Ue(t,o,$t.newNoDocument(o,Me.min()))}else Ce(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}Md==null||Md.et(function(d,f,g,y,T){var A,P,U,q,M,z;const he={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},pe=f.unchangedNames;return pe&&(he.bloomFilter={applied:T===0,hashCount:(A=pe==null?void 0:pe.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(q=(U=(P=pe==null?void 0:pe.bits)===null||P===void 0?void 0:P.bitmap)===null||U===void 0?void 0:U.length)!==null&&q!==void 0?q:0,padding:(z=(M=pe==null?void 0:pe.bits)===null||M===void 0?void 0:M.padding)!==null&&z!==void 0?z:0,mightContain:x=>{var I;return(I=y==null?void 0:y.mightContain(x))!==null&&I!==void 0&&I}}),he}(o,e.me,this.Le.tt(),a,l))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Ds(r).toUint8Array()}catch(l){if(l instanceof cw)return xr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Am(o,s,i)}catch(l){return xr(l instanceof Jl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Nd(a.target)){const l=new xe(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,$t.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=Ye();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new ec(e,t,this.Qe,this.ke,r);return this.ke=lr(),this.qe=Fy(),this.Qe=new Ot(ze),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ly,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new At(ze),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ly),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Fy(){return new Ot(xe.comparator)}function $y(){return new Ot(xe.comparator)}const bC=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),wC=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),IC=(()=>({and:"AND",or:"OR"}))();class EC{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bp(n,e){return n.useProto3Json||Qu(e)?e:{value:e}}function Ba(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function TC(n,e){return Ba(n,e.toTimestamp())}function on(n){return Ce(!!n),Me.fromTimestamp(function(t){const r=ks(t);return new Wt(r.seconds,r.nanos)}(n))}function Sm(n,e){return wp(n,e).canonicalString()}function wp(n,e){const t=function(s){return new it(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Kw(n){const e=it.fromString(n);return Ce(tI(e)),e}function Cu(n,e){return Sm(n.databaseId,e.path)}function es(n,e){const t=Kw(e);if(t.get(1)!==n.databaseId.projectId)throw new de(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new xe(Ww(t))}function Gw(n,e){return Sm(n.databaseId,e)}function Hw(n){const e=Kw(n);return e.length===4?it.emptyPath():Ww(e)}function Ip(n){return new it(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ww(n){return Ce(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Uy(n,e,t){return{name:Cu(n,e),fields:t.value.mapValue.fields}}function Qw(n,e,t){const r=es(n,e.name),s=on(e.updateTime),i=e.createTime?on(e.createTime):Me.min(),o=new Pn({mapValue:{fields:e.fields}}),a=$t.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function xC(n,e){return"found"in e?function(r,s){Ce(!!s.found),s.found.name,s.found.updateTime;const i=es(r,s.found.name),o=on(s.found.updateTime),a=s.found.createTime?on(s.found.createTime):Me.min(),l=new Pn({mapValue:{fields:s.found.fields}});return $t.newFoundDocument(i,o,a,l)}(n,e):"missing"in e?function(r,s){Ce(!!s.missing),Ce(!!s.readTime);const i=es(r,s.missing),o=on(s.readTime);return $t.newNoDocument(i,o)}(n,e):Re()}function AC(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Re()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Ce(d===void 0||typeof d=="string"),Zt.fromBase64String(d||"")):(Ce(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Zt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?H.UNKNOWN:Uw(c.code);return new de(d,c.message||"")}(o);t=new qw(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=es(n,r.document.name),i=on(r.document.updateTime),o=r.document.createTime?on(r.document.createTime):Me.min(),a=new Pn({mapValue:{fields:r.document.fields}}),l=$t.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new dd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=es(n,r.document),i=r.readTime?on(r.readTime):Me.min(),o=$t.newNoDocument(s,i),a=r.removedTargetIds||[];t=new dd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=es(n,r.document),i=r.removedTargetIds||[];t=new dd([],i,s,null)}else{if(!("filter"in e))return Re();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new vC(s,i),a=r.targetId;t=new Bw(a,o)}}return t}function ku(n,e){let t;if(e instanceof sl)t={update:Uy(n,e.key,e.value)};else if(e instanceof il)t={delete:Cu(n,e.key)};else if(e instanceof $s)t={update:Uy(n,e.key,e.data),updateMask:DC(e.fieldMask)};else{if(!(e instanceof Im))return Re();t={verify:Cu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Ua)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Po)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ro)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ja)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Re()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:TC(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Re()}(n,e.precondition)),t}function Ep(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Kt.updateTime(on(i.updateTime)):i.exists!==void 0?Kt.exists(i.exists):Kt.none()}(e.currentDocument):Kt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Ce(a.setToServerValue==="REQUEST_TIME"),l=new Ua;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new Po(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Ro(d)}else"increment"in a?l=new ja(o,a.increment):Re();const c=zt.fromServerFormat(a.fieldPath);return new Zu(c,l)}(n,s)):[];if(e.update){e.update.name;const s=es(n,e.update.name),i=new Pn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new ar(c.map(d=>zt.fromServerFormat(d)))}(e.updateMask);return new $s(s,i,o,t,r)}return new sl(s,i,t,r)}if(e.delete){const s=es(n,e.delete);return new il(s,t)}if(e.verify){const s=es(n,e.verify);return new Im(s,t)}return Re()}function SC(n,e){return n&&n.length>0?(Ce(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?on(s.updateTime):on(i);return o.isEqual(Me.min())&&(o=on(i)),new pC(o,s.transformResults||[])}(t,e))):[]}function Jw(n,e){return{documents:[Gw(n,e.path)]}}function wh(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Gw(n,s);const i=function(c){if(c.length!==0)return eI(Et.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:ci(g.field),direction:RC(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=bp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function Yw(n,e,t,r){const{_t:s,parent:i}=wh(n,e),o={},a=[];let l=0;return t.forEach(c=>{const d=r?c.alias:"aggregate_"+l++;o[d]=c.alias,c.aggregateType==="count"?a.push({alias:d,count:{}}):c.aggregateType==="avg"?a.push({alias:d,avg:{field:ci(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:d,sum:{field:ci(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function Xw(n){let e=Hw(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ce(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const g=Zw(f);return g instanceof Et&&ym(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(T){return new Ru(va(T.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,Qu(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(f){const g=!!f.before,y=f.values||[];return new Ci(y,g)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const g=!f.before,y=f.values||[];return new Ci(y,g)}(t.endAt)),ww(e,s,o,i,a,"F",l,c)}function PC(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Zw(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=va(t.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=va(t.unaryFilter.field);return ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=va(t.unaryFilter.field);return ot.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=va(t.unaryFilter.field);return ot.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Re()}}(n):n.fieldFilter!==void 0?function(t){return ot.create(va(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Re()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Et.create(t.compositeFilter.filters.map(r=>Zw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Re()}}(t.compositeFilter.op))}(n):Re()}function RC(n){return bC[n]}function CC(n){return wC[n]}function kC(n){return IC[n]}function ci(n){return{fieldPath:n.canonicalString()}}function va(n){return zt.fromServerFormat(n.fieldPath)}function eI(n){return n instanceof ot?function(t){if(t.op==="=="){if(Ey(t.value))return{unaryFilter:{field:ci(t.field),op:"IS_NAN"}};if(Iy(t.value))return{unaryFilter:{field:ci(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ey(t.value))return{unaryFilter:{field:ci(t.field),op:"IS_NOT_NAN"}};if(Iy(t.value))return{unaryFilter:{field:ci(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ci(t.field),op:CC(t.op),value:t.value}}}(n):n instanceof Et?function(t){const r=t.getFilters().map(s=>eI(s));return r.length===1?r[0]:{compositeFilter:{op:kC(t.op),filters:r}}}(n):Re()}function DC(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function tI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,t,r,s,i=Me.min(),o=Me.min(),a=Zt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ws(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ws(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ws(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ws(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e){this.ct=e}}function NC(n,e){let t;if(e.document)t=Qw(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=xe.fromSegments(e.noDocument.path),s=ko(e.noDocument.readTime);t=$t.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re();{const r=xe.fromSegments(e.unknownDocument.path),s=ko(e.unknownDocument.version);t=$t.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Wt(s[0],s[1]);return Me.fromTimestamp(i)}(e.readTime)),t}function jy(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Ld(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Cu(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ba(i,o.version.toTimestamp()),createTime:Ba(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Co(e.version)};else{if(!e.isUnknownDocument())return Re();r.unknownDocument={path:t.path.toArray(),version:Co(e.version)}}return r}function Ld(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Co(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ko(n){const e=new Wt(n.seconds,n.nanoseconds);return Me.fromTimestamp(e)}function po(n,e){const t=(e.baseMutations||[]).map(i=>Ep(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Ep(n.ct,i)),s=Wt.fromMillis(e.localWriteTimeMs);return new Em(e.batchId,s,t,r)}function Yl(n){const e=ko(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ko(n.lastLimboFreeSnapshotVersion):Me.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return Ce(i.documents.length===1),Bn(rl(Hw(i.documents[0])))}(n.query):function(i){return Bn(Xw(i))}(n.query),new ws(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Zt.fromBase64String(n.resumeToken))}function rI(n,e){const t=Co(e.snapshotVersion),r=Co(e.lastLimboFreeSnapshotVersion);let s;s=Nd(e.target)?Jw(n.ct,e.target):wh(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:So(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Pm(n){const e=Xw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Od(e,e.limit,"L"):e}function Rf(n,e){return new xm(e.largestBatchId,Ep(n.ct,e.overlayMutation))}function By(n,e){const t=e.path.lastSegment();return[n,jn(e.path.popLast()),t]}function qy(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Co(r.readTime),documentKey:jn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{getBundleMetadata(e,t){return zy(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:ko(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return zy(e).put(function(s){return{bundleId:s.id,createTime:Co(on(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return Ky(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:Pm(i.bundledQuery),readTime:ko(i.readTime)}}(r)})}saveNamedQuery(e,t){return Ky(e).put(function(s){return{name:s.name,readTime:Co(on(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function zy(n){return yn(n,"bundles")}function Ky(n){return yn(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Ih(e,r)}getOverlay(e,t){return Fl(e).get(By(this.userId,t)).next(r=>r?Rf(this.serializer,r):null)}getOverlays(e,t){const r=Jr();return G.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new xm(t,o);s.push(this.ht(e,a))}),G.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(jn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Fl(e).j("collectionPathOverlayIndex",a))}),G.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Jr(),i=jn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Fl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Rf(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Jr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Fl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const f=Rf(this.serializer,c);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return Fl(e).put(function(s,i,o){const[a,l,c]=By(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ku(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Fl(n){return yn(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{Pt(e){return yn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Zt.fromUint8Array(r):Zt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(qt(e.integerValue));else if("doubleValue"in e){const r=qt(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),xu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=ks(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ds(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?dw(e)?this.dt(t,Number.MAX_SAFE_INTEGER):yh(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Re()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(qt(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),xe.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}mo.vt=new mo;function MC(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Gy(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=MC(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class LC{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=Gy(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=Gy(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class FC{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class $C{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class $l{constructor(){this.jt=new LC,this.Ht=new FC(this.jt),this.Jt=new $C(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new go(this.indexId,this.documentKey,this.arrayValue,r)}}function ri(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Hy(n.arrayValue,e.arrayValue),t!==0?t:(t=Hy(n.directionalValue,e.directionalValue),t!==0?t:xe.comparator(n.documentKey,e.documentKey)))}function Hy(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e){this.Xt=new At((t,r)=>zt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Ce(e.collectionGroup===this.collectionId),this.nn)return!1;const t=hp(e);if(t!==void 0&&!this.sn(t))return!1;const r=uo(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new At(zt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Io(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Io(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Io(r.field,r.dir==="asc"?0:1)));return new Ma(Ma.UNKNOWN_ID,this.collectionId,t,La.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(n){var e,t;if(Ce(n instanceof ot||n instanceof Et),n instanceof ot){if(n instanceof bw){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>ot.create(n.field,"==",i)))||[];return Et.create(s,"or")}return n}const r=n.filters.map(s=>sI(s));return Et.create(r,n.op)}function UC(n){if(n.getFilters().length===0)return[];const e=Ap(sI(n));return Ce(iI(e)),Tp(e)||xp(e)?[e]:e.getFilters()}function Tp(n){return n instanceof ot}function xp(n){return n instanceof Et&&ym(n)}function iI(n){return Tp(n)||xp(n)||function(t){if(t instanceof Et&&gp(t)){for(const r of t.getFilters())if(!Tp(r)&&!xp(r))return!1;return!0}return!1}(n)}function Ap(n){if(Ce(n instanceof ot||n instanceof Et),n instanceof ot)return n;if(n.filters.length===1)return Ap(n.filters[0]);const e=n.filters.map(r=>Ap(r));let t=Et.create(e,n.op);return t=Fd(t),iI(t)?t:(Ce(t instanceof Et),Ce($a(t)),Ce(t.filters.length>1),t.filters.reduce((r,s)=>Rm(r,s)))}function Rm(n,e){let t;return Ce(n instanceof ot||n instanceof Et),Ce(e instanceof ot||e instanceof Et),t=n instanceof ot?e instanceof ot?function(s,i){return Et.create([s,i],"and")}(n,e):Qy(n,e):e instanceof ot?Qy(e,n):function(s,i){if(Ce(s.filters.length>0&&i.filters.length>0),$a(s)&&$a(i))return vw(s,i.getFilters());const o=gp(s)?s:i,a=gp(s)?i:s,l=o.filters.map(c=>Rm(c,a));return Et.create(l,"or")}(n,e),Fd(t)}function Qy(n,e){if($a(e))return vw(e,n.getFilters());{const t=e.filters.map(r=>Rm(n,r));return Et.create(t,"or")}}function Fd(n){if(Ce(n instanceof ot||n instanceof Et),n instanceof ot)return n;const e=n.getFilters();if(e.length===1)return Fd(e[0]);if(mw(n))return n;const t=e.map(s=>Fd(s)),r=[];return t.forEach(s=>{s instanceof ot?r.push(s):s instanceof Et&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Et.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(){this.un=new Cm}addToCollectionParentIndex(e,t){return this.un.add(t),G.resolve()}getCollectionParents(e,t){return G.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return G.resolve()}deleteFieldIndex(e,t){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,t){return G.resolve()}getDocumentsMatchingTarget(e,t){return G.resolve(null)}getIndexType(e,t){return G.resolve(0)}getFieldIndexes(e,t){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,t){return G.resolve(pr.min())}getMinOffsetFromCollectionGroup(e,t){return G.resolve(pr.min())}updateCollectionGroup(e,t,r){return G.resolve()}updateIndexEntries(e,t){return G.resolve()}}class Cm{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new At(it.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new At(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=new Uint8Array(0);class BC{constructor(e,t){this.databaseId=t,this.cn=new Cm,this.ln=new Fs(r=>So(r),(r,s)=>Ju(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:jn(s)};return Jy(e).put(i)}return G.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Yb(t),""],!1,!0);return Jy(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Qr(o.parent))}return r})}addFieldIndex(e,t){const r=Ul(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=da(e);return i.next(a=>{o.put(qy(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Ul(e),s=da(e),i=ca(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ul(e),r=ca(e),s=da(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return G.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Wy(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=ca(e);let s=!0;const i=new Map;return G.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ye();const a=[];return G.forEach(i,(l,c)=>{ce("IndexedDbIndexManager",`Using index ${function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(l)} to execute ${So(t)}`);const d=function(M,z){const he=hp(z);if(he===void 0)return null;for(const pe of Vd(M,he.fieldPath))switch(pe.op){case"array-contains-any":return pe.value.arrayValue.values||[];case"array-contains":return[pe.value]}return null}(c,l),f=function(M,z){const he=new Map;for(const pe of uo(z))for(const x of Vd(M,pe.fieldPath))switch(x.op){case"==":case"in":he.set(pe.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return he.set(pe.fieldPath.canonicalString(),x.value),Array.from(he.values())}return null}(c,l),g=function(M,z){const he=[];let pe=!0;for(const x of uo(z)){const I=x.kind===0?Py(M,x.fieldPath,M.startAt):Ry(M,x.fieldPath,M.startAt);he.push(I.value),pe&&(pe=I.inclusive)}return new Ci(he,pe)}(c,l),y=function(M,z){const he=[];let pe=!0;for(const x of uo(z)){const I=x.kind===0?Ry(M,x.fieldPath,M.endAt):Py(M,x.fieldPath,M.endAt);he.push(I.value),pe&&(pe=I.inclusive)}return new Ci(he,pe)}(c,l),T=this.In(l,c,g),A=this.In(l,c,y),P=this.Tn(l,c,f),U=this.En(l.indexId,d,T,g.inclusive,A,y.inclusive,P);return G.forEach(U,q=>r.G(q,t.limit).next(M=>{M.forEach(z=>{const he=xe.fromSegments(z.documentKey);o.has(he)||(o=o.add(he),a.push(he))})}))}).next(()=>a)}return G.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=UC(Et.create(e.filters,"and")).map(r=>yp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),c=l/(t!=null?t.length:1),d=[];for(let f=0;f<l;++f){const g=t?this.dn(t[f/c]):Kc,y=this.An(e,g,r[f%c],s),T=this.Rn(e,g,i[f%c],o),A=a.map(P=>this.An(e,g,P,!0));d.push(...this.createRange(y,T,A))}return d}An(e,t,r,s){const i=new go(e,xe.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new go(e,xe.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new Wy(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return G.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new At(zt.comparator),d=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:c=c.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new $l;for(const s of uo(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);mo.vt.It(i,o)}return r.zt()}dn(e){const t=new $l;return mo.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new $l;return mo.vt.It(Ao(this.databaseId,t),r.Yt(function(i){const o=uo(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new $l);let i=0;for(const o of uo(e)){const a=r[i++];for(const l of s)if(this.fn(t,o.fieldPath)&&Pu(a))s=this.gn(s,o,a);else{const c=l.Yt(o.kind);mo.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new $l;l.seed(a.zt()),mo.vt.It(o,l.Yt(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof ot&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ul(e),s=da(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return G.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(d,f){const g=f?new La(f.sequenceNumber,new pr(ko(f.readTime),new xe(Qr(f.documentKey)),f.largestBatchId)):La.empty(),y=d.fields.map(([T,A])=>new Io(zt.fromServerFormat(T),A));return new Ma(d.indexId,d.collectionGroup,y,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ze(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Ul(e),i=da(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>G.forEach(a,l=>i.put(qy(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return G.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?G.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),G.forEach(a,l=>this.wn(e,s,l).next(c=>{const d=this.Sn(i,l);return c.isEqual(d)?G.resolve():this.bn(e,i,l,c,d)}))))})}Dn(e,t,r,s){return ca(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return ca(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=ca(e);let i=new At(ri);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new go(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new At(ri);const s=this.Vn(t,e);if(s==null)return r;const i=hp(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Pu(o))for(const a of o.arrayValue.values||[])r=r.add(new go(t.indexId,e.key,this.dn(a),s))}else r=r.add(new go(t.indexId,e.key,Kc,s));return r}bn(e,t,r,s,i){ce("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,c,d,f,g){const y=l.getIterator(),T=c.getIterator();let A=ua(y),P=ua(T);for(;A||P;){let U=!1,q=!1;if(A&&P){const M=d(A,P);M<0?q=!0:M>0&&(U=!0)}else A!=null?q=!0:U=!0;U?(f(P),P=ua(T)):q?(g(A),A=ua(y)):(A=ua(y),P=ua(T))}}(s,i,ri,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),G.waitFor(o)}yn(e){let t=1;return da(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ri(o,a)).filter((o,a,l)=>!a||ri(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ri(o,e),l=ri(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Kc,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Kc,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,t){return ri(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Yy)}getMinOffset(e,t){return G.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||Re())).next(Yy)}}function Jy(n){return yn(n,"collectionParents")}function ca(n){return yn(n,"indexEntries")}function Ul(n){return yn(n,"indexConfiguration")}function da(n){return yn(n,"indexState")}function Yy(n){Ce(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;mm(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new pr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ln{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ln(e,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(d,f,g)=>(a++,g.delete()));i.push(l.next(()=>{Ce(a===1)}));const c=[];for(const d of t.mutations){const f=sw(e,d.key.path,t.batchId);i.push(s.delete(f)),c.push(d.key)}return G.waitFor(i).next(()=>c)}function $d(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(41943040,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);class Eh{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){Ce(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Eh(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return si(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=ya(e),o=si(e);return o.add({}).next(a=>{Ce(typeof a=="number");const l=new Em(a,t,r,s),c=function(y,T,A){const P=A.baseMutations.map(q=>ku(y.ct,q)),U=A.mutations.map(q=>ku(y.ct,q));return{userId:T,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:P,mutations:U}}(this.serializer,this.userId,l),d=[];let f=new At((g,y)=>ze(g.canonicalString(),y.canonicalString()));for(const g of s){const y=sw(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(c)),d.push(i.put(y,CR))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),G.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return si(e).get(t).next(r=>r?(Ce(r.userId===this.userId),po(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?G.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return si(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(Ce(a.batchId>=r),i=po(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return si(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return si(e).U("userMutationsIndex",t).next(r=>r.map(s=>po(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=od(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return ya(e).J({range:s},(o,a,l)=>{const[c,d,f]=o,g=Qr(d);if(c===this.userId&&t.path.isEqual(g))return si(e).get(f).next(y=>{if(!y)throw Re();Ce(y.userId===this.userId),i.push(po(this.serializer,y))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new At(ze);const s=[];return t.forEach(i=>{const o=od(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=ya(e).J({range:a},(c,d,f)=>{const[g,y,T]=c,A=Qr(y);g===this.userId&&i.path.isEqual(A)?r=r.add(T):f.done()});s.push(l)}),G.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=od(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new At(ze);return ya(e).J({range:o},(l,c,d)=>{const[f,g,y]=l,T=Qr(g);f===this.userId&&r.isPrefixOf(T)?T.length===s&&(a=a.add(y)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(si(e).get(i).next(o=>{if(o===null)throw Re();Ce(o.userId===this.userId),r.push(po(this.serializer,o))}))}),G.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return oI(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),G.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return G.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ya(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Qr(i[1]);s.push(l)}else a.done()}).next(()=>{Ce(s.length===0)})})}containsKey(e,t){return aI(e,this.userId,t)}Nn(e){return lI(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function aI(n,e,t){const r=od(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ya(n).J({range:i,H:!0},(a,l,c)=>{const[d,f,g]=a;d===e&&f===s&&(o=!0),c.done()}).next(()=>o)}function si(n){return yn(n,"mutations")}function ya(n){return yn(n,"documentMutations")}function lI(n){return yn(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Do(0)}static kn(){return new Do(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new Do(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>Me.fromTimestamp(new Wt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ha(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Ce(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return ha(e).J((o,a)=>{const l=Yl(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>G.waitFor(i)).next(()=>s)}forEachTarget(e,t){return ha(e).J((r,s)=>{const i=Yl(s);t(i)})}qn(e){return Zy(e).get("targetGlobalKey").next(t=>(Ce(t!==null),t))}Qn(e,t){return Zy(e).put("targetGlobalKey",t)}Kn(e,t){return ha(e).put(rI(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=So(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ha(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const c=Yl(a);Ju(t,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=di(e);return t.forEach(o=>{const a=jn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),G.waitFor(s)}removeMatchingKeys(e,t,r){const s=di(e);return G.forEach(t,i=>{const o=jn(i.path);return G.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=di(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=di(e);let i=Ye();return s.J({range:r,H:!0},(o,a,l)=>{const c=Qr(o[1]),d=new xe(c);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=jn(t.path),s=IDBKeyRange.bound([r],[Yb(r)],!1,!0);let i=0;return di(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return ha(e).get(t).next(r=>r?Yl(r):null)}}function ha(n){return yn(n,"targets")}function Zy(n){return yn(n,"targetGlobal")}function di(n){return yn(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_([n,e],[t,r]){const s=ze(n,t);return s===0?ze(e,r):s}class zC{constructor(e){this.Un=e,this.buffer=new At(e_),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();e_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class uI{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){ce("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fi(t)?ce("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Li(t)}await this.Hn(3e5)})}}class KC{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return G.resolve(or.oe);const r=new zC(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),G.resolve(Xy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xy):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),ma()<=st.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),G.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function cI(n,e){return new KC(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,t){this.db=e,this.garbageCollector=cI(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Gc(e,r)}removeReference(e,t,r){return Gc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Gc(e,t)}nr(e,t){return function(s,i){let o=!1;return lI(s).Y(a=>aI(s,a,i).next(l=>(l&&(o=!0),G.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Me.min()),di(e).delete(function(f){return[0,jn(f.path)]}(o))))});s.push(l)}}).next(()=>G.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Gc(e,t)}tr(e,t){const r=di(e);let s,i=or.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==or.oe&&t(new xe(Qr(s)),i),i=c,s=l):i=or.oe}).next(()=>{i!==or.oe&&t(new xe(Qr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Gc(n,e){return di(n).put(function(r,s){return{targetId:0,path:jn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(){this.changes=new Fs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$t.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?G.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return oo(e).put(r)}removeEntry(e,t,r){return oo(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ld(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=$t.newInvalidDocument(t);return oo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(jl(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:$t.newInvalidDocument(t)};return oo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(jl(t))},(s,i)=>{r={document:this.ir(t,i),size:$d(i)}}).next(()=>r)}getEntries(e,t){let r=lr();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=lr(),s=new Ot(xe.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,$d(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return G.resolve();let s=new At(r_);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(jl(s.first()),jl(s.last())),o=s.getIterator();let a=o.getNext();return oo(e).J({index:"documentKeyIndex",range:i},(l,c,d)=>{const f=xe.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&r_(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(jl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Ld(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return oo(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=lr();for(const f of c){const g=this.ir(xe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Xu(t,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=lr();const o=n_(t,r),a=n_(t,pr.max());return oo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const f=this.ir(xe.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new WC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return t_(e).get("remoteDocumentGlobalKey").next(t=>(Ce(!!t),t))}rr(e,t){return t_(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=NC(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Me.min())))return r}return $t.newInvalidDocument(e)}}function hI(n){return new HC(n)}class WC extends dI{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Fs(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new At((i,o)=>ze(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=jy(this.cr.serializer,o);s=s.add(i.path.popLast());const c=$d(l);r+=c-a.size,t.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=jy(this.cr.serializer,o.convertToNoDocument(Me.min()));t.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),G.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function t_(n){return yn(n,"remoteDocumentGlobal")}function oo(n){return yn(n,"remoteDocumentsV14")}function jl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function n_(n,e){const t=e.documentKey.path.toArray();return[n,Ld(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function r_(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=ze(t[i],r[i]),s)return s;return s=ze(t.length,r.length),s||(s=ze(t[t.length-2],r[r.length-2]),s||ze(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&hu(r.mutation,s,ar.empty(),Wt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ye()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ye()){const s=Jr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Ql();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Jr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ye()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=lr();const o=du(),a=function(){return du()}();return t.forEach((l,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof $s)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),hu(d.mutation,c,d.mutation.getFieldMask(),Wt.now())):o.set(c.key,ar.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var f;return a.set(c,new QC(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=du();let s=new Ot((o,a)=>o-a),i=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let d=r.get(l)||ar.empty();d=a.applyToLocalView(c,d),r.set(l,d);const f=(s.get(a.batchId)||Ye()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,f=Rw();d.forEach(g=>{if(!i.has(g)){const y=Mw(t.get(g),r.get(g));y!==null&&f.set(g,y),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return G.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return xe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_m(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):G.resolve(Jr());let a=-1,l=i;return o.next(c=>G.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?G.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ye())).next(d=>({batchId:a,changes:Pw(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xe(t)).next(r=>{let s=Ql();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Ql();return this.indexManager.getCollectionParents(e,i).next(a=>G.forEach(a,l=>{const c=function(f,g){return new Ls(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,$t.newInvalidDocument(d)))});let a=Ql();return o.forEach((l,c)=>{const d=i.get(l);d!==void 0&&hu(d.mutation,c,ar.empty(),Wt.now()),Xu(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return G.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:on(s.createTime)}}(t)),G.resolve()}getNamedQuery(e,t){return G.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:Pm(s.bundledQuery),readTime:on(s.readTime)}}(t)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(){this.overlays=new Ot(xe.comparator),this.Ir=new Map}getOverlay(e,t){return G.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Jr();return G.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),G.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),G.resolve()}getOverlaysForCollection(e,t,r){const s=Jr(),i=t.length+1,o=new xe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return G.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Ot((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=Jr(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Jr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return G.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new xm(t,r));let i=this.Ir.get(t);i===void 0&&(i=Ye(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(){this.Tr=new At(bn.Er),this.dr=new At(bn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new bn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new bn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new xe(new it([])),r=new bn(t,e),s=new bn(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new xe(new it([])),r=new bn(t,e),s=new bn(t,e+1);let i=Ye();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new bn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class bn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return xe.comparator(e.key,t.key)||ze(e.wr,t.wr)}static Ar(e,t){return ze(e.wr,t.wr)||xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new At(bn.Er)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Em(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new bn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return G.resolve(o)}lookupMutationBatch(e,t){return G.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return G.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new bn(t,0),s=new bn(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),G.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new At(ze);return t.forEach(s=>{const i=new bn(s,0),o=new bn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),G.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;xe.isDocumentKey(i)||(i=i.child(""));const o=new bn(new xe(i),0);let a=new At(ze);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.wr)),!0)},o),G.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ce(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return G.forEach(t.mutations,s=>{const i=new bn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new bn(t,0),s=this.br.firstAfterOrEqual(r);return G.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.Mr=e,this.docs=function(){return new Ot(xe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return G.resolve(r?r.document.mutableCopy():$t.newInvalidDocument(t))}getEntries(e,t){let r=lr();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():$t.newInvalidDocument(s))}),G.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=lr();const o=t.path,a=new xe(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||mm(Zb(d),r)<=0||(s.has(d.key)||Xu(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return G.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Re()}Or(e,t){return G.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new tk(this)}getSize(e){return G.resolve(this.size)}}class tk extends dI{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),G.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.persistence=e,this.Nr=new Fs(t=>So(t),Ju),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.Lr=0,this.Br=new km,this.targetCount=0,this.kr=Do.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),G.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Do(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,G.resolve()}updateTargetData(e,t){return this.Kn(t),G.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),G.waitFor(i).next(()=>s)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return G.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),G.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),G.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),G.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return G.resolve(r)}containsKey(e,t){return G.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,t){this.qr={},this.overlays={},this.Qr=new or(0),this.Kr=!1,this.Kr=!0,this.$r=new XC,this.referenceDelegate=e(this),this.Ur=new nk(this),this.indexManager=new jC,this.remoteDocumentCache=function(s){return new ek(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new nI(t),this.Gr=new JC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new ZC(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){ce("MemoryPersistence","Starting transaction:",e);const s=new rk(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return G.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class rk extends tw{constructor(e){super(),this.currentSequenceNumber=e}}class Th{constructor(e){this.persistence=e,this.Jr=new km,this.Yr=null}static Zr(e){return new Th(e)}get Xr(){if(this.Yr)return this.Yr;throw Re()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),G.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),G.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.Xr,r=>{const s=xe.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,Me.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return G.or([()=>G.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Ud{constructor(e,t){this.persistence=e,this.ti=new Fs(r=>jn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=cI(this,t)}static Zr(e,t){return new Ud(e,t)}zr(){}jr(e){return G.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return G.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?G.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,Me.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),G.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),G.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),G.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),G.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ld(e.data.value)),t}nr(e,t,r){return G.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ti.get(t);return G.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.serializer=e}O(e,t,r,s){const i=new mh("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vy,{unique:!0}),l.createObjectStore("documentMutations")}(e),s_(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=G.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),s_(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Me.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vy,{unique:!0});const f=c.store("mutations"),g=d.map(y=>f.put(y));return G.waitFor(g)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:BR});c.createIndex("collectionPathOverlayIndex",qR,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",zR,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:kR});c.createIndex("documentKeyIndex",DR),c.createIndex("collectionGroupIndex",NR)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:FR}).createIndex("sequenceNumberIndex",$R,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:UR}).createIndex("documentKeyIndex",jR,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=$d(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>G.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>G.forEach(a,l=>{Ce(l.userId===i.userId);const c=po(this.serializer,l);return oI(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new it(o),c=function(f){return[0,jn(f)]}(l);i.push(t.get(c).next(d=>d?G.resolve():(f=>t.put({targetId:0,path:jn(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>G.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:LR});const r=t.store("collectionParents"),s=new Cm,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:jn(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new it(o);return i(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Qr(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Yl(s),o=rI(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),l=function(f){return f.document?new xe(it.fromString(f.document.name).popFirst(5)):f.noDocument?xe.fromSegments(f.noDocument.path):f.unknownDocument?xe.fromSegments(f.unknownDocument.path):Re()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>G.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=hI(this.serializer),i=new Dm(Th.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:Ye();po(this.serializer,l).keys().forEach(f=>d=d.add(f)),a.set(l.userId,d)}),G.forEach(a,(l,c)=>{const d=new wn(c),f=Ih.lt(this.serializer,d),g=i.getIndexManager(d),y=Eh.lt(d,this.serializer,g,i.referenceDelegate);return new fI(s,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new fp(t,or.oe),l).next()})})}}function s_(n){n.createObjectStore("targetDocuments",{keyPath:OR}).createIndex("documentTargetsIndex",MR,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",VR,{unique:!0}),n.createObjectStore("targetGlobal")}const Cf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Nm{constructor(e,t,r,s,i,o,a,l,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!Nm.D())throw new de(H.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new GC(this,s),this.Ai=t+"main",this.serializer=new nI(l),this.Ri=new Zr(this.Ai,this.hi,new sk(this.serializer)),this.$r=new OC,this.Ur=new qC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hI(this.serializer),this.Gr=new VC,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&rn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new de(H.FAILED_PRECONDITION,Cf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new or(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Hc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Fi(e))return ce("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Bl(e).get("owner").next(t=>G.resolve(this.vi(t)))}Ci(e){return Hc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=yn(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return G.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?G.resolve(!0):Bl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new de(H.FAILED_PRECONDITION,Cf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Hc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&ce("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new fp(e,or.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Hc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Eh.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new BC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ih.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){ce("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===17?HR:l===16?GR:l===15?vm:l===14?aw:l===13?ow:l===12?KR:l===11?iw:void Re()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new fp(a,this.Qr?this.Qr.next():or.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw rn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new de(H.FAILED_PRECONDITION,ew);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Bl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new de(H.FAILED_PRECONDITION,Cf)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Bl(e).put("owner",t)}static D(){return Zr.D()}bi(e){const t=Bl(e);return t.get("owner").next(r=>this.vi(r)?(ce("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):G.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(rn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;Ob()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return ce("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return rn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){rn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Bl(n){return yn(n,"owner")}function Hc(n){return yn(n,"clientMetadata")}function Vm(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Ye(),s=Ye();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Om(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Ob()?8:nw(vn())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ik;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(ma()<=st.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",ga(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),G.resolve()):(ma()<=st.DEBUG&&ce("QueryEngine","Query:",ga(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ma()<=st.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",ga(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bn(t))):G.resolve())}Yi(e,t){if(Cy(t))return G.resolve(null);let r=Bn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Od(t,null,"F"),r=Bn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ye(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,o,l.readTime)?this.Yi(e,Od(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,s){return Cy(t)||s.isEqual(Me.min())?G.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?G.resolve(null):(ma()<=st.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ga(t)),this.rs(e,o,t,Xb(s,-1)).next(a=>a))})}ts(e,t){let r=new At(Aw(e));return t.forEach((s,i)=>{Xu(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return ma()<=st.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",ga(t)),this.Ji.getDocumentsMatchingQuery(e,t,pr.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Ot(ze),this._s=new Fs(i=>So(i),Ju),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function mI(n,e,t,r){return new ok(n,e,t,r)}async function gI(n,e){const t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ye();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function ak(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const f=c.batch,g=f.keys();let y=G.resolve();return g.forEach(T=>{y=y.next(()=>d.getEntry(l,T)).next(A=>{const P=c.docVersions.get(T);Ce(P!==null),A.version.compareTo(P)<0&&(f.applyToRemoteDocument(A,c),A.isValidDocument()&&(A.setReadTime(c.commitVersion),d.addEntry(A)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ye();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function vI(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function lk(n,e){const t=Ee(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let y=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Zt.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),s=s.insert(f,y),function(A,P,U){return A.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(g,y,d)&&a.push(t.Ur.updateTargetData(i,y))});let l=lr(),c=Ye();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(yI(i,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(Me.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return G.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.os=s,i))}function yI(n,e,t){let r=Ye(),s=Ye();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=lr();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ce("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function uk(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function qa(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,G.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new ws(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function za(n,e,t){const r=Ee(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Fi(o))throw o;ce("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function jd(n,e,t){const r=Ee(n);let s=Me.min(),i=Ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const f=Ee(l),g=f._s.get(d);return g!==void 0?G.resolve(f.os.get(g)):f.Ur.getTargetData(c,d)}(r,o,Bn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:Me.min(),t?i:Ye())).next(a=>(wI(r,xw(e),a),{documents:a,Ts:i})))}function _I(n,e){const t=Ee(n),r=Ee(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function bI(n,e){const t=Ee(n),r=t.us.get(e)||Me.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,Xb(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(wI(t,e,s),s))}function wI(n,e,t){let r=n.us.get(e)||Me.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function ck(n,e,t,r){const s=Ee(n);let i=Ye(),o=lr();for(const c of t){const d=e.Es(c.metadata.name);c.document&&(i=i.add(d));const f=e.ds(c);f.setReadTime(e.As(c.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),l=await qa(s,function(d){return Bn(rl(it.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>yI(c,a,o).next(d=>(a.apply(c),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(c,l.targetId).next(()=>s.Ur.addMatchingKeys(c,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,d.Ps,d.Is)).next(()=>d.Ps)))}async function dk(n,e,t=Ye()){const r=await qa(n,Bn(Pm(e.bundledQuery))),s=Ee(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=on(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(Zt.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function i_(n,e){return`firestore_clients_${n}_${e}`}function o_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function kf(n,e){return`firestore_targets_${n}_${e}`}class Bd{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new de(s.error.code,s.error.message))),o?new Bd(e,t,s.state,i):(rn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class fu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new de(r.error.code,r.error.message))),i?new fu(e,r.state,s):(rn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class qd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=bm();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=rw(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new qd(e,i):(rn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Mm{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Mm(t.clientId,t.onlineState):(rn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Sp{constructor(){this.activeTargetIds=bm()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Df{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ot(ze),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=i_(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Sp),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(i_(this.persistenceKey,r));if(s){const i=qd.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(kf(this.persistenceKey,e));if(s){const i=fu.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kf(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ce("SharedClientState","READ",e,t),t}setItem(e,t){ce("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){ce("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(ce("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void rn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=or.oe;if(i!=null)try{const a=JSON.parse(i);Ce(typeof a=="number"),o=a}catch(a){rn("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==or.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new Bd(this.currentUser,e,t,r),i=o_(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=o_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=kf(this.persistenceKey,e),i=new fu(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return qd.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Bd.Rs(new wn(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return fu.Rs(s,t)}Ls(e){return Mm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);ce("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=bm();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class II{constructor(){this.so=new Sp,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Sp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ce("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ce("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wc=null;function Nf(){return Wc===null?Wc=function(){return 268435456+Math.round(2147483648*Math.random())}():Wc++,"0x"+Wc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On="WebChannelConnection";class mk extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Nf(),l=this.xo(t,r.toUriEncodedString());ce("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,l,c,s).then(d=>(ce("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw xr("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=fk[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Nf();return new Promise((o,a)=>{const l=new qb;l.setWithCredentials(!0),l.listenOnce(zb.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case id.NO_ERROR:const d=l.getResponseJson();ce(On,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case id.TIMEOUT:ce(On,`RPC '${e}' ${i} timed out`),a(new de(H.DEADLINE_EXCEEDED,"Request time out"));break;case id.HTTP_ERROR:const f=l.getStatus();if(ce(On,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g==null?void 0:g.error;if(y&&y.status&&y.message){const T=function(P){const U=P.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(U)>=0?U:H.UNKNOWN}(y.status);a(new de(T,y.message))}else a(new de(H.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new de(H.UNAVAILABLE,"Connection failed."));break;default:Re()}}finally{ce(On,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);ce(On,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=Nf(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Hb(),a=Gb(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");ce(On,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let g=!1,y=!1;const T=new pk({Io:P=>{y?ce(On,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(ce(On,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),ce(On,`RPC '${e}' stream ${s} sending:`,P),f.send(P))},To:()=>f.close()}),A=(P,U,q)=>{P.listen(U,M=>{try{q(M)}catch(z){setTimeout(()=>{throw z},0)}})};return A(f,Wl.EventType.OPEN,()=>{y||(ce(On,`RPC '${e}' stream ${s} transport opened.`),T.yo())}),A(f,Wl.EventType.CLOSE,()=>{y||(y=!0,ce(On,`RPC '${e}' stream ${s} transport closed`),T.So())}),A(f,Wl.EventType.ERROR,P=>{y||(y=!0,xr(On,`RPC '${e}' stream ${s} transport errored:`,P),T.So(new de(H.UNAVAILABLE,"The operation could not be completed")))}),A(f,Wl.EventType.MESSAGE,P=>{var U;if(!y){const q=P.data[0];Ce(!!q);const M=q,z=M.error||((U=M[0])===null||U===void 0?void 0:U.error);if(z){ce(On,`RPC '${e}' stream ${s} received error:`,z);const he=z.status;let pe=function(w){const C=hn[w];if(C!==void 0)return Uw(C)}(he),x=z.message;pe===void 0&&(pe=H.INTERNAL,x="Unknown error status: "+he+" with message "+z.message),y=!0,T.So(new de(pe,x)),f.close()}else ce(On,`RPC '${e}' stream ${s} received:`,q),T.bo(q)}}),A(a,Kb.STAT_EVENT,P=>{P.stat===dp.PROXY?ce(On,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===dp.NOPROXY&&ce(On,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(){return typeof window<"u"?window:null}function hd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){return new EC(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&ce("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lm(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===H.RESOURCE_EXHAUSTED?(rn(t.toString()),rn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new de(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ce("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ce("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gk extends TI{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=AC(this.serializer,e),r=function(i){if(!("targetChange"in i))return Me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Me.min():o.readTime?on(o.readTime):Me.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Ip(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Nd(l)?{documents:Jw(i,l)}:{query:wh(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zw(i,o.resumeToken);const c=bp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Me.min())>0){a.readTime=Ba(i,o.snapshotVersion.toTimestamp());const c=bp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=PC(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Ip(this.serializer),t.removeTarget=e,this.a_(t)}}class vk extends TI{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ce(!!e.streamToken),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ce(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=SC(e.writeResults,e.commitTime),r=on(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Ip(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>ku(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new de(H.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,wp(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new de(H.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,wp(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(H.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class _k{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(rn(t),this.D_=!1):ce("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Ui(this)&&(ce("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ee(l);c.L_.add(4),await ol(c),c.q_.set("Unknown"),c.L_.delete(4),await rc(c)}(this))})}),this.q_=new _k(r,s)}}async function rc(n){if(Ui(n))for(const e of n.B_)await e(!0)}async function ol(n){for(const e of n.B_)await e(!1)}function xh(n,e){const t=Ee(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Um(t)?$m(t):ll(t).r_()&&Fm(t,e))}function Ka(n,e){const t=Ee(n),r=ll(t);t.N_.delete(e),r.r_()&&xI(t,e),t.N_.size===0&&(r.r_()?r.o_():Ui(t)&&t.q_.set("Unknown"))}function Fm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ll(n).A_(e)}function xI(n,e){n.Q_.xe(e),ll(n).R_(e)}function $m(n){n.Q_=new _C({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ll(n).start(),n.q_.v_()}function Um(n){return Ui(n)&&!ll(n).n_()&&n.N_.size>0}function Ui(n){return Ee(n).L_.size===0}function AI(n){n.Q_=void 0}async function wk(n){n.q_.set("Online")}async function Ik(n){n.N_.forEach((e,t)=>{Fm(n,e)})}async function Ek(n,e){AI(n),Um(n)?(n.q_.M_(e),$m(n)):n.q_.set("Unknown")}async function Tk(n,e,t){if(n.q_.set("Online"),e instanceof qw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){ce("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zd(n,r)}else if(e instanceof dd?n.Q_.Ke(e):e instanceof Bw?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Me.min()))try{const r=await vI(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(c);d&&i.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(Zt.EMPTY_BYTE_STRING,d.snapshotVersion)),xI(i,l);const f=new ws(d.target,l,c,d.sequenceNumber);Fm(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){ce("RemoteStore","Failed to raise snapshot:",r),await zd(n,r)}}async function zd(n,e,t){if(!Fi(e))throw e;n.L_.add(1),await ol(n),n.q_.set("Offline"),t||(t=()=>vI(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ce("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await rc(n)})}function SI(n,e){return e().catch(t=>zd(n,t,e))}async function al(n){const e=Ee(n),t=ki(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;xk(e);)try{const s=await uk(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,Ak(e,s)}catch(s){await zd(e,s)}PI(e)&&RI(e)}function xk(n){return Ui(n)&&n.O_.length<10}function Ak(n,e){n.O_.push(e);const t=ki(n);t.r_()&&t.V_&&t.m_(e.mutations)}function PI(n){return Ui(n)&&!ki(n).n_()&&n.O_.length>0}function RI(n){ki(n).start()}async function Sk(n){ki(n).p_()}async function Pk(n){const e=ki(n);for(const t of n.O_)e.m_(t.mutations)}async function Rk(n,e,t){const r=n.O_.shift(),s=Tm.from(r,e,t);await SI(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await al(n)}async function Ck(n,e){e&&ki(n).V_&&await async function(r,s){if(function(o){return $w(o)&&o!==H.ABORTED}(s.code)){const i=r.O_.shift();ki(r).s_(),await SI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await al(r)}}(n,e),PI(n)&&RI(n)}async function l_(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),ce("RemoteStore","RemoteStore received new credentials");const r=Ui(t);t.L_.add(3),await ol(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await rc(t)}async function Pp(n,e){const t=Ee(n);e?(t.L_.delete(2),await rc(t)):e||(t.L_.add(2),await ol(t),t.q_.set("Unknown"))}function ll(n){return n.K_||(n.K_=function(t,r,s){const i=Ee(t);return i.w_(),new gk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:wk.bind(null,n),Ro:Ik.bind(null,n),mo:Ek.bind(null,n),d_:Tk.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Um(n)?$m(n):n.q_.set("Unknown")):(await n.K_.stop(),AI(n))})),n.K_}function ki(n){return n.U_||(n.U_=function(t,r,s){const i=Ee(t);return i.w_(),new vk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Sk.bind(null,n),mo:Ck.bind(null,n),f_:Pk.bind(null,n),g_:Rk.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await al(n)):(await n.U_.stop(),n.O_.length>0&&(ce("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new In,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new jm(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ul(n,e){if(rn("AsyncQueue",`${e}: ${n}`),Fi(n))return new de(H.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.comparator=e?(t,r)=>e(t,r)||xe.comparator(t.key,r.key):(t,r)=>xe.comparator(t.key,r.key),this.keyedMap=Ql(),this.sortedSet=new Ot(this.comparator)}static emptySet(e){return new Aa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Aa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Aa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(){this.W_=new Ot(xe.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Re():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ga{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Ga(e,t,Aa.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Dk{constructor(){this.queries=c_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=Ee(t),i=s.queries;s.queries=c_(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new de(H.ABORTED,"Firestore shutting down"))}}function c_(){return new Fs(n=>Tw(n),Yu)}async function Bm(n,e){const t=Ee(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new kk,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=ul(o,`Initialization of query '${ga(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&zm(t)}async function qm(n,e){const t=Ee(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Nk(n,e){const t=Ee(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&zm(t)}function Vk(n,e,t){const r=Ee(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function zm(n){n.Y_.forEach(e=>{e.next()})}var Rp,d_;(d_=Rp||(Rp={})).ea="default",d_.Cache="cache";class Km{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ga(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ga.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Rp.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e){this.serializer=e}Es(e){return es(this.serializer,e)}ds(e){return e.metadata.exists?Qw(this.serializer,e.document,!1):$t.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return on(e)}}class Mk{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=CI(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=it.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new h_(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||Ye()).add(i);t.set(o,a)}}return t}async complete(){const e=await ck(this.localStore,new h_(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await dk(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function CI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e){this.key=e}}class DI{constructor(e){this.key=e}}class NI{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ye(),this.mutatedKeys=Ye(),this.Aa=Aw(e),this.Ra=new Aa(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new u_,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),y=Xu(this.query,f)?f:null,T=!!g&&this.mutatedKeys.has(g.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let P=!1;g&&y?g.data.isEqual(y.data)?T!==A&&(r.track({type:3,doc:y}),P=!0):this.ga(g,y)||(r.track({type:2,doc:y}),P=!0,(l&&this.Aa(y,l)>0||c&&this.Aa(y,c)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),P=!0):g&&!y&&(r.track({type:1,doc:g}),P=!0,(l||c)&&(a=!0)),P&&(y?(o=o.add(y),i=A?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(y,T){const A=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re()}};return A(y)-A(T)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new Ga(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new u_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ye(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new DI(r))}),this.da.forEach(r=>{e.has(r)||t.push(new kI(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ye();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ga.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Lk{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Fk{constructor(e){this.key=e,this.va=!1}}class $k{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Fs(a=>Tw(a),Yu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ot(xe.comparator),this.Na=new Map,this.La=new km,this.Ba={},this.ka=new Map,this.qa=Do.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Uk(n,e,t=!0){const r=Ah(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await VI(r,e,t,!0),s}async function jk(n,e){const t=Ah(n);await VI(t,e,!0,!1)}async function VI(n,e,t,r){const s=await qa(n.localStore,Bn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Gm(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&xh(n.remoteStore,s),a}async function Gm(n,e,t,r,s){n.Ka=(f,g,y)=>async function(A,P,U,q){let M=P.view.ma(U);M.ns&&(M=await jd(A.localStore,P.query,!1).then(({documents:x})=>P.view.ma(x,M)));const z=q&&q.targetChanges.get(P.targetId),he=q&&q.targetMismatches.get(P.targetId)!=null,pe=P.view.applyChanges(M,A.isPrimaryClient,z,he);return Cp(A,P.targetId,pe.wa),pe.snapshot}(n,f,g,y);const i=await jd(n.localStore,e,!0),o=new NI(e,i.Ts),a=o.ma(i.documents),l=tc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);Cp(n,t,c.wa);const d=new Lk(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function Bk(n,e,t){const r=Ee(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Yu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await za(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Ka(r.remoteStore,s.targetId),Ha(r,s.targetId)}).catch(Li)):(Ha(r,s.targetId),await za(r.localStore,s.targetId,!0))}async function qk(n,e){const t=Ee(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ka(t.remoteStore,r.targetId))}async function zk(n,e,t){const r=Jm(n);try{const s=await function(o,a){const l=Ee(o),c=Wt.now(),d=a.reduce((y,T)=>y.add(T.key),Ye());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=lr(),A=Ye();return l.cs.getEntries(y,d).next(P=>{T=P,T.forEach((U,q)=>{q.isValidDocument()||(A=A.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,T)).next(P=>{f=P;const U=[];for(const q of a){const M=gC(q,f.get(q.key).overlayedDocument);M!=null&&U.push(new $s(q.key,M,fw(M.value.mapValue),Kt.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,U,a)}).next(P=>{g=P;const U=P.applyToLocalDocumentSet(f,A);return l.documentOverlayCache.saveOverlays(y,P.batchId,U)})}).then(()=>({batchId:g.batchId,changes:Pw(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new Ot(ze)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await Us(r,s.changes),await al(r.remoteStore)}catch(s){const i=ul(s,"Failed to persist write");t.reject(i)}}async function OI(n,e){const t=Ee(n);try{const r=await lk(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(Ce(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ce(o.va):s.removedDocuments.size>0&&(Ce(o.va),o.va=!1))}),await Us(t,r,e)}catch(r){await Li(r)}}function f_(n,e,t){const r=Ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let c=!1;l.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(a)&&(c=!0)}),c&&zm(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Kk(n,e,t){const r=Ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Ot(xe.comparator);o=o.insert(i,$t.newNoDocument(i,Me.min()));const a=Ye().add(i),l=new ec(Me.min(),new Map,new Ot(ze),o,a);await OI(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Qm(r)}else await za(r.localStore,e,!1).then(()=>Ha(r,e,t)).catch(Li)}async function Gk(n,e){const t=Ee(n),r=e.batch.batchId;try{const s=await ak(t.localStore,e);Wm(t,r,null),Hm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Us(t,s)}catch(s){await Li(s)}}async function Hk(n,e,t){const r=Ee(n);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Ce(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);Wm(r,e,t),Hm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Us(r,s)}catch(s){await Li(s)}}async function Wk(n,e){const t=Ee(n);Ui(t.remoteStore)||ce("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=Ee(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=ul(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Hm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Wm(n,e,t){const r=Ee(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ha(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||MI(n,r)})}function MI(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Ka(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Qm(n))}function Cp(n,e,t){for(const r of t)r instanceof kI?(n.La.addReference(r.key,e),Qk(n,r)):r instanceof DI?(ce("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||MI(n,r.key)):Re()}function Qk(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(ce("SyncEngine","New document in limbo: "+t),n.xa.add(r),Qm(n))}function Qm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new xe(it.fromString(e)),r=n.qa.next();n.Na.set(r,new Fk(t)),n.Oa=n.Oa.insert(t,r),xh(n.remoteStore,new ws(Bn(rl(t.path)),r,"TargetPurposeLimboResolution",or.oe))}}async function Us(n,e,t){const r=Ee(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=Om.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,c){const d=Ee(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>G.forEach(c,g=>G.forEach(g.$i,y=>d.persistence.referenceDelegate.addReference(f,g.targetId,y)).next(()=>G.forEach(g.Ui,y=>d.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))}catch(f){if(!Fi(f))throw f;ce("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const g=f.targetId;if(!f.fromCache){const y=d.os.get(g),T=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(T);d.os=d.os.insert(g,A)}}}(r.localStore,i))}async function Jk(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){ce("SyncEngine","User change. New user:",e.toKey());const r=await gI(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new de(H.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Us(t,r.hs)}}function Yk(n,e){const t=Ee(n),r=t.Na.get(e);if(r&&r.va)return Ye().add(r.key);{let s=Ye();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function Xk(n,e){const t=Ee(n),r=await jd(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&Cp(t,e.targetId,s.wa),s}async function Zk(n,e){const t=Ee(n);return bI(t.localStore,e).then(r=>Us(t,r))}async function eD(n,e,t,r){const s=Ee(n),i=await function(a,l){const c=Ee(a),d=Ee(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,l).next(g=>g?c.localDocuments.getDocuments(f,g):G.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await al(s.remoteStore):t==="acknowledged"||t==="rejected"?(Wm(s,e,r||null),Hm(s,e),function(a,l){Ee(Ee(a).mutationQueue).On(l)}(s.localStore,e)):Re(),await Us(s,i)):ce("SyncEngine","Cannot apply mutation batch with id: "+e)}async function tD(n,e){const t=Ee(n);if(Ah(t),Jm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await p_(t,r.toArray());t.Qa=!0,await Pp(t.remoteStore,!0);for(const i of s)xh(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Ha(t,o),za(t.localStore,o,!0))),Ka(t.remoteStore,o)}),await s,await p_(t,r),function(o){const a=Ee(o);a.Na.forEach((l,c)=>{Ka(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new Ot(xe.comparator)}(t),t.Qa=!1,await Pp(t.remoteStore,!1)}}async function p_(n,e,t){const r=Ee(n),s=[],i=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await qa(r.localStore,Bn(l[0]));for(const c of l){const d=r.Fa.get(c),f=await Xk(r,d);f.snapshot&&i.push(f.snapshot)}}else{const c=await _I(r.localStore,o);a=await qa(r.localStore,c),await Gm(r,LI(c),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function LI(n){return ww(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function nD(n){return function(t){return Ee(Ee(t).persistence).Qi()}(Ee(n).localStore)}async function rD(n,e,t,r){const s=Ee(n);if(s.Qa)return void ce("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await bI(s.localStore,xw(i[0])),a=ec.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Zt.EMPTY_BYTE_STRING);await Us(s,o,a);break}case"rejected":await za(s.localStore,e,!0),Ha(s,e,r);break;default:Re()}}async function sD(n,e,t){const r=Ah(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){ce("SyncEngine","Adding an already active target "+s);continue}const i=await _I(r.localStore,s),o=await qa(r.localStore,i);await Gm(r,LI(i),o.targetId,!1,o.resumeToken),xh(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await za(r.localStore,s,!1).then(()=>{Ka(r.remoteStore,s),Ha(r,s)}).catch(Li)}}function Ah(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=OI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Kk.bind(null,e),e.Ca.d_=Nk.bind(null,e.eventManager),e.Ca.$a=Vk.bind(null,e.eventManager),e}function Jm(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Hk.bind(null,e),e}function iD(n,e,t){const r=Ee(n);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(y,T){const A=Ee(y),P=on(T.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",U=>A.Gr.getBundleMetadata(U,T.id)).then(U=>!!U&&U.createTime.compareTo(P)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(CI(l));const c=new Mk(l,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await c.la(d);g&&a._updateProgress(g),d=await o.Ua()}const f=await c.complete();return await Us(i,f.Ia,void 0),await function(y,T){const A=Ee(y);return A.persistence.runTransaction("Save bundle","readwrite",P=>A.Gr.saveBundleMetadata(P,T))}(i.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(l){return xr("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Di{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return mI(this.persistence,new pI,e.initialUser,this.serializer)}Ga(e){return new Dm(Th.Zr,this.serializer)}Wa(e){return new II}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Di.provider={build:()=>new Di};class oD extends Di{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){Ce(this.persistence.referenceDelegate instanceof Ud);const r=this.persistence.referenceDelegate.garbageCollector;return new uI(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new Dm(r=>Ud.Zr(r,t),this.serializer)}}class Ym extends Di{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Jm(this.Ja.syncEngine),await al(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return mI(this.persistence,new pI,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new uI(r,e.asyncQueue,t)}Ha(e,t){const r=new PR(t,this.persistence);return new SR(e.asyncQueue,r)}Ga(e){const t=Vm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new Nm(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,EI(),hd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new II}}class FI extends Ym{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Df&&(this.sharedClientState.syncEngine={no:eD.bind(null,t),ro:rD.bind(null,t),io:sD.bind(null,t),Qi:nD.bind(null,t),eo:Zk.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await tD(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=EI();if(!Df.D(t))throw new de(H.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Vm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Df(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ni{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>f_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Jk.bind(null,this.syncEngine),await Pp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Dk}()}createDatastore(e){const t=nc(e.databaseInfo.databaseId),r=function(i){return new mk(i)}(e.databaseInfo);return function(i,o,a,l){return new yk(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new bk(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>f_(this.syncEngine,t,0),function(){return a_.D()?new a_:new hk}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,d){const f=new $k(s,i,o,a,l,c);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=Ee(s);ce("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ol(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ni.provider={build:()=>new Ni};function m_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):rn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new In,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new Ok(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new de(H.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=Ee(s),a={documents:i.map(f=>Cu(o.serializer,f))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,it.emptyPath(),a,i.length),c=new Map;l.forEach(f=>{const g=xC(o.serializer,f);c.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=c.get(f.toString());Ce(!!g),d.push(g)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new il(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=xe.fromPath(r);this.mutations.push(new Im(s,this.precondition(s)))}),await async function(r,s){const i=Ee(r),o={writes:s.map(a=>ku(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,it.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Re();t=Me.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new de(H.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Me.min())?Kt.exists(!1):Kt.updateTime(t):Kt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Me.min()))throw new de(H.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Kt.updateTime(t)}return Kt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new Lm(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new lD(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!Qu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!$w(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=wn.UNAUTHENTICATED,this.clientId=Jb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ce("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ce("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new In;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ul(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Vf(n,e){n.asyncQueue.verifyOperationInProgress(),ce("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await gI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function g_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Xm(n);ce("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>l_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>l_(e.remoteStore,s)),n._onlineComponents=e}async function Xm(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ce("FirestoreClient","Using user provided OfflineComponentProvider");try{await Vf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;xr("Error using user provided cache. Falling back to memory cache: "+t),await Vf(n,new Di)}}else ce("FirestoreClient","Using default OfflineComponentProvider"),await Vf(n,new Di);return n._offlineComponents}async function Ph(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ce("FirestoreClient","Using user provided OnlineComponentProvider"),await g_(n,n._uninitializedComponentsProvider._online)):(ce("FirestoreClient","Using default OnlineComponentProvider"),await g_(n,new Ni))),n._onlineComponents}function $I(n){return Xm(n).then(e=>e.persistence)}function cl(n){return Xm(n).then(e=>e.localStore)}function UI(n){return Ph(n).then(e=>e.remoteStore)}function Zm(n){return Ph(n).then(e=>e.syncEngine)}function jI(n){return Ph(n).then(e=>e.datastore)}async function Wa(n){const e=await Ph(n),t=e.eventManager;return t.onListen=Uk.bind(null,e.syncEngine),t.onUnlisten=Bk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=jk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=qk.bind(null,e.syncEngine),t}function dD(n){return n.asyncQueue.enqueue(async()=>{const e=await $I(n),t=await UI(n);return e.setNetworkEnabled(!0),function(s){const i=Ee(s);return i.L_.delete(0),rc(i)}(t)})}function hD(n){return n.asyncQueue.enqueue(async()=>{const e=await $I(n),t=await UI(n);return e.setNetworkEnabled(!1),async function(s){const i=Ee(s);i.L_.add(0),await ol(i),i.q_.set("Offline")}(t)})}function fD(n,e){const t=new In;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,d){const f=Ee(c);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new de(H.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=ul(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await cl(n),e,t)),t.promise}function BI(n,e,t={}){const r=new In;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new Sh({next:g=>{d.Za(),o.enqueueAndForget(()=>qm(i,f));const y=g.docs.has(a);!y&&g.fromCache?c.reject(new de(H.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&l&&l.source==="server"?c.reject(new de(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Km(rl(a.path),d,{includeMetadataChanges:!0,_a:!0});return Bm(i,f)}(await Wa(n),n.asyncQueue,e,t,r)),r.promise}function pD(n,e){const t=new In;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await jd(s,i,!0),l=new NI(i,a.Ts),c=l.ma(a.documents),d=l.applyChanges(c,!1);o.resolve(d.snapshot)}catch(a){const l=ul(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await cl(n),e,t)),t.promise}function qI(n,e,t={}){const r=new In;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new Sh({next:g=>{d.Za(),o.enqueueAndForget(()=>qm(i,f)),g.fromCache&&l.source==="server"?c.reject(new de(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Km(a,d,{includeMetadataChanges:!0,_a:!0});return Bm(i,f)}(await Wa(n),n.asyncQueue,e,t,r)),r.promise}function mD(n,e,t){const r=new In;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await jI(n);r.resolve(async function(o,a,l){var c;const d=Ee(o),{request:f,ut:g,parent:y}=Yw(d.serializer,Iw(a),l);d.connection.Fo||delete f.parent;const T=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,y,f,1)).filter(P=>!!P.result);Ce(T.length===1);const A=(c=T[0].result)===null||c===void 0?void 0:c.aggregateFields;return Object.keys(A).reduce((P,U)=>(P[g[U]]=A[U],P),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function gD(n,e){const t=new Sh(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){Ee(s).Y_.add(i),i.next()}(await Wa(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){Ee(s).Y_.delete(i)}(await Wa(n),t))}}function vD(n,e,t,r){const s=function(o,a){let l;return l=typeof o=="string"?jw().encode(o):o,function(d,f){return new aD(d,f)}(function(d,f){if(d instanceof Uint8Array)return m_(d,f);if(d instanceof ArrayBuffer)return m_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,nc(e));n.asyncQueue.enqueueAndForget(async()=>{iD(await Zm(n),s,r)})}function yD(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=Ee(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await cl(n),e))}function _D(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=Ee(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(c=>function(f,g,y,T,A){f=[...f],g=[...g],f.sort(y),g.sort(y);const P=f.length,U=g.length;let q=0,M=0;for(;q<U&&M<P;){const z=y(f[M],g[q]);z<0?A(f[M++]):z>0?T(g[q++]):(q++,M++)}for(;q<U;)T(g[q++]);for(;M<P;)A(f[M++])}(c,s,ER,d=>{a.push(o.addFieldIndex(l,d))},d=>{a.push(o.deleteFieldIndex(l,d))})).next(()=>G.waitFor(a)))}(await cl(n),e))}function bD(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){Ee(r).ss.zi=s}(await cl(n),e))}function wD(n){return n.asyncQueue.enqueue(async()=>function(t){const r=Ee(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await cl(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(n,e,t){if(!t)throw new de(H.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ID(n,e,t,r){if(e===!0&&r===!0)throw new de(H.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function y_(n){if(!xe.isDocumentKey(n))throw new de(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function __(n){if(xe.isDocumentKey(n))throw new de(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Rh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re()}function rt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Rh(n);throw new de(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function KI(n,e){if(e<=0)throw new de(H.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new de(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new de(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ID("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new de(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new de(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new de(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sc{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new mR;switch(r.type){case"firstParty":return new _R(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new de(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=v_.get(t);r&&(ce("ComponentProvider","Removing Datastore"),v_.delete(t),r.terminate())}(this),Promise.resolve()}}function ED(n,e,t,r={}){var s;const i=(n=rt(n,sc))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=wn.MOCK_USER;else{a=K1(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new de(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new wn(c)}n._authCredentials=new gR(new Wb(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Rn(this.firestore,e,this._query)}}class an{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ts(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new an(this.firestore,e,this._key)}}class ts extends Rn{constructor(e,t,r){super(e,t,rl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new an(this.firestore,null,new xe(e))}withConverter(e){return new ts(this.firestore,e,this._path)}}function Je(n,e,...t){if(n=Ne(n),eg("collection","path",e),n instanceof sc){const r=it.fromString(e,...t);return __(r),new ts(n,null,r)}{if(!(n instanceof an||n instanceof ts))throw new de(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(it.fromString(e,...t));return __(r),new ts(n.firestore,null,r)}}function aj(n,e){if(n=rt(n,sc),eg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new de(H.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rn(n,null,function(r){return new Ls(it.emptyPath(),r)}(e))}function Se(n,e,...t){if(n=Ne(n),arguments.length===1&&(e=Jb.newId()),eg("doc","path",e),n instanceof sc){const r=it.fromString(e,...t);return y_(r),new an(n,null,new xe(r))}{if(!(n instanceof an||n instanceof ts))throw new de(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(it.fromString(e,...t));return y_(r),new an(n.firestore,n instanceof ts?n.converter:null,new xe(r))}}function lj(n,e){return n=Ne(n),e=Ne(e),(n instanceof an||n instanceof ts)&&(e instanceof an||e instanceof ts)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function GI(n,e){return n=Ne(n),e=Ne(e),n instanceof Rn&&e instanceof Rn&&n.firestore===e.firestore&&Yu(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lm(this,"async_queue_retry"),this.Vu=()=>{const r=hd();r&&ce("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=hd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=hd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new In;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Fi(e))throw e;ce("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw rn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=jm.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Re()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function kp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class TD{constructor(){this._progressObserver={},this._taskCompletionResolver=new In,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj=-1;class Rt extends sc{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new w_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new w_(e),this._firestoreClient=void 0,await e}}}function cj(n,e,t){t||(t="(default)");const r=Mi(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(Ai(i,e))return s;throw new de(H.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new de(H.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new de(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function xD(n,e){const t=typeof n=="object"?n:fm(),r=typeof n=="string"?n:e||"(default)",s=Mi(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=q1("firestore");i&&ED(s,...i)}return s}function Jt(n){if(n._terminated)throw new de(H.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||HI(n),n._firestoreClient}function HI(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,d){return new QR(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,zI(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new cD(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function AD(n,e){xr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return WI(n,Ni.provider,{build:r=>new Ym(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function dj(n){xr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();WI(n,Ni.provider,{build:t=>new FI(t,e.cacheSizeBytes)})}function WI(n,e,t){if((n=rt(n,Rt))._firestoreClient||n._terminated)throw new de(H.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new de(H.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},HI(n)}function hj(n){if(n._initialized&&!n._terminated)throw new de(H.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new In;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Zr.D())return Promise.resolve();const s=r+"main";await Zr.delete(s)}(Vm(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function fj(n){return function(t){const r=new In;return t.asyncQueue.enqueueAndForget(async()=>Wk(await Zm(t),r)),r.promise}(Jt(n=rt(n,Rt)))}function pj(n){return dD(Jt(n=rt(n,Rt)))}function mj(n){return hD(Jt(n=rt(n,Rt)))}function gj(n){return tR(n.app,"firestore",n._databaseId.database),n._delete()}function vj(n,e){const t=Jt(n=rt(n,Rt)),r=new TD;return vD(t,n._databaseId,e,r),r}function yj(n,e){return yD(Jt(n=rt(n,Rt)),e).then(t=>t?new Rn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class SD{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e){this._byteString=e}static fromBase64String(e){try{return new No(Zt.fromBase64String(e))}catch(t){throw new de(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new No(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function _j(){return new Fo("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=/^__.*__$/;class RD{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new $s(e,this.data,this.fieldMask,t,this.fieldTransforms):new sl(e,this.data,t,this.fieldTransforms)}}class QI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new $s(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function JI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re()}}class kh{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new kh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Kd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(JI(this.Cu)&&PD.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class CD{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||nc(e)}Qu(e,t,r,s=!1){return new kh({Cu:e,methodName:t,qu:r,path:zt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uo(n){const e=n._freezeSettings(),t=nc(n._databaseId);return new CD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dh(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);lg("Data must be an object, but it was:",o,r);const a=ZI(r,o);let l,c;if(i.merge)l=new ar(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=Nu(e,f,t);if(!o.contains(g))throw new de(H.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);tE(d,g)||d.push(g)}l=new ar(d),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new RD(new Pn(a),l,c)}class ic extends $o{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ic}}function YI(n,e,t){return new kh({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ng extends $o{_toFieldTransform(e){return new Zu(e.path,new Ua)}isEqual(e){return e instanceof ng}}class rg extends $o{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=YI(this,e,!0),r=this.Ku.map(i=>jo(i,t)),s=new Po(r);return new Zu(e.path,s)}isEqual(e){return e instanceof rg&&Ai(this.Ku,e.Ku)}}class sg extends $o{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=YI(this,e,!0),r=this.Ku.map(i=>jo(i,t)),s=new Ro(r);return new Zu(e.path,s)}isEqual(e){return e instanceof sg&&Ai(this.Ku,e.Ku)}}class ig extends $o{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new ja(e.serializer,kw(e.serializer,this.$u));return new Zu(e.path,t)}isEqual(e){return e instanceof ig&&this.$u===e.$u}}function og(n,e,t,r){const s=n.Qu(1,e,t);lg("Data must be an object, but it was:",s,r);const i=[],o=Pn.empty();$i(r,(l,c)=>{const d=Nh(e,l,t);c=Ne(c);const f=s.Nu(d);if(c instanceof ic)i.push(d);else{const g=jo(c,f);g!=null&&(i.push(d),o.set(d,g))}});const a=new ar(i);return new QI(o,a,s.fieldTransforms)}function ag(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[Nu(e,r,t)],l=[s];if(i.length%2!=0)throw new de(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(Nu(e,i[g])),l.push(i[g+1]);const c=[],d=Pn.empty();for(let g=a.length-1;g>=0;--g)if(!tE(c,a[g])){const y=a[g];let T=l[g];T=Ne(T);const A=o.Nu(y);if(T instanceof ic)c.push(y);else{const P=jo(T,A);P!=null&&(c.push(y),d.set(y,P))}}const f=new ar(c);return new QI(d,f,o.fieldTransforms)}function XI(n,e,t,r=!1){return jo(t,n.Qu(r?4:3,e))}function jo(n,e){if(eE(n=Ne(n)))return lg("Unsupported field value:",e,n),ZI(n,e);if(n instanceof $o)return function(r,s){if(!JI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=jo(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Ne(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kw(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Wt.fromDate(r);return{timestampValue:Ba(s.serializer,i)}}if(r instanceof Wt){const i=new Wt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ba(s.serializer,i)}}if(r instanceof tg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof No)return{bytesValue:zw(s.serializer,r._byteString)};if(r instanceof an){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Sm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ch)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return wm(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Rh(r)}`)}(n,e)}function ZI(n,e){const t={};return uw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$i(n,(r,s)=>{const i=jo(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function eE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Wt||n instanceof tg||n instanceof No||n instanceof an||n instanceof $o||n instanceof Ch)}function lg(n,e,t){if(!eE(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Rh(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Nu(n,e,t){if((e=Ne(e))instanceof Fo)return e._internalPath;if(typeof e=="string")return Nh(n,e);throw Kd("Field path arguments must be of type string or ",n,!1,void 0,t)}const kD=new RegExp("[~\\*/\\[\\]]");function Nh(n,e,t){if(e.search(kD)>=0)throw Kd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fo(...e.split("."))._internalPath}catch{throw Kd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Kd(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new de(H.INVALID_ARGUMENT,a+n+l)}function tE(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new an(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new DD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Vh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class DD extends Vu{data(){return super.data()}}function Vh(n,e){return typeof e=="string"?Nh(n,e):e instanceof Fo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ug{}class oc extends ug{}function Ou(n,e,...t){let r=[];e instanceof ug&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof dl).length,a=i.filter(l=>l instanceof ac).length;if(o>1||o>0&&a>0)throw new de(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class ac extends oc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ac(e,t,r)}_apply(e){const t=this._parse(e);return sE(e._query,t),new Rn(e.firestore,e.converter,_p(e._query,t))}_parse(e){const t=Uo(e.firestore);return function(i,o,a,l,c,d,f){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new de(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){E_(f,d);const y=[];for(const T of f)y.push(I_(l,i,T));g={arrayValue:{values:y}}}else g=I_(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||E_(f,d),g=XI(a,o,f,d==="in"||d==="not-in");return ot.create(c,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Gd(n,e,t){const r=e,s=Vh("where",n);return ac._create(s,r,t)}class dl extends ug{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new dl(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Et.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)sE(o,l),o=_p(o,l)}(e._query,t),new Rn(e.firestore,e.converter,_p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function bj(...n){return n.forEach(e=>iE("or",e)),dl._create("or",n)}function wj(...n){return n.forEach(e=>iE("and",e)),dl._create("and",n)}class cg extends oc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cg(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new de(H.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new de(H.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(i,o)}(e._query,this._field,this._direction);return new Rn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Ls(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function ND(n,e="asc"){const t=e,r=Vh("orderBy",n);return cg._create(r,t)}class Oh extends oc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Oh(e,t,r)}_apply(e){return new Rn(e.firestore,e.converter,Od(e._query,this._limit,this._limitType))}}function Ij(n){return KI("limit",n),Oh._create("limit",n,"F")}function Ej(n){return KI("limitToLast",n),Oh._create("limitToLast",n,"L")}class Mh extends oc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Mh(e,t,r)}_apply(e){const t=rE(e,this.type,this._docOrFields,this._inclusive);return new Rn(e.firestore,e.converter,function(s,i){return new Ls(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function Tj(...n){return Mh._create("startAt",n,!0)}function xj(...n){return Mh._create("startAfter",n,!1)}class Lh extends oc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Lh(e,t,r)}_apply(e){const t=rE(e,this.type,this._docOrFields,this._inclusive);return new Rn(e.firestore,e.converter,function(s,i){return new Ls(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function Aj(...n){return Lh._create("endBefore",n,!1)}function Sj(...n){return Lh._create("endAt",n,!0)}function rE(n,e,t,r){if(t[0]=Ne(t[0]),t[0]instanceof Vu)return function(i,o,a,l,c){if(!l)throw new de(H.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of xa(i))if(f.field.isKeyField())d.push(Ao(o,l.key));else{const g=l.data.field(f.field);if(gh(g))throw new de(H.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const y=f.field.canonicalString();throw new de(H.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new Ci(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Uo(n.firestore);return function(o,a,l,c,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new de(H.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let T=0;T<d.length;T++){const A=d[T];if(g[T].field.isKeyField()){if(typeof A!="string")throw new de(H.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof A}`);if(!_m(o)&&A.indexOf("/")!==-1)throw new de(H.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${A}' contains a slash.`);const P=o.path.child(it.fromString(A));if(!xe.isDocumentKey(P))throw new de(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const U=new xe(P);y.push(Ao(a,U))}else{const P=XI(l,c,A);y.push(P)}}return new Ci(y,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function I_(n,e,t){if(typeof(t=Ne(t))=="string"){if(t==="")throw new de(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_m(e)&&t.indexOf("/")!==-1)throw new de(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(it.fromString(t));if(!xe.isDocumentKey(r))throw new de(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ao(n,new xe(r))}if(t instanceof an)return Ao(n,t._key);throw new de(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rh(t)}.`)}function E_(n,e){if(!Array.isArray(n)||n.length===0)throw new de(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sE(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new de(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function iE(n,e){if(!(e instanceof ac||e instanceof dl))throw new de(H.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class oE{convertValue(e,t="none"){switch(Pi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ds(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Re()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return $i(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>qt(o.doubleValue));return new Ch(i)}convertGeoPoint(e){return new tg(qt(e.latitude),qt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=vh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Au(e));default:return null}}convertTimestamp(e){const t=ks(e);return new Wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=it.fromString(e);Ce(tI(r));const s=new xo(r.get(1),r.get(3)),i=new xe(r.popFirst(5));return s.isEqual(t)||rn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class VD extends oE{constructor(e){super(),this.firestore=e}convertBytes(e){return new No(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new an(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(n){return new Du("sum",Nu("sum",n))}function Rj(n){return new Du("avg",Nu("average",n))}function OD(){return new Du("count")}function Cj(n,e){var t,r;return n instanceof Du&&e instanceof Du&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function kj(n,e){return GI(n.query,e.query)&&Ai(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qa extends Vu{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Vh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class fd extends Qa{data(e={}){return super.data(e)}}class Ja{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new vo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new fd(this._firestore,this._userDataWriter,r.key,r,new vo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new fd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new fd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:MD(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function MD(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re()}}function Dj(n,e){return n instanceof Qa&&e instanceof Qa?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ja&&e instanceof Ja&&n._firestore===e._firestore&&GI(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(n){n=rt(n,an);const e=rt(n.firestore,Rt);return BI(Jt(e),n._key).then(t=>dg(e,n,t))}class ji extends oE{constructor(e){super(),this.firestore=e}convertBytes(e){return new No(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new an(this.firestore,null,t)}}function Nj(n){n=rt(n,an);const e=rt(n.firestore,Rt),t=Jt(e),r=new ji(e);return fD(t,n._key).then(s=>new Qa(e,r,n._key,s,new vo(s!==null&&s.hasLocalMutations,!0),n.converter))}function Vj(n){n=rt(n,an);const e=rt(n.firestore,Rt);return BI(Jt(e),n._key,{source:"server"}).then(t=>dg(e,n,t))}function bt(n){n=rt(n,Rn);const e=rt(n.firestore,Rt),t=Jt(e),r=new ji(e);return nE(n._query),qI(t,n._query).then(s=>new Ja(e,r,n,s))}function Oj(n){n=rt(n,Rn);const e=rt(n.firestore,Rt),t=Jt(e),r=new ji(e);return pD(t,n._query).then(s=>new Ja(e,r,n,s))}function Mj(n){n=rt(n,Rn);const e=rt(n.firestore,Rt),t=Jt(e),r=new ji(e);return qI(t,n._query,{source:"server"}).then(s=>new Ja(e,r,n,s))}function mn(n,e,t){n=rt(n,an);const r=rt(n.firestore,Rt),s=Fh(n.converter,e,t);return lc(r,[Dh(Uo(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Kt.none())])}function hl(n,e,t,...r){n=rt(n,an);const s=rt(n.firestore,Rt),i=Uo(s);let o;return o=typeof(e=Ne(e))=="string"||e instanceof Fo?ag(i,"updateDoc",n._key,e,t,r):og(i,"updateDoc",n._key,e),lc(s,[o.toMutation(n._key,Kt.exists(!0))])}function Ya(n){return lc(rt(n.firestore,Rt),[new il(n._key,Kt.none())])}function fl(n,e){const t=rt(n.firestore,Rt),r=Se(n),s=Fh(n.converter,e);return lc(t,[Dh(Uo(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Kt.exists(!1))]).then(()=>r)}function Lj(n,...e){var t,r,s;n=Ne(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||kp(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(kp(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,d;if(n instanceof an)c=rt(n.firestore,Rt),d=rl(n._key.path),l={next:f=>{e[o]&&e[o](dg(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=rt(n,Rn);c=rt(f.firestore,Rt),d=f._query;const g=new ji(c);l={next:y=>{e[o]&&e[o](new Ja(c,g,f,y))},error:e[o+1],complete:e[o+2]},nE(n._query)}return function(g,y,T,A){const P=new Sh(A),U=new Km(y,P,T);return g.asyncQueue.enqueueAndForget(async()=>Bm(await Wa(g),U)),()=>{P.Za(),g.asyncQueue.enqueueAndForget(async()=>qm(await Wa(g),U))}}(Jt(c),d,a,l)}function Fj(n,e){return gD(Jt(n=rt(n,Rt)),kp(e)?e:{next:e})}function lc(n,e){return function(r,s){const i=new In;return r.asyncQueue.enqueueAndForget(async()=>zk(await Zm(r),s,i)),i.promise}(Jt(n),e)}function dg(n,e,t){const r=t.docs.get(e._key),s=new ji(n);return new Qa(n,s,e._key,r,new vo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $j(n){return LD(n,{count:OD()})}function LD(n,e){const t=rt(n.firestore,Rt),r=Jt(t),s=lw(e,(i,o)=>new Fw(o,i.aggregateType,i._internalFieldPath));return mD(r,n._query,s).then(i=>function(a,l,c){const d=new ji(a);return new SD(l,d,c)}(t,n,i))}class FD{constructor(e){this.kind="memory",this._onlineComponentProvider=Ni.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=Di.provider}toJSON(){return{kind:this.kind}}}class $D{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=zD(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class UD{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Di.provider}toJSON(){return{kind:this.kind}}}class jD{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new oD(e)}}toJSON(){return{kind:this.kind}}}function Uj(){return new UD}function jj(n){return new jD(n==null?void 0:n.cacheSizeBytes)}function Bj(n){return new FD(n)}function qj(n){return new $D(n)}class BD{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ni.provider,this._offlineComponentProvider={build:t=>new Ym(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class qD{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ni.provider,this._offlineComponentProvider={build:t=>new FI(t,e==null?void 0:e.cacheSizeBytes)}}}function zD(n){return new BD(n==null?void 0:n.forceOwnership)}function zj(){return new qD}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Uo(e)}set(e,t,r){this._verifyNotCommitted();const s=hi(e,this._firestore),i=Fh(s.converter,t,r),o=Dh(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Kt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=hi(e,this._firestore);let o;return o=typeof(t=Ne(t))=="string"||t instanceof Fo?ag(this._dataReader,"WriteBatch.update",i._key,t,r,s):og(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hi(e,this._firestore);return this._mutations=this._mutations.concat(new il(t._key,Kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new de(H.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function hi(n,e){if((n=Ne(n)).firestore!==e)throw new de(H.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Uo(t)}get(t){const r=hi(t,this._firestore),s=new VD(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return Re();const o=i[0];if(o.isFoundDocument())return new Vu(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new Vu(this._firestore,s,r._key,null,r.converter);throw Re()})}set(t,r,s){const i=hi(t,this._firestore),o=Fh(i.converter,r,s),a=Dh(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=hi(t,this._firestore);let a;return a=typeof(r=Ne(r))=="string"||r instanceof Fo?ag(this._dataReader,"Transaction.update",o._key,r,s,i):og(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=hi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=hi(e,this._firestore),r=new ji(this._firestore);return super.get(e).then(s=>new Qa(this._firestore,r,t._key,s._document,new vo(!1,!1),t.converter))}}function Gj(n,e,t){n=rt(n,Rt);const r=Object.assign(Object.assign({},KD),t);return function(i){if(i.maxAttempts<1)throw new de(H.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new In;return i.asyncQueue.enqueueAndForget(async()=>{const c=await jI(i);new uD(i.asyncQueue,c,a,o,l).au()}),l.promise}(Jt(n),s=>e(new HD(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hj(){return new ic("deleteField")}function Bi(){return new ng("serverTimestamp")}function WD(...n){return new rg("arrayUnion",n)}function Wj(...n){return new sg("arrayRemove",n)}function Qj(n){return new ig("increment",n)}function Jj(n){return new Ch(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n){return Jt(n=rt(n,Rt)),new GD(n,e=>lc(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(n,e){const t=Jt(n=rt(n,Rt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return xr("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(c){try{return JSON.parse(c)}catch(d){throw new de(H.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const c=T_(l,"collectionGroup"),d=[];if(Array.isArray(l.fields))for(const f of l.fields){const g=Nh("setIndexConfiguration",T_(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new Io(g,2)):f.order==="ASCENDING"?d.push(new Io(g,0)):f.order==="DESCENDING"&&d.push(new Io(g,1))}a.push(new Ma(Ma.UNKNOWN_ID,c,d,La.empty()))}return a}(e);return _D(t,r)}function T_(n,e){if(typeof n[e]!="string")throw new de(H.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function Xj(n){var e;n=rt(n,Rt);const t=x_.get(n);if(t)return t;if(((e=Jt(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new QD(n);return x_.set(n,r),r}function Zj(n){aE(n,!0)}function eB(n){aE(n,!1)}function tB(n){wD(Jt(n._firestore)).then(e=>ce("deleting all persistent cache indexes succeeded")).catch(e=>xr("deleting all persistent cache indexes failed",e))}function aE(n,e){bD(Jt(n._firestore),e).then(t=>ce(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>xr(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const x_=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nB(n){var e;const t=(e=Jt(rt(n.firestore,Rt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:wh(t,Bn(n._query))._t}function rB(n,e){var t;const r=lw(e,(i,o)=>new Fw(o,i.aggregateType,i._internalFieldPath)),s=(t=Jt(rt(n.firestore,Rt))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:Yw(s,Iw(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return fg.instance.onExistenceFilterMismatch(e)}}class fg{constructor(){this.Uu=new Map}static get instance(){return Qc||(Qc=new fg,function(t){if(Md)throw new Error("a TestingHooksSpi instance is already set");Md=t}(Qc)),Qc}et(e){this.Uu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let Qc=null;(function(e,t=!0){(function(s){nl=s})(tl),ss(new $r("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Rt(new vR(r.getProvider("auth-internal")),new bR(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new de(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xo(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Er(py,"4.7.3",e),Er(py,"4.7.3","esm2017")})();function pg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iB={PHONE:"phone",TOTP:"totp"},oB={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},aB={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},lB={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},uB={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JD(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function lE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const cB=JD,YD=lE,uE=new Lo("auth","Firebase",lE()),dB={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd=new dm("@firebase/auth");function XD(n,...e){Hd.logLevel<=st.WARN&&Hd.warn(`Auth (${tl}): ${n}`,...e)}function pd(n,...e){Hd.logLevel<=st.ERROR&&Hd.error(`Auth (${tl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(n,...e){throw gg(n,...e)}function Xn(n,...e){return gg(n,...e)}function mg(n,e,t){const r=Object.assign(Object.assign({},YD()),{[e]:t});return new Lo("auth","Firebase",r).create(e,{appName:n.name})}function En(n){return mg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pl(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ur(n,"argument-error"),mg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function gg(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return uE.create(n,...e)}function we(n,e,...t){if(!n)throw gg(e,...t)}function Yr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw pd(e),new Error(e)}function Ns(n,e){n||Yr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function vg(){return A_()==="http:"||A_()==="https:"}function A_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vg()||Q1()||"connection"in navigator)?navigator.onLine:!0}function e2(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ns(t>e,"Short delay should be less than long delay!"),this.isMobile=G1()||J1()}get(){return ZD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n,e){Ns(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=new uc(3e4,6e4);function Ut(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function jt(n,e,t,r,s={}){return dE(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=el(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return W1()||(c.referrerPolicy="no-referrer"),cE.fetch()(hE(n,n.config.apiHost,t,a),c)})}async function dE(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},t2),e);try{const s=new s2(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Xl(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xl(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Xl(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Xl(n,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw mg(n,d,c);ur(n,d)}}catch(s){if(s instanceof os)throw s;ur(n,"network-request-failed",{message:String(s)})}}async function js(n,e,t,r,s={}){const i=await jt(n,e,t,r,s);return"mfaPendingCredential"in i&&ur(n,"multi-factor-auth-required",{_serverResponse:i}),i}function hE(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?yg(n.config,s):`${n.config.apiScheme}://${s}`}function r2(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class s2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Xn(this.auth,"network-request-failed")),n2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Xl(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Xn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(n){return n!==void 0&&n.getResponse!==void 0}function P_(n){return n!==void 0&&n.enterprise!==void 0}class fE{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return r2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i2(n){return(await jt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function pE(n,e){return jt(n,"GET","/v2/recaptchaConfig",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o2(n,e){return jt(n,"POST","/v1/accounts:delete",e)}async function a2(n,e){return jt(n,"POST","/v1/accounts:update",e)}async function mE(n,e){return jt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(n,e=!1){return Ne(n).getIdToken(e)}async function l2(n,e=!1){const t=Ne(n),r=await t.getIdToken(e),s=$h(r);we(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:pu(Of(s.auth_time)),issuedAtTime:pu(Of(s.iat)),expirationTime:pu(Of(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Of(n){return Number(n)*1e3}function $h(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return pd("JWT malformed, contained fewer than 3 sections"),null;try{const s=kb(t);return s?JSON.parse(s):(pd("Failed to decode base64 JWT payload"),null)}catch(s){return pd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function R_(n){const e=$h(n);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof os&&u2(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function u2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pu(this.lastLoginAt),this.creationTime=pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lu(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Vs(n,mE(t,{idToken:r}));we(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?gE(i.providerUserInfo):[],a=h2(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Dp(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function d2(n){const e=Ne(n);await Lu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function h2(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function gE(n){return n.map(e=>{var{providerId:t}=e,r=pg(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f2(n,e){const t=await dE(n,{},async()=>{const r=el({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=hE(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",cE.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function p2(n,e){return jt(n,"POST","/v2/accounts:revokeToken",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):R_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){we(e.length!==0,"internal-error");const t=R_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await f2(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Sa;return r&&(we(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(we(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(we(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sa,this.toJSON())}_performRefresh(){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(n,e){we(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Is{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=pg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new c2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Dp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Vs(this,this.stsTokenManager.getToken(this.auth,e));return we(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return l2(this,e)}reload(){return d2(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Is(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Lu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(sn(this.auth.app))return Promise.reject(En(this.auth));const e=await this.getIdToken();return await Vs(this,o2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(s=t.email)!==null&&s!==void 0?s:void 0,y=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,T=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,U=(c=t.createdAt)!==null&&c!==void 0?c:void 0,q=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:M,emailVerified:z,isAnonymous:he,providerData:pe,stsTokenManager:x}=t;we(M&&x,e,"internal-error");const I=Sa.fromJSON(this.name,x);we(typeof M=="string",e,"internal-error"),ii(f,e.name),ii(g,e.name),we(typeof z=="boolean",e,"internal-error"),we(typeof he=="boolean",e,"internal-error"),ii(y,e.name),ii(T,e.name),ii(A,e.name),ii(P,e.name),ii(U,e.name),ii(q,e.name);const w=new Is({uid:M,auth:e,email:g,emailVerified:z,displayName:f,isAnonymous:he,photoURL:T,phoneNumber:y,tenantId:A,stsTokenManager:I,createdAt:U,lastLoginAt:q});return pe&&Array.isArray(pe)&&(w.providerData=pe.map(C=>Object.assign({},C))),P&&(w._redirectEventId=P),w}static async _fromIdTokenResponse(e,t,r=!1){const s=new Sa;s.updateFromServerResponse(t);const i=new Is({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Lu(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];we(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?gE(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Sa;a.updateFromIdToken(r);const l=new Is({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Dp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_=new Map;function Es(n){Ns(n instanceof Function,"Expected a class definition");let e=C_.get(n);return e?(Ns(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,C_.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vE.type="NONE";const k_=vE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(n,e,t){return`firebase:${n}:${e}:${t}`}class Pa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=md(this.userKey,s.apiKey,i),this.fullPersistenceKey=md("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Is._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Pa(Es(k_),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Es(k_);const o=md(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){const f=Is._fromJSON(e,d);c!==i&&(a=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Pa(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Pa(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(EE(e))return"Blackberry";if(TE(e))return"Webos";if(_E(e))return"Safari";if((e.includes("chrome/")||bE(e))&&!e.includes("edge/"))return"Chrome";if(IE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function yE(n=vn()){return/firefox\//i.test(n)}function _E(n=vn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bE(n=vn()){return/crios\//i.test(n)}function wE(n=vn()){return/iemobile/i.test(n)}function IE(n=vn()){return/android/i.test(n)}function EE(n=vn()){return/blackberry/i.test(n)}function TE(n=vn()){return/webos/i.test(n)}function _g(n=vn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function m2(n=vn()){var e;return _g(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function g2(){return Y1()&&document.documentMode===10}function xE(n=vn()){return _g(n)||IE(n)||TE(n)||EE(n)||/windows phone/i.test(n)||wE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(n,e=[]){let t;switch(n){case"Browser":t=D_(vn());break;case"Worker":t=`${D_(vn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${tl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(n,e={}){return jt(n,"GET","/v2/passwordPolicy",Ut(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=6;class b2{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:_2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new N_(this),this.idTokenSubscription=new N_(this),this.beforeStateQueue=new v2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Es(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Pa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await mE(this,{idToken:e}),r=await Is._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(sn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Lu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=e2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(sn(this.app))return Promise.reject(En(this));const t=e?Ne(e):null;return t&&we(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return sn(this.app)?Promise.reject(En(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return sn(this.app)?Promise.reject(En(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Es(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await y2(this),t=new b2(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Lo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await p2(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Es(e)||this._popupRedirectResolver;we(t,this,"argument-error"),this.redirectPersistenceManager=await Pa.create(this,[Es(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=AE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&XD(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function en(n){return Ne(n)}class N_{constructor(e){this.auth=e,this.observer=null,this.addObserver=rP(t=>this.observer=t)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function I2(n){cc=n}function bg(n){return cc.loadJS(n)}function E2(){return cc.recaptchaV2Script}function T2(){return cc.recaptchaEnterpriseScript}function x2(){return cc.gapiScript}function SE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const A2="recaptcha-enterprise",S2="NO_RECAPTCHA";class PE{constructor(e){this.type=A2,this.auth=en(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{pE(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new fE(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;P_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(S2)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&P_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=T2();l.length!==0&&(l+=a),bg(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function V_(n,e,t,r=!1){const s=new PE(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Fu(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await V_(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await V_(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}async function P2(n){const e=en(n),t=await pE(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new fE(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new PE(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(n,e){const t=Mi(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Ai(i,e??{}))return s;ur(s,"already-initialized")}return t.initialize({options:e})}function C2(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Es);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function k2(n,e,t){const r=en(n);we(r._canInitEmulator,r,"emulator-config-failed"),we(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=RE(e),{host:o,port:a}=D2(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||N2()}function RE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function D2(n){const e=RE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:O_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:O_(o)}}}function O_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function N2(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Yr("not implemented")}_getIdTokenResponse(e){return Yr("not implemented")}_linkToIdToken(e,t){return Yr("not implemented")}_getReauthenticationResolver(e){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CE(n,e){return jt(n,"POST","/v1/accounts:resetPassword",Ut(n,e))}async function V2(n,e){return jt(n,"POST","/v1/accounts:update",e)}async function O2(n,e){return jt(n,"POST","/v1/accounts:signUp",e)}async function M2(n,e){return jt(n,"POST","/v1/accounts:update",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L2(n,e){return js(n,"POST","/v1/accounts:signInWithPassword",Ut(n,e))}async function Uh(n,e){return jt(n,"POST","/v1/accounts:sendOobCode",Ut(n,e))}async function F2(n,e){return Uh(n,e)}async function $2(n,e){return Uh(n,e)}async function U2(n,e){return Uh(n,e)}async function j2(n,e){return Uh(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B2(n,e){return js(n,"POST","/v1/accounts:signInWithEmailLink",Ut(n,e))}async function q2(n,e){return js(n,"POST","/v1/accounts:signInWithEmailLink",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u extends dc{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new $u(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new $u(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fu(e,t,"signInWithPassword",L2);case"emailLink":return B2(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fu(e,r,"signUpPassword",O2);case"emailLink":return q2(e,{idToken:t,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ss(n,e){return js(n,"POST","/v1/accounts:signInWithIdp",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="http://localhost";class Os extends dc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Os(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ur("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=pg(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Os(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ss(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ss(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ss(e,t)}buildRequest(){const e={requestUri:z2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=el(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K2(n,e){return jt(n,"POST","/v1/accounts:sendVerificationCode",Ut(n,e))}async function G2(n,e){return js(n,"POST","/v1/accounts:signInWithPhoneNumber",Ut(n,e))}async function H2(n,e){const t=await js(n,"POST","/v1/accounts:signInWithPhoneNumber",Ut(n,e));if(t.temporaryProof)throw Xl(n,"account-exists-with-different-credential",t);return t}const W2={USER_NOT_FOUND:"user-not-found"};async function Q2(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return js(n,"POST","/v1/accounts:signInWithPhoneNumber",Ut(n,t),W2)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo extends dc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Eo({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Eo({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return G2(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return H2(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Q2(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new Eo({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Y2(n){const e=Gl(Hl(n)).link,t=e?Gl(Hl(e)).deep_link_id:null,r=Gl(Hl(n)).deep_link_id;return(r?Gl(Hl(r)).link:null)||r||t||e||n}class hc{constructor(e){var t,r,s,i,o,a;const l=Gl(Hl(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=J2((s=l.mode)!==null&&s!==void 0?s:null);we(c&&d&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=Y2(e);try{return new hc(t)}catch{return null}}}function fB(n){return hc.parseLink(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(){this.providerId=Bo.PROVIDER_ID}static credential(e,t){return $u._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=hc.parseLink(t);return we(r,"argument-error"),$u._fromEmailAndCode(e,r.code,r.tenantId)}}Bo.PROVIDER_ID="password";Bo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml extends Bs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class gd extends ml{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return we("providerId"in t&&"signInMethod"in t,"argument-error"),Os._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return we(e.idToken||e.accessToken,"argument-error"),Os._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return gd.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return gd.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new gd(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends ml{constructor(){super("facebook.com")}static credential(e){return Os._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fi.credential(e.oauthAccessToken)}catch{return null}}}fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends ml{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Os._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return pi.credential(t,r)}catch{return null}}}pi.GOOGLE_SIGN_IN_METHOD="google.com";pi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends ml{constructor(){super("github.com")}static credential(e){return Os._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.GITHUB_SIGN_IN_METHOD="github.com";mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2="http://localhost";class Uu extends dc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Ss(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ss(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ss(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new Uu(r,i)}static _create(e,t){return new Uu(e,t)}buildRequest(){return{requestUri:X2,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2="saml.";class Np extends Bs{constructor(e){we(e.startsWith(Z2),"argument-error"),super(e)}static credentialFromResult(e){return Np.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Np.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Uu.fromJSON(e);return we(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Uu._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends ml{constructor(){super("twitter.com")}static credential(e,t){return Os._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return gi.credential(t,r)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kE(n,e){return js(n,"POST","/v1/accounts:signUp",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Is._fromIdTokenResponse(e,r,s),o=M_(r);return new Ar({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=M_(r);return new Ar({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function M_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eN(n){var e;if(sn(n.app))return Promise.reject(En(n));const t=en(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ar({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await kE(t,{returnSecureToken:!0}),s=await Ar._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd extends os{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Wd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Wd(e,t,r,s)}}function DE(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wd._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pB(n,e){const t=Ne(n);await jh(!0,t,e);const{providerUserInfo:r}=await a2(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=NE(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function wg(n,e,t=!1){const r=await Vs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ar._forOperation(n,"link",r)}async function jh(n,e,t){await Lu(e);const r=NE(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";we(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VE(n,e,t=!1){const{auth:r}=n;if(sn(r.app))return Promise.reject(En(r));const s="reauthenticate";try{const i=await Vs(n,DE(r,s,e,n),t);we(i.idToken,r,"internal-error");const o=$h(i.idToken);we(o,r,"internal-error");const{sub:a}=o;return we(n.uid===a,r,"user-mismatch"),Ar._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OE(n,e,t=!1){if(sn(n.app))return Promise.reject(En(n));const r="signIn",s=await DE(n,r,e),i=await Ar._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function Ig(n,e){return OE(en(n),e)}async function tN(n,e){const t=Ne(n);return await jh(!1,t,e.providerId),wg(t,e)}async function nN(n,e){return VE(Ne(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(n,e){return js(n,"POST","/v1/accounts:signInWithCustomToken",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mB(n,e){if(sn(n.app))return Promise.reject(En(n));const t=en(n),r=await rN(t,{token:e,returnSecureToken:!0}),s=await Ar._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Eg._fromServerResponse(e,t):"totpInfo"in t?Tg._fromServerResponse(e,t):ur(e,"internal-error")}}class Eg extends fc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Eg(t)}}class Tg extends fc{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Tg(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(n,e,t){var r;we(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),we(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(we(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(we(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xg(n){const e=en(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sN(n,e,t){const r=en(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Bh(r,s,t),await Fu(r,s,"getOobCode",$2)}async function iN(n,e,t){await CE(Ne(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&xg(n),r})}async function gB(n,e){await M2(Ne(n),{oobCode:e})}async function oN(n,e){const t=Ne(n),r=await CE(t,{oobCode:e}),s=r.requestType;switch(we(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":we(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":we(r.mfaInfo,t,"internal-error");default:we(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=fc._fromServerResponse(en(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function vB(n,e){const{data:t}=await oN(Ne(n),e);return t.email}async function aN(n,e,t){if(sn(n.app))return Promise.reject(En(n));const r=en(n),o=await Fu(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kE).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&xg(n),l}),a=await Ar._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function lN(n,e,t){return sn(n.app)?Promise.reject(En(n)):Ig(Ne(n),Bo.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&xg(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yB(n,e,t){const r=en(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){we(a.handleCodeInApp,r,"argument-error"),a&&Bh(r,o,a)}i(s,t),await Fu(r,s,"getOobCode",U2)}function _B(n,e){const t=hc.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function bB(n,e,t){if(sn(n.app))return Promise.reject(En(n));const r=Ne(n),s=Bo.credentialWithLink(e,t||Mu());return we(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ig(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uN(n,e){return jt(n,"POST","/v1/accounts:createAuthUri",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wB(n,e){const t=vg()?Mu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await uN(Ne(n),r);return s||[]}async function IB(n,e){const t=Ne(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Bh(t.auth,s,e);const{email:i}=await F2(t.auth,s);i!==n.email&&await n.reload()}async function EB(n,e,t){const r=Ne(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Bh(r.auth,i,t);const{email:o}=await j2(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cN(n,e){return jt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TB(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Ne(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Vs(r,cN(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function dN(n,e){const t=Ne(n);return sn(t.auth.app)?Promise.reject(En(t.auth)):ME(t,e,null)}function hN(n,e){return ME(Ne(n),null,e)}async function ME(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await Vs(n,V2(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fN(n){var e,t;if(!n)return null;const{providerId:r}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=$h(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new Ra(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new pN(i,s);case"github.com":return new mN(i,s);case"google.com":return new gN(i,s);case"twitter.com":return new vN(i,s,n.screenName||null);case"custom":case"anonymous":return new Ra(i,null);default:return new Ra(i,r,s)}}class Ra{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class LE extends Ra{constructor(e,t,r,s){super(e,t,r),this.username=s}}class pN extends Ra{constructor(e,t){super(e,"facebook.com",t)}}class mN extends LE{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class gN extends Ra{constructor(e,t){super(e,"google.com",t)}}class vN extends LE{constructor(e,t,r){super(e,"twitter.com",t,r)}}function xB(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:fN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yN(n,e){return Ne(n).setPersistence(e)}function AB(n){return P2(n)}async function SB(n,e){return en(n).validatePassword(e)}function _N(n,e,t,r){return Ne(n).onIdTokenChanged(e,t,r)}function bN(n,e,t){return Ne(n).beforeAuthStateChanged(e,t)}function wN(n,e,t,r){return Ne(n).onAuthStateChanged(e,t,r)}function PB(n){Ne(n).useDeviceLanguage()}function RB(n,e){return Ne(n).updateCurrentUser(e)}function IN(n){return Ne(n).signOut()}function CB(n,e){return en(n).revokeAccessToken(e)}async function kB(n){return Ne(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new yo("enroll",e,t)}static _fromMfaPendingCredential(e){return new yo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return yo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return yo._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=en(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>fc._fromServerResponse(r,a));we(s.mfaPendingCredential,r,"internal-error");const o=yo._fromMfaPendingCredential(s.mfaPendingCredential);return new Ag(o,i,async a=>{const l=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const c=Object.assign(Object.assign({},s),{idToken:l.idToken,refreshToken:l.refreshToken});switch(t.operationType){case"signIn":const d=await Ar._fromIdTokenResponse(r,t.operationType,c);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return we(t.user,r,"internal-error"),Ar._forOperation(t.user,t.operationType,c);default:ur(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function DB(n,e){var t;const r=Ne(n),s=e;return we(e.customData.operationType,r,"argument-error"),we((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Ag._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:start",Ut(n,e))}function TN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ut(n,e))}function xN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:start",Ut(n,e))}function AN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ut(n,e))}function SN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ut(n,e))}class Sg{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>fc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Sg(e)}async getSession(){return yo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await Vs(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Vs(this.user,SN(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const Mf=new WeakMap;function NB(n){const e=Ne(n);return Mf.has(e)||Mf.set(e,Sg._fromUser(e)),Mf.get(e)}const Qd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qd,"1"),this.storage.removeItem(Qd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=1e3,RN=10;class $E extends FE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);g2()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,RN):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},PN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}$E.type="LOCAL";const UE=$E;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE extends FE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}jE.type="SESSION";const BE=jE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new qh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await CN(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=zh("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function DN(n){pn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function NN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function ON(){return Pg()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE="firebaseLocalStorageDb",MN=1,Jd="firebaseLocalStorage",zE="fbase_key";class pc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kh(n,e){return n.transaction([Jd],e?"readwrite":"readonly").objectStore(Jd)}function LN(){const n=indexedDB.deleteDatabase(qE);return new pc(n).toPromise()}function Vp(){const n=indexedDB.open(qE,MN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Jd,{keyPath:zE})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Jd)?e(r):(r.close(),await LN(),e(await Vp()))})})}async function L_(n,e,t){const r=Kh(n,!0).put({[zE]:e,value:t});return new pc(r).toPromise()}async function FN(n,e){const t=Kh(n,!1).get(e),r=await new pc(t).toPromise();return r===void 0?null:r.value}function F_(n,e){const t=Kh(n,!0).delete(e);return new pc(t).toPromise()}const $N=800,UN=3;class KE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>UN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qh._getInstance(ON()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await NN(),!this.activeServiceWorker)return;this.sender=new kN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vp();return await L_(e,Qd,"1"),await F_(e,Qd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>L_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>FN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>F_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Kh(s,!1).getAll();return new pc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$N)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KE.type="LOCAL";const jN=KE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(n,e){return jt(n,"POST","/v2/accounts/mfaSignIn:start",Ut(n,e))}function qN(n,e){return jt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ut(n,e))}function zN(n,e){return jt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN=500,GN=6e4,Jc=1e12;class HN{constructor(e){this.auth=e,this.counter=Jc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new WN(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Jc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Jc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Jc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class WN{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;we(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=QN(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},GN)},KN))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function QN(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf=SE("rcb"),JN=new uc(3e4,6e4);class YN{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=pn().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return we(XN(t),e,"argument-error"),this.shouldResolveImmediately(t)&&S_(pn().grecaptcha)?Promise.resolve(pn().grecaptcha):new Promise((r,s)=>{const i=pn().setTimeout(()=>{s(Xn(e,"network-request-failed"))},JN.get());pn()[Lf]=()=>{pn().clearTimeout(i),delete pn()[Lf];const a=pn().grecaptcha;if(!a||!S_(a)){s(Xn(e,"internal-error"));return}const l=a.render;a.render=(c,d)=>{const f=l(c,d);return this.counter++,f},this.hostLanguage=t,r(a)};const o=`${E2()}?${el({onload:Lf,render:"explicit",hl:t})}`;bg(o).catch(()=>{clearTimeout(i),s(Xn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=pn().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function XN(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class ZN{async load(e){return new HN(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE="recaptcha",eV={theme:"light",type:"image"};class VB{constructor(e,t,r=Object.assign({},eV)){this.parameters=r,this.type=GE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=en(e),this.isInvisible=this.parameters.size==="invisible",we(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;we(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ZN:new YN,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){we(!this.parameters.sitekey,this.auth,"argument-error"),we(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),we(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=pn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){we(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){we(vg()&&!Pg(),this.auth,"internal-error"),await tV(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await i2(this.auth);we(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return we(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function tV(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Eo._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function OB(n,e,t){if(sn(n.app))return Promise.reject(En(n));const r=en(n),s=await Gh(r,e,Ne(t));return new Rg(s,i=>Ig(r,i))}async function MB(n,e,t){const r=Ne(n);await jh(!1,r,"phone");const s=await Gh(r.auth,e,Ne(t));return new Rg(s,i=>tN(r,i))}async function LB(n,e,t){const r=Ne(n);if(sn(r.auth.app))return Promise.reject(En(r.auth));const s=await Gh(r.auth,e,Ne(t));return new Rg(s,i=>nN(r,i))}async function Gh(n,e,t){var r;const s=await t.verify();try{we(typeof s=="string",n,"argument-error"),we(t.type===GE,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return we(o.type==="enroll",n,"internal-error"),(await EN(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{we(o.type==="signin",n,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return we(a,n,"missing-multi-factor-info"),(await BN(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await K2(n,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{t._reset()}}async function FB(n,e){const t=Ne(n);if(sn(t.auth.app))return Promise.reject(En(t.auth));await wg(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this.providerId=Ca.PROVIDER_ID,this.auth=en(e)}verifyPhoneNumber(e,t){return Gh(this.auth,e,Ne(t))}static credential(e,t){return Eo._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ca.credentialFromTaggedObject(t)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Eo._fromTokenResponse(t,r):null}}Ca.PROVIDER_ID="phone";Ca.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(n,e){return e?Es(e):(we(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg extends dc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ss(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ss(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ss(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function nV(n){return OE(n.auth,new Cg(n),n.bypassAuthState)}function rV(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),VE(t,new Cg(n),n.bypassAuthState)}async function sV(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),wg(t,new Cg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nV;case"linkViaPopup":case"linkViaRedirect":return sV;case"reauthViaPopup":case"reauthViaRedirect":return rV;default:ur(this.auth,"internal-error")}}resolve(e){Ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV=new uc(2e3,1e4);async function $B(n,e,t){if(sn(n.app))return Promise.reject(Xn(n,"operation-not-supported-in-this-environment"));const r=en(n);pl(n,e,Bs);const s=qo(r,t);return new Ts(r,"signInViaPopup",e,s).executeNotNull()}async function UB(n,e,t){const r=Ne(n);if(sn(r.auth.app))return Promise.reject(Xn(r.auth,"operation-not-supported-in-this-environment"));pl(r.auth,e,Bs);const s=qo(r.auth,t);return new Ts(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function jB(n,e,t){const r=Ne(n);pl(r.auth,e,Bs);const s=qo(r.auth,t);return new Ts(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Ts extends HE{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ts.currentPopupAction&&Ts.currentPopupAction.cancel(),Ts.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Ns(this.filter.length===1,"Popup operations only handle one event");const e=zh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Xn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ts.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,iV.get())};e()}}Ts.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV="pendingRedirect",vd=new Map;class aV extends HE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=vd.get(this.auth._key());if(!e){try{const r=await lV(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}vd.set(this.auth._key(),e)}return this.bypassAuthState||vd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lV(n,e){const t=QE(e),r=WE(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function kg(n,e){return WE(n)._set(QE(e),"true")}function uV(n,e){vd.set(n._key(),e)}function WE(n){return Es(n._redirectPersistence)}function QE(n){return md(oV,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BB(n,e,t){return cV(n,e,t)}async function cV(n,e,t){if(sn(n.app))return Promise.reject(En(n));const r=en(n);pl(n,e,Bs),await r._initializationPromise;const s=qo(r,t);return await kg(s,r),s._openRedirect(r,e,"signInViaRedirect")}function qB(n,e,t){return dV(n,e,t)}async function dV(n,e,t){const r=Ne(n);if(pl(r.auth,e,Bs),sn(r.auth.app))return Promise.reject(En(r.auth));await r.auth._initializationPromise;const s=qo(r.auth,t);await kg(s,r.auth);const i=await YE(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function zB(n,e,t){return hV(n,e,t)}async function hV(n,e,t){const r=Ne(n);pl(r.auth,e,Bs),await r.auth._initializationPromise;const s=qo(r.auth,t);await jh(!1,r,e.providerId),await kg(s,r.auth);const i=await YE(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function KB(n,e){return await en(n)._initializationPromise,JE(n,e,!1)}async function JE(n,e,t=!1){if(sn(n.app))return Promise.reject(En(n));const r=en(n),s=qo(r,e),o=await new aV(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function YE(n){const e=zh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV=10*60*1e3;class pV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mV(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!XE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Xn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fV&&this.cachedEventUids.clear(),this.cachedEventUids.has($_(e))}saveEventToCache(e){this.cachedEventUids.add($_(e)),this.lastProcessedEventTime=Date.now()}}function $_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function XE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function mV(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gV(n,e={}){return jt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yV=/^https?/;async function _V(n){if(n.config.emulator)return;const{authorizedDomains:e}=await gV(n);for(const t of e)try{if(bV(t))return}catch{}ur(n,"unauthorized-domain")}function bV(n){const e=Mu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!yV.test(t))return!1;if(vV.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV=new uc(3e4,6e4);function U_(){const n=pn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function IV(n){return new Promise((e,t)=>{var r,s,i;function o(){U_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{U_(),t(Xn(n,"network-request-failed"))},timeout:wV.get()})}if(!((s=(r=pn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=pn().gapi)===null||i===void 0)&&i.load)o();else{const a=SE("iframefcb");return pn()[a]=()=>{gapi.load?o():t(Xn(n,"network-request-failed"))},bg(`${x2()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw yd=null,e})}let yd=null;function EV(n){return yd=yd||IV(n),yd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV=new uc(5e3,15e3),xV="__/auth/iframe",AV="emulator/auth/iframe",SV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RV(n){const e=n.config;we(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yg(e,AV):`https://${n.config.authDomain}/${xV}`,r={apiKey:e.apiKey,appName:n.name,v:tl},s=PV.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${el(r).slice(1)}`}async function CV(n){const e=await EV(n),t=pn().gapi;return we(t,n,"internal-error"),e.open({where:document.body,url:RV(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SV,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Xn(n,"network-request-failed"),a=pn().setTimeout(()=>{i(o)},TV.get());function l(){pn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DV=500,NV=600,VV="_blank",OV="http://localhost";class j_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MV(n,e,t,r=DV,s=NV){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},kV),{width:r.toString(),height:s.toString(),top:i,left:o}),c=vn().toLowerCase();t&&(a=bE(c)?VV:t),yE(c)&&(e=e||OV,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[y,T])=>`${g}${y}=${T},`,"");if(m2(c)&&a!=="_self")return LV(e||"",a),new j_(null);const f=window.open(e||"",a,d);we(f,n,"popup-blocked");try{f.focus()}catch{}return new j_(f)}function LV(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV="__/auth/handler",$V="emulator/auth/handler",UV=encodeURIComponent("fac");async function B_(n,e,t,r,s,i){we(n.config.authDomain,n,"auth-domain-config-required"),we(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:tl,eventId:s};if(e instanceof Bs){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",nP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof ml){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),c=l?`#${UV}=${encodeURIComponent(l)}`:"";return`${jV(n)}?${el(a).slice(1)}${c}`}function jV({config:n}){return n.emulator?yg(n,$V):`https://${n.authDomain}/${FV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff="webStorageSupport";class BV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BE,this._completeRedirectFn=JE,this._overrideRedirectResult=uV}async _openPopup(e,t,r,s){var i;Ns((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await B_(e,t,r,Mu(),s);return MV(e,o,zh())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await B_(e,t,r,Mu(),s);return DN(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Ns(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await CV(e),r=new pV(e);return t.register("authEvent",s=>(we(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ff,{type:Ff},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Ff];o!==void 0&&t(!!o),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=_V(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xE()||_E()||_g()}}const qV=BV;class ZE{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Yr("unexpected MultiFactorSessionType")}}}class Dg extends ZE{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Dg(e)}_finalizeEnroll(e,t,r){return TN(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return qN(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class zV{constructor(){}static assertion(e){return Dg._fromCredential(e)}}zV.FACTOR_ID="phone";class KV{static assertionForEnrollment(e,t){return ju._fromSecret(e,t)}static assertionForSignIn(e,t){return ju._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const r=e;we(typeof((t=r.user)===null||t===void 0?void 0:t.auth)<"u","internal-error");const s=await xN(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return Ng._fromStartTotpMfaEnrollmentResponse(s,r.user.auth)}}KV.FACTOR_ID="totp";class ju extends ZE{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new ju(t,void 0,e)}static _fromEnrollmentId(e,t){return new ju(t,e)}async _finalizeEnroll(e,t,r){return we(typeof this.secret<"u",e,"argument-error"),AN(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){we(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return zN(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class Ng{constructor(e,t,r,s,i,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new Ng(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let s=!1;return(Yc(e)||Yc(t))&&(s=!0),s&&(Yc(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),Yc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Yc(n){return typeof n>"u"||(n==null?void 0:n.length)===0}var q_="@firebase/auth",z_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WV(n){ss(new $r("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:AE(n)},c=new w2(r,s,i,l);return C2(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ss(new $r("auth-internal",e=>{const t=en(e.getProvider("auth").getImmediate());return(r=>new GV(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Er(q_,z_,HV(n)),Er(q_,z_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=5*60,JV=Vb("authIdTokenMaxAge")||QV;let K_=null;const YV=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>JV)return;const s=t==null?void 0:t.token;K_!==s&&(K_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function XV(n=fm()){const e=Mi(n,"auth");if(e.isInitialized())return e.getImmediate();const t=R2(n,{popupRedirectResolver:qV,persistence:[jN,UE,BE]}),r=Vb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=YV(i.toString());bN(t,o,()=>o(t.currentUser)),_N(t,a=>o(a))}}const s=Db("auth");return s&&k2(t,`http://${s}`),t}function ZV(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}I2({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Xn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",ZV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WV("Browser");const eO={apiKey:"AIzaSyDCqJRmxKiIzuAhgXsmXICCx_O65aujNa0",authDomain:"impro-selector.firebaseapp.com",projectId:"impro-selector",storageBucket:"impro-selector.appspot.com",messagingSenderId:"730278491306",appId:"1:730278491306:web:c966af1179221e91118cd3",measurementId:"G-3NB062D088"},Hh=$b(eO),ue=xD(Hh),Nt=XV(Hh);try{AD(ue)}catch{}try{yN(Nt,UE)}catch{}wN(Nt,n=>{n||eN(Nt)});async function tO(n,e){try{return(await aN(Nt,n,e)).user}catch(t){throw t}}async function eT(n,e){try{return(await lN(Nt,n,e)).user}catch(t){throw t}}async function tT(n){try{await sN(Nt,n)}catch(e){throw e}}async function nO(n){try{const e=Nt.currentUser;if(e)await hN(e,n);else throw new Error("Aucun utilisateur connecté")}catch(e){throw e}}const wi=Object.freeze(Object.defineProperty({__proto__:null,app:Hh,auth:Nt,createPlayerAccount:tO,db:ue,resetPlayerPassword:tT,signInPlayer:eT,updatePlayerPassword:nO},Symbol.toStringTag,{value:"Module"})),gl="seasons";async function rO(n,e,t){return await fl(Je(ue,gl),{name:n,slug:e,pinCode:t,createdAt:Bi()})}async function sO(n){return await Ya(Se(ue,gl,n))}async function $f(){const n=Ou(Je(ue,gl),ND("createdAt","desc"));return(await bt(n)).docs.map(t=>({id:t.id,...t.data()}))}async function Yd(n,e){const t=await Qt(Se(ue,gl,n));return t.exists()?t.data().pinCode===e:!1}async function Op(n){const e=await Qt(Se(ue,gl,n));return e.exists()?e.data().pinCode:null}async function ql(n,e){const t=Se(ue,gl,n);await hl(t,{sortOrder:e})}const Uf=7*24*60*60*1e3,zl="impro_selector_pin_session";class iO{constructor(){this.sessionData=this.loadSession()}loadSession(){try{const e=localStorage.getItem(zl);if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<Uf){try{t.timestamp=Date.now(),localStorage.setItem(zl,JSON.stringify(t))}catch{}return t}else this.clearSession()}}catch{console.error("Erreur lors du chargement de la session PIN")}return null}saveSession(e,t){try{const r={seasonId:e,pinCode:t,timestamp:Date.now()};localStorage.setItem(zl,JSON.stringify(r)),this.sessionData=r}catch{console.error("Erreur lors de la sauvegarde de la session PIN")}}isPinCached(e){if(!this.sessionData)return!1;const t=this.sessionData.seasonId===e&&this.sessionData.timestamp&&Date.now()-this.sessionData.timestamp<Uf;if(t)try{this.sessionData.timestamp=Date.now(),localStorage.setItem(zl,JSON.stringify(this.sessionData))}catch{}return t}getCachedPin(e){return this.isPinCached(e)?this.sessionData.pinCode:null}clearSession(){try{localStorage.removeItem(zl),this.sessionData=null}catch{console.error("Erreur lors de la suppression de la session PIN")}}getTimeRemaining(){if(!this.sessionData||!this.sessionData.timestamp)return 0;const e=Date.now()-this.sessionData.timestamp,t=Uf-e;return Math.max(0,Math.ceil(t/(60*1e3)))}isExpiringSoon(){return this.getTimeRemaining()<=2}}const xn=new iO,oO={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},aO={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},lO={class:"text-center mb-6"},uO={class:"text-gray-300"},cO={key:0,class:"mt-2 p-2 bg-green-900/20 border border-green-500/30 rounded-lg"},dO={class:"text-sm text-green-400"},hO={class:"mb-6"},fO={class:"mb-4"},pO={key:0,class:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-center"},mO={class:"flex justify-end space-x-3"},gO=["disabled"],nT={__name:"PinModal",props:{show:{type:Boolean,default:!1},message:{type:String,default:"Veuillez saisir le code PIN à 4 chiffres"},error:{type:String,default:""},sessionInfo:{type:Object,default:null}},emits:["submit","cancel"],setup(n,{emit:e}){const t=n,r=e,s=k(""),i=k(""),o=k(null);xt(()=>t.show,d=>{d&&(s.value="",i.value="",fn(()=>{var f;(f=o.value)==null||f.focus()}))});function a(){s.value=s.value.replace(/[^0-9]/g,""),s.value.length>4&&(s.value=s.value.slice(0,4))}function l(){s.value.length===4&&r("submit",s.value)}function c(){r("cancel")}return(d,f)=>n.show?(L(),F("div",oO,[h("div",aO,[h("div",lO,[f[1]||(f[1]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"🔒")],-1)),f[2]||(f[2]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Code d'accès requis",-1)),h("p",uO,le(n.message),1),n.sessionInfo?(L(),F("div",cO,[h("p",dO," Session active : "+le(n.sessionInfo.timeRemaining)+" min restantes ",1)])):ge("",!0)]),h("div",hO,[h("div",fO,[f[3]||(f[3]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN",-1)),nt(h("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g),type:"password",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-center text-2xl font-mono tracking-widest",placeholder:"••••",onInput:a,onKeydown:[Mn(l,["enter"]),Mn(c,["escape"])],ref_key:"pinInput",ref:o},null,544),[[kt,s.value]])]),f[4]||(f[4]=h("p",{class:"text-xs text-gray-400 text-center"},"Tapez directement votre code PIN à 4 chiffres",-1))]),i.value||t.error?(L(),F("div",pO,le(i.value||t.error),1)):ge("",!0),h("div",mO,[h("button",{onClick:c,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:l,disabled:s.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Valider ",8,gO)])])])):ge("",!0)}},vO={class:"relative p-6 pb-4 border-b border-white/10"},yO={class:"sticky bottom-0 p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex justify-end"},rT={__name:"AppHelpModal",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=e;return(r,s)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[95] p-0 md:p-4",onClick:s[3]||(s[3]=i=>t("close"))},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:s[2]||(s[2]=Ft(()=>{},["stop"]))},[h("div",vO,[h("button",{onClick:s[0]||(s[0]=i=>t("close")),title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),s[4]||(s[4]=h("div",{class:"flex items-center gap-3"},[h("div",{class:"w-12 h-12 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-2xl"},"❓"),h("div",null,[h("h2",{class:"text-xl md:text-2xl font-bold text-white"},"Kezako ?"),h("p",{class:"text-sm text-purple-300"},"L'appli pour sélectionner les joueurs d'impro de manière simple et apaisée")])],-1))]),s[5]||(s[5]=Jn('<div class="px-4 md:px-6 py-4 md:py-6 overflow-y-auto space-y-4 text-gray-200"><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-3"><h3 class="text-white font-semibold">C&#39;est quoi ?</h3><p> Tu joues quand ? est une appli conçue pour faciliter <span class="text-white">la sélection des joueurs d&#39;impro</span> pour les spectacles. L&#39;idée est née au sein de <span class="text-purple-300">La Malice</span> pour <span class="text-white">dépersonnaliser une tâche délicate</span> qui créait des tensions depuis des années. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-3"><h3 class="text-white font-semibold">Comment ça marche</h3><p> L&#39;asso déclare ses dates et le nombre de personnes nécessaires. Les joueurs indiquent leurs disponibilités. L&#39;appli propose des sélections. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Sélection auto ou manuelle</h3><p> Le <span class="text-white">mode sélection auto</span> s&#39;appuie sur le hasard (pondéré) pour simplifier la vie. Vous pouvez aussi repasser en mode <span class="text-white">manuel</span> si besoin. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Pensée mobile • Libre d&#39;utilisation</h3><p> L&#39;appli est <span class="text-white">pensée pour le mobile</span> et peut être utilisée librement par La Malice ou <span class="text-white">toute autre troupe</span>. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Comptes (facultatif)</h3><p> Les joueurs qui le souhaitent peuvent créer un compte via leur email pour <span class="text-white">recevoir des notifications</span>, <span class="text-white">protéger leurs saisies</span> et bénéficier d&#39;un meilleur confort d&#39;utilisation. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2 text-sm"><h3 class="text-white font-semibold">Statut &amp; licence</h3><p> Application <span class="text-white">en cours de développement</span>, <span class="text-white">sans garanties</span> à ce stade. Licence libre <span class="text-white">MIT</span>. </p><p>Contact &amp; retours : <a href="mailto:impropick@gmail.com" class="text-blue-300 underline">impropick@gmail.com</a></p></div></div>',1)),h("div",yO,[h("button",{onClick:s[1]||(s[1]=i=>t("close")),class:"h-10 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600"},"Compris")])])])):ge("",!0)}},_O=["pin","pinCode","password","motdepasse","mdp","token","oobCode","apiKey","apikey","key","secret","authorization","auth","bearer"];function bO(){var t,r,s,i;const n=((r=(t=import.meta)==null?void 0:t.env)==null?void 0:r.MODE)==="development"?"debug":"warn";return((i=(s=import.meta)==null?void 0:s.env)==null?void 0:i.VITE_LOG_LEVEL)||n}function sT(n){switch(n){case"debug":return 10;case"info":return 20;case"warn":return 30;case"error":return 40;case"silent":return 100;default:return 30}}function wO(n){return typeof n!="string"?n:n.length<=2?"••":n.length>=8?`${n.slice(0,2)}••••${n.slice(-2)}`:"••••"}function iT(n){if(!n)return!1;const e=String(n).toLowerCase();return _O.some(t=>e.includes(t.toLowerCase()))}function Mp(n){if(n==null)return n;if(typeof n=="string"){if(n.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){const[r,s]=n.split("@"),i=r.length<=2?"••":`${r.slice(0,2)}••`,o=s.split("."),a=o[0].length<=2?"••":`${o[0].slice(0,2)}••`;return`${i}@${a}.${o.slice(1).join(".")}`}return n.length>=12&&!/\s/.test(n)?wO(n):n}if(typeof n=="number"){const e=String(n);return/^\d{4,6}$/.test(e)?"••••":n}if(Array.isArray(n))return n.map(e=>Mp(e));if(typeof n=="object"){const e={};for(const[t,r]of Object.entries(n))e[t]=iT(t)?"••••":Mp(r);return e}return n}function IO(n){const e=[];for(let t=0;t<n.length;t+=1){const r=n[t],s=t>0?n[t-1]:null;if(typeof s=="string"&&iT(s)&&(typeof r=="string"||typeof r=="number")){e.push("••••");continue}e.push(Mp(r))}return e}const EO=sT(bO());function Xc(n,e){const t=sT(n);return(...r)=>{if(t<EO)return;const s=IO(r);console[e](...s)}}const _e={debug:Xc("debug","log"),info:Xc("info","info"),warn:Xc("warn","warn"),error:Xc("error","error")};let qn="mock",Ii=[{id:"p1",name:"Alice"},{id:"p2",name:"Bob"},{id:"p3",name:"Charlie"},{id:"p4",name:"David"},{id:"p5",name:"Eva"},{id:"p6",name:"Fanny"},{id:"p7",name:"Georges"},{id:"p8",name:"Hélène"},{id:"p9",name:"Ismaël"},{id:"p10",name:"Jade"},{id:"p11",name:"Karim"},{id:"p12",name:"Léa"},{id:"p13",name:"Marc"},{id:"p14",name:"Nina"},{id:"p15",name:"Oscar"}],Vo=[{id:"event1",title:"Apérock Septembre",date:"2025-09-08",description:"Soirée apéro-rock avec ambiance festive"},{id:"event2",title:"Match à Cambo",date:"2025-11-25",description:"Match d'improvisation compétitif à Cambo-les-Bains"},{id:"event3",title:"Impro des Familles",date:"2025-12-02",description:"Spectacle d'improvisation pour toute la famille"},{id:"event4",title:"Cabaret Surprise",date:"2026-01-20",description:"Cabaret avec des surprises et des performances uniques"},{id:"event5",title:"Impro Plage",date:"2026-03-10",description:"Improvisation en plein air avec vue sur la plage"}];function oT(n){qn=n}async function TO(){if(qn!=="firebase"||!(await bt(Je(ue,"seasons"))).empty)return;const e=Se(Je(ue,"seasons"));await mn(e,{name:"Malice 2025-2026",slug:"malice-2025-2026",createdAt:Bi()});const t=await bt(Je(ue,"players"));for(const o of t.docs)await mn(Se(e,"players",o.id),o.data());const r=await bt(Je(ue,"events"));for(const o of r.docs)await mn(Se(e,"events",o.id),o.data());const s=await bt(Je(ue,"availability"));for(const o of s.docs)await mn(Se(e,"availability",o.id),o.data());const i=await bt(Je(ue,"selections"));for(const o of i.docs)await mn(Se(e,"selections",o.id),o.data())}async function xO(){qn==="firebase"&&await TO()}async function Lp(n=null){return(qn==="firebase"?n?(await bt(Je(ue,"seasons",n,"events"))).docs.map(t=>({id:t.id,...t.data()})):(await bt(Je(ue,"events"))).docs.map(t=>({id:t.id,...t.data()})):Vo).sort((t,r)=>{const s=c=>{if(!c)return null;if(c instanceof Date)return c;if(typeof(c==null?void 0:c.toDate)=="function")return c.toDate();const d=new Date(c);return isNaN(d.getTime())?null:d},i=s(t.date),o=s(r.date),a=i?i.getTime():Number.POSITIVE_INFINITY,l=o?o.getTime():Number.POSITIVE_INFINITY;return a!==l?a-l:(t.title||"").localeCompare(r.title||"","fr",{sensitivity:"base"})})}async function _d(n=null){return(qn==="firebase"?n?(await bt(Je(ue,"seasons",n,"players"))).docs.map(t=>({id:t.id,...t.data()})):(await bt(Je(ue,"players"))).docs.map(t=>({id:t.id,...t.data()})):Ii).sort((t,r)=>t.order<r.order?-1:t.order>r.order?1:t.name.localeCompare(r.name))}async function aT(n,e=null){if(qn==="firebase"){const t=Se(e?Je(ue,"seasons",e,"players"):Je(ue,"players"));return await mn(t,{name:n}),t.id}else{const t=`p${Ii.length+1}`;return Ii.push({id:t,name:n}),t}}async function AO(n,e=null){if(qn==="firebase"){const t=e?Se(ue,"seasons",e,"players",n):Se(ue,"players",n);await Ya(t);const r=e?await bt(Je(ue,"seasons",e,"availability")):await bt(Je(ue,"availability")),s=hg(ue);r.forEach(i=>{const o=i.data();if(o[n]!==void 0){const a={...o};delete a[n],s.update(i.ref,a)}}),await s.commit()}else Ii=Ii.filter(t=>t.id!==n)}async function SO(n,e,t=null){if(qn==="firebase"){const r=t?Se(ue,"seasons",t,"players",n):Se(ue,"players",n),s=await Qt(r),i=s.exists()&&s.data().name||null;if(await mn(r,{name:e},{merge:!0}),i&&i!==e){const o=hg(ue);try{const a=t?Se(ue,"seasons",t,"availability",i):Se(ue,"availability",i),l=await Qt(a);if(l.exists()){const c=l.data()||{},d=t?Se(ue,"seasons",t,"availability",e):Se(ue,"availability",e);o.set(d,c,{merge:!0}),o.delete(a)}}catch{}try{const a=t?Je(ue,"seasons",t,"selections"):Je(ue,"selections");(await bt(a)).forEach(c=>{var f;const d=Array.isArray((f=c.data())==null?void 0:f.players)?c.data().players:[];if(d.includes(i)){const g=d.map(y=>y===i?e:y);o.update(c.ref,{players:g})}})}catch{}await o.commit()}}else{const r=Ii.findIndex(s=>s.id===n);r!==-1&&(Ii[r]={...Ii[r],name:e})}}async function co(n,e,t=null){if(qn==="firebase"){const r=t?await bt(Je(ue,"seasons",t,"availability")):await bt(Je(ue,"availability")),s={};return r.forEach(i=>{s[i.id]=i.data()}),s}else{const r={};return n.forEach(s=>{r[s.name]={},e.forEach(i=>{r[s.name][i.id]=void 0})}),e.forEach(s=>{const i=[...n].sort(()=>.5-Math.random());i.slice(0,4).forEach(o=>{r[o.name][s.id]=!0}),i.slice(4).forEach(o=>{const a=Math.random();r[o.name][s.id]=a<.4?!0:a<.8?!1:void 0})}),r}}async function ho(n=null){if(qn==="firebase"){const e=n?await bt(Je(ue,"seasons",n,"selections")):await bt(Je(ue,"selections")),t={};return e.forEach(r=>{t[r.id]=r.data().players||[]}),t}else return{}}async function G_(n,e,t=null){if(qn==="firebase"){const r=t?Se(ue,"seasons",t,"availability",n):Se(ue,"availability",n);await mn(r,e)}}async function PO({seasonId:n,playerName:e,eventId:t,value:r}){if(qn!=="firebase")return;const s=n?Se(ue,"seasons",n,"availability",e):Se(ue,"availability",e),i=await Qt(s),a={...i.exists()?i.data():{}};r===void 0?delete a[t]:a[t]=r,await mn(s,a)}async function H_(n,e,t=null){if(qn==="firebase"){const r=t?Se(ue,"seasons",t,"selections",n):Se(ue,"selections",n);await mn(r,{players:e})}}async function RO(n,e=null){if(_e.info("Suppression de l'événement",{eventId:n}),qn==="firebase")try{_e.debug("Suppression de l'événement dans Firestore");const t=e?Se(ue,"seasons",e,"events",n):Se(ue,"events",n);await Ya(t),_e.debug("Suppression de la sélection associée");const r=e?Se(ue,"seasons",e,"selections",n):Se(ue,"selections",n);await Ya(r),_e.debug("Suppression des disponibilités");const s=e?await bt(Je(ue,"seasons",e,"availability")):await bt(Je(ue,"availability")),i=hg(ue);s.forEach(o=>{const a=o.data();if(a[n]!==void 0){_e.debug("Mise à jour de la disponibilité pour un joueur");const l={...a};delete l[n],i.update(o.ref,l)}}),await i.commit(),_e.info("Opérations de suppression terminées avec succès")}catch(t){throw _e.error("Erreur lors de la suppression",t),t}else Vo=Vo.filter(t=>t.id!==n)}async function CO(n,e=null){if(qn==="firebase"){const t=Se(e?Je(ue,"seasons",e,"events"):Je(ue,"events"));return await mn(t,n),t.id}else{const t=`event${Vo.length+1}`;return Vo.push({id:t,...n}),t}}async function W_(n,e,t=null){if(qn==="firebase"){const r=t?Se(ue,"seasons",t,"events",n):Se(ue,"events",n);await mn(r,e,{merge:!0})}else{const r=Vo.findIndex(s=>s.id===n);r!==-1&&(Vo[r]={id:n,...e})}}const kO={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},DO={class:"text-center py-16 px-4 relative"},NO=["aria-busy"],VO={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto animate-pulse"},OO={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto"},MO=["onClick"],LO={class:"text-2xl font-bold text-white mb-4 group-hover:text-purple-300 transition-colors"},FO={class:"absolute top-4 right-4"},$O=["onClick","aria-expanded"],UO={key:0,class:"absolute right-0 mt-2 w-44 bg-gray-900 border border-white/10 rounded-lg shadow-xl py-1 z-10",role:"menu"},jO=["onClick"],BO=["onClick"],qO=["onClick"],zO=["onClick"],KO={key:2,class:"flex justify-center mt-12"},GO={key:3,class:"text-center py-16"},HO={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},WO={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},QO={class:"mb-6"},JO={class:"mb-6"},YO={class:"mb-6"},XO={class:"flex justify-end space-x-3"},ZO=["disabled"],eM={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},tM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},nM={class:"text-center mb-6"},rM={class:"text-gray-300"},sM={__name:"Home",setup(n){const e=k([]),t=k(!0),r=Wu(),s=k(null),i=k(!1),o=k(!1),a=k(""),l=k(""),c=k(""),d=k(null),f=k(!1),g=k(null),y=k(""),T=k(!1);ir(async()=>{var D;try{e.value=await $f(),_e.info("Saisons chargées",{count:((D=e.value)==null?void 0:D.length)||0}),M().catch($=>_e.error("Migration sortOrder échouée",$))}finally{t.value=!1}});const A=Oe(()=>[...e.value].sort((D,$)=>{var E,S;const X=typeof D.sortOrder=="number"?D.sortOrder:Number.MAX_SAFE_INTEGER,se=typeof $.sortOrder=="number"?$.sortOrder:Number.MAX_SAFE_INTEGER;if(X!==se)return X-se;const ke=(E=D.createdAt)!=null&&E.toMillis?D.createdAt.toMillis():0,$e=(S=$.createdAt)!=null&&S.toMillis?$.createdAt.toMillis():0;return ke!==$e?$e-ke:(D.name||"").localeCompare($.name||"")}));function P(D){r.push(`/season/${D}`)}function U(D){s.value=s.value===D?null:D}function q(){s.value=null}async function M(){if(!e.value.length)return;const D=e.value.map(X=>typeof X.sortOrder=="number"?X.sortOrder:null).filter(X=>X!==null);let $=D.length?Math.max(...D):0;for(const X of e.value)if(typeof X.sortOrder!="number"){$+=1;try{await ql(X.id,$),X.sortOrder=$}catch(se){_e.error("Erreur migration sortOrder",{seasonName:X==null?void 0:X.name,error:se})}}}async function z(D){try{if(!(D!=null&&D.id)){alert("Saison introuvable");return}const[$,X]=await Promise.all([Lp(D.id),_d(D.id)]),[se,ke]=await Promise.all([co(X,$,D.id),ho(D.id)]),$e=["Joueur",...$.map(ve=>pe(ve))],E=[];for(const ve of X){const ye=(ve==null?void 0:ve.name)||"",fe=(se==null?void 0:se[ye])||{},Ae=[ye,...$.map(Te=>V(fe[Te.id],ke==null?void 0:ke[Te.id],ye))];E.push(Ae)}const S=I([$e,...E]),O=new Blob(["\uFEFF"+S],{type:"text/csv;charset=utf-8;"}),oe=(D==null?void 0:D.name)||(D==null?void 0:D.slug)||"saison",Z=`${C(oe)}-disponibilites.csv`,ae=URL.createObjectURL(O),be=document.createElement("a");be.href=ae,be.download=Z,document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(ae),_e.info("Export CSV saison",{seasonId:D.id,events:$.length,players:X.length})}catch($){_e.error("Erreur export CSV",$),alert("Erreur lors de l'export CSV. Veuillez réessayer.")}}function he(D){if(!D)return null;if(D instanceof Date)return D;if(typeof(D==null?void 0:D.toDate)=="function")return D.toDate();if(typeof D=="string"||typeof D=="number"){const $=new Date(D);return isNaN($.getTime())?null:$}return null}function pe(D){const $=he(D==null?void 0:D.date),X=$?`${$.getFullYear()}-${String($.getMonth()+1).padStart(2,"0")}-${String($.getDate()).padStart(2,"0")}`:"",se=(D==null?void 0:D.title)||"Sans titre";return`${X} · ${se}`.trim()}function x(D){return D===!0||D==="oui"?"disponible":D===!1||D==="non"?"non disponible":""}function I(D){return D.map($=>$.map(w).join(",")).join(`
`)}function w(D){const $=String(D??"");return/[",\n\r]/.test($)?'"'+$.replace(/"/g,'""')+'"':$}function C(D){return String(D||"").normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\-_. ]+/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$|^\.+|\.+$/g,"")||"fichier"}function V(D,$,X){return Array.isArray($)&&$.includes(X)?D===!1||D==="non"?"non disponible":"sélectionné":x(D)}async function B(D){if(q(),D<=0)return;const $=[...A.value],X=$[D],se=$[D-1],ke=X.sortOrder;X.sortOrder=se.sortOrder,se.sortOrder=ke;try{await Promise.all([ql(X.id,X.sortOrder),ql(se.id,se.sortOrder)])}catch($e){_e.error("Erreur lors du déplacement vers le haut",$e)}}async function R(D){q();const $=[...A.value];if(D>=$.length-1)return;const X=$[D],se=$[D+1],ke=X.sortOrder;X.sortOrder=se.sortOrder,se.sortOrder=ke;try{await Promise.all([ql(X.id,X.sortOrder),ql(se.id,se.sortOrder)])}catch($e){_e.error("Erreur lors du déplacement vers le bas",$e)}}function wt(){a.value&&(l.value=a.value.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}function gt(){c.value=c.value.replace(/[^0-9]/g,""),c.value.length>4&&(c.value=c.value.slice(0,4))}async function Y(){if(!a.value.trim()||!l.value.trim()||!c.value.trim()){alert("Veuillez remplir tous les champs, y compris le code PIN à 4 chiffres");return}if(c.value.length!==4){alert("Le code PIN doit contenir exactement 4 chiffres");return}try{await rO(a.value.trim(),l.value.trim(),c.value.trim()),e.value=await $f(),await M(),j()}catch(D){_e.error("Erreur lors de la création de la saison",D),alert("Erreur lors de la création de la saison. Veuillez réessayer.")}}function j(){i.value=!1,a.value="",l.value="",c.value=""}function ne(D){d.value=D,o.value=!0}async function Ke(){o.value=!1,await re({type:"deleteSeason",data:{seasonId:d.value.id,seasonName:d.value.name}})}function Be(){o.value=!1,d.value=null}function Ge(){return g.value?{deleteSeason:"Suppression de saison - Code PIN requis"}[g.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function re(D){if(xn.isPinCached(d.value.id)){const $=xn.getCachedPin(d.value.id);if(_e.debug("PIN en cache trouvé, utilisation automatique"),await Yd(d.value.id,$)){await ht(D);return}else xn.clearSession()}g.value=D,f.value=!0}async function ee(D){var $,X,se,ke;_e.debug("PIN soumis pour l'opération",{operationType:($=g.value)==null?void 0:$.type});try{const $e=((se=(X=g.value)==null?void 0:X.data)==null?void 0:se.seasonId)||((ke=d.value)==null?void 0:ke.id),E=await Yd($e,D);if(_e.debug("PIN validé",{valid:E}),E){xn.saveSession($e,D),_e.debug("PIN correct, fermeture de la modal et exécution de l'opération"),f.value=!1;const S=g.value;g.value=null,_e.debug("Appel de executePendingOperation",{operationType:S==null?void 0:S.type}),await ht(S)}else y.value="Code PIN incorrect",setTimeout(()=>{y.value=""},3e3)}catch($e){_e.error("Erreur lors de la vérification du PIN",$e),y.value="Erreur lors de la vérification du code PIN"}}function je(){f.value=!1,g.value=null,y.value=""}function Xe(){return d.value&&xn.isPinCached(d.value.id)?{timeRemaining:xn.getTimeRemaining(),isExpiringSoon:xn.isExpiringSoon()}:null}async function ht(D){var se;if(_e.debug("executePendingOperation appelé",{hasOperation:!!D}),!D){_e.warn("Aucune opération à exécuter");return}const{type:$,data:X}=D;_e.info("Exécution de l'opération",{type:$});try{switch($){case"deleteSeason":_e.info("Suppression de la saison",{seasonId:X.seasonId}),await sO(X.seasonId),_e.info("Saison supprimée, rechargement de la liste"),e.value=await $f(),_e.info("Liste des saisons rechargée",{count:((se=e.value)==null?void 0:se.length)||0});break;default:_e.warn("Type d'opération non reconnu",{type:$})}}catch(ke){_e.error("Erreur lors de l'exécution de l'opération",ke),alert("Erreur lors de l'opération. Veuillez réessayer.")}}return(D,$)=>{var X;return L(),F("div",kO,[h("div",DO,[h("button",{onClick:$[0]||($[0]=se=>T.value=!0),class:"absolute right-4 top-4 text-white/90 hover:text-white p-2 rounded-full hover:bg-white/10",title:"Kezako ?","aria-label":"Kezako ?"},$[8]||($[8]=[h("span",{class:"text-2xl"},"❓",-1)])),$[9]||($[9]=h("h1",{class:"text-6xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent animate-pulse"}," Tu joues quand ? ",-1)),$[10]||($[10]=h("p",{class:"text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed"},"Arrêtez de vous prendre la tête pour savoir qui sera sur scène quand. Laissez chacun indiquer ses dispos et le hasard choisir pour vous !",-1))]),h("div",{class:"container mx-auto px-4 pb-16","aria-busy":t.value},[t.value?(L(),F("div",VO,[(L(),F(dt,null,wr(8,se=>h("div",{key:"skeleton-"+se,class:"bg-gradient-to-br from-white/10 to-white/5 border border-white/10 rounded-2xl p-8"},$[11]||($[11]=[h("div",{class:"w-16 h-16 bg-white/10 rounded-full mx-auto mb-6"},null,-1),h("div",{class:"h-6 bg-white/10 rounded mb-4 w-2/3 mx-auto"},null,-1),h("div",{class:"h-px bg-white/10 mb-4"},null,-1),h("div",{class:"h-4 bg-white/10 rounded w-1/2 mx-auto"},null,-1)]))),64))])):e.value.length>0?(L(),F("div",OO,[(L(!0),F(dt,null,wr(A.value,(se,ke)=>(L(),F("div",{key:se.id,class:"group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm border border-white/20 rounded-2xl p-8 transition-all duration-300 hover:shadow-2xl hover:shadow-purple-500/20"},[h("div",{onClick:$e=>P(se.slug),class:"text-center cursor-pointer"},[$[12]||($[12]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg"},[h("span",{class:"text-2xl"},"🎭")],-1)),h("h2",LO,le(se.name),1),$[13]||($[13]=h("div",{class:"w-full bg-gradient-to-r from-transparent via-white/20 to-transparent h-px mb-4"},null,-1)),$[14]||($[14]=h("p",{class:"text-gray-300 text-sm"}," Cliquez pour accéder ",-1))],8,MO),h("div",FO,[h("div",{class:"relative",onClick:$[1]||($[1]=Ft(()=>{},["stop"]))},[h("button",{onClick:$e=>U(ke),class:"p-1 rounded-full text-gray-300 hover:text-white hover:bg-white/10","aria-expanded":s.value===ke,"aria-haspopup":"true",title:"Options"},$[15]||($[15]=[h("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.75a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"})],-1)]),8,$O),s.value===ke?(L(),F("div",UO,[h("button",{onClick:$e=>{z(se),q()},class:"w-full text-left px-4 py-2 text-sm text-emerald-300 hover:bg-white/10",role:"menuitem"}," Exporter CSV ",8,jO),$[16]||($[16]=h("div",{class:"border-t border-white/10 my-1"},null,-1)),h("button",{onClick:$e=>B(ke),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Monter ",8,BO),h("button",{onClick:$e=>R(ke),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Descendre ",8,qO),$[17]||($[17]=h("div",{class:"border-t border-white/10 my-1"},null,-1)),h("button",{onClick:$e=>ne(se),class:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-red-500/10",role:"menuitem"}," Supprimer ",8,zO)])):ge("",!0)])])]))),128))])):ge("",!0),!t.value&&e.value.length>0?(L(),F("div",KO,[h("button",{onClick:$[2]||($[2]=se=>i.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-2xl hover:shadow-pink-500/25 transition-all duration-300 transform hover:scale-105"}," ✨ Nouvelle saison ")])):ge("",!0),!t.value&&e.value.length===0?(L(),F("div",GO,[$[18]||($[18]=h("div",{class:"w-24 h-24 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[h("span",{class:"text-4xl"},"🎪")],-1)),$[19]||($[19]=h("h3",{class:"text-2xl font-bold text-white mb-4"},"Aucune saison créée",-1)),$[20]||($[20]=h("p",{class:"text-gray-300 mb-8"},"Commencez par créer votre première saison de spectacles !",-1)),h("button",{onClick:$[3]||($[3]=se=>i.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-xl hover:shadow-pink-500/25 transition-all duration-300"}," Créer ma première saison ")])):ge("",!0)],8,NO),i.value?(L(),F("div",HO,[h("div",WO,[$[25]||($[25]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvelle saison",-1)),h("div",QO,[$[21]||($[21]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom de la saison",-1)),nt(h("input",{"onUpdate:modelValue":$[4]||($[4]=se=>a.value=se),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: La Malice 2025-2026",onInput:wt},null,544),[[kt,a.value]])]),h("div",JO,[$[22]||($[22]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Slug (URL)",-1)),nt(h("input",{"onUpdate:modelValue":$[5]||($[5]=se=>l.value=se),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: malice-2025-2026"},null,512),[[kt,l.value]])]),h("div",YO,[$[23]||($[23]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN (4 chiffres)",-1)),nt(h("input",{"onUpdate:modelValue":$[6]||($[6]=se=>c.value=se),type:"text",inputmode:"numeric",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"1234",onInput:gt},null,544),[[kt,c.value]]),$[24]||($[24]=h("p",{class:"text-xs text-gray-400 mt-1"},"Ce code protégera les opérations sensibles (suppressions, sélections)",-1))]),h("div",XO,[h("button",{onClick:j,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Y,disabled:!a.value.trim()||!l.value.trim()||!c.value.trim()||c.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Créer ",8,ZO)])])])):ge("",!0),o.value?(L(),F("div",eM,[h("div",tM,[h("div",nM,[$[26]||($[26]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"⚠️")],-1)),$[27]||($[27]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Confirmation",-1)),h("p",rM,'Êtes-vous sûr de vouloir supprimer la saison "'+le((X=d.value)==null?void 0:X.name)+'" ?',1)]),$[28]||($[28]=h("p",{class:"mb-6 text-sm text-red-400 bg-red-900/20 p-3 rounded-lg border border-red-500/20"}," ⚠️ Cette action est irréversible et supprimera toutes les données de cette saison. ",-1)),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:Be,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Ke,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):ge("",!0),ct(nT,{show:f.value,message:Ge(),error:y.value,"session-info":Xe(),onSubmit:ee,onCancel:je},null,8,["show","message","error","session-info"]),ct(rT,{show:T.value,onClose:$[7]||($[7]=se=>T.value=!1)},null,8,["show"]),$[29]||($[29]=Jn('<footer class="mt-16 border-t border-white/10"><div class="container mx-auto px-4 py-6 text-center text-xs text-gray-400"><span>© Patrice Lamarque 2025</span><span class="mx-2">•</span><span>Licence MIT</span><span class="mx-2">•</span><a href="https://github.com/plamarque/impro-selector" target="_blank" rel="noopener noreferrer" class="underline decoration-white/20 hover:decoration-white/40 hover:text-gray-200">GitHub</a></div></footer>',1))])}}},Wh="magicLinks";function Qh({seasonId:n,playerId:e,eventId:t,action:r}){return`${n}__${e}__${t}__${r}`}function Vg(n=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let r=0;r<n;r++)t+=e[Math.floor(Math.random()*e.length)];return t}async function Fp({seasonId:n,playerId:e,eventId:t,action:r}){const s=Qh({seasonId:n,playerId:e,eventId:t,action:r}),i=Vg(40),o=Se(ue,Wh,s),a=Date.now()+1e3*60*60*24*7;await mn(o,{seasonId:n,playerId:e,eventId:t,token:i,action:r,expiresAt:a});const c=`${window.location.origin+"/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&eid=${encodeURIComponent(t)}&t=${encodeURIComponent(i)}&a=${encodeURIComponent(r)}`;return{id:s,token:i,url:c}}async function lT({seasonId:n,playerId:e,email:t}){const r="protection",s="verify_email",i=Qh({seasonId:n,playerId:e,eventId:r,action:s}),o=Vg(40),a=Se(ue,Wh,i),l=Date.now()+1e3*60*60*24*7;await mn(a,{seasonId:n,playerId:e,eventId:r,token:o,action:s,email:t,expiresAt:l});const d=`${window.location.origin+"/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&t=${encodeURIComponent(o)}&a=${encodeURIComponent(s)}`;return{id:i,token:o,url:d}}async function uT({seasonId:n,playerId:e,eventId:t,token:r,action:s}){const i=Qh({seasonId:n,playerId:e,eventId:t,action:s}),o=Se(ue,Wh,i),a=await Qt(o);if(!a.exists())return{valid:!1,reason:"not_found"};const l=a.data();return l.token!==r?{valid:!1,reason:"token_mismatch"}:l.action!==s?{valid:!1,reason:"action_mismatch"}:typeof l.expiresAt=="number"&&Date.now()>l.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:l}}async function $p({seasonId:n,playerId:e,eventId:t,action:r}){const s=Qh({seasonId:n,playerId:e,eventId:t,action:r}),i=Se(ue,Wh,s);await Ya(i)}const Og="accountMagicLinks";function Jh(n){return`account__${n}`}async function cT({currentEmail:n,newEmail:e}){const t=Vg(40),r=Jh(t),s=Se(ue,Og,r),i=Date.now()+1e3*60*60*24*7;await mn(s,{token:t,currentEmail:n,newEmail:e,action:"account_email_update",expiresAt:i});const a=`${window.location.origin+"/"}magic?a=account_email_update&t=${encodeURIComponent(t)}`;return{id:r,token:t,url:a}}async function dT({token:n}){const e=Jh(n),t=Se(ue,Og,e),r=await Qt(t);if(!r.exists())return{valid:!1,reason:"not_found"};const s=r.data();return s.token!==n?{valid:!1,reason:"token_mismatch"}:typeof s.expiresAt=="number"&&Date.now()>s.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:s}}async function hT({token:n}){const e=Jh(n),t=Se(ue,Og,e);await Ya(t)}const iM=Object.freeze(Object.defineProperty({__proto__:null,buildAccountId:Jh,consumeAccountEmailUpdateLink:hT,consumeMagicLink:$p,createAccountEmailUpdateLink:cT,createEmailVerificationLink:lT,createMagicLink:Fp,verifyAccountEmailUpdateLink:dT,verifyMagicLink:uT},Symbol.toStringTag,{value:"Module"})),Q_="impro_selector_trusted_players",J_=180*24*60*60*1e3;class oM{constructor(){this.trustedMap=this.load()}load(){try{const e=localStorage.getItem(Q_);if(!e)return{};const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}}persist(){try{localStorage.setItem(Q_,JSON.stringify(this.trustedMap))}catch{}}isPasswordCached(e){if(!e)return!1;const t=this.trustedMap[e];if(!t)return!1;const r=Date.now(),s=r-t<J_;return s?(this.trustedMap[e]=r,this.persist()):(delete this.trustedMap[e],this.persist()),s}getCachedPassword(e){return null}saveSession(e,t){e&&(this.trustedMap[e]=Date.now(),this.persist())}clearSession(e){e&&(delete this.trustedMap[e],this.persist())}clearExpiredSessions(){const e=Date.now();let t=!1;for(const[r,s]of Object.entries(this.trustedMap))e-s>J_&&(delete this.trustedMap[r],t=!0);t&&this.persist()}clearAllSessions(){this.trustedMap={},this.persist()}}const Vi=new oM;function Mg(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return e.toString()}function fT(n){return`seasonPreferredPlayer:${n||"global"}`}function Up(n,e){try{const t=fT(n),r=localStorage.getItem(t);if(!r){localStorage.setItem(t,JSON.stringify([e]));return}if(r.startsWith("[")){const s=JSON.parse(r);s.includes(e)||(s.push(e),localStorage.setItem(t,JSON.stringify(s)))}else r!==e&&localStorage.setItem(t,JSON.stringify([r,e]))}catch{}}function aM(n,e){try{const t=fT(n),r=localStorage.getItem(t);if(!r)return;if(r.startsWith("[")){const s=JSON.parse(r).filter(i=>i!==e);s.length===0?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(s))}else r===e&&localStorage.removeItem(t)}catch{}}async function pT(n,e,t,r=null){try{_e.info("Début protectPlayer",{playerId:n,seasonId:r});const s=await vl(n,r);if(s&&s.isProtected)throw new Error("Ce joueur est déjà protégé");const{collection:i,query:o,where:a,getDocs:l}=await Xt(()=>import("./index.esm-224d04fa.js"),[]),{db:c}=await Xt(()=>Promise.resolve().then(()=>wi),void 0),d=r?i(c,"seasons",r,"playerProtection"):i(c,"playerProtection"),f=o(d,a("email","==",e)),g=await l(f);if(!g.empty&&g.docs.find(M=>M.id!==n))throw new Error("Cette adresse email est déjà utilisée par un autre joueur");_e.debug("Création du compte Firebase Auth...");const{createUserWithEmailAndPassword:y}=await Xt(()=>import("./index.esm-fc3b6a68.js"),[]),{auth:T}=await Xt(()=>Promise.resolve().then(()=>wi),void 0),A=await y(T,e,t);_e.info("Compte Firebase Auth créé",{uid:A.user.uid});const P=Mg(t),U=r?Se(c,"seasons",r,"playerProtection",n):Se(c,"playerProtection",n);return await mn(U,{playerId:n,email:e,passwordHash:P,firebaseUid:A.user.uid,isProtected:!0,createdAt:new Date}),_e.info("Protection sauvegardée dans Firestore"),r&&Up(r,n),{success:!0}}catch(s){throw _e.error("Erreur lors de la protection du joueur",s),s}}async function mT({playerId:n,email:e,seasonId:t=null}){const r=t?Se(ue,"seasons",t,"playerProtection",n):Se(ue,"playerProtection",n);(await Qt(r)).exists()?await hl(r,{email:e,updatedAt:new Date}):await mn(r,{playerId:n,email:e,isProtected:!1,createdAt:new Date});const{url:i}=await lT({seasonId:t,playerId:n,email:e});return{success:!0,url:i}}async function gT({playerId:n,seasonId:e=null}){const t=e?Se(ue,"seasons",e,"playerProtection",n):Se(ue,"playerProtection",n);if(!(await Qt(t)).exists())throw new Error("Protection introuvable");return await hl(t,{emailVerifiedAt:new Date}),{success:!0}}async function vT({playerId:n,seasonId:e=null}){const t=e?Se(ue,"seasons",e,"playerProtection",n):Se(ue,"playerProtection",n);return await hl(t,{emailVerifiedAt:null}),{success:!0}}async function yT(n,e=null){try{const t=e?Se(ue,"seasons",e,"playerProtection",n):Se(ue,"playerProtection",n);return await mn(t,{playerId:n,email:"",isProtected:!1,emailVerifiedAt:null,updatedAt:new Date}),e&&aM(e,n),{success:!0,email:""}}catch(t){throw _e.error("Erreur lors de la suppression de la protection",t),t}}async function Ei(n,e=null){try{const t=e?Se(ue,"seasons",e,"playerProtection",n):Se(ue,"playerProtection",n),r=await Qt(t);return r.exists()?r.data().isProtected===!0:!1}catch(t){return _e.error("Erreur lors de la vérification de protection",t),!1}}async function vl(n,e=null){try{const t=e?Se(ue,"seasons",e,"playerProtection",n):Se(ue,"playerProtection",n),r=await Qt(t);return r.exists()?r.data():null}catch(t){return _e.error("Erreur lors de la récupération des données de protection",t),null}}async function _T(n,e=null){try{const t=await vl(n,e);return(t==null?void 0:t.email)||""}catch(t){return _e.error("Erreur lors de la récupération de l'email",t),""}}async function jp(n=null){try{const e=n?Je(ue,"seasons",n,"playerProtection"):Je(ue,"playerProtection");return(await bt(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return _e.error("Erreur lors du chargement des protections",e),[]}}async function Lg(n){try{const e=[],t=Ou(Je(ue,"playerProtection"),Gd("email","==",n));(await bt(t)).forEach(i=>{const o=i.data();o!=null&&o.isProtected&&e.push({seasonId:null,playerId:i.id,...o})});const s=await bt(Je(ue,"seasons"));for(const i of s.docs){const o=i.id,a=Ou(Je(ue,"seasons",o,"playerProtection"),Gd("email","==",n));(await bt(a)).forEach(c=>{var f;const d=c.data();d!=null&&d.isProtected&&e.push({seasonId:o,seasonName:(f=i.data())==null?void 0:f.name,playerId:c.id,...d})})}return e}catch(e){return _e.error("Erreur listAssociationsForEmail",e),[]}}async function bT(n,e,t=null){try{const r=await vl(n,t);if(!r||!r.isProtected)return!1;if(r.email){_e.debug("Vérification avec Firebase Auth");try{const{signInWithEmailAndPassword:s}=await Xt(()=>import("./index.esm-fc3b6a68.js"),[]),{auth:i}=await Xt(()=>Promise.resolve().then(()=>wi),void 0);return await s(i,r.email,e),_e.debug("Mot de passe Firebase Auth valide"),Vi.saveSession(n),t&&Up(t,n),!0}catch(s){return _e.debug("Mot de passe Firebase Auth invalide",{code:s.code}),!1}}else{_e.debug("Vérification avec hash local");const s=Mg(e),i=r.passwordHash===s;return i&&(Vi.saveSession(n),t&&Up(t,n)),i}}catch(r){return _e.error("Erreur lors de la vérification du mot de passe",r),!1}}async function wT({playerId:n,seasonId:e=null}){const t=e?Se(ue,"seasons",e,"playerProtection",n):Se(ue,"playerProtection",n),r=await Qt(t);if(!r.exists())throw new Error("Protection introuvable");const s=r.data();if(s!=null&&s.email)return await hl(t,{isProtected:!0,updatedAt:new Date}),{success:!0};throw new Error("Email non défini pour cette protection")}function To(n){return Vi.isPasswordCached(n)}function lM(n){return null}async function IT(n,e=null){try{_e.info("Début sendPasswordResetEmail",{playerId:n,seasonId:e});const t=await vl(n,e);if(_e.debug("Protection data disponible"),!t||!t.isProtected)throw new Error("Joueur non protégé");if(_e.debug("Email à utiliser (masqué)"),t.firebaseUid){_e.debug("Utilisation du compte Firebase Auth existant");const{sendPasswordResetEmail:r}=await Xt(()=>import("./index.esm-fc3b6a68.js"),[]),{auth:s}=await Xt(()=>Promise.resolve().then(()=>wi),void 0);_e.debug("Tentative d'envoi d'email"),await r(s,t.email),_e.info("Email envoyé avec succès via Firebase Auth")}else{_e.debug("Pas de compte Firebase Auth, création temporaire...");const{createUserWithEmailAndPassword:r,sendPasswordResetEmail:s}=await Xt(()=>import("./index.esm-fc3b6a68.js"),[]),{auth:i}=await Xt(()=>Promise.resolve().then(()=>wi),void 0),o=Math.random().toString(36).slice(-8)+"A1!";try{const a=await r(i,t.email,o);_e.info("Compte temporaire créé",{uid:a.user.uid}),await s(i,t.email),_e.info("Email envoyé avec succès");const{updateDoc:l}=await Xt(()=>import("./index.esm-224d04fa.js"),[]),{db:c}=await Xt(()=>Promise.resolve().then(()=>wi),void 0),d=e?Se(c,"seasons",e,"playerProtection",n):Se(c,"playerProtection",n);await l(d,{firebaseUid:a.user.uid})}catch(a){if(a.code==="auth/email-already-in-use")_e.debug("Email déjà utilisé, tentative d'envoi direct..."),await s(i,t.email),_e.info("Email envoyé avec succès");else throw a}}return{success:!0,message:"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}}catch(t){throw _e.error("Erreur lors de l'envoi de l'email de réinitialisation",{error:t}),t.code==="auth/user-not-found"?new Error("Aucun compte trouvé avec cette adresse email"):t.code==="auth/too-many-requests"?new Error("Trop de tentatives. Veuillez réessayer plus tard"):t.code==="auth/invalid-email"?new Error("Adresse email invalide"):new Error(`Erreur lors de l'envoi de l'email: ${t.message}`)}}async function uM(n,e,t=null){try{const r=Mg(e),s=t?Se(ue,"seasons",t,"playerProtection",n):Se(ue,"playerProtection",n);return await hl(s,{passwordHash:r,updatedAt:new Date}),{success:!0}}catch(r){throw _e.error("Erreur lors de la mise à jour du mot de passe",r),r}}async function cM(n){return new Promise((e,t)=>{_e.debug("Demande de mot de passe pour disponibilité"),t(new Error("Gestion de mot de passe à implémenter côté composant"))})}const mc=Object.freeze(Object.defineProperty({__proto__:null,clearEmailVerificationForProtection:vT,finalizeProtectionAfterVerification:wT,getCachedPlayerPassword:lM,getPlayerEmail:_T,getPlayerProtectionData:vl,isPlayerPasswordCached:To,isPlayerProtected:Ei,listAssociationsForEmail:Lg,listProtectedPlayers:jp,markEmailVerifiedForProtection:gT,protectPlayer:pT,requirePlayerPasswordForAvailability:cM,sendPasswordResetEmail:IT,startEmailVerificationForProtection:mT,unprotectPlayer:yT,updatePlayerPasswordInFirestore:uM,verifyPlayerPassword:bT},Symbol.toStringTag,{value:"Module"}));async function gc({toEmail:n,title:e,body:t,data:r={},reason:s="generic"}){if(!n)return{success:!1,error:"missing_toEmail"};const i={to:n,title:e,body:t,data:r,reason:s,createdAt:Bi()};return await fl(Je(ue,"pushQueue"),i),{success:!0}}async function dM({toEmail:n,playerName:e,eventTitle:t,eventDate:r,yesUrl:s,noUrl:i,eventUrl:o=void 0,reason:a="new_event",fromEmail:l=void 0}){try{const g=Se(ue,"userPreferences",n),y=await Qt(g);if(y.exists()){const T=y.data();if((T==null?void 0:T.notifyAvailability)===!1)return{success:!0,skipped:!0}}}catch{}const c=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <p><strong>Nouvel événement programmé!</strong></p>
      <p style="margin: 12px 0 2px 0; font-weight: 600;">${t}</p>
      <p style="margin: 0 0 16px 0; color:#374151;">${r}</p>
      <p>Nous avons besoin de savoir si tu es disponible.</p>
      <p style="margin-top: 12px;">
        <a href="${s}" style="display:inline-block;padding:10px 12px;margin-right:8px;border:2px solid #16a34a;color:#16a34a;border-radius:8px;text-decoration:none;">✅ Dispo</a>
        <a href="${i}" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;">❌ Pas dispo</a>
      </p>
      <p style="margin-top: 16px;">Merci!!</p>
    </div>
  `,d=`${a==="reminder"?"Rappel: ":""}${t} (${r})`,f={to:n,message:{subject:d,html:c},createdAt:Bi(),meta:{reason:a,eventTitle:t,eventDate:r,playerName:e}};l&&(f.from=l,f.replyTo=l),await fl(Je(ue,"mail"),f);try{const g=Se(ue,"userPreferences",n),y=await Qt(g),T=y.exists()?y.data():{};if((T==null?void 0:T.notifyAvailabilityPush)!==!1){const A=`${a==="reminder"?"Rappel: ":""}${t} (${r})`,P=`${e}, t'es dispo ?`;await gc({toEmail:n,title:A,body:P,data:{url:o||window.location.origin,yesUrl:s,noUrl:i,reason:a},reason:a==="reminder"?"availability_reminder":"availability_request"})}}catch{}return{success:!0}}async function ET({toEmail:n,verifyUrl:e,purpose:t="player_protection",displayName:r="utilisateur",fromEmail:s=void 0}){const i=t==="account_email_update",o=i?"Vérification de votre nouvelle adresse email":"Vérification de votre email",a=`Bonjour ${r},`,l=i?"Pour sécuriser votre compte, merci de confirmer que vous avez accès à cette nouvelle adresse email.":"Pour sécuriser votre joueur, merci de confirmer que vous avez accès à cette adresse email.",c=i?"Confirmer mon adresse email":"Vérifier mon email",d=i?"Confirmez votre nouvelle adresse email":"Confirmez votre email pour activer la protection",f=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>${o}</h2>
      <p>${a}</p>
      <p>${l}</p>
      <p>
        <a href="${e}" style="display:inline-block;padding:10px 16px;background:#3b82f6;color:#fff;border-radius:8px;text-decoration:none;">${c}</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Ce lien expirera dans 7 jours.</p>
    </div>
  `,g={to:n,message:{subject:d,html:f},createdAt:Bi(),meta:{reason:t,displayName:r}};s&&(g.from=s,g.replyTo=s),await fl(Je(ue,"mail"),g)}async function hM({toEmail:n,playerName:e,verifyUrl:t,fromEmail:r=void 0}){return ET({toEmail:n,verifyUrl:t,purpose:"player_protection",displayName:e,fromEmail:r})}async function fM({toEmail:n,playerName:e,eventTitle:t,eventDate:r,eventUrl:s,html:i=void 0,subject:o=void 0,fromEmail:a=void 0}){try{const f=Se(ue,"userPreferences",n),g=await Qt(f);if(g.exists()){const y=g.data();if((y==null?void 0:y.notifySelection)===!1)return{success:!0,skipped:!0}}}catch{}_e.debug("queueSelectionEmail",{forPlayer:e,hasCustomHtml:!!i,hasCustomSubject:!!o});const l=i||`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <p>Bonjour ${e},</p>
      <p>Félicitations ! Tu as été sélectionné(e) pour <strong>${t}</strong> (${r}).</p>
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 12px;border:2px solid #8b5cf6;color:#8b5cf6;border-radius:8px;text-decoration:none;">Afficher les Détails</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Tu recevras bientôt plus d'informations sur l'organisation.</p>
    </div>
  `,c=o||`🎭 Sélection confirmée · ${t}`;_e.debug("queueSelectionEmail html/subject ready");const d={to:n,message:{subject:c,html:l},createdAt:Bi(),meta:{reason:"selection",eventTitle:t,eventDate:r,playerName:e}};a&&(d.from=a,d.replyTo=a),_e.debug("queueSelectionEmail firestore payload ready");try{await fl(Je(ue,"mail"),d);try{const f=Se(ue,"userPreferences",n),g=await Qt(f),y=g.exists()?g.data():{};(y==null?void 0:y.notifySelectionPush)!==!1&&await gc({toEmail:n,title:"🎭 Sélection confirmée",body:`${e}, tu as été sélectionné(e) pour ${t} (${r}) 🎉`,data:{url:s||window.location.origin},reason:"selection"})}catch{}return _e.info("Email ajouté à la queue Firestore",{playerName:e}),{success:!0}}catch(f){throw _e.error("Erreur lors de l'ajout à Firestore",{playerName:e,error:f}),f}}async function pM({toEmail:n,playerName:e,eventTitle:t,eventDate:r,eventUrl:s,newSelectedPlayers:i=[],html:o=void 0,subject:a=void 0,fromEmail:l=void 0}){try{const y=Se(ue,"userPreferences",n),T=await Qt(y);if(T.exists()){const A=T.data();if((A==null?void 0:A.notifySelection)===!1)return{success:!0,skipped:!0}}}catch{}const c=Array.isArray(i)?i.join(", "):"",d=o||`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>🎭 Sélection mise à jour</h2>
      <p>Bonjour ${e},</p>
      <p>La sélection pour <strong>${t}</strong> (${r}) a été mise à jour et tu n'en fais plus partie 😔.</p>
      ${c?`<p>Nouvelle sélection: <strong>${c}</strong>.</p>`:""}
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;background:#6b7280;color:#fff;border-radius:8px;text-decoration:none;">Voir les détails de l'événement</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Motif: mise à jour de sélection (relance auto ou ajustement manuel).</p>
    </div>
  `,f=a||`🎭 Tu n'es plus dans la sélection · ${t}`,g={to:n,message:{subject:f,html:d},createdAt:Bi(),meta:{reason:"deselection",eventTitle:t,eventDate:r,playerName:e,newSelectedPlayers:i}};l&&(g.from=l,g.replyTo=l),await fl(Je(ue,"mail"),g);try{const y=Se(ue,"userPreferences",n),T=await Qt(y),A=T.exists()?T.data():{};(A==null?void 0:A.notifySelectionPush)!==!1&&await gc({toEmail:n,title:"🎭 Sélection mise à jour",body:`${e}, tu n'es plus sélectionné(e) pour ${t} (${r}) 😔`,data:{url:s||window.location.origin,noUrl:s&&s.includes("/event/")?s.replace("/event/","/magic?auto=no&event="):void 0},reason:"deselection"})}catch{}return{success:!0}}async function mM({eventId:n,eventData:e,selectedPlayers:t,seasonId:r,seasonSlug:s,players:i}){if(_e.info("sendSelectionEmailsForEvent",{eventId:n,seasonId:r,seasonSlug:s,playersCount:i==null?void 0:i.length,selectedCount:t==null?void 0:t.length}),!e||!t||t.length===0)throw new Error("Données manquantes pour l'envoi des emails de sélection");const{getPlayerEmail:o}=await Xt(()=>Promise.resolve().then(()=>mc),void 0),{createMagicLink:a}=await Xt(()=>Promise.resolve().then(()=>iM),void 0),l=`${window.location.origin}/season/${s}/event/${n}`;t.join(", ");const c=`🎭 Sélection confirmée · ${e.title}`,d=[];for(const f of t){_e.debug("Traitement du joueur",{playerName:f});try{const g=i==null?void 0:i.find(q=>q.name===f);if(!g){_e.warn("Joueur non trouvé",{playerName:f});continue}_e.debug("Joueur trouvé");const y=await o(g.id,r);if(!y){_e.warn("Pas d'email pour le joueur",{playerName:f});continue}_e.debug("Email trouvé pour joueur");const A=`${(await a({seasonId:r,playerId:g.id,eventId:n,action:"no"})).url}&slug=${encodeURIComponent(s)}`,P=`
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
          <p>Bonjour <strong>${f}</strong>,</p>
          <p>Tu as été sélectionné(e) pour <strong>${e.title}</strong> (${Xd(e.date)}).</p>
          <p>Un imprévu ?</p>
          <p>
            <a href="${A}" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;margin-right:8px;">❌ Plus dispo</a>
            <a href="${l}" style="display:inline-block;padding:10px 12px;border:2px solid #8b5cf6;color:#8b5cf6;border-radius:8px;text-decoration:none;">Afficher les Détails</a>
          </p>
        </div>
      `;_e.debug("HTML généré pour joueur");const U=fM({toEmail:y,playerName:f,eventTitle:e.title,eventDate:Xd(e.date),eventUrl:l,html:P,subject:c});d.push(U),_e.info("Email ajouté à la queue",{playerName:f})}catch(g){_e.error("Erreur lors de l'envoi de l'email de sélection",{playerName:f,error:g})}}return _e.info("Nombre total d'emails à envoyer",{count:d.length}),await Promise.all(d),_e.info("Tous les emails ont été envoyés avec succès"),{success:!0,count:d.length}}async function gM({eventId:n,eventData:e,removedPlayers:t,newSelectedPlayers:r,seasonId:s,seasonSlug:i,players:o}){if(_e.info("sendDeselectionEmailsForEvent",{eventId:n,seasonId:s,removedCount:t==null?void 0:t.length}),!e||!t||t.length===0)return{success:!0,count:0};const{getPlayerEmail:a}=await Xt(()=>Promise.resolve().then(()=>mc),void 0),l=`${window.location.origin}/season/${i}/event/${n}`,c=[],d=Array.isArray(r)?r.join(", "):"";for(const f of t)try{const g=o==null?void 0:o.find(A=>A.name===f);if(!g){_e.warn("Joueur retiré non trouvé",{playerName:f});continue}const y=await a(g.id,s);if(!y){_e.warn("Pas d'email pour le joueur retiré",{playerName:f});continue}const T=`
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
          <h2>🎭 Sélection mise à jour</h2>
          <p>Bonjour <strong>${f}</strong>,</p>
          <p>Tu n'es plus sélectionné(e) pour <strong>${e.title}</strong> (${Xd(e.date)}) 😔.</p>
          ${d?`<p>Nouvelle sélection: <strong>${d}</strong>.</p>`:""}
          <p>
            <a href="${l}" style="display:inline-block;padding:10px 12px;border:2px solid #6b7280;color:#6b7280;border-radius:8px;text-decoration:none;">Voir les détails de l'événement</a>
          </p>
        </div>
      `;c.push(pM({toEmail:y,playerName:f,eventTitle:e.title,eventDate:Xd(e.date),eventUrl:l,newSelectedPlayers:r,html:T}))}catch(g){_e.error("Erreur lors de l'envoi de l'email de désélection",{playerName:f,error:g})}return await Promise.all(c),_e.info("Emails de désélection envoyés",{count:c.length}),{success:!0,count:c.length}}function Xd(n){var t;return n?(typeof n=="string"?new Date(n):((t=n.toDate)==null?void 0:t.call(n))||n).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function vM({reason:n,recipientName:e,eventTitle:t,eventDate:r,urls:s={},prefs:i={},extra:o={}}){const a={email:null,push:null};if(n==="availability_request"||n==="availability_reminder"){const l=(i==null?void 0:i.notifyAvailability)!==!1,c=(i==null?void 0:i.notifyAvailabilityPush)!==!1;a.email={enabled:l,subject:n==="availability_reminder"?`Rappel disponibilité · ${t} (${r})`:`Disponibilité demandée · ${t} (${r})`},a.push={enabled:c,title:n==="availability_reminder"?"⏰ Rappel disponibilité":"🗓️ Disponibilité demandée",body:`${e}, ${t} (${r})`,data:{url:s.eventUrl,yesUrl:s.yesUrl,noUrl:s.noUrl,reason:n}}}if(n==="selection"){const l=(i==null?void 0:i.notifySelection)!==!1,c=(i==null?void 0:i.notifySelectionPush)!==!1;a.email={enabled:l,subject:`🎭 Sélection confirmée · ${t}`},a.push={enabled:c,title:"🎭 Sélection confirmée",body:`${e}, tu as été sélectionné(e) pour ${t} (${r}) 🎉`,data:{url:s.eventUrl}}}return a}async function yM({reason:n,recipientEmail:e,recipientName:t,eventTitle:r,eventDate:s,urls:i={},extra:o={}}){if(!e)return{success:!1,skipped:!0,reason:"missing_email"};const a=await Qt(Se(ue,"userPreferences",e)).catch(()=>null),l=a!=null&&a.exists()?a.data():{},c=vM({reason:n,recipientName:t,eventTitle:r,eventDate:s,urls:i,prefs:l,extra:o}),d=[];return c.email&&c.email.enabled&&(n==="availability_request"||n==="availability_reminder"?await dM({toEmail:e,playerName:t,eventTitle:r,eventDate:s,yesUrl:i.yesUrl,noUrl:i.noUrl,eventUrl:i.eventUrl,reason:n==="availability_reminder"?"reminder":"new_event"}).then(()=>d.push({channel:"email",success:!0})).catch(g=>{_e.error("notifyRecipientAcrossChannels email error",g),d.push({channel:"email",success:!1})}):n==="selection"&&d.push({channel:"email",success:!0,skipped:!0,note:"batch_handled_elsewhere"})),c.push&&c.push.enabled&&await gc({toEmail:e,title:c.push.title,body:c.push.body,data:c.push.data||{},reason:n}).then(()=>d.push({channel:"push",success:!0})).catch(g=>{_e.error("notifyRecipientAcrossChannels push error",g),d.push({channel:"push",success:!1})}),{success:d.some(g=>g.success),results:d}}async function Y_({eventId:n,eventData:e,players:t,seasonId:r,seasonSlug:s,createMagicLink:i,reminder:o=!1,getAvailabilityForEvent:a=null}){const l=[],c=`${window.location.origin}/season/${s}/event/${n}`;for(const d of t)try{if(o&&typeof a=="function"){const y=await Promise.resolve(a(d.name,n));if(y===!0||y===!1)continue}const f={};if(typeof i=="function"){const y=await i({seasonId:r,playerId:d.id,eventId:n,action:"yes"}),T=await i({seasonId:r,playerId:d.id,eventId:n,action:"no"});f.yesUrl=`${y.url}&slug=${encodeURIComponent(s)}`,f.noUrl=`${T.url}&slug=${encodeURIComponent(s)}`}f.eventUrl=c,(await yM({reason:o?"availability_reminder":"availability_request",recipientEmail:d.email,recipientName:d.name,eventTitle:e.title,eventDate:_M(e.date),urls:f})).success||l.push(d.id)}catch{l.push(d.id)}return{success:!0,failures:l}}async function X_(n){return mM(n)}function _M(n){var t;return n?(typeof n=="string"?new Date(n):((t=n.toDate)==null?void 0:t.call(n))||n).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}const bM="/icons/manifest-icon-192.maskable.png",wM={class:"relative p-5 pb-4 border-b border-white/10"},IM={class:"text-xl md:text-2xl font-bold text-white pr-10 flex items-center gap-2"},EM={key:0,class:"text-sm text-purple-300 mt-1"},TM={class:"px-4 md:px-6 py-4 md:py-6 space-y-6 overflow-y-auto"},xM={class:"space-y-4"},AM={class:"inline-flex bg-gray-800 rounded-lg overflow-hidden border border-gray-700 mb-3"},SM={class:"text-sm text-gray-300"},PM={class:"text-sm text-gray-300"},RM={class:"text-sm text-gray-300"},CM=["innerHTML"],kM=["value"],DM={class:"mt-3"},NM={class:"text-lg font-semibold leading-snug"},VM={class:"mt-2 text-base whitespace-pre-line text-white/90"},OM={class:"mt-4 flex items-center gap-4 text-base"},MM={key:1,class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-gray-100 text-gray-900 border border-white/20"},LM={class:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-200 rounded-md p-3 text-sm mb-2"},FM=["value"],$M={class:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2"},UM={key:0,class:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 mb-3"},jM={class:"bg-gray-800 border border-gray-600 rounded-lg p-3"},BM={key:0,class:"space-y-2"},qM={class:"flex flex-wrap gap-2"},zM=["onClick","title"],KM={key:1,class:"text-amber-400 text-sm"},GM={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},HM={class:"flex items-center gap-2 w-full"},WM=["disabled"],QM={key:0},JM={key:1,class:"inline-flex items-center gap-2"},YM=["title"],XM={key:0},ZM={key:1},TT={__name:"EventAnnounceModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},players:{type:Array,default:()=>[]},mode:{type:String,default:"event",validator:n=>["event","selection"].includes(n)},selectedPlayers:{type:Array,default:()=>[]},sending:{type:Boolean,default:!1},availabilityByPlayer:{type:Object,default:()=>({})}},emits:["close","notifications-sent","send-notifications"],setup(n,{emit:e}){const t=n,r=e;k("notify");const s=k(!1),i=k("Copier le message"),o=k(!1),a=Oe(()=>t.sending||o.value),l=k(!1),c=k("email"),d=Oe(()=>!t.event||!t.seasonSlug?"":`${window.location.origin}/season/${t.seasonSlug}/event/${t.event.id}`),f=Oe(()=>{if(!t.event)return"";if(c.value==="push"){const j=P.value,ne=U.value;if(t.mode==="event"){const Ke=`

Lien direct: ${d.value}`;return`${j}
${ne}
✅ Dispo
❌ Pas dispo${Ke}`}return`${j}
${ne}
Ouvrir`}const Y=`

Lien direct: ${d.value}`;return`Objet: ${g.value}

${A.value}${Y}`}),g=Oe(()=>{var j,ne,Ke;const Y=B((j=t.event)==null?void 0:j.date);return t.mode==="event"?`${(ne=t.event)==null?void 0:ne.title} (${Y})`:`🎭 Sélection confirmée · ${(Ke=t.event)==null?void 0:Ke.title}`}),y=Oe(()=>"impropick@gmail.com"),T=Oe(()=>{var ne,Ke,Be,Ge,re,ee,je;const Y=((ne=z.value)==null?void 0:ne.id)==="ALL"?"<joueur>":((Ke=z.value)==null?void 0:Ke.name)||"[Nom du joueur]",j=B((Be=t.event)==null?void 0:Be.date);return z.value&&z.value.id&&z.value.id!=="ALL"&&!((Ge=pe.value.find(Xe=>Xe.id===z.value.id))!=null&&Ge.hasContact)?`
      <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
        <p><strong>${Y}</strong> n'a pas configuré d'email. Utilise la fonction « Copier le message » et envoie-lui ces informations par un autre canal.</p>
        <p style="margin-top: 8px; font-weight: 600;">${(re=t.event)==null?void 0:re.title}</p>
        <p style="color:#374151;">${j}</p>
        <p style="margin-top: 8px;">Lien direct : ${d.value}</p>
      </div>
    `:t.mode==="event"?`
      <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
        <p><strong>${Y}</strong>, un nouvel événement est prévu.</p>
        <p style="margin: 12px 0 2px 0; font-weight: 600;">${(ee=t.event)==null?void 0:ee.title}</p>
        <p style="margin: 0 0 16px 0; color:#374151;">${j}</p>
        <p>Nous avons besoin de savoir si tu es disponible.</p>
        <p style="margin-top: 12px;">
          <a href="#yes" style="display:inline-block;padding:10px 12px;margin-right:8px;border:2px solid #16a34a;color:#16a34a;border-radius:8px;text-decoration:none;">✅ Dispo</a>
          <a href="#no" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;">❌ Pas dispo</a>
        </p>
        <p style="margin-top: 16px;">Merci!!</p>
      </div>
    `:`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <p>Bonjour ${Y},</p>
      <p>Tu as été sélectionné(e) pour <strong>${(je=t.event)==null?void 0:je.title}</strong> (${j}).</p>
      <p>Un imprévu ?</p>
      <p>
        <a href="#no" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;margin-right:8px;">❌ Plus dispo</a>
        <a href="#event" style="display:inline-block;padding:10px 12px;border:2px solid #8b5cf6;color:#8b5cf6;border-radius:8px;text-decoration:none;">Afficher les Détails</a>
      </p>
    </div>
  `}),A=Oe(()=>T.value.replace(/<\/?div[^>]*>/g,`
`).replace(/<\/?p[^>]*>/g,`
`).replace(/<br\s*\/?>(\n)?/g,`
`).replace(/<[^>]+>/g,"").replace(/\n{3,}/g,`

`).trim()),P=Oe(()=>{var Y,j;return t.mode==="event"?`${(Y=t.event)==null?void 0:Y.title} (${B((j=t.event)==null?void 0:j.date)})`:"🎭 Sélection confirmée"}),U=Oe(()=>{var Be,Ge,re,ee,je,Xe;const Y=B((Be=t.event)==null?void 0:Be.date),j=((Ge=z.value)==null?void 0:Ge.id)==="ALL"?"<joueur>":((re=z.value)==null?void 0:re.name)||"[Nom du joueur]",ne=z.value&&z.value.id&&z.value.id!=="ALL",Ke=ne?!!((ee=pe.value.find(ht=>ht.id===z.value.id))!=null&&ee.hasContact):!0;return ne&&!Ke?`${j} n'a pas installé l'appli. Envoie-lui ce message manuellement.
${(je=t.event)==null?void 0:je.title} (${Y})
Lien: ${d.value}`:t.mode==="event"?`${j}, t'es dispo ?`:`${j}, tu as été sélectionné(e) pour ${(Xe=t.event)==null?void 0:Xe.title} (${Y}) 🎉`}),q=k([]),M=k([]),z=k(null),he=k([]),pe=Oe(()=>{const Y=M.value.map(ne=>({...ne,hasContact:ne.id!=="ALL",missingReason:""})),j=he.value.map(ne=>({...ne,hasContact:!1,missingReason:"Aucun canal actif"}));return[{id:"ALL",name:"Tous",hasContact:!0},...Y.filter(ne=>ne.id!=="ALL"),...j]}),x=Oe(()=>{if(!z.value||z.value.id==="ALL")return!0;const Y=pe.value.find(j=>(j.id||j.name)===(z.value.id||z.value.name));return!!(Y!=null&&Y.hasContact)}),I=Oe(()=>{var ne,Ke,Be,Ge,re;const Y=((ne=z.value)==null?void 0:ne.id)==="ALL"?"<joueur>":((Ke=z.value)==null?void 0:Ke.name)||"[Nom du joueur]",j=B((Be=t.event)==null?void 0:Be.date);return t.mode==="selection"?`Bonjour ${Y},
Tu as été sélectionné(e) pour ${(Ge=t.event)==null?void 0:Ge.title} (${j})
Un imprévu ? ${w.value}
Détails : ${d.value}`:`Bonjour ${Y},
${(re=t.event)==null?void 0:re.title} (${j})
Peux-tu indiquer ta disponibilité ?
Lien : ${d.value}`}),w=Oe(()=>{var Y,j;try{const ne=(Y=z.value)!=null&&Y.id&&z.value.id!=="ALL"?t.players.find(Ke=>Ke.id===z.value.id):null;return!ne||!((j=t.event)!=null&&j.id)||!t.seasonId?"[lien désistement]":`${window.location.origin}/magic?auto=no&season=${encodeURIComponent(t.seasonId)}&player=${encodeURIComponent(ne.id)}&event=${encodeURIComponent(t.event.id)}&slug=${encodeURIComponent(t.seasonSlug||"")}`}catch{return"[lien désistement]"}});async function C(){if(!t.seasonId)return;let Y=[];t.mode==="selection"?Y=t.players.filter(Be=>t.selectedPlayers.includes(Be.name)):Y=t.players.filter(Be=>{var re;return typeof((re=t.availabilityByPlayer)==null?void 0:re[Be.name])>"u"});const j=[];for(const Be of Y)try{const{getPlayerEmail:Ge}=await Xt(()=>Promise.resolve().then(()=>mc),void 0),re=await Ge(Be.id,t.seasonId);re&&j.push({...Be,email:re})}catch(Ge){console.warn(`Impossible de charger l'email pour ${Be.name}:`,Ge)}q.value=j;const ne={id:"ALL",name:"Tous"};M.value=[ne,...j];const Ke=Y.filter(Be=>!j.find(Ge=>Ge.id===Be.id)).map(Be=>({id:Be.id,name:Be.name}));he.value=Ke,z.value||(z.value=ne)}function V(){r("close")}function B(Y){var ne;return Y?(typeof Y=="string"?new Date(Y):((ne=Y.toDate)==null?void 0:ne.call(Y))||Y).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function R(){const Y=f.value;navigator.clipboard.writeText(Y).then(()=>{s.value=!0,i.value="Copié !",setTimeout(()=>{s.value=!1,i.value="Copier le message"},2e3)}).catch(j=>{console.warn("Erreur lors de la copie du texte"),alert("Impossible de copier le message.")})}function wt(Y){z.value=Y}async function gt(){if(!(!t.event||M.value.length===0)){o.value=!0;try{const Y=z.value&&z.value.id!=="ALL"?"single":"all",j=Y==="single"?{id:z.value.id,name:z.value.name,email:z.value.email}:null;t.mode==="selection"?r("send-notifications",{eventId:t.event.id,eventData:t.event,reason:"selection",selectedPlayers:t.selectedPlayers,scope:Y,recipient:j}):r("send-notifications",{eventId:t.event.id,eventData:t.event,reason:"manual",scope:Y,recipient:j})}catch{console.error("Erreur lors de l'envoi des notifications"),alert("Erreur lors de l'envoi des notifications. Veuillez réessayer.")}}}return ir(()=>{t.show&&C()}),xt(()=>t.show,Y=>{Y&&C()}),xt(()=>t.selectedPlayers,()=>{t.show&&t.mode==="selection"&&C()}),xt(()=>t.availabilityByPlayer,()=>{t.show&&t.mode==="event"&&C()},{deep:!0}),xt(()=>t.sending,Y=>{Y||(o.value=!1)}),(Y,j)=>{var ne,Ke,Be,Ge,re;return n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:V},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-3xl max-h-[92vh] flex flex-col",onClick:j[3]||(j[3]=Ft(()=>{},["stop"]))},[h("div",wM,[h("button",{onClick:V,title:"Fermer",class:"absolute right-2.5 top-2.5 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),h("h2",IM,[h("span",null,le(n.mode==="selection"?"📣":"📢"),1),h("span",null,le(n.mode==="selection"?"Annoncer la sélection":"Annoncer l'événement"),1)]),n.event?(L(),F("p",EM,le(n.event.title)+" — "+le(B(n.event.date)),1)):ge("",!0)]),h("div",TM,[h("div",xM,[h("div",null,[j[11]||(j[11]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Prévisualisation du message :",-1)),h("div",AM,[h("button",{class:Tt(["px-3 py-2 text-sm transition-colors",c.value==="email"?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"]),onClick:j[0]||(j[0]=ee=>c.value="email"),title:"Prévisualiser l'email"},"📧",2),h("button",{class:Tt(["px-3 py-2 text-sm transition-colors",c.value==="push"?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"]),onClick:j[1]||(j[1]=ee=>c.value="push"),title:"Prévisualiser la notification push"},"🔔",2)]),c.value==="email"?(L(),F("div",{key:0,class:Tt(x.value||((ne=z.value)==null?void 0:ne.id)==="ALL"?"bg-gray-800 border border-gray-600 rounded-lg p-4 text-white space-y-3":"space-y-3")},[x.value||((Ke=z.value)==null?void 0:Ke.id)==="ALL"?(L(),F(dt,{key:0},[h("div",SM,[j[4]||(j[4]=h("span",{class:"font-semibold"},"De:",-1)),Dt(" "+le(y.value),1)]),h("div",PM,[j[5]||(j[5]=h("span",{class:"font-semibold"},"À:",-1)),Dt(" "+le(((Be=z.value)==null?void 0:Be.id)==="ALL"?"<joueur>":((Ge=z.value)==null?void 0:Ge.name)||"[Nom du joueur]"),1)]),h("div",RM,[j[6]||(j[6]=h("span",{class:"font-semibold"},"Objet:",-1)),Dt(" "+le(g.value),1)]),h("div",{class:"bg-white text-black rounded-md p-4",innerHTML:T.value},null,8,CM)],64)):(L(),F(dt,{key:1},[j[7]||(j[7]=h("div",{class:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-200 rounded-md p-3 text-sm"}," Ce joueur n'a pas configuré d'email. Utilise la fonction « Copier le message » et envoie-lui ces informations par un autre canal. ",-1)),h("textarea",{class:"w-full mt-2 p-3 bg-gray-900 border border-gray-700 rounded-md text-white text-sm",value:I.value,rows:"5",readonly:""},null,8,kM)],64))],2)):(L(),F("div",{key:1,class:Tt(z.value&&z.value.id!=="ALL"&&!x.value?"text-white":"bg-gray-900 border border-gray-700 rounded-xl p-4 text-white")},[z.value&&z.value.id!=="ALL"&&!x.value?(L(),F(dt,{key:1},[h("div",LM,le((re=z.value)==null?void 0:re.name)+" n'a pas installé l'appli. Envoie-lui ce message manuellement. ",1),h("textarea",{class:"w-full p-3 bg-gray-800 border border-gray-700 rounded-md text-white text-sm",value:I.value,rows:"5",readonly:""},null,8,FM)],64)):(L(),F(dt,{key:0},[j[10]||(j[10]=Jn('<div class="flex items-center justify-between text-xs text-white/70"><div class="flex items-center gap-2 min-w-0"><div class="w-6 h-6 rounded-full bg-white/10 flex items-center justify-center">🔔</div><div class="truncate">Impropick</div><span class="opacity-60">•</span><span>il y a 1 min</span></div><img src="'+bM+'" alt="App icon" class="w-10 h-10 rounded-full shadow"></div>',1)),h("div",DM,[h("div",NM,le(P.value),1),h("div",VM,le(U.value),1)]),h("div",OM,[t.mode==="event"?(L(),F(dt,{key:0},[j[8]||(j[8]=h("span",{class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-green-600/20 text-green-300 border border-green-600/40"},"✅ Dispo",-1)),j[9]||(j[9]=h("span",{class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-red-600/20 text-red-300 border border-red-600/40"},"❌ Pas dispo",-1))],64)):(L(),F("span",MM,"Ouvrir"))])],64))],2))]),h("div",null,[h("label",$M,[j[12]||(j[12]=Dt(" Destinataires ")),h("button",{onClick:j[2]||(j[2]=ee=>l.value=!l.value),class:"text-blue-400 hover:text-blue-300 text-lg cursor-help",title:"Cliquer pour plus d'information"}," ? ")]),l.value?(L(),F("div",UM,j[13]||(j[13]=[h("p",{class:"text-blue-200 text-sm"},[Dt(" Cette liste montre tous les joueurs ciblés: "),h("span",{class:"text-purple-300"},"« Tous »"),Dt(", "),h("span",{class:"text-gray-200"},"ceux notifiables (email/push actifs)"),Dt(" et "),h("span",{class:"text-yellow-300"},"ceux en jaune sans canal actif"),Dt(". Les joueurs en jaune ne peuvent pas être notifiés automatiquement. Utilise « Copier le message » pour leur écrire via un autre moyen (l'URL de l'événement est incluse). ")],-1)]))):ge("",!0),h("div",jM,[pe.value.length>0?(L(),F("div",BM,[h("div",qM,[(L(!0),F(dt,null,wr(pe.value,ee=>(L(),F("button",{key:ee.id||ee.name,type:"button",onClick:je=>wt(ee),class:Tt(["px-3 py-1 rounded text-sm border transition-colors",z.value&&z.value.id===ee.id?"bg-purple-600 border-purple-500 text-white":ee.hasContact?"bg-gray-700 border-gray-600 text-white hover:bg-gray-600":"bg-yellow-900/20 border-yellow-600/40 text-yellow-200 hover:bg-yellow-900/30 opacity-75 cursor-not-allowed"]),title:ee.hasContact?"Prévisualiser pour "+ee.name:ee.missingReason||"Aucun canal actif"},le(ee.name),11,zM))),128))])])):(L(),F("div",KM," ⚠️ Aucun destinataire disponible. "))])])])]),h("div",GM,[h("div",HM,[h("button",{onClick:gt,disabled:M.value.length===0||a.value||z.value&&z.value.id!=="ALL"&&!x.value,class:"h-12 px-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600 flex-1"},[a.value?(L(),F("span",JM,j[14]||(j[14]=[h("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[h("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),h("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),Dt(" Envoi en cours... ")]))):(L(),F("span",QM,[z.value&&z.value.id!=="ALL"?(L(),F("span",{key:0,class:Tt(x.value?"":"opacity-60")},"🔔 Notifier "+le(z.value.name),3)):(L(),F(dt,{key:1},[Dt("🔔 Envoyer les notifications")],64))]))],8,WM),h("button",{onClick:R,class:"h-12 px-6 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300",title:i.value},[s.value?(L(),F("span",ZM,"✅ Copié")):(L(),F("span",XM,"📋 Copier le message"))],8,YM)]),h("button",{onClick:V,class:"h-12 px-4 bg-gray-700 text-white rounded-lg"}," Fermer ")])])])):ge("",!0)}}},eL={class:"text-center mb-6"},tL={class:"text-lg text-gray-300"},nL={class:"mb-6"},rL={class:"space-y-4"},sL={class:"flex items-center gap-2 text-gray-300 text-sm"},iL=["disabled"],oL={key:0,class:"animate-spin"},aL={key:1},lL={class:"mb-6 text-center"},uL={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},cL={class:"text-red-300 text-sm"},dL={class:"text-center mb-6"},hL={class:"text-lg text-gray-300"},fL={class:"mb-6"},pL=["disabled"],mL={key:0,class:"animate-spin"},gL={key:1},vL={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},yL={class:"text-red-300 text-sm"},_L={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},bL={class:"text-green-300 text-sm"},wL={class:"flex justify-center"},Fg={__name:"PasswordVerificationModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","verified"],setup(n,{emit:e}){const t=n,r=e,s=k(""),i=k(!1),o=k(""),a=k(!1),l=k(""),c=k(""),d=k(null),f=k(!0);async function g(){if(s.value){i.value=!0,o.value="";try{const A=await Op(t.seasonId);if(s.value===A){if(f.value)try{Vi.saveSession(t.player.id)}catch{}r("verified",{type:"season_pin"}),T();return}if(await bT(t.player.id,s.value,t.seasonId)){if(f.value)try{Vi.saveSession(t.player.id)}catch{}r("verified",{type:"player_password"}),T()}else o.value="Mot de passe incorrect. Veuillez réessayer."}catch(A){_e.error("Erreur lors de la vérification",A),o.value="Erreur lors de la vérification. Veuillez réessayer."}finally{i.value=!1}}}async function y(){i.value=!0,l.value="",c.value="";try{const A=await IT(t.player.id,t.seasonId);c.value=A.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(A){_e.error("Erreur lors de l'envoi de l'email",A),l.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{i.value=!1}}function T(){r("close"),s.value="",o.value="",a.value=!1,l.value="",c.value=""}return xt(()=>t.show,A=>{A&&fn(()=>{d.value&&d.value.focus()})}),(A,P)=>{var U,q;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4",onClick:T},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:P[3]||(P[3]=Ft(()=>{},["stop"]))},[h("div",eL,[P[7]||(P[7]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"🔐")],-1)),P[8]||(P[8]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Vérification requise",-1)),h("p",tL,le((U=n.player)==null?void 0:U.name),1),P[9]||(P[9]=h("p",{class:"text-sm text-gray-400 mt-2"},"Ce joueur est protégé par mot de passe",-1))]),h("div",nL,[h("div",rL,[h("div",null,[P[10]||(P[10]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),nt(h("input",{"onUpdate:modelValue":P[0]||(P[0]=M=>s.value=M),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:Mn(g,["enter"]),ref_key:"passwordInput",ref:d},null,544),[[kt,s.value]])]),h("div",sL,[nt(h("input",{id:"staySignedIn",type:"checkbox","onUpdate:modelValue":P[1]||(P[1]=M=>f.value=M),class:"w-4 h-4"},null,512),[[vi,f.value]]),P[11]||(P[11]=h("label",{for:"staySignedIn"},"Rester connecté sur cet appareil",-1))])]),h("button",{onClick:g,disabled:!s.value||i.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(L(),F("span",oL,"⏳")):(L(),F("span",aL,"🔓")),h("span",null,le(i.value?"Vérification...":"Vérifier"),1)],8,iL)]),h("div",lL,[h("button",{onClick:P[2]||(P[2]=M=>a.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),o.value?(L(),F("div",uL,[h("div",cL,le(o.value),1)])):ge("",!0),h("div",{class:"flex justify-center"},[h("button",{onClick:T,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):ge("",!0),a.value?(L(),F("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:P[6]||(P[6]=M=>a.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:P[5]||(P[5]=Ft(()=>{},["stop"]))},[h("div",dL,[P[12]||(P[12]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"📧")],-1)),P[13]||(P[13]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Mot de passe oublié",-1)),h("p",hL,le((q=n.player)==null?void 0:q.name),1)]),h("div",fL,[P[14]||(P[14]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),h("button",{onClick:y,disabled:i.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(L(),F("span",mL,"⏳")):(L(),F("span",gL,"📧")),h("span",null,le(i.value?"Envoi...":"Envoyer l'email"),1)],8,pL)]),l.value?(L(),F("div",vL,[h("div",yL,le(l.value),1)])):ge("",!0),c.value?(L(),F("div",_L,[h("div",bL,le(c.value),1)])):ge("",!0),h("div",wL,[h("button",{onClick:P[4]||(P[4]=M=>a.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ge("",!0)],64)}}},IL={class:"text-center mb-6"},EL={class:"text-sm text-gray-300"},TL={key:0,class:"space-y-4"},xL={key:0,class:"p-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-200 text-sm flex items-center gap-2"},AL={key:1,class:"space-y-4"},SL=["disabled"],PL={key:0,class:"animate-spin"},RL={key:1},CL={key:2,class:"mt-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm"},kL={class:"mt-6 flex justify-center gap-3"},DL=["disabled"],NL={key:0,class:"animate-spin"},VL={key:1},xT={__name:"AccountClaimModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","success"],setup(n,{emit:e}){const t=n,r=e,s=k(1),i=k(""),o=k(""),a=k(""),l=k(!1),c=k(""),d=k(!1),f=Za(),g=Oe(()=>i.value&&i.value.includes("@")),y=Oe(()=>o.value&&a.value&&o.value===a.value&&o.value.length>=6);async function T(){var q,M,z;if(!(!g.value||!((q=t.player)!=null&&q.id))){l.value=!0,c.value="";try{const he=await mT({playerId:t.player.id,email:i.value.trim(),seasonId:t.seasonId}),pe=(M=f.params)==null?void 0:M.slug,x=`${he.url}${pe?`&slug=${encodeURIComponent(pe)}`:""}&player=${encodeURIComponent(t.player.id)}&open=protection`;await hM({toEmail:i.value,playerName:((z=t.player)==null?void 0:z.name)||"joueur",verifyUrl:x}),d.value=!0}catch{c.value="Impossible d'envoyer l'email de vérification"}finally{l.value=!1}}}async function A(){try{await vT({playerId:t.player.id,seasonId:t.seasonId})}catch{}s.value=1,d.value=!1,i.value="",o.value="",a.value=""}async function P(){var q;try{const M=await vl((q=t.player)==null?void 0:q.id,t.seasonId);M!=null&&M.email&&(M!=null&&M.emailVerifiedAt)?s.value=2:s.value=1}catch{s.value=1}}ir(()=>{P()}),xt(()=>t.show,q=>{q&&P()});async function U(){if(y.value){l.value=!0,c.value="";try{await pT(t.player.id,i.value.trim(),o.value,t.seasonId),r("success")}catch(q){c.value=(q==null?void 0:q.message)||"Erreur lors de l'association"}finally{l.value=!1}}}return(q,M)=>{var z;return n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[160] p-4",onClick:M[6]||(M[6]=he=>q.$emit("close"))},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-md",onClick:M[5]||(M[5]=Ft(()=>{},["stop"]))},[h("button",{onClick:M[0]||(M[0]=he=>q.$emit("close")),class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"}," ✖️ "),h("div",IL,[M[7]||(M[7]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"👤")],-1)),M[8]||(M[8]=h("h2",{class:"text-2xl font-bold text-white mb-1"},"Associer un compte",-1)),h("p",EL,"Pour sécuriser les saisies de "+le((z=n.player)==null?void 0:z.name),1)]),s.value===1?(L(),F("div",TL,[h("div",null,[M[9]||(M[9]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Adresse email",-1)),nt(h("input",{"onUpdate:modelValue":M[1]||(M[1]=he=>i.value=he),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[kt,i.value]])]),d.value?(L(),F("div",xL,[M[10]||(M[10]=h("span",null,"✅",-1)),h("span",null,"Un email a été envoyé à "+le(i.value)+". Cliquez sur le lien contenu dans l'email pour continuer.",1)])):ge("",!0)])):s.value===2?(L(),F("div",AL,[h("div",{class:"p-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-200 text-sm flex items-center gap-2"},[M[11]||(M[11]=h("span",null,"✅",-1)),M[12]||(M[12]=h("span",null,"Adresse email vérifiée",-1)),h("button",{type:"button",onClick:A,title:"Changer d'adresse email",class:"ml-auto px-2 py-1 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 text-white/80 hover:text-white transition-colors"},"✏️")]),h("div",null,[M[13]||(M[13]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":M[2]||(M[2]=he=>o.value=he),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe sécurisé (min. 6 caractères)"},null,512),[[kt,o.value]])]),h("div",null,[M[14]||(M[14]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":M[3]||(M[3]=he=>a.value=he),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe"},null,512),[[kt,a.value]])]),h("button",{onClick:U,disabled:!y.value||l.value,class:"w-full px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(L(),F("span",PL,"⏳")):(L(),F("span",RL,"🔒")),h("span",null,le(l.value?"Association...":"Associer ce joueur"),1)],8,SL)])):ge("",!0),c.value?(L(),F("div",CL,le(c.value),1)):ge("",!0),h("div",kL,[h("button",{onClick:M[4]||(M[4]=he=>q.$emit("close")),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer"),s.value===1?(L(),F("button",{key:0,onClick:T,disabled:!g.value||l.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(L(),F("span",NL,"⏳")):(L(),F("span",VL,"✉️")),h("span",null,le(l.value?"Envoi...":"Envoyer le lien de vérification"),1)],8,DL)):ge("",!0)])])])):ge("",!0)}}},OL={class:"mt-4"},ML={key:0,class:"mt-2 p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg text-sm text-gray-300 space-y-2"},AT={__name:"AccountBenefitsHint",setup(n){const e=k(!1);return(t,r)=>(L(),F("div",OL,[h("button",{onClick:r[0]||(r[0]=s=>e.value=!e.value),class:"w-full p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-all duration-200 flex items-center justify-between"},[r[1]||(r[1]=h("h3",{class:"text-sm font-semibold text-blue-300"},"💡 A quoi sert un compte ?",-1)),h("span",{class:Tt(["text-blue-300 transition-transform duration-200",{"rotate-180":e.value}])},"▼",2)]),e.value?(L(),F("div",ML,r[2]||(r[2]=[h("div",{class:"text-gray-300"},"Ça fonctionne très bien sans compte. Mais si vous en créez un, vous aurez quelques trucs sympas en plus :",-1),h("div",null,[Dt("• "),h("span",{class:"text-blue-300"},"Protégez vos saisies :"),Dt(" vous êtes sûr que personne n'a changé vos dispos car vous êtes le seul à pouvoir les modifier")],-1),h("div",null,[Dt("• "),h("span",{class:"text-blue-300"},"Notifications :"),Dt(" nouveaux spectacles, disponibilités et sélections dans votre boite mail")],-1),h("div",null,[Dt("• "),h("span",{class:"text-blue-300"},"Saisie simplifiée :"),Dt(" votre joueur reste toujours en haut de la liste")],-1)]))):ge("",!0)]))}},LL={class:"text-center mb-6"},FL={class:"text-2xl font-bold text-white mb-2"},$L={class:"text-lg text-gray-300"},UL={class:"mb-6"},jL={class:"flex items-center space-x-3"},BL={class:"text-2xl"},qL={class:"font-semibold text-white"},zL={class:"text-sm text-gray-300"},KL={key:0,class:"mb-6"},GL={key:1,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},HL={class:"text-red-300 text-sm"},WL={key:2,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},QL={class:"text-green-300 text-sm"},JL={class:"flex justify-center gap-3"},YL=["disabled"],XL={__name:"PlayerClaimModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null},onboarding:{type:Boolean,default:!1}},emits:["close","update","onboarding-finished"],setup(n,{emit:e}){const t=n,r=e,s=k(!1),i=k(!1),o=k(!1),a=k(""),l=k(""),c=k(!1);Za();const d=k(!1);Oe(()=>!1),Oe(()=>!1);function f(){l.value="Compte créé et joueur associé !",s.value=!0,c.value=!1,r("update")}async function g(){var U;if((U=t.player)!=null&&U.id){s.value=await Ei(t.player.id,t.seasonId);try{const{isPlayerPasswordCached:q}=await Xt(()=>Promise.resolve().then(()=>mc),void 0);i.value=q(t.player.id)}catch{i.value=!1}}}function y(){var U;a.value="";try{if((U=t.player)!=null&&U.id&&To(t.player.id)){T();return}}catch{}d.value=!0}async function T(){o.value=!0,a.value="",l.value="";try{const U=await yT(t.player.id,t.seasonId);l.value="Joueur déverrouillé!",s.value=!1,U.email&&(email.value=U.email),r("update")}catch(U){logger.error("Erreur lors de la désactivation de la protection",U),a.value="Erreur lors de la désactivation de la protection. Veuillez réessayer."}finally{o.value=!1}}function A(){d.value=!1,T()}function P(){r("close")}return xt(()=>t.player,()=>{t.show&&t.player&&g()},{immediate:!0}),xt(()=>t.show,U=>{U&&t.player&&(a.value="",l.value="",d.value=!1,g(),t.onboarding&&fn(()=>{}))}),(U,q)=>{var M;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4",onClick:P},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:q[1]||(q[1]=Ft(()=>{},["stop"]))},[h("button",{onClick:P,class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"}," ✖️ "),h("div",LL,[q[4]||(q[4]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"🔒")],-1)),h("h2",FL,le(s.value?"Déverrouiller ce joueur":"Verrouiller ce joueur"),1),h("p",$L,le((M=n.player)==null?void 0:M.name),1)]),h("div",UL,[h("div",{class:Tt(["flex items-center justify-between p-4 rounded-lg",s.value?"bg-green-500/20 border border-green-500/30":"bg-gray-500/20 border border-gray-500/30"])},[h("div",jL,[h("span",BL,le(s.value?"🔒":"🔓"),1),h("div",null,[h("div",qL,le(s.value?i.value?"Joueur associé à votre compte":"Ce joueur est associé à un compte utilisateur":"Joueur sans compte"),1),h("div",zL,le(s.value?i.value?"Seul vous pouvez modifier":"Seul le titulaire peut modifier les disponibilités":"Tout le monde peut modifier les disponibilités"),1)])])],2)]),s.value?ge("",!0):(L(),F("div",KL,q[5]||(q[5]=[h("div",{class:"text-sm text-gray-300"},"Vous pouvez protéger vos saisies de disponibilités avec un compte utilisateur.",-1)]))),a.value?(L(),F("div",GL,[h("div",HL,le(a.value),1)])):ge("",!0),l.value?(L(),F("div",WL,[h("div",QL,le(l.value),1)])):ge("",!0),h("div",JL,[h("button",{onClick:P,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer "),s.value?(L(),F("button",{key:1,onClick:y,disabled:o.value,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," 🔓 Dissocier ",8,YL)):(L(),F("button",{key:0,onClick:q[0]||(q[0]=z=>c.value=!0),class:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300"}," Associer un compte "))]),s.value?ge("",!0):(L(),Ad(AT,{key:3}))])])):ge("",!0),ct(xT,{show:c.value,player:n.player,"season-id":n.seasonId,onClose:q[2]||(q[2]=z=>c.value=!1),onSuccess:f},null,8,["show","player","season-id"]),ct(Fg,{show:d.value,player:n.player,seasonId:n.seasonId,onClose:q[3]||(q[3]=z=>d.value=!1),onVerified:A},null,8,["show","player","seasonId"])],64)}}};const ZL=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},eF={class:"relative text-center p-6 pb-4 border-b border-white/10"},tF={class:"text-2xl md:text-3xl font-bold text-white mb-1"},nF={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},rF={class:"grid grid-cols-3 gap-3 md:gap-4"},sF={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},iF={class:"text-xl md:text-2xl font-bold text-white"},oF={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},aF={class:"text-xl md:text-2xl font-bold text-white"},lF={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 md:p-4 rounded-lg border border-green-500/30"},uF={class:"text-xl md:text-2xl font-bold text-white"},cF={class:"hidden md:flex justify-center flex-wrap gap-3 mt-6"},dF={key:0,class:"md:hidden mt-3 space-y-2"},hF={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},fF={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},pF={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},mF={class:"mb-6"},gF={__name:"PlayerModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},stats:{type:Object,default:()=>({availability:0,selection:0,ratio:0})},seasonId:{type:String,default:null},onboardingStep:{type:Number,default:0},onboardingPlayerId:{type:[String,null],default:null}},emits:["close","update","delete","refresh","advance-onboarding"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=k(!1),o=k(""),a=k(null),l=k(!1),c=k(!1),d=k(null),f=k(!1),g=k(!1),y=k(!1);function T(){s("close")}function A(){var I;o.value=((I=r.player)==null?void 0:I.name)||"",i.value=!0,fn(()=>{a.value&&a.value.focus()})}function P(){i.value=!1,o.value=""}async function U(){var w,C;if(!o.value.trim())return;if(await Ei((w=r.player)==null?void 0:w.id,r.seasonId)){To((C=r.player)==null?void 0:C.id)?q():(d.value="update",c.value=!0);return}q()}function q(){var I;s("update",{playerId:(I=r.player)==null?void 0:I.id,newName:o.value.trim()}),i.value=!1,o.value=""}async function M(){var w,C;if(await Ei((w=r.player)==null?void 0:w.id,r.seasonId)){To((C=r.player)==null?void 0:C.id)?z():(d.value="delete",c.value=!0);return}z()}function z(){var I;s("delete",(I=r.player)==null?void 0:I.id)}function he(){s("refresh")}function pe(I){d.value==="update"?q():d.value==="delete"&&z(),d.value=null}xt(()=>r.show,I=>{var w;I||(i.value=!1,o.value="",d.value=null,l.value=!1),I&&((w=r.player)!=null&&w.id)&&(Ei(r.player.id,r.seasonId).then(C=>{g.value=!!C}),Xt(()=>Promise.resolve().then(()=>mc),void 0).then(C=>{try{y.value=!!C.isPlayerPasswordCached(r.player.id)}catch{y.value=!1}}))}),e({openProtection(){l.value=!0}});const x=k({position:null});return xt(()=>r.show,I=>{I&&r.onboardingStep===4?fn(()=>{const w=document.querySelectorAll("button");let C=null;if(w.forEach(V=>{!C&&V.textContent&&V.textContent.includes("Protection")&&(C=V)}),C){const V=C.getBoundingClientRect();x.value.position={x:Math.round(V.right+8),y:Math.round(V.top+window.scrollY-4)}}}):I||(x.value.position=null)}),(I,w)=>{var C;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:T},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:w[5]||(w[5]=Ft(()=>{},["stop"]))},[h("div",eF,[h("button",{onClick:T,class:"absolute right-3 top-3 text-white/80 hover:text-white"},"✖️"),w[10]||(w[10]=h("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[h("span",{class:"text-2xl md:text-3xl"},"👤")],-1)),h("h2",tF,le((C=n.player)==null?void 0:C.name),1)]),h("div",nF,[h("div",null,[h("div",rF,[h("div",sF,[h("div",iF,le(r.stats.availability),1),w[11]||(w[11]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibilités",-1))]),h("div",oF,[h("div",aF,le(r.stats.selection),1),w[12]||(w[12]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Sélections",-1))]),h("div",lF,[h("div",uF,le(r.stats.ratio),1),w[13]||(w[13]=h("div",{class:"text-xs md:text-sm text-gray-300"},"% de sélection",-1))])])]),h("div",cF,[h("button",{onClick:A,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},w[14]||(w[14]=[h("span",null,"✏️",-1),h("span",null,"Renommer",-1)])),h("button",{onClick:w[0]||(w[0]=V=>l.value=!0),class:"px-5 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2"},[h("span",null,le(g.value?"🔓":"🔒"),1),h("span",null,le(g.value?"Déverrouiller":"Verrouiller"),1)]),h("button",{onClick:M,class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},w[15]||(w[15]=[h("span",null,"🗑️",-1),h("span",null,"Supprimer",-1)])),h("button",{onClick:T,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")]),f.value?(L(),F("div",dF,[h("button",{onClick:w[1]||(w[1]=V=>{A(),f.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"}," ✏️ Renommer "),h("button",{onClick:w[2]||(w[2]=V=>{M(),f.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"}," 🗑️ Supprimer ")])):ge("",!0)]),h("div",hF,[h("button",{onClick:w[3]||(w[3]=V=>l.value=!0),class:"h-12 px-4 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex-[1.4]"},le(g.value?"🔓 Déverrouiller":"🔒 Verrouiller"),1),h("button",{onClick:T,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"}," Fermer "),h("button",{onClick:w[4]||(w[4]=V=>f.value=!f.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"}," ⋯ ")])])])):ge("",!0),i.value?(L(),F("div",fF,[h("div",pF,[w[17]||(w[17]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Renommer le joueur",-1)),h("div",mF,[w[16]||(w[16]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),nt(h("input",{"onUpdate:modelValue":w[6]||(w[6]=V=>o.value=V),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Mn(P,["esc"]),Mn(U,["enter"])],ref_key:"editNameInput",ref:a},null,544),[[kt,o.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:P,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:U,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):ge("",!0),ct(XL,{show:l.value,player:n.player,seasonId:n.seasonId,onboarding:n.onboardingStep===4,onClose:w[7]||(w[7]=V=>l.value=!1),onUpdate:he,onOnboardingFinished:w[8]||(w[8]=V=>I.$emit("advance-onboarding",5))},null,8,["show","player","seasonId","onboarding"]),ct(Fg,{show:c.value,player:n.player,seasonId:n.seasonId,onClose:w[9]||(w[9]=V=>c.value=!1),onVerified:pe},null,8,["show","player","seasonId"])],64)}}},vF=ZL(gF,[["__scopeId","data-v-731bb3fb"]]),yF={class:"relative p-6 pb-4 border-b border-white/10"},_F={class:"sticky bottom-0 p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex justify-end"},bF={__name:"HowItWorksModal",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=e;return(r,s)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:s[3]||(s[3]=i=>t("close"))},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:s[2]||(s[2]=Ft(()=>{},["stop"]))},[h("div",yF,[h("button",{onClick:s[0]||(s[0]=i=>t("close")),title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),s[4]||(s[4]=h("div",{class:"flex items-center gap-3"},[h("div",{class:"w-12 h-12 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-2xl"},"❓"),h("div",null,[h("h2",{class:"text-xl md:text-2xl font-bold text-white"},"Comment fonctionne la sélection automatique ?"),h("p",{class:"text-sm text-blue-300"},"Tirage au sort pondéré pour favoriser l'équité")])],-1))]),s[5]||(s[5]=Jn('<div class="px-4 md:px-6 py-4 md:py-6 overflow-y-auto space-y-4 text-gray-200"><div class="bg-white/5 border border-white/10 rounded-lg p-4"><h3 class="text-white font-semibold mb-2">En bref</h3><p>On tire au sort uniquement parmi les joueurs <span class="text-green-300">disponibles</span>. Ceux qui ont <span class="text-purple-300">moins joué</span> ont plus de chances d&#39;être tirés. À long terme, tout le monde joue à peu près autant.</p></div><div class="space-y-3"><h3 class="text-white font-semibold">Détails du tirage</h3><ol class="list-decimal list-inside space-y-2 text-gray-300"><li><span class="text-white">Qui participe ?</span> Tous les joueurs marqués « ✅ Disponible » pour l’événement.</li><li><span class="text-white">Un coup de pouce aux moins joués</span> : si vous avez moins joué récemment, le tirage vous favorise un peu plus.</li><li><span class="text-white">Comment se fait le tirage ?</span> On tire un nom au hasard en tenant compte de cet avantage, on le met de côté, puis on recommence jusqu’à avoir assez de joueurs.</li><li><span class="text-white">Si on relance</span> : on garde les joueurs encore disponibles et on complète seulement les places manquantes.</li><li><span class="text-white">Indisponibles</span> : ils ne sont jamais tirés au sort.</li></ol></div><div class="space-y-2"><h3 class="text-white font-semibold">Estimation des chances</h3><p>L’application peut afficher un pourcentage indicatif pour aider à comprendre : si Alice a moins joué que Bob, elle aura un pourcentage plus élevé. C’est une indication, pas une promesse : deux tirages peuvent donner des résultats différents.</p></div><div class="space-y-2"><h3 class="text-white font-semibold">Pourquoi c’est juste</h3><ul class="list-disc list-inside space-y-1 text-gray-300"><li>Ceux qui ont moins joué ont automatiquement plus de chances.</li><li>Après une sélection, vos chances diminuent un peu pour laisser la place aux autres.</li><li>Sur la durée, les sélections s’<span class="text-green-300">équilibrent naturellement</span>.</li></ul></div><div class="space-y-2"><h3 class="text-white font-semibold">Exemples rapides</h3><p> • Alice n’a encore jamais été sélectionnée, Bob a été sélectionné une fois, Charlie plusieurs fois. Pour 1 place, on aura environ : Alice 57 %, Bob 29 %, Charlie 14 %.<br> • S’il y a 2 places, les chances de chacun augmentent, mais l’ordre reste aléatoire : un tirage peut donner Alice + Bob, un autre Alice + Charlie. </p></div><div class="text-xs text-gray-400"> Remarque : l’algorithme favorise l’équité à long terme, mais <span class="text-gray-300">n’assure pas</span> une rotation parfaite à chaque événement. </div></div>',1)),h("div",_F,[h("button",{onClick:s[1]||(s[1]=i=>t("close")),class:"h-10 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600"},"Compris")])])])):ge("",!0)}},wF={class:"relative text-center p-6 pb-4 border-b border-white/10"},IF={class:"text-2xl md:text-3xl font-bold text-white mb-1"},EF={class:"text-sm md:text-base text-purple-300"},TF={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},xF={class:"mb-3"},AF={class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-0"},SF={key:0,class:"flex items-center justify-between gap-2"},PF=["title"],RF={key:0,class:"text-purple-400 mr-2"},CF={key:1,class:"text-green-400 mr-2"},kF={key:2,class:"text-red-400 mr-2"},DF={key:3,class:"text-gray-400 mr-2"},NF=["onClick"],VF={key:1,class:"flex items-center justify-center"},OF=["onChange"],MF=["value"],LF=["onClick"],FF={key:0,class:"mb-3"},$F={class:"grid grid-cols-3 gap-2 md:gap-3 mb-3"},UF={class:"p-3 md:p-3 rounded-lg border border-yellow-500/30 bg-yellow-500/10 text-center"},jF={class:"text-yellow-300 text-lg md:text-xl font-semibold"},BF={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},qF={class:"text-green-400 text-lg md:text-xl font-semibold"},zF={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},KF={class:"text-purple-400 text-lg md:text-xl font-semibold"},GF={key:1,class:"mb-3"},HF={class:"flex items-center space-x-3 p-3 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20"},WF={class:"flex-1"},QF={class:"text-blue-300 text-sm font-medium"},JF={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},YF=["disabled","title"],XF=["disabled"],ZF=["disabled"],e4={__name:"SelectionModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},currentSelection:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},selectedCount:{type:Number,default:0},playerAvailability:{type:Object,default:()=>({})},seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},players:{type:Array,default:()=>[]}},emits:["close","selection","perfect","send-notifications","update-selection"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=k(!1),o=k("Copier le message"),a=k(!1),l=k(!1),c=k(""),d=k(!1),f=k(!1),g=Oe(()=>{var re;return((re=r.event)==null?void 0:re.playerCount)||6}),y=k([]),T=k(null),A=Oe(()=>Array.from({length:g.value},(ee,je)=>{var Xe;return((Xe=r.currentSelection)==null?void 0:Xe[je])||null})),P=Oe(()=>JSON.stringify(y.value)!==JSON.stringify(A.value)),U=Oe(()=>(r.players||[]).map(re=>re.name).filter(re=>{var ee;return((ee=r.playerAvailability)==null?void 0:ee[re])===!0}).sort((re,ee)=>re.localeCompare(ee,"fr",{sensitivity:"base"})));function q(re){const ee=new Set(y.value.filter(Boolean)),je=y.value[re];return je&&ee.delete(je),U.value.filter(Xe=>!ee.has(Xe))}function M(re){T.value=re}function z(){T.value=null}function he(re,ee){var Xe;const je=((Xe=re==null?void 0:re.target)==null?void 0:Xe.value)||"";je&&(y.value[ee]=je),T.value=null}function pe(re){y.value[re]=null}Oe(()=>(q(-1).length<g.value,""));const x=Oe(()=>r.currentSelection&&r.currentSelection.length>0),I=Oe(()=>{var Xe;if(!x.value)return!1;const re=r.currentSelection.some(ht=>!Y(ht)),ee=((Xe=r.event)==null?void 0:Xe.playerCount)||6,je=r.availableCount<ee;return re||je});Oe(()=>{var je;if(!I.value)return"";const re=r.currentSelection.filter(Xe=>!Y(Xe)),ee=((je=r.event)==null?void 0:je.playerCount)||6;return re.length>0?re.length===1?`${re[0]} n'est plus disponible. Veuillez relancer la sélection.`:`${re.length} joueurs ne sont plus disponibles. Veuillez relancer la sélection.`:r.availableCount<ee?`Seulement ${r.availableCount} joueurs disponibles pour ${ee} requis. Veuillez attendre plus de disponibilités ou ajuster le nombre de joueurs à sélectionner.`:"Sélection incomplète"}),Oe(()=>{if(!r.event||!x.value)return"";const re=w(r.event.date),ee=r.currentSelection.join(", ");return`Sélection pour ${r.event.title} du ${re} : ${ee}`}),xt(()=>r.show,re=>{if(re){i.value=!1,o.value="Copier le message",l.value=!1,c.value="",d.value=!1,a.value=!1;const ee=Array.isArray(r.currentSelection)?[...r.currentSelection]:[],je=g.value;y.value=Array.from({length:je},(Xe,ht)=>ee[ht]||null),T.value=null}}),xt([g,()=>r.currentSelection,()=>{var re;return(re=r.event)==null?void 0:re.id}],()=>{if(!r.show)return;const re=Array.isArray(r.currentSelection)?[...r.currentSelection]:[],ee=g.value,je=Array.from({length:ee},(Xe,ht)=>re[ht]||y.value[ht]||null);y.value=je.slice(0,ee)});function w(re){var je;return re?(typeof re=="string"?new Date(re):((je=re.toDate)==null?void 0:je.call(re))||re).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function C(){s("selection")}function V(){s("perfect")}function B(){var ee;if(!((ee=r.event)!=null&&ee.id))return;const re=y.value.filter(Boolean);s("update-selection",{eventId:r.event.id,players:re})}function R(){s("close")}function wt(){a.value=!0}function gt(){f.value=!0}function Y(re){return r.playerAvailability[re]===!0}function j(re){return r.playerAvailability[re]===!1}function ne(re){return r.currentSelection.includes(re)&&Y(re)}function Ke(re=!1,ee=!1){if(d.value=re,re){const je=w(r.event.date),Xe=r.currentSelection.join(", ");ee?c.value=`Sélection mise à jour pour ${r.event.title} du ${je} : ${Xe}`:c.value=`Nouvelle sélection pour ${r.event.title} du ${je} : ${Xe}`}else c.value="Sélection effectuée avec succès !";l.value=!0,setTimeout(()=>{l.value=!1},8e3)}function Be(){l.value=!1}e({showSuccess:Ke});function Ge(re){s("send-notifications",re)}return(re,ee)=>{var je,Xe,ht;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:R},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:ee[1]||(ee[1]=Ft(()=>{},["stop"]))},[h("div",wF,[h("button",{onClick:R,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),ee[5]||(ee[5]=h("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-3xl"},"🎭")],-1)),h("h2",IF,"Sélection pour "+le((je=n.event)==null?void 0:je.title),1),h("p",EF,le(w((Xe=n.event)==null?void 0:Xe.date)),1),h("div",{class:"mt-3"},[h("button",{onClick:gt,class:"inline-flex items-center gap-2 text-sm text-blue-300 hover:text-blue-200"},ee[4]||(ee[4]=[h("span",null,"❓",-1),Dt(),h("span",null,"Kezako ?",-1)]))])]),h("div",TF,[h("div",xF,[ee[8]||(ee[8]=h("h3",{class:"text-base md:text-lg font-semibold text-white mb-2"},"Joueurs sélectionnés",-1)),h("div",AF,[(L(!0),F(dt,null,wr(y.value,(D,$)=>(L(),F("div",{key:"sel-slot-"+$,class:Tt(["relative p-3 rounded-lg border text-center transition-colors",D?["bg-gradient-to-r",j(D)?"from-yellow-500/20 to-orange-500/20 border-yellow-500/30":Y(D)?"from-green-500/20 to-emerald-500/20 border-green-500/30":"from-red-500/20 to-red-600/20 border-red-500/30"]:"border-dashed border-white/20 hover:border-white/40 bg-white/5"])},[D?(L(),F("div",SF,[h("div",{class:"flex-1 text-white font-medium truncate",title:D},[ne(D)?(L(),F("span",RF,"🎭")):Y(D)?(L(),F("span",CF,"✅")):j(D)?(L(),F("span",kF,"❌")):(L(),F("span",DF,"–")),Dt(" "+le(D),1)],8,PF),h("button",{onClick:X=>pe($),class:"text-white/80 hover:text-white rounded-full hover:bg-white/10 px-2 py-1",title:"Retirer ce joueur"}," × ",8,NF)])):(L(),F("div",VF,[T.value===$?(L(),F("select",{key:0,class:"w-full bg-gray-800 text-white rounded-md p-2 border border-white/20 focus:outline-none",onChange:X=>he(X,$),onBlur:ee[0]||(ee[0]=X=>z())},[ee[6]||(ee[6]=h("option",{value:""},"— Choisir —",-1)),(L(!0),F(dt,null,wr(q($),X=>(L(),F("option",{key:X,value:X},le(X),9,MF))),128))],40,OF)):(L(),F("button",{key:1,onClick:X=>M($),class:"flex items-center gap-2 text-white/80 hover:text-white px-2 py-1 rounded-md hover:bg-white/10",title:"Ajouter un joueur"},ee[7]||(ee[7]=[h("span",{class:"text-lg"},"＋",-1),h("span",{class:"text-sm"},"Ajouter",-1)]),8,LF))]))],2))),128))])]),I.value?(L(),F("div",FF,ee[9]||(ee[9]=[h("div",{class:"flex items-center space-x-2 p-3 bg-yellow-500/10 rounded-lg border border-yellow-500/20"},[h("div",{class:"text-yellow-400"},"⚠️"),h("div",{class:"text-yellow-200 text-sm"},"Sélection incomplète. Vérifie ci-dessous.")],-1)]))):ge("",!0),h("div",$F,[h("div",UF,[h("div",jF,le(Math.max((((ht=n.event)==null?void 0:ht.playerCount)||6)-n.selectedCount,0)),1),ee[10]||(ee[10]=h("div",{class:"text-xs md:text-sm text-yellow-300"},"manquants",-1))]),h("div",BF,[h("div",qF,le(n.availableCount),1),ee[11]||(ee[11]=h("div",{class:"text-xs md:text-sm text-gray-400"},"Disponibles",-1))]),h("div",zF,[h("div",KF,le(n.selectedCount),1),ee[12]||(ee[12]=h("div",{class:"text-xs md:text-sm text-gray-400"},"Sélectionnés",-1))])]),l.value?(L(),F("div",GF,[h("div",HF,[ee[14]||(ee[14]=h("div",{class:"text-blue-400 text-xl"},"✨",-1)),h("div",WF,[h("p",QF,le(c.value),1)]),h("button",{onClick:Be,class:"text-blue-400 hover:text-blue-300 transition-colors",title:"Fermer le message"},ee[13]||(ee[13]=[h("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):ge("",!0)]),h("div",JF,[h("button",{onClick:C,disabled:n.availableCount===0,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex-1 whitespace-nowrap",title:n.availableCount===0?"Aucun joueur disponible":x.value?"Relancer la sélection automatique":"Lancer la sélection automatique"},ee[15]||(ee[15]=[Dt(" ✨ "),h("span",{class:"hidden sm:inline"},"Sélection Auto",-1),h("span",{class:"sm:hidden"},"Auto",-1)]),8,YF),h("button",{onClick:B,disabled:!P.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",title:"Enregistrer cette composition manuelle"},ee[16]||(ee[16]=[Dt(" 💾 "),h("span",{class:"hidden sm:inline"},"Enregistrer",-1),h("span",{class:"sm:hidden"},"Save",-1)]),8,XF),h("button",{onClick:wt,disabled:!x.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed"},ee[17]||(ee[17]=[Dt(" 📣 "),h("span",{class:"hidden sm:inline"},"Annoncer",-1)]),8,ZF),x.value?(L(),F("button",{key:0,onClick:V,class:"h-12 px-3 md:px-4 bg-gray-700 text-white rounded-lg flex-1 whitespace-nowrap"},ee[18]||(ee[18]=[Dt(" 👍 "),h("span",{class:"hidden sm:inline"},"Fermer",-1)]))):ge("",!0)])])])):ge("",!0),ct(TT,{show:a.value,event:n.event,"season-id":n.seasonId,"season-slug":n.seasonSlug,players:n.players,mode:"selection","selected-players":n.currentSelection,onClose:ee[2]||(ee[2]=D=>a.value=!1),onSendNotifications:Ge},null,8,["show","event","season-id","season-slug","players","selected-players"]),ct(bF,{show:f.value,onClose:ee[3]||(ee[3]=D=>f.value=!1)},null,8,["show"])],64)}}},t4={class:"flex items-center justify-center gap-2"},n4=["title"],r4=["title"],s4=["title"],i4=["title"],o4=["title"],Z_={__name:"AvailabilityCell",props:{playerName:{type:String,required:!0},compact:{type:Boolean,default:!1},eventId:{type:String,required:!0},isAvailable:{type:Boolean,default:null},isSelected:{type:Boolean,default:!1},chancePercent:{type:Number,default:null},showSelectedChance:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(n,{emit:e}){const t=n,r=e,s=k(!1),i=Oe(()=>!(t.chancePercent==null||t.isAvailable!==!0||t.isSelected&&!t.showSelectedChance)),o=Oe(()=>t.disabled?"Événement archivé — désarchivez pour modifier":t.isSelected&&t.isAvailable===!0?i.value?`${t.playerName} est sélectionné pour cet événement • avait ~${t.chancePercent}% de chances`:`${t.playerName} est sélectionné pour cet événement`:t.isAvailable===!0?t.chancePercent!=null?`${t.playerName} est disponible • ~${t.chancePercent}% de chances d'être sélectionné`:`${t.playerName} est disponible`:t.isAvailable===!1?`${t.playerName} n'est pas disponible`:`Cliquer pour indiquer la disponibilité de ${t.playerName}`);function a(){t.disabled||r("toggle",t.playerName,t.eventId)}return(l,c)=>(L(),F("div",{class:Tt(["flex items-center justify-center transition-all duration-200",[n.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-white/10",n.compact?"min-h-0 p-1 md:p-2":"min-h-20 p-3 md:p-5"]]),onClick:a,onMouseenter:c[0]||(c[0]=d=>s.value=!0),onMouseleave:c[1]||(c[1]=d=>s.value=!1)},[h("div",t4,[i.value&&s.value?(L(),F("span",{key:0,class:"text-[11px] md:text-xs px-2 py-0.5 rounded-full bg-emerald-500/15 border border-emerald-400/40 text-emerald-200",title:o.value},le(n.chancePercent)+"% ",9,n4)):(L(),F(dt,{key:1},[n.isSelected&&n.isAvailable===!0?(L(),F("span",{key:0,class:Tt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value}," 🎭 ",10,r4)):n.isAvailable===!0?(L(),F("span",{key:1,class:Tt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value}," ✅ ",10,s4)):n.isAvailable===!1?(L(),F("span",{key:2,class:Tt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value}," ❌ ",10,i4)):(L(),F("span",{key:3,class:Tt(["text-gray-500 transition-colors duration-200",[n.compact?"text-base md:text-lg":"text-xl md:text-2xl",n.disabled?"":"hover:text-white"]]),title:o.value}," – ",10,o4))],64))])],34))}},a4={key:0,class:"fixed inset-0 z-[130] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4"},l4={class:"w-full max-w-xl bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl text-center"},u4={class:"text-2xl md:text-3xl font-bold text-white mb-3"},c4={class:"text-gray-300 mb-6"},d4={class:"flex flex-col items-stretch justify-center gap-3"},h4=["value"],f4={__name:"CreatorOnboardingModal",props:{seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},playersCount:{type:Number,default:0},eventsCount:{type:Number,default:0},onboardingDone:{type:Boolean,default:!1}},emits:["create-event","add-player","copy-link","dismissed"],setup(n,{emit:e}){const t=n,r=e,s=window.location.origin,i=Oe(()=>`${s}/season/${t.seasonSlug}`),o=k(!1);try{t.seasonId&&(o.value=!!localStorage.getItem(`dismissCreatorOnboarding:${t.seasonId}`))}catch{}const a=Oe(()=>t.onboardingDone?0:t.eventsCount===0&&t.playersCount===0?1:t.eventsCount>0&&t.playersCount===0?2:t.eventsCount>0&&t.playersCount>0&&!o.value?3:0),l=Oe(()=>a.value>0),c=k(l.value);xt(a,P=>{c.value=P>0});const d=Oe(()=>{switch(a.value){case 1:return"Commençons par créer votre premier événement";case 2:return"Super ! Ajoutez votre premier joueur";case 3:return"Vous y êtes presque! Maintenant, invitez vos joueurs.";default:return""}}),f=Oe(()=>{switch(a.value){case 1:return"Un titre, une date... et c’est parti.";case 2:return"Ajoutez au moins un joueur pour commencer à saisir des disponibilités.";case 3:return"Laissez vos membres s’inscrire eux-même et indiquer leurs disponibilités en leur envoyant le lien direct.";default:return""}});function g(){c.value=!1,r("create-event")}function y(){c.value=!1,r("add-player")}function T(){var P;try{(P=navigator.clipboard)==null||P.writeText(i.value)}catch{}r("copy-link")}async function A(){try{if(t.seasonId){const{db:P}=await Xt(()=>Promise.resolve().then(()=>wi),void 0),{doc:U,updateDoc:q}=await Xt(()=>import("./index.esm-224d04fa.js"),[]);await q(U(P,"seasons",t.seasonId),{onboardingCreatorDone:!0})}else localStorage.setItem("dismissCreatorOnboarding","1")}catch{}o.value=!0,c.value=!1,r("dismissed")}return(P,U)=>l.value&&c.value?(L(),F("div",a4,[h("div",l4,[U[1]||(U[1]=h("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[h("span",{class:"text-3xl"},"🎬")],-1)),h("h2",u4,le(d.value),1),h("p",c4,le(f.value),1),h("div",d4,[a.value===1?(L(),F("button",{key:0,onClick:g,class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all"}," ✨ Créer un événement ")):a.value===2?(L(),F("button",{key:1,onClick:y,class:"px-5 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all"}," 👤 Ajouter un joueur ")):a.value===3?(L(),F(dt,{key:2},[h("input",{value:i.value,type:"text",readonly:"",class:"w-full px-3 py-2 bg-gray-800 border border-white/20 rounded-lg text-white text-sm select-all",onFocus:U[0]||(U[0]=q=>q.target.select())},null,40,h4),h("div",{class:"flex gap-3 justify-center"},[h("button",{onClick:T,class:"px-5 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-all"}," 🔗 Copier le lien "),h("button",{onClick:A,class:"px-5 py-3 bg-transparent text-gray-300 border border-white/20 rounded-lg hover:bg-white/10 transition-all"}," J’ai compris ")])],64)):ge("",!0)])])])):ge("",!0)}},ST="@firebase/installations",$g="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT=1e4,RT=`w:${$g}`,CT="FIS_v2",p4="https://firebaseinstallations.googleapis.com/v1",m4=60*60*1e3,g4="installations",v4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Oo=new Lo(g4,v4,y4);function kT(n){return n instanceof os&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT({projectId:n}){return`${p4}/projects/${n}/installations`}function NT(n){return{token:n.token,requestStatus:2,expiresIn:b4(n.expiresIn),creationTime:Date.now()}}async function VT(n,e){const r=(await e.json()).error;return Oo.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function OT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function _4(n,{refreshToken:e}){const t=OT(n);return t.append("Authorization",w4(e)),t}async function MT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function b4(n){return Number(n.replace("s","000"))}function w4(n){return`${CT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I4({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=DT(n),s=OT(n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:t,authVersion:CT,appId:n.appId,sdkVersion:RT},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await MT(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:NT(c.authToken)}}else throw await VT("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E4(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=/^[cdef][\w-]{21}$/,Bp="";function x4(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=A4(n);return T4.test(t)?t:Bp}catch{return Bp}}function A4(n){return E4(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=new Map;function $T(n,e){const t=Yh(n);UT(t,e),S4(t,e)}function UT(n,e){const t=FT.get(n);if(t)for(const r of t)r(e)}function S4(n,e){const t=P4();t&&t.postMessage({key:n,fid:e}),R4()}let _o=null;function P4(){return!_o&&"BroadcastChannel"in self&&(_o=new BroadcastChannel("[Firebase] FID Change"),_o.onmessage=n=>{UT(n.data.key,n.data.fid)}),_o}function R4(){FT.size===0&&_o&&(_o.close(),_o=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="firebase-installations-database",k4=1,Mo="firebase-installations-store";let jf=null;function Ug(){return jf||(jf=ph(C4,k4,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Mo)}}})),jf}async function Zd(n,e){const t=Yh(n),s=(await Ug()).transaction(Mo,"readwrite"),i=s.objectStore(Mo),o=await i.get(t);return await i.put(e,t),await s.done,(!o||o.fid!==e.fid)&&$T(n,e.fid),e}async function jT(n){const e=Yh(n),r=(await Ug()).transaction(Mo,"readwrite");await r.objectStore(Mo).delete(e),await r.done}async function Xh(n,e){const t=Yh(n),s=(await Ug()).transaction(Mo,"readwrite"),i=s.objectStore(Mo),o=await i.get(t),a=e(o);return a===void 0?await i.delete(t):await i.put(a,t),await s.done,a&&(!o||o.fid!==a.fid)&&$T(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jg(n){let e;const t=await Xh(n.appConfig,r=>{const s=D4(r),i=N4(n,s);return e=i.registrationPromise,i.installationEntry});return t.fid===Bp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function D4(n){const e=n||{fid:x4(),registrationStatus:0};return BT(e)}function N4(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Oo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=V4(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:O4(n)}:{installationEntry:e}}async function V4(n,e){try{const t=await I4(n,e);return Zd(n.appConfig,t)}catch(t){throw kT(t)&&t.customData.serverCode===409?await jT(n.appConfig):await Zd(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function O4(n){let e=await e0(n.appConfig);for(;e.registrationStatus===1;)await LT(100),e=await e0(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await jg(n);return r||t}return e}function e0(n){return Xh(n,e=>{if(!e)throw Oo.create("installation-not-found");return BT(e)})}function BT(n){return M4(n)?{fid:n.fid,registrationStatus:0}:n}function M4(n){return n.registrationStatus===1&&n.registrationTime+PT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4({appConfig:n,heartbeatServiceProvider:e},t){const r=F4(n,t),s=_4(n,t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:RT,appId:n.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await MT(()=>fetch(r,a));if(l.ok){const c=await l.json();return NT(c)}else throw await VT("Generate Auth Token",l)}function F4(n,{fid:e}){return`${DT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bg(n,e=!1){let t;const r=await Xh(n.appConfig,i=>{if(!qT(i))throw Oo.create("not-registered");const o=i.authToken;if(!e&&j4(o))return i;if(o.requestStatus===1)return t=$4(n,e),i;{if(!navigator.onLine)throw Oo.create("app-offline");const a=q4(i);return t=U4(n,a),a}});return t?await t:r.authToken}async function $4(n,e){let t=await t0(n.appConfig);for(;t.authToken.requestStatus===1;)await LT(100),t=await t0(n.appConfig);const r=t.authToken;return r.requestStatus===0?Bg(n,e):r}function t0(n){return Xh(n,e=>{if(!qT(e))throw Oo.create("not-registered");const t=e.authToken;return z4(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function U4(n,e){try{const t=await L4(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await Zd(n.appConfig,r),t}catch(t){if(kT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await jT(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Zd(n.appConfig,r)}throw t}}function qT(n){return n!==void 0&&n.registrationStatus===2}function j4(n){return n.requestStatus===2&&!B4(n)}function B4(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+m4}function q4(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function z4(n){return n.requestStatus===1&&n.requestTime+PT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4(n){const e=n,{installationEntry:t,registrationPromise:r}=await jg(e);return r?r.catch(console.error):Bg(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G4(n,e=!1){const t=n;return await H4(t),(await Bg(t,e)).token}async function H4(n){const{registrationPromise:e}=await jg(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W4(n){if(!n||!n.options)throw Bf("App Configuration");if(!n.name)throw Bf("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Bf(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Bf(n){return Oo.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="installations",Q4="installations-internal",J4=n=>{const e=n.getProvider("app").getImmediate(),t=W4(e),r=Mi(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Y4=n=>{const e=n.getProvider("app").getImmediate(),t=Mi(e,zT).getImmediate();return{getId:()=>K4(t),getToken:s=>G4(t,s)}};function X4(){ss(new $r(zT,J4,"PUBLIC")),ss(new $r(Q4,Y4,"PRIVATE"))}X4();Er(ST,$g);Er(ST,$g,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4="/firebase-messaging-sw.js",e3="/firebase-cloud-messaging-push-scope",KT="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",t3="https://fcmregistrations.googleapis.com/v1",GT="google.c.a.c_id",n3="google.c.a.c_l",r3="google.c.a.ts",s3="google.c.a.e";var n0;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(n0||(n0={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Bu;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(Bu||(Bu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function i3(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf="fcm_token_details_db",o3=5,r0="fcm_token_object_Store";async function a3(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(qf))return null;let e=null;return(await ph(qf,o3,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(r0))return;const l=o.objectStore(r0),c=await l.index("fcmSenderId").get(n);if(await l.clear(),!!c){if(s===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:vs(d.vapidKey)}}}else if(s===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:vs(d.auth),p256dh:vs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:vs(d.vapidKey)}}}else if(s===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:vs(d.auth),p256dh:vs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:vs(d.vapidKey)}}}}}})).close(),await Af(qf),await Af("fcm_vapid_details_db"),await Af("undefined"),l3(e)?e:null}function l3(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3="firebase-messaging-database",c3=1,qu="firebase-messaging-store";let zf=null;function HT(){return zf||(zf=ph(u3,c3,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(qu)}}})),zf}async function d3(n){const e=WT(n),r=await(await HT()).transaction(qu).objectStore(qu).get(e);if(r)return r;{const s=await a3(n.appConfig.senderId);if(s)return await qg(n,s),s}}async function qg(n,e){const t=WT(n),s=(await HT()).transaction(qu,"readwrite");return await s.objectStore(qu).put(e,t),await s.done,e}function WT({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Zn=new Lo("messaging","Messaging",h3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f3(n,e){const t=await Kg(n),r=QT(e),s={method:"POST",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(zg(n.appConfig),s)).json()}catch(o){throw Zn.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Zn.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw Zn.create("token-subscribe-no-token");return i.token}async function p3(n,e){const t=await Kg(n),r=QT(e.subscriptionOptions),s={method:"PATCH",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${zg(n.appConfig)}/${e.token}`,s)).json()}catch(o){throw Zn.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Zn.create("token-update-failed",{errorInfo:o})}if(!i.token)throw Zn.create("token-update-no-token");return i.token}async function m3(n,e){const r={method:"DELETE",headers:await Kg(n)};try{const i=await(await fetch(`${zg(n.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw Zn.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw Zn.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function zg({projectId:n}){return`${t3}/projects/${n}/registrations`}async function Kg({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function QT({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const s={web:{endpoint:t,auth:e,p256dh:n}};return r!==KT&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3=7*24*60*60*1e3;async function v3(n){const e=await _3(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:vs(e.getKey("auth")),p256dh:vs(e.getKey("p256dh"))},r=await d3(n.firebaseDependencies);if(r){if(b3(r.subscriptionOptions,t))return Date.now()>=r.createTime+g3?y3(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await m3(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return s0(n.firebaseDependencies,t)}else return s0(n.firebaseDependencies,t)}async function y3(n,e){try{const t=await p3(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return await qg(n.firebaseDependencies,r),t}catch(t){throw t}}async function s0(n,e){const r={token:await f3(n,e),createTime:Date.now(),subscriptionOptions:e};return await qg(n,r),r.token}async function _3(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i3(e)})}function b3(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,s=e.auth===n.auth,i=e.p256dh===n.p256dh;return t&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return w3(e,n),I3(e,n),E3(e,n),e}function w3(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const s=e.notification.image;s&&(n.notification.image=s);const i=e.notification.icon;i&&(n.notification.icon=i)}function I3(n,e){e.data&&(n.data=e.data)}function E3(n,e){var t,r,s,i,o;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(n.fcmOptions.link=a);const l=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;l&&(n.fcmOptions.analyticsLabel=l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(n){return typeof n=="object"&&!!n&&GT in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */x3("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function x3(n,e){const t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A3(n){if(!n||!n.options)throw Kf("App Configuration Object");if(!n.name)throw Kf("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw Kf(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Kf(n){return Zn.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=A3(e);this.firebaseDependencies={app:e,appConfig:s,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P3(n){try{n.swRegistration=await navigator.serviceWorker.register(Z4,{scope:e3}),n.swRegistration.update().catch(()=>{})}catch(e){throw Zn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R3(n,e){if(!e&&!n.swRegistration&&await P3(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Zn.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C3(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=KT)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JT(n,e){if(!navigator)throw Zn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Zn.create("permission-blocked");return await C3(n,e==null?void 0:e.vapidKey),await R3(n,e==null?void 0:e.serviceWorkerRegistration),v3(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k3(n,e,t){const r=D3(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[GT],message_name:t[n3],message_time:t[r3],message_device_time:Math.floor(Date.now()/1e3)})}function D3(n){switch(n){case Bu.NOTIFICATION_CLICKED:return"notification_open";case Bu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N3(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===Bu.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(i0(t)):n.onMessageHandler.next(i0(t)));const r=t.data;T3(r)&&r[s3]==="1"&&await k3(n,t.messageType,r)}const o0="@firebase/messaging",a0="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3=n=>{const e=new S3(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>N3(e,t)),e},O3=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>JT(e,r)}};function M3(){ss(new $r("messaging",V3,"PUBLIC")),ss(new $r("messaging-internal",O3,"PRIVATE")),Er(o0,a0),Er(o0,a0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YT(){try{await Mb()}catch{return!1}return typeof window<"u"&&cm()&&X1()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L3(n=fm()){return YT().then(e=>{if(!e)throw Zn.create("unsupported-browser")},e=>{throw Zn.create("indexed-db-unsupported")}),Mi(Ne(n),"messaging").getImmediate()}async function F3(n,e){return n=Ne(n),JT(n,e)}M3();const l0="BCp_LGds4qlhPqneNocMDmN2dv6iF11IVY3ZfS-3PxrkVbLzPR_Sm3v8aiiNzKhOSRFM_BpncKbxum9M333w-N8";async function XT(){try{return await YT()}catch{return!1}}async function $3(){if(typeof navigator>"u"||!navigator.serviceWorker)return null;const n=await navigator.serviceWorker.ready;if(n!=null&&n.active&&n.active.state==="activated")return n;const e=(n==null?void 0:n.installing)||(n==null?void 0:n.waiting);return!e||e.state==="activated"||await new Promise(t=>{const r=()=>{e.state==="activated"&&(e.removeEventListener("statechange",r),t())};e.addEventListener("statechange",r)}),n}async function U3(n){var i;if(!await XT()||await Notification.requestPermission()!=="granted")return null;const t=L3(Hh);let r=n||await $3();const s=await F3(t,r?{vapidKey:l0,serviceWorkerRegistration:r}:{vapidKey:l0});try{const o=((i=Nt==null?void 0:Nt.currentUser)==null?void 0:i.email)||"anonymous";o&&s&&await mn(Se(ue,"userPushTokens",o),{tokens:WD(s),lastToken:s,email:o,updatedAt:Bi(),userAgent:navigator.userAgent},{merge:!0})}catch{}return s}const j3={class:"flex justify-center gap-2 mb-4"},B3={class:"space-y-3"},q3={key:0},z3={key:0,class:"text-sm text-gray-400"},K3={key:1,class:"space-y-2"},G3={class:"flex items-center justify-between gap-3"},H3={class:"truncate"},W3={class:"text-white font-semibold"},Q3={class:"text-gray-400 text-xs"},J3=["onClick"],Y3={key:1,class:"text-sm text-gray-300 space-y-3"},X3={class:"p-3 rounded-lg border border-white/10 bg-white/5 space-y-3"},Z3={class:"flex items-center justify-between"},e$={class:"flex items-center gap-2"},t$={class:"flex items-center justify-between"},n$={class:"flex items-center gap-2"},r$={class:"p-3 rounded-lg border border-white/10 bg-white/5 space-y-3"},s$={class:"flex items-center justify-between"},i$={class:"flex items-center gap-2"},o$={class:"flex items-center justify-between"},a$={class:"flex items-center gap-2"},l$={class:"flex items-center justify-between pt-2 border-t border-white/10"},u$=["disabled"],c$={key:1,class:"inline-flex items-center text-xs text-gray-300"},d$={class:"flex items-center justify-between pt-2"},h$=["disabled"],f$={key:0,class:"text-xs text-green-300"},p$={key:1,class:"text-xs text-red-300"},m$={key:2,class:"text-[10px] text-gray-400 break-all"},g$={class:"text-[10px] text-gray-500"},v$={class:"text-right"},y$=["disabled"],_$={key:0,class:"text-xs text-red-300"},b$={key:1,class:"text-xs text-green-300"},w$={key:2,class:"flex flex-col gap-3"},I$={class:"p-3 rounded-lg border border-white/10 bg-white/5 text-sm text-gray-300"},E$={class:"flex items-center gap-2"},T$=["disabled"],x$={key:0,class:"mt-2 text-xs text-red-300"},A$={key:1,class:"mt-2 text-xs text-green-300"},S$={__name:"AccountMenu",props:{show:{type:Boolean,default:!1},seasonId:{type:String,default:null}},emits:["close","manage-player","change-password","logout-device","delete-account"],setup(n,{emit:e}){const t=n,r=e,s=k(""),i=k([]),o=k("players");function a(Y){return["px-4 py-2 rounded-full text-sm transition-colors",o.value===Y?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10"]}function l(Y){return`${Y.seasonId||"global"}__${Y.playerId}`}async function c(){var Y;try{s.value=((Y=Nt==null?void 0:Nt.currentUser)==null?void 0:Y.email)||""}catch{}try{const j=s.value?await Lg(s.value):[],ne=[];for(const Ke of j){let Be=Ke.playerId;try{if(Ke.seasonId){const Ge=Se(ue,"seasons",Ke.seasonId,"players",Ke.playerId),re=await Qt(Ge);re.exists()&&(Be=re.data().name||Be)}}catch{}ne.push({...Ke,playerName:Be})}i.value=ne}catch{i.value=[]}}function d(){r("close")}xt(()=>t.show,Y=>{Y&&(c(),B())}),ir(()=>{t.show&&(c(),B())});const f=k(""),g=k(!1),y=k(""),T=k(""),A=k(!1);xt(s,Y=>{f.value=Y||""}),xt(f,Y=>{A.value=!!Y&&Y.includes("@")&&Y!==s.value});async function P(){if(A.value){g.value=!0,y.value="",T.value="";try{const Y=await cT({currentEmail:s.value,newEmail:f.value.trim()});await ET({toEmail:f.value.trim(),verifyUrl:Y.url,purpose:"account_email_update",displayName:"utilisateur"}),T.value=`Un email de vérification a été envoyé à ${f.value.trim()}. Cliquez sur le lien pour confirmer le changement.`}catch(Y){y.value=(Y==null?void 0:Y.code)==="auth/requires-recent-login"?"Veuillez vous reconnecter pour modifier votre email":"Impossible de mettre à jour l'email"}finally{g.value=!1}}}const U=k({notifyAvailability:!0,notifySelection:!0,notifySelectionPush:!0,notifyAvailabilityPush:!0}),q=k(!1),M=k(""),z=k(""),he=k(!1),pe=k(""),x=k(""),I=k(!1),w=k(localStorage.getItem("fcmToken")||""),C=k(!1),V=function(j){try{return j?j.length>20?j.slice(0,8)+"…"+j.slice(-6):j:""}catch{return""}}("BCp_LGds4qlhPqneNocMDmN2dv6iF11IVY3ZfS-3PxrkVbLzPR_Sm3v8aiiNzKhOSRFM_BpncKbxum9M333w-N8");async function B(){try{if(!s.value)return;const Y=Se(ue,"userPreferences",s.value),j=await Qt(Y);if(j.exists()){const ne=j.data()||{};U.value.notifyAvailability=ne.notifyAvailability!==!1,U.value.notifySelection=ne.notifySelection!==!1,U.value.notifySelectionPush=ne.notifySelectionPush!==!1,U.value.notifyAvailabilityPush=ne.notifyAvailabilityPush!==!1}else U.value={notifyAvailability:!0,notifySelection:!0,notifySelectionPush:!0,notifyAvailabilityPush:!0}}catch{}}async function R(){if(s.value){he.value=!0,x.value="",pe.value="";try{await gc({toEmail:s.value,title:"Test Impro Selector",body:"Ceci est un test de notification",data:{url:"/"},reason:"manual_test"}),pe.value="OK"}catch{x.value="Échec de l'envoi du test"}finally{he.value=!1}}}async function wt(){try{if(I.value=!0,!await XT()){x.value="Push non supporté sur cet appareil";return}const j=window.__swReg,ne=await U3(j);if(ne){w.value=ne;try{localStorage.setItem("fcmToken",ne)}catch{}C.value=!0}}catch(Y){const j=typeof Notification<"u"?Notification.permission:"unknown",ne=Y&&(Y.message||Y.code)?` (${Y.message||Y.code})`:"";x.value=`Activation impossible – permission: ${j}${ne}`}finally{I.value=!1}}ir(()=>{try{C.value=typeof Notification<"u"&&Notification.permission==="granted"&&!!localStorage.getItem("fcmToken")}catch{C.value=!1}});async function gt(){if(s.value){q.value=!0,M.value="",z.value="";try{const Y=Se(ue,"userPreferences",s.value);await mn(Y,{...U.value},{merge:!0}),z.value="Préférences sauvegardées"}catch{M.value="Impossible de sauvegarder vos préférences"}finally{q.value=!1}}}return(Y,j)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[150] p-4",onClick:d},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-xl",onClick:j[11]||(j[11]=Ft(()=>{},["stop"]))},[h("button",{onClick:d,class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},"✖️"),j[25]||(j[25]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-indigo-400 to-cyan-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">👤</span></div><h2 class="text-2xl font-bold text-white mb-1">Mon compte</h2><p class="text-sm text-gray-300">Gérez votre compte et vos préférences</p></div>',1)),h("div",j3,[h("button",{onClick:j[0]||(j[0]=ne=>o.value="manage"),class:Tt(a("manage"))},"Gérer",2),h("button",{onClick:j[1]||(j[1]=ne=>o.value="notifications"),class:Tt(a("notifications"))},"Notifications",2),h("button",{onClick:j[2]||(j[2]=ne=>o.value="players"),class:Tt(a("players"))},"Joueurs",2)]),h("div",B3,[o.value==="players"?(L(),F("div",q3,[j[12]||(j[12]=h("h3",{class:"text-white font-semibold mb-2"},"Mes joueurs associés",-1)),i.value.length===0?(L(),F("div",z3,"Aucun joueur associé pour le moment.")):(L(),F("ul",K3,[(L(!0),F(dt,null,wr(i.value,ne=>(L(),F("li",{key:l(ne),class:"p-3 rounded-lg border border-white/10 bg-white/5 text-sm text-gray-300"},[h("div",G3,[h("div",H3,[h("div",W3,le(ne.seasonName||ne.seasonId||"—"),1),h("div",Q3,"Joueur : "+le(ne.playerName||"—"),1)]),h("button",{onClick:Ke=>Y.$emit("manage-player",ne),class:"px-3 py-2 rounded-lg bg-gray-700 text-white hover:bg-gray-600 text-xs"},"Gérer",8,J3)])]))),128))]))])):o.value==="notifications"?(L(),F("div",Y3,[h("div",X3,[j[15]||(j[15]=h("div",{class:"text-white font-semibold text-sm mb-1"},"Emails",-1)),h("div",Z3,[h("label",e$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[3]||(j[3]=ne=>U.value.notifyAvailability=ne),class:"w-4 h-4"},null,512),[[vi,U.value.notifyAvailability]]),j[13]||(j[13]=h("span",null,"M'envoyer un email lorsqu'un événement a besoin de joueurs",-1))])]),h("div",t$,[h("label",n$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[4]||(j[4]=ne=>U.value.notifySelection=ne),class:"w-4 h-4"},null,512),[[vi,U.value.notifySelection]]),j[14]||(j[14]=h("span",null,"M'envoyer un email lorsque je suis concerné par une sélection",-1))])])]),h("div",r$,[j[21]||(j[21]=h("div",{class:"text-white font-semibold text-sm mb-1"},"Push (expérimental)",-1)),j[22]||(j[22]=h("div",{class:"text-xs text-emerald-200 mb-1"},"Fonctionnalité en test: activable uniquement ici.",-1)),h("div",s$,[h("label",i$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[5]||(j[5]=ne=>U.value.notifySelectionPush=ne),class:"w-4 h-4"},null,512),[[vi,U.value.notifySelectionPush]]),j[16]||(j[16]=h("span",null,"Me notifier lorsque je suis concerné par une sélection",-1))])]),h("div",o$,[h("label",a$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[6]||(j[6]=ne=>U.value.notifyAvailabilityPush=ne),class:"w-4 h-4"},null,512),[[vi,U.value.notifyAvailabilityPush]]),j[17]||(j[17]=h("span",null,"Me notifier lorsqu'un événement a besoin de joueurs",-1))])]),h("div",l$,[j[19]||(j[19]=h("div",{class:"text-xs text-gray-400"},"Notifications sur cet appareil",-1)),C.value?(L(),F("span",c$,j[18]||(j[18]=[h("span",{class:"mr-1 text-emerald-400"},"✓",-1),Dt(" Actif ")]))):(L(),F("button",{key:0,onClick:wt,disabled:I.value,class:"px-3 py-1 rounded bg-emerald-600 text-white text-xs hover:bg-emerald-500 disabled:opacity-50"},le(I.value?"...":"Activer"),9,u$))]),h("div",d$,[j[20]||(j[20]=h("div",{class:"text-xs text-gray-400"},"Test de notification push",-1)),h("button",{onClick:R,disabled:he.value||!s.value,class:"px-3 py-1 rounded bg-emerald-600 text-white text-xs hover:bg-emerald-500 disabled:opacity-50"},le(he.value?"Envoi…":"Envoyer un test"),9,h$)]),pe.value?(L(),F("div",f$,"Notification test envoyée (vérifiez votre appareil)")):ge("",!0),x.value?(L(),F("div",p$,le(x.value),1)):ge("",!0),w.value?(L(),F("div",m$,"FCM token: "+le(w.value),1)):ge("",!0),h("div",g$,"VAPID: "+le(Xr(V)||"indisponible"),1)]),h("div",v$,[h("button",{onClick:gt,disabled:q.value,class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-500 disabled:opacity-50"},le(q.value?"⏳":"Sauvegarder"),9,y$)]),M.value?(L(),F("div",_$,le(M.value),1)):ge("",!0),z.value?(L(),F("div",b$,le(z.value),1)):ge("",!0)])):(L(),F("div",w$,[h("div",I$,[j[23]||(j[23]=h("label",{class:"block text-xs text-gray-400 mb-2"},"Email",-1)),h("div",E$,[nt(h("input",{"onUpdate:modelValue":j[7]||(j[7]=ne=>f.value=ne),type:"email",class:"flex-1 p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"nouvel@email.com"},null,512),[[kt,f.value]]),h("button",{onClick:P,disabled:!A.value||g.value,class:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},le(g.value?"⏳":"Mettre à jour"),9,T$)]),y.value?(L(),F("div",x$,le(y.value),1)):ge("",!0),T.value?(L(),F("div",A$,le(T.value),1)):ge("",!0)]),j[24]||(j[24]=h("div",{class:"text-sm text-gray-400"},"Vous pouvez changer votre mot de passe pour sécuriser vos opérations sensibles.",-1)),h("button",{onClick:j[8]||(j[8]=ne=>Y.$emit("change-password")),class:"w-full px-4 py-3 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500"},"Changer de mot de passe"),h("button",{onClick:j[9]||(j[9]=ne=>Y.$emit("logout-device")),class:"w-full px-4 py-3 rounded-lg bg-gray-700 text-white hover:bg-gray-600"},"Déconnexion de cet appareil"),h("button",{onClick:j[10]||(j[10]=ne=>Y.$emit("delete-account")),class:"w-full px-4 py-3 rounded-lg bg-red-600 text-white hover:bg-red-500"},"Supprimer mon compte")]))]),h("div",{class:"mt-6 text-center"},[h("button",{onClick:d,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800"},"Fermer")])])])):ge("",!0)}},P$={class:"space-y-4"},R$={class:"flex items-center justify-between"},C$={class:"flex items-center gap-2 text-gray-300 text-sm"},k$={key:0,class:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm"},D$={key:1,class:"p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm"},N$={class:"flex justify-center gap-3 mt-2"},V$=["disabled"],O$={key:0,class:"animate-spin"},M$={key:1},L$={__name:"AccountLoginModal",props:{show:{type:Boolean,default:!1}},emits:["close","success"],setup(n,{emit:e}){const t=e,r=k(""),s=k(""),i=k(!1),o=k(""),a=k(""),l=k(!0),c=Oe(()=>!!r.value&&r.value.includes("@")&&!!s.value);async function d(){if(c.value){i.value=!0,o.value="",a.value="";try{if(await eT(r.value.trim(),s.value),l.value)try{Vi.saveSession(r.value.trim())}catch{}t("success")}catch{o.value="Email ou mot de passe incorrect"}finally{i.value=!1}}}async function f(){if(!r.value||!r.value.includes("@")){o.value="Saisissez votre email pour recevoir un lien de réinitialisation",setTimeout(()=>{o.value=""},2500);return}i.value=!0,o.value="",a.value="";try{await tT(r.value.trim()),a.value="Email de réinitialisation envoyé"}catch{o.value="Impossible d'envoyer l'email de réinitialisation"}finally{i.value=!1}}return(g,y)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[170] p-4",onClick:y[6]||(y[6]=T=>g.$emit("close"))},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-md",onClick:y[5]||(y[5]=Ft(()=>{},["stop"]))},[h("button",{onClick:y[0]||(y[0]=T=>g.$emit("close")),class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},"✖️"),y[10]||(y[10]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">👤</span></div><h2 class="text-2xl font-bold text-white mb-1">Mon compte</h2><p class="text-sm text-gray-300">Connectez-vous pour gérer votre compte et vos préférences</p></div>',1)),h("div",P$,[ct(AT),h("div",null,[y[7]||(y[7]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Email",-1)),nt(h("input",{"onUpdate:modelValue":y[1]||(y[1]=T=>r.value=T),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[kt,r.value]])]),h("div",null,[y[8]||(y[8]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":y[2]||(y[2]=T=>s.value=T),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe"},null,512),[[kt,s.value]])]),h("div",R$,[h("label",C$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":y[3]||(y[3]=T=>l.value=T),class:"w-4 h-4"},null,512),[[vi,l.value]]),y[9]||(y[9]=h("span",null,"Rester connecté sur cet appareil",-1))]),h("button",{onClick:f,class:"text-sm text-blue-400 hover:text-blue-300 underline"},"Mot de passe oublié ?")]),o.value?(L(),F("div",k$,le(o.value),1)):ge("",!0),a.value?(L(),F("div",D$,le(a.value),1)):ge("",!0),h("div",N$,[h("button",{onClick:y[4]||(y[4]=T=>g.$emit("close")),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer"),h("button",{onClick:d,disabled:!c.value||i.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},[i.value?(L(),F("span",O$,"⏳")):(L(),F("span",M$,"Se connecter"))],8,V$)])])])])):ge("",!0)}};const F$={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},$$={ref:"pageHeaderRef",class:"sticky top-0 z-[60] text-center py-4 md:py-6 px-4 relative bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900/95 backdrop-blur-sm border-b border-white/10"},U$={class:"text-4xl font-bold text-white mb-0 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},j$={class:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2"},B$={class:"hidden md:flex items-center gap-2"},q$={class:"w-full px-0 md:px-0 pb-0 pt-[72px] md:pt-[80px] -mt-[72px] md:-mt-[80px] bg-gray-900"},z$={class:"flex items-stretch relative"},K$={key:0,class:"col-left flex-shrink-0 p-3 md:p-4 sticky left-0 z-[81] bg-gray-900 h-full"},G$={class:"flex-1 overflow-hidden"},H$=["data-event-id","onClick"],W$=["title"],Q$=["title"],J$={key:0,class:"mt-1 text-xs text-gray-400"},Y$=["title","onClick"],X$=["title","onClick"],Z$=["title","aria-label"],e6={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t6={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3l18 18"},n6={key:0,class:"pointer-events-none"},r6={class:"flex items-center justify-between"},s6={key:1,class:"pointer-events-none"},i6={id:"coachmark-avail",class:"coachmark pointer-events-auto max-w-sm bg-gray-900 border border-pink-500/40 rounded-xl shadow-2xl p-3 text-white relative"},o6={class:"flex items-center justify-between"},a6={key:2,class:"pointer-events-none"},l6={id:"coachmark-name",class:"coachmark pointer-events-auto max-w-sm bg-gray-900 border border-yellow-500/40 rounded-xl shadow-2xl p-3 text-white relative"},u6={class:"flex items-center justify-between"},c6={class:"table-auto border-separate border-spacing-0 table-fixed w-auto min-w-max"},d6=["data-player-id"],h6={class:"px-0 py-4 md:py-5 font-medium text-white relative group text-xl md:text-2xl sticky left-0 z-40 bg-gray-900 left-col-td"},f6={class:"px-4 md:px-5 font-bold text-xl md:text-2xl flex items-center w-full min-w-0"},p6={key:0,class:"text-yellow-400 mr-1 text-sm",title:"Joueur protégé par mot de passe"},m6=["onClick","title"],g6=["data-event-id"],v6={class:"border-t border-white/10"},y6={class:"px-0 py-4 md:py-5 sticky left-0 z-40 bg-gray-900 left-col-td"},_6={class:"px-4 md:px-5 flex items-center"},b6=["data-event-id"],w6={key:0,class:"fixed inset-0 z-[120] flex items-center justify-center bg-gray-950/80 backdrop-blur-sm"},I6={class:"text-center"},E6={class:"text-white text-lg"},T6={class:"mt-3 w-64 h-2 bg-white/10 rounded-full overflow-hidden"},x6={class:"text-white/60 text-xs mt-2"},A6={key:3,class:"fixed bottom-4 left-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-2xl border border-green-400/30 backdrop-blur-sm z-[200]"},S6={class:"flex items-center space-x-2"},P6={key:4,class:"fixed bottom-4 left-4 bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-xl shadow-2xl border border-red-400/30 backdrop-blur-sm z-[200]"},R6={class:"flex items-center space-x-2"},C6={key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},k6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},D6={class:"mb-6"},N6={class:"mb-6"},V6={class:"mb-6"},O6={class:"mb-6 flex items-center gap-3"},M6={class:"mb-6"},L6={key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},F6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},$6={class:"mb-6"},U6={class:"flex justify-end space-x-3"},j6={key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},B6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},q6={class:"flex justify-end space-x-3"},z6={key:8,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},K6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},G6={class:"flex justify-end space-x-3"},H6={key:9,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[95] p-4"},W6={class:"relative text-center p-6 pb-4 border-b border-white/10"},Q6={class:"text-2xl md:text-3xl font-bold text-white mb-1"},J6={class:"text-sm md:text-base text-purple-300"},Y6={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},X6={key:0,class:"mb-4 md:mb-6"},Z6={class:"text-gray-300 bg-gray-800/50 p-4 rounded-lg border border-gray-600/50"},eU={class:"grid grid-cols-3 gap-3 md:gap-4 mb-2 md:mb-4"},tU={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},nU={class:"text-xl md:text-2xl font-bold text-white"},rU={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},sU={class:"text-xl md:text-2xl font-bold text-white"},iU={class:"p-3 md:p-4 rounded-lg border border-yellow-500/30 bg-yellow-500/10 text-center"},oU={class:"text-xl md:text-2xl font-bold text-yellow-300"},aU={key:1,class:"mb-4 md:mb-6"},lU={class:"mb-3 flex items-center"},uU=["title"],cU={class:"truncate"},dU={class:"space-y-0.5"},hU={class:"flex items-center min-w-0 gap-1.5"},fU={key:0,class:"text-yellow-400 mr-1 text-xs",title:"Joueur protégé par mot de passe"},pU=["title"],mU={class:"flex-0 p-0"},gU={class:"hidden md:flex justify-center flex-wrap gap-3 mt-4"},vU=["disabled","title"],yU=["title"],_U={key:2,class:"md:hidden mt-3 space-y-2"},bU=["disabled","title"],wU={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},IU={key:11,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},EU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},TU={class:"mb-6"},xU={class:"mb-6"},AU={class:"mb-6"},SU={class:"mb-6 flex items-center gap-3"},PU={class:"mb-6"},RU={key:12,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},CU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},kU={class:"mb-6"},DU={class:"space-y-4"},NU=["disabled"],VU={key:0,class:"animate-spin"},OU={key:1},MU={class:"mb-6 text-center"},LU={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},FU={class:"text-red-300 text-sm"},$U={key:13,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[110] p-0 md:p-4"},UU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 shadow-2xl w-full max-w-md rounded-t-2xl md:rounded-2xl flex flex-col max-h-[90vh]"},jU={class:"px-4 pt-3 pb-16 md:px-6 md:pt-4 md:pb-20 overflow-y-auto"},BU={class:"space-y-4"},qU={class:"mt-2 text-center"},zU={key:0,class:"mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},KU={class:"text-red-300 text-sm"},GU={class:"sticky bottom-0 w-full p-3 md:p-4 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2 pb-[env(safe-area-inset-bottom)]"},HU=["disabled"],WU={key:0,class:"animate-spin"},QU={key:1},JU={class:"mb-6"},YU=["disabled"],XU={key:0,class:"animate-spin"},ZU={key:1},e5={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},t5={class:"text-red-300 text-sm"},n5={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},r5={class:"text-green-300 text-sm"},s5={class:"flex justify-center"},i5={class:"mb-6"},o5=["disabled"],a5={key:0,class:"animate-spin"},l5={key:1},u5={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},c5={class:"text-red-300 text-sm"},d5={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},h5={class:"text-green-300 text-sm"},f5={class:"flex justify-center"},p5={key:16,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},m5={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl max-w-md"},g5={class:"flex gap-3"},u0={__name:"GridBoard",props:{slug:{type:String,required:!0},eventId:{type:String,required:!1}},setup(n){const e=n,t=Wu(),r=Za(),s=e.slug,i=k(""),o=k(""),a=k({}),l=k(!1),c=k(null),d=k(null),f=k(""),g=k(""),y=k(6),T=k(!1),A=k(""),P=k(null),U=k(null),q=k(null),M=k({position:null,side:null}),z=k({position:null}),he=k({position:null}),pe=k(!1),x=k(null),I=k(!1),w=k(null),C=k(null),V=k(!1),B=k(null),R=k(""),wt=k(!1),gt=k(null),Y=k(""),j=k(""),ne=k(!1),Ke=k(null),Be=k(!1),Ge=k(null),re=k(""),ee=k(""),je=k(!1),Xe=k(null),ht=k(!1),D=k(!1),$=k(""),X=k(""),se=k(!1),ke=k(!1),$e=k(""),E=k(""),S=k(!1),O=k(null),oe=k(""),Z=k(!1),ae=k(!1),be=k(!1),ve=k(null),ye=k(null),fe=k(null),Ae=k(0);function Te(){var _;try{if(!o.value||!a.value||a.value.onboardingCreatorDone!==!0||qe.value.length===0)return;const m=localStorage.getItem(`playerTourCompleted:${o.value}`);try{const J=((_=Nt==null?void 0:Nt.currentUser)==null?void 0:_.email)||"";J&&Lg(J).then(async ie=>{const te=ie.filter(me=>me.seasonId===o.value);if(te.length>0){const me=`seasonPreferredPlayer:${o.value}`,Ve=localStorage.getItem(me);let We=[];if(Ve)if(Ve.startsWith("["))try{We=JSON.parse(Ve)||[]}catch{}else We=[Ve];const tt=new Set(We);te.forEach(Ht=>tt.add(Ht.playerId));const mt=Array.from(tt);localStorage.setItem(me,JSON.stringify(mt))}}).catch(()=>{})}catch{}const N=localStorage.getItem(`startPlayerTour:${o.value}`);!m&&N&&(Ae.value=1,localStorage.removeItem(`startPlayerTour:${o.value}`),fn(()=>{const J=document.querySelector('button[data-onboarding="add-player"]');if(J){J.scrollIntoView({behavior:"smooth",block:"end"});const ie=J.getBoundingClientRect(),te=document.getElementById("coachmark-add"),me=280,Ve=100,We=(te==null?void 0:te.offsetWidth)||me,tt=(te==null?void 0:te.offsetHeight)||Ve,mt=Math.round(ie.right+12);if(mt+We<=window.innerWidth-12){const nn=ie.top+ie.height/2-tt/2,ut=-14,Nn=12,dr=window.innerHeight-tt-12,Vr=Math.max(Nn,Math.min(Math.round(nn+ut),dr));M.value={position:{x:mt,y:Vr},side:"right"}}else{const nn=Math.round(ie.left+ie.width/2-We/2),ut=Math.round(ie.top-tt-8),Nn=8,dr=window.innerWidth-We-8;M.value={position:{x:Math.max(Nn,Math.min(nn,dr)),y:ut},side:null}}}}))}catch{}}const Pe=k(!1),De=k(null),Le=k(null),He=k(!1),Ze=k(null),Yt=k(!1),Bt=k(null),_n=k(!1),Mt=k(!1),mr=k(!1),Ur=k(!1),un=k(null);function Cn(){Mt.value=!1}function qi(){try{const _=Nt==null?void 0:Nt.currentUser;if(!_||_.isAnonymous){let m=null;if(ta.value&&ta.value.size>0){const N=ta.value.values().next().value;m=et.value.find(J=>J.id===N)||null}m||(m=et.value[0]||null),Ur.value=!0,m&&(un.value=m);return}}catch{}Mt.value=!0}async function yl(){var _;try{const m=(_=Nt==null?void 0:Nt.currentUser)==null?void 0:_.email;if(!m)return;const{resetPlayerPassword:N}=await Xt(()=>Promise.resolve().then(()=>wi),void 0);await N(m),Fe.value=!0,pt.value="Email de réinitialisation envoyé.",setTimeout(()=>{Fe.value=!1},3e3)}catch{yr.value=!0,Qi.value="Impossible d'envoyer l'email de réinitialisation.",setTimeout(()=>{yr.value=!1},3e3)}}async function vc(){try{await IN(Nt),Cn(),Fe.value=!0,pt.value="Déconnecté de cet appareil.",setTimeout(()=>{Fe.value=!1},2500)}catch{yr.value=!0,Qi.value="Déconnexion impossible.",setTimeout(()=>{yr.value=!1},3e3)}}async function yc(){alert("Suppression de compte: contactez l'organisateur pour dissocier vos joueurs. Fonction complète à venir.")}async function zi(_){var m;Cn();try{if(_.seasonId&&_.seasonId!==o.value){const N=Se(ue,"seasons",_.seasonId),ie=(await bt(Je(ue,"seasons"))).docs.find(me=>me.id===_.seasonId),te=(m=ie==null?void 0:ie.data())==null?void 0:m.slug;if(te){t.push(`/season/${te}?player=${encodeURIComponent(_.playerId)}&open=protection`);return}}else{const N=et.value.find(J=>J.id===_.playerId);if(N){dn(N);return}t.push(`?player=${encodeURIComponent(_.playerId)}&open=protection`)}}catch{}}ir(()=>{try{o.value&&localStorage.getItem(`dismissCreatorOnboarding:${o.value}`)&&(onboardingDismissedShare.value=!0)}catch{}});function _l(){fn(()=>{wl()})}const Sr=k(new Set),er=k(!0),Pr=k(0),Rr=k("Préparation de la grille"),Cr=k(e.eventId||null),qs=k(!1),Ki=k(null);xt(()=>e.eventId,_=>{if(_)if(Cr.value=_,qe.value.length>0)Qg(_);else{const m=xt(qe,N=>{N.length>0&&(Qg(_),m())},{immediate:!0})}});const tn=Oe(()=>et.value.map(_=>({..._,isProtected:Sr.value.has(_.id),email:null}))),_c=Oe(()=>Cr.value?Dn.value.findIndex(_=>_.id===Cr.value):-1);Oe(()=>{if(!Cr.value||_c.value===-1)return!1;if(window.innerWidth<=768){const _=document.querySelector(`[data-event-id="${Cr.value}"]`);if(_){const m=_.getBoundingClientRect();return m.left>=0&&m.right<=window.innerWidth}}return!0});const kn=k(null),zs=k(!1),bc=k(!1),bl=k(0),Ks=k(null),zn=k(null),zo=k(null);function Kn(){const _=kn.value;if(!_)return;const{scrollLeft:m,scrollWidth:N,clientWidth:J}=_;zs.value=m>2,bc.value=m<N-J-2}function wl(){var _;try{Kn(),bl.value=((_=kn.value)==null?void 0:_.scrollLeft)||0}catch{}}function Ko(_){const m=kn.value;if(!m)return;let N=0;const J=m.querySelector("tbody tr td[data-event-id]");if(J)N=J.getBoundingClientRect().width;else if(zn!=null&&zn.value){const te=zn.value.querySelector(".col-event");te&&(N=te.getBoundingClientRect().width)}(!N||!isFinite(N))&&(N=m.clientWidth*.6);const ie=m.scrollLeft+_*N;m.scrollTo({left:ie,behavior:"smooth"})}const jr=k(null);k(0);const tr=k(!1),Gi=k(!1),as=k(0);function Go(_,m){m&&typeof m.preventDefault=="function"&&m.preventDefault(),gr(),Ko(_)}function Gs(_,m){if(m&&typeof m.preventDefault=="function"&&m.preventDefault(),tr.value)return;tr.value=!0,as.value=_,Gi.value=!1;const N=kn.value;if(!N)return;let J=0;const ie=N.querySelector("tbody tr td[data-event-id]");if(ie)J=ie.getBoundingClientRect().width;else if(zn!=null&&zn.value){const We=zn.value.querySelector(".col-event");We&&(J=We.getBoundingClientRect().width)}(!J||!isFinite(J))&&(J=N.clientWidth*.6);const te=J/6,me=120,Ve=()=>{if(!tr.value||as.value===0)return;Gi.value||(Gi.value=!0);const We=N.scrollLeft+as.value*te;N.scrollTo({left:We,behavior:"auto"}),jr.value=window.setTimeout(Ve,me)};jr.value=window.setTimeout(Ve,250)}function gr(_){_&&typeof _.preventDefault=="function"&&_.preventDefault();const m=tr.value,N=Gi.value;if(tr.value=!1,jr.value&&(clearTimeout(jr.value),jr.value=null),_&&typeof _.type=="string"&&_.type.startsWith("touch")&&!N){const J=as.value||0;J!==0&&Ko(J),as.value=0;return}as.value=0,m&&N&&wc()}function wc(){const _=kn.value;if(!_)return;let m=0;const N=_.querySelector("tbody tr td[data-event-id]");if(N)m=N.getBoundingClientRect().width;else if(zn!=null&&zn.value){const me=zn.value.querySelector(".col-event");me&&(m=me.getBoundingClientRect().width)}if(!m||!isFinite(m)||m<=0)return;const J=_.scrollLeft,te=Math.round(J/m)*m;_.scrollTo({left:te,behavior:"smooth"})}function Zh(_){P.value=_;const m=document.querySelector(`[data-player-id="${_}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"center"}),Fe.value=!0,pt.value="Nouveau joueur ajouté !",setTimeout(()=>{Fe.value=!1},3e3)}function Ho(){if(Ae.value!==1)return;const _=document.querySelector('button[data-onboarding="add-player"]');if(!_)return;const m=_.getBoundingClientRect(),N=document.getElementById("coachmark-add"),J=280,ie=100,te=N!=null&&N.offsetWidth&&N.offsetWidth>0?N.offsetWidth:J,me=N!=null&&N.offsetHeight&&N.offsetHeight>0?N.offsetHeight:ie,Ve=Math.round(m.right+12);if(Ve+te<=window.innerWidth-12){const tt=m.top+m.height/2-me/2,Ht=Il(tt+-14,me);M.value={position:{x:Ve,y:Ht},side:"right"}}else{const tt=Math.round(m.left+m.width/2-te/2),mt=Il(m.top-me-8,me),Ht=8,nn=window.innerWidth-te-8;M.value={position:{x:Math.max(Ht,Math.min(tt,nn)),y:mt},side:null}}}function Il(_,m){const N=pageHeaderRef==null?void 0:pageHeaderRef.value,J=N?Math.max(0,Math.round(N.getBoundingClientRect().height||0)):0,ie=Math.max(12,J+8),te=window.innerHeight-m-12;return Math.max(ie,Math.min(Math.round(_),te))}const vr=k(!1),ls=k(null),Br=k(null),Wo=k({position:"fixed",top:"0px",right:"0px"});function El(){try{const _=ls.value;if(!_)return;const m=_.getBoundingClientRect(),N=8,J=Math.max(N,Math.round(m.bottom+N)),ie=Math.max(N,Math.round(window.innerWidth-m.right));Wo.value={position:"fixed",top:`${J}px`,right:`${ie}px`,zIndex:400}}catch{}}function Ic(){vr.value=!vr.value,vr.value&&fn(()=>El())}function Qo(){vr.value=!1}function Tl(_){if(!vr.value)return;const m=ls.value,N=Br.value,J=m&&m.contains(_.target),ie=N&&N.contains(_.target);!J&&!ie&&(vr.value=!1)}function Jo(_){_.key==="Escape"&&Qo()}function Hs(){vr.value&&El()}ir(()=>{document.addEventListener("click",Tl),document.addEventListener("keydown",Jo),window.addEventListener("scroll",Hs,{passive:!0}),window.addEventListener("resize",Hs)}),_a(()=>{document.removeEventListener("click",Tl),document.removeEventListener("keydown",Jo),window.removeEventListener("scroll",Hs),window.removeEventListener("resize",Hs)});function Hi(){var _;Ae.value===1&&((_=M.value)!=null&&_.position)&&Ho()}ir(()=>{window.addEventListener("scroll",Hi,{passive:!0}),window.addEventListener("resize",Hi)}),_a(()=>{window.removeEventListener("scroll",Hi),window.removeEventListener("resize",Hi)});function Wi(_){return Sr.value.has(_)}async function xl(){if(o.value)try{const _=await jp(o.value),m=new Set;_.forEach(N=>{N.isProtected&&m.add(N.playerId||N.id)}),Sr.value=m}catch{const m=new Set;for(const N of et.value)await Ei(N.id,o.value)&&m.add(N.id);Sr.value=m}}const Fe=k(!1),pt=k(""),yr=k(!1),Qi=k("");function us(){try{const _=`${window.location.origin}/season/${s}`;navigator.clipboard.writeText(_),Fe.value=!0,pt.value="Lien copié dans le presse-papiers",setTimeout(()=>{Fe.value=!1},2500)}catch{yr.value=!0,Qi.value="Impossible de copier le lien",setTimeout(()=>{yr.value=!1},2500)}}async function _r(_){await Xs({type:"deleteEvent",data:{eventId:_}})}async function Yo(_=null){const m=_||c.value;if(console.debug("deleteEventConfirmed"),!m){console.error("Aucun événement à supprimer");return}try{await RO(m,o.value),qe.value=qe.value.filter(N=>N.id!==m),await Promise.all([Lp(o.value),co(et.value,qe.value,o.value),ho(o.value)]).then(([N,J,ie])=>{qe.value=N,Gt.value=J,at.value=ie}),l.value=!1,c.value=null,Fe.value=!0,pt.value="Événement supprimé avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la suppression de l'événement"),alert("Erreur lors de la suppression de l'événement. Veuillez réessayer.")}}function Xo(){l.value=!1,c.value=null}async function Zo(){if(!d.value||!f.value.trim()||!g.value)return;const _=parseInt(y.value);if(isNaN(_)||_<1||_>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}try{const m={title:f.value.trim(),date:g.value,description:oe.value.trim()||"",playerCount:_,archived:!!Z.value};await W_(d.value,m,o.value),!m.archived&&et.value.length>0&&Sr.value.size>0&&(Bt.value={id:d.value,...m},Yt.value=!0),await Promise.all([Lp(o.value),co(et.value,qe.value,o.value),ho(o.value)]).then(([N,J,ie])=>{qe.value=N,Gt.value=J,at.value=ie}),d.value=null,f.value="",g.value="",oe.value="",y.value=6,Z.value=!1,Fe.value=!0,pt.value="Événement mis à jour avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de l'édition de l'événement"),alert("Erreur lors de l'édition de l'événement. Veuillez réessayer.")}}async function St(){if(A.value.trim())try{const _=A.value.trim(),m=await aT(_,o.value);await Promise.all([_d(o.value),co(et.value,qe.value,o.value),ho(o.value)]).then(([N,J,ie])=>{et.value=N,Gt.value=J,at.value=ie,xl();const te=et.value.find(Ve=>Ve.id===m);Zh(m),U.value=m,q.value=Dn.value&&Dn.value[0]&&Dn.value[0].id?Dn.value[0].id:null;try{o.value&&localStorage.setItem(`lastAddedPlayerId:${o.value}`,m)}catch{}try{typeof Ae<"u"&&(Ae.value=2)}catch{}const me=document.querySelector(`[data-player-id="${m}"]`);me&&me.scrollIntoView({behavior:"smooth",block:"center"}),fn(()=>{const Ve=`[data-player-id="${U.value}"] td[data-event-id="${q.value}"]`,We=document.querySelector(Ve);if(We){const tt=We.getBoundingClientRect();z.value.position={x:Math.round(tt.left),y:Math.round(tt.top+window.scrollY-48)}}}),Fe.value=!0,pt.value="Joueur ajouté avec succès ! Vous pouvez maintenant indiquer sa disponibilité.",setTimeout(()=>{Fe.value=!1},3e3),setTimeout(()=>{Fe.value=!1,pt.value=""},5e3)}),T.value=!1,A.value=""}catch{console.error("Erreur lors de l'ajout du joueur"),alert("Erreur lors de l'ajout du joueur. Veuillez réessayer.")}}function qr(){d.value=null,f.value="",g.value="",oe.value="",y.value=6}k(null);const zr=k(!1),br=k(""),Ws=k(""),Qs=k(""),Ji=k(6),ea=k(!1);async function ef(){if(!br.value.trim()||!Ws.value){alert("Veuillez remplir le titre et la date de l'événement");return}const _=parseInt(Ji.value);if(isNaN(_)||_<1||_>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}const m={title:br.value.trim(),date:Ws.value,description:Qs.value.trim()||"",playerCount:_,archived:!!ea.value};await tf(m)}async function tf(_){try{const m=await CO(_,o.value);qe.value=[...qe.value,{id:m,..._}];const N={};for(const J of et.value)N[J.name]=Gt.value[J.name]||{},N[J.name][m]=null,await G_(J.name,N[J.name],o.value);br.value="",Ws.value="",Qs.value="",Ji.value=6,ea.value=!1,zr.value=!1,await Promise.resolve(),Fe.value=!0,pt.value="Événement créé avec succès !",!_.archived&&et.value.length>0&&Sr.value.size>0&&(Bt.value={id:m,..._},Yt.value=!0),setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la création de l'événement"),alert("Erreur lors de la création de l'événement. Veuillez réessayer.")}}function Yi(){br.value="",Ws.value="",Qs.value="",Ji.value=6,zr.value=!1}async function kr(){await Xs({type:"addEvent",data:{}})}const qe=k([]),et=k([]),Gt=k({}),at=k({}),nf=k({}),Al=k({});xt([()=>qe.value.length,()=>et.value.length,er],()=>{er.value||fn(()=>{wl()})}),xt([()=>et.value.length,()=>qe.value.length,o],()=>{Te()}),ir(async()=>{oT("firebase"),await xO();const _=Ou(Je(ue,"seasons"),Gd("slug","==",e.slug)),m=await bt(_);if(m.empty){t.push("/");return}else{const te=m.docs[0];o.value=te.id;const me=te.data();i.value=me.name,a.value=me,document.title=`Saison : ${i.value}`}if(o.value){Rr.value="Chargement des événements de la saison",Pr.value=20;const te=await bt(Je(ue,"seasons",o.value,"events"));qe.value=te.docs.map(ut=>({id:ut.id,...ut.data(),playerCount:ut.data().playerCount||6})),Rr.value="Chargement des joueurs",Pr.value=45;const me=await bt(Je(ue,"seasons",o.value,"players"));et.value=me.docs.map(ut=>({id:ut.id,...ut.data()})),Rr.value="Chargement des disponibilités",Pr.value=70;const Ve=await bt(Je(ue,"seasons",o.value,"availability")),We={};Ve.docs.forEach(ut=>{const Nn=ut.data(),dr={};Object.keys(Nn).forEach(Vr=>{const ti=Nn[Vr];dr[Vr]=ti==="oui"?!0:ti==="non"?!1:ti}),We[ut.id]=dr}),Gt.value=We,Rr.value="Chargement des sélections",Pr.value=85;const tt=await bt(Je(ue,"seasons",o.value,"selections")),mt={};tt.docs.forEach(ut=>{mt[ut.id]=ut.data().players||[]}),at.value=mt;const Ht=await jp(o.value),nn=new Set;Array.isArray(Ht)&&Ht.forEach(ut=>{ut.isProtected&&nn.add(ut.playerId||ut.id)}),Sr.value=nn}const N=te=>{typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>te()):setTimeout(te,0)};Rr.value="Préparation de l'interface",Pr.value=95,N(()=>{Rc(),ia()}),console.debug("players (deduplicated)"),console.debug("availability loaded"),await fn(),Pr.value=100,er.value=!1,fn(()=>{Kn(),requestAnimationFrame(()=>Kn()),setTimeout(()=>Kn(),250);const te=kn.value;te&&(te.addEventListener("scroll",me=>{Kn(),bl.value=te.scrollLeft||0},{passive:!0}),window.addEventListener("resize",Kn),typeof ResizeObserver<"u"&&(zo.value=new ResizeObserver(()=>{Kn()}),zo.value.observe(te)))});const J=r.query.event;if(J&&qe.value.length>0){const te=qe.value.find(me=>me.id===J);te?(console.debug("Événement trouvé depuis l'URL"),await lf(J,te)):(console.warn("Événement non trouvé avec l'ID"),yr.value=!0,Qi.value="Événement non trouvé",setTimeout(()=>{yr.value=!1},3e3))}const ie=r.query.player;if(ie&&et.value.length>0){const te=et.value.find(me=>me.id===ie);te&&(dn(te),await fn(),r.query.verified==="1"&&(Fe.value=!0,pt.value="Joueur associé à votre compte.",setTimeout(()=>{Fe.value=!1},2500)))}}),xt(()=>r.params.eventId,_=>{if(_){const m=()=>{const N=qe.value.find(J=>J.id===_);return N?(v(N),!0):!1};if(qe.value.length>0)m();else{const N=xt(qe,J=>{J.length>0&&m()&&N()},{immediate:!0})}}},{immediate:!0});function Ec(_){if(!_)return null;if(_ instanceof Date)return _;if(typeof(_==null?void 0:_.toDate)=="function")return _.toDate();if(typeof _=="string"||typeof _=="number"){const m=new Date(_);return isNaN(m.getTime())?null:m}return null}const Gn=Oe(()=>{let _=null;try{o.value&&(_=localStorage.getItem(`seasonPreferredPlayer:${o.value}`))}catch{}const m=[...et.value].sort((me,Ve)=>(me.name||"").localeCompare(Ve.name||"","fr",{sensitivity:"base"}));if(!_)return m;let N=[];try{_.startsWith("[")?N=JSON.parse(_):_&&(N=[_])}catch{N=[]}const J=new Set(N);if(J.size===0)return m;const ie=m.filter(me=>J.has(me.id)),te=m.filter(me=>!J.has(me.id));return[...ie,...te]}),ta=Oe(()=>{try{if(o.value){const _=localStorage.getItem(`seasonPreferredPlayer:${o.value}`);if(!_)return new Set;if(_.startsWith("[")){const m=JSON.parse(_);return new Set(Array.isArray(m)?m:[])}return new Set([_])}}catch{}return new Set}),rf=Oe(()=>[...qe.value].sort((_,m)=>{const N=Ec(_.date),J=Ec(m.date),ie=N?N.getTime():Number.POSITIVE_INFINITY,te=J?J.getTime():Number.POSITIVE_INFINITY;return ie!==te?ie-te:(_.title||"").localeCompare(m.title||"","fr",{sensitivity:"base"})})),Dr=k(!1),Dn=Oe(()=>{const _=rf.value;return Dr.value?_:_.filter(m=>!m.archived)});function Tc(){Dr.value=!Dr.value}const cs=k("selected"),Xi=Oe(()=>{var N;if(!O.value)return Gn.value;const _=O.value.id,m=new Set(((N=at.value)==null?void 0:N[_])||[]);return Gn.value.filter(J=>{var Ve;const ie=J.name,te=(Ve=Gt.value[ie])==null?void 0:Ve[_],me=m.has(ie);switch(cs.value){case"selected":return me;case"available":return te===!0&&!me;case"unavailable":return te===!1;case"unknown":return te!==!0&&te!==!1;case"all":default:return!0}})}),xc=Oe(()=>O.value?fs(O.value.id):null),Sl=Oe(()=>{if(!O.value)return!1;const _=fs(O.value.id);return _.type==="incomplete"||_.type==="insufficient"}),Lt=Oe(()=>O.value?sf(O.value.id):"");async function na(_,m){const N=et.value.find(te=>te.name===_);if(!N){console.error("Joueur non trouvé");return}const J=qe.value.find(te=>te.id===m);if(!J){console.error("Événement non trouvé");return}if(J.archived){Fe.value=!0,pt.value="Événement archivé — désarchivez pour modifier",setTimeout(()=>{Fe.value=!1},3e3);return}if(Wi(N.id)){const te=To(N.id),me=fe.value===N.id;console.debug("Joueur protégé:",{playerId:N.id,hasCachedPassword:te,wasRecentlyVerified:me,recentlyVerifiedPlayer:fe.value}),te||me?(console.debug("Session active ou joueur récemment vérifié, procéder au toggle"),me&&(console.debug("Nettoyage du flag recentlyVerifiedPlayer"),fe.value=null),Pl(N,m)):(console.debug("Pas de session, affichage de la modal de vérification"),ye.value={playerName:_,eventId:m},ve.value=N,be.value=!0);return}Pl(N,m)}function Pl(_,m){var ie,te,me;const N=(ie=Gt.value[_.name])==null?void 0:ie[m];console.debug("toggleAvailability");let J;N===!0?J=!1:N===!1?J=void 0:J=!0,J===void 0?Gt.value[_.name]&&delete Gt.value[_.name][m]:(Gt.value[_.name]||(Gt.value[_.name]={}),Gt.value[_.name][m]=J);try{typeof Ae<"u"&&Ae.value===1&&_.id===(U.value||((te=Gn.value[0])==null?void 0:te.id))&&m===(q.value||((me=Dn.value[0])==null?void 0:me.id))&&(Ae.value=3,fn(()=>{const We=document.querySelector(`[data-player-id="${_.id}"]`);if(We){const tt=We.querySelector(".player-name");if(tt){const mt=tt.getBoundingClientRect();he.value.position={x:Math.round(mt.right+8),y:Math.round(mt.top+window.scrollY-4)}}}}),_a(()=>{try{window.removeEventListener("resize",Kn)}catch{}try{zo.value&&zo.value.disconnect()}catch{}}))}catch{}G_(_.name,Gt.value[_.name],o.value).then(async()=>{await fn(),ia(),Fe.value=!0,pt.value="Disponibilité mise à jour avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}).catch(Ve=>{console.error("Erreur lors de la mise à jour de la disponibilité"),alert("Erreur lors de la mise à jour de la disponibilité. Veuillez réessayer.")})}function nr(_,m){var N;return(N=Gt.value[_])==null?void 0:N[m]}function Ac(_,m){var ie;const N=at.value[m]||[],J=(ie=Gt.value[_])==null?void 0:ie[m];return N.includes(_)&&J===!0}async function Sc(_,m=6){const N=qe.value.find(me=>me.id===_),J=(N==null?void 0:N.playerCount)||6,ie=at.value[_]||[];if(ie.length>0&&ie.every(me=>nr(me,_))){console.debug("Tous les joueurs sélectionnés sont disponibles, nouveau tirage complet");const Ve=et.value.filter(mt=>nr(mt.name,_)).map(mt=>{const Ht=Js(mt.name);return{name:mt.name,weight:1/(1+Ht)}}),We=[],tt=[...Ve];for(;We.length<J&&tt.length>0;){const mt=tt.reduce((ut,Nn)=>ut+Nn.weight,0);let Ht=Math.random()*mt;const nn=tt.findIndex(ut=>(Ht-=ut.weight,Ht<=0));nn>=0&&(We.push(tt[nn].name),tt.splice(nn,1))}at.value[_]=We}else{const me=ie.filter(We=>nr(We,_)),Ve=J-me.length;if(Ve<=0)at.value[_]=me;else{const We=new Set(me),mt=et.value.filter(ut=>nr(ut.name,_)&&!We.has(ut.name)).map(ut=>{const Nn=Js(ut.name);return{name:ut.name,weight:1/(1+Nn)}}),Ht=[],nn=[...mt];for(;Ht.length<Ve&&nn.length>0;){const ut=nn.reduce((Vr,ti)=>Vr+ti.weight,0);let Nn=Math.random()*ut;const dr=nn.findIndex(Vr=>(Nn-=Vr.weight,Nn<=0));dr>=0&&(Ht.push(nn[dr].name),nn.splice(dr,1))}at.value[_]=[...me,...Ht]}}await H_(_,at.value[_],o.value),Rc(),ia()}async function Zi(_,m=6){var me,Ve;console.debug("tirerProtected appelé"),console.debug("etat modal selection avant");const N=Pe.value,J=(me=De.value)==null?void 0:me.id,ie=at.value[_]&&at.value[_].length>0,te=ie?[...at.value[_]]:[];if(await Sc(_,m),console.debug("etat modal selection apres"),N&&!Pe.value&&(console.debug("Restauration de la popin de sélection..."),Pe.value=!0,De.value=qe.value.find(We=>We.id===J)),Pe.value&&((Ve=De.value)==null?void 0:Ve.id)===_)if(console.debug("Popin de sélection ouverte, mise à jour..."),await fn(),Le.value&&Le.value.showSuccess){console.debug("Appel de showSuccess sur la popin de sélection");const We=at.value[_]||[],tt=te.filter(Ht=>We.includes(Ht)),mt=tt.length>0&&tt.length<te.length;Le.value.showSuccess(ie,mt)}else console.debug("showSuccess indisponible");else console.debug("Popin de sélection fermée, affichage message global"),Fe.value=!0,qe.value.find(We=>We.id===_),at.value[_],ie?pt.value="Sélection mise à jour avec succès !":pt.value="Sélection effectuée avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}function ra(_){_===0?M.value.position=null:_===1?z.value.position=null:_===2&&(he.value.position=null)}function Nr(_){var N;return _?(typeof _=="string"?new Date(_):((N=_.toDate)==null?void 0:N.call(_))||_).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):""}function Rl(_){var N;return _?(typeof _=="string"?new Date(_):((N=_.toDate)==null?void 0:N.call(_))||_).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function Js(_){return Object.values(at.value).filter(m=>m.includes(_)).length}function ds(_){const m=Gt.value[_]||{};return Object.values(m).filter(N=>N===!0).length}function eo(_){return _?Object.values(Gt.value).filter(m=>m[_]===!0).length:0}function Ys(_){return _?(at.value[_]||[]).length:0}function to(_){const m=qe.value.find(J=>J.id===_),N=(m==null?void 0:m.playerCount)||6;return Ys(_)>=N}function Pc(_){const m=ds(_),N=Js(_);return m===0?0:N/m}function sa(_){nf.value[_]={availability:ds(_),selection:Js(_),ratio:Pc(_)}}function Rc(){et.value.forEach(_=>sa(_.name))}function ia(){const _={};qe.value.forEach(m=>{const N=m.playerCount||6,ie=et.value.filter(me=>nr(me.name,m.id)===!0).map(me=>{const Ve=Js(me.name);return{name:me.name,weight:1/(1+Ve)}}),te=ie.reduce((me,Ve)=>me+Ve.weight,0);ie.forEach(me=>{const Ve=Math.min(1,me.weight/te*N);_[me.name]||(_[me.name]={}),_[me.name][m.id]=Math.round(Ve*100)})}),Al.value=_}const Kr=k(null),no=k(!1);async function Cc(_=null){const m=_||Kr.value;if(!m){console.error("Aucun joueur à supprimer");return}try{await AO(m,o.value),et.value=et.value.filter(N=>N.id!==m),no.value=!1,Kr.value=null,Fe.value=!0,pt.value="Joueur supprimé avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la suppression du joueur"),alert("Erreur lors de la suppression du joueur. Veuillez réessayer.")}}function Cl(){no.value=!1,Kr.value=null}async function kl(_){gn(),await Ei(_,o.value)?await hs({type:"deletePlayer",data:{playerId:_}}):await Xs({type:"deletePlayer",data:{playerId:_}})}async function kc(){if(x.value){const _=qe.value.find(N=>N.id===x.value),m=(_==null?void 0:_.playerCount)||6;await Zi(x.value,m),pe.value=!1,x.value=null}}function oa(){pe.value=!1,x.value=null}function Dc(){return B.value?{deleteEvent:"Suppression d'événement - Code PIN requis",addEvent:"Ajout d'événement - Code PIN requis",deletePlayer:"Suppression de joueur - Code PIN requis",launchSelection:"Lancement de sélection - Code PIN requis",toggleArchive:"Archivage d'événement - Code PIN requis",updateSelection:"Mise à jour de sélection - Code PIN requis"}[B.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function Xs(_){if(xn.isPinCached(o.value)){const m=xn.getCachedPin(o.value);if(console.debug("PIN en cache trouvé, utilisation automatique"),await Yd(o.value,m)){await u(_);return}else xn.clearSession()}B.value=_,V.value=!0}async function hs(_){const m=_.data.playerId;try{if(xn.isPinCached(o.value)){console.debug("PIN de saison en cache — saut de la demande de mot de passe joueur"),await u(_);return}}catch{}if(To(m)){console.debug("Mot de passe du joueur en cache trouvé, utilisation automatique"),await u(_);return}gt.value=_,wt.value=!0}async function Nc(_){try{if(await Yd(o.value,_)){xn.saveSession(o.value,_),V.value=!1;const N=B.value;B.value=null,await u(N)}else R.value="Code PIN incorrect",setTimeout(()=>{R.value=""},3e3)}catch{console.error("Erreur lors de la vérification du PIN"),R.value="Erreur lors de la vérification du code PIN"}}function Vc(){V.value=!1,B.value=null,R.value=""}async function Dl(_){if(_){ne.value=!0,Y.value="";try{const m=gt.value.data.playerId,N=await Op(o.value);if(_===N){try{xn.saveSession(o.value,_)}catch{}try{Vi.saveSession(gt.value.data.playerId)}catch{}wt.value=!1;const ie=gt.value;gt.value=null,j.value="",await u(ie);return}if(await verifyPlayerPassword(m,_,o.value)){wt.value=!1;const ie=gt.value;gt.value=null,j.value="",await u(ie)}else Y.value="Mot de passe incorrect",setTimeout(()=>{Y.value=""},3e3)}catch{console.error("Erreur lors de la vérification du mot de passe"),Y.value="Erreur lors de la vérification du mot de passe"}finally{ne.value=!1}}}function Oc(){wt.value=!1,gt.value=null,Y.value="",j.value="",ne.value=!1}async function ro(_){if(_){je.value=!0,re.value="";try{const m=Ge.value.data.player,N=await Op(o.value);if(_===N){try{xn.saveSession(o.value,_)}catch{}try{Vi.saveSession(Ge.value.data.player.id)}catch{}Be.value=!1;const ie=Ge.value;Ge.value=null,ee.value="",await u(ie);return}if(await verifyPlayerPassword(m.id,_,o.value)){Be.value=!1;const ie=Ge.value;Ge.value=null,ee.value="",await u(ie)}else re.value="Mot de passe incorrect",setTimeout(()=>{re.value=""},3e3)}catch{console.error("Erreur lors de la vérification du mot de passe"),re.value="Erreur lors de la vérification du mot de passe"}finally{je.value=!1}}}function Hn(){Be.value=!1,Ge.value=null,re.value="",ee.value="",je.value=!1}async function Mc(){D.value=!0,$.value="",X.value="";try{const _=Ge.value.data.player,m=await sendPasswordResetEmail(_.id,o.value);X.value=m.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch{console.error("Erreur lors de l'envoi de l'email"),$.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{D.value=!1}}async function Lc(){ke.value=!0,$e.value="",E.value="";try{const _=gt.value.data.playerId,m=await sendPasswordResetEmail(_,o.value);E.value=m.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch{console.error("Erreur lors de l'envoi de l'email"),$e.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{ke.value=!1}}function Zs(){return xn.isPinCached(o.value)?{timeRemaining:xn.getTimeRemaining(),isExpiringSoon:xn.isExpiringSoon()}:null}async function u(_){var J;if(!_)return;const{type:m,data:N}=_;try{switch(m){case"deleteEvent":console.debug("executePendingOperation - data.eventId reçu"),c.value=N.eventId,l.value=!0;break;case"addEvent":zr.value=!0;break;case"deletePlayer":Kr.value=N.playerId,no.value=!0;break;case"launchSelection":at.value[N.eventId]&&at.value[N.eventId].length>0?(x.value=N.eventId,pe.value=!0,S.value=!1):(await Zi(N.eventId,N.count),S.value=!1);break;case"toggleAvailability":Pl(N.player,N.eventId);break;case"toggleArchive":await setEventArchived(N.eventId,N.archived,o.value);{const ie=qe.value.findIndex(te=>te.id===N.eventId);ie!==-1&&(qe.value[ie]={...qe.value[ie],archived:!!N.archived}),Z.value=!!N.archived}break;case"updateSelection":{const{eventId:ie,players:te}=N,me=[...at.value[ie]||[]],Ve=Array.isArray(te)?te:[];await H_(ie,Ve,o.value),at.value[ie]=Ve;try{const We=me.filter(tt=>!Ve.includes(tt));if(We.length>0){const tt=qe.value.find(mt=>mt.id===ie);await gM({eventId:ie,eventData:tt,removedPlayers:We,newSelectedPlayers:Ve,seasonId:o.value,seasonSlug:s,players:tn.value})}}catch{}try{(J=Le.value)==null||J.showSuccess(!0,!0)}catch{}}break}}catch{console.error("Erreur lors de l'exécution de l'opération"),Fe.value=!0,pt.value="Erreur lors de l'opération. Veuillez réessayer.",setTimeout(()=>{Fe.value=!1},3e3)}}function p(){t.push("/")}_a(()=>{const _=kn.value;_&&_.removeEventListener("scroll",Kn),window.removeEventListener("resize",Kn)});async function v(_){O.value=_,oe.value=_.description||"",Z.value=!!_.archived;try{const[m,N]=await Promise.all([co(et.value,qe.value,o.value),ho(o.value)]);Gt.value=m,at.value=N}catch(m){console.warn("Impossible de rafraîchir les données avant ouverture des détails:",m)}S.value=!0}function b(){S.value=!1,O.value=null,oe.value="",ae.value=!1}function K(){b(),r.params.eventId&&t.push(`/season/${e.slug}`)}async function W(_,m){console.debug("handleAvailabilityToggle appelé");const N=et.value.find(te=>te.name===_);if(!N){console.error("Joueur non trouvé");return}const J=qe.value.find(te=>te.id===m);if(J!=null&&J.archived){Fe.value=!0,pt.value="Événement archivé — désarchivez pour modifier",setTimeout(()=>{Fe.value=!1},3e3);return}console.debug("Joueur trouvé");const ie=Wi(N.id);if(console.debug("Joueur protégé"),ie){To(N.id)?(console.debug("Session active, procéder au toggle"),await na(_,m)):(console.debug("Demande du mot de passe pour joueur protégé"),ye.value={playerName:_,eventId:m},ve.value=N,be.value=!0);return}console.debug("Joueur non protégé, procéder au toggle"),await na(_,m)}function Ie(_,m){return(at.value[m]||[]).includes(_)}async function It(_){if(console.debug("Mot de passe vérifié"),ve.value&&(fe.value=ve.value.id,console.debug("Joueur marqué comme récemment vérifié")),ye.value){const{playerName:m,eventId:N}=ye.value;console.debug("Exécution de l'action en attente"),await na(m,N),ye.value=null}else console.debug("Aucune action en attente trouvée");be.value=!1,ve.value=null}function cn(){d.value=O.value.id,f.value=O.value.title,g.value=O.value.date,oe.value=O.value.description||"",y.value=O.value.playerCount||6,S.value=!1}async function lt(){if(O.value)try{const _=!O.value.archived,m={...O.value,archived:_};await W_(O.value.id,m,o.value),O.value.archived=_;const N=qe.value.findIndex(J=>J.id===O.value.id);N!==-1&&(qe.value[N].archived=_),Fe.value=!0,pt.value=_?"Événement archivé avec succès !":"Événement désarchivé avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la modification de l'archivage"),alert("Erreur lors de la modification de l'archivage. Veuillez réessayer.")}}function dn(_){w.value=_,I.value=!0;try{typeof Ae<"u"&&Ae.value}catch{}}function gn(){I.value=!1,w.value=null}async function ei({playerId:_,newName:m}){try{await SO(_,m,o.value),await Promise.all([_d(o.value),co(et.value,qe.value,o.value),ho(o.value)]).then(([N,J,ie])=>{if(et.value=N,Gt.value=J,at.value=ie,xl(),w.value&&w.value.id===_){const te=N.find(me=>me.id===_);te&&(w.value=te)}}),Fe.value=!0,pt.value="Joueur mis à jour avec succès !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de l'édition du joueur"),alert("Erreur lors de l'édition du joueur. Veuillez réessayer.")}}async function cr(){try{await Promise.all([_d(o.value),co(et.value,qe.value,o.value),ho(o.value)]).then(([_,m,N])=>{if(et.value=_,Gt.value=m,at.value=N,xl(),w.value){const J=_.find(ie=>ie.id===w.value.id);J&&(w.value=J)}}),Fe.value=!0,pt.value="Données mises à jour !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors du rafraîchissement")}}function aa(_){if(!_)return{availability:0,selection:0,ratio:0};const m=ds(_.name),N=Js(_.name),J=m===0?0:Math.round(N/m*100);return{availability:m,selection:N,ratio:J}}function fs(_){const m=at.value[_]||[],N=qe.value.find(te=>te.id===_),J=(N==null?void 0:N.playerCount)||6,ie=eo(_);if(m.length>0){const te=m.some(Ve=>!nr(Ve,_)),me=ie<J;if(te||me)return{type:"incomplete",hasUnavailablePlayers:te,hasInsufficientPlayers:me,unavailablePlayers:m.filter(Ve=>!nr(Ve,_)),availableCount:ie,requiredCount:J}}return ie<J?{type:"insufficient",availableCount:ie,requiredCount:J}:m.length===0?{type:"ready",availableCount:ie,requiredCount:J}:{type:"complete",availableCount:ie,requiredCount:J}}function ex(_){const m=fs(_);return m.type==="incomplete"||m.type==="insufficient"}function sf(_){const m=fs(_);switch(m.type){case"incomplete":return m.hasUnavailablePlayers?m.unavailablePlayers.length===1?`Sélection incomplète : ${m.unavailablePlayers[0]} n'est plus disponible`:`Sélection incomplète : ${m.unavailablePlayers.length} joueurs ne sont plus disponibles`:`Sélection incomplète : ${m.availableCount} joueurs disponibles pour ${m.requiredCount} requis`;case"insufficient":return`Pas assez de joueurs : ${m.availableCount} disponibles pour ${m.requiredCount} requis`;case"ready":return`Prêt pour la sélection : ${m.availableCount} joueurs disponibles`;case"complete":return`Sélection complète : ${m.availableCount} joueurs disponibles`;default:return""}}async function tx(){const _=[];for(const m of et.value){if(!await Ei(m.id,o.value))continue;const J=await _T(m.id,o.value);J&&_.push({...m,email:J})}return _}function Fc(_){if(_!=null&&_.archived){Fe.value=!0,pt.value="Impossible d'annoncer un événement archivé",setTimeout(()=>{Fe.value=!1},3e3);return}Gg(),Ze.value=_,He.value=!0;try{const m=new URLSearchParams(window.location.search);m.set("modal","announce"),m.set("event",(_==null?void 0:_.id)||""),history.replaceState(null,"",`${window.location.pathname}?${m.toString()}`)}catch{}}function nx(){He.value=!1,Ze.value=null;try{const _=new URLSearchParams(window.location.search);_.get("modal")==="announce"&&(_.delete("modal"),_.delete("event"),history.replaceState(null,"",`${window.location.pathname}?${_.toString()}`))}catch{}}function Gg(){Yt.value=!1,Bt.value=null}const of=k(!1);async function Hg({eventId:_,eventData:m,reason:N,selectedPlayers:J,scope:ie="all",recipient:te=null}){of.value=!0;try{N==="selection"?(ie==="single"&&(te!=null&&te.email)?await X_({eventId:_,eventData:m,selectedPlayers:[te.name],seasonId:o.value,seasonSlug:s,players:tn.value}):await X_({eventId:_,eventData:m,selectedPlayers:J,seasonId:o.value,seasonSlug:s,players:tn.value}),Fe.value=!0,pt.value=ie==="single"?`Notification envoyée à ${(te==null?void 0:te.name)||"1 joueur"}`:"Notifications de sélection envoyées à tous les joueurs sélectionnés !",setTimeout(()=>{Fe.value=!1},3e3)):(ie==="single"&&(te!=null&&te.email)?await Y_({eventId:_,eventData:m,players:[te],seasonId:o.value,seasonSlug:s,createMagicLink:Fp,reminder:!1,getAvailabilityForEvent:(me,Ve)=>nr(me,Ve)}):await Y_({eventId:_,eventData:m,players:await tx(),seasonId:o.value,seasonSlug:s,createMagicLink:Fp,reminder:!1,getAvailabilityForEvent:(me,Ve)=>nr(me,Ve)}),Fe.value=!0,pt.value=ie==="single"?`Notification envoyée à ${(te==null?void 0:te.name)||"1 joueur"}`:"Notifications envoyées à tous les joueurs protégés !",setTimeout(()=>{Fe.value=!1},3e3))}catch{console.error("Erreur lors de l'envoi des notifications"),Fe.value=!0,pt.value="Erreur lors de l'envoi des notifications",setTimeout(()=>{Fe.value=!1},3e3)}of.value=!1}function af(_){if(!_)return{};const m={};return et.value.forEach(N=>{m[N.name]=nr(N.name,_)}),m}function Nl(_){if(_!=null&&_.archived){Fe.value=!0,pt.value="Impossible d'ouvrir la sélection sur un événement archivé",setTimeout(()=>{Fe.value=!1},3e3);return}De.value=_,Pe.value=!0;try{const m=new URLSearchParams(window.location.search);m.set("modal","selection"),m.set("event",(_==null?void 0:_.id)||""),history.replaceState(null,"",`${window.location.pathname}?${m.toString()}`)}catch{}}function Wg(){Pe.value=!1,De.value=null;try{const _=new URLSearchParams(window.location.search);_.get("modal")==="selection"&&(_.delete("modal"),_.delete("event"),history.replaceState(null,"",`${window.location.pathname}?${_.toString()}`))}catch{}}async function rx(){if(!De.value)return;const _=De.value.id,m=De.value.playerCount||6;if(eo(_)===0){Fe.value=!0,pt.value="Aucun joueur disponible pour cet événement",setTimeout(()=>{Fe.value=!1},3e3);return}await Xs({type:"launchSelection",data:{eventId:_,count:m}})}function sx(){Wg(),Fe.value=!0,pt.value="Sélection validée !",setTimeout(()=>{Fe.value=!1},3e3)}async function ix(_){if(!_||!_.eventId)return;const{eventId:m,players:N}=_;await Xs({type:"updateSelection",data:{eventId:m,players:N}})}async function lf(_,m){if(!_||!m)return;Jg(),Cr.value=_,qs.value=!0,await fn();const N=document.querySelector(`[data-event-id="${_}"]`);if(!N){console.warn("Élément événement non trouvé dans le DOM");return}document.querySelectorAll(".focused-event-highlight").forEach(me=>{me.classList.remove("focused-event-highlight")});const J=document.querySelectorAll(`[data-event-id="${_}"]`);J.forEach(me=>{me.classList.add("focused-event-highlight")});const ie=J[0],te=J[J.length-1];ie&&ie.classList.add("focused-event-column-start"),te&&te.classList.add("focused-event-column-end"),await ox(N),Fe.value=!0,pt.value=`Événement ciblé : ${m.title}`,setTimeout(()=>{Fe.value=!1},4e3),Ki.value=setTimeout(()=>{Jg()},8e3)}function Qg(_){if(!_)return;const m=qe.value.find(N=>N.id===_);if(!m){console.warn("Événement non trouvé dans la liste des événements"),setTimeout(()=>{const N=qe.value.find(J=>J.id===_);N?lf(_,N):console.error("Événement toujours introuvable après retry")},500);return}lf(_,m)}xt(qe,_=>{try{const m=new URLSearchParams(window.location.search),N=m.get("modal"),J=m.get("event");if(!N||!J)return;const ie=_.find(te=>te.id===J);if(!ie)return;N==="announce"&&Fc(ie),N==="selection"&&Nl(ie)}catch{}},{immediate:!0});async function ox(_){if(!_)return;if(await new Promise(N=>setTimeout(N,100)),window.innerWidth<=768){const N=kn.value;if(N){const J=_.offsetLeft,ie=_.offsetWidth,te=N.clientWidth,me=J-te/2+ie/2,Ve=N.scrollWidth-te,We=Math.max(0,Math.min(me,Ve));N.scrollTo({left:We,behavior:"smooth"}),setTimeout(()=>{const tt=_.getBoundingClientRect();if(tt.left<0||tt.right>window.innerWidth){const mt=J-20;N.scrollTo({left:Math.max(0,mt),behavior:"smooth"})}},500)}}else _.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});const m=kn.value;m&&setTimeout(()=>{const N=document.querySelector(`[data-event-id="${Cr.value}"]`);if(N&&N.closest("tbody")){const J=N.offsetLeft,ie=N.offsetWidth,te=m.clientWidth,me=J-te/2+ie/2,Ve=m.scrollWidth-te,We=Math.max(0,Math.min(me,Ve));m.scrollTo({left:We,behavior:"smooth"})}},300)}function Jg(){Ki.value&&(clearTimeout(Ki.value),Ki.value=null),Cr.value=null,qs.value=!1,document.querySelectorAll(".focused-event-highlight").forEach(_=>{_.classList.remove("focused-event-highlight")}),document.querySelectorAll(".focused-event-column-start, .focused-event-column-end").forEach(_=>{_.classList.remove("focused-event-column-start","focused-event-column-end")})}return(_,m)=>{var N,J,ie,te,me,Ve,We,tt,mt,Ht,nn,ut,Nn,dr,Vr,ti,Yg,Xg,Zg,ev,tv,nv;return L(),F(dt,null,[h("div",F$,[h("div",$$,[h("button",{onClick:p,class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Retour à l'accueil"},m[70]||(m[70]=[h("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),h("h1",U$,le(i.value?i.value:"Chargement..."),1),h("div",j$,[h("div",B$,[h("button",{onClick:qi,class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Mon compte","aria-label":"Mon compte"},m[71]||(m[71]=[h("span",{class:"text-2xl"},"👤",-1)])),h("button",{onClick:m[0]||(m[0]=Q=>_n.value=!0),class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Kezako ?","aria-label":"Kezako ?"},m[72]||(m[72]=[h("span",{class:"text-2xl"},"❓",-1)]))]),h("div",{class:"relative md:hidden",ref_key:"headerMenuRef",ref:ls},[h("button",{onClick:m[1]||(m[1]=Ft(Q=>{Ic(),El()},["stop"])),class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Menu","aria-label":"Menu"},m[73]||(m[73]=[h("span",{class:"text-2xl"},"⋯",-1)]))],512),(L(),Ad(Zx,{to:"body"},[vr.value?(L(),F("div",{key:0,ref_key:"headerMenuDropdownRef",ref:Br,class:"w-48 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[400] overflow-hidden",style:ys(Wo.value)},[h("button",{onClick:m[2]||(m[2]=Q=>{qi(),Qo()}),class:"w-full text-left px-4 py-3 text-white hover:bg-white/10 flex items-center gap-2"},m[74]||(m[74]=[h("span",null,"👤",-1),h("span",{class:"text-sm"},"Mon compte",-1)])),h("button",{onClick:m[3]||(m[3]=Q=>{_n.value=!0,Qo()}),class:"w-full text-left px-4 py-3 text-white hover:bg-white/10 flex items-center gap-2"},m[75]||(m[75]=[h("span",null,"❓",-1),h("span",{class:"text-sm"},"Kezako ?",-1)]))],4)):ge("",!0)]))])],512),h("div",q$,[h("div",{ref_key:"headerBarRef",ref:Ks,class:"sticky top-0 z-[80] bg-gray-900 overflow-hidden"},[h("div",z$,[qe.value.length===0&&et.value.length===0?ge("",!0):(L(),F("div",K$,[h("div",{class:"flex items-center justify-center h-full gap-2"},[h("button",{onClick:kr,class:"flex items-center space-x-2 px-3 py-2 md:px-4 md:py-2 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl text-sm md:text-base font-medium",title:"Ajouter un nouvel événement"},m[76]||(m[76]=[h("span",{class:"text-lg"},"➕",-1),h("span",{class:"hidden sm:inline"},"Ajouter un événement",-1),h("span",{class:"sm:hidden"},"Événement",-1)]))])])),h("div",G$,[h("div",{ref_key:"headerEventsRef",ref:zn,class:"flex relative z-[60]",style:ys({transform:`translateX(-${bl.value}px)`})},[(L(!0),F(dt,null,wr(Dn.value,Q=>(L(),F("div",{key:"h-"+Q.id,"data-event-id":Q.id,class:Tt(["col-event flex-shrink-0 p-3 text-center cursor-pointer",{"archived-header":Q.archived}]),onClick:Vn=>v(Q)},[h("div",{class:"header-date text-[16px] md:text-base text-gray-300",title:Rl(Q.date)},le(Nr(Q.date)),9,W$),h("div",{class:"header-title text-[22px] md:text-2xl leading-snug text-white text-center clamp-2",title:Q.title},le(Q.title||"Sans titre"),9,Q$),Q.archived?(L(),F("div",J$,"(Archivé)")):ge("",!0),ex(Q.id)?(L(),F("div",{key:1,class:"mt-1 w-4 h-4 bg-yellow-500 rounded-full mx-auto flex items-center justify-center hover:bg-yellow-400 transition-colors duration-200",title:sf(Q.id)+" - Cliquez pour ouvrir la sélection",onClick:Ft(Vn=>Nl(Q),["stop"])},m[77]||(m[77]=[h("span",{class:"text-xs text-white font-bold"},"⚠️",-1)]),8,Y$)):fs(Q.id).type==="ready"?(L(),F("div",{key:2,class:"mt-1 w-4 h-4 bg-green-500 rounded-full mx-auto flex items-center justify-center hover:bg-green-400 transition-colors duration-200",title:sf(Q.id)+" - Cliquez pour ouvrir la sélection",onClick:Ft(Vn=>Nl(Q),["stop"])},m[78]||(m[78]=[h("span",{class:"text-xs text-white font-bold"},"🎲",-1)]),8,X$)):ge("",!0)],10,H$))),128))],4)]),m[81]||(m[81]=h("div",{class:"col-right flex-shrink-0 p-3 sticky right-0 z-[81] bg-gray-900 h-full"},null,-1)),h("button",{onClick:Tc,class:"absolute right-2 top-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[86] backdrop-blur-sm",title:Dr.value?"Masquer les événements archivés":"Afficher les événements archivés","aria-label":Dr.value?"Masquer les événements archivés":"Afficher les événements archivés"},[(L(),F("svg",e6,[m[79]||(m[79]=h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.25 12c1.5-4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z"},null,-1)),m[80]||(m[80]=h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)),Dr.value?ge("",!0):(L(),F("path",t6))]))],8,Z$),nt(h("button",{onClick:m[4]||(m[4]=Ft(Q=>Go(-1,Q),["prevent"])),onMousedown:m[5]||(m[5]=Ft(Q=>Gs(-1,Q),["prevent"])),onMouseup:m[6]||(m[6]=Q=>gr(Q)),onMouseleave:m[7]||(m[7]=Q=>gr(Q)),onTouchstart:m[8]||(m[8]=Ft(Q=>Gs(-1,Q),["prevent"])),onTouchend:m[9]||(m[9]=Q=>gr(Q)),onTouchcancel:m[10]||(m[10]=Q=>gr(Q)),class:"absolute left-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"Événements précédents — cliquez pour défiler"}," ‹ ",544),[[vf,zs.value]]),nt(h("button",{onClick:m[11]||(m[11]=Ft(Q=>Go(1,Q),["prevent"])),onMousedown:m[12]||(m[12]=Ft(Q=>Gs(1,Q),["prevent"])),onMouseup:m[13]||(m[13]=Q=>gr(Q)),onMouseleave:m[14]||(m[14]=Q=>gr(Q)),onTouchstart:m[15]||(m[15]=Ft(Q=>Gs(1,Q),["prevent"])),onTouchend:m[16]||(m[16]=Q=>gr(Q)),onTouchcancel:m[17]||(m[17]=Q=>gr(Q)),class:"absolute right-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"Événements suivants — cliquez pour défiler"}," › ",544),[[vf,bc.value]])])],512),nt(h("div",{ref_key:"gridboardRef",ref:kn,class:"gridboard overflow-x-auto bg-gradient-to-br from-blue-900/50 via-purple-900/50 to-indigo-900/50"},[Ae.value===1?(L(),F("div",n6,[M.value.position?(L(),F("div",{key:0,class:"fixed z-[400]",style:ys({left:M.value.position.x+"px",top:M.value.position.y+"px"})},[h("div",{id:"coachmark-add",class:Tt(["coachmark pointer-events-auto max-w-sm bg-gray-900 border border-purple-500/40 rounded-xl shadow-2xl p-3 text-white relative",{"coachmark-right":M.value.side==="right","coachmark-left":M.value.side==="left"}])},[m[83]||(m[83]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Ajoutez votre nom",-1)),m[84]||(m[84]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},'Cliquez sur "Ajouter un joueur" pour vous inscrire',-1)),h("div",r6,[m[82]||(m[82]=h("span",{class:"text-purple-300 text-base md:text-sm"},"Étape 1/4",-1)),h("button",{onClick:m[18]||(m[18]=Q=>ra(0)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant >")])],2)],4)):ge("",!0)])):ge("",!0),Ae.value===2&&U.value&&q.value?(L(),F("div",s6,[z.value.position?(L(),F("div",{key:0,class:"fixed z-[400]",style:ys({position:"absolute",left:z.value.position.x+"px",top:z.value.position.y+"px"})},[h("div",i6,[m[86]||(m[86]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Indiquez vos disponibilités",-1)),m[87]||(m[87]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},"Cliquez cette case pour alterner Oui / Non / Vide",-1)),h("div",o6,[m[85]||(m[85]=h("span",{class:"text-pink-300 text-base md:text-sm"},"Étape 2/4",-1)),h("button",{onClick:m[19]||(m[19]=Q=>ra(1)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant")])])],4)):ge("",!0)])):ge("",!0),Ae.value===3&&U.value?(L(),F("div",a6,[he.value.position?(L(),F("div",{key:0,class:"fixed z-[400]",style:ys({position:"absolute",left:he.value.position.x+"px",top:he.value.position.y+"px"})},[h("div",l6,[m[89]||(m[89]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Ouvrez votre fiche",-1)),m[90]||(m[90]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},"Cliquez sur votre nom pour voir les détails et la protection",-1)),h("div",u6,[m[88]||(m[88]=h("span",{class:"text-yellow-300 text-base md:text-sm"},"Étape 3/4",-1)),h("button",{onClick:m[20]||(m[20]=Q=>ra(2)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant")])])],4)):ge("",!0)])):ge("",!0),h("table",c6,[h("colgroup",null,[m[91]||(m[91]=h("col",{class:"col-left"},null,-1)),(L(!0),F(dt,null,wr(Dn.value,(Q,Vn)=>(L(),F("col",{key:"c"+Vn,class:"col-event"}))),128)),m[92]||(m[92]=h("col",{class:"col-right"},null,-1))]),m[96]||(m[96]=h("thead",{class:"hidden"},null,-1)),h("tbody",null,[(L(!0),F(dt,null,wr(Gn.value,Q=>{var Vn;return L(),F("tr",{key:Q.id,class:Tt(["border-b border-white/10 hover:bg-white/5 transition-all duration-200",{"highlighted-player":Q.id===P.value,"preferred-player":ta.value.has(Q.id)}]),"data-player-id":Q.id},[h("td",h6,[h("div",f6,[Wi(Q.id)?(L(),F("span",p6," 🔒 ")):ge("",!0),h("span",{onClick:rr=>dn(Q),class:Tt(["player-name hover:border-b-2 hover:border-dashed hover:border-purple-400 cursor-pointer transition-colors duration-200 text-[22px] md:text-2xl leading-tight block truncate max-w-full flex-1 min-w-0",{"inline-block rounded px-1 ring-2 ring-yellow-400 animate-pulse":Ae.value===3&&Q.id===(U.value||((Vn=Gn.value[0])==null?void 0:Vn.id))}]),title:"Cliquez pour voir les détails : "+Q.name},le(Q.name),11,m6)])]),(L(!0),F(dt,null,wr(Dn.value,rr=>{var rv,sv,iv;return L(),F("td",{key:rr.id,"data-event-id":rr.id,class:Tt(["p-0",rr.archived?"archived-col":"",{"relative ring-2 ring-pink-400 rounded-md animate-pulse":Ae.value===2&&Q.id===(U.value||((rv=Gn.value[0])==null?void 0:rv.id))&&rr.id===(q.value||((sv=Dn.value[0])==null?void 0:sv.id))}])},[ct(Z_,{"player-name":Q.name,"event-id":rr.id,"is-available":nr(Q.name,rr.id),"is-selected":Ac(Q.name,rr.id),"chance-percent":((iv=Al.value[Q.name])==null?void 0:iv[rr.id])??null,"show-selected-chance":to(rr.id),disabled:rr.archived===!0,onToggle:na},null,8,["player-name","event-id","is-available","is-selected","chance-percent","show-selected-chance","disabled"])],10,g6)}),128)),m[93]||(m[93]=h("td",{class:"p-3 md:p-4"},null,-1))],10,d6)}),128)),h("tr",v6,[h("td",y6,[h("div",_6,[h("button",{onClick:m[21]||(m[21]=Q=>T.value=!0),class:"w-full md:w-auto flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 text-sm md:text-base font-medium",title:"Ajouter un nouveau joueur","data-onboarding":"add-player"},m[94]||(m[94]=[h("span",{class:"text-lg"},"➕",-1),h("span",{class:"hidden sm:inline"},"Ajouter un joueur",-1),h("span",{class:"sm:hidden"},"Joueur",-1)]))])]),(L(!0),F(dt,null,wr(Dn.value,Q=>(L(),F("td",{key:"add-row-"+Q.id,"data-event-id":Q.id,class:Tt(["p-3 md:p-5",Q.archived?"archived-col":""])},null,10,b6))),128)),m[95]||(m[95]=h("td",{class:"p-3 md:p-4"},null,-1))])])])],512),[[vf,!er.value]])])]),er.value?(L(),F("div",w6,[h("div",I6,[m[97]||(m[97]=h("div",{class:"w-20 h-20 rounded-full bg-gradient-to-br from-pink-500 to-purple-600 animate-pulse mx-auto mb-6 flex items-center justify-center shadow-2xl"},[h("span",{class:"text-3xl"},"🎭")],-1)),h("p",E6,le(Rr.value)+"…",1),h("div",T6,[h("div",{class:"h-full bg-gradient-to-r from-pink-500 to-purple-600 transition-all duration-300",style:ys({width:Pr.value+"%"})},null,4)]),h("p",x6,le(Pr.value)+"%",1)])])):ge("",!0),er.value?ge("",!0):(L(),Ad(f4,{key:1,"season-id":o.value,"season-slug":Xr(s),"players-count":et.value.length,"events-count":qe.value.length,"onboarding-done":((N=a.value)==null?void 0:N.onboardingCreatorDone)===!0,onCreateEvent:kr,onAddPlayer:m[22]||(m[22]=()=>{T.value=!0}),onCopyLink:us,onDismissed:_l},null,8,["season-id","season-slug","players-count","events-count","onboarding-done"])),ge("",!0),Fe.value?(L(),F("div",A6,[h("div",S6,[m[98]||(m[98]=h("span",{class:"text-xl"},"✨",-1)),h("span",null,le(pt.value),1)])])):ge("",!0),yr.value?(L(),F("div",P6,[h("div",R6,[m[99]||(m[99]=h("span",{class:"text-xl"},"⚠️",-1)),h("span",null,le(Qi.value),1)])])):ge("",!0),zr.value?(L(),F("div",C6,[h("div",k6,[m[105]||(m[105]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvel événement",-1)),h("div",D6,[m[100]||(m[100]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),nt(h("input",{"onUpdate:modelValue":m[23]||(m[23]=Q=>br.value=Q),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Titre de l'événement"},null,512),[[kt,br.value]])]),h("div",N6,[m[101]||(m[101]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),nt(h("input",{"onUpdate:modelValue":m[24]||(m[24]=Q=>Ws.value=Q),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white"},null,512),[[kt,Ws.value]])]),h("div",V6,[m[102]||(m[102]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),nt(h("textarea",{"onUpdate:modelValue":m[25]||(m[25]=Q=>Qs.value=Q),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)"},null,512),[[kt,Qs.value]])]),h("div",O6,[nt(h("input",{id:"new-archived",type:"checkbox","onUpdate:modelValue":m[26]||(m[26]=Q=>ea.value=Q),class:"w-4 h-4"},null,512),[[vi,ea.value]]),m[103]||(m[103]=h("label",{for:"new-archived",class:"text-sm font-medium text-gray-300"},"Créer comme archivé",-1))]),h("div",M6,[m[104]||(m[104]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),nt(h("input",{"onUpdate:modelValue":m[27]||(m[27]=Q=>Ji.value=Q),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",placeholder:"6"},null,512),[[kt,Ji.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:Yi,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:ef,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Créer ")])])])):ge("",!0),T.value?(L(),F("div",L6,[h("div",F6,[m[107]||(m[107]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouveau joueur",-1)),h("div",$6,[m[106]||(m[106]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),nt(h("input",{"onUpdate:modelValue":m[28]||(m[28]=Q=>A.value=Q),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nom du joueur"},null,512),[[kt,A.value]])]),h("div",U6,[h("button",{onClick:m[29]||(m[29]=Q=>T.value=!1),class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:St,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ajouter ")])])])):ge("",!0),l.value?(L(),F("div",j6,[h("div",B6,[m[108]||(m[108]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer cet événement ?</p></div>',1)),h("div",q6,[h("button",{onClick:Xo,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:m[30]||(m[30]=()=>Yo()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):ge("",!0),no.value?(L(),F("div",z6,[h("div",K6,[m[109]||(m[109]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer ce joueur ?</p></div>',1)),h("div",G6,[h("button",{onClick:Cl,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{onClick:m[31]||(m[31]=()=>Cc()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"Supprimer")])])])):ge("",!0),pe.value?(L(),F("div",H6,[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},[m[110]||(m[110]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🎭</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Attention, toute la sélection sera refaite en fonction des disponibilités actuelles.</p></div><p class="mb-6 text-sm text-yellow-400 bg-yellow-900/20 p-3 rounded-lg border border-yellow-500/20"> ⚠️ Pensez à prévenir les gens du changement ! </p>',2)),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:oa,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{onClick:kc,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"},"Confirmer")])])])):ge("",!0),S.value?(L(),F("div",{key:10,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:b},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:m[42]||(m[42]=Ft(()=>{},["stop"]))},[h("div",W6,[h("button",{onClick:b,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),m[111]||(m[111]=h("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[h("span",{class:"text-2xl md:text-3xl"},"🎭")],-1)),h("h2",Q6,le((J=O.value)==null?void 0:J.title),1),h("p",J6,le(Rl((ie=O.value)==null?void 0:ie.date)),1)]),h("div",Y6,[(te=O.value)!=null&&te.description?(L(),F("div",X6,[h("p",Z6,le(O.value.description),1)])):ge("",!0),h("div",eU,[h("div",tU,[h("div",nU,le(eo((me=O.value)==null?void 0:me.id)),1),m[112]||(m[112]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibles",-1))]),h("div",rU,[h("div",sU,le(Ys((Ve=O.value)==null?void 0:Ve.id)),1),m[113]||(m[113]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Sélectionnés",-1))]),h("div",iU,[h("div",oU,le(Math.max((((We=O.value)==null?void 0:We.playerCount)||6)-Ys((tt=O.value)==null?void 0:tt.id),0)),1),m[114]||(m[114]=h("div",{class:"text-xs md:text-sm text-yellow-300"},"manquants",-1))])]),O.value?(L(),F("div",aU,[h("div",lU,[Sl.value?(L(),F("div",{key:0,class:Tt(["flex items-center gap-2 px-2 py-1 rounded-md border text-[11px] md:text-xs max-w-[70%] truncate",((mt=xc.value)==null?void 0:mt.type)==="incomplete"?"bg-yellow-500/10 border-yellow-500/30 text-yellow-200":"bg-orange-500/10 border-orange-500/30 text-orange-200"]),title:Lt.value},[m[115]||(m[115]=h("span",null,"⚠️",-1)),h("span",cU,le(Lt.value),1)],10,uU)):ge("",!0),nt(h("select",{"onUpdate:modelValue":m[32]||(m[32]=Q=>cs.value=Q),class:"ml-auto bg-gray-800 text-white rounded-md px-3 py-2 border border-white/10 focus:outline-none text-sm",title:"Filtrer les joueurs par statut"},m[116]||(m[116]=[Jn('<option value="selected">Sélectionnés</option><option value="available">Disponibles</option><option value="unavailable">Non Disponibles</option><option value="unknown">Pas de réponse</option><option value="all">Tous</option>',5)]),512),[[bS,cs.value]])]),h("div",dU,[(L(!0),F(dt,null,wr(Xi.value,Q=>{var Vn,rr;return L(),F("div",{key:Q.id,class:"flex items-center justify-between px-2 py-1.5 rounded-md hover:bg-gray-800/40 transition-colors"},[h("div",hU,[Wi(Q.id)?(L(),F("span",fU," 🔒 ")):ge("",!0),h("span",{class:"text-white text-sm md:text-base block truncate max-w-full flex-1 min-w-0",title:Q.name},le(Q.name),9,pU)]),h("div",mU,[ct(Z_,{"player-name":Q.name,"event-id":O.value.id,"is-available":af(O.value.id)[Q.name],"is-selected":Ie(Q.name,O.value.id),"chance-percent":((Vn=Al.value[Q.name])==null?void 0:Vn[O.value.id])??null,"show-selected-chance":to(O.value.id),disabled:((rr=O.value)==null?void 0:rr.archived)===!0,compact:!0,onToggle:W},null,8,["player-name","event-id","is-available","is-selected","chance-percent","show-selected-chance","disabled"])])])}),128))])])):ge("",!0),h("div",gU,[h("button",{onClick:cn,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},m[117]||(m[117]=[h("span",null,"✏️",-1),h("span",null,"Modifier",-1)])),h("button",{onClick:m[33]||(m[33]=Q=>Fc(O.value)),disabled:(Ht=O.value)==null?void 0:Ht.archived,class:"px-5 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-lg hover:from-amber-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600",title:(nn=O.value)!=null&&nn.archived?"Impossible d'annoncer un événement archivé":"Annoncer l'événement aux joueurs (email, copie, WhatsApp)"},m[118]||(m[118]=[h("span",null,"📢",-1),h("span",null,"Annoncer",-1)]),8,vU),h("button",{onClick:lt,class:"px-5 py-3 bg-gradient-to-r from-indigo-500 to-blue-600 text-white rounded-lg hover:from-indigo-600 hover:to-blue-700 transition-all duration-300 flex items-center gap-2",title:(ut=O.value)!=null&&ut.archived?"Désarchiver cet événement":"Archiver cet événement"},[h("span",null,le((Nn=O.value)!=null&&Nn.archived?"📂":"📁"),1),h("span",null,le((dr=O.value)!=null&&dr.archived?"Désarchiver":"Archiver"),1)],8,yU),h("button",{onClick:m[34]||(m[34]=Q=>Nl(O.value)),class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center gap-2",title:"Gérer la sélection"},m[119]||(m[119]=[h("span",null,"🎭",-1),h("span",null,"Sélectionner",-1)])),h("button",{onClick:m[35]||(m[35]=Q=>{var Vn;return _r((Vn=O.value)==null?void 0:Vn.id)}),class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},m[120]||(m[120]=[h("span",null,"🗑️",-1),h("span",null,"Supprimer",-1)])),h("button",{onClick:K,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer")]),ae.value?(L(),F("div",_U,[h("button",{onClick:m[36]||(m[36]=Q=>{cn(),ae.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"},"✏️ Modifier"),h("button",{onClick:m[37]||(m[37]=Q=>{Fc(O.value),ae.value=!1}),disabled:(Vr=O.value)==null?void 0:Vr.archived,class:"w-full px-4 py-3 rounded-lg bg-amber-600/20 text-amber-200 border border-amber-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600",title:(ti=O.value)!=null&&ti.archived?"Impossible d'annoncer un événement archivé":"Annoncer l'événement aux joueurs (email, copie, WhatsApp)"},m[121]||(m[121]=[h("span",null,"📢",-1),h("span",null,"Annoncer",-1)]),8,bU),h("button",{onClick:m[38]||(m[38]=Q=>{lt(),ae.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-indigo-600/20 text-indigo-200 border border-indigo-500/30"},le((Yg=O.value)!=null&&Yg.archived?"📂 Désarchiver":"📁 Archiver"),1),h("button",{onClick:m[39]||(m[39]=Q=>{var Vn;_r((Vn=O.value)==null?void 0:Vn.id),ae.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"},"🗑️ Supprimer")])):ge("",!0)]),h("div",wU,[h("button",{onClick:m[40]||(m[40]=Q=>Nl(O.value)),class:"h-12 px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex-[1.4]"},"🎭 Sélectionner"),h("button",{onClick:K,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"},"Fermer"),h("button",{onClick:m[41]||(m[41]=Q=>ae.value=!ae.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"},"⋯")])])])):ge("",!0),ct(Fg,{show:be.value,player:ve.value,seasonId:o.value,onClose:m[43]||(m[43]=Q=>be.value=!1),onVerified:It},null,8,["show","player","seasonId"]),d.value?(L(),F("div",IU,[h("div",EU,[m[127]||(m[127]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Modifier l'événement",-1)),h("div",TU,[m[122]||(m[122]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),nt(h("input",{"onUpdate:modelValue":m[44]||(m[44]=Q=>f.value=Q),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Mn(qr,["esc"]),Mn(Zo,["enter"])],ref:"editTitleInput"},null,544),[[kt,f.value]])]),h("div",xU,[m[123]||(m[123]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),nt(h("input",{"onUpdate:modelValue":m[45]||(m[45]=Q=>g.value=Q),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:[Mn(qr,["esc"]),Mn(Zo,["enter"])]},null,544),[[kt,g.value]])]),h("div",AU,[m[124]||(m[124]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),nt(h("textarea",{"onUpdate:modelValue":m[46]||(m[46]=Q=>oe.value=Q),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)",onKeydown:Mn(qr,["esc"])},null,544),[[kt,oe.value]])]),h("div",SU,[nt(h("input",{id:"edit-archived",type:"checkbox","onUpdate:modelValue":m[47]||(m[47]=Q=>Z.value=Q),class:"w-4 h-4"},null,512),[[vi,Z.value]]),m[125]||(m[125]=h("label",{for:"edit-archived",class:"text-sm font-medium text-gray-300"},"Archiver cet événement",-1))]),h("div",PU,[m[126]||(m[126]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),nt(h("input",{"onUpdate:modelValue":m[48]||(m[48]=Q=>y.value=Q),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:Mn(qr,["esc"])},null,544),[[kt,y.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:qr,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Zo,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):ge("",!0),ct(nT,{show:V.value,message:Dc(),error:R.value,"session-info":Zs(),onSubmit:Nc,onCancel:Vc},null,8,["show","message","error","session-info"]),wt.value?(L(),F("div",RU,[h("div",CU,[m[129]||(m[129]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-2">Vérification requise</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protégé par mot de passe</p></div>',1)),h("div",kU,[h("div",DU,[h("div",null,[m[128]||(m[128]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),nt(h("input",{"onUpdate:modelValue":m[49]||(m[49]=Q=>j.value=Q),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:m[50]||(m[50]=Mn(Q=>Dl(j.value),["enter"])),ref_key:"playerPasswordInputRef",ref:Ke},null,544),[[kt,j.value]])])]),h("button",{onClick:m[51]||(m[51]=Q=>Dl(j.value)),disabled:!j.value||ne.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[ne.value?(L(),F("span",VU,"⏳")):(L(),F("span",OU,"🔓")),h("span",null,le(ne.value?"Vérification...":"Vérifier et supprimer"),1)],8,NU)]),h("div",MU,[h("button",{onClick:m[52]||(m[52]=Q=>se.value=!0),class:"text-sm text-red-400 hover:text-red-300 transition-colors underline"}," Mot de passe oublié ? ")]),Y.value?(L(),F("div",LU,[h("div",FU,le(Y.value),1)])):ge("",!0),h("div",{class:"flex justify-center"},[h("button",{onClick:Oc,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):ge("",!0),Be.value?(L(),F("div",$U,[h("div",UU,[m[132]||(m[132]=Jn('<div class="text-center p-6 pb-4 border-b border-white/10"><div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-1">Vérification requise</h2><p class="text-base text-gray-300">Modification de disponibilité</p><p class="text-sm text-gray-400 mt-1">Ce joueur est protégé par mot de passe</p></div>',1)),h("div",jU,[h("div",BU,[h("div",null,[m[130]||(m[130]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),nt(h("input",{"onUpdate:modelValue":m[53]||(m[53]=Q=>ee.value=Q),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:m[54]||(m[54]=Mn(Q=>ro(ee.value),["enter"])),ref_key:"availabilityPasswordInputRef",ref:Xe},null,544),[[kt,ee.value]])])]),h("div",qU,[h("button",{onClick:m[55]||(m[55]=Q=>ht.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),re.value?(L(),F("div",zU,[h("div",KU,le(re.value),1)])):ge("",!0)]),h("div",GU,[h("button",{onClick:Hn,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300 flex-1 text-sm md:text-base whitespace-nowrap"}," Annuler "),h("button",{onClick:m[56]||(m[56]=Q=>ro(ee.value)),disabled:!ee.value||je.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 flex-1 text-sm md:text-base whitespace-nowrap"},[je.value?(L(),F("span",WU,"⏳")):(L(),F("span",QU,"🔓")),h("span",null,[Dt(le(je.value?"Vérification...":"Vérifier"),1),m[131]||(m[131]=h("span",{class:"hidden sm:inline"}," et modifier",-1))])],8,HU)])])])):ge("",!0),ht.value?(L(),F("div",{key:14,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:m[59]||(m[59]=Q=>ht.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:m[58]||(m[58]=Ft(()=>{},["stop"]))},[m[134]||(m[134]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Modification de disponibilité</p></div>',1)),h("div",JU,[m[133]||(m[133]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),h("button",{onClick:Mc,disabled:D.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[D.value?(L(),F("span",XU,"⏳")):(L(),F("span",ZU,"📧")),h("span",null,le(D.value?"Envoi...":"Envoyer l'email"),1)],8,YU)]),$.value?(L(),F("div",e5,[h("div",t5,le($.value),1)])):ge("",!0),X.value?(L(),F("div",n5,[h("div",r5,le(X.value),1)])):ge("",!0),h("div",s5,[h("button",{onClick:m[57]||(m[57]=Q=>ht.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ge("",!0),se.value?(L(),F("div",{key:15,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:m[62]||(m[62]=Q=>se.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:m[61]||(m[61]=Ft(()=>{},["stop"]))},[m[136]||(m[136]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p></div>',1)),h("div",i5,[m[135]||(m[135]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),h("button",{onClick:Lc,disabled:ke.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[ke.value?(L(),F("span",a5,"⏳")):(L(),F("span",l5,"📧")),h("span",null,le(ke.value?"Envoi...":"Envoyer l'email"),1)],8,o5)]),$e.value?(L(),F("div",u5,[h("div",c5,le($e.value),1)])):ge("",!0),E.value?(L(),F("div",d5,[h("div",h5,le(E.value),1)])):ge("",!0),h("div",f5,[h("button",{onClick:m[60]||(m[60]=Q=>se.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ge("",!0),ct(vF,{ref_key:"playerModalRef",ref:C,show:I.value,player:w.value,stats:aa(w.value),seasonId:o.value,"onboarding-step":Ae.value,"onboarding-player-id":U.value,onClose:gn,onUpdate:ei,onDelete:kl,onRefresh:cr,onAdvanceOnboarding:m[63]||(m[63]=Q=>{try{typeof Ae.value<"u"&&(Ae.value.value=Q)}catch{}})},null,8,["show","player","stats","seasonId","onboarding-step","onboarding-player-id"]),ct(e4,{ref_key:"selectionModalRef",ref:Le,show:Pe.value,event:De.value,"current-selection":at.value[(Xg=De.value)==null?void 0:Xg.id]||[],"available-count":eo((Zg=De.value)==null?void 0:Zg.id),"selected-count":Ys((ev=De.value)==null?void 0:ev.id),"player-availability":af((tv=De.value)==null?void 0:tv.id),"season-id":o.value,"season-slug":Xr(s),players:tn.value,onClose:Wg,onSelection:rx,onPerfect:sx,onSendNotifications:Hg,onUpdateSelection:ix},null,8,["show","event","current-selection","available-count","selected-count","player-availability","season-id","season-slug","players"]),ct(TT,{show:He.value,event:Ze.value,"season-id":o.value,"season-slug":Xr(s),players:tn.value,sending:of.value,"availability-by-player":af((nv=Ze.value)==null?void 0:nv.id),onClose:nx,onSendNotifications:Hg},null,8,["show","event","season-id","season-slug","players","sending","availability-by-player"]),ct(rT,{show:_n.value,onClose:m[64]||(m[64]=Q=>_n.value=!1)},null,8,["show"]),ct(S$,{show:Mt.value,"season-id":o.value,onClose:Cn,onManagePlayer:zi,onChangePassword:yl,onLogoutDevice:vc,onDeleteAccount:yc},null,8,["show","season-id"]),ct(xT,{show:mr.value,player:un.value,"season-id":o.value,onClose:m[65]||(m[65]=Q=>mr.value=!1),onSuccess:m[66]||(m[66]=()=>{mr.value=!1,Mt.value=!0})},null,8,["show","player","season-id"]),ct(L$,{show:Ur.value,onClose:m[67]||(m[67]=Q=>Ur.value=!1),onSuccess:m[68]||(m[68]=()=>{Ur.value=!1,Mt.value=!0})},null,8,["show"]),Yt.value?(L(),F("div",p5,[h("div",m5,[m[137]||(m[137]=h("h3",{class:"text-xl font-bold text-white mb-4 text-center"},"Voulez-vous annoncer cet événement ?",-1)),m[138]||(m[138]=h("p",{class:"text-gray-300 text-center mb-6"},"Envoyer des notifications aux joueurs pour qu'ils indiquent leur disponibilité",-1)),h("div",g5,[h("button",{onClick:m[69]||(m[69]=Q=>Fc(Bt.value)),class:"flex-1 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300"}," 📢 Oui "),h("button",{onClick:Gg,class:"flex-1 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all duration-300"}," Plus tard ")])])])):ge("",!0)],64)}}},v5={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},y5={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},_5={key:0,class:"text-center py-8"},b5={key:1,class:"text-center py-8"},w5={class:"text-gray-300 mb-6"},I5={key:2,class:"space-y-6"},E5={class:"text-center"},T5={class:"text-gray-300"},x5={class:"font-semibold text-white"},A5={class:"space-y-4"},S5=["disabled"],P5={key:0,class:"animate-spin"},R5={key:1},C5={key:0,class:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},k5={class:"text-red-300 text-sm"},D5={key:1,class:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},N5={class:"text-green-300 text-sm"},V5={__name:"PasswordReset",setup(n){const e=Za(),t=Wu(),r=k(!0),s=k(""),i=k(""),o=k(""),a=k(""),l=k(""),c=k(!1),d=k(""),f=k(""),g=Oe(()=>a.value&&l.value&&a.value===l.value&&a.value.length>=6);ir(async()=>{try{const{oobCode:A}=e.query;if(_e.debug("Token reçu (masqué)"),!A){s.value="Lien de réinitialisation incomplet",r.value=!1;return}o.value=A,i.value="patrice.lamarque+ron@gmail.com",r.value=!1}catch(A){_e.error("Erreur lors de la vérification du lien",A),s.value="Erreur lors de la vérification du lien",r.value=!1}});async function y(){if(g.value){c.value=!0,d.value="",f.value="";try{_e.debug("Début réinitialisation avec token (masqué)"),await iN(Nt,o.value,a.value),_e.info("Mot de passe Firebase Auth mis à jour"),_e.info("Réinitialisation terminée avec Firebase Auth"),f.value="Mot de passe réinitialisé avec succès ! Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.",setTimeout(()=>{T()},3e3)}catch(A){_e.error("Erreur lors de la réinitialisation",A),A.code==="auth/weak-password"?d.value="Le mot de passe doit contenir au moins 6 caractères":A.code==="auth/invalid-action-code"?d.value="Lien de réinitialisation invalide ou expiré":d.value="Erreur lors de la réinitialisation. Veuillez réessayer."}finally{c.value=!1}}}function T(){t.push("/")}return(A,P)=>(L(),F("div",v5,[h("div",y5,[P[8]||(P[8]=Jn('<div class="text-center mb-6"><div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-3xl">🔑</span></div><h1 class="text-3xl font-bold text-white mb-2">Réinitialisation</h1><p class="text-lg text-gray-300">Nouveau mot de passe</p></div>',1)),r.value?(L(),F("div",_5,P[2]||(P[2]=[h("div",{class:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),h("p",{class:"text-gray-300"},"Vérification du lien...",-1)]))):s.value?(L(),F("div",b5,[P[3]||(P[3]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"❌")],-1)),P[4]||(P[4]=h("h2",{class:"text-xl font-bold text-white mb-2"},"Lien invalide",-1)),h("p",w5,le(s.value),1),h("button",{onClick:T,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300"}," Retour à l'accueil ")])):i.value?(L(),F("div",I5,[h("div",E5,[h("p",T5,[P[5]||(P[5]=Dt("Email : ")),h("span",x5,le(i.value),1)])]),h("div",A5,[h("div",null,[P[6]||(P[6]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nouveau mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":P[0]||(P[0]=U=>a.value=U),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nouveau mot de passe",onKeydown:Mn(y,["enter"])},null,544),[[kt,a.value]])]),h("div",null,[P[7]||(P[7]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":P[1]||(P[1]=U=>l.value=U),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe",onKeydown:Mn(y,["enter"])},null,544),[[kt,l.value]])])]),h("button",{onClick:y,disabled:!g.value||c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(L(),F("span",P5,"⏳")):(L(),F("span",R5,"🔑")),h("span",null,le(c.value?"Réinitialisation...":"Réinitialiser le mot de passe"),1)],8,S5),d.value?(L(),F("div",C5,[h("div",k5,le(d.value),1)])):ge("",!0),f.value?(L(),F("div",D5,[h("div",N5,le(f.value),1)])):ge("",!0)])):ge("",!0)])]))}},O5={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},M5={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center"},L5={class:"text-3xl"},F5={class:"text-2xl font-bold text-white mb-2"},$5={class:"text-gray-300 mb-6"},U5={__name:"MagicLink",setup(n){const e=Za(),t=Wu(),r=k("loading"),s=k("Traitement en cours..."),i=k("Merci de patienter pendant la validation du lien."),o=Oe(()=>r.value==="loading"?"⏳":r.value==="ok"?"✅":"❌");function a(){const l=e.query.slug;l?t.push(`/season/${l}`):t.push("/")}return ir(async()=>{var l;try{oT("firebase");const c=String(e.query.sid||""),d=String(e.query.pid||"");let f=String(e.query.eid||"");const g=String(e.query.t||""),y=String(e.query.a||""),T=String(e.query.slug||"");if(!g||!y){r.value="error",s.value="Lien invalide",i.value="Paramètres manquants.";return}if(y==="account_email_update"){const z=await dT({token:g});if(!z.valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expiré.";return}try{await dN(Nt.currentUser,z.data.newEmail),await hT({token:g}),r.value="ok",s.value="Email mis à jour",i.value="Votre adresse email a été mise à jour avec succès."}catch{r.value="error",s.value="Action impossible",i.value="Veuillez vous reconnecter puis réessayer."}return}if(y==="verify_email"&&(f="protection"),!(await uT({seasonId:c,playerId:d,eventId:f,token:g,action:y})).valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expiré.";return}if(y==="verify_email"){await gT({playerId:d,seasonId:c});try{await wT({playerId:d,seasonId:c})}catch{}await $p({seasonId:c,playerId:d,eventId:"protection",action:y}),r.value="ok",s.value="Email vérifié",i.value="Merci ! Vous pouvez maintenant définir votre mot de passe.",setTimeout(T?()=>t.push(`/season/${T}?player=${encodeURIComponent(d)}&verified=1`):()=>t.push("/"),800);return}const P=Se(ue,"seasons",c,"players",d),U=await Qt(P),q=U.exists()&&U.data().name||"";if(!q){r.value="error",s.value="Lien invalide",i.value="Joueur introuvable.";return}if(await PO({seasonId:c,playerName:q,eventId:f,value:y==="yes"}),y==="no")try{const z=Se(ue,"seasons",c,"selections",f),he=await Qt(z);if(he.exists()){const pe=Array.isArray((l=he.data())==null?void 0:l.players)?he.data().players:[],x=pe.filter(I=>I!==q);x.length!==pe.length&&await setDoc(z,{players:x},{merge:!0})}}catch{}await $p({seasonId:c,playerId:d,eventId:f,action:y}),r.value="ok",s.value="Merci !",i.value=y==="yes"?"Votre disponibilité a été enregistrée: Disponible.":"Votre disponibilité a été enregistrée: Non disponible. (Si vous étiez sélectionné(e), vous avez été retiré(e) de la sélection.)",setTimeout(T?()=>t.push(`/season/${T}/event/${f}`):()=>t.push("/"),1200)}catch(c){_e.error("Magic link error",c),r.value="error",s.value="Erreur",i.value="Impossible de traiter votre lien."}}),(l,c)=>(L(),F("div",O5,[h("div",M5,[h("div",{class:Tt(["w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center",r.value==="ok"?"bg-green-500":r.value==="loading"?"bg-blue-500":"bg-red-500"])},[h("span",L5,le(o.value),1)],2),h("h1",F5,le(s.value),1),h("p",$5,le(i.value),1),h("button",{onClick:a,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ouvrir la saison ")])]))}},j5={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},B5={class:"text-center py-12 px-4"},q5={class:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},z5={class:"container mx-auto px-4 pb-16"},K5={class:"max-w-xl mx-auto bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl"},G5={class:"space-y-5"},H5=["onKeydown"],W5={class:"flex items-center justify-end gap-3 pt-2"},Q5=["disabled"],J5={key:0,class:"mt-6 text-sm text-gray-200"},Y5={__name:"JoinSeason",setup(n){const e=Za(),t=Wu(),r=e.params.slug,s=k(""),i=k(""),o=k(""),a=k(!1),l=k("");ir(async()=>{const f=Ou(Je(ue,"seasons"),Gd("slug","==",r)),g=await bt(f);if(g.empty)l.value="Saison introuvable";else{const y=g.docs[0];s.value=y.id,i.value=y.data().name,document.title=`Rejoindre : ${i.value}`}});function c(){t.push(`/season/${r}`)}async function d(){if(!(!o.value.trim()||!s.value)){a.value=!0,l.value="";try{await aT(o.value.trim(),s.value),l.value="Inscription réussie. Vous pouvez maintenant indiquer vos disponibilités.";try{localStorage.setItem(`startPlayerTour:${s.value}`,"1"),localStorage.setItem(`dismissCreatorOnboarding:${s.value}`,"1")}catch{}setTimeout(()=>{c()},600)}catch(f){_e.error("Erreur inscription",f),l.value=`Erreur lors de l'inscription: ${(f==null?void 0:f.message)||"Veuillez réessayer"}`}finally{a.value=!1}}}return(f,g)=>(L(),F("div",j5,[h("div",B5,[h("h1",q5,le(i.value||"Rejoindre la saison"),1),g[1]||(g[1]=h("p",{class:"text-gray-300"},"Inscrivez-vous pour indiquer vos disponibilités aux événements",-1))]),h("div",z5,[h("div",K5,[g[3]||(g[3]=h("h2",{class:"text-2xl font-bold text-white mb-6 text-center"},"Je rejoins la saison",-1)),h("div",G5,[h("div",null,[g[2]||(g[2]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Votre nom",-1)),nt(h("input",{"onUpdate:modelValue":g[0]||(g[0]=y=>o.value=y),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: Marie Dupont",onKeydown:Mn(Ft(d,["prevent"]),["enter"])},null,40,H5),[[kt,o.value]])]),h("div",W5,[h("button",{onClick:c,class:"px-5 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{disabled:!o.value.trim()||a.value,onClick:d,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Rejoindre ",8,Q5)])]),l.value?(L(),F("div",J5,le(l.value),1)):ge("",!0)])])]))}};{const n=()=>{};console.debug=n,console.log=n,console.info=n}const X5=[{path:"/",component:sM},{path:"/season/:slug",component:u0,props:!0},{path:"/season/:slug/event/:eventId",component:u0,props:!0},{path:"/season/:slug/join",component:Y5,props:!0},{path:"/reset-password",component:V5},{path:"/magic",component:U5}],Z5=k1({history:o1("/"),routes:X5}),ZT=AS(RS);ZT.use(Z5);ZT.mount("#app");O1({immediate:!0,onRegistered(n){window.__swReg=n}});export{Je as $,oE as A,No as B,ts as C,an as D,rB as E,Fo as F,tg as G,nB as H,sj as I,xr as J,ID as K,TD as L,fl as M,Cj as N,kj as O,QD as P,Rn as Q,wj as R,uj as S,Wt as T,Wj as U,Ch as V,GD as W,WD as X,Rj as Y,hj as Z,Jb as _,Du as a,hc as a$,aj as a0,ED as a1,OD as a2,tB as a3,Ya as a4,Hj as a5,mj as a6,eB as a7,Se as a8,_j as a9,yj as aA,Lj as aB,Fj as aC,bj as aD,ND as aE,qj as aF,zj as aG,zD as aH,Ou as aI,GI as aJ,lj as aK,Gj as aL,Bi as aM,mn as aN,Yj as aO,ej as aP,Dj as aQ,xj as aR,Tj as aS,Pj as aT,gj as aU,hl as aV,Jj as aW,fj as aX,Gd as aY,hg as aZ,uB as a_,AD as aa,dj as ab,pj as ac,Zj as ad,Sj as ae,Aj as af,Jt as ag,lc as ah,LD as ai,$j as aj,Qt as ak,Nj as al,Vj as am,bt as an,Oj as ao,Mj as ap,xD as aq,Xj as ar,Qj as as,cj as at,Ij as au,Ej as av,vj as aw,Uj as ax,Bj as ay,jj as az,SD as b,eN as b$,dc as b0,dB as b1,$u as b2,Bo as b3,fi as b4,iB as b5,mi as b6,pi as b7,Os as b8,gd as b9,l2 as bA,DB as bB,KB as bC,k_ as bD,jN as bE,R2 as bF,AB as bG,_B as bH,tN as bI,MB as bJ,jB as bK,zB as bL,NB as bM,wN as bN,_N as bO,fB as bP,YD as bQ,nN as bR,LB as bS,UB as bT,qB as bU,d2 as bV,CB as bW,IB as bX,sN as bY,yB as bZ,yN as b_,lB as ba,Eo as bb,Ca as bc,zV as bd,oB as be,VB as bf,Np as bg,aB as bh,KV as bi,Ng as bj,gi as bk,gB as bl,bN as bm,UE as bn,qV as bo,BE as bp,oN as bq,iN as br,k2 as bs,aN as bt,cB as bu,kB as bv,wB as bw,xB as bx,XV as by,hB as bz,Qa as c,Ig as c0,mB as c1,lN as c2,bB as c3,OB as c4,$B as c5,BB as c6,IN as c7,pB as c8,RB as c9,dN as ca,hN as cb,FB as cc,TB as cd,PB as ce,SB as cf,EB as cg,vB as ch,$o as d,Rt as e,de as f,dl as g,oc as h,fd as i,Lh as j,ac as k,Oh as l,cg as m,Ja as n,Mh as o,vo as p,HD as q,Zt as r,xo as s,xe as t,nj as u,mR as v,zt as w,sB as x,rt as y,tj as z};
