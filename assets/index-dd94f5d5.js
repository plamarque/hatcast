(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function tf(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const dt={},no=[],nr=()=>{},Wb=()=>!1,Au=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),nf=n=>n.startsWith("onUpdate:"),on=Object.assign,rf=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},Qb=Object.prototype.hasOwnProperty,st=(n,e)=>Qb.call(n,e),Ne=Array.isArray,ro=n=>xu(n)==="[object Map]",Q_=n=>xu(n)==="[object Set]",Fe=n=>typeof n=="function",Qt=n=>typeof n=="string",Os=n=>typeof n=="symbol",Pt=n=>n!==null&&typeof n=="object",J_=n=>(Pt(n)||Fe(n))&&Fe(n.then)&&Fe(n.catch),Y_=Object.prototype.toString,xu=n=>Y_.call(n),Jb=n=>xu(n).slice(8,-1),X_=n=>xu(n)==="[object Object]",sf=n=>Qt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Ma=tf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Pu=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},Yb=/-(\w)/g,Qn=Pu(n=>n.replace(Yb,(e,t)=>t?t.toUpperCase():"")),Xb=/\B([A-Z])/g,Ms=Pu(n=>n.replace(Xb,"-$1").toLowerCase()),Su=Pu(n=>n.charAt(0).toUpperCase()+n.slice(1)),Cd=Pu(n=>n?`on${Su(n)}`:""),bs=(n,e)=>!Object.is(n,e),Cc=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},uh=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},dh=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let um;const Ru=()=>um||(um=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Cu(n){if(Ne(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=Qt(r)?nI(r):Cu(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(Qt(n)||Pt(n))return n}const Zb=/;(?![^(]*\))/g,eI=/:([^]+)/,tI=/\/\*[^]*?\*\//g;function nI(n){const e={};return n.replace(tI,"").split(Zb).forEach(t=>{if(t){const r=t.split(eI);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function rr(n){let e="";if(Qt(n))e=n;else if(Ne(n))for(let t=0;t<n.length;t++){const r=rr(n[t]);r&&(e+=r+" ")}else if(Pt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const rI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",sI=tf(rI);function Z_(n){return!!n||n===""}const ey=n=>!!(n&&n.__v_isRef===!0),we=n=>Qt(n)?n:n==null?"":Ne(n)||Pt(n)&&(n.toString===Y_||!Fe(n.toString))?ey(n)?we(n.value):JSON.stringify(n,ty,2):String(n),ty=(n,e)=>ey(e)?ty(n,e.value):ro(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[kd(r,i)+" =>"]=s,t),{})}:Q_(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>kd(t))}:Os(e)?kd(e):Pt(e)&&!Ne(e)&&!X_(e)?String(e):e,kd=(n,e="")=>{var t;return Os(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let kn;class iI{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=kn,!e&&kn&&(this.index=(kn.scopes||(kn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=kn;try{return kn=this,e()}finally{kn=t}}}on(){++this._on===1&&(this.prevScope=kn,kn=this)}off(){this._on>0&&--this._on===0&&(kn=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function oI(){return kn}let mt;const Dd=new WeakSet;class ny{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,kn&&kn.active&&kn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Dd.has(this)&&(Dd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||sy(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,dm(this),iy(this);const e=mt,t=sr;mt=this,sr=!0;try{return this.fn()}finally{oy(this),mt=e,sr=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)lf(e);this.deps=this.depsTail=void 0,dm(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Dd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){hh(this)&&this.run()}get dirty(){return hh(this)}}let ry=0,La,Fa;function sy(n,e=!1){if(n.flags|=8,e){n.next=Fa,Fa=n;return}n.next=La,La=n}function of(){ry++}function af(){if(--ry>0)return;if(Fa){let e=Fa;for(Fa=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;La;){let e=La;for(La=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function iy(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function oy(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),lf(r),aI(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function hh(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ay(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function ay(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Xa)||(n.globalVersion=Xa,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!hh(n))))return;n.flags|=2;const e=n.dep,t=mt,r=sr;mt=n,sr=!0;try{iy(n);const s=n.fn(n._value);(e.version===0||bs(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{mt=t,sr=r,oy(n),n.flags&=-3}}function lf(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)lf(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function aI(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let sr=!0;const ly=[];function jr(){ly.push(sr),sr=!1}function qr(){const n=ly.pop();sr=n===void 0?!0:n}function dm(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=mt;mt=void 0;try{e()}finally{mt=t}}}let Xa=0;class lI{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class cf{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!mt||!sr||mt===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==mt)t=this.activeLink=new lI(mt,this),mt.deps?(t.prevDep=mt.depsTail,mt.depsTail.nextDep=t,mt.depsTail=t):mt.deps=mt.depsTail=t,cy(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=mt.depsTail,t.nextDep=void 0,mt.depsTail.nextDep=t,mt.depsTail=t,mt.deps===t&&(mt.deps=r)}return t}trigger(e){this.version++,Xa++,this.notify(e)}notify(e){of();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{af()}}}function cy(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)cy(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const fh=new WeakMap,hi=Symbol(""),ph=Symbol(""),Za=Symbol("");function yn(n,e,t){if(sr&&mt){let r=fh.get(n);r||fh.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new cf),s.map=r,s.key=t),s.track()}}function Vr(n,e,t,r,s,i){const o=fh.get(n);if(!o){Xa++;return}const a=l=>{l&&l.trigger()};if(of(),e==="clear")o.forEach(a);else{const l=Ne(n),u=l&&sf(t);if(l&&t==="length"){const d=Number(r);o.forEach((f,g)=>{(g==="length"||g===Za||!Os(g)&&g>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(Za)),e){case"add":l?u&&a(o.get("length")):(a(o.get(hi)),ro(n)&&a(o.get(ph)));break;case"delete":l||(a(o.get(hi)),ro(n)&&a(o.get(ph)));break;case"set":ro(n)&&a(o.get(hi));break}}af()}function zi(n){const e=rt(n);return e===n?e:(yn(e,"iterate",Za),Wn(n)?e:e.map(cn))}function ku(n){return yn(n=rt(n),"iterate",Za),n}const cI={__proto__:null,[Symbol.iterator](){return Nd(this,Symbol.iterator,cn)},concat(...n){return zi(this).concat(...n.map(e=>Ne(e)?zi(e):e))},entries(){return Nd(this,"entries",n=>(n[1]=cn(n[1]),n))},every(n,e){return Cr(this,"every",n,e,void 0,arguments)},filter(n,e){return Cr(this,"filter",n,e,t=>t.map(cn),arguments)},find(n,e){return Cr(this,"find",n,e,cn,arguments)},findIndex(n,e){return Cr(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Cr(this,"findLast",n,e,cn,arguments)},findLastIndex(n,e){return Cr(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Cr(this,"forEach",n,e,void 0,arguments)},includes(...n){return Vd(this,"includes",n)},indexOf(...n){return Vd(this,"indexOf",n)},join(n){return zi(this).join(n)},lastIndexOf(...n){return Vd(this,"lastIndexOf",n)},map(n,e){return Cr(this,"map",n,e,void 0,arguments)},pop(){return ga(this,"pop")},push(...n){return ga(this,"push",n)},reduce(n,...e){return hm(this,"reduce",n,e)},reduceRight(n,...e){return hm(this,"reduceRight",n,e)},shift(){return ga(this,"shift")},some(n,e){return Cr(this,"some",n,e,void 0,arguments)},splice(...n){return ga(this,"splice",n)},toReversed(){return zi(this).toReversed()},toSorted(n){return zi(this).toSorted(n)},toSpliced(...n){return zi(this).toSpliced(...n)},unshift(...n){return ga(this,"unshift",n)},values(){return Nd(this,"values",cn)}};function Nd(n,e,t){const r=ku(n),s=r[e]();return r!==n&&!Wn(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const uI=Array.prototype;function Cr(n,e,t,r,s,i){const o=ku(n),a=o!==n&&!Wn(n),l=o[e];if(l!==uI[e]){const f=l.apply(n,i);return a?cn(f):f}let u=t;o!==n&&(a?u=function(f,g){return t.call(this,cn(f),g,n)}:t.length>2&&(u=function(f,g){return t.call(this,f,g,n)}));const d=l.call(o,u,r);return a&&s?s(d):d}function hm(n,e,t,r){const s=ku(n);let i=t;return s!==n&&(Wn(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,cn(a),l,n)}),s[e](i,...r)}function Vd(n,e,t){const r=rt(n);yn(r,"iterate",Za);const s=r[e](...t);return(s===-1||s===!1)&&hf(t[0])?(t[0]=rt(t[0]),r[e](...t)):s}function ga(n,e,t=[]){jr(),of();const r=rt(n)[e].apply(n,t);return af(),qr(),r}const dI=tf("__proto__,__v_isRef,__isVue"),uy=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Os));function hI(n){Os(n)||(n=String(n));const e=rt(this);return yn(e,"has",n),e.hasOwnProperty(n)}class dy{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?II:my:i?py:fy).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Ne(e);if(!s){let l;if(o&&(l=cI[t]))return l;if(t==="hasOwnProperty")return hI}const a=Reflect.get(e,t,wn(e)?e:r);return(Os(t)?uy.has(t):dI(t))||(s||yn(e,"get",t),i)?a:wn(a)?o&&sf(t)?a:a.value:Pt(a)?s?_y(a):Du(a):a}}class hy extends dy{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=As(i);if(!Wn(r)&&!As(r)&&(i=rt(i),r=rt(r)),!Ne(e)&&wn(i)&&!wn(r))return l?!1:(i.value=r,!0)}const o=Ne(e)&&sf(t)?Number(t)<e.length:st(e,t),a=Reflect.set(e,t,r,wn(e)?e:s);return e===rt(s)&&(o?bs(r,i)&&Vr(e,"set",t,r):Vr(e,"add",t,r)),a}deleteProperty(e,t){const r=st(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&Vr(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!Os(t)||!uy.has(t))&&yn(e,"has",t),r}ownKeys(e){return yn(e,"iterate",Ne(e)?"length":hi),Reflect.ownKeys(e)}}class fI extends dy{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const pI=new hy,mI=new fI,gI=new hy(!0);const mh=n=>n,yc=n=>Reflect.getPrototypeOf(n);function _I(n,e,t){return function(...r){const s=this.__v_raw,i=rt(s),o=ro(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=s[n](...r),d=t?mh:e?Qc:cn;return!e&&yn(i,"iterate",l?ph:hi),{next(){const{value:f,done:g}=u.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function vc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function yI(n,e){const t={get(s){const i=this.__v_raw,o=rt(i),a=rt(s);n||(bs(s,a)&&yn(o,"get",s),yn(o,"get",a));const{has:l}=yc(o),u=e?mh:n?Qc:cn;if(l.call(o,s))return u(i.get(s));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&yn(rt(s),"iterate",hi),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=rt(i),a=rt(s);return n||(bs(s,a)&&yn(o,"has",s),yn(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=rt(a),u=e?mh:n?Qc:cn;return!n&&yn(l,"iterate",hi),a.forEach((d,f)=>s.call(i,u(d),u(f),o))}};return on(t,n?{add:vc("add"),set:vc("set"),delete:vc("delete"),clear:vc("clear")}:{add(s){!e&&!Wn(s)&&!As(s)&&(s=rt(s));const i=rt(this);return yc(i).has.call(i,s)||(i.add(s),Vr(i,"add",s,s)),this},set(s,i){!e&&!Wn(i)&&!As(i)&&(i=rt(i));const o=rt(this),{has:a,get:l}=yc(o);let u=a.call(o,s);u||(s=rt(s),u=a.call(o,s));const d=l.call(o,s);return o.set(s,i),u?bs(i,d)&&Vr(o,"set",s,i):Vr(o,"add",s,i),this},delete(s){const i=rt(this),{has:o,get:a}=yc(i);let l=o.call(i,s);l||(s=rt(s),l=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return l&&Vr(i,"delete",s,void 0),u},clear(){const s=rt(this),i=s.size!==0,o=s.clear();return i&&Vr(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=_I(s,n,e)}),t}function uf(n,e){const t=yI(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(st(t,s)&&s in r?t:r,s,i)}const vI={get:uf(!1,!1)},wI={get:uf(!1,!0)},bI={get:uf(!0,!1)};const fy=new WeakMap,py=new WeakMap,my=new WeakMap,II=new WeakMap;function EI(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function TI(n){return n.__v_skip||!Object.isExtensible(n)?0:EI(Jb(n))}function Du(n){return As(n)?n:df(n,!1,pI,vI,fy)}function gy(n){return df(n,!1,gI,wI,py)}function _y(n){return df(n,!0,mI,bI,my)}function df(n,e,t,r,s){if(!Pt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=TI(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function so(n){return As(n)?so(n.__v_raw):!!(n&&n.__v_isReactive)}function As(n){return!!(n&&n.__v_isReadonly)}function Wn(n){return!!(n&&n.__v_isShallow)}function hf(n){return n?!!n.__v_raw:!1}function rt(n){const e=n&&n.__v_raw;return e?rt(e):n}function AI(n){return!st(n,"__v_skip")&&Object.isExtensible(n)&&uh(n,"__v_skip",!0),n}const cn=n=>Pt(n)?Du(n):n,Qc=n=>Pt(n)?_y(n):n;function wn(n){return n?n.__v_isRef===!0:!1}function q(n){return yy(n,!1)}function xI(n){return yy(n,!0)}function yy(n,e){return wn(n)?n:new PI(n,e)}class PI{constructor(e,t){this.dep=new cf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:rt(e),this._value=t?e:cn(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Wn(e)||As(e);e=r?e:rt(e),bs(e,t)&&(this._rawValue=e,this._value=r?e:cn(e),this.dep.trigger())}}function io(n){return wn(n)?n.value:n}const SI={get:(n,e,t)=>e==="__v_raw"?n:io(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return wn(s)&&!wn(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function vy(n){return so(n)?n:new Proxy(n,SI)}class RI{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new cf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Xa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&mt!==this)return sy(this,!0),!0}get value(){const e=this.dep.track();return ay(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function CI(n,e,t=!1){let r,s;return Fe(n)?r=n:(r=n.get,s=n.set),new RI(r,s,t)}const wc={},Jc=new WeakMap;let ni;function kI(n,e=!1,t=ni){if(t){let r=Jc.get(t);r||Jc.set(t,r=[]),r.push(n)}}function DI(n,e,t=dt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,u=j=>s?j:Wn(j)||s===!1||s===0?Or(j,1):Or(j);let d,f,g,_,C=!1,x=!1;if(wn(n)?(f=()=>n.value,C=Wn(n)):so(n)?(f=()=>u(n),C=!0):Ne(n)?(x=!0,C=n.some(j=>so(j)||Wn(j)),f=()=>n.map(j=>{if(wn(j))return j.value;if(so(j))return u(j);if(Fe(j))return l?l(j,2):j()})):Fe(n)?e?f=l?()=>l(n,2):n:f=()=>{if(g){jr();try{g()}finally{qr()}}const j=ni;ni=d;try{return l?l(n,3,[_]):n(_)}finally{ni=j}}:f=nr,e&&s){const j=f,O=s===!0?1/0:s;f=()=>Or(j(),O)}const R=oI(),L=()=>{d.stop(),R&&R.active&&rf(R.effects,d)};if(i&&e){const j=e;e=(...O)=>{j(...O),L()}}let B=x?new Array(n.length).fill(wc):wc;const $=j=>{if(!(!(d.flags&1)||!d.dirty&&!j))if(e){const O=d.run();if(s||C||(x?O.some((se,T)=>bs(se,B[T])):bs(O,B))){g&&g();const se=ni;ni=d;try{const T=[O,B===wc?void 0:x&&B[0]===wc?[]:B,_];B=O,l?l(e,3,T):e(...T)}finally{ni=se}}}else d.run()};return a&&a($),d=new ny(f),d.scheduler=o?()=>o($,!1):$,_=j=>kI(j,!1,d),g=d.onStop=()=>{const j=Jc.get(d);if(j){if(l)l(j,4);else for(const O of j)O();Jc.delete(d)}},e?r?$(!0):B=d.run():o?o($.bind(null,!0),!0):d.run(),L.pause=d.pause.bind(d),L.resume=d.resume.bind(d),L.stop=L,L}function Or(n,e=1/0,t){if(e<=0||!Pt(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,wn(n))Or(n.value,e,t);else if(Ne(n))for(let r=0;r<n.length;r++)Or(n[r],e,t);else if(Q_(n)||ro(n))n.forEach(r=>{Or(r,e,t)});else if(X_(n)){for(const r in n)Or(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&Or(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Al(n,e,t,r){try{return r?n(...r):n()}catch(s){Nu(s,e,t)}}function br(n,e,t,r){if(Fe(n)){const s=Al(n,e,t,r);return s&&J_(s)&&s.catch(i=>{Nu(i,e,t)}),s}if(Ne(n)){const s=[];for(let i=0;i<n.length;i++)s.push(br(n[i],e,t,r));return s}}function Nu(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||dt;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,l,u)===!1)return}a=a.parent}if(i){jr(),Al(i,null,10,[n,l,u]),qr();return}}NI(n,t,s,r,o)}function NI(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Sn=[];let hr=-1;const oo=[];let us=null,Qi=0;const wy=Promise.resolve();let Yc=null;function pr(n){const e=Yc||wy;return n?e.then(this?n.bind(this):n):e}function VI(n){let e=hr+1,t=Sn.length;for(;e<t;){const r=e+t>>>1,s=Sn[r],i=el(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function ff(n){if(!(n.flags&1)){const e=el(n),t=Sn[Sn.length-1];!t||!(n.flags&2)&&e>=el(t)?Sn.push(n):Sn.splice(VI(e),0,n),n.flags|=1,by()}}function by(){Yc||(Yc=wy.then(Ey))}function OI(n){Ne(n)?oo.push(...n):us&&n.id===-1?us.splice(Qi+1,0,n):n.flags&1||(oo.push(n),n.flags|=1),by()}function fm(n,e,t=hr+1){for(;t<Sn.length;t++){const r=Sn[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Sn.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Iy(n){if(oo.length){const e=[...new Set(oo)].sort((t,r)=>el(t)-el(r));if(oo.length=0,us){us.push(...e);return}for(us=e,Qi=0;Qi<us.length;Qi++){const t=us[Qi];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}us=null,Qi=0}}const el=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Ey(n){const e=nr;try{for(hr=0;hr<Sn.length;hr++){const t=Sn[hr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Al(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;hr<Sn.length;hr++){const t=Sn[hr];t&&(t.flags&=-2)}hr=-1,Sn.length=0,Iy(),Yc=null,(Sn.length||oo.length)&&Ey()}}let zn=null,Ty=null;function Xc(n){const e=zn;return zn=n,Ty=n&&n.type.__scopeId||null,e}function MI(n,e=zn,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&Im(-1);const i=Xc(e);let o;try{o=n(...s)}finally{Xc(i),r._d&&Im(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function gt(n,e){if(zn===null)return n;const t=Lu(zn),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=dt]=e[s];i&&(Fe(i)&&(i={mounted:i,updated:i}),i.deep&&Or(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Zs(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(jr(),br(l,t,8,[n.el,a,n,e]),qr())}}const LI=Symbol("_vte"),FI=n=>n.__isTeleport;function pf(n,e){n.shapeFlag&6&&n.component?(n.transition=e,pf(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Ay(n,e){return Fe(n)?(()=>on({name:n.name},e,{setup:n}))():n}function xy(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Ua(n,e,t,r,s=!1){if(Ne(n)){n.forEach((C,x)=>Ua(C,e&&(Ne(e)?e[x]:e),t,r,s));return}if(Ba(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Ua(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?Lu(r.component):r.el,o=s?null:i,{i:a,r:l}=n,u=e&&e.r,d=a.refs===dt?a.refs={}:a.refs,f=a.setupState,g=rt(f),_=f===dt?()=>!1:C=>st(g,C);if(u!=null&&u!==l&&(Qt(u)?(d[u]=null,_(u)&&(f[u]=null)):wn(u)&&(u.value=null)),Fe(l))Al(l,a,12,[o,d]);else{const C=Qt(l),x=wn(l);if(C||x){const R=()=>{if(n.f){const L=C?_(l)?f[l]:d[l]:l.value;s?Ne(L)&&rf(L,i):Ne(L)?L.includes(i)||L.push(i):C?(d[l]=[i],_(l)&&(f[l]=d[l])):(l.value=[i],n.k&&(d[n.k]=l.value))}else C?(d[l]=o,_(l)&&(f[l]=o)):x&&(l.value=o,n.k&&(d[n.k]=o))};o?(R.id=-1,jn(R,t)):R()}}}Ru().requestIdleCallback;Ru().cancelIdleCallback;const Ba=n=>!!n.type.__asyncLoader,Py=n=>n.type.__isKeepAlive;function UI(n,e){Sy(n,"a",e)}function BI(n,e){Sy(n,"da",e)}function Sy(n,e,t=vn){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Vu(e,r,t),t){let s=t.parent;for(;s&&s.parent;)Py(s.parent.vnode)&&$I(r,e,t,s),s=s.parent}}function $I(n,e,t,r){const s=Vu(e,n,r,!0);mf(()=>{rf(r[e],s)},t)}function Vu(n,e,t=vn,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{jr();const a=xl(t),l=br(e,t,n,o);return a(),qr(),l});return r?s.unshift(i):s.push(i),i}}const Jr=n=>(e,t=vn)=>{(!nl||n==="sp")&&Vu(n,(...r)=>e(...r),t)},jI=Jr("bm"),go=Jr("m"),qI=Jr("bu"),zI=Jr("u"),Ry=Jr("bum"),mf=Jr("um"),GI=Jr("sp"),KI=Jr("rtg"),HI=Jr("rtc");function WI(n,e=vn){Vu("ec",n,e)}const Cy="components";function QI(n,e){return YI(Cy,n,!0,e)||n}const JI=Symbol.for("v-ndc");function YI(n,e,t=!0,r=!1){const s=zn||vn;if(s){const i=s.type;if(n===Cy){const a=LE(i,!1);if(a&&(a===e||a===Qn(e)||a===Su(Qn(e))))return i}const o=pm(s[n]||i[n],e)||pm(s.appContext[n],e);return!o&&r?i:o}}function pm(n,e){return n&&(n[e]||n[Qn(e)]||n[Su(Qn(e))])}function Mr(n,e,t,r){let s;const i=t&&t[r],o=Ne(n);if(o||Qt(n)){const a=o&&so(n);let l=!1,u=!1;a&&(l=!Wn(n),u=As(n),n=ku(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(l?u?Qc(cn(n[d])):cn(n[d]):n[d],d,void 0,i&&i[d])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(Pt(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i&&i[l]));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const d=a[l];s[l]=e(n[d],d,l,i&&i[l])}}else s=[];return t&&(t[r]=s),s}const gh=n=>n?Jy(n)?Lu(n):gh(n.parent):null,$a=on(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>gh(n.parent),$root:n=>gh(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>gf(n),$forceUpdate:n=>n.f||(n.f=()=>{ff(n.update)}),$nextTick:n=>n.n||(n.n=pr.bind(n.proxy)),$watch:n=>yE.bind(n)}),Od=(n,e)=>n!==dt&&!n.__isScriptSetup&&st(n,e),XI={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let u;if(e[0]!=="$"){const _=o[e];if(_!==void 0)switch(_){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Od(r,e))return o[e]=1,r[e];if(s!==dt&&st(s,e))return o[e]=2,s[e];if((u=n.propsOptions[0])&&st(u,e))return o[e]=3,i[e];if(t!==dt&&st(t,e))return o[e]=4,t[e];_h&&(o[e]=0)}}const d=$a[e];let f,g;if(d)return e==="$attrs"&&yn(n.attrs,"get",""),d(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==dt&&st(t,e))return o[e]=4,t[e];if(g=l.config.globalProperties,st(g,e))return g[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Od(s,e)?(s[e]=t,!0):r!==dt&&st(r,e)?(r[e]=t,!0):st(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==dt&&st(n,o)||Od(e,o)||(a=i[0])&&st(a,o)||st(r,o)||st($a,o)||st(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:st(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function mm(n){return Ne(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let _h=!0;function ZI(n){const e=gf(n),t=n.proxy,r=n.ctx;_h=!1,e.beforeCreate&&gm(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:u,created:d,beforeMount:f,mounted:g,beforeUpdate:_,updated:C,activated:x,deactivated:R,beforeDestroy:L,beforeUnmount:B,destroyed:$,unmounted:j,render:O,renderTracked:se,renderTriggered:T,errorCaptured:w,serverPrefetch:I,expose:S,inheritAttrs:k,components:D,directives:A,filters:Jt}=e;if(u&&eE(u,r,null),o)for(const ce in o){const K=o[ce];Fe(K)&&(r[ce]=K.bind(t))}if(s){const ce=s.call(t,t);Pt(ce)&&(n.data=Du(ce))}if(_h=!0,i)for(const ce in i){const K=i[ce],Se=Fe(K)?K.bind(t,t):Fe(K.get)?K.get.bind(t,t):nr,De=!Fe(K)&&Fe(K.set)?K.set.bind(t):nr,Qe=Lt({get:Se,set:De});Object.defineProperty(r,ce,{enumerable:!0,configurable:!0,get:()=>Qe.value,set:Ve=>Qe.value=Ve})}if(a)for(const ce in a)ky(a[ce],r,t,ce);if(l){const ce=Fe(l)?l.call(t):l;Reflect.ownKeys(ce).forEach(K=>{kc(K,ce[K])})}d&&gm(d,n,"c");function Ze(ce,K){Ne(K)?K.forEach(Se=>ce(Se.bind(t))):K&&ce(K.bind(t))}if(Ze(jI,f),Ze(go,g),Ze(qI,_),Ze(zI,C),Ze(UI,x),Ze(BI,R),Ze(WI,w),Ze(HI,se),Ze(KI,T),Ze(Ry,B),Ze(mf,j),Ze(GI,I),Ne(S))if(S.length){const ce=n.exposed||(n.exposed={});S.forEach(K=>{Object.defineProperty(ce,K,{get:()=>t[K],set:Se=>t[K]=Se})})}else n.exposed||(n.exposed={});O&&n.render===nr&&(n.render=O),k!=null&&(n.inheritAttrs=k),D&&(n.components=D),A&&(n.directives=A),I&&xy(n)}function eE(n,e,t=nr){Ne(n)&&(n=yh(n));for(const r in n){const s=n[r];let i;Pt(s)?"default"in s?i=ir(s.from||r,s.default,!0):i=ir(s.from||r):i=ir(s),wn(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function gm(n,e,t){br(Ne(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function ky(n,e,t,r){let s=r.includes(".")?zy(t,r):()=>t[r];if(Qt(n)){const i=e[n];Fe(i)&&or(s,i)}else if(Fe(n))or(s,n.bind(t));else if(Pt(n))if(Ne(n))n.forEach(i=>ky(i,e,t,r));else{const i=Fe(n.handler)?n.handler.bind(t):e[n.handler];Fe(i)&&or(s,i,n)}}function gf(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(u=>Zc(l,u,o,!0)),Zc(l,e,o)),Pt(e)&&i.set(e,l),l}function Zc(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Zc(n,i,t,!0),s&&s.forEach(o=>Zc(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=tE[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const tE={data:_m,props:ym,emits:ym,methods:Sa,computed:Sa,beforeCreate:xn,created:xn,beforeMount:xn,mounted:xn,beforeUpdate:xn,updated:xn,beforeDestroy:xn,beforeUnmount:xn,destroyed:xn,unmounted:xn,activated:xn,deactivated:xn,errorCaptured:xn,serverPrefetch:xn,components:Sa,directives:Sa,watch:rE,provide:_m,inject:nE};function _m(n,e){return e?n?function(){return on(Fe(n)?n.call(this,this):n,Fe(e)?e.call(this,this):e)}:e:n}function nE(n,e){return Sa(yh(n),yh(e))}function yh(n){if(Ne(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function xn(n,e){return n?[...new Set([].concat(n,e))]:e}function Sa(n,e){return n?on(Object.create(null),n,e):e}function ym(n,e){return n?Ne(n)&&Ne(e)?[...new Set([...n,...e])]:on(Object.create(null),mm(n),mm(e??{})):e}function rE(n,e){if(!n)return e;if(!e)return n;const t=on(Object.create(null),n);for(const r in e)t[r]=xn(n[r],e[r]);return t}function Dy(){return{app:null,config:{isNativeTag:Wb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let sE=0;function iE(n,e){return function(r,s=null){Fe(r)||(r=on({},r)),s!=null&&!Pt(s)&&(s=null);const i=Dy(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:sE++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:UE,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&Fe(d.install)?(o.add(d),d.install(u,...f)):Fe(d)&&(o.add(d),d(u,...f))),u},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),u},component(d,f){return f?(i.components[d]=f,u):i.components[d]},directive(d,f){return f?(i.directives[d]=f,u):i.directives[d]},mount(d,f,g){if(!l){const _=u._ceVNode||Ut(r,s);return _.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),f&&e?e(_,d):n(_,d,g),l=!0,u._container=d,d.__vue_app__=u,Lu(_.component)}},onUnmount(d){a.push(d)},unmount(){l&&(br(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(d,f){return i.provides[d]=f,u},runWithContext(d){const f=ao;ao=u;try{return d()}finally{ao=f}}};return u}}let ao=null;function kc(n,e){if(vn){let t=vn.provides;const r=vn.parent&&vn.parent.provides;r===t&&(t=vn.provides=Object.create(r)),t[n]=e}}function ir(n,e,t=!1){const r=vn||zn;if(r||ao){let s=ao?ao._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&Fe(e)?e.call(r&&r.proxy):e}}const Ny={},Vy=()=>Object.create(Ny),Oy=n=>Object.getPrototypeOf(n)===Ny;function oE(n,e,t,r=!1){const s={},i=Vy();n.propsDefaults=Object.create(null),My(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:gy(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function aE(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=rt(s),[l]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(Ou(n.emitsOptions,g))continue;const _=e[g];if(l)if(st(i,g))_!==i[g]&&(i[g]=_,u=!0);else{const C=Qn(g);s[C]=vh(l,a,C,_,n,!1)}else _!==i[g]&&(i[g]=_,u=!0)}}}else{My(n,e,s,i)&&(u=!0);let d;for(const f in a)(!e||!st(e,f)&&((d=Ms(f))===f||!st(e,d)))&&(l?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=vh(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!st(e,f))&&(delete i[f],u=!0)}u&&Vr(n.attrs,"set","")}function My(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Ma(l))continue;const u=e[l];let d;s&&st(s,d=Qn(l))?!i||!i.includes(d)?t[d]=u:(a||(a={}))[d]=u:Ou(n.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(i){const l=rt(t),u=a||dt;for(let d=0;d<i.length;d++){const f=i[d];t[f]=vh(s,l,f,u[f],n,!st(u,f))}}return o}function vh(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=st(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Fe(l)){const{propsDefaults:u}=s;if(t in u)r=u[t];else{const d=xl(s);r=u[t]=l.call(null,e),d()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Ms(t))&&(r=!0))}return r}const lE=new WeakMap;function Ly(n,e,t=!1){const r=t?lE:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!Fe(n)){const d=f=>{l=!0;const[g,_]=Ly(f,e,!0);on(o,g),_&&a.push(..._)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!l)return Pt(n)&&r.set(n,no),no;if(Ne(i))for(let d=0;d<i.length;d++){const f=Qn(i[d]);vm(f)&&(o[f]=dt)}else if(i)for(const d in i){const f=Qn(d);if(vm(f)){const g=i[d],_=o[f]=Ne(g)||Fe(g)?{type:g}:on({},g),C=_.type;let x=!1,R=!0;if(Ne(C))for(let L=0;L<C.length;++L){const B=C[L],$=Fe(B)&&B.name;if($==="Boolean"){x=!0;break}else $==="String"&&(R=!1)}else x=Fe(C)&&C.name==="Boolean";_[0]=x,_[1]=R,(x||st(_,"default"))&&a.push(f)}}const u=[o,a];return Pt(n)&&r.set(n,u),u}function vm(n){return n[0]!=="$"&&!Ma(n)}const _f=n=>n[0]==="_"||n==="$stable",yf=n=>Ne(n)?n.map(fr):[fr(n)],cE=(n,e,t)=>{if(e._n)return e;const r=MI((...s)=>yf(e(...s)),t);return r._c=!1,r},Fy=(n,e,t)=>{const r=n._ctx;for(const s in n){if(_f(s))continue;const i=n[s];if(Fe(i))e[s]=cE(s,i,r);else if(i!=null){const o=yf(i);e[s]=()=>o}}},Uy=(n,e)=>{const t=yf(e);n.slots.default=()=>t},By=(n,e,t)=>{for(const r in e)(t||!_f(r))&&(n[r]=e[r])},uE=(n,e,t)=>{const r=n.slots=Vy();if(n.vnode.shapeFlag&32){const s=e.__;s&&uh(r,"__",s,!0);const i=e._;i?(By(r,e,t),t&&uh(r,"_",i,!0)):Fy(e,r)}else e&&Uy(n,e)},dE=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=dt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:By(s,e,t):(i=!e.$stable,Fy(e,s)),o=e}else e&&(Uy(n,e),o={default:1});if(i)for(const a in s)!_f(a)&&o[a]==null&&delete s[a]},jn=AE;function hE(n){return fE(n)}function fE(n,e){const t=Ru();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:d,parentNode:f,nextSibling:g,setScopeId:_=nr,insertStaticContent:C}=n,x=(b,E,M,J=null,G=null,Z=null,fe=void 0,oe=null,ne=!!E.dynamicChildren)=>{if(b===E)return;b&&!_a(b,E)&&(J=z(b),Ve(b,G,Z,!0),b=null),E.patchFlag===-2&&(ne=!1,E.dynamicChildren=null);const{type:ee,ref:Ae,shapeFlag:ae}=E;switch(ee){case Mu:R(b,E,M,J);break;case xs:L(b,E,M,J);break;case Dc:b==null&&B(E,M,J,fe);break;case Nt:D(b,E,M,J,G,Z,fe,oe,ne);break;default:ae&1?O(b,E,M,J,G,Z,fe,oe,ne):ae&6?A(b,E,M,J,G,Z,fe,oe,ne):(ae&64||ae&128)&&ee.process(b,E,M,J,G,Z,fe,oe,ne,ie)}Ae!=null&&G?Ua(Ae,b&&b.ref,Z,E||b,!E):Ae==null&&b&&b.ref!=null&&Ua(b.ref,null,Z,b,!0)},R=(b,E,M,J)=>{if(b==null)r(E.el=a(E.children),M,J);else{const G=E.el=b.el;E.children!==b.children&&u(G,E.children)}},L=(b,E,M,J)=>{b==null?r(E.el=l(E.children||""),M,J):E.el=b.el},B=(b,E,M,J)=>{[b.el,b.anchor]=C(b.children,E,M,J,b.el,b.anchor)},$=({el:b,anchor:E},M,J)=>{let G;for(;b&&b!==E;)G=g(b),r(b,M,J),b=G;r(E,M,J)},j=({el:b,anchor:E})=>{let M;for(;b&&b!==E;)M=g(b),s(b),b=M;s(E)},O=(b,E,M,J,G,Z,fe,oe,ne)=>{E.type==="svg"?fe="svg":E.type==="math"&&(fe="mathml"),b==null?se(E,M,J,G,Z,fe,oe,ne):I(b,E,G,Z,fe,oe,ne)},se=(b,E,M,J,G,Z,fe,oe)=>{let ne,ee;const{props:Ae,shapeFlag:ae,transition:Ie,dirs:Ce}=b;if(ne=b.el=o(b.type,Z,Ae&&Ae.is,Ae),ae&8?d(ne,b.children):ae&16&&w(b.children,ne,null,J,G,Md(b,Z),fe,oe),Ce&&Zs(b,null,J,"created"),T(ne,b,b.scopeId,fe,J),Ae){for(const ge in Ae)ge!=="value"&&!Ma(ge)&&i(ne,ge,null,Ae[ge],Z,J);"value"in Ae&&i(ne,"value",null,Ae.value,Z),(ee=Ae.onVnodeBeforeMount)&&dr(ee,J,b)}Ce&&Zs(b,null,J,"beforeMount");const Pe=pE(G,Ie);Pe&&Ie.beforeEnter(ne),r(ne,E,M),((ee=Ae&&Ae.onVnodeMounted)||Pe||Ce)&&jn(()=>{ee&&dr(ee,J,b),Pe&&Ie.enter(ne),Ce&&Zs(b,null,J,"mounted")},G)},T=(b,E,M,J,G)=>{if(M&&_(b,M),J)for(let Z=0;Z<J.length;Z++)_(b,J[Z]);if(G){let Z=G.subTree;if(E===Z||Ky(Z.type)&&(Z.ssContent===E||Z.ssFallback===E)){const fe=G.vnode;T(b,fe,fe.scopeId,fe.slotScopeIds,G.parent)}}},w=(b,E,M,J,G,Z,fe,oe,ne=0)=>{for(let ee=ne;ee<b.length;ee++){const Ae=b[ee]=oe?ds(b[ee]):fr(b[ee]);x(null,Ae,E,M,J,G,Z,fe,oe)}},I=(b,E,M,J,G,Z,fe)=>{const oe=E.el=b.el;let{patchFlag:ne,dynamicChildren:ee,dirs:Ae}=E;ne|=b.patchFlag&16;const ae=b.props||dt,Ie=E.props||dt;let Ce;if(M&&ei(M,!1),(Ce=Ie.onVnodeBeforeUpdate)&&dr(Ce,M,E,b),Ae&&Zs(E,b,M,"beforeUpdate"),M&&ei(M,!0),(ae.innerHTML&&Ie.innerHTML==null||ae.textContent&&Ie.textContent==null)&&d(oe,""),ee?S(b.dynamicChildren,ee,oe,M,J,Md(E,G),Z):fe||K(b,E,oe,null,M,J,Md(E,G),Z,!1),ne>0){if(ne&16)k(oe,ae,Ie,M,G);else if(ne&2&&ae.class!==Ie.class&&i(oe,"class",null,Ie.class,G),ne&4&&i(oe,"style",ae.style,Ie.style,G),ne&8){const Pe=E.dynamicProps;for(let ge=0;ge<Pe.length;ge++){const Re=Pe[ge],Gt=ae[Re],Mt=Ie[Re];(Mt!==Gt||Re==="value")&&i(oe,Re,Gt,Mt,G,M)}}ne&1&&b.children!==E.children&&d(oe,E.children)}else!fe&&ee==null&&k(oe,ae,Ie,M,G);((Ce=Ie.onVnodeUpdated)||Ae)&&jn(()=>{Ce&&dr(Ce,M,E,b),Ae&&Zs(E,b,M,"updated")},J)},S=(b,E,M,J,G,Z,fe)=>{for(let oe=0;oe<E.length;oe++){const ne=b[oe],ee=E[oe],Ae=ne.el&&(ne.type===Nt||!_a(ne,ee)||ne.shapeFlag&198)?f(ne.el):M;x(ne,ee,Ae,null,J,G,Z,fe,!0)}},k=(b,E,M,J,G)=>{if(E!==M){if(E!==dt)for(const Z in E)!Ma(Z)&&!(Z in M)&&i(b,Z,E[Z],null,G,J);for(const Z in M){if(Ma(Z))continue;const fe=M[Z],oe=E[Z];fe!==oe&&Z!=="value"&&i(b,Z,oe,fe,G,J)}"value"in M&&i(b,"value",E.value,M.value,G)}},D=(b,E,M,J,G,Z,fe,oe,ne)=>{const ee=E.el=b?b.el:a(""),Ae=E.anchor=b?b.anchor:a("");let{patchFlag:ae,dynamicChildren:Ie,slotScopeIds:Ce}=E;Ce&&(oe=oe?oe.concat(Ce):Ce),b==null?(r(ee,M,J),r(Ae,M,J),w(E.children||[],M,Ae,G,Z,fe,oe,ne)):ae>0&&ae&64&&Ie&&b.dynamicChildren?(S(b.dynamicChildren,Ie,M,G,Z,fe,oe),(E.key!=null||G&&E===G.subTree)&&$y(b,E,!0)):K(b,E,M,Ae,G,Z,fe,oe,ne)},A=(b,E,M,J,G,Z,fe,oe,ne)=>{E.slotScopeIds=oe,b==null?E.shapeFlag&512?G.ctx.activate(E,M,J,fe,ne):Jt(E,M,J,G,Z,fe,ne):qt(b,E,ne)},Jt=(b,E,M,J,G,Z,fe)=>{const oe=b.component=DE(b,J,G);if(Py(b)&&(oe.ctx.renderer=ie),NE(oe,!1,fe),oe.asyncDep){if(G&&G.registerDep(oe,Ze,fe),!b.el){const ne=oe.subTree=Ut(xs);L(null,ne,E,M)}}else Ze(oe,b,E,M,G,Z,fe)},qt=(b,E,M)=>{const J=E.component=b.component;if(EE(b,E,M))if(J.asyncDep&&!J.asyncResolved){ce(J,E,M);return}else J.next=E,J.update();else E.el=b.el,J.vnode=E},Ze=(b,E,M,J,G,Z,fe)=>{const oe=()=>{if(b.isMounted){let{next:ae,bu:Ie,u:Ce,parent:Pe,vnode:ge}=b;{const St=jy(b);if(St){ae&&(ae.el=ge.el,ce(b,ae,fe)),St.asyncDep.then(()=>{b.isUnmounted||oe()});return}}let Re=ae,Gt;ei(b,!1),ae?(ae.el=ge.el,ce(b,ae,fe)):ae=ge,Ie&&Cc(Ie),(Gt=ae.props&&ae.props.onVnodeBeforeUpdate)&&dr(Gt,Pe,ae,ge),ei(b,!0);const Mt=Ld(b),An=b.subTree;b.subTree=Mt,x(An,Mt,f(An.el),z(An),b,G,Z),ae.el=Mt.el,Re===null&&TE(b,Mt.el),Ce&&jn(Ce,G),(Gt=ae.props&&ae.props.onVnodeUpdated)&&jn(()=>dr(Gt,Pe,ae,ge),G)}else{let ae;const{el:Ie,props:Ce}=E,{bm:Pe,m:ge,parent:Re,root:Gt,type:Mt}=b,An=Ba(E);if(ei(b,!1),Pe&&Cc(Pe),!An&&(ae=Ce&&Ce.onVnodeBeforeMount)&&dr(ae,Re,E),ei(b,!0),Ie&&ze){const St=()=>{b.subTree=Ld(b),ze(Ie,b.subTree,b,G,null)};An&&Mt.__asyncHydrate?Mt.__asyncHydrate(Ie,b,St):St()}else{Gt.ce&&Gt.ce._def.shadowRoot!==!1&&Gt.ce._injectChildStyle(Mt);const St=b.subTree=Ld(b);x(null,St,M,J,b,G,Z),E.el=St.el}if(ge&&jn(ge,G),!An&&(ae=Ce&&Ce.onVnodeMounted)){const St=E;jn(()=>dr(ae,Re,St),G)}(E.shapeFlag&256||Re&&Ba(Re.vnode)&&Re.vnode.shapeFlag&256)&&b.a&&jn(b.a,G),b.isMounted=!0,E=M=J=null}};b.scope.on();const ne=b.effect=new ny(oe);b.scope.off();const ee=b.update=ne.run.bind(ne),Ae=b.job=ne.runIfDirty.bind(ne);Ae.i=b,Ae.id=b.uid,ne.scheduler=()=>ff(Ae),ei(b,!0),ee()},ce=(b,E,M)=>{E.component=b;const J=b.vnode.props;b.vnode=E,b.next=null,aE(b,E.props,J,M),dE(b,E.children,M),jr(),fm(b),qr()},K=(b,E,M,J,G,Z,fe,oe,ne=!1)=>{const ee=b&&b.children,Ae=b?b.shapeFlag:0,ae=E.children,{patchFlag:Ie,shapeFlag:Ce}=E;if(Ie>0){if(Ie&128){De(ee,ae,M,J,G,Z,fe,oe,ne);return}else if(Ie&256){Se(ee,ae,M,J,G,Z,fe,oe,ne);return}}Ce&8?(Ae&16&&zt(ee,G,Z),ae!==ee&&d(M,ae)):Ae&16?Ce&16?De(ee,ae,M,J,G,Z,fe,oe,ne):zt(ee,G,Z,!0):(Ae&8&&d(M,""),Ce&16&&w(ae,M,J,G,Z,fe,oe,ne))},Se=(b,E,M,J,G,Z,fe,oe,ne)=>{b=b||no,E=E||no;const ee=b.length,Ae=E.length,ae=Math.min(ee,Ae);let Ie;for(Ie=0;Ie<ae;Ie++){const Ce=E[Ie]=ne?ds(E[Ie]):fr(E[Ie]);x(b[Ie],Ce,M,null,G,Z,fe,oe,ne)}ee>Ae?zt(b,G,Z,!0,!1,ae):w(E,M,J,G,Z,fe,oe,ne,ae)},De=(b,E,M,J,G,Z,fe,oe,ne)=>{let ee=0;const Ae=E.length;let ae=b.length-1,Ie=Ae-1;for(;ee<=ae&&ee<=Ie;){const Ce=b[ee],Pe=E[ee]=ne?ds(E[ee]):fr(E[ee]);if(_a(Ce,Pe))x(Ce,Pe,M,null,G,Z,fe,oe,ne);else break;ee++}for(;ee<=ae&&ee<=Ie;){const Ce=b[ae],Pe=E[Ie]=ne?ds(E[Ie]):fr(E[Ie]);if(_a(Ce,Pe))x(Ce,Pe,M,null,G,Z,fe,oe,ne);else break;ae--,Ie--}if(ee>ae){if(ee<=Ie){const Ce=Ie+1,Pe=Ce<Ae?E[Ce].el:J;for(;ee<=Ie;)x(null,E[ee]=ne?ds(E[ee]):fr(E[ee]),M,Pe,G,Z,fe,oe,ne),ee++}}else if(ee>Ie)for(;ee<=ae;)Ve(b[ee],G,Z,!0),ee++;else{const Ce=ee,Pe=ee,ge=new Map;for(ee=Pe;ee<=Ie;ee++){const Dt=E[ee]=ne?ds(E[ee]):fr(E[ee]);Dt.key!=null&&ge.set(Dt.key,ee)}let Re,Gt=0;const Mt=Ie-Pe+1;let An=!1,St=0;const lr=new Array(Mt);for(ee=0;ee<Mt;ee++)lr[ee]=0;for(ee=Ce;ee<=ae;ee++){const Dt=b[ee];if(Gt>=Mt){Ve(Dt,G,Z,!0);continue}let Yt;if(Dt.key!=null)Yt=ge.get(Dt.key);else for(Re=Pe;Re<=Ie;Re++)if(lr[Re-Pe]===0&&_a(Dt,E[Re])){Yt=Re;break}Yt===void 0?Ve(Dt,G,Z,!0):(lr[Yt-Pe]=ee+1,Yt>=St?St=Yt:An=!0,x(Dt,E[Yt],M,null,G,Z,fe,oe,ne),Gt++)}const Xn=An?mE(lr):no;for(Re=Xn.length-1,ee=Mt-1;ee>=0;ee--){const Dt=Pe+ee,Yt=E[Dt],Zn=Dt+1<Ae?E[Dt+1].el:J;lr[ee]===0?x(null,Yt,M,Zn,G,Z,fe,oe,ne):An&&(Re<0||ee!==Xn[Re]?Qe(Yt,M,Zn,2):Re--)}}},Qe=(b,E,M,J,G=null)=>{const{el:Z,type:fe,transition:oe,children:ne,shapeFlag:ee}=b;if(ee&6){Qe(b.component.subTree,E,M,J);return}if(ee&128){b.suspense.move(E,M,J);return}if(ee&64){fe.move(b,E,M,ie);return}if(fe===Nt){r(Z,E,M);for(let ae=0;ae<ne.length;ae++)Qe(ne[ae],E,M,J);r(b.anchor,E,M);return}if(fe===Dc){$(b,E,M);return}if(J!==2&&ee&1&&oe)if(J===0)oe.beforeEnter(Z),r(Z,E,M),jn(()=>oe.enter(Z),G);else{const{leave:ae,delayLeave:Ie,afterLeave:Ce}=oe,Pe=()=>{b.ctx.isUnmounted?s(Z):r(Z,E,M)},ge=()=>{ae(Z,()=>{Pe(),Ce&&Ce()})};Ie?Ie(Z,Pe,ge):ge()}else r(Z,E,M)},Ve=(b,E,M,J=!1,G=!1)=>{const{type:Z,props:fe,ref:oe,children:ne,dynamicChildren:ee,shapeFlag:Ae,patchFlag:ae,dirs:Ie,cacheIndex:Ce}=b;if(ae===-2&&(G=!1),oe!=null&&(jr(),Ua(oe,null,M,b,!0),qr()),Ce!=null&&(E.renderCache[Ce]=void 0),Ae&256){E.ctx.deactivate(b);return}const Pe=Ae&1&&Ie,ge=!Ba(b);let Re;if(ge&&(Re=fe&&fe.onVnodeBeforeUnmount)&&dr(Re,E,b),Ae&6)Tn(b.component,M,J);else{if(Ae&128){b.suspense.unmount(M,J);return}Pe&&Zs(b,null,E,"beforeUnmount"),Ae&64?b.type.remove(b,E,M,ie,J):ee&&!ee.hasOnce&&(Z!==Nt||ae>0&&ae&64)?zt(ee,E,M,!1,!0):(Z===Nt&&ae&384||!G&&Ae&16)&&zt(ne,E,M),J&&Ye(b)}(ge&&(Re=fe&&fe.onVnodeUnmounted)||Pe)&&jn(()=>{Re&&dr(Re,E,b),Pe&&Zs(b,null,E,"unmounted")},M)},Ye=b=>{const{type:E,el:M,anchor:J,transition:G}=b;if(E===Nt){hn(M,J);return}if(E===Dc){j(b);return}const Z=()=>{s(M),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(b.shapeFlag&1&&G&&!G.persisted){const{leave:fe,delayLeave:oe}=G,ne=()=>fe(M,Z);oe?oe(b.el,Z,ne):ne()}else Z()},hn=(b,E)=>{let M;for(;b!==E;)M=g(b),s(b),b=M;s(E)},Tn=(b,E,M)=>{const{bum:J,scope:G,job:Z,subTree:fe,um:oe,m:ne,a:ee,parent:Ae,slots:{__:ae}}=b;wm(ne),wm(ee),J&&Cc(J),Ae&&Ne(ae)&&ae.forEach(Ie=>{Ae.renderCache[Ie]=void 0}),G.stop(),Z&&(Z.flags|=8,Ve(fe,b,E,M)),oe&&jn(oe,E),jn(()=>{b.isUnmounted=!0},E),E&&E.pendingBranch&&!E.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===E.pendingId&&(E.deps--,E.deps===0&&E.resolve())},zt=(b,E,M,J=!1,G=!1,Z=0)=>{for(let fe=Z;fe<b.length;fe++)Ve(b[fe],E,M,J,G)},z=b=>{if(b.shapeFlag&6)return z(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const E=g(b.anchor||b.el),M=E&&E[LI];return M?g(M):E};let me=!1;const ue=(b,E,M)=>{b==null?E._vnode&&Ve(E._vnode,null,null,!0):x(E._vnode||null,b,E,null,null,null,M),E._vnode=b,me||(me=!0,fm(),Iy(),me=!1)},ie={p:x,um:Ve,m:Qe,r:Ye,mt:Jt,mc:w,pc:K,pbc:S,n:z,o:n};let Oe,ze;return e&&([Oe,ze]=e(ie)),{render:ue,hydrate:Oe,createApp:iE(ue,Oe)}}function Md({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function ei({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function pE(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function $y(n,e,t=!1){const r=n.children,s=e.children;if(Ne(r)&&Ne(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=ds(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&$y(o,a)),a.type===Mu&&(a.el=o.el),a.type===xs&&!a.el&&(a.el=o.el)}}function mE(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const u=n[r];if(u!==0){if(s=t[t.length-1],n[s]<u){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<u?i=a+1:o=a;u<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function jy(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:jy(e)}function wm(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const gE=Symbol.for("v-scx"),_E=()=>ir(gE);function or(n,e,t){return qy(n,e,t)}function qy(n,e,t=dt){const{immediate:r,deep:s,flush:i,once:o}=t,a=on({},t),l=e&&r||!e&&i!=="post";let u;if(nl){if(i==="sync"){const _=_E();u=_.__watcherHandles||(_.__watcherHandles=[])}else if(!l){const _=()=>{};return _.stop=nr,_.resume=nr,_.pause=nr,_}}const d=vn;a.call=(_,C,x)=>br(_,d,C,x);let f=!1;i==="post"?a.scheduler=_=>{jn(_,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(_,C)=>{C?_():ff(_)}),a.augmentJob=_=>{e&&(_.flags|=4),f&&(_.flags|=2,d&&(_.id=d.uid,_.i=d))};const g=DI(n,e,a);return nl&&(u?u.push(g):l&&g()),g}function yE(n,e,t){const r=this.proxy,s=Qt(n)?n.includes(".")?zy(r,n):()=>r[n]:n.bind(r,r);let i;Fe(e)?i=e:(i=e.handler,t=e);const o=xl(this),a=qy(s,i.bind(r),t);return o(),a}function zy(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const vE=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${Qn(e)}Modifiers`]||n[`${Ms(e)}Modifiers`];function wE(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||dt;let s=t;const i=e.startsWith("update:"),o=i&&vE(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>Qt(d)?d.trim():d)),o.number&&(s=t.map(dh)));let a,l=r[a=Cd(e)]||r[a=Cd(Qn(e))];!l&&i&&(l=r[a=Cd(Ms(e))]),l&&br(l,n,6,s);const u=r[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,br(u,n,6,s)}}function Gy(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!Fe(n)){const l=u=>{const d=Gy(u,e,!0);d&&(a=!0,on(o,d))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(Pt(n)&&r.set(n,null),null):(Ne(i)?i.forEach(l=>o[l]=null):on(o,i),Pt(n)&&r.set(n,o),o)}function Ou(n,e){return!n||!Au(e)?!1:(e=e.slice(2).replace(/Once$/,""),st(n,e[0].toLowerCase()+e.slice(1))||st(n,Ms(e))||st(n,e))}function Ld(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:d,props:f,data:g,setupState:_,ctx:C,inheritAttrs:x}=n,R=Xc(n);let L,B;try{if(t.shapeFlag&4){const j=s||r,O=j;L=fr(u.call(O,j,d,f,_,g,C)),B=a}else{const j=e;L=fr(j.length>1?j(f,{attrs:a,slots:o,emit:l}):j(f,null)),B=e.props?a:bE(a)}}catch(j){ja.length=0,Nu(j,n,1),L=Ut(xs)}let $=L;if(B&&x!==!1){const j=Object.keys(B),{shapeFlag:O}=$;j.length&&O&7&&(i&&j.some(nf)&&(B=IE(B,i)),$=_o($,B,!1,!0))}return t.dirs&&($=_o($,null,!1,!0),$.dirs=$.dirs?$.dirs.concat(t.dirs):t.dirs),t.transition&&pf($,t.transition),L=$,Xc(R),L}const bE=n=>{let e;for(const t in n)(t==="class"||t==="style"||Au(t))&&((e||(e={}))[t]=n[t]);return e},IE=(n,e)=>{const t={};for(const r in n)(!nf(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function EE(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?bm(r,o,u):!!o;if(l&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(o[g]!==r[g]&&!Ou(u,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?bm(r,o,u):!0:!!o;return!1}function bm(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Ou(t,i))return!0}return!1}function TE({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const Ky=n=>n.__isSuspense;function AE(n,e){e&&e.pendingBranch?Ne(n)?e.effects.push(...n):e.effects.push(n):OI(n)}const Nt=Symbol.for("v-fgt"),Mu=Symbol.for("v-txt"),xs=Symbol.for("v-cmt"),Dc=Symbol.for("v-stc"),ja=[];let Gn=null;function H(n=!1){ja.push(Gn=n?null:[])}function xE(){ja.pop(),Gn=ja[ja.length-1]||null}let tl=1;function Im(n,e=!1){tl+=n,n<0&&Gn&&e&&(Gn.hasOnce=!0)}function Hy(n){return n.dynamicChildren=tl>0?Gn||no:null,xE(),tl>0&&Gn&&Gn.push(n),n}function W(n,e,t,r,s,i){return Hy(m(n,e,t,r,s,i,!0))}function Wy(n,e,t,r,s){return Hy(Ut(n,e,t,r,s,!0))}function eu(n){return n?n.__v_isVNode===!0:!1}function _a(n,e){return n.type===e.type&&n.key===e.key}const Qy=({key:n})=>n??null,Nc=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Qt(n)||wn(n)||Fe(n)?{i:zn,r:n,k:e,f:!!t}:n:null);function m(n,e=null,t=null,r=0,s=null,i=n===Nt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&Qy(e),ref:e&&Nc(e),scopeId:Ty,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:zn};return a?(vf(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=Qt(t)?8:16),tl>0&&!o&&Gn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Gn.push(l),l}const Ut=PE;function PE(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===JI)&&(n=xs),eu(n)){const a=_o(n,e,!0);return t&&vf(a,t),tl>0&&!i&&Gn&&(a.shapeFlag&6?Gn[Gn.indexOf(n)]=a:Gn.push(a)),a.patchFlag=-2,a}if(FE(n)&&(n=n.__vccOpts),e){e=SE(e);let{class:a,style:l}=e;a&&!Qt(a)&&(e.class=rr(a)),Pt(l)&&(hf(l)&&!Ne(l)&&(l=on({},l)),e.style=Cu(l))}const o=Qt(n)?1:Ky(n)?128:FI(n)?64:Pt(n)?4:Fe(n)?2:0;return m(n,e,t,r,s,o,i,!0)}function SE(n){return n?hf(n)||Oy(n)?on({},n):n:null}function _o(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,u=e?RE(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&Qy(u),ref:e&&e.ref?t&&i?Ne(i)?i.concat(Nc(e)):[i,Nc(e)]:Nc(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Nt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&_o(n.ssContent),ssFallback:n.ssFallback&&_o(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&pf(d,l.clone(d)),d}function qn(n=" ",e=0){return Ut(Mu,null,n,e)}function Dr(n,e){const t=Ut(Dc,null,n);return t.staticCount=e,t}function xe(n="",e=!1){return e?(H(),Wy(xs,null,n)):Ut(xs,null,n)}function fr(n){return n==null||typeof n=="boolean"?Ut(xs):Ne(n)?Ut(Nt,null,n.slice()):eu(n)?ds(n):Ut(Mu,null,String(n))}function ds(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:_o(n)}function vf(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Ne(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),vf(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Oy(e)?e._ctx=zn:s===3&&zn&&(zn.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Fe(e)?(e={default:e,_ctx:zn},t=32):(e=String(e),r&64?(t=16,e=[qn(e)]):t=8);n.children=e,n.shapeFlag|=t}function RE(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=rr([e.class,r.class]));else if(s==="style")e.style=Cu([e.style,r.style]);else if(Au(s)){const i=e[s],o=r[s];o&&i!==o&&!(Ne(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function dr(n,e,t,r=null){br(n,e,7,[t,r])}const CE=Dy();let kE=0;function DE(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||CE,i={uid:kE++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new iI(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ly(r,s),emitsOptions:Gy(r,s),emit:null,emitted:null,propsDefaults:dt,inheritAttrs:r.inheritAttrs,ctx:dt,data:dt,props:dt,attrs:dt,slots:dt,refs:dt,setupState:dt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=wE.bind(null,i),n.ce&&n.ce(i),i}let vn=null,tu,wh;{const n=Ru(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};tu=e("__VUE_INSTANCE_SETTERS__",t=>vn=t),wh=e("__VUE_SSR_SETTERS__",t=>nl=t)}const xl=n=>{const e=vn;return tu(n),n.scope.on(),()=>{n.scope.off(),tu(e)}},Em=()=>{vn&&vn.scope.off(),tu(null)};function Jy(n){return n.vnode.shapeFlag&4}let nl=!1;function NE(n,e=!1,t=!1){e&&wh(e);const{props:r,children:s}=n.vnode,i=Jy(n);oE(n,r,i,e),uE(n,s,t||e);const o=i?VE(n,e):void 0;return e&&wh(!1),o}function VE(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,XI);const{setup:r}=t;if(r){jr();const s=n.setupContext=r.length>1?ME(n):null,i=xl(n),o=Al(r,n,0,[n.props,s]),a=J_(o);if(qr(),i(),(a||n.sp)&&!Ba(n)&&xy(n),a){if(o.then(Em,Em),e)return o.then(l=>{Tm(n,l,e)}).catch(l=>{Nu(l,n,0)});n.asyncDep=o}else Tm(n,o,e)}else Yy(n,e)}function Tm(n,e,t){Fe(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Pt(e)&&(n.setupState=vy(e)),Yy(n,t)}let Am;function Yy(n,e,t){const r=n.type;if(!n.render){if(!e&&Am&&!r.render){const s=r.template||gf(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,u=on(on({isCustomElement:i,delimiters:a},o),l);r.render=Am(s,u)}}n.render=r.render||nr}{const s=xl(n);jr();try{ZI(n)}finally{qr(),s()}}}const OE={get(n,e){return yn(n,"get",""),n[e]}};function ME(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,OE),slots:n.slots,emit:n.emit,expose:e}}function Lu(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(vy(AI(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in $a)return $a[t](n)},has(e,t){return t in e||t in $a}})):n.proxy}function LE(n,e=!0){return Fe(n)?n.displayName||n.name:n.name||e&&n.__name}function FE(n){return Fe(n)&&"__vccOpts"in n}const Lt=(n,e)=>CI(n,e,nl);function Xy(n,e,t){const r=arguments.length;return r===2?Pt(e)&&!Ne(e)?eu(e)?Ut(n,null,[e]):Ut(n,e):Ut(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&eu(t)&&(t=[t]),Ut(n,e,t))}const UE="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bh;const xm=typeof window<"u"&&window.trustedTypes;if(xm)try{bh=xm.createPolicy("vue",{createHTML:n=>n})}catch{}const Zy=bh?n=>bh.createHTML(n):n=>n,BE="http://www.w3.org/2000/svg",$E="http://www.w3.org/1998/Math/MathML",Nr=typeof document<"u"?document:null,Pm=Nr&&Nr.createElement("template"),jE={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?Nr.createElementNS(BE,n):e==="mathml"?Nr.createElementNS($E,n):t?Nr.createElement(n,{is:t}):Nr.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>Nr.createTextNode(n),createComment:n=>Nr.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Nr.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Pm.innerHTML=Zy(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Pm.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},qE=Symbol("_vtc");function zE(n,e,t){const r=n[qE];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const nu=Symbol("_vod"),ev=Symbol("_vsh"),Fd={beforeMount(n,{value:e},{transition:t}){n[nu]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):ya(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),ya(n,!0),r.enter(n)):r.leave(n,()=>{ya(n,!1)}):ya(n,e))},beforeUnmount(n,{value:e}){ya(n,e)}};function ya(n,e){n.style.display=e?n[nu]:"none",n[ev]=!e}const GE=Symbol(""),KE=/(^|;)\s*display\s*:/;function HE(n,e,t){const r=n.style,s=Qt(t);let i=!1;if(t&&!s){if(e)if(Qt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Vc(r,a,"")}else for(const o in e)t[o]==null&&Vc(r,o,"");for(const o in t)o==="display"&&(i=!0),Vc(r,o,t[o])}else if(s){if(e!==t){const o=r[GE];o&&(t+=";"+o),r.cssText=t,i=KE.test(t)}}else e&&n.removeAttribute("style");nu in n&&(n[nu]=i?r.display:"",n[ev]&&(r.display="none"))}const Sm=/\s*!important$/;function Vc(n,e,t){if(Ne(t))t.forEach(r=>Vc(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=WE(n,e);Sm.test(t)?n.setProperty(Ms(r),t.replace(Sm,""),"important"):n[r]=t}}const Rm=["Webkit","Moz","ms"],Ud={};function WE(n,e){const t=Ud[e];if(t)return t;let r=Qn(e);if(r!=="filter"&&r in n)return Ud[e]=r;r=Su(r);for(let s=0;s<Rm.length;s++){const i=Rm[s]+r;if(i in n)return Ud[e]=i}return e}const Cm="http://www.w3.org/1999/xlink";function km(n,e,t,r,s,i=sI(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Cm,e.slice(6,e.length)):n.setAttributeNS(Cm,e,t):t==null||i&&!Z_(t)?n.removeAttribute(e):n.setAttribute(e,i?"":Os(t)?String(t):t)}function Dm(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?Zy(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=Z_(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function Ji(n,e,t,r){n.addEventListener(e,t,r)}function QE(n,e,t,r){n.removeEventListener(e,t,r)}const Nm=Symbol("_vei");function JE(n,e,t,r,s=null){const i=n[Nm]||(n[Nm]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=YE(e);if(r){const u=i[e]=eT(r,s);Ji(n,a,u,l)}else o&&(QE(n,a,o,l),i[e]=void 0)}}const Vm=/(?:Once|Passive|Capture)$/;function YE(n){let e;if(Vm.test(n)){e={};let r;for(;r=n.match(Vm);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Ms(n.slice(2)),e]}let Bd=0;const XE=Promise.resolve(),ZE=()=>Bd||(XE.then(()=>Bd=0),Bd=Date.now());function eT(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;br(tT(r,t.value),e,5,[r])};return t.value=n,t.attached=ZE(),t}function tT(n,e){if(Ne(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Om=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,nT=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?zE(n,r,o):e==="style"?HE(n,t,r):Au(e)?nf(e)||JE(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):rT(n,e,r,o))?(Dm(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&km(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Qt(r))?Dm(n,Qn(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),km(n,e,r,o))};function rT(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Om(e)&&Fe(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Om(e)&&Qt(t)?!1:e in n}const Mm=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Ne(e)?t=>Cc(e,t):e};function sT(n){n.target.composing=!0}function Lm(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const $d=Symbol("_assign"),Rt={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[$d]=Mm(s);const i=r||s.props&&s.props.type==="number";Ji(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=dh(a)),n[$d](a)}),t&&Ji(n,"change",()=>{n.value=n.value.trim()}),e||(Ji(n,"compositionstart",sT),Ji(n,"compositionend",Lm),Ji(n,"change",Lm))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[$d]=Mm(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?dh(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},iT=["ctrl","shift","alt","meta"],oT={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>iT.some(t=>n[`${t}Key`]&&!e.includes(t))},Dn=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=oT[e[o]];if(a&&a(s,e))return}return n(s,...i)})},aT={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Pn=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Ms(s.key);if(e.some(o=>o===i||aT[o]===i))return n(s)})},lT=on({patchProp:nT},jE);let Fm;function cT(){return Fm||(Fm=hE(lT))}const uT=(...n)=>{const e=cT().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=hT(r);if(!s)return;const i=e._component;!Fe(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,dT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function dT(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function hT(n){return Qt(n)?document.querySelector(n):n}const fT={__name:"App",setup(n){return(e,t)=>{const r=QI("router-view");return H(),Wy(r)}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Yi=typeof document<"u";function tv(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function pT(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&tv(n.default)}const nt=Object.assign;function jd(n,e){const t={};for(const r in e){const s=e[r];t[r]=ar(s)?s.map(n):n(s)}return t}const qa=()=>{},ar=Array.isArray,nv=/#/g,mT=/&/g,gT=/\//g,_T=/=/g,yT=/\?/g,rv=/\+/g,vT=/%5B/g,wT=/%5D/g,sv=/%5E/g,bT=/%60/g,iv=/%7B/g,IT=/%7C/g,ov=/%7D/g,ET=/%20/g;function wf(n){return encodeURI(""+n).replace(IT,"|").replace(vT,"[").replace(wT,"]")}function TT(n){return wf(n).replace(iv,"{").replace(ov,"}").replace(sv,"^")}function Ih(n){return wf(n).replace(rv,"%2B").replace(ET,"+").replace(nv,"%23").replace(mT,"%26").replace(bT,"`").replace(iv,"{").replace(ov,"}").replace(sv,"^")}function AT(n){return Ih(n).replace(_T,"%3D")}function xT(n){return wf(n).replace(nv,"%23").replace(yT,"%3F")}function PT(n){return n==null?"":xT(n).replace(gT,"%2F")}function rl(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const ST=/\/$/,RT=n=>n.replace(ST,"");function qd(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=NT(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:rl(o)}}function CT(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Um(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function kT(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&yo(e.matched[r],t.matched[s])&&av(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function yo(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function av(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!DT(n[t],e[t]))return!1;return!0}function DT(n,e){return ar(n)?Bm(n,e):ar(e)?Bm(e,n):n===e}function Bm(n,e){return ar(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function NT(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const os={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var sl;(function(n){n.pop="pop",n.push="push"})(sl||(sl={}));var za;(function(n){n.back="back",n.forward="forward",n.unknown=""})(za||(za={}));function VT(n){if(!n)if(Yi){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),RT(n)}const OT=/^[^#]+#/;function MT(n,e){return n.replace(OT,"#")+e}function LT(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Fu=()=>({left:window.scrollX,top:window.scrollY});function FT(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=LT(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function $m(n,e){return(history.state?history.state.position-e:-1)+n}const Eh=new Map;function UT(n,e){Eh.set(n,e)}function BT(n){const e=Eh.get(n);return Eh.delete(n),e}let $T=()=>location.protocol+"//"+location.host;function lv(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),Um(l,"")}return Um(t,n)+r+s}function jT(n,e,t,r){let s=[],i=[],o=null;const a=({state:g})=>{const _=lv(n,location),C=t.value,x=e.value;let R=0;if(g){if(t.value=_,e.value=g,o&&o===C){o=null;return}R=x?g.position-x.position:0}else r(_);s.forEach(L=>{L(t.value,C,{delta:R,type:sl.pop,direction:R?R>0?za.forward:za.back:za.unknown})})};function l(){o=t.value}function u(g){s.push(g);const _=()=>{const C=s.indexOf(g);C>-1&&s.splice(C,1)};return i.push(_),_}function d(){const{history:g}=window;g.state&&g.replaceState(nt({},g.state,{scroll:Fu()}),"")}function f(){for(const g of i)g();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:u,destroy:f}}function jm(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?Fu():null}}function qT(n){const{history:e,location:t}=window,r={value:lv(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,u,d){const f=n.indexOf("#"),g=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:$T()+n+l;try{e[d?"replaceState":"pushState"](u,"",g),s.value=u}catch(_){console.error(_),t[d?"replace":"assign"](g)}}function o(l,u){const d=nt({},e.state,jm(s.value.back,l,s.value.forward,!0),u,{position:s.value.position});i(l,d,!0),r.value=l}function a(l,u){const d=nt({},s.value,e.state,{forward:l,scroll:Fu()});i(d.current,d,!0);const f=nt({},jm(r.value,l,null),{position:d.position+1},u);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function zT(n){n=VT(n);const e=qT(n),t=jT(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=nt({location:"",base:n,go:r,createHref:MT.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function GT(n){return typeof n=="string"||n&&typeof n=="object"}function cv(n){return typeof n=="string"||typeof n=="symbol"}const uv=Symbol("");var qm;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(qm||(qm={}));function vo(n,e){return nt(new Error,{type:n,[uv]:!0},e)}function kr(n,e){return n instanceof Error&&uv in n&&(e==null||!!(n.type&e))}const zm="[^/]+?",KT={sensitive:!1,strict:!1,start:!0,end:!0},HT=/[.+*?^${}()[\]/\\]/g;function WT(n,e){const t=nt({},KT,e),r=[];let s=t.start?"^":"";const i=[];for(const u of n){const d=u.length?[]:[90];t.strict&&!u.length&&(s+="/");for(let f=0;f<u.length;f++){const g=u[f];let _=40+(t.sensitive?.25:0);if(g.type===0)f||(s+="/"),s+=g.value.replace(HT,"\\$&"),_+=40;else if(g.type===1){const{value:C,repeatable:x,optional:R,regexp:L}=g;i.push({name:C,repeatable:x,optional:R});const B=L||zm;if(B!==zm){_+=10;try{new RegExp(`(${B})`)}catch(j){throw new Error(`Invalid custom RegExp for param "${C}" (${B}): `+j.message)}}let $=x?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;f||($=R&&u.length<2?`(?:/${$})`:"/"+$),R&&($+="?"),s+=$,_+=20,R&&(_+=-8),x&&(_+=-20),B===".*"&&(_+=-50)}d.push(_)}r.push(d)}if(t.strict&&t.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(u){const d=u.match(o),f={};if(!d)return null;for(let g=1;g<d.length;g++){const _=d[g]||"",C=i[g-1];f[C.name]=_&&C.repeatable?_.split("/"):_}return f}function l(u){let d="",f=!1;for(const g of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const _ of g)if(_.type===0)d+=_.value;else if(_.type===1){const{value:C,repeatable:x,optional:R}=_,L=C in u?u[C]:"";if(ar(L)&&!x)throw new Error(`Provided param "${C}" is an array but it is not repeatable (* or + modifiers)`);const B=ar(L)?L.join("/"):L;if(!B)if(R)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${C}"`);d+=B}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function QT(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function dv(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=QT(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(Gm(r))return 1;if(Gm(s))return-1}return s.length-r.length}function Gm(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const JT={type:0,value:""},YT=/[a-zA-Z0-9_]/;function XT(n){if(!n)return[[]];if(n==="/")return[[JT]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(_){throw new Error(`ERR (${t})/"${u}": ${_}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,u="",d="";function f(){u&&(t===0?i.push({type:0,value:u}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function g(){u+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(u&&f(),o()):l===":"?(f(),t=1):g();break;case 4:g(),t=r;break;case 1:l==="("?t=2:YT.test(l)?g():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:t=3:d+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),s}function ZT(n,e,t){const r=WT(XT(n.path),t),s=nt(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function eA(n,e){const t=[],r=new Map;e=Qm({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,g,_){const C=!_,x=Hm(f);x.aliasOf=_&&_.record;const R=Qm(e,f),L=[x];if("alias"in f){const j=typeof f.alias=="string"?[f.alias]:f.alias;for(const O of j)L.push(Hm(nt({},x,{components:_?_.record.components:x.components,path:O,aliasOf:_?_.record:x})))}let B,$;for(const j of L){const{path:O}=j;if(g&&O[0]!=="/"){const se=g.record.path,T=se[se.length-1]==="/"?"":"/";j.path=g.record.path+(O&&T+O)}if(B=ZT(j,g,R),_?_.alias.push(B):($=$||B,$!==B&&$.alias.push(B),C&&f.name&&!Wm(B)&&o(f.name)),hv(B)&&l(B),x.children){const se=x.children;for(let T=0;T<se.length;T++)i(se[T],B,_&&_.children[T])}_=_||B}return $?()=>{o($)}:qa}function o(f){if(cv(f)){const g=r.get(f);g&&(r.delete(f),t.splice(t.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=t.indexOf(f);g>-1&&(t.splice(g,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const g=rA(f,t);t.splice(g,0,f),f.record.name&&!Wm(f)&&r.set(f.record.name,f)}function u(f,g){let _,C={},x,R;if("name"in f&&f.name){if(_=r.get(f.name),!_)throw vo(1,{location:f});R=_.record.name,C=nt(Km(g.params,_.keys.filter($=>!$.optional).concat(_.parent?_.parent.keys.filter($=>$.optional):[]).map($=>$.name)),f.params&&Km(f.params,_.keys.map($=>$.name))),x=_.stringify(C)}else if(f.path!=null)x=f.path,_=t.find($=>$.re.test(x)),_&&(C=_.parse(x),R=_.record.name);else{if(_=g.name?r.get(g.name):t.find($=>$.re.test(g.path)),!_)throw vo(1,{location:f,currentLocation:g});R=_.record.name,C=nt({},g.params,f.params),x=_.stringify(C)}const L=[];let B=_;for(;B;)L.unshift(B.record),B=B.parent;return{name:R,path:x,params:C,matched:L,meta:nA(L)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function Km(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function Hm(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:tA(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function tA(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function Wm(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function nA(n){return n.reduce((e,t)=>nt(e,t.meta),{})}function Qm(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function rA(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;dv(n,e[i])<0?r=i:t=i+1}const s=sA(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function sA(n){let e=n;for(;e=e.parent;)if(hv(e)&&dv(n,e)===0)return e}function hv({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function iA(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(rv," "),o=i.indexOf("="),a=rl(o<0?i:i.slice(0,o)),l=o<0?null:rl(i.slice(o+1));if(a in e){let u=e[a];ar(u)||(u=e[a]=[u]),u.push(l)}else e[a]=l}return e}function Jm(n){let e="";for(let t in n){const r=n[t];if(t=AT(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(ar(r)?r.map(i=>i&&Ih(i)):[r&&Ih(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function oA(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=ar(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const aA=Symbol(""),Ym=Symbol(""),Uu=Symbol(""),bf=Symbol(""),Th=Symbol("");function va(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function hs(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const u=g=>{g===!1?l(vo(4,{from:t,to:e})):g instanceof Error?l(g):GT(g)?l(vo(2,{from:e,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),a())},d=i(()=>n.call(r&&r.instances[s],e,t,u));let f=Promise.resolve(d);n.length<3&&(f=f.then(u)),f.catch(g=>l(g))})}function zd(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(tv(l)){const d=(l.__vccOpts||l)[e];d&&i.push(hs(d,t,r,o,a,s))}else{let u=l();i.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=pT(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const _=(f.__vccOpts||f)[e];return _&&hs(_,t,r,o,a,s)()}))}}return i}function Xm(n){const e=ir(Uu),t=ir(bf),r=Lt(()=>{const l=io(n.to);return e.resolve(l)}),s=Lt(()=>{const{matched:l}=r.value,{length:u}=l,d=l[u-1],f=t.matched;if(!d||!f.length)return-1;const g=f.findIndex(yo.bind(null,d));if(g>-1)return g;const _=Zm(l[u-2]);return u>1&&Zm(d)===_&&f[f.length-1].path!==_?f.findIndex(yo.bind(null,l[u-2])):g}),i=Lt(()=>s.value>-1&&hA(t.params,r.value.params)),o=Lt(()=>s.value>-1&&s.value===t.matched.length-1&&av(t.params,r.value.params));function a(l={}){if(dA(l)){const u=e[io(n.replace)?"replace":"push"](io(n.to)).catch(qa);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:Lt(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function lA(n){return n.length===1?n[0]:n}const cA=Ay({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Xm,setup(n,{slots:e}){const t=Du(Xm(n)),{options:r}=ir(Uu),s=Lt(()=>({[eg(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[eg(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&lA(e.default(t));return n.custom?i:Xy("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),uA=cA;function dA(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function hA(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!ar(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Zm(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const eg=(n,e,t)=>n??e??t,fA=Ay({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=ir(Th),s=Lt(()=>n.route||r.value),i=ir(Ym,0),o=Lt(()=>{let u=io(i);const{matched:d}=s.value;let f;for(;(f=d[u])&&!f.components;)u++;return u}),a=Lt(()=>s.value.matched[o.value]);kc(Ym,Lt(()=>o.value+1)),kc(aA,a),kc(Th,s);const l=q();return or(()=>[l.value,a.value,n.name],([u,d,f],[g,_,C])=>{d&&(d.instances[f]=u,_&&_!==d&&u&&u===g&&(d.leaveGuards.size||(d.leaveGuards=_.leaveGuards),d.updateGuards.size||(d.updateGuards=_.updateGuards))),u&&d&&(!_||!yo(d,_)||!g)&&(d.enterCallbacks[f]||[]).forEach(x=>x(u))},{flush:"post"}),()=>{const u=s.value,d=n.name,f=a.value,g=f&&f.components[d];if(!g)return tg(t.default,{Component:g,route:u});const _=f.props[d],C=_?_===!0?u.params:typeof _=="function"?_(u):_:null,R=Xy(g,nt({},C,e,{onVnodeUnmounted:L=>{L.component.isUnmounted&&(f.instances[d]=null)},ref:l}));return tg(t.default,{Component:R,route:u})||R}}});function tg(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const pA=fA;function mA(n){const e=eA(n.routes,n),t=n.parseQuery||iA,r=n.stringifyQuery||Jm,s=n.history,i=va(),o=va(),a=va(),l=xI(os);let u=os;Yi&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=jd.bind(null,z=>""+z),f=jd.bind(null,PT),g=jd.bind(null,rl);function _(z,me){let ue,ie;return cv(z)?(ue=e.getRecordMatcher(z),ie=me):ie=z,e.addRoute(ie,ue)}function C(z){const me=e.getRecordMatcher(z);me&&e.removeRoute(me)}function x(){return e.getRoutes().map(z=>z.record)}function R(z){return!!e.getRecordMatcher(z)}function L(z,me){if(me=nt({},me||l.value),typeof z=="string"){const E=qd(t,z,me.path),M=e.resolve({path:E.path},me),J=s.createHref(E.fullPath);return nt(E,M,{params:g(M.params),hash:rl(E.hash),redirectedFrom:void 0,href:J})}let ue;if(z.path!=null)ue=nt({},z,{path:qd(t,z.path,me.path).path});else{const E=nt({},z.params);for(const M in E)E[M]==null&&delete E[M];ue=nt({},z,{params:f(E)}),me.params=f(me.params)}const ie=e.resolve(ue,me),Oe=z.hash||"";ie.params=d(g(ie.params));const ze=CT(r,nt({},z,{hash:TT(Oe),path:ie.path})),b=s.createHref(ze);return nt({fullPath:ze,hash:Oe,query:r===Jm?oA(z.query):z.query||{}},ie,{redirectedFrom:void 0,href:b})}function B(z){return typeof z=="string"?qd(t,z,l.value.path):nt({},z)}function $(z,me){if(u!==z)return vo(8,{from:me,to:z})}function j(z){return T(z)}function O(z){return j(nt(B(z),{replace:!0}))}function se(z){const me=z.matched[z.matched.length-1];if(me&&me.redirect){const{redirect:ue}=me;let ie=typeof ue=="function"?ue(z):ue;return typeof ie=="string"&&(ie=ie.includes("?")||ie.includes("#")?ie=B(ie):{path:ie},ie.params={}),nt({query:z.query,hash:z.hash,params:ie.path!=null?{}:z.params},ie)}}function T(z,me){const ue=u=L(z),ie=l.value,Oe=z.state,ze=z.force,b=z.replace===!0,E=se(ue);if(E)return T(nt(B(E),{state:typeof E=="object"?nt({},Oe,E.state):Oe,force:ze,replace:b}),me||ue);const M=ue;M.redirectedFrom=me;let J;return!ze&&kT(r,ie,ue)&&(J=vo(16,{to:M,from:ie}),Qe(ie,ie,!0,!1)),(J?Promise.resolve(J):S(M,ie)).catch(G=>kr(G)?kr(G,2)?G:De(G):K(G,M,ie)).then(G=>{if(G){if(kr(G,2))return T(nt({replace:b},B(G.to),{state:typeof G.to=="object"?nt({},Oe,G.to.state):Oe,force:ze}),me||M)}else G=D(M,ie,!0,b,Oe);return k(M,ie,G),G})}function w(z,me){const ue=$(z,me);return ue?Promise.reject(ue):Promise.resolve()}function I(z){const me=hn.values().next().value;return me&&typeof me.runWithContext=="function"?me.runWithContext(z):z()}function S(z,me){let ue;const[ie,Oe,ze]=gA(z,me);ue=zd(ie.reverse(),"beforeRouteLeave",z,me);for(const E of ie)E.leaveGuards.forEach(M=>{ue.push(hs(M,z,me))});const b=w.bind(null,z,me);return ue.push(b),zt(ue).then(()=>{ue=[];for(const E of i.list())ue.push(hs(E,z,me));return ue.push(b),zt(ue)}).then(()=>{ue=zd(Oe,"beforeRouteUpdate",z,me);for(const E of Oe)E.updateGuards.forEach(M=>{ue.push(hs(M,z,me))});return ue.push(b),zt(ue)}).then(()=>{ue=[];for(const E of ze)if(E.beforeEnter)if(ar(E.beforeEnter))for(const M of E.beforeEnter)ue.push(hs(M,z,me));else ue.push(hs(E.beforeEnter,z,me));return ue.push(b),zt(ue)}).then(()=>(z.matched.forEach(E=>E.enterCallbacks={}),ue=zd(ze,"beforeRouteEnter",z,me,I),ue.push(b),zt(ue))).then(()=>{ue=[];for(const E of o.list())ue.push(hs(E,z,me));return ue.push(b),zt(ue)}).catch(E=>kr(E,8)?E:Promise.reject(E))}function k(z,me,ue){a.list().forEach(ie=>I(()=>ie(z,me,ue)))}function D(z,me,ue,ie,Oe){const ze=$(z,me);if(ze)return ze;const b=me===os,E=Yi?history.state:{};ue&&(ie||b?s.replace(z.fullPath,nt({scroll:b&&E&&E.scroll},Oe)):s.push(z.fullPath,Oe)),l.value=z,Qe(z,me,ue,b),De()}let A;function Jt(){A||(A=s.listen((z,me,ue)=>{if(!Tn.listening)return;const ie=L(z),Oe=se(ie);if(Oe){T(nt(Oe,{replace:!0,force:!0}),ie).catch(qa);return}u=ie;const ze=l.value;Yi&&UT($m(ze.fullPath,ue.delta),Fu()),S(ie,ze).catch(b=>kr(b,12)?b:kr(b,2)?(T(nt(B(b.to),{force:!0}),ie).then(E=>{kr(E,20)&&!ue.delta&&ue.type===sl.pop&&s.go(-1,!1)}).catch(qa),Promise.reject()):(ue.delta&&s.go(-ue.delta,!1),K(b,ie,ze))).then(b=>{b=b||D(ie,ze,!1),b&&(ue.delta&&!kr(b,8)?s.go(-ue.delta,!1):ue.type===sl.pop&&kr(b,20)&&s.go(-1,!1)),k(ie,ze,b)}).catch(qa)}))}let qt=va(),Ze=va(),ce;function K(z,me,ue){De(z);const ie=Ze.list();return ie.length?ie.forEach(Oe=>Oe(z,me,ue)):console.error(z),Promise.reject(z)}function Se(){return ce&&l.value!==os?Promise.resolve():new Promise((z,me)=>{qt.add([z,me])})}function De(z){return ce||(ce=!z,Jt(),qt.list().forEach(([me,ue])=>z?ue(z):me()),qt.reset()),z}function Qe(z,me,ue,ie){const{scrollBehavior:Oe}=n;if(!Yi||!Oe)return Promise.resolve();const ze=!ue&&BT($m(z.fullPath,0))||(ie||!ue)&&history.state&&history.state.scroll||null;return pr().then(()=>Oe(z,me,ze)).then(b=>b&&FT(b)).catch(b=>K(b,z,me))}const Ve=z=>s.go(z);let Ye;const hn=new Set,Tn={currentRoute:l,listening:!0,addRoute:_,removeRoute:C,clearRoutes:e.clearRoutes,hasRoute:R,getRoutes:x,resolve:L,options:n,push:j,replace:O,go:Ve,back:()=>Ve(-1),forward:()=>Ve(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Ze.add,isReady:Se,install(z){const me=this;z.component("RouterLink",uA),z.component("RouterView",pA),z.config.globalProperties.$router=me,Object.defineProperty(z.config.globalProperties,"$route",{enumerable:!0,get:()=>io(l)}),Yi&&!Ye&&l.value===os&&(Ye=!0,j(s.location).catch(Oe=>{}));const ue={};for(const Oe in os)Object.defineProperty(ue,Oe,{get:()=>l.value[Oe],enumerable:!0});z.provide(Uu,me),z.provide(bf,gy(ue)),z.provide(Th,l);const ie=z.unmount;hn.add(z),z.unmount=function(){hn.delete(z),hn.size<1&&(u=os,A&&A(),A=null,l.value=os,Ye=!1,ce=!1),ie()}}};function zt(z){return z.reduce((me,ue)=>me.then(()=>I(ue)),Promise.resolve())}return Tn}function gA(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(u=>yo(u,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(u=>yo(u,l))||s.push(l))}return[t,r,s]}function Bu(){return ir(Uu)}function fv(n){return ir(bf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},_A=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},mv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,u=l?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let g=(a&15)<<2|u>>6,_=u&63;l||(_=64,o||(g=64)),r.push(t[d],t[f],t[g],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(pv(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_A(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||u==null||f==null)throw new yA;const g=i<<2|a>>4;if(r.push(g),u!==64){const _=a<<4&240|u>>2;if(r.push(_),f!==64){const C=u<<6&192|f;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vA=function(n){const e=pv(n);return mv.encodeByteArray(e,!0)},ru=function(n){return vA(n).replace(/\./g,"")},gv=function(n){try{return mv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA=()=>wA().__FIREBASE_DEFAULTS__,IA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},EA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&gv(n[1]);return e&&JSON.parse(e)},$u=()=>{try{return bA()||IA()||EA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},_v=n=>{var e,t;return(t=(e=$u())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},TA=n=>{const e=_v(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},yv=()=>{var n;return(n=$u())===null||n===void 0?void 0:n.config},vv=n=>{var e;return(e=$u())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[ru(JSON.stringify(t)),ru(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xt())}function SA(){var n;const e=(n=$u())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function RA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function DA(){const n=Xt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function wv(){return!SA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bv(){try{return typeof indexedDB=="object"}catch{return!1}}function NA(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="FirebaseError";class Yr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=VA,Object.setPrototypeOf(this,Yr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pl.prototype.create)}}class Pl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?OA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Yr(s,a,r)}}function OA(n,e){return n.replace(MA,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const MA=/\{\$([^}]+)}/g;function LA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ps(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(ng(i)&&ng(o)){if(!Ps(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function ng(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ra(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ca(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function FA(n,e){const t=new UA(n,e);return t.subscribe.bind(t)}class UA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");BA(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Gd),s.error===void 0&&(s.error=Gd),s.complete===void 0&&(s.complete=Gd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function BA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Gd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(n){return n&&n._delegate?n._delegate:n}class gi{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new AA;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qA(e))try{this.getOrInitializeService({instanceIdentifier:ri})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ri){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ri){return this.instances.has(e)}getOptions(e=ri){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:jA(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ri){return this.component?this.component.multipleInstances?e:ri:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function jA(n){return n===ri?void 0:n}function qA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $A(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const GA={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},KA=Ke.INFO,HA={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},WA=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=HA[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class If{constructor(e){this.name=e,this._logLevel=KA,this._logHandler=WA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const QA=(n,e)=>e.some(t=>n instanceof t);let rg,sg;function JA(){return rg||(rg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YA(){return sg||(sg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Iv=new WeakMap,Ah=new WeakMap,Ev=new WeakMap,Kd=new WeakMap,Ef=new WeakMap;function XA(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Is(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Iv.set(t,n)}).catch(()=>{}),Ef.set(e,n),e}function ZA(n){if(Ah.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Ah.set(n,e)}let xh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ah.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ev.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Is(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ex(n){xh=n(xh)}function tx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Hd(this),e,...t);return Ev.set(r,e.sort?e.sort():[e]),Is(r)}:YA().includes(n)?function(...e){return n.apply(Hd(this),e),Is(Iv.get(this))}:function(...e){return Is(n.apply(Hd(this),e))}}function nx(n){return typeof n=="function"?tx(n):(n instanceof IDBTransaction&&ZA(n),QA(n,JA())?new Proxy(n,xh):n)}function Is(n){if(n instanceof IDBRequest)return XA(n);if(Kd.has(n))return Kd.get(n);const e=nx(n);return e!==n&&(Kd.set(n,e),Ef.set(e,n)),e}const Hd=n=>Ef.get(n);function rx(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Is(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Is(o.result),l.oldVersion,l.newVersion,Is(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const sx=["get","getKey","getAll","getAllKeys","count"],ix=["put","add","delete","clear"],Wd=new Map;function ig(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Wd.get(e))return Wd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=ix.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||sx.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),s&&l.done]))[0]};return Wd.set(e,i),i}ex(n=>({...n,get:(e,t,r)=>ig(e,t)||n.get(e,t,r),has:(e,t)=>!!ig(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ax(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ax(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ph="@firebase/app",og="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new If("@firebase/app"),lx="@firebase/app-compat",cx="@firebase/analytics-compat",ux="@firebase/analytics",dx="@firebase/app-check-compat",hx="@firebase/app-check",fx="@firebase/auth",px="@firebase/auth-compat",mx="@firebase/database",gx="@firebase/data-connect",_x="@firebase/database-compat",yx="@firebase/functions",vx="@firebase/functions-compat",wx="@firebase/installations",bx="@firebase/installations-compat",Ix="@firebase/messaging",Ex="@firebase/messaging-compat",Tx="@firebase/performance",Ax="@firebase/performance-compat",xx="@firebase/remote-config",Px="@firebase/remote-config-compat",Sx="@firebase/storage",Rx="@firebase/storage-compat",Cx="@firebase/firestore",kx="@firebase/vertexai-preview",Dx="@firebase/firestore-compat",Nx="firebase",Vx="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su="[DEFAULT]",Ox={[Ph]:"fire-core",[lx]:"fire-core-compat",[ux]:"fire-analytics",[cx]:"fire-analytics-compat",[hx]:"fire-app-check",[dx]:"fire-app-check-compat",[fx]:"fire-auth",[px]:"fire-auth-compat",[mx]:"fire-rtdb",[gx]:"fire-data-connect",[_x]:"fire-rtdb-compat",[yx]:"fire-fn",[vx]:"fire-fn-compat",[wx]:"fire-iid",[bx]:"fire-iid-compat",[Ix]:"fire-fcm",[Ex]:"fire-fcm-compat",[Tx]:"fire-perf",[Ax]:"fire-perf-compat",[xx]:"fire-rc",[Px]:"fire-rc-compat",[Sx]:"fire-gcs",[Rx]:"fire-gcs-compat",[Cx]:"fire-fst",[Dx]:"fire-fst-compat",[kx]:"fire-vertex","fire-js":"fire-js",[Nx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu=new Map,Mx=new Map,Sh=new Map;function ag(n,e){try{n.container.addComponent(e)}catch(t){zr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wo(n){const e=n.name;if(Sh.has(e))return zr.debug(`There were multiple attempts to register component ${e}.`),!1;Sh.set(e,n);for(const t of iu.values())ag(t,n);for(const t of Mx.values())ag(t,n);return!0}function Sl(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Lx(n,e,t=su){Sl(n,e).clearInstance(t)}function Bt(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Es=new Pl("app","Firebase",Fx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new gi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Es.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo=Vx;function Tv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:su,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Es.create("bad-app-name",{appName:String(s)});if(t||(t=yv()),!t)throw Es.create("no-options");const i=iu.get(s);if(i){if(Ps(t,i.options)&&Ps(r,i.config))return i;throw Es.create("duplicate-app",{appName:s})}const o=new zA(s);for(const l of Sh.values())o.addComponent(l);const a=new Ux(t,r,o);return iu.set(s,a),a}function Av(n=su){const e=iu.get(n);if(!e&&n===su&&yv())return Tv();if(!e)throw Es.create("no-app",{appName:n});return e}function Ts(n,e,t){var r;let s=(r=Ox[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zr.warn(a.join(" "));return}wo(new gi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx="firebase-heartbeat-database",$x=1,il="firebase-heartbeat-store";let Qd=null;function xv(){return Qd||(Qd=rx(Bx,$x,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(il)}catch(t){console.warn(t)}}}}).catch(n=>{throw Es.create("idb-open",{originalErrorMessage:n.message})})),Qd}async function jx(n){try{const t=(await xv()).transaction(il),r=await t.objectStore(il).get(Pv(n));return await t.done,r}catch(e){if(e instanceof Yr)zr.warn(e.message);else{const t=Es.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zr.warn(t.message)}}}async function lg(n,e){try{const r=(await xv()).transaction(il,"readwrite");await r.objectStore(il).put(e,Pv(n)),await r.done}catch(t){if(t instanceof Yr)zr.warn(t.message);else{const r=Es.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});zr.warn(r.message)}}}function Pv(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=1024,zx=30*24*60*60*1e3;class Gx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Hx(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=cg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=zx}),this._storage.overwrite(this._heartbeatsCache))}catch(r){zr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=cg(),{heartbeatsToSend:r,unsentEntries:s}=Kx(this._heartbeatsCache.heartbeats),i=ru(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return zr.warn(t),""}}}function cg(){return new Date().toISOString().substring(0,10)}function Kx(n,e=qx){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),ug(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),ug(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Hx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bv()?NA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jx(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return lg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return lg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ug(n){return ru(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(n){wo(new gi("platform-logger",e=>new ox(e),"PRIVATE")),wo(new gi("heartbeat",e=>new Gx(e),"PRIVATE")),Ts(Ph,og,n),Ts(Ph,og,"esm2017"),Ts("fire-js","")}Wx("");var Qx="firebase",Jx="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ts(Qx,Jx,"app");var dg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fi,Sv;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,w){function I(){}I.prototype=w.prototype,T.D=w.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(S,k,D){for(var A=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)A[Jt-2]=arguments[Jt];return w.prototype[k].apply(S,A)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,w,I){I||(I=0);var S=Array(16);if(typeof w=="string")for(var k=0;16>k;++k)S[k]=w.charCodeAt(I++)|w.charCodeAt(I++)<<8|w.charCodeAt(I++)<<16|w.charCodeAt(I++)<<24;else for(k=0;16>k;++k)S[k]=w[I++]|w[I++]<<8|w[I++]<<16|w[I++]<<24;w=T.g[0],I=T.g[1],k=T.g[2];var D=T.g[3],A=w+(D^I&(k^D))+S[0]+3614090360&4294967295;w=I+(A<<7&4294967295|A>>>25),A=D+(k^w&(I^k))+S[1]+3905402710&4294967295,D=w+(A<<12&4294967295|A>>>20),A=k+(I^D&(w^I))+S[2]+606105819&4294967295,k=D+(A<<17&4294967295|A>>>15),A=I+(w^k&(D^w))+S[3]+3250441966&4294967295,I=k+(A<<22&4294967295|A>>>10),A=w+(D^I&(k^D))+S[4]+4118548399&4294967295,w=I+(A<<7&4294967295|A>>>25),A=D+(k^w&(I^k))+S[5]+1200080426&4294967295,D=w+(A<<12&4294967295|A>>>20),A=k+(I^D&(w^I))+S[6]+2821735955&4294967295,k=D+(A<<17&4294967295|A>>>15),A=I+(w^k&(D^w))+S[7]+4249261313&4294967295,I=k+(A<<22&4294967295|A>>>10),A=w+(D^I&(k^D))+S[8]+1770035416&4294967295,w=I+(A<<7&4294967295|A>>>25),A=D+(k^w&(I^k))+S[9]+2336552879&4294967295,D=w+(A<<12&4294967295|A>>>20),A=k+(I^D&(w^I))+S[10]+4294925233&4294967295,k=D+(A<<17&4294967295|A>>>15),A=I+(w^k&(D^w))+S[11]+2304563134&4294967295,I=k+(A<<22&4294967295|A>>>10),A=w+(D^I&(k^D))+S[12]+1804603682&4294967295,w=I+(A<<7&4294967295|A>>>25),A=D+(k^w&(I^k))+S[13]+4254626195&4294967295,D=w+(A<<12&4294967295|A>>>20),A=k+(I^D&(w^I))+S[14]+2792965006&4294967295,k=D+(A<<17&4294967295|A>>>15),A=I+(w^k&(D^w))+S[15]+1236535329&4294967295,I=k+(A<<22&4294967295|A>>>10),A=w+(k^D&(I^k))+S[1]+4129170786&4294967295,w=I+(A<<5&4294967295|A>>>27),A=D+(I^k&(w^I))+S[6]+3225465664&4294967295,D=w+(A<<9&4294967295|A>>>23),A=k+(w^I&(D^w))+S[11]+643717713&4294967295,k=D+(A<<14&4294967295|A>>>18),A=I+(D^w&(k^D))+S[0]+3921069994&4294967295,I=k+(A<<20&4294967295|A>>>12),A=w+(k^D&(I^k))+S[5]+3593408605&4294967295,w=I+(A<<5&4294967295|A>>>27),A=D+(I^k&(w^I))+S[10]+38016083&4294967295,D=w+(A<<9&4294967295|A>>>23),A=k+(w^I&(D^w))+S[15]+3634488961&4294967295,k=D+(A<<14&4294967295|A>>>18),A=I+(D^w&(k^D))+S[4]+3889429448&4294967295,I=k+(A<<20&4294967295|A>>>12),A=w+(k^D&(I^k))+S[9]+568446438&4294967295,w=I+(A<<5&4294967295|A>>>27),A=D+(I^k&(w^I))+S[14]+3275163606&4294967295,D=w+(A<<9&4294967295|A>>>23),A=k+(w^I&(D^w))+S[3]+4107603335&4294967295,k=D+(A<<14&4294967295|A>>>18),A=I+(D^w&(k^D))+S[8]+1163531501&4294967295,I=k+(A<<20&4294967295|A>>>12),A=w+(k^D&(I^k))+S[13]+2850285829&4294967295,w=I+(A<<5&4294967295|A>>>27),A=D+(I^k&(w^I))+S[2]+4243563512&4294967295,D=w+(A<<9&4294967295|A>>>23),A=k+(w^I&(D^w))+S[7]+1735328473&4294967295,k=D+(A<<14&4294967295|A>>>18),A=I+(D^w&(k^D))+S[12]+2368359562&4294967295,I=k+(A<<20&4294967295|A>>>12),A=w+(I^k^D)+S[5]+4294588738&4294967295,w=I+(A<<4&4294967295|A>>>28),A=D+(w^I^k)+S[8]+2272392833&4294967295,D=w+(A<<11&4294967295|A>>>21),A=k+(D^w^I)+S[11]+1839030562&4294967295,k=D+(A<<16&4294967295|A>>>16),A=I+(k^D^w)+S[14]+4259657740&4294967295,I=k+(A<<23&4294967295|A>>>9),A=w+(I^k^D)+S[1]+2763975236&4294967295,w=I+(A<<4&4294967295|A>>>28),A=D+(w^I^k)+S[4]+1272893353&4294967295,D=w+(A<<11&4294967295|A>>>21),A=k+(D^w^I)+S[7]+4139469664&4294967295,k=D+(A<<16&4294967295|A>>>16),A=I+(k^D^w)+S[10]+3200236656&4294967295,I=k+(A<<23&4294967295|A>>>9),A=w+(I^k^D)+S[13]+681279174&4294967295,w=I+(A<<4&4294967295|A>>>28),A=D+(w^I^k)+S[0]+3936430074&4294967295,D=w+(A<<11&4294967295|A>>>21),A=k+(D^w^I)+S[3]+3572445317&4294967295,k=D+(A<<16&4294967295|A>>>16),A=I+(k^D^w)+S[6]+76029189&4294967295,I=k+(A<<23&4294967295|A>>>9),A=w+(I^k^D)+S[9]+3654602809&4294967295,w=I+(A<<4&4294967295|A>>>28),A=D+(w^I^k)+S[12]+3873151461&4294967295,D=w+(A<<11&4294967295|A>>>21),A=k+(D^w^I)+S[15]+530742520&4294967295,k=D+(A<<16&4294967295|A>>>16),A=I+(k^D^w)+S[2]+3299628645&4294967295,I=k+(A<<23&4294967295|A>>>9),A=w+(k^(I|~D))+S[0]+4096336452&4294967295,w=I+(A<<6&4294967295|A>>>26),A=D+(I^(w|~k))+S[7]+1126891415&4294967295,D=w+(A<<10&4294967295|A>>>22),A=k+(w^(D|~I))+S[14]+2878612391&4294967295,k=D+(A<<15&4294967295|A>>>17),A=I+(D^(k|~w))+S[5]+4237533241&4294967295,I=k+(A<<21&4294967295|A>>>11),A=w+(k^(I|~D))+S[12]+1700485571&4294967295,w=I+(A<<6&4294967295|A>>>26),A=D+(I^(w|~k))+S[3]+2399980690&4294967295,D=w+(A<<10&4294967295|A>>>22),A=k+(w^(D|~I))+S[10]+4293915773&4294967295,k=D+(A<<15&4294967295|A>>>17),A=I+(D^(k|~w))+S[1]+2240044497&4294967295,I=k+(A<<21&4294967295|A>>>11),A=w+(k^(I|~D))+S[8]+1873313359&4294967295,w=I+(A<<6&4294967295|A>>>26),A=D+(I^(w|~k))+S[15]+4264355552&4294967295,D=w+(A<<10&4294967295|A>>>22),A=k+(w^(D|~I))+S[6]+2734768916&4294967295,k=D+(A<<15&4294967295|A>>>17),A=I+(D^(k|~w))+S[13]+1309151649&4294967295,I=k+(A<<21&4294967295|A>>>11),A=w+(k^(I|~D))+S[4]+4149444226&4294967295,w=I+(A<<6&4294967295|A>>>26),A=D+(I^(w|~k))+S[11]+3174756917&4294967295,D=w+(A<<10&4294967295|A>>>22),A=k+(w^(D|~I))+S[2]+718787259&4294967295,k=D+(A<<15&4294967295|A>>>17),A=I+(D^(k|~w))+S[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(k+(A<<21&4294967295|A>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.u=function(T,w){w===void 0&&(w=T.length);for(var I=w-this.blockSize,S=this.B,k=this.h,D=0;D<w;){if(k==0)for(;D<=I;)s(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<w;)if(S[k++]=T.charCodeAt(D++),k==this.blockSize){s(this,S),k=0;break}}else for(;D<w;)if(S[k++]=T[D++],k==this.blockSize){s(this,S),k=0;break}}this.h=k,this.o+=w},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;var I=8*this.o;for(w=T.length-8;w<T.length;++w)T[w]=I&255,I/=256;for(this.u(T),T=Array(16),w=I=0;4>w;++w)for(var S=0;32>S;S+=8)T[I++]=this.g[w]>>>S&255;return T};function i(T,w){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=w(T)}function o(T,w){this.h=w;for(var I=[],S=!0,k=T.length-1;0<=k;k--){var D=T[k]|0;S&&D==w||(I[k]=D,S=!1)}this.g=I}var a={};function l(T){return-128<=T&&128>T?i(T,function(w){return new o([w|0],0>w?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return f;if(0>T)return R(u(-T));for(var w=[],I=1,S=0;T>=I;S++)w[S]=T/I|0,I*=4294967296;return new o(w,0)}function d(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return R(d(T.substring(1),w));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(w,8)),S=f,k=0;k<T.length;k+=8){var D=Math.min(8,T.length-k),A=parseInt(T.substring(k,k+D),w);8>D?(D=u(Math.pow(w,D)),S=S.j(D).add(u(A))):(S=S.j(I),S=S.add(u(A)))}return S}var f=l(0),g=l(1),_=l(16777216);n=o.prototype,n.m=function(){if(x(this))return-R(this).m();for(var T=0,w=1,I=0;I<this.g.length;I++){var S=this.i(I);T+=(0<=S?S:4294967296+S)*w,w*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(C(this))return"0";if(x(this))return"-"+R(this).toString(T);for(var w=u(Math.pow(T,6)),I=this,S="";;){var k=j(I,w).g;I=L(I,k.j(w));var D=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=k,C(I))return D+S;for(;6>D.length;)D="0"+D;S=D+S}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function C(T){if(T.h!=0)return!1;for(var w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function x(T){return T.h==-1}n.l=function(T){return T=L(this,T),x(T)?-1:C(T)?0:1};function R(T){for(var w=T.g.length,I=[],S=0;S<w;S++)I[S]=~T.g[S];return new o(I,~T.h).add(g)}n.abs=function(){return x(this)?R(this):this},n.add=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],S=0,k=0;k<=w;k++){var D=S+(this.i(k)&65535)+(T.i(k)&65535),A=(D>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);S=A>>>16,D&=65535,A&=65535,I[k]=A<<16|D}return new o(I,I[I.length-1]&-2147483648?-1:0)};function L(T,w){return T.add(R(w))}n.j=function(T){if(C(this)||C(T))return f;if(x(this))return x(T)?R(this).j(R(T)):R(R(this).j(T));if(x(T))return R(this.j(R(T)));if(0>this.l(_)&&0>T.l(_))return u(this.m()*T.m());for(var w=this.g.length+T.g.length,I=[],S=0;S<2*w;S++)I[S]=0;for(S=0;S<this.g.length;S++)for(var k=0;k<T.g.length;k++){var D=this.i(S)>>>16,A=this.i(S)&65535,Jt=T.i(k)>>>16,qt=T.i(k)&65535;I[2*S+2*k]+=A*qt,B(I,2*S+2*k),I[2*S+2*k+1]+=D*qt,B(I,2*S+2*k+1),I[2*S+2*k+1]+=A*Jt,B(I,2*S+2*k+1),I[2*S+2*k+2]+=D*Jt,B(I,2*S+2*k+2)}for(S=0;S<w;S++)I[S]=I[2*S+1]<<16|I[2*S];for(S=w;S<2*w;S++)I[S]=0;return new o(I,0)};function B(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function $(T,w){this.g=T,this.h=w}function j(T,w){if(C(w))throw Error("division by zero");if(C(T))return new $(f,f);if(x(T))return w=j(R(T),w),new $(R(w.g),R(w.h));if(x(w))return w=j(T,R(w)),new $(R(w.g),w.h);if(30<T.g.length){if(x(T)||x(w))throw Error("slowDivide_ only works with positive integers.");for(var I=g,S=w;0>=S.l(T);)I=O(I),S=O(S);var k=se(I,1),D=se(S,1);for(S=se(S,2),I=se(I,2);!C(S);){var A=D.add(S);0>=A.l(T)&&(k=k.add(I),D=A),S=se(S,1),I=se(I,1)}return w=L(T,k.j(w)),new $(k,w)}for(k=f;0<=T.l(w);){for(I=Math.max(1,Math.floor(T.m()/w.m())),S=Math.ceil(Math.log(I)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),D=u(I),A=D.j(w);x(A)||0<A.l(T);)I-=S,D=u(I),A=D.j(w);C(D)&&(D=g),k=k.add(D),T=L(T,A)}return new $(k,T)}n.A=function(T){return j(this,T).h},n.and=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],S=0;S<w;S++)I[S]=this.i(S)&T.i(S);return new o(I,this.h&T.h)},n.or=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],S=0;S<w;S++)I[S]=this.i(S)|T.i(S);return new o(I,this.h|T.h)},n.xor=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],S=0;S<w;S++)I[S]=this.i(S)^T.i(S);return new o(I,this.h^T.h)};function O(T){for(var w=T.g.length+1,I=[],S=0;S<w;S++)I[S]=T.i(S)<<1|T.i(S-1)>>>31;return new o(I,T.h)}function se(T,w){var I=w>>5;w%=32;for(var S=T.g.length-I,k=[],D=0;D<S;D++)k[D]=0<w?T.i(D+I)>>>w|T.i(D+I+1)<<32-w:T.i(D+I);return new o(k,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Sv=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,fi=o}).apply(typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{});var bc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rv,ka,Cv,Oc,Rh,kv,Dv,Nv;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,h,p){return c==Array.prototype||c==Object.prototype||(c[h]=p.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof bc=="object"&&bc];for(var h=0;h<c.length;++h){var p=c[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(c,h){if(h)e:{var p=r;c=c.split(".");for(var y=0;y<c.length-1;y++){var N=c[y];if(!(N in p))break e;p=p[N]}c=c[c.length-1],y=p[c],h=h(y),h!=y&&h!=null&&e(p,c,{configurable:!0,writable:!0,value:h})}}function i(c,h){c instanceof String&&(c+="");var p=0,y=!1,N={next:function(){if(!y&&p<c.length){var U=p++;return{value:h(U,c[U]),done:!1}}return y=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}s("Array.prototype.values",function(c){return c||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var h=typeof c;return h=h!="object"?h:c?Array.isArray(c)?"array":h:"null",h=="array"||h=="object"&&typeof c.length=="number"}function u(c){var h=typeof c;return h=="object"&&c!=null||h=="function"}function d(c,h,p){return c.call.apply(c.bind,arguments)}function f(c,h,p){if(!c)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,y),c.apply(h,N)}}return function(){return c.apply(h,arguments)}}function g(c,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function _(c,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),c.apply(this,y)}}function C(c,h){function p(){}p.prototype=h.prototype,c.aa=h.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(y,N,U){for(var de=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)de[ut-2]=arguments[ut];return h.prototype[N].apply(y,de)}}function x(c){const h=c.length;if(0<h){const p=Array(h);for(let y=0;y<h;y++)p[y]=c[y];return p}return[]}function R(c,h){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(l(y)){const N=c.length||0,U=y.length||0;c.length=N+U;for(let de=0;de<U;de++)c[N+de]=y[de]}else c.push(y)}}class L{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function B(c){return/^[\s\xa0]*$/.test(c)}function $(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function j(c){return j[" "](c),c}j[" "]=function(){};var O=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function se(c,h,p){for(const y in c)h.call(p,c[y],y,c)}function T(c,h){for(const p in c)h.call(void 0,c[p],p,c)}function w(c){const h={};for(const p in c)h[p]=c[p];return h}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(c,h){let p,y;for(let N=1;N<arguments.length;N++){y=arguments[N];for(p in y)c[p]=y[p];for(let U=0;U<I.length;U++)p=I[U],Object.prototype.hasOwnProperty.call(y,p)&&(c[p]=y[p])}}function k(c){var h=1;c=c.split(":");const p=[];for(;0<h&&c.length;)p.push(c.shift()),h--;return c.length&&p.push(c.join(":")),p}function D(c){a.setTimeout(()=>{throw c},0)}function A(){var c=Se;let h=null;return c.g&&(h=c.g,c.g=c.g.next,c.g||(c.h=null),h.next=null),h}class Jt{constructor(){this.h=this.g=null}add(h,p){const y=qt.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var qt=new L(()=>new Ze,c=>c.reset());class Ze{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,K=!1,Se=new Jt,De=()=>{const c=a.Promise.resolve(void 0);ce=()=>{c.then(Qe)}};var Qe=()=>{for(var c;c=A();){try{c.h.call(c.g)}catch(p){D(p)}var h=qt;h.j(c),100>h.h&&(h.h++,c.next=h.g,h.g=c)}K=!1};function Ve(){this.s=this.s,this.C=this.C}Ve.prototype.s=!1,Ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ye(c,h){this.type=c,this.g=this.target=h,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var hn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,h=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return c}();function Tn(c,h){if(Ye.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,y=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=h,h=c.relatedTarget){if(O){e:{try{j(h.nodeName);var N=!0;break e}catch{}N=!1}N||(h=null)}}else p=="mouseover"?h=c.fromElement:p=="mouseout"&&(h=c.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:zt[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Tn.aa.h.call(this)}}C(Tn,Ye);var zt={2:"touch",3:"pen",4:"mouse"};Tn.prototype.h=function(){Tn.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var z="closure_listenable_"+(1e6*Math.random()|0),me=0;function ue(c,h,p,y,N){this.listener=c,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=N,this.key=++me,this.da=this.fa=!1}function ie(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Oe(c){this.src=c,this.g={},this.h=0}Oe.prototype.add=function(c,h,p,y,N){var U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);var de=b(c,h,y,N);return-1<de?(h=c[de],p||(h.fa=!1)):(h=new ue(h,this.src,U,!!y,N),h.fa=p,c.push(h)),h};function ze(c,h){var p=h.type;if(p in c.g){var y=c.g[p],N=Array.prototype.indexOf.call(y,h,void 0),U;(U=0<=N)&&Array.prototype.splice.call(y,N,1),U&&(ie(h),c.g[p].length==0&&(delete c.g[p],c.h--))}}function b(c,h,p,y){for(var N=0;N<c.length;++N){var U=c[N];if(!U.da&&U.listener==h&&U.capture==!!p&&U.ha==y)return N}return-1}var E="closure_lm_"+(1e6*Math.random()|0),M={};function J(c,h,p,y,N){if(y&&y.once)return fe(c,h,p,y,N);if(Array.isArray(h)){for(var U=0;U<h.length;U++)J(c,h[U],p,y,N);return null}return p=Ce(p),c&&c[z]?c.K(h,p,u(y)?!!y.capture:!!y,N):G(c,h,p,!1,y,N)}function G(c,h,p,y,N,U){if(!h)throw Error("Invalid event type");var de=u(N)?!!N.capture:!!N,ut=ae(c);if(ut||(c[E]=ut=new Oe(c)),p=ut.add(h,p,y,de,U),p.proxy)return p;if(y=Z(),p.proxy=y,y.src=c,y.listener=p,c.addEventListener)hn||(N=de),N===void 0&&(N=!1),c.addEventListener(h.toString(),y,N);else if(c.attachEvent)c.attachEvent(ee(h.toString()),y);else if(c.addListener&&c.removeListener)c.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Z(){function c(p){return h.call(c.src,c.listener,p)}const h=Ae;return c}function fe(c,h,p,y,N){if(Array.isArray(h)){for(var U=0;U<h.length;U++)fe(c,h[U],p,y,N);return null}return p=Ce(p),c&&c[z]?c.L(h,p,u(y)?!!y.capture:!!y,N):G(c,h,p,!0,y,N)}function oe(c,h,p,y,N){if(Array.isArray(h))for(var U=0;U<h.length;U++)oe(c,h[U],p,y,N);else y=u(y)?!!y.capture:!!y,p=Ce(p),c&&c[z]?(c=c.i,h=String(h).toString(),h in c.g&&(U=c.g[h],p=b(U,p,y,N),-1<p&&(ie(U[p]),Array.prototype.splice.call(U,p,1),U.length==0&&(delete c.g[h],c.h--)))):c&&(c=ae(c))&&(h=c.g[h.toString()],c=-1,h&&(c=b(h,p,y,N)),(p=-1<c?h[c]:null)&&ne(p))}function ne(c){if(typeof c!="number"&&c&&!c.da){var h=c.src;if(h&&h[z])ze(h.i,c);else{var p=c.type,y=c.proxy;h.removeEventListener?h.removeEventListener(p,y,c.capture):h.detachEvent?h.detachEvent(ee(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=ae(h))?(ze(p,c),p.h==0&&(p.src=null,h[E]=null)):ie(c)}}}function ee(c){return c in M?M[c]:M[c]="on"+c}function Ae(c,h){if(c.da)c=!0;else{h=new Tn(h,this);var p=c.listener,y=c.ha||c.src;c.fa&&ne(c),c=p.call(y,h)}return c}function ae(c){return c=c[E],c instanceof Oe?c:null}var Ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ce(c){return typeof c=="function"?c:(c[Ie]||(c[Ie]=function(h){return c.handleEvent(h)}),c[Ie])}function Pe(){Ve.call(this),this.i=new Oe(this),this.M=this,this.F=null}C(Pe,Ve),Pe.prototype[z]=!0,Pe.prototype.removeEventListener=function(c,h,p,y){oe(this,c,h,p,y)};function ge(c,h){var p,y=c.F;if(y)for(p=[];y;y=y.F)p.push(y);if(c=c.M,y=h.type||h,typeof h=="string")h=new Ye(h,c);else if(h instanceof Ye)h.target=h.target||c;else{var N=h;h=new Ye(y,c),S(h,N)}if(N=!0,p)for(var U=p.length-1;0<=U;U--){var de=h.g=p[U];N=Re(de,y,!0,h)&&N}if(de=h.g=c,N=Re(de,y,!0,h)&&N,N=Re(de,y,!1,h)&&N,p)for(U=0;U<p.length;U++)de=h.g=p[U],N=Re(de,y,!1,h)&&N}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var c=this.i,h;for(h in c.g){for(var p=c.g[h],y=0;y<p.length;y++)ie(p[y]);delete c.g[h],c.h--}}this.F=null},Pe.prototype.K=function(c,h,p,y){return this.i.add(String(c),h,!1,p,y)},Pe.prototype.L=function(c,h,p,y){return this.i.add(String(c),h,!0,p,y)};function Re(c,h,p,y){if(h=c.i.g[String(h)],!h)return!0;h=h.concat();for(var N=!0,U=0;U<h.length;++U){var de=h[U];if(de&&!de.da&&de.capture==p){var ut=de.listener,an=de.ha||de.src;de.fa&&ze(c.i,de),N=ut.call(an,y)!==!1&&N}}return N&&!y.defaultPrevented}function Gt(c,h,p){if(typeof c=="function")p&&(c=g(c,p));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(c,h||0)}function Mt(c){c.g=Gt(()=>{c.g=null,c.i&&(c.i=!1,Mt(c))},c.l);const h=c.h;c.h=null,c.m.apply(null,h)}class An extends Ve{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Mt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function St(c){Ve.call(this),this.h=c,this.g={}}C(St,Ve);var lr=[];function Xn(c){se(c.g,function(h,p){this.g.hasOwnProperty(p)&&ne(h)},c),c.g={}}St.prototype.N=function(){St.aa.N.call(this),Xn(this)},St.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dt=a.JSON.stringify,Yt=a.JSON.parse,Zn=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Er(){}Er.prototype.h=null;function ss(c){return c.h||(c.h=c.i())}function Jl(){}var js={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xo(){Ye.call(this,"d")}C(Xo,Ye);function Zo(){Ye.call(this,"c")}C(Zo,Ye);var ot={},ft=null;function It(){return ft=ft||new Pe}ot.La="serverreachability";function pt(c){Ye.call(this,ot.La,c)}C(pt,Ye);function qs(c){const h=It();ge(h,new pt(h))}ot.STAT_EVENT="statevent";function ea(c,h){Ye.call(this,ot.STAT_EVENT,c),this.stat=h}C(ea,Ye);function en(c){const h=It();ge(h,new ea(h,c))}ot.Ma="timingevent";function Yl(c,h){Ye.call(this,ot.Ma,c),this.size=h}C(Yl,Ye);function cr(c,h){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},h)}function zs(){this.g=!0}zs.prototype.xa=function(){this.g=!1};function ta(c,h,p,y,N,U){c.info(function(){if(c.g)if(U)for(var de="",ut=U.split("&"),an=0;an<ut.length;an++){var et=ut[an].split("=");if(1<et.length){var pn=et[0];et=et[1];var mn=pn.split("_");de=2<=mn.length&&mn[1]=="type"?de+(pn+"="+et+"&"):de+(pn+"=redacted&")}}else de=null;else de=U;return"XMLHTTP REQ ("+y+") [attempt "+N+"]: "+h+`
`+p+`
`+de})}function Fn(c,h,p,y,N,U,de){c.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+N+"]: "+h+`
`+p+`
`+U+" "+de})}function Tr(c,h,p,y){c.info(function(){return"XMLHTTP TEXT ("+h+"): "+Xl(c,p)+(y?" "+y:"")})}function wd(c,h){c.info(function(){return"TIMEOUT: "+h})}zs.prototype.info=function(){};function Xl(c,h){if(!c.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var y=p[c];if(!(2>y.length)){var N=y[1];if(Array.isArray(N)&&!(1>N.length)){var U=N[0];if(U!="noop"&&U!="stop"&&U!="close")for(var de=1;de<N.length;de++)N[de]=""}}}}return Dt(p)}catch{return h}}var Mi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Li={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ur;function is(){}C(is,Er),is.prototype.g=function(){return new XMLHttpRequest},is.prototype.i=function(){return{}},ur=new is;function Un(c,h,p,y){this.j=c,this.i=h,this.l=p,this.R=y||1,this.U=new St(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new na}function na(){this.i=null,this.g="",this.h=!1}var Zl={},ra={};function Fi(c,h,p){c.L=1,c.v=Ws(er(h)),c.m=p,c.P=!0,sa(c,null)}function sa(c,h){c.F=Date.now(),Ar(c),c.A=er(c.v);var p=c.A,y=c.R;Array.isArray(y)||(y=[String(y)]),uc(p.i,"t",y),c.C=0,p=c.j.J,c.h=new na,c.g=om(c.j,p?h:null,!c.m),0<c.O&&(c.M=new An(g(c.Y,c,c.g),c.O)),h=c.U,p=c.g,y=c.ca;var N="readystatechange";Array.isArray(N)||(N&&(lr[0]=N.toString()),N=lr);for(var U=0;U<N.length;U++){var de=J(p,N[U],y||h.handleEvent,!1,h.h||h);if(!de)break;h.g[de.key]=de}h=c.H?w(c.H):{},c.m?(c.u||(c.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,h)):(c.u="GET",c.g.ea(c.A,c.u,null,h)),qs(),ta(c.i,c.u,c.A,c.l,c.R,c.m)}Un.prototype.ca=function(c){c=c.target;const h=this.M;h&&Rr(c)==3?h.j():this.Y(c)},Un.prototype.Y=function(c){try{if(c==this.g)e:{const mn=Rr(this.g);var h=this.g.Ba();const qi=this.g.Z();if(!(3>mn)&&(mn!=3||this.g&&(this.h.h||this.g.oa()||Qp(this.g)))){this.J||mn!=4||h==7||(h==8||0>=qi?qs(3):qs(2)),ia(this);var p=this.g.Z();this.X=p;t:if(Gs(this)){var y=Qp(this.g);c="";var N=y.length,U=Rr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xr(this),Ks(this);var de="";break t}this.h.i=new a.TextDecoder}for(h=0;h<N;h++)this.h.h=!0,c+=this.h.i.decode(y[h],{stream:!(U&&h==N-1)});y.length=0,this.h.g+=c,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=p==200,Fn(this.i,this.u,this.A,this.l,this.R,mn,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ut,an=this.g;if((ut=an.g?an.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(ut)){var et=ut;break t}}et=null}if(p=et)Tr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,oa(this,p);else{this.o=!1,this.s=3,en(12),xr(this),Ks(this);break e}}if(this.P){p=!0;let tr;for(;!this.J&&this.C<de.length;)if(tr=Ui(this,de),tr==ra){mn==4&&(this.s=4,en(14),p=!1),Tr(this.i,this.l,null,"[Incomplete Response]");break}else if(tr==Zl){this.s=4,en(15),Tr(this.i,this.l,de,"[Invalid Chunk]"),p=!1;break}else Tr(this.i,this.l,tr,null),oa(this,tr);if(Gs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mn!=4||de.length!=0||this.h.h||(this.s=1,en(16),p=!1),this.o=this.o&&p,!p)Tr(this.i,this.l,de,"[Invalid Chunked Response]"),xr(this),Ks(this);else if(0<de.length&&!this.W){this.W=!0;var pn=this.j;pn.g==this&&pn.ba&&!pn.M&&(pn.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),Sd(pn),pn.M=!0,en(11))}}else Tr(this.i,this.l,de,null),oa(this,de);mn==4&&xr(this),this.o&&!this.J&&(mn==4?nm(this.j,this):(this.o=!1,Ar(this)))}else Kb(this.g),p==400&&0<de.indexOf("Unknown SID")?(this.s=3,en(12)):(this.s=0,en(13)),xr(this),Ks(this)}}}catch{}finally{}};function Gs(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Ui(c,h){var p=c.C,y=h.indexOf(`
`,p);return y==-1?ra:(p=Number(h.substring(p,y)),isNaN(p)?Zl:(y+=1,y+p>h.length?ra:(h=h.slice(y,y+p),c.C=y+p,h)))}Un.prototype.cancel=function(){this.J=!0,xr(this)};function Ar(c){c.S=Date.now()+c.I,ec(c,c.I)}function ec(c,h){if(c.B!=null)throw Error("WatchDog timer not null");c.B=cr(g(c.ba,c),h)}function ia(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Un.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(wd(this.i,this.A),this.L!=2&&(qs(),en(17)),xr(this),this.s=2,Ks(this)):ec(this,this.S-c)};function Ks(c){c.j.G==0||c.J||nm(c.j,c)}function xr(c){ia(c);var h=c.M;h&&typeof h.ma=="function"&&h.ma(),c.M=null,Xn(c.U),c.g&&(h=c.g,c.g=null,h.abort(),h.ma())}function oa(c,h){try{var p=c.j;if(p.G!=0&&(p.g==c||aa(p.h,c))){if(!c.K&&aa(p.h,c)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var N=y;if(N[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)mc(p),fc(p);else break e;Pd(p),en(18)}}else p.za=N[1],0<p.za-p.T&&37500>N[2]&&p.F&&p.v==0&&!p.C&&(p.C=cr(g(p.Za,p),6e3));if(1>=nc(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Xs(p,11)}else if((c.K||p.g==c)&&mc(p),!B(h))for(N=p.Da.g.parse(h),h=0;h<N.length;h++){let et=N[h];if(p.T=et[0],et=et[1],p.G==2)if(et[0]=="c"){p.K=et[1],p.ia=et[2];const pn=et[3];pn!=null&&(p.la=pn,p.j.info("VER="+p.la));const mn=et[4];mn!=null&&(p.Aa=mn,p.j.info("SVER="+p.Aa));const qi=et[5];qi!=null&&typeof qi=="number"&&0<qi&&(y=1.5*qi,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const tr=c.g;if(tr){const _c=tr.g?tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_c){var U=y.h;U.g||_c.indexOf("spdy")==-1&&_c.indexOf("quic")==-1&&_c.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(la(U,U.h),U.h=null))}if(y.D){const Rd=tr.g?tr.g.getResponseHeader("X-HTTP-Session-Id"):null;Rd&&(y.ya=Rd,ct(y.I,y.D,Rd))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var de=c;if(y.qa=im(y,y.J?y.ia:null,y.W),de.K){ca(y.h,de);var ut=de,an=y.L;an&&(ut.I=an),ut.B&&(ia(ut),Ar(ut)),y.g=de}else em(y);0<p.i.length&&pc(p)}else et[0]!="stop"&&et[0]!="close"||Xs(p,7);else p.G==3&&(et[0]=="stop"||et[0]=="close"?et[0]=="stop"?Xs(p,7):xd(p):et[0]!="noop"&&p.l&&p.l.ta(et),p.v=0)}}qs(4)}catch{}}var bd=class{constructor(c,h){this.g=c,this.map=h}};function Hs(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tc(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function nc(c){return c.h?1:c.g?c.g.size:0}function aa(c,h){return c.h?c.h==h:c.g?c.g.has(h):!1}function la(c,h){c.g?c.g.add(h):c.h=h}function ca(c,h){c.h&&c.h==h?c.h=null:c.g&&c.g.has(h)&&c.g.delete(h)}Hs.prototype.cancel=function(){if(this.i=rc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function rc(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let h=c.i;for(const p of c.g.values())h=h.concat(p.D);return h}return x(c.i)}function sc(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var h=[],p=c.length,y=0;y<p;y++)h.push(c[y]);return h}h=[],p=0;for(y in c)h[p++]=c[y];return h}function Id(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var h=[];c=c.length;for(var p=0;p<c;p++)h.push(p);return h}h=[],p=0;for(const y in c)h[p++]=y;return h}}}function ic(c,h){if(c.forEach&&typeof c.forEach=="function")c.forEach(h,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,h,void 0);else for(var p=Id(c),y=sc(c),N=y.length,U=0;U<N;U++)h.call(void 0,y[U],p&&p[U],c)}var oc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ed(c,h){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var y=c[p].indexOf("="),N=null;if(0<=y){var U=c[p].substring(0,y);N=c[p].substring(y+1)}else U=c[p];h(U,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function fn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof fn){this.h=c.h,Bi(this,c.j),this.o=c.o,this.g=c.g,Pr(this,c.s),this.l=c.l;var h=c.i,p=new Ys;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),ua(this,p),this.m=c.m}else c&&(h=String(c).match(oc))?(this.h=!1,Bi(this,h[1]||"",!0),this.o=Qs(h[2]||""),this.g=Qs(h[3]||"",!0),Pr(this,h[4]),this.l=Qs(h[5]||"",!0),ua(this,h[6]||"",!0),this.m=Qs(h[7]||"")):(this.h=!1,this.i=new Ys(null,this.h))}fn.prototype.toString=function(){var c=[],h=this.j;h&&c.push(Js(h,$i,!0),":");var p=this.g;return(p||h=="file")&&(c.push("//"),(h=this.o)&&c.push(Js(h,$i,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(Js(p,p.charAt(0)=="/"?ac:Ad,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",Js(p,lc)),c.join("")};function er(c){return new fn(c)}function Bi(c,h,p){c.j=p?Qs(h,!0):h,c.j&&(c.j=c.j.replace(/:$/,""))}function Pr(c,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);c.s=h}else c.s=null}function ua(c,h,p){h instanceof Ys?(c.i=h,v(c.i,c.h)):(p||(h=Js(h,da)),c.i=new Ys(h,c.h))}function ct(c,h,p){c.i.set(h,p)}function Ws(c){return ct(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Qs(c,h){return c?h?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Js(c,h,p){return typeof c=="string"?(c=encodeURI(c).replace(h,Td),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Td(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var $i=/[#\/\?@]/g,Ad=/[#\?:]/g,ac=/[#\?]/g,da=/[#\?@]/g,lc=/#/g;function Ys(c,h){this.h=this.g=null,this.i=c||null,this.j=!!h}function Bn(c){c.g||(c.g=new Map,c.h=0,c.i&&Ed(c.i,function(h,p){c.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Ys.prototype,n.add=function(c,h){Bn(this),this.i=null,c=P(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(h),this.h+=1,this};function ha(c,h){Bn(c),h=P(c,h),c.g.has(h)&&(c.i=null,c.h-=c.g.get(h).length,c.g.delete(h))}function cc(c,h){return Bn(c),h=P(c,h),c.g.has(h)}n.forEach=function(c,h){Bn(this),this.g.forEach(function(p,y){p.forEach(function(N){c.call(h,N,y,this)},this)},this)},n.na=function(){Bn(this);const c=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){const N=c[y];for(let U=0;U<N.length;U++)p.push(h[y])}return p},n.V=function(c){Bn(this);let h=[];if(typeof c=="string")cc(this,c)&&(h=h.concat(this.g.get(P(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)h=h.concat(c[p])}return h},n.set=function(c,h){return Bn(this),this.i=null,c=P(this,c),cc(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[h]),this.h+=1,this},n.get=function(c,h){return c?(c=this.V(c),0<c.length?String(c[0]):h):h};function uc(c,h,p){ha(c,h),0<p.length&&(c.i=null,c.g.set(P(c,h),x(p)),c.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];const U=encodeURIComponent(String(y)),de=this.V(y);for(y=0;y<de.length;y++){var N=U;de[y]!==""&&(N+="="+encodeURIComponent(String(de[y]))),c.push(N)}}return this.i=c.join("&")};function P(c,h){return h=String(h),c.j&&(h=h.toLowerCase()),h}function v(c,h){h&&!c.j&&(Bn(c),c.i=null,c.g.forEach(function(p,y){var N=y.toLowerCase();y!=N&&(ha(this,y),uc(this,N,p))},c)),c.j=h}function Q(c,h){const p=new zs;if(a.Image){const y=new Image;y.onload=_(ye,p,"TestLoadImage: loaded",!0,h,y),y.onerror=_(ye,p,"TestLoadImage: error",!1,h,y),y.onabort=_(ye,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=_(ye,p,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=c}else h(!1)}function he(c,h){const p=new zs,y=new AbortController,N=setTimeout(()=>{y.abort(),ye(p,"TestPingServer: timeout",!1,h)},1e4);fetch(c,{signal:y.signal}).then(U=>{clearTimeout(N),U.ok?ye(p,"TestPingServer: ok",!0,h):ye(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(N),ye(p,"TestPingServer: error",!1,h)})}function ye(c,h,p,y,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),y(p)}catch{}}function Ue(){this.g=new Zn}function Le(c,h,p){const y=p||"";try{ic(c,function(N,U){let de=N;u(N)&&(de=Dt(N)),h.push(y+U+"="+encodeURIComponent(de))})}catch(N){throw h.push(y+"type="+encodeURIComponent("_badmap")),N}}function Ge(c){this.l=c.Ub||null,this.j=c.eb||!1}C(Ge,Er),Ge.prototype.g=function(){return new at(this.l,this.j)},Ge.prototype.i=function(c){return function(){return c}}({});function at(c,h){Pe.call(this),this.D=c,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(at,Pe),n=at.prototype,n.open=function(c,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=h,this.readyState=1,Be(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(h.body=c),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,yt(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Be(this)),this.g&&(this.readyState=3,Be(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Kt(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Kt(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var h=c.value?c.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!c.done}))&&(this.response=this.responseText+=h)}c.done?yt(this):Be(this),this.readyState==3&&Kt(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,yt(this))},n.Qa=function(c){this.g&&(this.response=c,yt(this))},n.ga=function(){this.g&&yt(this)};function yt(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Be(c)}n.setRequestHeader=function(c,h){this.u.append(c,h)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=h.next();return c.join(`\r
`)};function Be(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(at.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function te(c){let h="";return se(c,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function $e(c,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=te(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):ct(c,h,p))}function Je(c){Pe.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Je,Pe);var Sr=/^https?$/i,fa=["POST","PUT"];n=Je.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);h=h?h.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ur.g(),this.v=this.o?ss(this.o):ss(ur),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(c),!0),this.B=!1}catch(U){dc(this,U);return}if(c=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var N in y)p.set(N,y[N]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const U of y.keys())p.set(U,y.get(U));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(U=>U.toLowerCase()=="content-type"),N=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(fa,h,void 0))||y||N||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,de]of p)this.g.setRequestHeader(U,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wp(this),this.u=!0,this.g.send(c),this.u=!1}catch(U){dc(this,U)}};function dc(c,h){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=h,c.m=5,Kp(c),hc(c)}function Kp(c){c.A||(c.A=!0,ge(c,"complete"),ge(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,ge(this,"complete"),ge(this,"abort"),hc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hc(this,!0)),Je.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Hp(this):this.bb())},n.bb=function(){Hp(this)};function Hp(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Rr(c)!=4||c.Z()!=2)){if(c.u&&Rr(c)==4)Gt(c.Ea,0,c);else if(ge(c,"readystatechange"),Rr(c)==4){c.h=!1;try{const de=c.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=de===0){var N=String(c.D).match(oc)[1]||null;!N&&a.self&&a.self.location&&(N=a.self.location.protocol.slice(0,-1)),y=!Sr.test(N?N.toLowerCase():"")}p=y}if(p)ge(c,"complete"),ge(c,"success");else{c.m=6;try{var U=2<Rr(c)?c.g.statusText:""}catch{U=""}c.l=U+" ["+c.Z()+"]",Kp(c)}}finally{hc(c)}}}}function hc(c,h){if(c.g){Wp(c);const p=c.g,y=c.v[0]?()=>{}:null;c.g=null,c.v=null,h||ge(c,"ready");try{p.onreadystatechange=y}catch{}}}function Wp(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Rr(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Rr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var h=this.g.responseText;return c&&h.indexOf(c)==0&&(h=h.substring(c.length)),Yt(h)}};function Qp(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Kb(c){const h={};c=(c.g&&2<=Rr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<c.length;y++){if(B(c[y]))continue;var p=k(c[y]);const N=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const U=h[N]||[];h[N]=U,U.push(p)}T(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pa(c,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||h}function Jp(c){this.Aa=0,this.i=[],this.j=new zs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pa("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pa("baseRetryDelayMs",5e3,c),this.cb=pa("retryDelaySeedMs",1e4,c),this.Wa=pa("forwardChannelMaxRetries",2,c),this.wa=pa("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Hs(c&&c.concurrentRequestLimit),this.Da=new Ue,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Jp.prototype,n.la=8,n.G=1,n.connect=function(c,h,p,y){en(0),this.W=c,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=im(this,null,this.W),pc(this)};function xd(c){if(Yp(c),c.G==3){var h=c.U++,p=er(c.I);if(ct(p,"SID",c.K),ct(p,"RID",h),ct(p,"TYPE","terminate"),ma(c,p),h=new Un(c,c.j,h),h.L=2,h.v=Ws(er(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=om(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Ar(h)}sm(c)}function fc(c){c.g&&(Sd(c),c.g.cancel(),c.g=null)}function Yp(c){fc(c),c.u&&(a.clearTimeout(c.u),c.u=null),mc(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function pc(c){if(!tc(c.h)&&!c.s){c.s=!0;var h=c.Ga;ce||De(),K||(ce(),K=!0),Se.add(h,c),c.B=0}}function Hb(c,h){return nc(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=h.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=cr(g(c.Ga,c,h),rm(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const N=new Un(this,this.j,c);let U=this.o;if(this.S&&(U?(U=w(U),S(U,this.S)):U=this.S),this.m!==null||this.O||(N.H=U,U=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Zp(this,N,h),p=er(this.I),ct(p,"RID",c),ct(p,"CVER",22),this.D&&ct(p,"X-HTTP-Session-Id",this.D),ma(this,p),U&&(this.O?h="headers="+encodeURIComponent(String(te(U)))+"&"+h:this.m&&$e(p,this.m,U)),la(this.h,N),this.Ua&&ct(p,"TYPE","init"),this.P?(ct(p,"$req",h),ct(p,"SID","null"),N.T=!0,Fi(N,p,null)):Fi(N,p,h),this.G=2}}else this.G==3&&(c?Xp(this,c):this.i.length==0||tc(this.h)||Xp(this))};function Xp(c,h){var p;h?p=h.l:p=c.U++;const y=er(c.I);ct(y,"SID",c.K),ct(y,"RID",p),ct(y,"AID",c.T),ma(c,y),c.m&&c.o&&$e(y,c.m,c.o),p=new Un(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),h&&(c.i=h.D.concat(c.i)),h=Zp(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),la(c.h,p),Fi(p,y,h)}function ma(c,h){c.H&&se(c.H,function(p,y){ct(h,y,p)}),c.l&&ic({},function(p,y){ct(h,y,p)})}function Zp(c,h,p){p=Math.min(c.i.length,p);var y=c.l?g(c.l.Na,c.l,c):null;e:{var N=c.i;let U=-1;for(;;){const de=["count="+p];U==-1?0<p?(U=N[0].g,de.push("ofs="+U)):U=0:de.push("ofs="+U);let ut=!0;for(let an=0;an<p;an++){let et=N[an].g;const pn=N[an].map;if(et-=U,0>et)U=Math.max(0,N[an].g-100),ut=!1;else try{Le(pn,de,"req"+et+"_")}catch{y&&y(pn)}}if(ut){y=de.join("&");break e}}}return c=c.i.splice(0,p),h.D=c,y}function em(c){if(!c.g&&!c.u){c.Y=1;var h=c.Fa;ce||De(),K||(ce(),K=!0),Se.add(h,c),c.v=0}}function Pd(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=cr(g(c.Fa,c),rm(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,tm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=cr(g(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,en(10),fc(this),tm(this))};function Sd(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function tm(c){c.g=new Un(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var h=er(c.qa);ct(h,"RID","rpc"),ct(h,"SID",c.K),ct(h,"AID",c.T),ct(h,"CI",c.F?"0":"1"),!c.F&&c.ja&&ct(h,"TO",c.ja),ct(h,"TYPE","xmlhttp"),ma(c,h),c.m&&c.o&&$e(h,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=Ws(er(h)),p.m=null,p.P=!0,sa(p,c)}n.Za=function(){this.C!=null&&(this.C=null,fc(this),Pd(this),en(19))};function mc(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function nm(c,h){var p=null;if(c.g==h){mc(c),Sd(c),c.g=null;var y=2}else if(aa(c.h,h))p=h.D,ca(c.h,h),y=1;else return;if(c.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var N=c.B;y=It(),ge(y,new Yl(y,p)),pc(c)}else em(c);else if(N=h.s,N==3||N==0&&0<h.X||!(y==1&&Hb(c,h)||y==2&&Pd(c)))switch(p&&0<p.length&&(h=c.h,h.i=h.i.concat(p)),N){case 1:Xs(c,5);break;case 4:Xs(c,10);break;case 3:Xs(c,6);break;default:Xs(c,2)}}}function rm(c,h){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*h}function Xs(c,h){if(c.j.info("Error code "+h),h==2){var p=g(c.fb,c),y=c.Xa;const N=!y;y=new fn(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Bi(y,"https"),Ws(y),N?Q(y.toString(),p):he(y.toString(),p)}else en(2);c.G=0,c.l&&c.l.sa(h),sm(c),Yp(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),en(2)):(this.j.info("Failed to ping google.com"),en(1))};function sm(c){if(c.G=0,c.ka=[],c.l){const h=rc(c.h);(h.length!=0||c.i.length!=0)&&(R(c.ka,h),R(c.ka,c.i),c.h.i.length=0,x(c.i),c.i.length=0),c.l.ra()}}function im(c,h,p){var y=p instanceof fn?er(p):new fn(p);if(y.g!="")h&&(y.g=h+"."+y.g),Pr(y,y.s);else{var N=a.location;y=N.protocol,h=h?h+"."+N.hostname:N.hostname,N=+N.port;var U=new fn(null);y&&Bi(U,y),h&&(U.g=h),N&&Pr(U,N),p&&(U.l=p),y=U}return p=c.D,h=c.ya,p&&h&&ct(y,p,h),ct(y,"VER",c.la),ma(c,y),y}function om(c,h,p){if(h&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=c.Ca&&!c.pa?new Je(new Ge({eb:p})):new Je(c.pa),h.Ha(c.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function am(){}n=am.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function gc(){}gc.prototype.g=function(c,h){return new $n(c,h)};function $n(c,h){Pe.call(this),this.g=new Jp(h),this.l=c,this.h=h&&h.messageUrlParams||null,c=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(c?c["X-WebChannel-Content-Type"]=h.messageContentType:c={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(c?c["X-WebChannel-Client-Profile"]=h.va:c={"X-WebChannel-Client-Profile":h.va}),this.g.S=c,(c=h&&h.Sb)&&!B(c)&&(this.g.m=c),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!B(h)&&(this.g.D=h,c=this.h,c!==null&&h in c&&(c=this.h,h in c&&delete c[h])),this.j=new ji(this)}C($n,Pe),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){xd(this.g)},$n.prototype.o=function(c){var h=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=Dt(c),c=p);h.i.push(new bd(h.Ya++,c)),h.G==3&&pc(h)},$n.prototype.N=function(){this.g.l=null,delete this.j,xd(this.g),delete this.g,$n.aa.N.call(this)};function lm(c){Xo.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var h=c.__sm__;if(h){e:{for(const p in h){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,h=h!==null&&c in h?h[c]:void 0),this.data=h}else this.data=c}C(lm,Xo);function cm(){Zo.call(this),this.status=1}C(cm,Zo);function ji(c){this.g=c}C(ji,am),ji.prototype.ua=function(){ge(this.g,"a")},ji.prototype.ta=function(c){ge(this.g,new lm(c))},ji.prototype.sa=function(c){ge(this.g,new cm)},ji.prototype.ra=function(){ge(this.g,"b")},gc.prototype.createWebChannel=gc.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,Nv=function(){return new gc},Dv=function(){return It()},kv=ot,Rh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mi.NO_ERROR=0,Mi.TIMEOUT=8,Mi.HTTP_ERROR=6,Oc=Mi,Li.COMPLETE="complete",Cv=Li,Jl.EventType=js,js.OPEN="a",js.CLOSE="b",js.ERROR="c",js.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,ka=Jl,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,Rv=Je}).apply(typeof bc<"u"?bc:typeof self<"u"?self:typeof window<"u"?window:{});const hg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}nn.UNAUTHENTICATED=new nn(null),nn.GOOGLE_CREDENTIALS=new nn("google-credentials-uid"),nn.FIRST_PARTY=new nn("first-party-uid"),nn.MOCK_USER=new nn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=new If("@firebase/firestore");function Xi(){return Ss.logLevel}function gL(n){Ss.setLogLevel(n)}function Y(n,...e){if(Ss.logLevel<=Ke.DEBUG){const t=e.map(Tf);Ss.debug(`Firestore (${Uo}): ${n}`,...t)}}function Ft(n,...e){if(Ss.logLevel<=Ke.ERROR){const t=e.map(Tf);Ss.error(`Firestore (${Uo}): ${n}`,...t)}}function Jn(n,...e){if(Ss.logLevel<=Ke.WARN){const t=e.map(Tf);Ss.warn(`Firestore (${Uo}): ${n}`,...t)}}function Tf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(n="Unexpected state"){const e=`FIRESTORE (${Uo}) INTERNAL ASSERTION FAILED: `+n;throw Ft(e),new Error(e)}function be(n,e){n||_e()}function _L(n,e){n||_e()}function le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class X extends Yr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Yx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(nn.UNAUTHENTICATED))}shutdown(){}}class Xx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Zx{constructor(e){this.t=e,this.currentUser=nn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new rn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new rn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new rn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(be(typeof r.accessToken=="string"),new Vv(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string"),new nn(e)}}class eP{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=nn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class tP{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new eP(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(nn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ov{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){be(this.o===void 0);const r=i=>{i.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(be(typeof t.token=="string"),this.R=t.token,new Ov(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class yL{getToken(){return Promise.resolve(new Ov(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=rP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function ke(n,e){return n<e?-1:n>e?1:0}function bo(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Lv(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new X(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new X(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new X(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new X(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ct.fromMillis(Date.now())}static fromDate(e){return Ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Ct(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ke(this.nanoseconds,e.nanoseconds):ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ee(e)}static min(){return new Ee(new Ct(0,0))}static max(){return new Ee(new Ct(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,t,r){t===void 0?t=0:t>e.length&&_e(),r===void 0?r=e.length-t:r>e.length-t&&_e(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ol.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ol?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class He extends ol{construct(e,t,r){return new He(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new X(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new He(t)}static emptyPath(){return new He([])}}const sP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tt extends ol{construct(e,t,r){return new Tt(e,t,r)}static isValidIdentifier(e){return sP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Tt(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new X(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new X(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new X(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new X(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tt(t)}static emptyPath(){return new Tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(He.fromString(e))}static fromName(e){return new pe(He.fromString(e).popFirst(5))}static empty(){return new pe(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return He.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new He(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Ch(n){return n.fields.find(e=>e.kind===2)}function si(n){return n.fields.filter(e=>e.kind!==2)}function iP(n,e){let t=ke(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=oP(n.fields[r],e.fields[r]),t!==0)return t;return ke(n.fields.length,e.fields.length)}Io.UNKNOWN_ID=-1;class pi{constructor(e,t){this.fieldPath=e,this.kind=t}}function oP(n,e){const t=Tt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:ke(n.kind,e.kind)}class Eo{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Eo(0,Kn.min())}}function Fv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Ee.fromTimestamp(r===1e9?new Ct(t+1,0):new Ct(t,r));return new Kn(s,pe.empty(),e)}function Uv(n){return new Kn(n.readTime,n.key,-1)}class Kn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Kn(Ee.min(),pe.empty(),-1)}static max(){return new Kn(Ee.max(),pe.empty(),-1)}}function Af(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:ke(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $v{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ls(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==Bv)throw n;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_e(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,r)=>{t(e)})}static reject(e){return new V((t,r)=>{r(e)})}static waitFor(e){return new V((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next(s=>s?V.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const u=l;t(e[u]).next(d=>{o[u]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new V((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new rn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ga(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=xf(r.target.error);this.V.reject(new Ga(e,s))}}static open(e,t,r,s){try{return new ju(t,e.transaction(s,r))}catch(i){throw new Ga(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Y("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new lP(t)}}class yr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,yr.S(Xt())===12.2&&Ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Y("SimpleDb","Removing database:",e),ii(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!bv())return!1;if(yr.v())return!0;const e=Xt(),t=yr.S(e),r=0<t&&t<10,s=jv(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(Y("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Ga(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new X(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new X(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ga(e,o))},s.onupgradeneeded=i=>{Y("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{Y("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=ju.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),V.reject(u))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(Y("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function jv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class aP{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ii(this.B.delete())}}class Ga extends X{constructor(e,t){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fs(n){return n.name==="IndexedDbTransactionError"}class lP{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Y("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Y("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ii(r)}add(e){return Y("SimpleDb","ADD",this.store.name,e,e),ii(this.store.add(e))}get(e){return ii(this.store.get(e)).next(t=>(t===void 0&&(t=null),Y("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Y("SimpleDb","DELETE",this.store.name,e),ii(this.store.delete(e))}count(){return Y("SimpleDb","COUNT",this.store.name),ii(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){Y("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new V((r,s)=>{t.onerror=i=>{const o=xf(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new aP(a),u=t(a.primaryKey,a.value,l);if(u instanceof V){const d=u.catch(f=>(l.done(),V.reject(f)));r.push(d)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>V.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ii(n){return new V((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=xf(r.target.error);t(s)}})}let fg=!1;function xf(n){const e=yr.S(Xt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new X("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fg||(fg=!0,setTimeout(()=>{throw r},0)),r}}return n}class cP{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Y("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Y("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Fs(t)?Y("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ls(t)}await this.X(6e4)})}}class uP{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Y("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(Y("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=Uv(i);Af(o,r)>0&&(r=o)}),new Kn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Vn.oe=-1;function Rl(n){return n==null}function al(n){return n===0&&1/n==-1/0}function qv(n){return typeof n=="number"&&Number.isInteger(n)&&!al(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pg(e)),e=dP(n.get(t),e);return pg(e)}function dP(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function pg(n){return n+""}function mr(n){const e=n.length;if(be(e>=2),e===2)return be(n.charAt(0)===""&&n.charAt(1)===""),He.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&_e(),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:_e()}i=o+2}return new He(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(n,e){return[n,bn(e)]}function zv(n,e,t){return[n,bn(e),t]}const hP={},fP=["prefixPath","collectionGroup","readTime","documentId"],pP=["prefixPath","collectionGroup","documentId"],mP=["collectionGroup","readTime","prefixPath","documentId"],gP=["canonicalId","targetId"],_P=["targetId","path"],yP=["path","targetId"],vP=["collectionId","parent"],wP=["indexId","uid"],bP=["uid","sequenceNumber"],IP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],EP=["indexId","uid","orderedDocumentKey"],TP=["userId","collectionPath","documentId"],AP=["userId","collectionPath","largestBatchId"],xP=["userId","collectionGroup","largestBatchId"],Gv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],PP=[...Gv,"documentOverlays"],Kv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Hv=Kv,Pf=[...Hv,"indexConfiguration","indexState","indexEntries"],SP=Pf,RP=[...Pf,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends $v{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Zt(n,e){const t=le(n);return yr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Us(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Wv(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function Qv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new _t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ic(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ic(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ic(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ic(this.root,e,this.comparator,!0)}}class Ic{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??ln.RED,this.left=s??ln.EMPTY,this.right=i??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new ln(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ln.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _e();const e=this.left.check();if(e!==this.right.check())throw _e();return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw _e()}get value(){throw _e()}get color(){throw _e()}get left(){throw _e()}get right(){throw _e()}copy(e,t,r,s,i){return this}insert(e,t,r){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _g(this.data.getIterator())}getIteratorFrom(e){return new _g(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new lt(this.comparator);return t.data=e,t}}class _g{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Gi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new On([])}unionWith(e){let t=new lt(Tt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new On(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bo(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wL(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Jv("Invalid base64 string: "+i):i}}(e);return new Vt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Vt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const CP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gr(n){if(be(!!n),typeof n=="string"){let e=0;const t=CP.exec(n);if(be(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Et(n.seconds),nanos:Et(n.nanos)}}function Et(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Kr(n){return typeof n=="string"?Vt.fromBase64String(n):Vt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function zu(n){const e=n.mapValue.fields.__previous_value__;return qu(e)?zu(e):e}function ll(n){const e=Gr(n.mapValue.fields.__local_write_time__.timestampValue);return new Ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,t,r,s,i,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class _i{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new _i("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof _i&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lc={nullValue:"NULL_VALUE"};function Rs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?qu(n)?4:Yv(n)?9007199254740991:Gu(n)?10:11:_e()}function Ir(n,e){if(n===e)return!0;const t=Rs(n);if(t!==Rs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ll(n).isEqual(ll(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Gr(s.timestampValue),a=Gr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Kr(s.bytesValue).isEqual(Kr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Et(s.geoPointValue.latitude)===Et(i.geoPointValue.latitude)&&Et(s.geoPointValue.longitude)===Et(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Et(s.integerValue)===Et(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Et(s.doubleValue),a=Et(i.doubleValue);return o===a?al(o)===al(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return bo(n.arrayValue.values||[],e.arrayValue.values||[],Ir);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(gg(o)!==gg(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Ir(o[l],a[l])))return!1;return!0}(n,e);default:return _e()}}function cl(n,e){return(n.values||[]).find(t=>Ir(t,e))!==void 0}function Cs(n,e){if(n===e)return 0;const t=Rs(n),r=Rs(e);if(t!==r)return ke(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ke(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Et(i.integerValue||i.doubleValue),l=Et(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return yg(n.timestampValue,e.timestampValue);case 4:return yg(ll(n),ll(e));case 5:return ke(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Kr(i),l=Kr(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=ke(a[u],l[u]);if(d!==0)return d}return ke(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ke(Et(i.latitude),Et(o.latitude));return a!==0?a:ke(Et(i.longitude),Et(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return vg(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,u,d;const f=i.fields||{},g=o.fields||{},_=(a=f.value)===null||a===void 0?void 0:a.arrayValue,C=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=ke(((u=_==null?void 0:_.values)===null||u===void 0?void 0:u.length)||0,((d=C==null?void 0:C.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:vg(_,C)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===ws.mapValue&&o===ws.mapValue)return 0;if(i===ws.mapValue)return 1;if(o===ws.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const g=ke(l[f],d[f]);if(g!==0)return g;const _=Cs(a[l[f]],u[d[f]]);if(_!==0)return _}return ke(l.length,d.length)}(n.mapValue,e.mapValue);default:throw _e()}}function yg(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ke(n,e);const t=Gr(n),r=Gr(e),s=ke(t.seconds,r.seconds);return s!==0?s:ke(t.nanos,r.nanos)}function vg(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Cs(t[s],r[s]);if(i)return i}return ke(t.length,r.length)}function To(n){return Dh(n)}function Dh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Gr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Kr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return pe.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Dh(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Dh(t.fields[o])}`;return s+"}"}(n.mapValue):_e()}function Fc(n){switch(Rs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zu(n);return e?16+Fc(e):16;case 5:return 2*n.stringValue.length;case 6:return Kr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Fc(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Us(r.fields,(i,o)=>{s+=i.length+Fc(o)}),s}(n.mapValue);default:throw _e()}}function yi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Nh(n){return!!n&&"integerValue"in n}function ul(n){return!!n&&"arrayValue"in n}function wg(n){return!!n&&"nullValue"in n}function bg(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Uc(n){return!!n&&"mapValue"in n}function Gu(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ka(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Us(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ka(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ka(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Yv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const Xv={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function DP(n){return"nullValue"in n?Lc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?yi(_i.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Gu(n)?Xv:{mapValue:{}}:_e()}function NP(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?yi(_i.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Xv:"mapValue"in n?Gu(n)?{mapValue:{}}:ws:_e()}function Ig(n,e){const t=Cs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Eg(n,e){const t=Cs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Uc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ka(t)}setAll(e){let t=Tt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Ka(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Uc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ir(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Uc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Us(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new un(Ka(this.value))}}function Zv(n){const e=[];return Us(n.fields,(t,r)=>{const s=new Tt([t]);if(Uc(r)){const i=Zv(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new On(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new vt(e,0,Ee.min(),Ee.min(),Ee.min(),un.empty(),0)}static newFoundDocument(e,t,r,s){return new vt(e,1,t,Ee.min(),r,s,0)}static newNoDocument(e,t){return new vt(e,2,t,Ee.min(),Ee.min(),un.empty(),0)}static newUnknownDocument(e,t){return new vt(e,3,t,Ee.min(),Ee.min(),un.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,t){this.position=e,this.inclusive=t}}function Tg(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=pe.comparator(pe.fromName(o.referenceValue),t.key):r=Cs(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ag(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ir(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t="asc"){this.field=e,this.dir=t}}function VP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{}class We extends e0{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new OP(e,t,r):t==="array-contains"?new FP(e,r):t==="in"?new o0(e,r):t==="not-in"?new UP(e,r):t==="array-contains-any"?new BP(e,r):new We(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new MP(e,r):new LP(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Cs(t,this.value)):t!==null&&Rs(this.value)===Rs(t)&&this.matchesComparison(Cs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class it extends e0{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new it(e,t)}matches(e){return Ao(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ao(n){return n.op==="and"}function Vh(n){return n.op==="or"}function Sf(n){return t0(n)&&Ao(n)}function t0(n){for(const e of n.filters)if(e instanceof it)return!1;return!0}function Oh(n){if(n instanceof We)return n.field.canonicalString()+n.op.toString()+To(n.value);if(Sf(n))return n.filters.map(e=>Oh(e)).join(",");{const e=n.filters.map(t=>Oh(t)).join(",");return`${n.op}(${e})`}}function n0(n,e){return n instanceof We?function(r,s){return s instanceof We&&r.op===s.op&&r.field.isEqual(s.field)&&Ir(r.value,s.value)}(n,e):n instanceof it?function(r,s){return s instanceof it&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&n0(o,s.filters[a]),!0):!1}(n,e):void _e()}function r0(n,e){const t=n.filters.concat(e);return it.create(t,n.op)}function s0(n){return n instanceof We?function(t){return`${t.field.canonicalString()} ${t.op} ${To(t.value)}`}(n):n instanceof it?function(t){return t.op.toString()+" {"+t.getFilters().map(s0).join(" ,")+"}"}(n):"Filter"}class OP extends We{constructor(e,t,r){super(e,t,r),this.key=pe.fromName(r.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class MP extends We{constructor(e,t){super(e,"in",t),this.keys=i0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class LP extends We{constructor(e,t){super(e,"not-in",t),this.keys=i0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function i0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>pe.fromName(r.referenceValue))}class FP extends We{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ul(t)&&cl(t.arrayValue,this.value)}}class o0 extends We{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&cl(this.value.arrayValue,t)}}class UP extends We{constructor(e,t){super(e,"not-in",t)}matches(e){if(cl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!cl(this.value.arrayValue,t)}}class BP extends We{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ul(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>cl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Mh(n,e=null,t=[],r=[],s=null,i=null,o=null){return new $P(n,e,t,r,s,i,o)}function vi(n){const e=le(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Oh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Rl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>To(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>To(r)).join(",")),e.ue=t}return e.ue}function Cl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!VP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!n0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ag(n.startAt,e.startAt)&&Ag(n.endAt,e.endAt)}function ou(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function au(n,e){return n.filters.filter(t=>t instanceof We&&t.field.isEqual(e))}function xg(n,e,t){let r=Lc,s=!0;for(const i of au(n,e)){let o=Lc,a=!0;switch(i.op){case"<":case"<=":o=DP(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Lc}Ig({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Ig({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Pg(n,e,t){let r=ws,s=!0;for(const i of au(n,e)){let o=ws,a=!0;switch(i.op){case">=":case">":o=NP(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=ws}Eg({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Eg({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function a0(n,e,t,r,s,i,o,a){return new Xr(n,e,t,r,s,i,o,a)}function Bo(n){return new Xr(n)}function Sg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Rf(n){return n.collectionGroup!==null}function lo(n){const e=le(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new lt(Tt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new dl(i,r))}),t.has(Tt.keyField().canonicalString())||e.ce.push(new dl(Tt.keyField(),r))}return e.ce}function In(n){const e=le(n);return e.le||(e.le=c0(e,lo(n))),e.le}function l0(n){const e=le(n);return e.he||(e.he=c0(e,n.explicitOrderBy)),e.he}function c0(n,e){if(n.limitType==="F")return Mh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new dl(s.field,i)});const t=n.endAt?new ks(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ks(n.startAt.position,n.startAt.inclusive):null;return Mh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Lh(n,e){const t=n.filters.concat([e]);return new Xr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function lu(n,e,t){return new Xr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kl(n,e){return Cl(In(n),In(e))&&n.limitType===e.limitType}function u0(n){return`${vi(In(n))}|lt:${n.limitType}`}function Zi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>s0(s)).join(", ")}]`),Rl(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>To(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>To(s)).join(",")),`Target(${r})`}(In(n))}; limitType=${n.limitType})`}function Dl(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):pe.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of lo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const u=Tg(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,lo(r),s)||r.endAt&&!function(o,a,l){const u=Tg(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,lo(r),s))}(n,e)}function d0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function h0(n){return(e,t)=>{let r=!1;for(const s of lo(n)){const i=jP(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function jP(n,e,t){const r=n.field.isKeyField()?pe.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),u=a.data.field(i);return l!==null&&u!==null?Cs(l,u):_e()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return _e()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Us(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Qv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP=new _t(pe.comparator);function Mn(){return qP}const f0=new _t(pe.comparator);function Da(...n){let e=f0;for(const t of n)e=e.insert(t.key,t);return e}function p0(n){let e=f0;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function gr(){return Ha()}function m0(){return Ha()}function Ha(){return new Zr(n=>n.toString(),(n,e)=>n.isEqual(e))}const zP=new _t(pe.comparator),GP=new lt(pe.comparator);function je(...n){let e=GP;for(const t of n)e=e.add(t);return e}const KP=new lt(ke);function Cf(){return KP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:al(e)?"-0":e}}function g0(n){return{integerValue:""+n}}function _0(n,e){return qv(e)?g0(e):kf(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(){this._=void 0}}function HP(n,e,t){return n instanceof xo?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&qu(i)&&(i=zu(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof wi?v0(n,e):n instanceof bi?w0(n,e):function(s,i){const o=y0(s,i),a=Rg(o)+Rg(s.Pe);return Nh(o)&&Nh(s.Pe)?g0(a):kf(s.serializer,a)}(n,e)}function WP(n,e,t){return n instanceof wi?v0(n,e):n instanceof bi?w0(n,e):t}function y0(n,e){return n instanceof Po?function(r){return Nh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class xo extends Ku{}class wi extends Ku{constructor(e){super(),this.elements=e}}function v0(n,e){const t=b0(e);for(const r of n.elements)t.some(s=>Ir(s,r))||t.push(r);return{arrayValue:{values:t}}}class bi extends Ku{constructor(e){super(),this.elements=e}}function w0(n,e){let t=b0(e);for(const r of n.elements)t=t.filter(s=>!Ir(s,r));return{arrayValue:{values:t}}}class Po extends Ku{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Rg(n){return Et(n.integerValue||n.doubleValue)}function b0(n){return ul(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t){this.field=e,this.transform=t}}function QP(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof wi&&s instanceof wi||r instanceof bi&&s instanceof bi?bo(r.elements,s.elements,Ir):r instanceof Po&&s instanceof Po?Ir(r.Pe,s.Pe):r instanceof xo&&s instanceof xo}(n.transform,e.transform)}class JP{constructor(e,t){this.version=e,this.transformResults=t}}class At{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new At}static exists(e){return new At(void 0,e)}static updateTime(e){return new At(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Hu{}function I0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new jo(n.key,At.none()):new $o(n.key,n.data,At.none());{const t=n.data,r=un.empty();let s=new lt(Tt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new es(n.key,r,new On(s.toArray()),At.none())}}function YP(n,e,t){n instanceof $o?function(s,i,o){const a=s.value.clone(),l=kg(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof es?function(s,i,o){if(!Bc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=kg(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(E0(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wa(n,e,t,r){return n instanceof $o?function(i,o,a,l){if(!Bc(i.precondition,o))return a;const u=i.value.clone(),d=Dg(i.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof es?function(i,o,a,l){if(!Bc(i.precondition,o))return a;const u=Dg(i.fieldTransforms,l,o),d=o.data;return d.setAll(E0(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return Bc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function XP(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=y0(r.transform,s||null);i!=null&&(t===null&&(t=un.empty()),t.set(r.field,i))}return t||null}function Cg(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&bo(r,s,(i,o)=>QP(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class $o extends Hu{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class es extends Hu{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function E0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function kg(n,e,t){const r=new Map;be(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,WP(o,a,t[s]))}return r}function Dg(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,HP(i,o,e))}return r}class jo extends Hu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Df extends Hu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&YP(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=m0();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=I0(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Ee.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),je())}isEqual(e){return this.batchId===e.batchId&&bo(this.mutations,e.mutations,(t,r)=>Cg(t,r))&&bo(this.baseMutations,e.baseMutations,(t,r)=>Cg(t,r))}}class Vf{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){be(e.mutations.length===r.length);let s=function(){return zP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Vf(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ht,Xe;function A0(n){switch(n){default:return _e();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function x0(n){if(n===void 0)return Ft("GRPC error has no .code"),F.UNKNOWN;switch(n){case Ht.OK:return F.OK;case Ht.CANCELLED:return F.CANCELLED;case Ht.UNKNOWN:return F.UNKNOWN;case Ht.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Ht.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Ht.INTERNAL:return F.INTERNAL;case Ht.UNAVAILABLE:return F.UNAVAILABLE;case Ht.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Ht.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Ht.NOT_FOUND:return F.NOT_FOUND;case Ht.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Ht.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Ht.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Ht.ABORTED:return F.ABORTED;case Ht.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Ht.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Ht.DATA_LOSS:return F.DATA_LOSS;default:return _e()}}(Xe=Ht||(Ht={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cu=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=new fi([4294967295,4294967295],0);function Ng(n){const e=P0().encode(n),t=new Sv;return t.update(e),new Uint8Array(t.digest())}function Vg(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new fi([t,r],0),new fi([s,i],0)]}class Mf{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Na(`Invalid padding: ${t}`);if(r<0)throw new Na(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Na(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Na(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=fi.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(fi.fromNumber(r)));return s.compare(eS)===1&&(s=new fi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Ng(e),[r,s]=Vg(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Mf(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=Ng(e),[r,s]=Vg(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Na extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ol.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Vl(Ee.min(),s,new _t(ke),Mn(),je())}}class Ol{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ol(r,t,je(),je(),je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class S0{constructor(e,t){this.targetId=e,this.me=t}}class R0{constructor(e,t,r=Vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Og{constructor(){this.fe=0,this.ge=Lg(),this.pe=Vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=je(),t=je(),r=je();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:_e()}}),new Ol(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Lg()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class tS{constructor(e){this.Le=e,this.Be=new Map,this.ke=Mn(),this.qe=Mg(),this.Qe=new _t(ke)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:_e()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(ou(i))if(r===0){const o=new pe(i.path);this.Ue(t,o,vt.newNoDocument(o,Ee.min()))}else be(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}cu==null||cu.et(function(d,f,g,_,C){var x,R,L,B,$,j;const O={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},se=f.unchangedNames;return se&&(O.bloomFilter={applied:C===0,hashCount:(x=se==null?void 0:se.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(B=(L=(R=se==null?void 0:se.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&B!==void 0?B:0,padding:(j=($=se==null?void 0:se.bits)===null||$===void 0?void 0:$.padding)!==null&&j!==void 0?j:0,mightContain:T=>{var w;return(w=_==null?void 0:_.mightContain(T))!==null&&w!==void 0&&w}}),O}(o,e.me,this.Le.tt(),a,l))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Kr(r).toUint8Array()}catch(l){if(l instanceof Jv)return Jn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Mf(o,s,i)}catch(l){return Jn(l instanceof Na?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&ou(a.target)){const l=new pe(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,vt.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=je();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Vl(e,t,this.Qe,this.ke,r);return this.ke=Mn(),this.qe=Mg(),this.Qe=new _t(ke),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Og,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new lt(ke),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||Y("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Og),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Mg(){return new _t(pe.comparator)}function Lg(){return new _t(pe.comparator)}const nS=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),rS=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),sS=(()=>({and:"AND",or:"OR"}))();class iS{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Fh(n,e){return n.useProto3Json||Rl(e)?e:{value:e}}function So(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function C0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function oS(n,e){return So(n,e.toTimestamp())}function $t(n){return be(!!n),Ee.fromTimestamp(function(t){const r=Gr(t);return new Ct(r.seconds,r.nanos)}(n))}function Lf(n,e){return Uh(n,e).canonicalString()}function Uh(n,e){const t=function(s){return new He(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function k0(n){const e=He.fromString(n);return be($0(e)),e}function hl(n,e){return Lf(n.databaseId,e.path)}function vr(n,e){const t=k0(e);if(t.get(1)!==n.databaseId.projectId)throw new X(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new X(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(V0(t))}function D0(n,e){return Lf(n.databaseId,e)}function N0(n){const e=k0(n);return e.length===4?He.emptyPath():V0(e)}function Bh(n){return new He(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function V0(n){return be(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Fg(n,e,t){return{name:hl(n,e),fields:t.value.mapValue.fields}}function O0(n,e,t){const r=vr(n,e.name),s=$t(e.updateTime),i=e.createTime?$t(e.createTime):Ee.min(),o=new un({mapValue:{fields:e.fields}}),a=vt.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function aS(n,e){return"found"in e?function(r,s){be(!!s.found),s.found.name,s.found.updateTime;const i=vr(r,s.found.name),o=$t(s.found.updateTime),a=s.found.createTime?$t(s.found.createTime):Ee.min(),l=new un({mapValue:{fields:s.found.fields}});return vt.newFoundDocument(i,o,a,l)}(n,e):"missing"in e?function(r,s){be(!!s.missing),be(!!s.readTime);const i=vr(r,s.missing),o=$t(s.readTime);return vt.newNoDocument(i,o)}(n,e):_e()}function lS(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:_e()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(be(d===void 0||typeof d=="string"),Vt.fromBase64String(d||"")):(be(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Vt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?F.UNKNOWN:x0(u.code);return new X(d,u.message||"")}(o);t=new R0(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=vr(n,r.document.name),i=$t(r.document.updateTime),o=r.document.createTime?$t(r.document.createTime):Ee.min(),a=new un({mapValue:{fields:r.document.fields}}),l=vt.newFoundDocument(s,i,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new $c(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=vr(n,r.document),i=r.readTime?$t(r.readTime):Ee.min(),o=vt.newNoDocument(s,i),a=r.removedTargetIds||[];t=new $c([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=vr(n,r.document),i=r.removedTargetIds||[];t=new $c([],i,s,null)}else{if(!("filter"in e))return _e();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new ZP(s,i),a=r.targetId;t=new S0(a,o)}}return t}function fl(n,e){let t;if(e instanceof $o)t={update:Fg(n,e.key,e.value)};else if(e instanceof jo)t={delete:hl(n,e.key)};else if(e instanceof es)t={update:Fg(n,e.key,e.data),updateMask:pS(e.fieldMask)};else{if(!(e instanceof Df))return _e();t={verify:hl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof xo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof wi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof bi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Po)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw _e()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:oS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:_e()}(n,e.precondition)),t}function $h(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?At.updateTime($t(i.updateTime)):i.exists!==void 0?At.exists(i.exists):At.none()}(e.currentDocument):At.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)be(a.setToServerValue==="REQUEST_TIME"),l=new xo;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new wi(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new bi(d)}else"increment"in a?l=new Po(o,a.increment):_e();const u=Tt.fromServerFormat(a.fieldPath);return new Nl(u,l)}(n,s)):[];if(e.update){e.update.name;const s=vr(n,e.update.name),i=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new On(u.map(d=>Tt.fromServerFormat(d)))}(e.updateMask);return new es(s,i,o,t,r)}return new $o(s,i,t,r)}if(e.delete){const s=vr(n,e.delete);return new jo(s,t)}if(e.verify){const s=vr(n,e.verify);return new Df(s,t)}return _e()}function cS(n,e){return n&&n.length>0?(be(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?$t(s.updateTime):$t(i);return o.isEqual(Ee.min())&&(o=$t(i)),new JP(o,s.transformResults||[])}(t,e))):[]}function M0(n,e){return{documents:[D0(n,e.path)]}}function Wu(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=D0(n,s);const i=function(u){if(u.length!==0)return B0(it.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:fs(g.field),direction:dS(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Fh(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:s}}function L0(n,e,t,r){const{_t:s,parent:i}=Wu(n,e),o={},a=[];let l=0;return t.forEach(u=>{const d=r?u.alias:"aggregate_"+l++;o[d]=u.alias,u.aggregateType==="count"?a.push({alias:d,count:{}}):u.aggregateType==="avg"?a.push({alias:d,avg:{field:fs(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:d,sum:{field:fs(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function F0(n){let e=N0(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){be(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const g=U0(f);return g instanceof it&&Sf(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(C){return new dl(eo(C.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,Rl(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(f){const g=!!f.before,_=f.values||[];return new ks(_,g)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const g=!f.before,_=f.values||[];return new ks(_,g)}(t.endAt)),a0(e,s,o,i,a,"F",l,u)}function uS(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function U0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=eo(t.unaryFilter.field);return We.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=eo(t.unaryFilter.field);return We.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=eo(t.unaryFilter.field);return We.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=eo(t.unaryFilter.field);return We.create(o,"!=",{nullValue:"NULL_VALUE"});default:return _e()}}(n):n.fieldFilter!==void 0?function(t){return We.create(eo(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _e()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return it.create(t.compositeFilter.filters.map(r=>U0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return _e()}}(t.compositeFilter.op))}(n):_e()}function dS(n){return nS[n]}function hS(n){return rS[n]}function fS(n){return sS[n]}function fs(n){return{fieldPath:n.canonicalString()}}function eo(n){return Tt.fromServerFormat(n.fieldPath)}function B0(n){return n instanceof We?function(t){if(t.op==="=="){if(bg(t.value))return{unaryFilter:{field:fs(t.field),op:"IS_NAN"}};if(wg(t.value))return{unaryFilter:{field:fs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bg(t.value))return{unaryFilter:{field:fs(t.field),op:"IS_NOT_NAN"}};if(wg(t.value))return{unaryFilter:{field:fs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fs(t.field),op:hS(t.op),value:t.value}}}(n):n instanceof it?function(t){const r=t.getFilters().map(s=>B0(s));return r.length===1?r[0]:{compositeFilter:{op:fS(t.op),filters:r}}}(n):_e()}function pS(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function $0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t,r,s,i=Ee.min(),o=Ee.min(),a=Vt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Lr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Lr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Lr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Lr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e){this.ct=e}}function mS(n,e){let t;if(e.document)t=O0(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=pe.fromSegments(e.noDocument.path),s=Ei(e.noDocument.readTime);t=vt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return _e();{const r=pe.fromSegments(e.unknownDocument.path),s=Ei(e.unknownDocument.version);t=vt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Ct(s[0],s[1]);return Ee.fromTimestamp(i)}(e.readTime)),t}function Ug(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:uu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:hl(i,o.key),fields:o.data.value.mapValue.fields,updateTime:So(i,o.version.toTimestamp()),createTime:So(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ii(e.version)};else{if(!e.isUnknownDocument())return _e();r.unknownDocument={path:t.path.toArray(),version:Ii(e.version)}}return r}function uu(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ii(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ei(n){const e=new Ct(n.seconds,n.nanoseconds);return Ee.fromTimestamp(e)}function oi(n,e){const t=(e.baseMutations||[]).map(i=>$h(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>$h(n.ct,i)),s=Ct.fromMillis(e.localWriteTimeMs);return new Nf(e.batchId,s,t,r)}function Va(n){const e=Ei(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ei(n.lastLimboFreeSnapshotVersion):Ee.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return be(i.documents.length===1),In(Bo(N0(i.documents[0])))}(n.query):function(i){return In(F0(i))}(n.query),new Lr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Vt.fromBase64String(n.resumeToken))}function q0(n,e){const t=Ii(e.snapshotVersion),r=Ii(e.lastLimboFreeSnapshotVersion);let s;s=ou(e.target)?M0(n.ct,e.target):Wu(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:vi(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Ff(n){const e=F0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lu(e,e.limit,"L"):e}function Jd(n,e){return new Of(e.largestBatchId,$h(n.ct,e.overlayMutation))}function Bg(n,e){const t=e.path.lastSegment();return[n,bn(e.path.popLast()),t]}function $g(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ii(r.readTime),documentKey:bn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{getBundleMetadata(e,t){return jg(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Ei(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return jg(e).put(function(s){return{bundleId:s.id,createTime:Ii($t(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return qg(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:Ff(i.bundledQuery),readTime:Ei(i.readTime)}}(r)})}saveNamedQuery(e,t){return qg(e).put(function(s){return{name:s.name,readTime:Ii($t(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function jg(n){return Zt(n,"bundles")}function qg(n){return Zt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Qu(e,r)}getOverlay(e,t){return wa(e).get(Bg(this.userId,t)).next(r=>r?Jd(this.serializer,r):null)}getOverlays(e,t){const r=gr();return V.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Of(t,o);s.push(this.ht(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(bn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(wa(e).j("collectionPathOverlayIndex",a))}),V.waitFor(i)}getOverlaysForCollection(e,t,r){const s=gr(),i=bn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return wa(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=Jd(this.serializer,l);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=gr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return wa(e).J({index:"collectionGroupOverlayIndex",range:a},(l,u,d)=>{const f=Jd(this.serializer,u);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return wa(e).put(function(s,i,o){const[a,l,u]=Bg(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:fl(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function wa(n){return Zt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{Pt(e){return Zt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Vt.fromUint8Array(r):Vt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Et(e.integerValue));else if("doubleValue"in e){const r=Et(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),al(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Gr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Kr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Yv(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Gu(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):_e()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Et(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),pe.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ai.vt=new ai;function yS(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function zg(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=yS(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class vS{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=zg(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=zg(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class wS{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class bS{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ba{constructor(){this.jt=new vS,this.Ht=new wS(this.jt),this.Jt=new bS(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new li(this.indexId,this.documentKey,this.arrayValue,r)}}function as(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Gg(n.arrayValue,e.arrayValue),t!==0?t:(t=Gg(n.directionalValue,e.directionalValue),t!==0?t:pe.comparator(n.documentKey,e.documentKey)))}function Gg(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e){this.Xt=new lt((t,r)=>Tt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(be(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Ch(e);if(t!==void 0&&!this.sn(t))return!1;const r=si(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new lt(Tt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new pi(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new pi(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new pi(r.field,r.dir==="asc"?0:1)));return new Io(Io.UNKNOWN_ID,this.collectionId,t,Eo.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(n){var e,t;if(be(n instanceof We||n instanceof it),n instanceof We){if(n instanceof o0){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>We.create(n.field,"==",i)))||[];return it.create(s,"or")}return n}const r=n.filters.map(s=>z0(s));return it.create(r,n.op)}function IS(n){if(n.getFilters().length===0)return[];const e=zh(z0(n));return be(G0(e)),jh(e)||qh(e)?[e]:e.getFilters()}function jh(n){return n instanceof We}function qh(n){return n instanceof it&&Sf(n)}function G0(n){return jh(n)||qh(n)||function(t){if(t instanceof it&&Vh(t)){for(const r of t.getFilters())if(!jh(r)&&!qh(r))return!1;return!0}return!1}(n)}function zh(n){if(be(n instanceof We||n instanceof it),n instanceof We)return n;if(n.filters.length===1)return zh(n.filters[0]);const e=n.filters.map(r=>zh(r));let t=it.create(e,n.op);return t=du(t),G0(t)?t:(be(t instanceof it),be(Ao(t)),be(t.filters.length>1),t.filters.reduce((r,s)=>Uf(r,s)))}function Uf(n,e){let t;return be(n instanceof We||n instanceof it),be(e instanceof We||e instanceof it),t=n instanceof We?e instanceof We?function(s,i){return it.create([s,i],"and")}(n,e):Hg(n,e):e instanceof We?Hg(e,n):function(s,i){if(be(s.filters.length>0&&i.filters.length>0),Ao(s)&&Ao(i))return r0(s,i.getFilters());const o=Vh(s)?s:i,a=Vh(s)?i:s,l=o.filters.map(u=>Uf(u,a));return it.create(l,"or")}(n,e),du(t)}function Hg(n,e){if(Ao(e))return r0(e,n.getFilters());{const t=e.filters.map(r=>Uf(n,r));return it.create(t,"or")}}function du(n){if(be(n instanceof We||n instanceof it),n instanceof We)return n;const e=n.getFilters();if(e.length===1)return du(e[0]);if(t0(n))return n;const t=e.map(s=>du(s)),r=[];return t.forEach(s=>{s instanceof We?r.push(s):s instanceof it&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:it.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.un=new Bf}addToCollectionParentIndex(e,t){return this.un.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Kn.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Kn.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class Bf{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new lt(He.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new lt(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ec=new Uint8Array(0);class TS{constructor(e,t){this.databaseId=t,this.cn=new Bf,this.ln=new Zr(r=>vi(r),(r,s)=>Cl(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:bn(s)};return Wg(e).put(i)}return V.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Lv(t),""],!1,!0);return Wg(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(mr(o.parent))}return r})}addFieldIndex(e,t){const r=Ia(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Hi(e);return i.next(a=>{o.put($g(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Ia(e),s=Hi(e),i=Ki(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ia(e),r=Ki(e),s=Hi(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return V.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Kg(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=Ki(e);let s=!0;const i=new Map;return V.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=je();const a=[];return V.forEach(i,(l,u)=>{Y("IndexedDbIndexManager",`Using index ${function($){return`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(l)} to execute ${vi(t)}`);const d=function($,j){const O=Ch(j);if(O===void 0)return null;for(const se of au($,O.fieldPath))switch(se.op){case"array-contains-any":return se.value.arrayValue.values||[];case"array-contains":return[se.value]}return null}(u,l),f=function($,j){const O=new Map;for(const se of si(j))for(const T of au($,se.fieldPath))switch(T.op){case"==":case"in":O.set(se.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return O.set(se.fieldPath.canonicalString(),T.value),Array.from(O.values())}return null}(u,l),g=function($,j){const O=[];let se=!0;for(const T of si(j)){const w=T.kind===0?xg($,T.fieldPath,$.startAt):Pg($,T.fieldPath,$.startAt);O.push(w.value),se&&(se=w.inclusive)}return new ks(O,se)}(u,l),_=function($,j){const O=[];let se=!0;for(const T of si(j)){const w=T.kind===0?Pg($,T.fieldPath,$.endAt):xg($,T.fieldPath,$.endAt);O.push(w.value),se&&(se=w.inclusive)}return new ks(O,se)}(u,l),C=this.In(l,u,g),x=this.In(l,u,_),R=this.Tn(l,u,f),L=this.En(l.indexId,d,C,g.inclusive,x,_.inclusive,R);return V.forEach(L,B=>r.G(B,t.limit).next($=>{$.forEach(j=>{const O=pe.fromSegments(j.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return V.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=IS(it.create(e.filters,"and")).map(r=>Mh(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),u=l/(t!=null?t.length:1),d=[];for(let f=0;f<l;++f){const g=t?this.dn(t[f/u]):Ec,_=this.An(e,g,r[f%u],s),C=this.Rn(e,g,i[f%u],o),x=a.map(R=>this.An(e,g,R,!0));d.push(...this.createRange(_,C,x))}return d}An(e,t,r,s){const i=new li(e,pe.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new li(e,pe.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new Kg(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return V.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new lt(Tt.comparator),d=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:u=u.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new ba;for(const s of si(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);ai.vt.It(i,o)}return r.zt()}dn(e){const t=new ba;return ai.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new ba;return ai.vt.It(yi(this.databaseId,t),r.Yt(function(i){const o=si(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new ba);let i=0;for(const o of si(e)){const a=r[i++];for(const l of s)if(this.fn(t,o.fieldPath)&&ul(a))s=this.gn(s,o,a);else{const u=l.Yt(o.kind);ai.vt.It(a,u)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new ba;l.seed(a.zt()),ai.vt.It(o,l.Yt(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof We&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ia(e),s=Hi(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(d,f){const g=f?new Eo(f.sequenceNumber,new Kn(Ei(f.readTime),new pe(mr(f.documentKey)),f.largestBatchId)):Eo.empty(),_=d.fields.map(([C,x])=>new pi(Tt.fromServerFormat(C),x));return new Io(d.indexId,d.collectionGroup,_,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ke(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Ia(e),i=Hi(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>V.forEach(a,l=>i.put($g(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return V.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,l=>this.wn(e,s,l).next(u=>{const d=this.Sn(i,l);return u.isEqual(d)?V.resolve():this.bn(e,i,l,u,d)}))))})}Dn(e,t,r,s){return Ki(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return Ki(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=Ki(e);let i=new lt(as);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new li(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new lt(as);const s=this.Vn(t,e);if(s==null)return r;const i=Ch(t);if(i!=null){const o=e.data.field(i.fieldPath);if(ul(o))for(const a of o.arrayValue.values||[])r=r.add(new li(t.indexId,e.key,this.dn(a),s))}else r=r.add(new li(t.indexId,e.key,Ec,s));return r}bn(e,t,r,s,i){Y("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,u,d,f,g){const _=l.getIterator(),C=u.getIterator();let x=Gi(_),R=Gi(C);for(;x||R;){let L=!1,B=!1;if(x&&R){const $=d(x,R);$<0?B=!0:$>0&&(L=!0)}else x!=null?B=!0:L=!0;L?(f(R),R=Gi(C)):B?(g(x),x=Gi(_)):(x=Gi(_),R=Gi(C))}}(s,i,as,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),V.waitFor(o)}yn(e){let t=1;return Hi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>as(o,a)).filter((o,a,l)=>!a||as(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=as(o,e),l=as(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Ec,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Ec,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,t){return as(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Qg)}getMinOffset(e,t){return V.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||_e())).next(Qg)}}function Wg(n){return Zt(n,"collectionParents")}function Ki(n){return Zt(n,"indexEntries")}function Ia(n){return Zt(n,"indexConfiguration")}function Hi(n){return Zt(n,"indexState")}function Qg(n){be(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Af(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Kn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class _n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new _n(e,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(d,f,g)=>(a++,g.delete()));i.push(l.next(()=>{be(a===1)}));const u=[];for(const d of t.mutations){const f=zv(e,d.key.path,t.batchId);i.push(s.delete(f)),u.push(d.key)}return V.waitFor(i).next(()=>u)}function hu(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw _e();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_n.DEFAULT_COLLECTION_PERCENTILE=10,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_n.DEFAULT=new _n(41943040,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_n.DISABLED=new _n(-1,0,0);class Ju{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){be(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Ju(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ls(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=to(e),o=ls(e);return o.add({}).next(a=>{be(typeof a=="number");const l=new Nf(a,t,r,s),u=function(_,C,x){const R=x.baseMutations.map(B=>fl(_.ct,B)),L=x.mutations.map(B=>fl(_.ct,B));return{userId:C,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,l),d=[];let f=new lt((g,_)=>ke(g.canonicalString(),_.canonicalString()));for(const g of s){const _=zv(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(u)),d.push(i.put(_,hP))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),V.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return ls(e).get(t).next(r=>r?(be(r.userId===this.userId),oi(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?V.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ls(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(be(a.batchId>=r),i=oi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ls(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ls(e).U("userMutationsIndex",t).next(r=>r.map(s=>oi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Mc(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return to(e).J({range:s},(o,a,l)=>{const[u,d,f]=o,g=mr(d);if(u===this.userId&&t.path.isEqual(g))return ls(e).get(f).next(_=>{if(!_)throw _e();be(_.userId===this.userId),i.push(oi(this.serializer,_))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new lt(ke);const s=[];return t.forEach(i=>{const o=Mc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=to(e).J({range:a},(u,d,f)=>{const[g,_,C]=u,x=mr(_);g===this.userId&&i.path.isEqual(x)?r=r.add(C):f.done()});s.push(l)}),V.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Mc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new lt(ke);return to(e).J({range:o},(l,u,d)=>{const[f,g,_]=l,C=mr(g);f===this.userId&&r.isPrefixOf(C)?C.length===s&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(ls(e).get(i).next(o=>{if(o===null)throw _e();be(o.userId===this.userId),r.push(oi(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return K0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return to(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=mr(i[1]);s.push(l)}else a.done()}).next(()=>{be(s.length===0)})})}containsKey(e,t){return H0(e,this.userId,t)}Nn(e){return W0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function H0(n,e,t){const r=Mc(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return to(n).J({range:i,H:!0},(a,l,u)=>{const[d,f,g]=a;d===e&&f===s&&(o=!0),u.done()}).next(()=>o)}function ls(n){return Zt(n,"mutations")}function to(n){return Zt(n,"documentMutations")}function W0(n){return Zt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ti(0)}static kn(){return new Ti(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new Ti(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>Ee.fromTimestamp(new Ct(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Wi(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(be(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Wi(e).J((o,a)=>{const l=Va(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Wi(e).J((r,s)=>{const i=Va(s);t(i)})}qn(e){return Yg(e).get("targetGlobalKey").next(t=>(be(t!==null),t))}Qn(e,t){return Yg(e).put("targetGlobalKey",t)}Kn(e,t){return Wi(e).put(q0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=vi(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Wi(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const u=Va(a);Cl(t,u.target)&&(i=u,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=ps(e);return t.forEach(o=>{const a=bn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,t,r){const s=ps(e);return V.forEach(t,i=>{const o=bn(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=ps(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=ps(e);let i=je();return s.J({range:r,H:!0},(o,a,l)=>{const u=mr(o[1]),d=new pe(u);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=bn(t.path),s=IDBKeyRange.bound([r],[Lv(r)],!1,!0);let i=0;return ps(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ot(e,t){return Wi(e).get(t).next(r=>r?Va(r):null)}}function Wi(n){return Zt(n,"targets")}function Yg(n){return Zt(n,"targetGlobal")}function ps(n){return Zt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg([n,e],[t,r]){const s=ke(n,t);return s===0?ke(e,r):s}class xS{constructor(e){this.Un=e,this.buffer=new lt(Xg),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Xg(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Q0{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Y("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fs(t)?Y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ls(t)}await this.Hn(3e5)})}}class PS{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return V.resolve(Vn.oe);const r=new xS(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Jg)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jg):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),Xi()<=Ke.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function J0(n,e){return new PS(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,t){this.db=e,this.garbageCollector=J0(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Tc(e,r)}removeReference(e,t,r){return Tc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Tc(e,t)}nr(e,t){return function(s,i){let o=!1;return W0(s).Y(a=>H0(s,a,i).next(l=>(l&&(o=!0),V.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Ee.min()),ps(e).delete(function(f){return[0,bn(f.path)]}(o))))});s.push(l)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Tc(e,t)}tr(e,t){const r=ps(e);let s,i=Vn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(i!==Vn.oe&&t(new pe(mr(s)),i),i=u,s=l):i=Vn.oe}).next(()=>{i!==Vn.oe&&t(new pe(mr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tc(n,e){return ps(n).put(function(r,s){return{targetId:0,path:bn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(){this.changes=new Zr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ti(e).put(r)}removeEntry(e,t,r){return ti(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],uu(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=vt.newInvalidDocument(t);return ti(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ea(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:vt.newInvalidDocument(t)};return ti(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ea(t))},(s,i)=>{r={document:this.ir(t,i),size:hu(i)}}).next(()=>r)}getEntries(e,t){let r=Mn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=Mn(),s=new _t(pe.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,hu(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return V.resolve();let s=new lt(t_);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Ea(s.first()),Ea(s.last())),o=s.getIterator();let a=o.getNext();return ti(e).J({index:"documentKeyIndex",range:i},(l,u,d)=>{const f=pe.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&t_(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(Ea(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),uu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ti(e).U(IDBKeyRange.bound(a,l,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Mn();for(const f of u){const g=this.ir(pe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Dl(t,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=Mn();const o=e_(t,r),a=e_(t,Kn.max());return ti(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,d)=>{const f=this.ir(pe.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new CS(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Zg(e).get("remoteDocumentGlobalKey").next(t=>(be(!!t),t))}rr(e,t){return Zg(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=mS(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ee.min())))return r}return vt.newInvalidDocument(e)}}function X0(n){return new RS(n)}class CS extends Y0{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Zr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new lt((i,o)=>ke(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=Ug(this.cr.serializer,o);s=s.add(i.path.popLast());const u=hu(l);r+=u-a.size,t.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=Ug(this.cr.serializer,o.convertToNoDocument(Ee.min()));t.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),V.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Zg(n){return Zt(n,"remoteDocumentGlobal")}function ti(n){return Zt(n,"remoteDocumentsV14")}function Ea(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function e_(n,e){const t=e.documentKey.path.toArray();return[n,uu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function t_(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=ke(t[i],r[i]),s)return s;return s=ke(t.length,r.length),s||(s=ke(t[t.length-2],r[r.length-2]),s||ke(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Wa(r.mutation,s,On.empty(),Ct.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,je()).next(()=>r))}getLocalViewOfDocuments(e,t,r=je()){const s=gr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Da();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=gr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,je()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Mn();const o=Ha(),a=function(){return Ha()}();return t.forEach((l,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof es)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Wa(d.mutation,u,d.mutation.getFieldMask(),Ct.now())):o.set(u.key,On.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new kS(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Ha();let s=new _t((o,a)=>o-a),i=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let d=r.get(l)||On.empty();d=a.applyToLocalView(u,d),r.set(l,d);const f=(s.get(a.batchId)||je()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=m0();d.forEach(g=>{if(!i.has(g)){const _=I0(t.get(g),r.get(g));_!==null&&f.set(g,_),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Rf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):V.resolve(gr());let a=-1,l=i;return o.next(u=>V.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,je())).next(d=>({batchId:a,changes:p0(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next(r=>{let s=Da();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Da();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,l=>{const u=function(f,g){return new Xr(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,vt.newInvalidDocument(d)))});let a=Da();return o.forEach((l,u)=>{const d=i.get(l);d!==void 0&&Wa(d.mutation,u,On.empty(),Ct.now()),Dl(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return V.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:$t(s.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:Ff(s.bundledQuery),readTime:$t(s.readTime)}}(t)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(){this.overlays=new _t(pe.comparator),this.Ir=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=gr();return V.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),V.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const s=gr(),i=t.length+1,o=new pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return V.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new _t((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=gr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=gr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=s)););return V.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Of(t,r));let i=this.Ir.get(t);i===void 0&&(i=je(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(){this.Tr=new lt(tn.Er),this.dr=new lt(tn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new tn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new tn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new pe(new He([])),r=new tn(t,e),s=new tn(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new pe(new He([])),r=new tn(t,e),s=new tn(t,e+1);let i=je();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new tn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class tn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return pe.comparator(e.key,t.key)||ke(e.wr,t.wr)}static Ar(e,t){return ke(e.wr,t.wr)||pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new lt(tn.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Nf(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new tn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new tn(t,0),s=new tn(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new lt(ke);return t.forEach(s=>{const i=new tn(s,0),o=new tn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;pe.isDocumentKey(i)||(i=i.child(""));const o=new tn(new pe(i),0);let a=new lt(ke);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(l.wr)),!0)},o),V.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){be(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(t.mutations,s=>{const i=new tn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new tn(t,0),s=this.br.firstAfterOrEqual(r);return V.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e){this.Mr=e,this.docs=function(){return new _t(pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():vt.newInvalidDocument(t))}getEntries(e,t){let r=Mn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():vt.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Mn();const o=t.path,a=new pe(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Af(Uv(d),r)<=0||(s.has(d.key)||Dl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,t,r,s){_e()}Or(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new LS(this)}getSize(e){return V.resolve(this.size)}}class LS extends Y0{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e){this.persistence=e,this.Nr=new Zr(t=>vi(t),Cl),this.lastRemoteSnapshotVersion=Ee.min(),this.highestTargetId=0,this.Lr=0,this.Br=new $f,this.targetCount=0,this.kr=Ti.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),V.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Ti(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Kn(t),V.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Vn(0),this.Kr=!1,this.Kr=!0,this.$r=new VS,this.referenceDelegate=e(this),this.Ur=new FS(this),this.indexManager=new ES,this.remoteDocumentCache=function(s){return new MS(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new j0(t),this.Gr=new DS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new NS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new OS(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){Y("MemoryPersistence","Starting transaction:",e);const s=new US(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class US extends $v{constructor(e){super(),this.currentSequenceNumber=e}}class Yu{constructor(e){this.persistence=e,this.Jr=new $f,this.Yr=null}static Zr(e){return new Yu(e)}get Xr(){if(this.Yr)return this.Yr;throw _e()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{const s=pe.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,Ee.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return V.or([()=>V.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class fu{constructor(e,t){this.persistence=e,this.ti=new Zr(r=>bn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=J0(this,t)}static Zr(e,t){return new fu(e,t)}zr(){}jr(e){return V.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return V.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?V.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,Ee.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),V.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),V.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Fc(e.data.value)),t}nr(e,t,r){return V.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ti.get(t);return V.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e){this.serializer=e}O(e,t,r,s){const i=new ju("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mg,{unique:!0}),l.createObjectStore("documentMutations")}(e),n_(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),n_(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ee.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mg,{unique:!0});const f=u.store("mutations"),g=d.map(_=>f.put(_));return V.waitFor(g)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:TP});u.createIndex("collectionPathOverlayIndex",AP,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",xP,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:fP});u.createIndex("documentKeyIndex",pP),u.createIndex("collectionGroupIndex",mP)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:wP}).createIndex("sequenceNumberIndex",bP,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:IP}).createIndex("documentKeyIndex",EP,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=hu(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>V.forEach(a,l=>{be(l.userId===i.userId);const u=oi(this.serializer,l);return K0(e,i.userId,u).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new He(o),u=function(f){return[0,bn(f)]}(l);i.push(t.get(u).next(d=>d?V.resolve():(f=>t.put({targetId:0,path:bn(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>V.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:vP});const r=t.store("collectionParents"),s=new Bf,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:bn(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new He(o);return i(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],u)=>{const d=mr(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Va(s),o=q0(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),l=function(f){return f.document?new pe(He.fromString(f.document.name).popFirst(5)):f.noDocument?pe.fromSegments(f.noDocument.path):f.unknownDocument?pe.fromSegments(f.unknownDocument.path):_e()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>V.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=X0(this.serializer),i=new jf(Yu.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var u;let d=(u=a.get(l.userId))!==null&&u!==void 0?u:je();oi(this.serializer,l).keys().forEach(f=>d=d.add(f)),a.set(l.userId,d)}),V.forEach(a,(l,u)=>{const d=new nn(u),f=Qu.lt(this.serializer,d),g=i.getIndexManager(d),_=Ju.lt(d,this.serializer,g,i.referenceDelegate);return new Z0(s,_,f,g).recalculateAndSaveOverlaysForDocumentKeys(new kh(t,Vn.oe),l).next()})})}}function n_(n){n.createObjectStore("targetDocuments",{keyPath:_P}).createIndex("documentTargetsIndex",yP,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",gP,{unique:!0}),n.createObjectStore("targetGlobal")}const Yd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class qf{constructor(e,t,r,s,i,o,a,l,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!qf.D())throw new X(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new SS(this,s),this.Ai=t+"main",this.serializer=new j0(l),this.Ri=new yr(this.Ai,this.hi,new BS(this.serializer)),this.$r=new _S,this.Ur=new AS(this.referenceDelegate,this.serializer),this.remoteDocumentCache=X0(this.serializer),this.Gr=new gS,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Ft("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new X(F.FAILED_PRECONDITION,Yd);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Vn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ac(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Fs(e))return Y("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Y("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ta(e).get("owner").next(t=>V.resolve(this.vi(t)))}Ci(e){return Ac(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Zt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?V.resolve(!0):Ta(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new X(F.FAILED_PRECONDITION,Yd);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ac(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Y("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new kh(e,Vn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Ac(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Ju.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new TS(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Qu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){Y("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===17?RP:l===16?SP:l===15?Pf:l===14?Hv:l===13?Kv:l===12?PP:l===11?Gv:void _e()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new kh(a,this.Qr?this.Qr.next():Vn.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new X(F.FAILED_PRECONDITION,Bv);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Ta(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new X(F.FAILED_PRECONDITION,Yd)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ta(e).put("owner",t)}static D(){return yr.D()}bi(e){const t=Ta(e);return t.get("owner").next(r=>this.vi(r)?(Y("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ft(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;wv()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return Y("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ft("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ft("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ta(n){return Zt(n,"owner")}function Ac(n){return Zt(n,"clientMetadata")}function zf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=je(),s=je();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Gf(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return wv()?8:jv(Xt())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new $S;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Xi()<=Ke.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",Zi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(Xi()<=Ke.DEBUG&&Y("QueryEngine","Query:",Zi(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Xi()<=Ke.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",Zi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,In(t))):V.resolve())}Yi(e,t){if(Sg(t))return V.resolve(null);let r=In(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=lu(t,null,"F"),r=In(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=je(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(t,a);return this.ns(t,u,o,l.readTime)?this.Yi(e,lu(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,r,s){return Sg(t)||s.isEqual(Ee.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?V.resolve(null):(Xi()<=Ke.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Zi(t)),this.rs(e,o,t,Fv(s,-1)).next(a=>a))})}ts(e,t){let r=new lt(h0(e));return t.forEach((s,i)=>{Dl(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return Xi()<=Ke.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",Zi(t)),this.Ji.getDocumentsMatchingQuery(e,t,Kn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new _t(ke),this._s=new Zr(i=>vi(i),Cl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Z0(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function tw(n,e,t,r){return new jS(n,e,t,r)}async function nw(n,e){const t=le(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=je();for(const u of s){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of i){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function qS(n,e){const t=le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,g=f.keys();let _=V.resolve();return g.forEach(C=>{_=_.next(()=>d.getEntry(l,C)).next(x=>{const R=u.docVersions.get(C);be(R!==null),x.version.compareTo(R)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=je();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function rw(n){const e=le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function zS(n,e){const t=le(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let _=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Vt.EMPTY_BYTE_STRING,Ee.min()).withLastLimboFreeSnapshotVersion(Ee.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(f,_),function(x,R,L){return x.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(g,_,d)&&a.push(t.Ur.updateTargetData(i,_))});let l=Mn(),u=je();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(sw(i,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!r.isEqual(Ee.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(t.os=s,i))}function sw(n,e,t){let r=je(),s=je();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Mn();return t.forEach((a,l)=>{const u=i.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Ee.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function GS(n,e){const t=le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ro(n,e){const t=le(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new Lr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Co(n,e,t){const r=le(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Fs(o))throw o;Y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function pu(n,e,t){const r=le(n);let s=Ee.min(),i=je();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=le(l),g=f._s.get(d);return g!==void 0?V.resolve(f.os.get(g)):f.Ur.getTargetData(u,d)}(r,o,In(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:Ee.min(),t?i:je())).next(a=>(aw(r,d0(e),a),{documents:a,Ts:i})))}function iw(n,e){const t=le(n),r=le(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function ow(n,e){const t=le(n),r=t.us.get(e)||Ee.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,Fv(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(aw(t,e,s),s))}function aw(n,e,t){let r=n.us.get(e)||Ee.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function KS(n,e,t,r){const s=le(n);let i=je(),o=Mn();for(const u of t){const d=e.Es(u.metadata.name);u.document&&(i=i.add(d));const f=e.ds(u);f.setReadTime(e.As(u.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),l=await Ro(s,function(d){return In(Bo(He.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>sw(u,a,o).next(d=>(a.apply(u),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(u,l.targetId).next(()=>s.Ur.addMatchingKeys(u,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))}async function HS(n,e,t=je()){const r=await Ro(n,In(Ff(e.bundledQuery))),s=le(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=$t(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(Vt.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function r_(n,e){return`firestore_clients_${n}_${e}`}function s_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Xd(n,e){return`firestore_targets_${n}_${e}`}class mu{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new X(s.error.code,s.error.message))),o?new mu(e,t,s.state,i):(Ft("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qa{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new X(r.error.code,r.error.message))),i?new Qa(e,r.state,s):(Ft("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Cf();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=qv(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new gu(e,i):(Ft("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Kf{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Kf(t.clientId,t.onlineState):(Ft("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Gh{constructor(){this.activeTargetIds=Cf()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zd{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new _t(ke),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=r_(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Gh),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(r_(this.persistenceKey,r));if(s){const i=gu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Xd(this.persistenceKey,e));if(s){const i=Qa.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Xd(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Y("SharedClientState","READ",e,t),t}setItem(e,t){Y("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Y("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(Y("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=Vn.oe;if(i!=null)try{const a=JSON.parse(i);be(typeof a=="number"),o=a}catch(a){Ft("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Vn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new mu(this.currentUser,e,t,r),i=s_(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=s_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=Xd(this.persistenceKey,e),i=new Qa(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return gu.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return mu.Rs(new nn(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return Qa.Rs(s,t)}Ls(e){return Kf.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);Y("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Cf();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class lw{constructor(){this.so=new Gh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Gh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xc=null;function eh(){return xc===null?xc=function(){return 268435456+Math.round(2147483648*Math.random())}():xc++,"0x"+xc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn="WebChannelConnection";class YS extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=eh(),l=this.xo(t,r.toUriEncodedString());Y("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(t,l,u,s).then(d=>(Y("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Jn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Uo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=QS[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=eh();return new Promise((o,a)=>{const l=new Rv;l.setWithCredentials(!0),l.listenOnce(Cv.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Oc.NO_ERROR:const d=l.getResponseJson();Y(gn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Oc.TIMEOUT:Y(gn,`RPC '${e}' ${i} timed out`),a(new X(F.DEADLINE_EXCEEDED,"Request time out"));break;case Oc.HTTP_ERROR:const f=l.getStatus();if(Y(gn,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const C=function(R){const L=R.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(L)>=0?L:F.UNKNOWN}(_.status);a(new X(C,_.message))}else a(new X(F.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new X(F.UNAVAILABLE,"Connection failed."));break;default:_e()}}finally{Y(gn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);Y(gn,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",u,r,15)})}Bo(e,t,r){const s=eh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Nv(),a=Dv(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");Y(gn,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let g=!1,_=!1;const C=new JS({Io:R=>{_?Y(gn,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(g||(Y(gn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),Y(gn,`RPC '${e}' stream ${s} sending:`,R),f.send(R))},To:()=>f.close()}),x=(R,L,B)=>{R.listen(L,$=>{try{B($)}catch(j){setTimeout(()=>{throw j},0)}})};return x(f,ka.EventType.OPEN,()=>{_||(Y(gn,`RPC '${e}' stream ${s} transport opened.`),C.yo())}),x(f,ka.EventType.CLOSE,()=>{_||(_=!0,Y(gn,`RPC '${e}' stream ${s} transport closed`),C.So())}),x(f,ka.EventType.ERROR,R=>{_||(_=!0,Jn(gn,`RPC '${e}' stream ${s} transport errored:`,R),C.So(new X(F.UNAVAILABLE,"The operation could not be completed")))}),x(f,ka.EventType.MESSAGE,R=>{var L;if(!_){const B=R.data[0];be(!!B);const $=B,j=$.error||((L=$[0])===null||L===void 0?void 0:L.error);if(j){Y(gn,`RPC '${e}' stream ${s} received error:`,j);const O=j.status;let se=function(I){const S=Ht[I];if(S!==void 0)return x0(S)}(O),T=j.message;se===void 0&&(se=F.INTERNAL,T="Unknown error status: "+O+" with message "+j.message),_=!0,C.So(new X(se,T)),f.close()}else Y(gn,`RPC '${e}' stream ${s} received:`,B),C.bo(B)}}),x(a,kv.STAT_EVENT,R=>{R.stat===Rh.PROXY?Y(gn,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===Rh.NOPROXY&&Y(gn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(){return typeof window<"u"?window:null}function jc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(n){return new iS(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Hf(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Ft(t.toString()),Ft("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new X(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class XS extends uw{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=lS(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ee.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ee.min():o.readTime?$t(o.readTime):Ee.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Bh(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=ou(l)?{documents:M0(i,l)}:{query:Wu(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=C0(i,o.resumeToken);const u=Fh(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Ee.min())>0){a.readTime=So(i,o.snapshotVersion.toTimestamp());const u=Fh(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=uS(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Bh(this.serializer),t.removeTarget=e,this.a_(t)}}class ZS extends uw{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return be(!!e.streamToken),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=cS(e.writeResults,e.commitTime),r=$t(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Bh(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>fl(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new X(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Uh(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new X(F.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Uh(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new X(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class tR{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ft(t),this.D_=!1):Y("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Bs(this)&&(Y("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=le(l);u.L_.add(4),await qo(u),u.q_.set("Unknown"),u.L_.delete(4),await Ll(u)}(this))})}),this.q_=new tR(r,s)}}async function Ll(n){if(Bs(n))for(const e of n.B_)await e(!0)}async function qo(n){for(const e of n.B_)await e(!1)}function Xu(n,e){const t=le(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Jf(t)?Qf(t):Go(t).r_()&&Wf(t,e))}function ko(n,e){const t=le(n),r=Go(t);t.N_.delete(e),r.r_()&&dw(t,e),t.N_.size===0&&(r.r_()?r.o_():Bs(t)&&t.q_.set("Unknown"))}function Wf(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ee.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Go(n).A_(e)}function dw(n,e){n.Q_.xe(e),Go(n).R_(e)}function Qf(n){n.Q_=new tS({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Go(n).start(),n.q_.v_()}function Jf(n){return Bs(n)&&!Go(n).n_()&&n.N_.size>0}function Bs(n){return le(n).L_.size===0}function hw(n){n.Q_=void 0}async function rR(n){n.q_.set("Online")}async function sR(n){n.N_.forEach((e,t)=>{Wf(n,e)})}async function iR(n,e){hw(n),Jf(n)?(n.q_.M_(e),Qf(n)):n.q_.set("Unknown")}async function oR(n,e,t){if(n.q_.set("Online"),e instanceof R0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){Y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _u(n,r)}else if(e instanceof $c?n.Q_.Ke(e):e instanceof S0?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ee.min()))try{const r=await rw(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(Vt.EMPTY_BYTE_STRING,d.snapshotVersion)),dw(i,l);const f=new Lr(d.target,l,u,d.sequenceNumber);Wf(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){Y("RemoteStore","Failed to raise snapshot:",r),await _u(n,r)}}async function _u(n,e,t){if(!Fs(e))throw e;n.L_.add(1),await qo(n),n.q_.set("Offline"),t||(t=()=>rw(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Y("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Ll(n)})}function fw(n,e){return e().catch(t=>_u(n,t,e))}async function zo(n){const e=le(n),t=Ds(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;aR(e);)try{const s=await GS(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,lR(e,s)}catch(s){await _u(e,s)}pw(e)&&mw(e)}function aR(n){return Bs(n)&&n.O_.length<10}function lR(n,e){n.O_.push(e);const t=Ds(n);t.r_()&&t.V_&&t.m_(e.mutations)}function pw(n){return Bs(n)&&!Ds(n).n_()&&n.O_.length>0}function mw(n){Ds(n).start()}async function cR(n){Ds(n).p_()}async function uR(n){const e=Ds(n);for(const t of n.O_)e.m_(t.mutations)}async function dR(n,e,t){const r=n.O_.shift(),s=Vf.from(r,e,t);await fw(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await zo(n)}async function hR(n,e){e&&Ds(n).V_&&await async function(r,s){if(function(o){return A0(o)&&o!==F.ABORTED}(s.code)){const i=r.O_.shift();Ds(r).s_(),await fw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await zo(r)}}(n,e),pw(n)&&mw(n)}async function o_(n,e){const t=le(n);t.asyncQueue.verifyOperationInProgress(),Y("RemoteStore","RemoteStore received new credentials");const r=Bs(t);t.L_.add(3),await qo(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Ll(t)}async function Kh(n,e){const t=le(n);e?(t.L_.delete(2),await Ll(t)):e||(t.L_.add(2),await qo(t),t.q_.set("Unknown"))}function Go(n){return n.K_||(n.K_=function(t,r,s){const i=le(t);return i.w_(),new XS(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:rR.bind(null,n),Ro:sR.bind(null,n),mo:iR.bind(null,n),d_:oR.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Jf(n)?Qf(n):n.q_.set("Unknown")):(await n.K_.stop(),hw(n))})),n.K_}function Ds(n){return n.U_||(n.U_=function(t,r,s){const i=le(t);return i.w_(),new ZS(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:cR.bind(null,n),mo:hR.bind(null,n),f_:uR.bind(null,n),g_:dR.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await zo(n)):(await n.U_.stop(),n.O_.length>0&&(Y("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new rn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Yf(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new X(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ko(n,e){if(Ft("AsyncQueue",`${e}: ${n}`),Fs(n))return new X(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.comparator=e?(t,r)=>e(t,r)||pe.comparator(t.key,r.key):(t,r)=>pe.comparator(t.key,r.key),this.keyedMap=Da(),this.sortedSet=new _t(this.comparator)}static emptySet(e){return new co(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof co)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new co;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(){this.W_=new _t(pe.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):_e():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Do{constructor(e,t,r,s,i,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Do(e,t,co.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class pR{constructor(){this.queries=l_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=le(t),i=s.queries;s.queries=l_(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new X(F.ABORTED,"Firestore shutting down"))}}function l_(){return new Zr(n=>u0(n),kl)}async function Xf(n,e){const t=le(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new fR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=Ko(o,`Initialization of query '${Zi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&ep(t)}async function Zf(n,e){const t=le(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function mR(n,e){const t=le(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&ep(t)}function gR(n,e,t){const r=le(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function ep(n){n.Y_.forEach(e=>{e.next()})}var Hh,c_;(c_=Hh||(Hh={})).ea="default",c_.Cache="cache";class tp{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Do(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Do.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hh.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.serializer=e}Es(e){return vr(this.serializer,e)}ds(e){return e.metadata.exists?O0(this.serializer,e.document,!1):vt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return $t(e)}}class yR{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=gw(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=He.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new u_(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||je()).add(i);t.set(o,a)}}return t}async complete(){const e=await KS(this.localStore,new u_(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await HS(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function gw(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e){this.key=e}}class yw{constructor(e){this.key=e}}class vw{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=je(),this.mutatedKeys=je(),this.Aa=h0(e),this.Ra=new co(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new a_,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),_=Dl(this.query,f)?f:null,C=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let R=!1;g&&_?g.data.isEqual(_.data)?C!==x&&(r.track({type:3,doc:_}),R=!0):this.ga(g,_)||(r.track({type:2,doc:_}),R=!0,(l&&this.Aa(_,l)>0||u&&this.Aa(_,u)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),R=!0):g&&!_&&(r.track({type:1,doc:g}),R=!0,(l||u)&&(a=!0)),R&&(_?(o=o.add(_),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(_,C){const x=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e()}};return x(_)-x(C)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new Do(this.query,e.Ra,i,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new a_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=je(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new yw(r))}),this.da.forEach(r=>{e.has(r)||t.push(new _w(r))}),t}ba(e){this.Ta=e.Ts,this.da=je();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Do.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class vR{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class wR{constructor(e){this.key=e,this.va=!1}}class bR{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Zr(a=>u0(a),kl),this.Ma=new Map,this.xa=new Set,this.Oa=new _t(pe.comparator),this.Na=new Map,this.La=new $f,this.Ba={},this.ka=new Map,this.qa=Ti.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function IR(n,e,t=!0){const r=Zu(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await ww(r,e,t,!0),s}async function ER(n,e){const t=Zu(n);await ww(t,e,!0,!1)}async function ww(n,e,t,r){const s=await Ro(n.localStore,In(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await np(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Xu(n.remoteStore,s),a}async function np(n,e,t,r,s){n.Ka=(f,g,_)=>async function(x,R,L,B){let $=R.view.ma(L);$.ns&&($=await pu(x.localStore,R.query,!1).then(({documents:T})=>R.view.ma(T,$)));const j=B&&B.targetChanges.get(R.targetId),O=B&&B.targetMismatches.get(R.targetId)!=null,se=R.view.applyChanges($,x.isPrimaryClient,j,O);return Wh(x,R.targetId,se.wa),se.snapshot}(n,f,g,_);const i=await pu(n.localStore,e,!0),o=new vw(e,i.Ts),a=o.ma(i.documents),l=Ol.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,l);Wh(n,t,u.wa);const d=new vR(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function TR(n,e,t){const r=le(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!kl(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Co(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&ko(r.remoteStore,s.targetId),No(r,s.targetId)}).catch(Ls)):(No(r,s.targetId),await Co(r.localStore,s.targetId,!0))}async function AR(n,e){const t=le(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ko(t.remoteStore,r.targetId))}async function xR(n,e,t){const r=op(n);try{const s=await function(o,a){const l=le(o),u=Ct.now(),d=a.reduce((_,C)=>_.add(C.key),je());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let C=Mn(),x=je();return l.cs.getEntries(_,d).next(R=>{C=R,C.forEach((L,B)=>{B.isValidDocument()||(x=x.add(L))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,C)).next(R=>{f=R;const L=[];for(const B of a){const $=XP(B,f.get(B.key).overlayedDocument);$!=null&&L.push(new es(B.key,$,Zv($.value.mapValue),At.exists(!0)))}return l.mutationQueue.addMutationBatch(_,u,L,a)}).next(R=>{g=R;const L=R.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(_,R.batchId,L)})}).then(()=>({batchId:g.batchId,changes:p0(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new _t(ke)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,t),await ts(r,s.changes),await zo(r.remoteStore)}catch(s){const i=Ko(s,"Failed to persist write");t.reject(i)}}async function bw(n,e){const t=le(n);try{const r=await zS(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?be(o.va):s.removedDocuments.size>0&&(be(o.va),o.va=!1))}),await ts(t,r,e)}catch(r){await Ls(r)}}function d_(n,e,t){const r=le(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=le(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(a)&&(u=!0)}),u&&ep(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PR(n,e,t){const r=le(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new _t(pe.comparator);o=o.insert(i,vt.newNoDocument(i,Ee.min()));const a=je().add(i),l=new Vl(Ee.min(),new Map,new _t(ke),o,a);await bw(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),ip(r)}else await Co(r.localStore,e,!1).then(()=>No(r,e,t)).catch(Ls)}async function SR(n,e){const t=le(n),r=e.batch.batchId;try{const s=await qS(t.localStore,e);sp(t,r,null),rp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ts(t,s)}catch(s){await Ls(s)}}async function RR(n,e,t){const r=le(n);try{const s=await function(o,a){const l=le(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(be(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);sp(r,e,t),rp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ts(r,s)}catch(s){await Ls(s)}}async function CR(n,e){const t=le(n);Bs(t.remoteStore)||Y("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=le(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=Ko(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function rp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function sp(n,e,t){const r=le(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function No(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Iw(n,r)})}function Iw(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(ko(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),ip(n))}function Wh(n,e,t){for(const r of t)r instanceof _w?(n.La.addReference(r.key,e),kR(n,r)):r instanceof yw?(Y("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Iw(n,r.key)):_e()}function kR(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(Y("SyncEngine","New document in limbo: "+t),n.xa.add(r),ip(n))}function ip(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new pe(He.fromString(e)),r=n.qa.next();n.Na.set(r,new wR(t)),n.Oa=n.Oa.insert(t,r),Xu(n.remoteStore,new Lr(In(Bo(t.path)),r,"TargetPurposeLimboResolution",Vn.oe))}}async function ts(n,e,t){const r=le(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){s.push(u);const f=Gf.Wi(l.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,u){const d=le(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>V.forEach(u,g=>V.forEach(g.$i,_=>d.persistence.referenceDelegate.addReference(f,g.targetId,_)).next(()=>V.forEach(g.Ui,_=>d.persistence.referenceDelegate.removeReference(f,g.targetId,_)))))}catch(f){if(!Fs(f))throw f;Y("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const _=d.os.get(g),C=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(C);d.os=d.os.insert(g,x)}}}(r.localStore,i))}async function DR(n,e){const t=le(n);if(!t.currentUser.isEqual(e)){Y("SyncEngine","User change. New user:",e.toKey());const r=await nw(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new X(F.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ts(t,r.hs)}}function NR(n,e){const t=le(n),r=t.Na.get(e);if(r&&r.va)return je().add(r.key);{let s=je();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function VR(n,e){const t=le(n),r=await pu(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&Wh(t,e.targetId,s.wa),s}async function OR(n,e){const t=le(n);return ow(t.localStore,e).then(r=>ts(t,r))}async function MR(n,e,t,r){const s=le(n),i=await function(a,l){const u=le(a),d=le(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,l).next(g=>g?u.localDocuments.getDocuments(f,g):V.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await zo(s.remoteStore):t==="acknowledged"||t==="rejected"?(sp(s,e,r||null),rp(s,e),function(a,l){le(le(a).mutationQueue).On(l)}(s.localStore,e)):_e(),await ts(s,i)):Y("SyncEngine","Cannot apply mutation batch with id: "+e)}async function LR(n,e){const t=le(n);if(Zu(t),op(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await h_(t,r.toArray());t.Qa=!0,await Kh(t.remoteStore,!0);for(const i of s)Xu(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(No(t,o),Co(t.localStore,o,!0))),ko(t.remoteStore,o)}),await s,await h_(t,r),function(o){const a=le(o);a.Na.forEach((l,u)=>{ko(a.remoteStore,u)}),a.La.pr(),a.Na=new Map,a.Oa=new _t(pe.comparator)}(t),t.Qa=!1,await Kh(t.remoteStore,!1)}}async function h_(n,e,t){const r=le(n),s=[],i=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await Ro(r.localStore,In(l[0]));for(const u of l){const d=r.Fa.get(u),f=await VR(r,d);f.snapshot&&i.push(f.snapshot)}}else{const u=await iw(r.localStore,o);a=await Ro(r.localStore,u),await np(r,Ew(u),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function Ew(n){return a0(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function FR(n){return function(t){return le(le(t).persistence).Qi()}(le(n).localStore)}async function UR(n,e,t,r){const s=le(n);if(s.Qa)return void Y("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await ow(s.localStore,d0(i[0])),a=Vl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Vt.EMPTY_BYTE_STRING);await ts(s,o,a);break}case"rejected":await Co(s.localStore,e,!0),No(s,e,r);break;default:_e()}}async function BR(n,e,t){const r=Zu(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){Y("SyncEngine","Adding an already active target "+s);continue}const i=await iw(r.localStore,s),o=await Ro(r.localStore,i);await np(r,Ew(i),o.targetId,!1,o.resumeToken),Xu(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await Co(r.localStore,s,!1).then(()=>{ko(r.remoteStore,s),No(r,s)}).catch(Ls)}}function Zu(n){const e=le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=bw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=NR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PR.bind(null,e),e.Ca.d_=mR.bind(null,e.eventManager),e.Ca.$a=gR.bind(null,e.eventManager),e}function op(n){const e=le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RR.bind(null,e),e}function $R(n,e,t){const r=le(n);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(_,C){const x=le(_),R=$t(C.createTime);return x.persistence.runTransaction("hasNewerBundle","readonly",L=>x.Gr.getBundleMetadata(L,C.id)).then(L=>!!L&&L.createTime.compareTo(R)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(gw(l));const u=new yR(l,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await u.la(d);g&&a._updateProgress(g),d=await o.Ua()}const f=await u.complete();return await ts(i,f.Ia,void 0),await function(_,C){const x=le(_);return x.persistence.runTransaction("Save bundle","readwrite",R=>x.Gr.saveBundleMetadata(R,C))}(i.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(l){return Jn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Ns{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ml(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return tw(this.persistence,new ew,e.initialUser,this.serializer)}Ga(e){return new jf(Yu.Zr,this.serializer)}Wa(e){return new lw}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ns.provider={build:()=>new Ns};class jR extends Ns{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){be(this.persistence.referenceDelegate instanceof fu);const r=this.persistence.referenceDelegate.garbageCollector;return new Q0(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?_n.withCacheSize(this.cacheSizeBytes):_n.DEFAULT;return new jf(r=>fu.Zr(r,t),this.serializer)}}class ap extends Ns{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await op(this.Ja.syncEngine),await zo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return tw(this.persistence,new ew,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new Q0(r,e.asyncQueue,t)}Ha(e,t){const r=new uP(t,this.persistence);return new cP(e.asyncQueue,r)}Ga(e){const t=zf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?_n.withCacheSize(this.cacheSizeBytes):_n.DEFAULT;return new qf(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,cw(),jc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new lw}}class Tw extends ap{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Zd&&(this.sharedClientState.syncEngine={no:MR.bind(null,t),ro:UR.bind(null,t),io:BR.bind(null,t),Qi:FR.bind(null,t),eo:OR.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await LR(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=cw();if(!Zd.D(t))throw new X(F.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=zf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Zd(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vs{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>d_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=DR.bind(null,this.syncEngine),await Kh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new pR}()}createDatastore(e){const t=Ml(e.databaseInfo.databaseId),r=function(i){return new YS(i)}(e.databaseInfo);return function(i,o,a,l){return new eR(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new nR(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>d_(this.syncEngine,t,0),function(){return i_.D()?new i_:new WS}())}createSyncEngine(e,t){return function(s,i,o,a,l,u,d){const f=new bR(s,i,o,a,l,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=le(s);Y("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await qo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Vs.provider={build:()=>new Vs};function f_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ft("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new rn,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new _R(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new X(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=le(s),a={documents:i.map(f=>hl(o.serializer,f))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,He.emptyPath(),a,i.length),u=new Map;l.forEach(f=>{const g=aS(o.serializer,f);u.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=u.get(f.toString());be(!!g),d.push(g)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new jo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=pe.fromPath(r);this.mutations.push(new Df(s,this.precondition(s)))}),await async function(r,s){const i=le(r),o={writes:s.map(a=>fl(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,He.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw _e();t=Ee.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new X(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ee.min())?At.exists(!1):At.updateTime(t):At.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ee.min()))throw new X(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return At.updateTime(t)}return At.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new Hf(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new zR(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!Rl(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!A0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=nn.UNAUTHENTICATED,this.clientId=Mv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Y("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Y("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ko(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function th(n,e){n.asyncQueue.verifyOperationInProgress(),Y("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await nw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function p_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lp(n);Y("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>o_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>o_(e.remoteStore,s)),n._onlineComponents=e}async function lp(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Y("FirestoreClient","Using user provided OfflineComponentProvider");try{await th(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Jn("Error using user provided cache. Falling back to memory cache: "+t),await th(n,new Ns)}}else Y("FirestoreClient","Using default OfflineComponentProvider"),await th(n,new Ns);return n._offlineComponents}async function td(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Y("FirestoreClient","Using user provided OnlineComponentProvider"),await p_(n,n._uninitializedComponentsProvider._online)):(Y("FirestoreClient","Using default OnlineComponentProvider"),await p_(n,new Vs))),n._onlineComponents}function Aw(n){return lp(n).then(e=>e.persistence)}function Ho(n){return lp(n).then(e=>e.localStore)}function xw(n){return td(n).then(e=>e.remoteStore)}function cp(n){return td(n).then(e=>e.syncEngine)}function Pw(n){return td(n).then(e=>e.datastore)}async function Vo(n){const e=await td(n),t=e.eventManager;return t.onListen=IR.bind(null,e.syncEngine),t.onUnlisten=TR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=ER.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=AR.bind(null,e.syncEngine),t}function HR(n){return n.asyncQueue.enqueue(async()=>{const e=await Aw(n),t=await xw(n);return e.setNetworkEnabled(!0),function(s){const i=le(s);return i.L_.delete(0),Ll(i)}(t)})}function WR(n){return n.asyncQueue.enqueue(async()=>{const e=await Aw(n),t=await xw(n);return e.setNetworkEnabled(!1),async function(s){const i=le(s);i.L_.add(0),await qo(i),i.q_.set("Offline")}(t)})}function QR(n,e){const t=new rn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(u,d){const f=le(u);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new X(F.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Ko(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await Ho(n),e,t)),t.promise}function Sw(n,e,t={}){const r=new rn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const d=new ed({next:g=>{d.Za(),o.enqueueAndForget(()=>Zf(i,f));const _=g.docs.has(a);!_&&g.fromCache?u.reject(new X(F.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&l&&l.source==="server"?u.reject(new X(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new tp(Bo(a.path),d,{includeMetadataChanges:!0,_a:!0});return Xf(i,f)}(await Vo(n),n.asyncQueue,e,t,r)),r.promise}function JR(n,e){const t=new rn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await pu(s,i,!0),l=new vw(i,a.Ts),u=l.ma(a.documents),d=l.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){const l=Ko(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await Ho(n),e,t)),t.promise}function Rw(n,e,t={}){const r=new rn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const d=new ed({next:g=>{d.Za(),o.enqueueAndForget(()=>Zf(i,f)),g.fromCache&&l.source==="server"?u.reject(new X(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new tp(a,d,{includeMetadataChanges:!0,_a:!0});return Xf(i,f)}(await Vo(n),n.asyncQueue,e,t,r)),r.promise}function YR(n,e,t){const r=new rn;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await Pw(n);r.resolve(async function(o,a,l){var u;const d=le(o),{request:f,ut:g,parent:_}=L0(d.serializer,l0(a),l);d.connection.Fo||delete f.parent;const C=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,_,f,1)).filter(R=>!!R.result);be(C.length===1);const x=(u=C[0].result)===null||u===void 0?void 0:u.aggregateFields;return Object.keys(x).reduce((R,L)=>(R[g[L]]=x[L],R),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function XR(n,e){const t=new ed(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){le(s).Y_.add(i),i.next()}(await Vo(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){le(s).Y_.delete(i)}(await Vo(n),t))}}function ZR(n,e,t,r){const s=function(o,a){let l;return l=typeof o=="string"?P0().encode(o):o,function(d,f){return new qR(d,f)}(function(d,f){if(d instanceof Uint8Array)return f_(d,f);if(d instanceof ArrayBuffer)return f_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,Ml(e));n.asyncQueue.enqueueAndForget(async()=>{$R(await cp(n),s,r)})}function eC(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=le(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await Ho(n),e))}function tC(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=le(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(u=>function(f,g,_,C,x){f=[...f],g=[...g],f.sort(_),g.sort(_);const R=f.length,L=g.length;let B=0,$=0;for(;B<L&&$<R;){const j=_(f[$],g[B]);j<0?x(f[$++]):j>0?C(g[B++]):(B++,$++)}for(;B<L;)C(g[B++]);for(;$<R;)x(f[$++])}(u,s,iP,d=>{a.push(o.addFieldIndex(l,d))},d=>{a.push(o.deleteFieldIndex(l,d))})).next(()=>V.waitFor(a)))}(await Ho(n),e))}function nC(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){le(r).ss.zi=s}(await Ho(n),e))}function rC(n){return n.asyncQueue.enqueue(async()=>function(t){const r=le(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await Ho(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(n,e,t){if(!t)throw new X(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function sC(n,e,t,r){if(e===!0&&r===!0)throw new X(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function g_(n){if(!pe.isDocumentKey(n))throw new X(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function __(n){if(pe.isDocumentKey(n))throw new X(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function nd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":_e()}function qe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new X(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=nd(n);throw new X(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function kw(n,e){if(e<=0)throw new X(F.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new X(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new X(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new X(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new X(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new X(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fl{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new y_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new X(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new X(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new y_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Yx;switch(r.type){case"firstParty":return new tP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new X(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=m_.get(t);r&&(Y("ComponentProvider","Removing Datastore"),m_.delete(t),r.terminate())}(this),Promise.resolve()}}function iC(n,e,t,r={}){var s;const i=(n=qe(n,Fl))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=nn.MOCK_USER;else{a=xA(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new X(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new nn(u)}n._authCredentials=new Xx(new Vv(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dn(this.firestore,e,this._query)}}class jt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}}class wr extends dn{constructor(e,t,r){super(e,t,Bo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new pe(e))}withConverter(e){return new wr(this.firestore,e,this._path)}}function tt(n,e,...t){if(n=Te(n),up("collection","path",e),n instanceof Fl){const r=He.fromString(e,...t);return __(r),new wr(n,null,r)}{if(!(n instanceof jt||n instanceof wr))throw new X(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(He.fromString(e,...t));return __(r),new wr(n.firestore,null,r)}}function EL(n,e){if(n=qe(n,Fl),up("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new X(F.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dn(n,null,function(r){return new Xr(He.emptyPath(),r)}(e))}function Me(n,e,...t){if(n=Te(n),arguments.length===1&&(e=Mv.newId()),up("doc","path",e),n instanceof Fl){const r=He.fromString(e,...t);return g_(r),new jt(n,null,new pe(r))}{if(!(n instanceof jt||n instanceof wr))throw new X(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(He.fromString(e,...t));return g_(r),new jt(n.firestore,n instanceof wr?n.converter:null,new pe(r))}}function TL(n,e){return n=Te(n),e=Te(e),(n instanceof jt||n instanceof wr)&&(e instanceof jt||e instanceof wr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Dw(n,e){return n=Te(n),e=Te(e),n instanceof dn&&e instanceof dn&&n.firestore===e.firestore&&kl(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Hf(this,"async_queue_retry"),this.Vu=()=>{const r=jc();r&&Y("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=jc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=jc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new rn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Fs(e))throw e;Y("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ft("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=Yf.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&_e()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Qh(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class oC{constructor(){this._progressObserver={},this._taskCompletionResolver=new rn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL=-1;class ht extends Fl{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new v_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new v_(e),this._firestoreClient=void 0,await e}}}function xL(n,e,t){t||(t="(default)");const r=Sl(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(Ps(i,e))return s;throw new X(F.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new X(F.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new X(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function aC(n,e){const t=typeof n=="object"?n:Av(),r=typeof n=="string"?n:e||"(default)",s=Sl(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=TA("firestore");i&&iC(s,...i)}return s}function kt(n){if(n._terminated)throw new X(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Nw(n),n._firestoreClient}function Nw(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,u,d){return new kP(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Cw(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new KR(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function lC(n,e){Jn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Vw(n,Vs.provider,{build:r=>new ap(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function PL(n){Jn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Vw(n,Vs.provider,{build:t=>new Tw(t,e.cacheSizeBytes)})}function Vw(n,e,t){if((n=qe(n,ht))._firestoreClient||n._terminated)throw new X(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new X(F.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Nw(n)}function SL(n){if(n._initialized&&!n._terminated)throw new X(F.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new rn;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!yr.D())return Promise.resolve();const s=r+"main";await yr.delete(s)}(zf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function RL(n){return function(t){const r=new rn;return t.asyncQueue.enqueueAndForget(async()=>CR(await cp(t),r)),r.promise}(kt(n=qe(n,ht)))}function CL(n){return HR(kt(n=qe(n,ht)))}function kL(n){return WR(kt(n=qe(n,ht)))}function DL(n){return Lx(n.app,"firestore",n._databaseId.database),n._delete()}function NL(n,e){const t=kt(n=qe(n,ht)),r=new oC;return ZR(t,n._databaseId,e,r),r}function VL(n,e){return eC(kt(n=qe(n,ht)),e).then(t=>t?new dn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class cC{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ai(Vt.fromBase64String(e))}catch(t){throw new X(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ai(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new X(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function OL(){return new Si("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new X(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new X(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ke(this._lat,e._lat)||ke(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=/^__.*__$/;class dC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new es(e,this.data,this.fieldMask,t,this.fieldTransforms):new $o(e,this.data,t,this.fieldTransforms)}}class Ow{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new es(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Mw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e()}}class sd{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new sd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Mw(this.Cu)&&uC.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class hC{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ml(e)}Qu(e,t,r,s=!1){return new sd({Cu:e,methodName:t,qu:r,path:Tt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ci(n){const e=n._freezeSettings(),t=Ml(n._databaseId);return new hC(n._databaseId,!!e.ignoreUndefinedProperties,t)}function id(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);yp("Data must be an object, but it was:",o,r);const a=Uw(r,o);let l,u;if(i.merge)l=new On(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=ml(e,f,t);if(!o.contains(g))throw new X(F.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);$w(d,g)||d.push(g)}l=new On(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new dC(new un(a),l,u)}class Ul extends Ri{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ul}}function Lw(n,e,t){return new sd({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class hp extends Ri{_toFieldTransform(e){return new Nl(e.path,new xo)}isEqual(e){return e instanceof hp}}class fp extends Ri{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Lw(this,e,!0),r=this.Ku.map(i=>ki(i,t)),s=new wi(r);return new Nl(e.path,s)}isEqual(e){return e instanceof fp&&Ps(this.Ku,e.Ku)}}class pp extends Ri{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Lw(this,e,!0),r=this.Ku.map(i=>ki(i,t)),s=new bi(r);return new Nl(e.path,s)}isEqual(e){return e instanceof pp&&Ps(this.Ku,e.Ku)}}class mp extends Ri{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Po(e.serializer,_0(e.serializer,this.$u));return new Nl(e.path,t)}isEqual(e){return e instanceof mp&&this.$u===e.$u}}function gp(n,e,t,r){const s=n.Qu(1,e,t);yp("Data must be an object, but it was:",s,r);const i=[],o=un.empty();Us(r,(l,u)=>{const d=od(e,l,t);u=Te(u);const f=s.Nu(d);if(u instanceof Ul)i.push(d);else{const g=ki(u,f);g!=null&&(i.push(d),o.set(d,g))}});const a=new On(i);return new Ow(o,a,s.fieldTransforms)}function _p(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[ml(e,r,t)],l=[s];if(i.length%2!=0)throw new X(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(ml(e,i[g])),l.push(i[g+1]);const u=[],d=un.empty();for(let g=a.length-1;g>=0;--g)if(!$w(u,a[g])){const _=a[g];let C=l[g];C=Te(C);const x=o.Nu(_);if(C instanceof Ul)u.push(_);else{const R=ki(C,x);R!=null&&(u.push(_),d.set(_,R))}}const f=new On(u);return new Ow(d,f,o.fieldTransforms)}function Fw(n,e,t,r=!1){return ki(t,n.Qu(r?4:3,e))}function ki(n,e){if(Bw(n=Te(n)))return yp("Unsupported field value:",e,n),Uw(n,e);if(n instanceof Ri)return function(r,s){if(!Mw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=ki(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return _0(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ct.fromDate(r);return{timestampValue:So(s.serializer,i)}}if(r instanceof Ct){const i=new Ct(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:So(s.serializer,i)}}if(r instanceof dp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ai)return{bytesValue:C0(s.serializer,r._byteString)};if(r instanceof jt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Lf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof rd)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return kf(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${nd(r)}`)}(n,e)}function Uw(n,e){const t={};return Qv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Us(n,(r,s)=>{const i=ki(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function Bw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ct||n instanceof dp||n instanceof Ai||n instanceof jt||n instanceof Ri||n instanceof rd)}function yp(n,e,t){if(!Bw(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=nd(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function ml(n,e,t){if((e=Te(e))instanceof Si)return e._internalPath;if(typeof e=="string")return od(n,e);throw yu("Field path arguments must be of type string or ",n,!1,void 0,t)}const fC=new RegExp("[~\\*/\\[\\]]");function od(n,e,t){if(e.search(fC)>=0)throw yu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Si(...e.split("."))._internalPath}catch{throw yu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yu(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new X(F.INVALID_ARGUMENT,a+n+l)}function $w(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ad("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class pC extends gl{data(){return super.data()}}function ad(n,e){return typeof e=="string"?od(n,e):e instanceof Si?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new X(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vp{}class Bl extends vp{}function qw(n,e,...t){let r=[];e instanceof vp&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof Wo).length,a=i.filter(l=>l instanceof $l).length;if(o>1||o>0&&a>0)throw new X(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class $l extends Bl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new $l(e,t,r)}_apply(e){const t=this._parse(e);return Gw(e._query,t),new dn(e.firestore,e.converter,Lh(e._query,t))}_parse(e){const t=Ci(e.firestore);return function(i,o,a,l,u,d,f){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new X(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){b_(f,d);const _=[];for(const C of f)_.push(w_(l,i,C));g={arrayValue:{values:_}}}else g=w_(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||b_(f,d),g=Fw(a,o,f,d==="in"||d==="not-in");return We.create(u,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mC(n,e,t){const r=e,s=ad("where",n);return $l._create(s,r,t)}class Wo extends vp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Wo(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:it.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)Gw(o,l),o=Lh(o,l)}(e._query,t),new dn(e.firestore,e.converter,Lh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function ML(...n){return n.forEach(e=>Kw("or",e)),Wo._create("or",n)}function LL(...n){return n.forEach(e=>Kw("and",e)),Wo._create("and",n)}class wp extends Bl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wp(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new X(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new X(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new dl(i,o)}(e._query,this._field,this._direction);return new dn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Xr(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function gC(n,e="asc"){const t=e,r=ad("orderBy",n);return wp._create(r,t)}class ld extends Bl{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new ld(e,t,r)}_apply(e){return new dn(e.firestore,e.converter,lu(e._query,this._limit,this._limitType))}}function FL(n){return kw("limit",n),ld._create("limit",n,"F")}function UL(n){return kw("limitToLast",n),ld._create("limitToLast",n,"L")}class cd extends Bl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new cd(e,t,r)}_apply(e){const t=zw(e,this.type,this._docOrFields,this._inclusive);return new dn(e.firestore,e.converter,function(s,i){return new Xr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function BL(...n){return cd._create("startAt",n,!0)}function $L(...n){return cd._create("startAfter",n,!1)}class ud extends Bl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new ud(e,t,r)}_apply(e){const t=zw(e,this.type,this._docOrFields,this._inclusive);return new dn(e.firestore,e.converter,function(s,i){return new Xr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function jL(...n){return ud._create("endBefore",n,!1)}function qL(...n){return ud._create("endAt",n,!0)}function zw(n,e,t,r){if(t[0]=Te(t[0]),t[0]instanceof gl)return function(i,o,a,l,u){if(!l)throw new X(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of lo(i))if(f.field.isKeyField())d.push(yi(o,l.key));else{const g=l.data.field(f.field);if(qu(g))throw new X(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const _=f.field.canonicalString();throw new X(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(g)}return new ks(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Ci(n.firestore);return function(o,a,l,u,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new X(F.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let C=0;C<d.length;C++){const x=d[C];if(g[C].field.isKeyField()){if(typeof x!="string")throw new X(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof x}`);if(!Rf(o)&&x.indexOf("/")!==-1)throw new X(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${x}' contains a slash.`);const R=o.path.child(He.fromString(x));if(!pe.isDocumentKey(R))throw new X(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);const L=new pe(R);_.push(yi(a,L))}else{const R=Fw(l,u,x);_.push(R)}}return new ks(_,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function w_(n,e,t){if(typeof(t=Te(t))=="string"){if(t==="")throw new X(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rf(e)&&t.indexOf("/")!==-1)throw new X(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(He.fromString(t));if(!pe.isDocumentKey(r))throw new X(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yi(n,new pe(r))}if(t instanceof jt)return yi(n,t._key);throw new X(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nd(t)}.`)}function b_(n,e){if(!Array.isArray(n)||n.length===0)throw new X(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Gw(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new X(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new X(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Kw(n,e){if(!(e instanceof $l||e instanceof Wo))throw new X(F.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Hw{convertValue(e,t="none"){switch(Rs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _e()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Us(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Et(o.doubleValue));return new rd(i)}convertGeoPoint(e){return new dp(Et(e.latitude),Et(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=zu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ll(e));default:return null}}convertTimestamp(e){const t=Gr(e);return new Ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=He.fromString(e);be($0(r));const s=new _i(r.get(1),r.get(3)),i=new pe(r.popFirst(5));return s.isEqual(t)||Ft(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class _C extends Hw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ai(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(n){return new pl("sum",ml("sum",n))}function GL(n){return new pl("avg",ml("average",n))}function yC(){return new pl("count")}function KL(n,e){var t,r;return n instanceof pl&&e instanceof pl&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function HL(n,e){return Dw(n.query,e.query)&&Ps(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Oo extends gl{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new qc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ad("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class qc extends Oo{data(e={}){return super.data(e)}}class Mo{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new ci(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new qc(this._firestore,this._userDataWriter,r.key,r,new ci(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new X(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new qc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ci(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new qc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ci(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:vC(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function vC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e()}}function WL(n,e){return n instanceof Oo&&e instanceof Oo?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Mo&&e instanceof Mo&&n._firestore===e._firestore&&Dw(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Di(n){n=qe(n,jt);const e=qe(n.firestore,ht);return Sw(kt(e),n._key).then(t=>bp(e,n,t))}class $s extends Hw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ai(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}function QL(n){n=qe(n,jt);const e=qe(n.firestore,ht),t=kt(e),r=new $s(e);return QR(t,n._key).then(s=>new Oo(e,r,n._key,s,new ci(s!==null&&s.hasLocalMutations,!0),n.converter))}function JL(n){n=qe(n,jt);const e=qe(n.firestore,ht);return Sw(kt(e),n._key,{source:"server"}).then(t=>bp(e,n,t))}function xt(n){n=qe(n,dn);const e=qe(n.firestore,ht),t=kt(e),r=new $s(e);return jw(n._query),Rw(t,n._query).then(s=>new Mo(e,r,n,s))}function YL(n){n=qe(n,dn);const e=qe(n.firestore,ht),t=kt(e),r=new $s(e);return JR(t,n._query).then(s=>new Mo(e,r,n,s))}function XL(n){n=qe(n,dn);const e=qe(n.firestore,ht),t=kt(e),r=new $s(e);return Rw(t,n._query,{source:"server"}).then(s=>new Mo(e,r,n,s))}function Rn(n,e,t){n=qe(n,jt);const r=qe(n.firestore,ht),s=dd(n.converter,e,t);return jl(r,[id(Ci(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,At.none())])}function wC(n,e,t,...r){n=qe(n,jt);const s=qe(n.firestore,ht),i=Ci(s);let o;return o=typeof(e=Te(e))=="string"||e instanceof Si?_p(i,"updateDoc",n._key,e,t,r):gp(i,"updateDoc",n._key,e),jl(s,[o.toMutation(n._key,At.exists(!0))])}function _l(n){return jl(qe(n.firestore,ht),[new jo(n._key,At.none())])}function Ww(n,e){const t=qe(n.firestore,ht),r=Me(n),s=dd(n.converter,e);return jl(t,[id(Ci(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,At.exists(!1))]).then(()=>r)}function ZL(n,...e){var t,r,s;n=Te(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Qh(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Qh(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,u,d;if(n instanceof jt)u=qe(n.firestore,ht),d=Bo(n._key.path),l={next:f=>{e[o]&&e[o](bp(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=qe(n,dn);u=qe(f.firestore,ht),d=f._query;const g=new $s(u);l={next:_=>{e[o]&&e[o](new Mo(u,g,f,_))},error:e[o+1],complete:e[o+2]},jw(n._query)}return function(g,_,C,x){const R=new ed(x),L=new tp(_,R,C);return g.asyncQueue.enqueueAndForget(async()=>Xf(await Vo(g),L)),()=>{R.Za(),g.asyncQueue.enqueueAndForget(async()=>Zf(await Vo(g),L))}}(kt(u),d,a,l)}function eF(n,e){return XR(kt(n=qe(n,ht)),Qh(e)?e:{next:e})}function jl(n,e){return function(r,s){const i=new rn;return r.asyncQueue.enqueueAndForget(async()=>xR(await cp(r),s,i)),i.promise}(kt(n),e)}function bp(n,e,t){const r=t.docs.get(e._key),s=new $s(n);return new Oo(n,s,e._key,r,new ci(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(n){return bC(n,{count:yC()})}function bC(n,e){const t=qe(n.firestore,ht),r=kt(t),s=Wv(e,(i,o)=>new T0(o,i.aggregateType,i._internalFieldPath));return YR(r,n._query,s).then(i=>function(a,l,u){const d=new $s(a);return new cC(l,d,u)}(t,n,i))}class IC{constructor(e){this.kind="memory",this._onlineComponentProvider=Vs.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=Ns.provider}toJSON(){return{kind:this.kind}}}class EC{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=SC(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class TC{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Ns.provider}toJSON(){return{kind:this.kind}}}class AC{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new jR(e)}}toJSON(){return{kind:this.kind}}}function nF(){return new TC}function rF(n){return new AC(n==null?void 0:n.cacheSizeBytes)}function sF(n){return new IC(n)}function iF(n){return new EC(n)}class xC{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Vs.provider,this._offlineComponentProvider={build:t=>new ap(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class PC{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Vs.provider,this._offlineComponentProvider={build:t=>new Tw(t,e==null?void 0:e.cacheSizeBytes)}}}function SC(n){return new xC(n==null?void 0:n.forceOwnership)}function oF(){return new PC}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ci(e)}set(e,t,r){this._verifyNotCommitted();const s=ms(e,this._firestore),i=dd(s.converter,t,r),o=id(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,At.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=ms(e,this._firestore);let o;return o=typeof(t=Te(t))=="string"||t instanceof Si?_p(this._dataReader,"WriteBatch.update",i._key,t,r,s):gp(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,At.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ms(e,this._firestore);return this._mutations=this._mutations.concat(new jo(t._key,At.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new X(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ms(n,e){if((n=Te(n)).firestore!==e)throw new X(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ci(t)}get(t){const r=ms(t,this._firestore),s=new _C(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return _e();const o=i[0];if(o.isFoundDocument())return new gl(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new gl(this._firestore,s,r._key,null,r.converter);throw _e()})}set(t,r,s){const i=ms(t,this._firestore),o=dd(i.converter,r,s),a=id(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=ms(t,this._firestore);let a;return a=typeof(r=Te(r))=="string"||r instanceof Si?_p(this._dataReader,"Transaction.update",o._key,r,s,i):gp(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=ms(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ms(e,this._firestore),r=new $s(this._firestore);return super.get(e).then(s=>new Oo(this._firestore,r,t._key,s._document,new ci(!1,!1),t.converter))}}function lF(n,e,t){n=qe(n,ht);const r=Object.assign(Object.assign({},RC),t);return function(i){if(i.maxAttempts<1)throw new X(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new rn;return i.asyncQueue.enqueueAndForget(async()=>{const u=await Pw(i);new GR(i.asyncQueue,u,a,o,l).au()}),l.promise}(kt(n),s=>e(new kC(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(){return new Ul("deleteField")}function Ip(){return new hp("serverTimestamp")}function uF(...n){return new fp("arrayUnion",n)}function dF(...n){return new pp("arrayRemove",n)}function hF(n){return new mp("increment",n)}function fF(n){return new rd(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(n){return kt(n=qe(n,ht)),new CC(n,e=>jl(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(n,e){const t=kt(n=qe(n,ht));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Jn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(u){try{return JSON.parse(u)}catch(d){throw new X(F.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const u=I_(l,"collectionGroup"),d=[];if(Array.isArray(l.fields))for(const f of l.fields){const g=od("setIndexConfiguration",I_(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new pi(g,2)):f.order==="ASCENDING"?d.push(new pi(g,0)):f.order==="DESCENDING"&&d.push(new pi(g,1))}a.push(new Io(Io.UNKNOWN_ID,u,d,Eo.empty()))}return a}(e);return tC(t,r)}function I_(n,e){if(typeof n[e]!="string")throw new X(F.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function mF(n){var e;n=qe(n,ht);const t=E_.get(n);if(t)return t;if(((e=kt(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new DC(n);return E_.set(n,r),r}function gF(n){Jw(n,!0)}function _F(n){Jw(n,!1)}function yF(n){rC(kt(n._firestore)).then(e=>Y("deleting all persistent cache indexes succeeded")).catch(e=>Jn("deleting all persistent cache indexes failed",e))}function Jw(n,e){nC(kt(n._firestore),e).then(t=>Y(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>Jn(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const E_=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(n){var e;const t=(e=kt(qe(n.firestore,ht))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Wu(t,In(n._query))._t}function wF(n,e){var t;const r=Wv(e,(i,o)=>new T0(o,i.aggregateType,i._internalFieldPath)),s=(t=kt(qe(n.firestore,ht))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:L0(s,l0(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Ep.instance.onExistenceFilterMismatch(e)}}class Ep{constructor(){this.Uu=new Map}static get instance(){return Pc||(Pc=new Ep,function(t){if(cu)throw new Error("a TestingHooksSpi instance is already set");cu=t}(Pc)),Pc}et(e){this.Uu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let Pc=null;(function(e,t=!0){(function(s){Uo=s})(Fo),wo(new gi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new ht(new Zx(r.getProvider("auth-internal")),new nP(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new X(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _i(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Ts(hg,"4.7.3",e),Ts(hg,"4.7.3","esm2017")})();function Tp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF={PHONE:"phone",TOTP:"totp"},EF={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},TF={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},AF={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},xF={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function Yw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PF=NC,VC=Yw,Xw=new Pl("auth","Firebase",Yw()),SF={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=new If("@firebase/auth");function OC(n,...e){vu.logLevel<=Ke.WARN&&vu.warn(`Auth (${Fo}): ${n}`,...e)}function zc(n,...e){vu.logLevel<=Ke.ERROR&&vu.error(`Auth (${Fo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(n,...e){throw xp(n,...e)}function Cn(n,...e){return xp(n,...e)}function Ap(n,e,t){const r=Object.assign(Object.assign({},VC()),{[e]:t});return new Pl("auth","Firebase",r).create(e,{appName:n.name})}function sn(n){return Ap(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qo(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ln(n,"argument-error"),Ap(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xp(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Xw.create(n,...e)}function re(n,e,...t){if(!n)throw xp(e,...t)}function _r(n){const e="INTERNAL ASSERTION FAILED: "+n;throw zc(e),new Error(e)}function Hr(n,e){n||_r(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Pp(){return T_()==="http:"||T_()==="https:"}function T_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Pp()||CA()||"connection"in navigator)?navigator.onLine:!0}function LC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,t){this.shortDelay=e,this.longDelay=t,Hr(t>e,"Short delay should be less than long delay!"),this.isMobile=PA()||kA()}get(){return MC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(n,e){Hr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_r("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_r("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_r("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=new ql(3e4,6e4);function wt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function bt(n,e,t,r,s={}){return eb(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Lo(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},i);return RA()||(u.referrerPolicy="no-referrer"),Zw.fetch()(tb(n,n.config.apiHost,t,a),u)})}async function eb(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},FC),e);try{const s=new $C(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Oa(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Oa(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Oa(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Oa(n,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Ap(n,d,u);Ln(n,d)}}catch(s){if(s instanceof Yr)throw s;Ln(n,"network-request-failed",{message:String(s)})}}async function ns(n,e,t,r,s={}){const i=await bt(n,e,t,r,s);return"mfaPendingCredential"in i&&Ln(n,"multi-factor-auth-required",{_serverResponse:i}),i}function tb(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?Sp(n.config,s):`${n.config.apiScheme}://${s}`}function BC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $C{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Cn(this.auth,"network-request-failed")),UC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Oa(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Cn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(n){return n!==void 0&&n.getResponse!==void 0}function x_(n){return n!==void 0&&n.enterprise!==void 0}class nb{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return BC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jC(n){return(await bt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function rb(n,e){return bt(n,"GET","/v2/recaptchaConfig",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qC(n,e){return bt(n,"POST","/v1/accounts:delete",e)}async function zC(n,e){return bt(n,"POST","/v1/accounts:update",e)}async function sb(n,e){return bt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RF(n,e=!1){return Te(n).getIdToken(e)}async function GC(n,e=!1){const t=Te(n),r=await t.getIdToken(e),s=hd(r);re(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ja(nh(s.auth_time)),issuedAtTime:Ja(nh(s.iat)),expirationTime:Ja(nh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function nh(n){return Number(n)*1e3}function hd(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return zc("JWT malformed, contained fewer than 3 sections"),null;try{const s=gv(t);return s?JSON.parse(s):(zc("Failed to decode base64 JWT payload"),null)}catch(s){return zc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function P_(n){const e=hd(n);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Yr&&KC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function KC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ja(this.lastLoginAt),this.creationTime=Ja(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vl(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Wr(n,sb(t,{idToken:r}));re(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?ib(i.providerUserInfo):[],a=QC(n.providerData,o),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Jh(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function WC(n){const e=Te(n);await vl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QC(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function ib(n){return n.map(e=>{var{providerId:t}=e,r=Tp(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JC(n,e){const t=await eb(n,{},async()=>{const r=Lo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=tb(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Zw.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YC(n,e){return bt(n,"POST","/v2/accounts:revokeToken",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):P_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){re(e.length!==0,"internal-error");const t=P_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await JC(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new uo;return r&&(re(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(re(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(re(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uo,this.toJSON())}_performRefresh(){return _r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(n,e){re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Fr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=Tp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new HC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Jh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Wr(this,this.stsTokenManager.getToken(this.auth,e));return re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return GC(this,e)}reload(){return WC(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Fr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await vl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bt(this.auth.app))return Promise.reject(sn(this.auth));const e=await this.getIdToken();return await Wr(this,qC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,u,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(s=t.email)!==null&&s!==void 0?s:void 0,_=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,C=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,L=(u=t.createdAt)!==null&&u!==void 0?u:void 0,B=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:$,emailVerified:j,isAnonymous:O,providerData:se,stsTokenManager:T}=t;re($&&T,e,"internal-error");const w=uo.fromJSON(this.name,T);re(typeof $=="string",e,"internal-error"),cs(f,e.name),cs(g,e.name),re(typeof j=="boolean",e,"internal-error"),re(typeof O=="boolean",e,"internal-error"),cs(_,e.name),cs(C,e.name),cs(x,e.name),cs(R,e.name),cs(L,e.name),cs(B,e.name);const I=new Fr({uid:$,auth:e,email:g,emailVerified:j,displayName:f,isAnonymous:O,photoURL:C,phoneNumber:_,tenantId:x,stsTokenManager:w,createdAt:L,lastLoginAt:B});return se&&Array.isArray(se)&&(I.providerData=se.map(S=>Object.assign({},S))),R&&(I._redirectEventId=R),I}static async _fromIdTokenResponse(e,t,r=!1){const s=new uo;s.updateFromServerResponse(t);const i=new Fr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await vl(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];re(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?ib(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new uo;a.updateFromIdToken(r);const l=new Fr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Jh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_=new Map;function Ur(n){Hr(n instanceof Function,"Expected a class definition");let e=S_.get(n);return e?(Hr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,S_.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ob.type="NONE";const R_=ob;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(n,e,t){return`firebase:${n}:${e}:${t}`}class ho{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Gc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Gc("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Fr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ho(Ur(R_),e,r);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Ur(R_);const o=Gc(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){const f=Fr._fromJSON(e,d);u!==i&&(a=f),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new ho(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new ho(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ub(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ab(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hb(e))return"Blackberry";if(fb(e))return"Webos";if(lb(e))return"Safari";if((e.includes("chrome/")||cb(e))&&!e.includes("edge/"))return"Chrome";if(db(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ab(n=Xt()){return/firefox\//i.test(n)}function lb(n=Xt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cb(n=Xt()){return/crios\//i.test(n)}function ub(n=Xt()){return/iemobile/i.test(n)}function db(n=Xt()){return/android/i.test(n)}function hb(n=Xt()){return/blackberry/i.test(n)}function fb(n=Xt()){return/webos/i.test(n)}function Rp(n=Xt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function XC(n=Xt()){var e;return Rp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ZC(){return DA()&&document.documentMode===10}function pb(n=Xt()){return Rp(n)||db(n)||fb(n)||hb(n)||/windows phone/i.test(n)||ub(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mb(n,e=[]){let t;switch(n){case"Browser":t=C_(Xt());break;case"Worker":t=`${C_(Xt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Fo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t1(n,e={}){return bt(n,"GET","/v2/passwordPolicy",wt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1=6;class r1{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:n1,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new k_(this),this.idTokenSubscription=new k_(this),this.beforeStateQueue=new e1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ur(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ho.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await sb(this,{idToken:e}),r=await Fr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Bt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await vl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bt(this.app))return Promise.reject(sn(this));const t=e?Te(e):null;return t&&re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bt(this.app)?Promise.reject(sn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bt(this.app)?Promise.reject(sn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ur(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await t1(this),t=new r1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await YC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ur(e)||this._popupRedirectResolver;re(t,this,"argument-error"),this.redirectPersistenceManager=await ho.create(this,[Ur(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&OC(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Ot(n){return Te(n)}class k_{constructor(e){this.auth=e,this.observer=null,this.addObserver=FA(t=>this.observer=t)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function i1(n){zl=n}function Cp(n){return zl.loadJS(n)}function o1(){return zl.recaptchaV2Script}function a1(){return zl.recaptchaEnterpriseScript}function l1(){return zl.gapiScript}function gb(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const c1="recaptcha-enterprise",u1="NO_RECAPTCHA";class _b{constructor(e){this.type=c1,this.auth=Ot(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{rb(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new nb(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;x_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(u1)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&x_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=a1();l.length!==0&&(l+=a),Cp(l).then(()=>{s(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function D_(n,e,t,r=!1){const s=new _b(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function wl(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await D_(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await D_(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}async function d1(n){const e=Ot(n),t=await rb(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new nb(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new _b(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(n,e){const t=Sl(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Ps(i,e??{}))return s;Ln(s,"already-initialized")}return t.initialize({options:e})}function f1(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ur);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function p1(n,e,t){const r=Ot(n);re(r._canInitEmulator,r,"emulator-config-failed"),re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=yb(e),{host:o,port:a}=m1(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||g1()}function yb(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function m1(n){const e=yb(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:N_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:N_(o)}}}function N_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function g1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _r("not implemented")}_getIdTokenResponse(e){return _r("not implemented")}_linkToIdToken(e,t){return _r("not implemented")}_getReauthenticationResolver(e){return _r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(n,e){return bt(n,"POST","/v1/accounts:resetPassword",wt(n,e))}async function _1(n,e){return bt(n,"POST","/v1/accounts:update",e)}async function y1(n,e){return bt(n,"POST","/v1/accounts:signUp",e)}async function v1(n,e){return bt(n,"POST","/v1/accounts:update",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w1(n,e){return ns(n,"POST","/v1/accounts:signInWithPassword",wt(n,e))}async function fd(n,e){return bt(n,"POST","/v1/accounts:sendOobCode",wt(n,e))}async function b1(n,e){return fd(n,e)}async function I1(n,e){return fd(n,e)}async function E1(n,e){return fd(n,e)}async function T1(n,e){return fd(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A1(n,e){return ns(n,"POST","/v1/accounts:signInWithEmailLink",wt(n,e))}async function x1(n,e){return ns(n,"POST","/v1/accounts:signInWithEmailLink",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl extends Gl{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new bl(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new bl(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wl(e,t,"signInWithPassword",w1);case"emailLink":return A1(e,{email:this._email,oobCode:this._password});default:Ln(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wl(e,r,"signUpPassword",y1);case"emailLink":return x1(e,{idToken:t,email:this._email,oobCode:this._password});default:Ln(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $r(n,e){return ns(n,"POST","/v1/accounts:signInWithIdp",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1="http://localhost";class Qr extends Gl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ln("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=Tp(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Qr(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return $r(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,$r(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$r(e,t)}buildRequest(){const e={requestUri:P1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lo(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S1(n,e){return bt(n,"POST","/v1/accounts:sendVerificationCode",wt(n,e))}async function R1(n,e){return ns(n,"POST","/v1/accounts:signInWithPhoneNumber",wt(n,e))}async function C1(n,e){const t=await ns(n,"POST","/v1/accounts:signInWithPhoneNumber",wt(n,e));if(t.temporaryProof)throw Oa(n,"account-exists-with-different-credential",t);return t}const k1={USER_NOT_FOUND:"user-not-found"};async function D1(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return ns(n,"POST","/v1/accounts:signInWithPhoneNumber",wt(n,t),k1)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends Gl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new mi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new mi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return R1(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return C1(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return D1(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new mi({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function V1(n){const e=Ra(Ca(n)).link,t=e?Ra(Ca(e)).deep_link_id:null,r=Ra(Ca(n)).deep_link_id;return(r?Ra(Ca(r)).link:null)||r||t||e||n}class Kl{constructor(e){var t,r,s,i,o,a;const l=Ra(Ca(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=N1((s=l.mode)!==null&&s!==void 0?s:null);re(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=V1(e);try{return new Kl(t)}catch{return null}}}function CF(n){return Kl.parseLink(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.providerId=Ni.PROVIDER_ID}static credential(e,t){return bl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Kl.parseLink(t);return re(r,"argument-error"),bl._fromEmailAndCode(e,r.code,r.tenantId)}}Ni.PROVIDER_ID="password";Ni.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ni.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends rs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Kc extends Jo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return re("providerId"in t&&"signInMethod"in t,"argument-error"),Qr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return re(e.idToken||e.accessToken,"argument-error"),Qr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Kc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Kc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new Kc(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs extends Jo{constructor(){super("facebook.com")}static credential(e){return Qr._fromParams({providerId:gs.PROVIDER_ID,signInMethod:gs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gs.credentialFromTaggedObject(e)}static credentialFromError(e){return gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gs.credential(e.oauthAccessToken)}catch{return null}}}gs.FACEBOOK_SIGN_IN_METHOD="facebook.com";gs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends Jo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qr._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return _s.credentialFromTaggedObject(e)}static credentialFromError(e){return _s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return _s.credential(t,r)}catch{return null}}}_s.GOOGLE_SIGN_IN_METHOD="google.com";_s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends Jo{constructor(){super("github.com")}static credential(e){return Qr._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ys.credential(e.oauthAccessToken)}catch{return null}}}ys.GITHUB_SIGN_IN_METHOD="github.com";ys.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="http://localhost";class Il extends Gl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return $r(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,$r(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$r(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new Il(r,i)}static _create(e,t){return new Il(e,t)}buildRequest(){return{requestUri:O1,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="saml.";class Yh extends rs{constructor(e){re(e.startsWith(M1),"argument-error"),super(e)}static credentialFromResult(e){return Yh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Yh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Il.fromJSON(e);return re(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Il._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Jo{constructor(){super("twitter.com")}static credential(e,t){return Qr._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return vs.credential(t,r)}catch{return null}}}vs.TWITTER_SIGN_IN_METHOD="twitter.com";vs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wb(n,e){return ns(n,"POST","/v1/accounts:signUp",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Fr._fromIdTokenResponse(e,r,s),o=V_(r);return new Yn({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=V_(r);return new Yn({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function V_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L1(n){var e;if(Bt(n.app))return Promise.reject(sn(n));const t=Ot(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Yn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await wb(t,{returnSecureToken:!0}),s=await Yn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends Yr{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,wu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new wu(e,t,r,s)}}function bb(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?wu._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ib(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kF(n,e){const t=Te(n);await pd(!0,t,e);const{providerUserInfo:r}=await zC(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=Ib(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function kp(n,e,t=!1){const r=await Wr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Yn._forOperation(n,"link",r)}async function pd(n,e,t){await vl(e);const r=Ib(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";re(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(n,e,t=!1){const{auth:r}=n;if(Bt(r.app))return Promise.reject(sn(r));const s="reauthenticate";try{const i=await Wr(n,bb(r,s,e,n),t);re(i.idToken,r,"internal-error");const o=hd(i.idToken);re(o,r,"internal-error");const{sub:a}=o;return re(n.uid===a,r,"user-mismatch"),Yn._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ln(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(n,e,t=!1){if(Bt(n.app))return Promise.reject(sn(n));const r="signIn",s=await bb(n,r,e),i=await Yn._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function Dp(n,e){return Tb(Ot(n),e)}async function F1(n,e){const t=Te(n);return await pd(!1,t,e.providerId),kp(t,e)}async function U1(n,e){return Eb(Te(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B1(n,e){return ns(n,"POST","/v1/accounts:signInWithCustomToken",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DF(n,e){if(Bt(n.app))return Promise.reject(sn(n));const t=Ot(n),r=await B1(t,{token:e,returnSecureToken:!0}),s=await Yn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Np._fromServerResponse(e,t):"totpInfo"in t?Vp._fromServerResponse(e,t):Ln(e,"internal-error")}}class Np extends Hl{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Np(t)}}class Vp extends Hl{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Vp(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(n,e,t){var r;re(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),re(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(re(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(re(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Op(n){const e=Ot(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function $1(n,e,t){const r=Ot(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&md(r,s,t),await wl(r,s,"getOobCode",I1)}async function j1(n,e,t){await vb(Te(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Op(n),r})}async function NF(n,e){await v1(Te(n),{oobCode:e})}async function q1(n,e){const t=Te(n),r=await vb(t,{oobCode:e}),s=r.requestType;switch(re(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":re(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":re(r.mfaInfo,t,"internal-error");default:re(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=Hl._fromServerResponse(Ot(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function VF(n,e){const{data:t}=await q1(Te(n),e);return t.email}async function z1(n,e,t){if(Bt(n.app))return Promise.reject(sn(n));const r=Ot(n),o=await wl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wb).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Op(n),l}),a=await Yn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function G1(n,e,t){return Bt(n.app)?Promise.reject(sn(n)):Dp(Te(n),Ni.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Op(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OF(n,e,t){const r=Ot(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){re(a.handleCodeInApp,r,"argument-error"),a&&md(r,o,a)}i(s,t),await wl(r,s,"getOobCode",E1)}function MF(n,e){const t=Kl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function LF(n,e,t){if(Bt(n.app))return Promise.reject(sn(n));const r=Te(n),s=Ni.credentialWithLink(e,t||yl());return re(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Dp(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K1(n,e){return bt(n,"POST","/v1/accounts:createAuthUri",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FF(n,e){const t=Pp()?yl():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await K1(Te(n),r);return s||[]}async function UF(n,e){const t=Te(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&md(t.auth,s,e);const{email:i}=await b1(t.auth,s);i!==n.email&&await n.reload()}async function BF(n,e,t){const r=Te(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&md(r.auth,i,t);const{email:o}=await T1(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H1(n,e){return bt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $F(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Te(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Wr(r,H1(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function jF(n,e){const t=Te(n);return Bt(t.auth.app)?Promise.reject(sn(t.auth)):Ab(t,e,null)}function W1(n,e){return Ab(Te(n),null,e)}async function Ab(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await Wr(n,_1(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(n){var e,t;if(!n)return null;const{providerId:r}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=hd(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new fo(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new J1(i,s);case"github.com":return new Y1(i,s);case"google.com":return new X1(i,s);case"twitter.com":return new Z1(i,s,n.screenName||null);case"custom":case"anonymous":return new fo(i,null);default:return new fo(i,r,s)}}class fo{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class xb extends fo{constructor(e,t,r,s){super(e,t,r),this.username=s}}class J1 extends fo{constructor(e,t){super(e,"facebook.com",t)}}class Y1 extends xb{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class X1 extends fo{constructor(e,t){super(e,"google.com",t)}}class Z1 extends xb{constructor(e,t,r){super(e,"twitter.com",t,r)}}function qF(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:Q1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zF(n,e){return Te(n).setPersistence(e)}function GF(n){return d1(n)}async function KF(n,e){return Ot(n).validatePassword(e)}function ek(n,e,t,r){return Te(n).onIdTokenChanged(e,t,r)}function tk(n,e,t){return Te(n).beforeAuthStateChanged(e,t)}function HF(n,e,t,r){return Te(n).onAuthStateChanged(e,t,r)}function WF(n){Te(n).useDeviceLanguage()}function QF(n,e){return Te(n).updateCurrentUser(e)}function JF(n){return Te(n).signOut()}function YF(n,e){return Ot(n).revokeAccessToken(e)}async function XF(n){return Te(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new ui("enroll",e,t)}static _fromMfaPendingCredential(e){return new ui("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return ui._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return ui._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Ot(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>Hl._fromServerResponse(r,a));re(s.mfaPendingCredential,r,"internal-error");const o=ui._fromMfaPendingCredential(s.mfaPendingCredential);return new Mp(o,i,async a=>{const l=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const u=Object.assign(Object.assign({},s),{idToken:l.idToken,refreshToken:l.refreshToken});switch(t.operationType){case"signIn":const d=await Yn._fromIdTokenResponse(r,t.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return re(t.user,r,"internal-error"),Yn._forOperation(t.user,t.operationType,u);default:Ln(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function ZF(n,e){var t;const r=Te(n),s=e;return re(e.customData.operationType,r,"argument-error"),re((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Mp._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(n,e){return bt(n,"POST","/v2/accounts/mfaEnrollment:start",wt(n,e))}function rk(n,e){return bt(n,"POST","/v2/accounts/mfaEnrollment:finalize",wt(n,e))}function sk(n,e){return bt(n,"POST","/v2/accounts/mfaEnrollment:start",wt(n,e))}function ik(n,e){return bt(n,"POST","/v2/accounts/mfaEnrollment:finalize",wt(n,e))}function ok(n,e){return bt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",wt(n,e))}class Lp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Hl._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Lp(e)}async getSession(){return ui._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await Wr(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Wr(this.user,ok(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const rh=new WeakMap;function e4(n){const e=Te(n);return rh.has(e)||rh.set(e,Lp._fromUser(e)),rh.get(e)}const bu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bu,"1"),this.storage.removeItem(bu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=1e3,lk=10;class Sb extends Pb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);ZC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,lk):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},ak)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sb.type="LOCAL";const ck=Sb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb extends Pb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Rb.type="SESSION";const Cb=Rb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new gd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(t.origin,i)),l=await uk(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=_d("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return window}function hk(n){Wt().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(){return typeof Wt().WorkerGlobalScope<"u"&&typeof Wt().importScripts=="function"}async function fk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function pk(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function mk(){return Fp()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="firebaseLocalStorageDb",gk=1,Iu="firebaseLocalStorage",Db="fbase_key";class Wl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function yd(n,e){return n.transaction([Iu],e?"readwrite":"readonly").objectStore(Iu)}function _k(){const n=indexedDB.deleteDatabase(kb);return new Wl(n).toPromise()}function Xh(){const n=indexedDB.open(kb,gk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Iu,{keyPath:Db})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Iu)?e(r):(r.close(),await _k(),e(await Xh()))})})}async function O_(n,e,t){const r=yd(n,!0).put({[Db]:e,value:t});return new Wl(r).toPromise()}async function yk(n,e){const t=yd(n,!1).get(e),r=await new Wl(t).toPromise();return r===void 0?null:r.value}function M_(n,e){const t=yd(n,!0).delete(e);return new Wl(t).toPromise()}const vk=800,wk=3;class Nb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xh(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>wk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Fp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gd._getInstance(mk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await fk(),!this.activeServiceWorker)return;this.sender=new dk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||pk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xh();return await O_(e,bu,"1"),await M_(e,bu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>O_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>yk(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>M_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=yd(s,!1).getAll();return new Wl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nb.type="LOCAL";const bk=Nb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(n,e){return bt(n,"POST","/v2/accounts/mfaSignIn:start",wt(n,e))}function Ek(n,e){return bt(n,"POST","/v2/accounts/mfaSignIn:finalize",wt(n,e))}function Tk(n,e){return bt(n,"POST","/v2/accounts/mfaSignIn:finalize",wt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=500,xk=6e4,Sc=1e12;class Pk{constructor(e){this.auth=e,this.counter=Sc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new Sk(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Sc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Sc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Sc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class Sk{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;re(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Rk(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},xk)},Ak))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Rk(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=gb("rcb"),Ck=new ql(3e4,6e4);class kk{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Wt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return re(Dk(t),e,"argument-error"),this.shouldResolveImmediately(t)&&A_(Wt().grecaptcha)?Promise.resolve(Wt().grecaptcha):new Promise((r,s)=>{const i=Wt().setTimeout(()=>{s(Cn(e,"network-request-failed"))},Ck.get());Wt()[sh]=()=>{Wt().clearTimeout(i),delete Wt()[sh];const a=Wt().grecaptcha;if(!a||!A_(a)){s(Cn(e,"internal-error"));return}const l=a.render;a.render=(u,d)=>{const f=l(u,d);return this.counter++,f},this.hostLanguage=t,r(a)};const o=`${o1()}?${Lo({onload:sh,render:"explicit",hl:t})}`;Cp(o).catch(()=>{clearTimeout(i),s(Cn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Wt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Dk(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class Nk{async load(e){return new Pk(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb="recaptcha",Vk={theme:"light",type:"image"};class t4{constructor(e,t,r=Object.assign({},Vk)){this.parameters=r,this.type=Vb,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ot(e),this.isInvisible=this.parameters.size==="invisible",re(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;re(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Nk:new kk,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){re(!this.parameters.sitekey,this.auth,"argument-error"),re(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),re(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Wt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){re(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){re(Pp()&&!Fp(),this.auth,"internal-error"),await Ok(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await jC(this.auth);re(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return re(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Ok(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=mi._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function n4(n,e,t){if(Bt(n.app))return Promise.reject(sn(n));const r=Ot(n),s=await vd(r,e,Te(t));return new Up(s,i=>Dp(r,i))}async function r4(n,e,t){const r=Te(n);await pd(!1,r,"phone");const s=await vd(r.auth,e,Te(t));return new Up(s,i=>F1(r,i))}async function s4(n,e,t){const r=Te(n);if(Bt(r.auth.app))return Promise.reject(sn(r.auth));const s=await vd(r.auth,e,Te(t));return new Up(s,i=>U1(r,i))}async function vd(n,e,t){var r;const s=await t.verify();try{re(typeof s=="string",n,"argument-error"),re(t.type===Vb,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return re(o.type==="enroll",n,"internal-error"),(await nk(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{re(o.type==="signin",n,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return re(a,n,"missing-multi-factor-info"),(await Ik(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await S1(n,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{t._reset()}}async function i4(n,e){const t=Te(n);if(Bt(t.auth.app))return Promise.reject(sn(t.auth));await kp(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.providerId=po.PROVIDER_ID,this.auth=Ot(e)}verifyPhoneNumber(e,t){return vd(this.auth,e,Te(t))}static credential(e,t){return mi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return po.credentialFromTaggedObject(t)}static credentialFromError(e){return po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?mi._fromTokenResponse(t,r):null}}po.PROVIDER_ID="phone";po.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(n,e){return e?Ur(e):(re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp extends Gl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $r(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $r(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $r(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Mk(n){return Tb(n.auth,new Bp(n),n.bypassAuthState)}function Lk(n){const{auth:e,user:t}=n;return re(t,e,"internal-error"),Eb(t,new Bp(n),n.bypassAuthState)}async function Fk(n){const{auth:e,user:t}=n;return re(t,e,"internal-error"),kp(t,new Bp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mk;case"linkViaPopup":case"linkViaRedirect":return Fk;case"reauthViaPopup":case"reauthViaRedirect":return Lk;default:Ln(this.auth,"internal-error")}}resolve(e){Hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk=new ql(2e3,1e4);async function o4(n,e,t){if(Bt(n.app))return Promise.reject(Cn(n,"operation-not-supported-in-this-environment"));const r=Ot(n);Qo(n,e,rs);const s=Vi(r,t);return new Br(r,"signInViaPopup",e,s).executeNotNull()}async function a4(n,e,t){const r=Te(n);if(Bt(r.auth.app))return Promise.reject(Cn(r.auth,"operation-not-supported-in-this-environment"));Qo(r.auth,e,rs);const s=Vi(r.auth,t);return new Br(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function l4(n,e,t){const r=Te(n);Qo(r.auth,e,rs);const s=Vi(r.auth,t);return new Br(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Br extends Ob{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Br.currentPopupAction&&Br.currentPopupAction.cancel(),Br.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){Hr(this.filter.length===1,"Popup operations only handle one event");const e=_d();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Cn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Cn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Br.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Uk.get())};e()}}Br.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk="pendingRedirect",Hc=new Map;class $k extends Ob{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Hc.get(this.auth._key());if(!e){try{const r=await jk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Hc.set(this.auth._key(),e)}return this.bypassAuthState||Hc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jk(n,e){const t=Lb(e),r=Mb(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function $p(n,e){return Mb(n)._set(Lb(e),"true")}function qk(n,e){Hc.set(n._key(),e)}function Mb(n){return Ur(n._redirectPersistence)}function Lb(n){return Gc(Bk,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(n,e,t){return zk(n,e,t)}async function zk(n,e,t){if(Bt(n.app))return Promise.reject(sn(n));const r=Ot(n);Qo(n,e,rs),await r._initializationPromise;const s=Vi(r,t);return await $p(s,r),s._openRedirect(r,e,"signInViaRedirect")}function u4(n,e,t){return Gk(n,e,t)}async function Gk(n,e,t){const r=Te(n);if(Qo(r.auth,e,rs),Bt(r.auth.app))return Promise.reject(sn(r.auth));await r.auth._initializationPromise;const s=Vi(r.auth,t);await $p(s,r.auth);const i=await Ub(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function d4(n,e,t){return Kk(n,e,t)}async function Kk(n,e,t){const r=Te(n);Qo(r.auth,e,rs),await r.auth._initializationPromise;const s=Vi(r.auth,t);await pd(!1,r,e.providerId),await $p(s,r.auth);const i=await Ub(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function h4(n,e){return await Ot(n)._initializationPromise,Fb(n,e,!1)}async function Fb(n,e,t=!1){if(Bt(n.app))return Promise.reject(sn(n));const r=Ot(n),s=Vi(r,e),o=await new $k(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function Ub(n){const e=_d(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk=10*60*1e3;class Wk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Qk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Bb(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Cn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Hk&&this.cachedEventUids.clear(),this.cachedEventUids.has(L_(e))}saveEventToCache(e){this.cachedEventUids.add(L_(e)),this.lastProcessedEventTime=Date.now()}}function L_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Bb({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Qk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bb(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jk(n,e={}){return bt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xk=/^https?/;async function Zk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Jk(n);for(const t of e)try{if(eD(t))return}catch{}Ln(n,"unauthorized-domain")}function eD(n){const e=yl(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Xk.test(t))return!1;if(Yk.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=new ql(3e4,6e4);function F_(){const n=Wt().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nD(n){return new Promise((e,t)=>{var r,s,i;function o(){F_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{F_(),t(Cn(n,"network-request-failed"))},timeout:tD.get()})}if(!((s=(r=Wt().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Wt().gapi)===null||i===void 0)&&i.load)o();else{const a=gb("iframefcb");return Wt()[a]=()=>{gapi.load?o():t(Cn(n,"network-request-failed"))},Cp(`${l1()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Wc=null,e})}let Wc=null;function rD(n){return Wc=Wc||nD(n),Wc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new ql(5e3,15e3),iD="__/auth/iframe",oD="emulator/auth/iframe",aD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cD(n){const e=n.config;re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Sp(e,oD):`https://${n.config.authDomain}/${iD}`,r={apiKey:e.apiKey,appName:n.name,v:Fo},s=lD.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Lo(r).slice(1)}`}async function uD(n){const e=await rD(n),t=Wt().gapi;return re(t,n,"internal-error"),e.open({where:document.body,url:cD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aD,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Cn(n,"network-request-failed"),a=Wt().setTimeout(()=>{i(o)},sD.get());function l(){Wt().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hD=500,fD=600,pD="_blank",mD="http://localhost";class U_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gD(n,e,t,r=hD,s=fD){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},dD),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Xt().toLowerCase();t&&(a=cb(u)?pD:t),ab(u)&&(e=e||mD,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[_,C])=>`${g}${_}=${C},`,"");if(XC(u)&&a!=="_self")return _D(e||"",a),new U_(null);const f=window.open(e||"",a,d);re(f,n,"popup-blocked");try{f.focus()}catch{}return new U_(f)}function _D(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="__/auth/handler",vD="emulator/auth/handler",wD=encodeURIComponent("fac");async function B_(n,e,t,r,s,i){re(n.config.authDomain,n,"auth-domain-config-required"),re(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Fo,eventId:s};if(e instanceof rs){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",LA(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof Jo){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),u=l?`#${wD}=${encodeURIComponent(l)}`:"";return`${bD(n)}?${Lo(a).slice(1)}${u}`}function bD({config:n}){return n.emulator?Sp(n,vD):`https://${n.authDomain}/${yD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih="webStorageSupport";class ID{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Cb,this._completeRedirectFn=Fb,this._overrideRedirectResult=qk}async _openPopup(e,t,r,s){var i;Hr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await B_(e,t,r,yl(),s);return gD(e,o,_d())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await B_(e,t,r,yl(),s);return hk(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Hr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await uD(e),r=new Wk(e);return t.register("authEvent",s=>(re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ih,{type:ih},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ih];o!==void 0&&t(!!o),Ln(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Zk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pb()||lb()||Rp()}}const ED=ID;class $b{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return _r("unexpected MultiFactorSessionType")}}}class jp extends $b{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new jp(e)}_finalizeEnroll(e,t,r){return rk(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return Ek(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class TD{constructor(){}static assertion(e){return jp._fromCredential(e)}}TD.FACTOR_ID="phone";class AD{static assertionForEnrollment(e,t){return El._fromSecret(e,t)}static assertionForSignIn(e,t){return El._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const r=e;re(typeof((t=r.user)===null||t===void 0?void 0:t.auth)<"u","internal-error");const s=await sk(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return qp._fromStartTotpMfaEnrollmentResponse(s,r.user.auth)}}AD.FACTOR_ID="totp";class El extends $b{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new El(t,void 0,e)}static _fromEnrollmentId(e,t){return new El(t,e)}async _finalizeEnroll(e,t,r){return re(typeof this.secret<"u",e,"argument-error"),ik(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){re(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return Tk(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class qp{constructor(e,t,r,s,i,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new qp(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let s=!1;return(Rc(e)||Rc(t))&&(s=!0),s&&(Rc(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),Rc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Rc(n){return typeof n>"u"||(n==null?void 0:n.length)===0}var $_="@firebase/auth",j_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function SD(n){wo(new gi("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;re(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mb(n)},u=new s1(r,s,i,l);return f1(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),wo(new gi("auth-internal",e=>{const t=Ot(e.getProvider("auth").getImmediate());return(r=>new xD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ts($_,j_,PD(n)),Ts($_,j_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=5*60,CD=vv("authIdTokenMaxAge")||RD;let q_=null;const kD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>CD)return;const s=t==null?void 0:t.token;q_!==s&&(q_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function DD(n=Av()){const e=Sl(n,"auth");if(e.isInitialized())return e.getImmediate();const t=h1(n,{popupRedirectResolver:ED,persistence:[bk,ck,Cb]}),r=vv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=kD(i.toString());tk(t,o,()=>o(t.currentUser)),ek(t,a=>o(a))}}const s=_v("auth");return s&&p1(t,`http://${s}`),t}function ND(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}i1({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Cn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",ND().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});SD("Browser");const VD={apiKey:"AIzaSyDCqJRmxKiIzuAhgXsmXICCx_O65aujNa0",authDomain:"impro-selector.firebaseapp.com",projectId:"impro-selector",storageBucket:"impro-selector.appspot.com",messagingSenderId:"730278491306",appId:"1:730278491306:web:c966af1179221e91118cd3",measurementId:"G-3NB062D088"},jb=Tv(VD),ve=aC(jb),Oi=DD(jb);try{lC(ve)}catch{}L1(Oi);async function OD(n,e){try{return(await z1(Oi,n,e)).user}catch(t){throw t}}async function MD(n,e){try{return(await G1(Oi,n,e)).user}catch(t){throw t}}async function LD(n){try{await $1(Oi,n)}catch(e){throw e}}async function FD(n){try{const e=Oi.currentUser;if(e)await W1(e,n);else throw new Error("Aucun utilisateur connect")}catch(e){throw e}}const mo=Object.freeze(Object.defineProperty({__proto__:null,auth:Oi,createPlayerAccount:OD,db:ve,resetPlayerPassword:LD,signInPlayer:MD,updatePlayerPassword:FD},Symbol.toStringTag,{value:"Module"})),Yo="seasons";async function UD(n,e,t){return await Ww(tt(ve,Yo),{name:n,slug:e,pinCode:t,createdAt:Ip()})}async function BD(n){return await _l(Me(ve,Yo,n))}async function oh(){const n=qw(tt(ve,Yo),gC("createdAt","desc"));return(await xt(n)).docs.map(t=>({id:t.id,...t.data()}))}async function Eu(n,e){const t=await Di(Me(ve,Yo,n));return t.exists()?t.data().pinCode===e:!1}async function Zh(n){const e=await Di(Me(ve,Yo,n));return e.exists()?e.data().pinCode:null}async function Aa(n,e){const t=Me(ve,Yo,n);await wC(t,{sortOrder:e})}const ah=10*60*1e3,lh="impro_selector_pin_session";class $D{constructor(){this.sessionData=this.loadSession()}loadSession(){try{const e=localStorage.getItem(lh);if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<ah)return t;this.clearSession()}}catch(e){console.error("Erreur lors du chargement de la session PIN:",e)}return null}saveSession(e,t){try{const r={seasonId:e,pinCode:t,timestamp:Date.now()};localStorage.setItem(lh,JSON.stringify(r)),this.sessionData=r}catch(r){console.error("Erreur lors de la sauvegarde de la session PIN:",r)}}isPinCached(e){return this.sessionData?this.sessionData.seasonId===e&&this.sessionData.timestamp&&Date.now()-this.sessionData.timestamp<ah:!1}getCachedPin(e){return this.isPinCached(e)?this.sessionData.pinCode:null}clearSession(){try{localStorage.removeItem(lh),this.sessionData=null}catch(e){console.error("Erreur lors de la suppression de la session PIN:",e)}}getTimeRemaining(){if(!this.sessionData||!this.sessionData.timestamp)return 0;const e=Date.now()-this.sessionData.timestamp,t=ah-e;return Math.max(0,Math.ceil(t/(60*1e3)))}isExpiringSoon(){return this.getTimeRemaining()<=2}}const Nn=new $D,jD={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},qD={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},zD={class:"text-center mb-6"},GD={class:"text-gray-300"},KD={key:0,class:"mt-2 p-2 bg-green-900/20 border border-green-500/30 rounded-lg"},HD={class:"text-sm text-green-400"},WD={class:"mb-4 flex justify-center"},QD={class:"flex bg-gray-800 rounded-lg p-1"},JD={key:0,class:"mb-6"},YD={class:"mb-4"},XD={key:1,class:"mb-6"},ZD={class:"flex justify-center space-x-3 mb-4"},eN={class:"grid grid-cols-3 gap-3 mb-4"},tN=["onClick"],nN={key:2,class:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-center"},rN={class:"flex justify-end space-x-3"},sN=["disabled"],qb={__name:"PinModal",props:{show:{type:Boolean,default:!1},message:{type:String,default:"Veuillez saisir le code PIN  4 chiffres"},error:{type:String,default:""},sessionInfo:{type:Object,default:null}},emits:["submit","cancel"],setup(n,{emit:e}){const t=n,r=e,s=q(""),i=q(""),o=q("direct"),a=q(null);or(()=>t.show,x=>{x&&(s.value="",i.value="",o.value==="direct"&&pr(()=>{var R;(R=a.value)==null||R.focus()}))}),or(o,x=>{x==="direct"&&t.show&&pr(()=>{var R;(R=a.value)==null||R.focus()})});function l(){s.value=s.value.replace(/[^0-9]/g,""),s.value.length>4&&(s.value=s.value.slice(0,4))}function u(x){s.value.length<4&&(s.value+=x.toString())}function d(){s.value=s.value.slice(0,-1)}function f(){s.value="",i.value=""}function g(){s.value.length===4&&r("submit",s.value)}function _(){r("cancel")}const C=x=>{t.show&&(x.key>="0"&&x.key<="9"?o.value==="keypad"&&u(parseInt(x.key)):x.key==="Backspace"?o.value==="keypad"&&d():x.key==="Enter"?g():x.key==="Escape"&&_())};return typeof window<"u"&&window.addEventListener("keydown",C),(x,R)=>n.show?(H(),W("div",jD,[m("div",qD,[m("div",zD,[R[4]||(R[4]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"")],-1)),R[5]||(R[5]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Code d'accs requis",-1)),m("p",GD,we(n.message),1),n.sessionInfo?(H(),W("div",KD,[m("p",HD," Session active : "+we(n.sessionInfo.timeRemaining)+" min restantes ",1)])):xe("",!0)]),m("div",WD,[m("div",QD,[m("button",{onClick:R[0]||(R[0]=L=>o.value="direct"),class:rr(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",o.value==="direct"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"])}," Saisie directe ",2),m("button",{onClick:R[1]||(R[1]=L=>o.value="keypad"),class:rr(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",o.value==="keypad"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"])}," Pav numrique ",2)])]),o.value==="direct"?(H(),W("div",JD,[m("div",YD,[R[6]||(R[6]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN",-1)),gt(m("input",{"onUpdate:modelValue":R[2]||(R[2]=L=>s.value=L),type:"password",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-center text-2xl font-mono tracking-widest",placeholder:"",onInput:l,onKeydown:[Pn(g,["enter"]),Pn(_,["escape"])],ref_key:"pinInput",ref:a},null,544),[[Rt,s.value]])]),R[7]||(R[7]=m("p",{class:"text-xs text-gray-400 text-center"},"Tapez directement votre code PIN  4 chiffres",-1))])):(H(),W("div",XD,[m("div",ZD,[(H(),W(Nt,null,Mr(4,(L,B)=>m("div",{key:B,class:rr(["w-12 h-12 border-2 border-gray-600 rounded-lg flex items-center justify-center text-2xl font-bold text-white bg-gray-800",{"border-purple-500 bg-purple-900/20":s.value.length>B}])},we(s.value[B]||""),3)),64))]),m("div",eN,[(H(),W(Nt,null,Mr([1,2,3,4,5,6,7,8,9],L=>m("button",{key:L,onClick:B=>u(L),class:"w-12 h-12 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold text-xl transition-all duration-200 hover:scale-105"},we(L),9,tN)),64)),m("button",{onClick:f,class:"w-12 h-12 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold text-lg transition-all duration-200 hover:scale-105"}," C "),m("button",{onClick:R[3]||(R[3]=L=>u(0)),class:"w-12 h-12 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold text-xl transition-all duration-200 hover:scale-105"}," 0 "),m("button",{onClick:d,class:"w-12 h-12 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-bold text-lg transition-all duration-200 hover:scale-105"},"  ")])])),i.value||t.error?(H(),W("div",nN,we(i.value||t.error),1)):xe("",!0),m("div",rN,[m("button",{onClick:_,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:g,disabled:s.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Valider ",8,sN)])])])):xe("",!0)}},iN={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},oN={class:"container mx-auto px-4 pb-16"},aN={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto"},lN=["onClick"],cN={class:"text-2xl font-bold text-white mb-4 group-hover:text-purple-300 transition-colors"},uN={class:"absolute top-4 right-4"},dN=["onClick","aria-expanded"],hN={key:0,class:"absolute right-0 mt-2 w-44 bg-gray-900 border border-white/10 rounded-lg shadow-xl py-1 z-10",role:"menu"},fN=["onClick"],pN=["onClick"],mN=["onClick"],gN={key:0,class:"flex justify-center mt-12"},_N={key:1,class:"text-center py-16"},yN={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},vN={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},wN={class:"mb-6"},bN={class:"mb-6"},IN={class:"mb-6"},EN={class:"flex justify-end space-x-3"},TN=["disabled"],AN={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},xN={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},PN={class:"text-center mb-6"},SN={class:"text-gray-300"},RN={__name:"Home",setup(n){const e=q([]),t=Bu(),r=q(null),s=q(!1),i=q(!1),o=q(""),a=q(""),l=q(""),u=q(null),d=q(!1),f=q(null),g=q("");go(async()=>{e.value=await oh(),console.log("Saisons charges:",e.value),await L()});const _=Lt(()=>[...e.value].sort((ce,K)=>{var Ye,hn;const Se=typeof ce.sortOrder=="number"?ce.sortOrder:Number.MAX_SAFE_INTEGER,De=typeof K.sortOrder=="number"?K.sortOrder:Number.MAX_SAFE_INTEGER;if(Se!==De)return Se-De;const Qe=(Ye=ce.createdAt)!=null&&Ye.toMillis?ce.createdAt.toMillis():0,Ve=(hn=K.createdAt)!=null&&hn.toMillis?K.createdAt.toMillis():0;return Qe!==Ve?Ve-Qe:(ce.name||"").localeCompare(K.name||"")}));function C(ce){t.push(`/season/${ce}`)}function x(ce){r.value=r.value===ce?null:ce}function R(){r.value=null}async function L(){if(!e.value.length)return;const ce=e.value.map(Se=>typeof Se.sortOrder=="number"?Se.sortOrder:null).filter(Se=>Se!==null);let K=ce.length?Math.max(...ce):0;for(const Se of e.value)if(typeof Se.sortOrder!="number"){K+=1;try{await Aa(Se.id,K),Se.sortOrder=K}catch(De){console.error("Erreur migration sortOrder pour",Se.name,De)}}}async function B(ce){if(R(),ce<=0)return;const K=[..._.value],Se=K[ce],De=K[ce-1],Qe=Se.sortOrder;Se.sortOrder=De.sortOrder,De.sortOrder=Qe;try{await Promise.all([Aa(Se.id,Se.sortOrder),Aa(De.id,De.sortOrder)])}catch(Ve){console.error("Erreur lors du dplacement vers le haut",Ve)}}async function $(ce){R();const K=[..._.value];if(ce>=K.length-1)return;const Se=K[ce],De=K[ce+1],Qe=Se.sortOrder;Se.sortOrder=De.sortOrder,De.sortOrder=Qe;try{await Promise.all([Aa(Se.id,Se.sortOrder),Aa(De.id,De.sortOrder)])}catch(Ve){console.error("Erreur lors du dplacement vers le bas",Ve)}}function j(){o.value&&(a.value=o.value.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}function O(){l.value=l.value.replace(/[^0-9]/g,""),l.value.length>4&&(l.value=l.value.slice(0,4))}async function se(){if(!o.value.trim()||!a.value.trim()||!l.value.trim()){alert("Veuillez remplir tous les champs, y compris le code PIN  4 chiffres");return}if(l.value.length!==4){alert("Le code PIN doit contenir exactement 4 chiffres");return}try{await UD(o.value.trim(),a.value.trim(),l.value.trim()),e.value=await oh(),await L(),T()}catch(ce){console.error("Erreur lors de la cration de la saison:",ce),alert("Erreur lors de la cration de la saison. Veuillez ressayer.")}}function T(){s.value=!1,o.value="",a.value="",l.value=""}function w(ce){u.value=ce,i.value=!0}async function I(){i.value=!1,await D({type:"deleteSeason",data:{seasonId:u.value.id,seasonName:u.value.name}})}function S(){i.value=!1,u.value=null}function k(){return f.value?{deleteSeason:"Suppression de saison - Code PIN requis"}[f.value.type]||"Code PIN requis":"Veuillez saisir le code PIN  4 chiffres"}async function D(ce){if(Nn.isPinCached(u.value.id)){const K=Nn.getCachedPin(u.value.id);if(console.log("PIN en cache trouv, utilisation automatique"),await Eu(u.value.id,K)){await Ze(ce);return}else Nn.clearSession()}f.value=ce,d.value=!0}async function A(ce){var K,Se,De;console.log("PIN soumis:",ce,"pour l'opration:",f.value);try{const Qe=((Se=(K=f.value)==null?void 0:K.data)==null?void 0:Se.seasonId)||((De=u.value)==null?void 0:De.id),Ve=await Eu(Qe,ce);if(console.log("PIN valide:",Ve),Ve){Nn.saveSession(Qe,ce),console.log("PIN correct, fermeture de la modal et excution de l'opration"),d.value=!1;const Ye=f.value;f.value=null,console.log("Appel de executePendingOperation avec:",Ye),await Ze(Ye)}else g.value="Code PIN incorrect",setTimeout(()=>{g.value=""},3e3)}catch(Qe){console.error("Erreur lors de la vrification du PIN:",Qe),g.value="Erreur lors de la vrification du code PIN"}}function Jt(){d.value=!1,f.value=null,g.value=""}function qt(){return u.value&&Nn.isPinCached(u.value.id)?{timeRemaining:Nn.getTimeRemaining(),isExpiringSoon:Nn.isExpiringSoon()}:null}async function Ze(ce){if(console.log("executePendingOperation appel avec:",ce),!ce){console.log("Aucune opration  excuter");return}const{type:K,data:Se}=ce;console.log("Excution de l'opration:",K,"avec donnes:",Se);try{switch(K){case"deleteSeason":console.log("Suppression de la saison ID:",Se.seasonId),await BD(Se.seasonId),console.log("Saison supprime, rechargement de la liste..."),e.value=await oh(),console.log("Nouvelle liste des saisons:",e.value);break;default:console.log("Type d'opration non reconnu:",K)}}catch(De){console.error("Erreur lors de l'excution de l'opration:",De),alert("Erreur lors de l'opration. Veuillez ressayer.")}}return(ce,K)=>{var Se;return H(),W("div",iN,[K[22]||(K[22]=m("div",{class:"text-center py-16 px-4"},[m("h1",{class:"text-6xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent animate-pulse"}," Slections Spectacle "),m("p",{class:"text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed"}," Grez facilement les slections pour vos spectacles. ")],-1)),m("div",oN,[m("div",aN,[(H(!0),W(Nt,null,Mr(_.value,(De,Qe)=>(H(),W("div",{key:De.id,class:"group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm border border-white/20 rounded-2xl p-8 transition-all duration-300 hover:shadow-2xl hover:shadow-purple-500/20"},[m("div",{onClick:Ve=>C(De.slug),class:"text-center cursor-pointer"},[K[6]||(K[6]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg"},[m("span",{class:"text-2xl"},"")],-1)),m("h2",cN,we(De.name),1),K[7]||(K[7]=m("div",{class:"w-full bg-gradient-to-r from-transparent via-white/20 to-transparent h-px mb-4"},null,-1)),K[8]||(K[8]=m("p",{class:"text-gray-300 text-sm"}," Cliquez pour accder ",-1))],8,lN),m("div",uN,[m("div",{class:"relative",onClick:K[0]||(K[0]=Dn(()=>{},["stop"]))},[m("button",{onClick:Ve=>x(Qe),class:"p-1 rounded-full text-gray-300 hover:text-white hover:bg-white/10","aria-expanded":r.value===Qe,"aria-haspopup":"true",title:"Options"},K[9]||(K[9]=[m("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.75a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"})],-1)]),8,dN),r.value===Qe?(H(),W("div",hN,[m("button",{onClick:Ve=>B(Qe),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Monter ",8,fN),m("button",{onClick:Ve=>$(Qe),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Descendre ",8,pN),K[10]||(K[10]=m("div",{class:"border-t border-white/10 my-1"},null,-1)),m("button",{onClick:Ve=>w(De),class:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-red-500/10",role:"menuitem"}," Supprimer ",8,mN)])):xe("",!0)])])]))),128))]),e.value.length>0?(H(),W("div",gN,[m("button",{onClick:K[1]||(K[1]=De=>s.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-2xl hover:shadow-pink-500/25 transition-all duration-300 transform hover:scale-105"},"  Nouvelle saison ")])):xe("",!0),e.value.length===0?(H(),W("div",_N,[K[11]||(K[11]=m("div",{class:"w-24 h-24 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[m("span",{class:"text-4xl"},"")],-1)),K[12]||(K[12]=m("h3",{class:"text-2xl font-bold text-white mb-4"},"Aucune saison cre",-1)),K[13]||(K[13]=m("p",{class:"text-gray-300 mb-8"},"Commencez par crer votre premire saison de spectacles !",-1)),m("button",{onClick:K[2]||(K[2]=De=>s.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-xl hover:shadow-pink-500/25 transition-all duration-300"}," Crer ma premire saison ")])):xe("",!0)]),s.value?(H(),W("div",yN,[m("div",vN,[K[18]||(K[18]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Nouvelle saison",-1)),m("div",wN,[K[14]||(K[14]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom de la saison",-1)),gt(m("input",{"onUpdate:modelValue":K[3]||(K[3]=De=>o.value=De),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: La Malice 2025-2026",onInput:j},null,544),[[Rt,o.value]])]),m("div",bN,[K[15]||(K[15]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Slug (URL)",-1)),gt(m("input",{"onUpdate:modelValue":K[4]||(K[4]=De=>a.value=De),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: malice-2025-2026"},null,512),[[Rt,a.value]])]),m("div",IN,[K[16]||(K[16]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN (4 chiffres)",-1)),gt(m("input",{"onUpdate:modelValue":K[5]||(K[5]=De=>l.value=De),type:"text",inputmode:"numeric",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"1234",onInput:O},null,544),[[Rt,l.value]]),K[17]||(K[17]=m("p",{class:"text-xs text-gray-400 mt-1"},"Ce code protgera les oprations sensibles (suppressions, slections)",-1))]),m("div",EN,[m("button",{onClick:T,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:se,disabled:!o.value.trim()||!a.value.trim()||!l.value.trim()||l.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Crer ",8,TN)])])])):xe("",!0),i.value?(H(),W("div",AN,[m("div",xN,[m("div",PN,[K[19]||(K[19]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"")],-1)),K[20]||(K[20]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Confirmation",-1)),m("p",SN,'tes-vous sr de vouloir supprimer la saison "'+we((Se=u.value)==null?void 0:Se.name)+'" ?',1)]),K[21]||(K[21]=m("p",{class:"mb-6 text-sm text-red-400 bg-red-900/20 p-3 rounded-lg border border-red-500/20"},"  Cette action est irrversible et supprimera toutes les donnes de cette saison. ",-1)),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:S,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:I,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):xe("",!0),Ut(qb,{show:d.value,message:k(),error:g.value,"session-info":qt(),onSubmit:A,onCancel:Jt},null,8,["show","message","error","session-info"])])}}};let En="mock",xi=[{id:"p1",name:"Alice"},{id:"p2",name:"Bob"},{id:"p3",name:"Charlie"},{id:"p4",name:"David"},{id:"p5",name:"Eva"},{id:"p6",name:"Fanny"},{id:"p7",name:"Georges"},{id:"p8",name:"Hlne"},{id:"p9",name:"Ismal"},{id:"p10",name:"Jade"},{id:"p11",name:"Karim"},{id:"p12",name:"La"},{id:"p13",name:"Marc"},{id:"p14",name:"Nina"},{id:"p15",name:"Oscar"}],Pi=[{id:"event1",title:"Aprock Septembre",date:"2025-09-08",description:"Soire apro-rock avec ambiance festive"},{id:"event2",title:"Match  Cambo",date:"2025-11-25",description:"Match d'improvisation comptitif  Cambo-les-Bains"},{id:"event3",title:"Impro des Familles",date:"2025-12-02",description:"Spectacle d'improvisation pour toute la famille"},{id:"event4",title:"Cabaret Surprise",date:"2026-01-20",description:"Cabaret avec des surprises et des performances uniques"},{id:"event5",title:"Impro Plage",date:"2026-03-10",description:"Improvisation en plein air avec vue sur la plage"}];function CN(n){En=n}async function kN(){if(En!=="firebase"||!(await xt(tt(ve,"seasons"))).empty)return;const e=Me(tt(ve,"seasons"));await Rn(e,{name:"Malice 2025-2026",slug:"malice-2025-2026",createdAt:Ip()});const t=await xt(tt(ve,"players"));for(const o of t.docs)await Rn(Me(e,"players",o.id),o.data());const r=await xt(tt(ve,"events"));for(const o of r.docs)await Rn(Me(e,"events",o.id),o.data());const s=await xt(tt(ve,"availability"));for(const o of s.docs)await Rn(Me(e,"availability",o.id),o.data());const i=await xt(tt(ve,"selections"));for(const o of i.docs)await Rn(Me(e,"selections",o.id),o.data())}async function DN(){En==="firebase"&&await kN()}async function z_(n=null){return(En==="firebase"?n?(await xt(tt(ve,"seasons",n,"events"))).docs.map(t=>({id:t.id,...t.data()})):(await xt(tt(ve,"events"))).docs.map(t=>({id:t.id,...t.data()})):Pi).sort((t,r)=>{const s=u=>{if(!u)return null;if(u instanceof Date)return u;if(typeof(u==null?void 0:u.toDate)=="function")return u.toDate();const d=new Date(u);return isNaN(d.getTime())?null:d},i=s(t.date),o=s(r.date),a=i?i.getTime():Number.POSITIVE_INFINITY,l=o?o.getTime():Number.POSITIVE_INFINITY;return a!==l?a-l:(t.title||"").localeCompare(r.title||"","fr",{sensitivity:"base"})})}async function ch(n=null){return(En==="firebase"?n?(await xt(tt(ve,"seasons",n,"players"))).docs.map(t=>({id:t.id,...t.data()})):(await xt(tt(ve,"players"))).docs.map(t=>({id:t.id,...t.data()})):xi).sort((t,r)=>t.order<r.order?-1:t.order>r.order?1:t.name.localeCompare(r.name))}async function NN(n,e=null){if(En==="firebase"){const t=Me(e?tt(ve,"seasons",e,"players"):tt(ve,"players"));return await Rn(t,{name:n}),t.id}else{const t=`p${xi.length+1}`;return xi.push({id:t,name:n}),t}}async function VN(n,e=null){if(En==="firebase"){const t=e?Me(ve,"seasons",e,"players",n):Me(ve,"players",n);await _l(t);const r=e?await xt(tt(ve,"seasons",e,"availability")):await xt(tt(ve,"availability")),s=Qw(ve);r.forEach(i=>{const o=i.data();if(o[n]!==void 0){const a={...o};delete a[n],s.update(i.ref,a)}}),await s.commit()}else xi=xi.filter(t=>t.id!==n)}async function ON(n,e,t=null){if(En==="firebase"){const r=t?Me(ve,"seasons",t,"players",n):Me(ve,"players",n);await Rn(r,{name:e})}else{const r=xi.findIndex(s=>s.id===n);r!==-1&&(xi[r]=e)}}async function xa(n,e,t=null){if(En==="firebase"){const r=t?await xt(tt(ve,"seasons",t,"availability")):await xt(tt(ve,"availability")),s={};return r.forEach(i=>{s[i.id]=i.data()}),s}else{const r={};return n.forEach(s=>{r[s.name]={},e.forEach(i=>{r[s.name][i.id]=void 0})}),e.forEach(s=>{const i=[...n].sort(()=>.5-Math.random());i.slice(0,4).forEach(o=>{r[o.name][s.id]=!0}),i.slice(4).forEach(o=>{const a=Math.random();r[o.name][s.id]=a<.4?!0:a<.8?!1:void 0})}),r}}async function Pa(n=null){if(En==="firebase"){const e=n?await xt(tt(ve,"seasons",n,"selections")):await xt(tt(ve,"selections")),t={};return e.forEach(r=>{t[r.id]=r.data().players||[]}),t}else return{}}async function G_(n,e,t=null){if(En==="firebase"){const r=t?Me(ve,"seasons",t,"availability",n):Me(ve,"availability",n);await Rn(r,e)}}async function MN({seasonId:n,playerName:e,eventId:t,value:r}){if(En!=="firebase")return;const s=n?Me(ve,"seasons",n,"availability",e):Me(ve,"availability",e),i=await Di(s),a={...i.exists()?i.data():{}};r===void 0?delete a[t]:a[t]=r,await Rn(s,a)}async function LN(n,e,t=null){if(En==="firebase"){const r=t?Me(ve,"seasons",t,"selections",n):Me(ve,"selections",n);await Rn(r,{players:e})}}async function FN(n,e=null){if(console.log("Suppression de l'vnement:",n),En==="firebase")try{console.log("Suppression de l'vnement dans Firestore");const t=e?Me(ve,"seasons",e,"events",n):Me(ve,"events",n);await _l(t),console.log("Suppression de la slection associe");const r=e?Me(ve,"seasons",e,"selections",n):Me(ve,"selections",n);await _l(r),console.log("Suppression des disponibilits");const s=e?await xt(tt(ve,"seasons",e,"availability")):await xt(tt(ve,"availability")),i=Qw(ve);s.forEach(o=>{const a=o.data();if(a[n]!==void 0){console.log("Mise  jour de la disponibilit pour:",o.id);const l={...a};delete l[n],i.update(o.ref,l)}}),await i.commit(),console.log("Oprations de suppression termines avec succs")}catch(t){throw console.error("Erreur lors de la suppression:",t),t}else Pi=Pi.filter(t=>t.id!==n)}async function UN(n,e=null){if(En==="firebase"){const t=Me(e?tt(ve,"seasons",e,"events"):tt(ve,"events"));return await Rn(t,n),t.id}else{const t=`event${Pi.length+1}`;return Pi.push({id:t,...n}),t}}async function BN(n,e,t=null){if(En==="firebase"){const r=t?Me(ve,"seasons",t,"events",n):Me(ve,"events",n);await Rn(r,e)}else{const r=Pi.findIndex(s=>s.id===n);r!==-1&&(Pi[r]={id:n,...e})}}class $N{constructor(){this.sessions=new Map,this.sessionDuration=10*60*1e3}isPasswordCached(e){const t=this.sessions.get(e);return t?Date.now()-t.timestamp>this.sessionDuration?(this.sessions.delete(e),!1):!0:!1}getCachedPassword(e){const t=this.sessions.get(e);return t?Date.now()-t.timestamp>this.sessionDuration?(this.sessions.delete(e),null):t.password:null}saveSession(e,t){this.sessions.set(e,{password:t,timestamp:Date.now()})}clearSession(e){this.sessions.delete(e)}clearExpiredSessions(){const e=Date.now();for(const[t,r]of this.sessions.entries())e-r.timestamp>this.sessionDuration&&this.sessions.delete(t)}clearAllSessions(){this.sessions.clear()}}const Tl=new $N,jN="modulepreload",qN=function(n){return"/impro-selector/"+n},K_={},Hn=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=qN(i),i in K_)return;K_[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":jN,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function zb(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return e.toString()}async function zN(n,e,t,r=null){try{console.log(" [DEBUG] Dbut protectPlayer:",{playerId:n,email:e,seasonId:r});const s=await Ql(n,r);if(s&&s.isProtected)throw new Error("Ce joueur est dj protg");const{collection:i,query:o,where:a,getDocs:l}=await Hn(()=>import("./index.esm-346117a1.js"),[]),{db:u}=await Hn(()=>Promise.resolve().then(()=>mo),void 0),d=r?i(u,"seasons",r,"playerProtection"):i(u,"playerProtection"),f=o(d,a("email","==",e)),g=await l(f);if(!g.empty&&g.docs.find($=>$.id!==n))throw new Error("Cette adresse email est dj utilise par un autre joueur");console.log(" [DEBUG] Cration du compte Firebase Auth...");const{createUserWithEmailAndPassword:_}=await Hn(()=>import("./index.esm-2ffddb9f.js"),[]),{auth:C}=await Hn(()=>Promise.resolve().then(()=>mo),void 0),x=await _(C,e,t);console.log(" [DEBUG] Compte Firebase Auth cr:",x.user.uid);const R=zb(t),L=r?Me(u,"seasons",r,"playerProtection",n):Me(u,"playerProtection",n);return await Rn(L,{playerId:n,email:e,passwordHash:R,firebaseUid:x.user.uid,isProtected:!0,createdAt:new Date}),console.log(" [DEBUG] Protection sauvegarde dans Firestore"),{success:!0}}catch(s){throw console.error(" [ERROR] Erreur lors de la protection du joueur:",s),s}}async function GN(n,e=null){try{const t=e?Me(ve,"seasons",e,"playerProtection",n):Me(ve,"playerProtection",n),r=await Ql(n,e),s=(r==null?void 0:r.email)||"";return await Rn(t,{playerId:n,email:s,isProtected:!1,updatedAt:new Date}),{success:!0,email:s}}catch(t){throw console.error("Erreur lors de la suppression de la protection:",t),t}}async function di(n,e=null){try{const t=e?Me(ve,"seasons",e,"playerProtection",n):Me(ve,"playerProtection",n),r=await Di(t);return r.exists()?r.data().isProtected===!0:!1}catch(t){return console.error("Erreur lors de la vrification de protection:",t),!1}}async function Ql(n,e=null){try{const t=e?Me(ve,"seasons",e,"playerProtection",n):Me(ve,"playerProtection",n),r=await Di(t);return r.exists()?r.data():null}catch(t){return console.error("Erreur lors de la rcupration des donnes de protection:",t),null}}async function Gb(n,e=null){try{const t=await Ql(n,e);return(t==null?void 0:t.email)||""}catch(t){return console.error("Erreur lors de la rcupration de l'email:",t),""}}async function H_(n=null){try{const e=n?tt(ve,"seasons",n,"playerProtection"):tt(ve,"playerProtection");return(await xt(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return console.error("Erreur lors du chargement des protections:",e),[]}}async function Tu(n,e,t=null){try{const r=await Ql(n,t);if(!r||!r.isProtected)return!1;if(r.firebaseUid){console.log(" [DEBUG] Vrification avec Firebase Auth");try{const{signInWithEmailAndPassword:s}=await Hn(()=>import("./index.esm-2ffddb9f.js"),[]),{auth:i}=await Hn(()=>Promise.resolve().then(()=>mo),void 0);return await s(i,r.email,e),console.log(" [DEBUG] Mot de passe Firebase Auth valide"),Tl.saveSession(n,e),!0}catch(s){return console.log(" [DEBUG] Mot de passe Firebase Auth invalide:",s.code),!1}}else{console.log(" [DEBUG] Vrification avec hash local");const s=zb(e),i=r.passwordHash===s;return i&&Tl.saveSession(n,e),i}}catch(r){return console.error("Erreur lors de la vrification du mot de passe:",r),!1}}function Ya(n){return Tl.isPasswordCached(n)}async function ef(n,e=null){try{console.log(" [DEBUG] Dbut sendPasswordResetEmail:",{playerId:n,seasonId:e});const t=await Ql(n,e);if(console.log(" [DEBUG] Protection data:",t),!t||!t.isProtected)throw new Error("Joueur non protg");if(console.log(" [DEBUG] Email  utiliser:",t.email),t.firebaseUid){console.log(" [DEBUG] Utilisation du compte Firebase Auth existant");const{sendPasswordResetEmail:r}=await Hn(()=>import("./index.esm-2ffddb9f.js"),[]),{auth:s}=await Hn(()=>Promise.resolve().then(()=>mo),void 0);console.log(" [DEBUG] Tentative d'envoi d'email :",t.email),await r(s,t.email),console.log(" [DEBUG] Email envoy avec succs via Firebase Auth!"),console.log(" [DEBUG] Vrifiez votre bote mail:",t.email)}else{console.log(" [DEBUG] Pas de compte Firebase Auth, cration temporaire...");const{createUserWithEmailAndPassword:r,sendPasswordResetEmail:s}=await Hn(()=>import("./index.esm-2ffddb9f.js"),[]),{auth:i}=await Hn(()=>Promise.resolve().then(()=>mo),void 0),o=Math.random().toString(36).slice(-8)+"A1!";try{const a=await r(i,t.email,o);console.log(" [DEBUG] Compte temporaire cr:",a.user.uid),await s(i,t.email),console.log(" [DEBUG] Email envoy avec succs!");const{updateDoc:l}=await Hn(()=>import("./index.esm-346117a1.js"),[]),{db:u}=await Hn(()=>Promise.resolve().then(()=>mo),void 0),d=e?Me(u,"seasons",e,"playerProtection",n):Me(u,"playerProtection",n);await l(d,{firebaseUid:a.user.uid})}catch(a){if(a.code==="auth/email-already-in-use")console.log(" [DEBUG] Email dj utilis, tentative d'envoi direct..."),await s(i,t.email),console.log(" [DEBUG] Email envoy avec succs!");else throw a}}return{success:!0,message:"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}}catch(t){throw console.error(" [ERROR] Erreur lors de l'envoi de l'email de rinitialisation:",t),console.error(" [ERROR] Code d'erreur:",t.code),console.error(" [ERROR] Message d'erreur:",t.message),t.code==="auth/user-not-found"?new Error("Aucun compte trouv avec cette adresse email"):t.code==="auth/too-many-requests"?new Error("Trop de tentatives. Veuillez ressayer plus tard"):t.code==="auth/invalid-email"?new Error("Adresse email invalide"):new Error(`Erreur lors de l'envoi de l'email: ${t.message}`)}}const zp="magicLinks";function Gp({seasonId:n,playerId:e,eventId:t}){return`${n}__${e}__${t}`}function KN(n=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let r=0;r<n;r++)t+=e[Math.floor(Math.random()*e.length)];return t}async function W_({seasonId:n,playerId:e,eventId:t,action:r}){const s=Gp({seasonId:n,playerId:e,eventId:t}),i=KN(40),o=Me(ve,zp,s),a=Date.now()+1e3*60*60*24*7;await Rn(o,{seasonId:n,playerId:e,eventId:t,token:i,action:r,expiresAt:a});const u=`${window.location.origin+"/impro-selector/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&eid=${encodeURIComponent(t)}&t=${encodeURIComponent(i)}&a=${encodeURIComponent(r)}`;return{id:s,token:i,url:u}}async function HN({seasonId:n,playerId:e,eventId:t,token:r,action:s}){const i=Gp({seasonId:n,playerId:e,eventId:t}),o=Me(ve,zp,i),a=await Di(o);if(!a.exists())return{valid:!1,reason:"not_found"};const l=a.data();return l.token!==r?{valid:!1,reason:"token_mismatch"}:l.action!==s?{valid:!1,reason:"action_mismatch"}:typeof l.expiresAt=="number"&&Date.now()>l.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:l}}async function WN({seasonId:n,playerId:e,eventId:t}){const r=Gp({seasonId:n,playerId:e,eventId:t}),s=Me(ve,zp,r);await _l(s)}async function QN({toEmail:n,playerName:e,eventTitle:t,eventDate:r,yesUrl:s,noUrl:i,reason:o="new_event",fromEmail:a=void 0}){const l=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>Disponibilit demande</h2>
      <p>Bonjour ${e},</p>
      <p>Peux-tu indiquer ta disponibilit pour <strong>${t}</strong> (${r}) ?</p>
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;margin-right:8px;background:#16a34a;color:#fff;border-radius:8px;text-decoration:none;">Je suis dispo </a>
        <a href="${i}" style="display:inline-block;padding:10px 16px;background:#dc2626;color:#fff;border-radius:8px;text-decoration:none;">Pas dispo </a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Motif: ${o}</p>
    </div>
  `,u=`Disponibilit demande  ${t}`,d={to:n,message:{subject:u,html:l},createdAt:Ip(),meta:{reason:o,eventTitle:t,eventDate:r,playerName:e}};return a&&(d.from=a,d.replyTo=a),await Ww(tt(ve,"mail"),d),{success:!0}}const JN={class:"text-center mb-6"},YN={class:"text-lg text-gray-300"},XN={class:"mb-6"},ZN={class:"flex items-center space-x-3"},eV={class:"text-2xl"},tV={class:"font-semibold text-white"},nV={class:"text-sm text-gray-300"},rV={class:"mb-6"},sV={key:0,class:"mt-2 p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg text-sm text-gray-300 space-y-1"},iV={key:0,class:"mb-6"},oV={class:"space-y-4"},aV=["disabled"],lV={key:0,class:"animate-spin"},cV={key:1},uV={key:1,class:"mb-6"},dV={key:0,class:"space-y-4 mb-4"},hV=["disabled"],fV={key:0,class:"animate-spin"},pV={key:1},mV=["disabled"],gV={key:2,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},_V={class:"text-red-300 text-sm"},yV={key:3,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},vV={class:"text-green-300 text-sm"},wV={__name:"PlayerProtectionModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","update"],setup(n,{emit:e}){const t=n,r=e,s=q(!1),i=q(""),o=q(""),a=q(""),l=q(!1),u=q(""),d=q(""),f=q(!1),g=q(!1),_=q(""),C=Lt(()=>i.value&&o.value&&a.value&&o.value===a.value&&o.value.length>=6&&i.value.includes("@"));async function x(){var j;if((j=t.player)!=null&&j.id&&(s.value=await di(t.player.id,t.seasonId),!s.value)){const O=await Gb(t.player.id,t.seasonId);O&&(i.value=O)}}async function R(){if(C.value){l.value=!0,u.value="",d.value="";try{await zN(t.player.id,i.value,o.value,t.seasonId),d.value="Protection active avec succs !",s.value=!0,i.value="",o.value="",a.value="",r("update")}catch(j){console.error("Erreur lors de l'activation de la protection:",j),j.message&&j.message.includes("email")?u.value="Cette adresse email est dj utilise par un autre joueur.":u.value="Erreur lors de l'activation de la protection. Veuillez ressayer."}finally{l.value=!1}}}function L(){g.value=!0,_.value="",u.value=""}async function B(){if(_.value){l.value=!0,u.value="",d.value="";try{if(!await Tu(t.player.id,_.value,t.seasonId)){u.value="Mot de passe incorrect. Veuillez ressayer.";return}const O=await GN(t.player.id,t.seasonId);d.value="Protection dsactive avec succs !",s.value=!1,g.value=!1,_.value="",O.email&&(i.value=O.email),r("update")}catch(j){console.error("Erreur lors de la dsactivation de la protection:",j),u.value="Erreur lors de la dsactivation de la protection. Veuillez ressayer."}finally{l.value=!1}}}function $(){r("close")}return or(()=>t.player,()=>{t.show&&t.player&&x()},{immediate:!0}),or(()=>t.show,j=>{j&&t.player&&(o.value="",a.value="",u.value="",d.value="",f.value=!1,g.value=!1,_.value="",x())}),(j,O)=>{var se;return n.show?(H(),W("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4",onClick:$},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:O[6]||(O[6]=Dn(()=>{},["stop"]))},[m("div",JN,[O[7]||(O[7]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"")],-1)),O[8]||(O[8]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Protection du joueur",-1)),m("p",YN,we((se=n.player)==null?void 0:se.name),1)]),m("div",XN,[m("div",{class:rr(["flex items-center justify-between p-4 rounded-lg",s.value?"bg-green-500/20 border border-green-500/30":"bg-gray-500/20 border border-gray-500/30"])},[m("div",ZN,[m("span",eV,we(s.value?"":""),1),m("div",null,[m("div",tV,we(s.value?"Protg":"Non protg"),1),m("div",nV,we(s.value?"Modifications scurises":"Modifications libres"),1)])])],2)]),m("div",rV,[m("button",{onClick:O[0]||(O[0]=T=>f.value=!f.value),class:"w-full p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-all duration-200 flex items-center justify-between"},[O[9]||(O[9]=m("h3",{class:"text-sm font-semibold text-blue-300"}," Pourquoi protger son joueur ?",-1)),m("span",{class:rr(["text-blue-300 transition-transform duration-200",{"rotate-180":f.value}])},"",2)]),f.value?(H(),W("div",sV,O[10]||(O[10]=[m("div",null,[qn(" "),m("span",{class:"text-blue-300"},"Protection des disponibilits :"),qn(" Seul vous pouvez modifier vos disponibilits")],-1),m("div",null,[qn(" "),m("span",{class:"text-blue-300"},"Protection du nom :"),qn(" Seul vous pouvez changer votre nom de joueur")],-1),m("div",null,[qn(" "),m("span",{class:"text-blue-300"},"Email requis :"),qn(" Permet de rinitialiser le mot de passe en cas d'oubli")],-1)]))):xe("",!0)]),s.value?xe("",!0):(H(),W("div",iV,[O[14]||(O[14]=m("h3",{class:"text-lg font-semibold text-white mb-4"}," Activer la protection",-1)),m("div",oV,[m("div",null,[O[11]||(O[11]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Adresse email",-1)),gt(m("input",{"onUpdate:modelValue":O[1]||(O[1]=T=>i.value=T),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[Rt,i.value]])]),m("div",null,[O[12]||(O[12]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":O[2]||(O[2]=T=>o.value=T),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe scuris"},null,512),[[Rt,o.value]])]),m("div",null,[O[13]||(O[13]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":O[3]||(O[3]=T=>a.value=T),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe"},null,512),[[Rt,a.value]])])]),m("button",{onClick:R,disabled:!C.value||l.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[l.value?(H(),W("span",lV,"")):(H(),W("span",cV,"")),m("span",null,we(l.value?"Activation...":"Activer la protection"),1)],8,aV)])),s.value?(H(),W("div",uV,[O[17]||(O[17]=m("h3",{class:"text-lg font-semibold text-white mb-4"}," Dsactiver la protection",-1)),O[18]||(O[18]=m("p",{class:"text-sm text-gray-300 mb-4"}," Attention : dsactiver la protection supprimera dfinitivement le mot de passe et l'email associs. ",-1)),g.value?(H(),W("div",dV,[m("div",null,[O[15]||(O[15]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe de confirmation",-1)),gt(m("input",{"onUpdate:modelValue":O[4]||(O[4]=T=>_.value=T),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe pour confirmer"},null,512),[[Rt,_.value]])]),m("button",{onClick:B,disabled:!_.value||l.value,class:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[l.value?(H(),W("span",fV,"")):(H(),W("span",pV,"")),m("span",null,we(l.value?"Dsactivation...":"Confirmer la dsactivation"),1)],8,hV),m("button",{onClick:O[5]||(O[5]=T=>g.value=!1),class:"w-full px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])):xe("",!0),g.value?xe("",!0):(H(),W("button",{key:1,onClick:L,disabled:l.value,class:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},O[16]||(O[16]=[m("span",null,"",-1),m("span",null,"Dsactiver la protection",-1)]),8,mV))])):xe("",!0),u.value?(H(),W("div",gV,[m("div",_V,we(u.value),1)])):xe("",!0),d.value?(H(),W("div",yV,[m("div",vV,we(d.value),1)])):xe("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:$,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):xe("",!0)}}},bV={class:"text-center mb-6"},IV={class:"text-lg text-gray-300"},EV={class:"mb-6"},TV={class:"space-y-4"},AV=["disabled"],xV={key:0,class:"animate-spin"},PV={key:1},SV={class:"mb-6 text-center"},RV={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},CV={class:"text-red-300 text-sm"},kV={class:"text-center mb-6"},DV={class:"text-lg text-gray-300"},NV={class:"mb-6"},VV=["disabled"],OV={key:0,class:"animate-spin"},MV={key:1},LV={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},FV={class:"text-red-300 text-sm"},UV={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},BV={class:"text-green-300 text-sm"},$V={class:"flex justify-center"},jV={__name:"PasswordVerificationModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","verified"],setup(n,{emit:e}){const t=n,r=e,s=q(""),i=q(!1),o=q(""),a=q(!1),l=q(""),u=q(""),d=q(null);async function f(){if(s.value){i.value=!0,o.value="";try{const C=await Zh(t.seasonId);if(s.value===C){r("verified",{type:"season_pin"}),_();return}await Tu(t.player.id,s.value,t.seasonId)?(r("verified",{type:"player_password"}),_()):o.value="Mot de passe incorrect. Veuillez ressayer."}catch(C){console.error("Erreur lors de la vrification:",C),o.value="Erreur lors de la vrification. Veuillez ressayer."}finally{i.value=!1}}}async function g(){i.value=!0,l.value="",u.value="";try{const C=await ef(t.player.id,t.seasonId);u.value=C.message||"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}catch(C){console.error("Erreur lors de l'envoi de l'email:",C),l.value="Erreur lors de l'envoi de l'email. Veuillez ressayer."}finally{i.value=!1}}function _(){r("close"),s.value="",o.value="",a.value=!1,l.value="",u.value=""}return or(()=>t.show,C=>{C&&pr(()=>{d.value&&d.value.focus()})}),(C,x)=>{var R,L;return H(),W(Nt,null,[n.show?(H(),W("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4",onClick:_},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:x[2]||(x[2]=Dn(()=>{},["stop"]))},[m("div",bV,[x[6]||(x[6]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"")],-1)),x[7]||(x[7]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Vrification requise",-1)),m("p",IV,we((R=n.player)==null?void 0:R.name),1),x[8]||(x[8]=m("p",{class:"text-sm text-gray-400 mt-2"},"Ce joueur est protg par mot de passe",-1))]),m("div",EV,[m("div",TV,[m("div",null,[x[9]||(x[9]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),gt(m("input",{"onUpdate:modelValue":x[0]||(x[0]=B=>s.value=B),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:Pn(f,["enter"]),ref_key:"passwordInput",ref:d},null,544),[[Rt,s.value]])])]),m("button",{onClick:f,disabled:!s.value||i.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(H(),W("span",xV,"")):(H(),W("span",PV,"")),m("span",null,we(i.value?"Vrification...":"Vrifier"),1)],8,AV)]),m("div",SV,[m("button",{onClick:x[1]||(x[1]=B=>a.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oubli ? ")]),o.value?(H(),W("div",RV,[m("div",CV,we(o.value),1)])):xe("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:_,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):xe("",!0),a.value?(H(),W("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:x[5]||(x[5]=B=>a.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:x[4]||(x[4]=Dn(()=>{},["stop"]))},[m("div",kV,[x[10]||(x[10]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"")],-1)),x[11]||(x[11]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Mot de passe oubli",-1)),m("p",DV,we((L=n.player)==null?void 0:L.name),1)]),m("div",NV,[x[12]||(x[12]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de rinitialisation sera envoy  l'adresse associe  ce joueur. ",-1)),m("button",{onClick:g,disabled:i.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(H(),W("span",OV,"")):(H(),W("span",MV,"")),m("span",null,we(i.value?"Envoi...":"Envoyer l'email"),1)],8,VV)]),l.value?(H(),W("div",LV,[m("div",FV,we(l.value),1)])):xe("",!0),u.value?(H(),W("div",UV,[m("div",BV,we(u.value),1)])):xe("",!0),m("div",$V,[m("button",{onClick:x[3]||(x[3]=B=>a.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):xe("",!0)],64)}}},qV={class:"relative text-center p-6 pb-4 border-b border-white/10"},zV={class:"text-2xl md:text-3xl font-bold text-white mb-1"},GV={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},KV={class:"grid grid-cols-3 gap-3 md:gap-4"},HV={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},WV={class:"text-xl md:text-2xl font-bold text-white"},QV={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},JV={class:"text-xl md:text-2xl font-bold text-white"},YV={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 md:p-4 rounded-lg border border-green-500/30"},XV={class:"text-xl md:text-2xl font-bold text-white"},ZV={class:"hidden md:flex justify-center flex-wrap gap-3 mt-6"},eO={key:0,class:"md:hidden mt-3 space-y-2"},tO={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},nO={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},rO={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},sO={class:"mb-6"},iO={__name:"PlayerModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},stats:{type:Object,default:()=>({availability:0,selection:0,ratio:0})},seasonId:{type:String,default:null}},emits:["close","update","delete","refresh"],setup(n,{emit:e}){const t=n,r=e,s=q(!1),i=q(""),o=q(null),a=q(!1),l=q(!1),u=q(null),d=q(!1);function f(){r("close")}function g(){var j;i.value=((j=t.player)==null?void 0:j.name)||"",s.value=!0,pr(()=>{o.value&&o.value.focus()})}function _(){s.value=!1,i.value=""}async function C(){var O,se;if(!i.value.trim())return;if(await di((O=t.player)==null?void 0:O.id,t.seasonId)){Ya((se=t.player)==null?void 0:se.id)?x():(u.value="update",l.value=!0);return}x()}function x(){var j;r("update",{playerId:(j=t.player)==null?void 0:j.id,newName:i.value.trim()}),s.value=!1,i.value=""}async function R(){var O,se;if(await di((O=t.player)==null?void 0:O.id,t.seasonId)){Ya((se=t.player)==null?void 0:se.id)?L():(u.value="delete",l.value=!0);return}L()}function L(){var j;r("delete",(j=t.player)==null?void 0:j.id)}function B(){r("refresh")}function $(j){u.value==="update"?x():u.value==="delete"&&L(),u.value=null}return or(()=>t.show,j=>{j||(s.value=!1,i.value="",u.value=null)}),(j,O)=>{var se;return H(),W(Nt,null,[n.show?(H(),W("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:f},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:O[5]||(O[5]=Dn(()=>{},["stop"]))},[m("div",qV,[m("button",{onClick:f,class:"absolute right-3 top-3 text-white/80 hover:text-white"},""),O[9]||(O[9]=m("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[m("span",{class:"text-2xl md:text-3xl"},"")],-1)),m("h2",zV,we((se=n.player)==null?void 0:se.name),1)]),m("div",GV,[m("div",null,[m("div",KV,[m("div",HV,[m("div",WV,we(t.stats.availability),1),O[10]||(O[10]=m("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibles",-1))]),m("div",QV,[m("div",JV,we(t.stats.selection),1),O[11]||(O[11]=m("div",{class:"text-xs md:text-sm text-gray-300"},"Slectionns",-1))]),m("div",YV,[m("div",XV,we(t.stats.ratio)+"%",1),O[12]||(O[12]=m("div",{class:"text-xs md:text-sm text-gray-300"},"Taux",-1))])])]),m("div",ZV,[m("button",{onClick:g,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},O[13]||(O[13]=[m("span",null,"",-1),m("span",null,"Modifier",-1)])),m("button",{onClick:O[0]||(O[0]=T=>a.value=!0),class:"px-5 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2"},O[14]||(O[14]=[m("span",null,"",-1),m("span",null,"Protection",-1)])),m("button",{onClick:R,class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},O[15]||(O[15]=[m("span",null,"",-1),m("span",null,"Supprimer",-1)])),m("button",{onClick:f,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")]),d.value?(H(),W("div",eO,[m("button",{onClick:O[1]||(O[1]=T=>{g(),d.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"},"  Modifier "),m("button",{onClick:O[2]||(O[2]=T=>{R(),d.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"},"  Supprimer ")])):xe("",!0)]),m("div",tO,[m("button",{onClick:O[3]||(O[3]=T=>a.value=!0),class:"h-12 px-4 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex-[1.4]"},"  Protection "),m("button",{onClick:f,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"}," Fermer "),m("button",{onClick:O[4]||(O[4]=T=>d.value=!d.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"},"  ")])])])):xe("",!0),s.value?(H(),W("div",nO,[m("div",rO,[O[17]||(O[17]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Modifier le joueur",-1)),m("div",sO,[O[16]||(O[16]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),gt(m("input",{"onUpdate:modelValue":O[6]||(O[6]=T=>i.value=T),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Pn(_,["esc"]),Pn(C,["enter"])],ref_key:"editNameInput",ref:o},null,544),[[Rt,i.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:_,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:C,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):xe("",!0),Ut(wV,{show:a.value,player:n.player,seasonId:n.seasonId,onClose:O[7]||(O[7]=T=>a.value=!1),onUpdate:B},null,8,["show","player","seasonId"]),Ut(jV,{show:l.value,player:n.player,seasonId:n.seasonId,onClose:O[8]||(O[8]=T=>l.value=!1),onVerified:$},null,8,["show","player","seasonId"])],64)}}},oO={class:"relative p-5 pb-4 border-b border-white/10"},aO={key:0,class:"text-sm text-purple-300 mt-1"},lO={class:"px-4 md:px-6 py-4 md:py-6 space-y-4 overflow-y-auto"},cO={class:"relative"},uO=["value"],dO=["title"],hO={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},fO={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pO={class:"text-sm text-gray-300"},mO={key:0,class:"mb-1"},gO={key:1},_O={__name:"AnnounceModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},message:{type:String,default:""},isPartial:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=n,r=e,s=q(!1),i=q("Copier le message");function o(){r("close")}function a(u){var f;return u?(typeof u=="string"?new Date(u):((f=u.toDate)==null?void 0:f.call(u))||u).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function l(){const u=t.message||"";navigator.clipboard.writeText(u).then(()=>{s.value=!0,i.value="Copi !",setTimeout(()=>{s.value=!1,i.value="Copier le message"},2e3)}).catch(d=>{console.error("Erreur lors de la copie du texte:",d),alert("Impossible de copier le message.")})}return(u,d)=>n.show?(H(),W("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:o},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:d[0]||(d[0]=Dn(()=>{},["stop"]))},[m("div",oO,[m("button",{onClick:o,title:"Fermer",class:"absolute right-2.5 top-2.5 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),d[1]||(d[1]=m("h2",{class:"text-xl md:text-2xl font-bold text-white pr-10"},"Annoncer la slection",-1)),n.event?(H(),W("p",aO,we(n.event.title)+"  "+we(a(n.event.date)),1)):xe("",!0)]),m("div",lO,[d[4]||(d[4]=m("div",{class:"bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20 p-3"},[m("p",{class:"text-blue-200 text-sm"},"Le message ci-dessous est prt  tre copi/coll dans WhatsApp, Messenger, email, etc.")],-1)),m("div",cO,[m("textarea",{value:n.message,class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400 resize-none",rows:"6",readonly:""},null,8,uO),m("button",{onClick:l,class:"absolute top-2 right-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg p-2 hover:from-purple-600 hover:to-pink-700 transition-all duration-300",title:i.value},[s.value?(H(),W("svg",fO,d[3]||(d[3]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(H(),W("svg",hO,d[2]||(d[2]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2z"},null,-1)])))],8,dO)]),m("div",pO,[n.isPartial?(H(),W("p",mO,"Note: cette annonce concerne une mise  jour partielle de la slection.")):(H(),W("p",gO,"Vrifie le message si besoin avant de l'envoyer."))])]),m("div",{class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},[m("button",{onClick:l,class:"h-12 px-4 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 flex-1"},"  Copier "),m("button",{onClick:o,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"}," Fermer ")])])])):xe("",!0)}},yO={class:"relative text-center p-6 pb-4 border-b border-white/10"},vO={class:"text-2xl md:text-3xl font-bold text-white mb-1"},wO={class:"text-sm md:text-base text-purple-300"},bO={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},IO={key:0,class:"mb-3"},EO={class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-0"},TO={class:"text-white font-medium"},AO={key:0,class:"text-purple-400 mr-2"},xO={key:1,class:"text-green-400 mr-2"},PO={key:2,class:"text-red-400 mr-2"},SO={key:3,class:"text-gray-400 mr-2"},RO={key:1,class:"mb-3"},CO={class:"grid grid-cols-3 gap-2 md:gap-3 mb-3"},kO={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},DO={class:"text-cyan-300 text-lg md:text-xl font-semibold"},NO={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},VO={class:"text-green-400 text-lg md:text-xl font-semibold"},OO={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},MO={class:"text-purple-400 text-lg md:text-xl font-semibold"},LO={key:2,class:"mb-3"},FO={class:"flex items-center space-x-3 p-3 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20"},UO={class:"flex-1"},BO={class:"text-blue-300 text-sm font-medium"},$O={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},jO=["disabled","title"],qO=["disabled"],zO={__name:"SelectionModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},currentSelection:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},selectedCount:{type:Number,default:0},playerAvailability:{type:Object,default:()=>({})}},emits:["close","selection","perfect"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=q(!1),o=q("Copier le message"),a=q(!1),l=q(!1),u=q(""),d=q(!1),f=Lt(()=>r.currentSelection&&r.currentSelection.length>0),g=Lt(()=>{var k;if(!f.value)return!1;const w=r.currentSelection.some(D=>!$(D)),I=((k=r.event)==null?void 0:k.playerCount)||6,S=r.availableCount<I;return w||S});Lt(()=>{var S;if(!g.value)return"";const w=r.currentSelection.filter(k=>!$(k)),I=((S=r.event)==null?void 0:S.playerCount)||6;return w.length>0?w.length===1?`${w[0]} n'est plus disponible. Veuillez relancer la slection.`:`${w.length} joueurs ne sont plus disponibles. Veuillez relancer la slection.`:r.availableCount<I?`Seulement ${r.availableCount} joueurs disponibles pour ${I} requis. Veuillez attendre plus de disponibilits ou ajuster le nombre de joueurs  slectionner.`:"Slection incomplte"});const _=Lt(()=>{if(!r.event||!f.value)return"";const w=C(r.event.date),I=r.currentSelection.join(", ");return`Slection pour ${r.event.title} du ${w} : ${I}`});or(()=>r.show,w=>{w&&(i.value=!1,o.value="Copier le message",l.value=!1,u.value="",d.value=!1,a.value=!1)});function C(w){var S;return w?(typeof w=="string"?new Date(w):((S=w.toDate)==null?void 0:S.call(w))||w).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function x(){s("selection")}function R(){s("perfect")}function L(){s("close")}function B(){a.value=!0}function $(w){return r.playerAvailability[w]===!0}function j(w){return r.playerAvailability[w]===!1}function O(w){return r.currentSelection.includes(w)&&$(w)}function se(w=!1,I=!1){if(d.value=w,w){const S=C(r.event.date),k=r.currentSelection.join(", ");I?u.value=`Slection mise  jour pour ${r.event.title} du ${S} : ${k}`:u.value=`Nouvelle slection pour ${r.event.title} du ${S} : ${k}`}else u.value="Slection effectue avec succs !";l.value=!0,setTimeout(()=>{l.value=!1},8e3)}function T(){l.value=!1}return e({showSuccess:se}),(w,I)=>{var S,k,D;return H(),W(Nt,null,[n.show?(H(),W("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:L},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:I[0]||(I[0]=Dn(()=>{},["stop"]))},[m("div",yO,[m("button",{onClick:L,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),I[2]||(I[2]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"")],-1)),m("h2",vO,"Slection pour "+we((S=n.event)==null?void 0:S.title),1),m("p",wO,we(C((k=n.event)==null?void 0:k.date)),1)]),m("div",bO,[f.value?(H(),W("div",IO,[I[3]||(I[3]=m("h3",{class:"text-base md:text-lg font-semibold text-white mb-2"},"Joueurs slectionns",-1)),m("div",EO,[(H(!0),W(Nt,null,Mr(n.currentSelection,A=>(H(),W("div",{key:A,class:rr(["bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 rounded-lg border border-green-500/30 text-center",{"from-red-500/20 to-red-600/20 border-red-500/30":!$(A),"from-yellow-500/20 to-orange-500/20 border-yellow-500/30":j(A)}])},[m("span",TO,[O(A)?(H(),W("span",AO,"")):$(A)?(H(),W("span",xO,"")):j(A)?(H(),W("span",PO,"")):(H(),W("span",SO,"")),qn(" "+we(A),1)])],2))),128))])])):xe("",!0),g.value?(H(),W("div",RO,I[4]||(I[4]=[m("div",{class:"flex items-center space-x-2 p-3 bg-yellow-500/10 rounded-lg border border-yellow-500/20"},[m("div",{class:"text-yellow-400"},""),m("div",{class:"text-yellow-200 text-sm"},"Slection incomplte. Vrifie ci-dessous.")],-1)]))):xe("",!0),m("div",CO,[m("div",kO,[m("div",DO,we(((D=n.event)==null?void 0:D.playerCount)||6),1),I[5]||(I[5]=m("div",{class:"text-xs md:text-sm text-gray-400"}," slectionner",-1))]),m("div",NO,[m("div",VO,we(n.availableCount),1),I[6]||(I[6]=m("div",{class:"text-xs md:text-sm text-gray-400"},"Disponibles",-1))]),m("div",OO,[m("div",MO,we(n.selectedCount),1),I[7]||(I[7]=m("div",{class:"text-xs md:text-sm text-gray-400"},"Slectionns",-1))])]),l.value?(H(),W("div",LO,[m("div",FO,[I[9]||(I[9]=m("div",{class:"text-blue-400 text-xl"},"",-1)),m("div",UO,[m("p",BO,we(u.value),1)]),m("button",{onClick:T,class:"text-blue-400 hover:text-blue-300 transition-colors",title:"Fermer le message"},I[8]||(I[8]=[m("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):xe("",!0)]),m("div",$O,[m("button",{onClick:x,disabled:n.availableCount===0,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex-1 whitespace-nowrap",title:n.availableCount===0?"Aucun joueur disponible":f.value?"Relancer la slection automatique":"Lancer la slection automatique"},I[10]||(I[10]=[qn("  "),m("span",{class:"hidden sm:inline"},"Slection Auto",-1),m("span",{class:"sm:hidden"},"Auto",-1)]),8,jO),f.value?(H(),W("button",{key:0,onClick:R,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex-1 whitespace-nowrap"},I[11]||(I[11]=[qn("  "),m("span",{class:"hidden sm:inline"},"Parfait",-1)]))):xe("",!0),m("button",{onClick:B,disabled:!f.value,class:"h-12 px-3 md:px-4 bg-gray-700 text-white rounded-lg flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed"},I[12]||(I[12]=[qn("  "),m("span",{class:"hidden sm:inline"},"Annoncer",-1)]),8,qO)])])])):xe("",!0),Ut(_O,{show:a.value,event:n.event,message:_.value,"is-partial":d.value,onClose:I[1]||(I[1]=A=>a.value=!1)},null,8,["show","event","message","is-partial"])],64)}}};const GO={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},KO={class:"text-4xl font-bold text-white mb-0 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},HO={class:"w-full px-0 md:px-0 pb-0 pt-[72px] md:pt-[80px] -mt-[72px] md:-mt-[80px] bg-gray-900"},WO={class:"flex items-stretch relative"},QO={class:"flex-1 overflow-hidden"},JO=["onClick"],YO=["title"],XO=["title"],ZO=["title","onClick"],e2=["title","onClick"],t2={class:"table-auto border-separate border-spacing-0 table-fixed w-full min-w-max"},n2=["data-player-id"],r2={class:"p-4 md:p-5 font-medium text-white relative group text-xl md:text-2xl sticky left-0 z-40 bg-gray-900"},s2={class:"font-bold text-xl md:text-2xl whitespace-pre-wrap flex items-center"},i2={key:0,class:"text-yellow-400 mr-1 text-sm",title:"Joueur protg par mot de passe"},o2=["onClick","title"],a2=["onClick"],l2={class:"flex items-center justify-center"},c2=["title"],u2=["title"],d2=["title"],h2=["title"],f2={class:"border-t border-white/10"},p2={class:"p-4 md:p-5 sticky left-0 z-40 bg-gray-900"},m2={class:"flex items-center"},g2={key:0,class:"fixed inset-0 z-[120] flex items-center justify-center bg-gray-950/80 backdrop-blur-sm"},_2={key:1,class:"fixed bottom-4 left-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-2xl border border-green-400/30 backdrop-blur-sm z-50"},y2={class:"flex items-center space-x-2"},v2={key:2,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},w2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},b2={class:"mb-6"},I2={class:"mb-6"},E2={class:"mb-6"},T2={class:"mb-6"},A2={key:3,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},x2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},P2={class:"mb-6"},S2={class:"flex justify-end space-x-3"},R2={key:4,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},C2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},k2={class:"flex justify-end space-x-3"},D2={key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},N2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},V2={class:"flex justify-end space-x-3"},O2={key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[95] p-4"},M2={class:"relative text-center p-6 pb-4 border-b border-white/10"},L2={class:"text-2xl md:text-3xl font-bold text-white mb-1"},F2={class:"text-sm md:text-base text-purple-300"},U2={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},B2={key:0,class:"mb-4 md:mb-6"},$2={class:"text-gray-300 bg-gray-800/50 p-4 rounded-lg border border-gray-600/50"},j2={class:"grid grid-cols-3 gap-3 md:gap-4 mb-2 md:mb-4"},q2={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},z2={class:"text-xl md:text-2xl font-bold text-white"},G2={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},K2={class:"text-xl md:text-2xl font-bold text-white"},H2={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 md:p-4 rounded-lg border border-green-500/30"},W2={class:"text-xl md:text-2xl font-bold text-white"},Q2={class:"hidden md:flex justify-center flex-wrap gap-3 mt-4"},J2={key:1,class:"md:hidden mt-3 space-y-2"},Y2={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},X2={key:8,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},Z2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},eM={class:"mb-6"},tM={class:"mb-6"},nM={class:"mb-6"},rM={class:"mb-6"},sM={key:9,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},iM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},oM={class:"mb-6"},aM={class:"space-y-4"},lM=["disabled"],cM={key:0,class:"animate-spin"},uM={key:1},dM={class:"mb-6 text-center"},hM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},fM={class:"text-red-300 text-sm"},pM={key:10,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[110] p-0 md:p-4"},mM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 shadow-2xl w-full max-w-md rounded-t-2xl md:rounded-2xl flex flex-col max-h-[90vh]"},gM={class:"px-4 pt-3 pb-16 md:px-6 md:pt-4 md:pb-20 overflow-y-auto"},_M={class:"space-y-4"},yM={class:"mt-2 text-center"},vM={key:0,class:"mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},wM={class:"text-red-300 text-sm"},bM={class:"sticky bottom-0 w-full p-3 md:p-4 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2 pb-[env(safe-area-inset-bottom)]"},IM=["disabled"],EM={key:0,class:"animate-spin"},TM={key:1},AM={class:"mb-6"},xM=["disabled"],PM={key:0,class:"animate-spin"},SM={key:1},RM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},CM={class:"text-red-300 text-sm"},kM={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},DM={class:"text-green-300 text-sm"},NM={class:"flex justify-center"},VM={class:"mb-6"},OM=["disabled"],MM={key:0,class:"animate-spin"},LM={key:1},FM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},UM={class:"text-red-300 text-sm"},BM={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},$M={class:"text-green-300 text-sm"},jM={class:"flex justify-center"},qM={__name:"GridBoard",props:{slug:{type:String,required:!0}},setup(n){const e=q(null),t=q(64);go(async()=>{await pr();const P=e.value;t.value=P?P.offsetHeight:64,window.addEventListener("resize",r)}),Ry(()=>{window.removeEventListener("resize",r)});function r(){const P=e.value;t.value=P?P.offsetHeight:64}const s=n,i=Bu(),o=s.slug,a=q(""),l=q(""),u=q(!1),d=q(null),f=q(null),g=q(""),_=q(""),C=q(6),x=q(!1),R=q(""),L=q(null),B=q(!1),$=q(null),j=q(!1),O=q(null),se=q(!1),T=q(null),w=q(""),I=q(!1),S=q(null),k=q(""),D=q(""),A=q(!1),Jt=q(null),qt=q(!1),Ze=q(null),ce=q(""),K=q(""),Se=q(!1),De=q(null),Qe=q(!1),Ve=q(!1),Ye=q(""),hn=q(""),Tn=q(!1),zt=q(!1),z=q(""),me=q(""),ue=q(!1),ie=q(null),Oe=q(""),ze=q(!1),b=q(!1),E=q(null),M=q(null),J=q(new Set),G=q(!0),Z=q(null),fe=q(!1),oe=q(!1),ne=q(0),ee=q(null),Ae=q(null);function ae(){const P=Z.value;if(!P)return;const{scrollLeft:v,scrollWidth:Q,clientWidth:he}=P;fe.value=v>2,oe.value=v<Q-he-2}function Ie(P){L.value=P;const v=document.querySelector(`[data-player-id="${P}"]`);v&&v.scrollIntoView({behavior:"smooth",block:"center"}),ge.value=!0,Re.value="Nouveau joueur ajout !",setTimeout(()=>{ge.value=!1},3e3)}function Ce(P){return J.value.has(P)}async function Pe(){if(l.value)try{const P=await H_(l.value),v=new Set;P.forEach(Q=>{Q.isProtected&&v.add(Q.playerId||Q.id)}),J.value=v}catch{const v=new Set;for(const Q of ft.value)await di(Q.id,l.value)&&v.add(Q.id);J.value=v}}const ge=q(!1),Re=q("");async function Gt(P){await Hs({type:"deleteEvent",data:{eventId:P}})}async function Mt(P=null){const v=P||d.value;if(console.log("deleteEventConfirmed - eventId param:",P),console.log("deleteEventConfirmed - eventToDelete.value:",d.value),console.log("deleteEventConfirmed - eventIdToDelete:",v),console.log("deleteEventConfirmed - type de eventIdToDelete:",typeof v),!v){console.error("Aucun vnement  supprimer");return}try{await FN(v,l.value),ot.value=ot.value.filter(Q=>Q.id!==v),await Promise.all([z_(l.value),xa(ft.value,ot.value,l.value),Pa(l.value)]).then(([Q,he,ye])=>{ot.value=Q,It.value=he,pt.value=ye}),u.value=!1,d.value=null,ge.value=!0,Re.value="vnement supprim avec succs !",setTimeout(()=>{ge.value=!1},3e3)}catch(Q){console.error("Erreur lors de la suppression de l'vnement:",Q),alert("Erreur lors de la suppression de l'vnement. Veuillez ressayer.")}}function An(){u.value=!1,d.value=null}async function St(){if(!f.value||!g.value.trim()||!_.value)return;const P=parseInt(C.value);if(isNaN(P)||P<1||P>20){alert("Le nombre de joueurs doit tre un nombre entier entre 1 et 20");return}try{const v={title:g.value.trim(),date:_.value,description:Oe.value.trim()||"",playerCount:P};await BN(f.value,v,l.value),await da({eventId:f.value,eventData:v,reason:"updated"}),await Promise.all([z_(l.value),xa(ft.value,ot.value,l.value),Pa(l.value)]).then(([Q,he,ye])=>{ot.value=Q,It.value=he,pt.value=ye}),f.value=null,g.value="",_.value="",Oe.value="",C.value=6,ge.value=!0,Re.value="vnement mis  jour avec succs !",setTimeout(()=>{ge.value=!1},3e3)}catch(v){console.error("Erreur lors de l'dition de l'vnement:",v),alert("Erreur lors de l'dition de l'vnement. Veuillez ressayer.")}}async function lr(){if(R.value.trim())try{const P=R.value.trim(),v=await NN(P,l.value);await Promise.all([ch(l.value),xa(ft.value,ot.value,l.value),Pa(l.value)]).then(([Q,he,ye])=>{ft.value=Q,It.value=he,pt.value=ye,Pe();const Ue=ft.value.find(Ge=>Ge.id===v);Ie(v);const Le=document.querySelector(`[data-player-id="${v}"]`);Le&&Le.scrollIntoView({behavior:"smooth",block:"center"}),ge.value=!0,Re.value="Joueur ajout avec succs ! Vous pouvez maintenant indiquer sa disponibilit.",setTimeout(()=>{ge.value=!1},3e3),setTimeout(()=>{ge.value=!1,Re.value=""},5e3)}),x.value=!1,R.value=""}catch(P){console.error("Erreur lors de l'ajout du joueur:",P),alert("Erreur lors de l'ajout du joueur. Veuillez ressayer.")}}function Xn(){f.value=null,g.value="",_.value="",Oe.value="",C.value=6}q(null);const Dt=q(!1),Yt=q(""),Zn=q(""),Er=q(""),ss=q(6);async function Jl(){if(!Yt.value.trim()||!Zn.value){alert("Veuillez remplir le titre et la date de l'vnement");return}const P=parseInt(ss.value);if(isNaN(P)||P<1||P>20){alert("Le nombre de joueurs doit tre un nombre entier entre 1 et 20");return}const v={title:Yt.value.trim(),date:Zn.value,description:Er.value.trim()||"",playerCount:P};await js(v)}async function js(P){try{const v=await UN(P,l.value);ot.value=[...ot.value,{id:v,...P}];const Q={};for(const he of ft.value)Q[he.name]=It.value[he.name]||{},Q[he.name][v]=null,await G_(he.name,Q[he.name],l.value);Yt.value="",Zn.value="",Er.value="",ss.value=6,Dt.value=!1,await Promise.resolve(),ge.value=!0,Re.value="vnement cr avec succs !";try{await da({eventId:v,eventData:P,reason:"created"})}catch(he){console.warn("Envoi des emails partiellement en chec:",he)}setTimeout(()=>{ge.value=!1},3e3)}catch(v){console.error("Erreur lors de la cration de l'vnement:",(v==null?void 0:v.message)||v),alert("Erreur lors de la cration de l'vnement. Veuillez ressayer.")}}function Xo(){Yt.value="",Zn.value="",Er.value="",ss.value=6,Dt.value=!1}async function Zo(){await Hs({type:"addEvent",data:{}})}const ot=q([]),ft=q([]),It=q({}),pt=q({}),qs=q({}),ea=q({});go(async()=>{CN("firebase"),await DN();const P=qw(tt(ve,"seasons"),mC("slug","==",s.slug)),v=await xt(P);if(!v.empty){const he=v.docs[0];l.value=he.id,a.value=he.data().name,document.title=`Saison : ${a.value}`}if(l.value){const[he,ye,Ue,Le,Ge]=await Promise.all([xt(tt(ve,"seasons",l.value,"players")),xt(tt(ve,"seasons",l.value,"events")),xt(tt(ve,"seasons",l.value,"availability")),xt(tt(ve,"seasons",l.value,"selections")),H_(l.value)]);ft.value=he.docs.map(Be=>({id:Be.id,...Be.data()}));const at=new Set;Array.isArray(Ge)&&Ge.forEach(Be=>{Be.isProtected&&at.add(Be.playerId||Be.id)}),J.value=at,ot.value=ye.docs.map(Be=>({id:Be.id,...Be.data(),playerCount:Be.data().playerCount||6}));const Kt={};Ue.docs.forEach(Be=>{const te=Be.data(),$e={};Object.keys(te).forEach(Je=>{const Sr=te[Je];$e[Je]=Sr==="oui"?!0:Sr==="non"?!1:Sr}),Kt[Be.id]=$e}),It.value=Kt;const yt={};Le.docs.forEach(Be=>{yt[Be.id]=Be.data().players||[]}),pt.value=yt}(he=>{typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>he()):setTimeout(he,0)})(()=>{Fi(),sa()}),console.log("players (deduplicated):",ft.value.map(he=>({id:he.id,name:he.name}))),console.log("availability loaded:",It.value),await pr(),G.value=!1,pr(()=>{ae();const he=Z.value;he&&(he.addEventListener("scroll",ye=>{ae(),ne.value=he.scrollLeft||0},{passive:!0}),window.addEventListener("resize",ae))})});function en(P){if(!P)return null;if(P instanceof Date)return P;if(typeof(P==null?void 0:P.toDate)=="function")return P.toDate();if(typeof P=="string"||typeof P=="number"){const v=new Date(P);return isNaN(v.getTime())?null:v}return null}const Yl=Lt(()=>[...ft.value].sort((P,v)=>(P.name||"").localeCompare(v.name||"","fr",{sensitivity:"base"}))),cr=Lt(()=>[...ot.value].sort((P,v)=>{const Q=en(P.date),he=en(v.date),ye=Q?Q.getTime():Number.POSITIVE_INFINITY,Ue=he?he.getTime():Number.POSITIVE_INFINITY;return ye!==Ue?ye-Ue:(P.title||"").localeCompare(v.title||"","fr",{sensitivity:"base"})}));async function zs(P,v){const Q=ft.value.find(Ue=>Ue.name===P);if(!Q){console.error("Joueur non trouv:",P);return}if(!ot.value.find(Ue=>Ue.id===v)){console.error("vnement non trouv:",v);return}if(await di(Q.id,l.value)){Ya(Q.id)?ta(Q,v):await nc({type:"toggleAvailability",data:{player:Q,eventId:v}});return}ta(Q,v)}function ta(P,v){var ye;const Q=(ye=It.value[P.name])==null?void 0:ye[v];console.log(`toggleAvailability - ${P.name} pour ${v}:`,Q);let he;Q===!0?he=!1:Q===!1?he=void 0:he=!0,he===void 0?It.value[P.name]&&delete It.value[P.name][v]:(It.value[P.name]||(It.value[P.name]={}),It.value[P.name][v]=he),G_(P.name,It.value[P.name],l.value).then(()=>{ge.value=!0,Re.value="Disponibilit mise  jour avec succs !",setTimeout(()=>{ge.value=!1},3e3)}).catch(Ue=>{console.error("Erreur lors de la mise  jour de la disponibilit:",Ue),alert("Erreur lors de la mise  jour de la disponibilit. Veuillez ressayer.")})}function Fn(P,v){var Q;return(Q=It.value[P])==null?void 0:Q[v]}function Tr(P,v){var ye;const Q=pt.value[v]||[],he=(ye=It.value[P])==null?void 0:ye[v];return Q.includes(P)&&he===!0}async function wd(P,v=6){const Q=ot.value.find(Le=>Le.id===P),he=(Q==null?void 0:Q.playerCount)||6,ye=pt.value[P]||[];if(ye.length>0&&ye.every(Le=>Fn(Le,P))){console.log("Tous les joueurs slectionns sont disponibles, nouveau tirage complet");const Ge=ft.value.filter(yt=>Fn(yt.name,P)).map(yt=>{const Be=ur(yt.name);return{name:yt.name,weight:1/(1+Be)}}),at=[],Kt=[...Ge];for(;at.length<he&&Kt.length>0;){const yt=Kt.reduce(($e,Je)=>$e+Je.weight,0);let Be=Math.random()*yt;const te=Kt.findIndex($e=>(Be-=$e.weight,Be<=0));te>=0&&(at.push(Kt[te].name),Kt.splice(te,1))}pt.value[P]=at}else{const Le=ye.filter(at=>Fn(at,P)),Ge=he-Le.length;if(Ge<=0)pt.value[P]=Le;else{const at=new Set(Le),yt=ft.value.filter($e=>Fn($e.name,P)&&!at.has($e.name)).map($e=>{const Je=ur($e.name);return{name:$e.name,weight:1/(1+Je)}}),Be=[],te=[...yt];for(;Be.length<Ge&&te.length>0;){const $e=te.reduce((fa,dc)=>fa+dc.weight,0);let Je=Math.random()*$e;const Sr=te.findIndex(fa=>(Je-=fa.weight,Je<=0));Sr>=0&&(Be.push(te[Sr].name),te.splice(Sr,1))}pt.value[P]=[...Le,...Be]}}await LN(P,pt.value[P],l.value),Fi(),sa()}async function Xl(P,v=6){var Le,Ge,at,Kt,yt;console.log("tirerProtected appel avec eventId:",P),console.log("showSelectionModal.value AVANT:",b.value),console.log("selectionModalEvent.value?.id AVANT:",(Le=E.value)==null?void 0:Le.id);const Q=b.value,he=(Ge=E.value)==null?void 0:Ge.id,ye=pt.value[P]&&pt.value[P].length>0,Ue=ye?[...pt.value[P]]:[];if(await wd(P,v),console.log("showSelectionModal.value APRS tirage:",b.value),console.log("selectionModalEvent.value?.id APRS tirage:",(at=E.value)==null?void 0:at.id),Q&&!b.value&&(console.log("Restauration de la popin de slection..."),b.value=!0,E.value=ot.value.find(Be=>Be.id===he)),b.value&&((Kt=E.value)==null?void 0:Kt.id)===P)if(console.log("Popin de slection ouverte, mise  jour..."),await pr(),M.value&&M.value.showSuccess){console.log("Appel de showSuccess sur la popin de slection");const Be=pt.value[P]||[],te=Ue.filter(Je=>Be.includes(Je)),$e=te.length>0&&te.length<Ue.length;M.value.showSuccess(ye,$e)}else console.log("selectionModalRef.value:",M.value),console.log("showSuccess disponible:",(yt=M.value)==null?void 0:yt.showSuccess);else console.log("Popin de slection ferme, affichage message global"),ge.value=!0,ot.value.find(Be=>Be.id===P),pt.value[P],ye?Re.value="Slection mise  jour avec succs !":Re.value="Slection effectue avec succs !",setTimeout(()=>{ge.value=!1},3e3)}function Mi(P){var Q;return P?(typeof P=="string"?new Date(P):((Q=P.toDate)==null?void 0:Q.call(P))||P).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):""}function Li(P){var Q;return P?(typeof P=="string"?new Date(P):((Q=P.toDate)==null?void 0:Q.call(P))||P).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function ur(P){return Object.values(pt.value).filter(v=>v.includes(P)).length}function is(P){const v=It.value[P]||{};return Object.values(v).filter(Q=>Q===!0).length}function Un(P){return P?Object.values(It.value).filter(v=>v[P]===!0).length:0}function na(P){return P?(pt.value[P]||[]).length:0}function Zl(P){const v=is(P),Q=ur(P);return v===0?0:Q/v}function ra(P){qs.value[P]={availability:is(P),selection:ur(P),ratio:Zl(P)}}function Fi(){ft.value.forEach(P=>ra(P.name))}function sa(){const P={};ot.value.forEach(v=>{const Q=v.playerCount||6,ye=ft.value.filter(Le=>Fn(Le.name,v.id)===!0).map(Le=>{const Ge=ur(Le.name);return{name:Le.name,weight:1/(1+Ge)}}),Ue=ye.reduce((Le,Ge)=>Le+Ge.weight,0);ye.forEach(Le=>{const Ge=Math.min(1,Le.weight/Ue*Q);P[Le.name]||(P[Le.name]={}),P[Le.name][v.id]=Math.round(Ge*100)})}),ea.value=P}function Gs(P,v){var Le,Ge;const Q=P.name,he=Fn(Q,v),ye=Tr(Q,v),Ue=((Ge=(Le=ea.value)==null?void 0:Le[Q])==null?void 0:Ge[v])??0;return he===!1?"Non disponible  cliquez pour changer":ye?`Slectionn  Chance estime : ${Ue}%`:he===!0?`Disponible  Chance estime : ${Ue}%`:"Cliquez pour indiquer votre disponibilit"}const Ui=q(null),Ar=q(!1);async function ec(P=null){const v=P||Ui.value;if(!v){console.error("Aucun joueur  supprimer");return}try{await VN(v,l.value),ft.value=ft.value.filter(Q=>Q.id!==v),Ar.value=!1,Ui.value=null,ge.value=!0,Re.value="Joueur supprim avec succs !",setTimeout(()=>{ge.value=!1},3e3)}catch(Q){console.error("Erreur lors de la suppression du joueur :",Q),alert("Erreur lors de la suppression du joueur. Veuillez ressayer.")}}function ia(){Ar.value=!1,Ui.value=null}async function Ks(P){Ws(),await di(P,l.value)?await tc({type:"deletePlayer",data:{playerId:P}}):await Hs({type:"deletePlayer",data:{playerId:P}})}async function xr(){if($.value){const P=ot.value.find(Q=>Q.id===$.value),v=(P==null?void 0:P.playerCount)||6;await Xl($.value,v),B.value=!1,$.value=null}}function oa(){B.value=!1,$.value=null}function bd(){return T.value?{deleteEvent:"Suppression d'vnement - Code PIN requis",addEvent:"Ajout d'vnement - Code PIN requis",deletePlayer:"Suppression de joueur - Code PIN requis",launchSelection:"Lancement de slection - Code PIN requis"}[T.value.type]||"Code PIN requis":"Veuillez saisir le code PIN  4 chiffres"}async function Hs(P){if(Nn.isPinCached(l.value)){const v=Nn.getCachedPin(l.value);if(console.log("PIN en cache trouv, utilisation automatique"),await Eu(l.value,v)){await fn(P);return}else Nn.clearSession()}T.value=P,se.value=!0}async function tc(P){const v=P.data.playerId;if(Ya(v)){console.log("Mot de passe du joueur en cache trouv, utilisation automatique"),await fn(P);return}S.value=P,I.value=!0}async function nc(P){const v=P.data.player.id;if(Ya(v)){console.log("Mot de passe du joueur en cache trouv, utilisation automatique"),await fn(P);return}Ze.value=P,qt.value=!0}async function aa(P){try{if(await Eu(l.value,P)){Nn.saveSession(l.value,P),se.value=!1;const Q=T.value;T.value=null,await fn(Q)}else w.value="Code PIN incorrect",setTimeout(()=>{w.value=""},3e3)}catch(v){console.error("Erreur lors de la vrification du PIN:",v),w.value="Erreur lors de la vrification du code PIN"}}function la(){se.value=!1,T.value=null,w.value=""}async function ca(P){if(P){A.value=!0,k.value="";try{const v=S.value.data.playerId,Q=await Zh(l.value);if(P===Q){try{Tl.saveSession(S.value.data.playerId,P)}catch{}I.value=!1;const ye=S.value;S.value=null,D.value="",await fn(ye);return}if(await Tu(v,P,l.value)){I.value=!1;const ye=S.value;S.value=null,D.value="",await fn(ye)}else k.value="Mot de passe incorrect",setTimeout(()=>{k.value=""},3e3)}catch(v){console.error("Erreur lors de la vrification du mot de passe:",v),k.value="Erreur lors de la vrification du mot de passe"}finally{A.value=!1}}}function rc(){I.value=!1,S.value=null,k.value="",D.value="",A.value=!1}async function sc(P){if(P){Se.value=!0,ce.value="";try{const v=Ze.value.data.player,Q=await Zh(l.value);if(P===Q){try{Tl.saveSession(Ze.value.data.player.id,P)}catch{}qt.value=!1;const ye=Ze.value;Ze.value=null,K.value="",await fn(ye);return}if(await Tu(v.id,P,l.value)){qt.value=!1;const ye=Ze.value;Ze.value=null,K.value="",await fn(ye)}else ce.value="Mot de passe incorrect",setTimeout(()=>{ce.value=""},3e3)}catch(v){console.error("Erreur lors de la vrification du mot de passe:",v),ce.value="Erreur lors de la vrification du mot de passe"}finally{Se.value=!1}}}function Id(){qt.value=!1,Ze.value=null,ce.value="",K.value="",Se.value=!1}async function ic(){Ve.value=!0,Ye.value="",hn.value="";try{const P=Ze.value.data.player,v=await ef(P.id,l.value);hn.value=v.message||"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}catch(P){console.error("Erreur lors de l'envoi de l'email:",P),Ye.value="Erreur lors de l'envoi de l'email. Veuillez ressayer."}finally{Ve.value=!1}}async function oc(){zt.value=!0,z.value="",me.value="";try{const P=S.value.data.playerId,v=await ef(P,l.value);me.value=v.message||"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}catch(P){console.error("Erreur lors de l'envoi de l'email:",P),z.value="Erreur lors de l'envoi de l'email. Veuillez ressayer."}finally{zt.value=!1}}function Ed(){return Nn.isPinCached(l.value)?{timeRemaining:Nn.getTimeRemaining(),isExpiringSoon:Nn.isExpiringSoon()}:null}async function fn(P){if(!P)return;const{type:v,data:Q}=P;try{switch(v){case"deleteEvent":console.log("executePendingOperation - data.eventId:",Q.eventId),console.log("executePendingOperation - type de data.eventId:",typeof Q.eventId),d.value=Q.eventId,u.value=!0;break;case"addEvent":Dt.value=!0;break;case"deletePlayer":Ui.value=Q.playerId,Ar.value=!0;break;case"launchSelection":pt.value[Q.eventId]&&pt.value[Q.eventId].length>0?($.value=Q.eventId,B.value=!0,ue.value=!1):(await Xl(Q.eventId,Q.count),ue.value=!1);break;case"toggleAvailability":ta(Q.player,Q.eventId);break}}catch(he){console.error("Erreur lors de l'excution de l'opration:",he),ge.value=!0,Re.value="Erreur lors de l'opration. Veuillez ressayer.",setTimeout(()=>{ge.value=!1},3e3)}}function er(){i.push("/")}mf(()=>{const P=Z.value;P&&P.removeEventListener("scroll",ae),window.removeEventListener("resize",ae)});function Bi(P){ie.value=P,Oe.value=P.description||"",ue.value=!0}function Pr(){ue.value=!1,ie.value=null,Oe.value="",ze.value=!1}function ua(){f.value=ie.value.id,g.value=ie.value.title,_.value=ie.value.date,Oe.value=ie.value.description||"",C.value=ie.value.playerCount||6,ue.value=!1}function ct(P){O.value=P,j.value=!0}function Ws(){j.value=!1,O.value=null}async function Qs({playerId:P,newName:v}){try{await ON(P,v,l.value),await Promise.all([ch(l.value),xa(ft.value,ot.value,l.value),Pa(l.value)]).then(([Q,he,ye])=>{if(ft.value=Q,It.value=he,pt.value=ye,Pe(),O.value&&O.value.id===P){const Ue=Q.find(Le=>Le.id===P);Ue&&(O.value=Ue)}}),ge.value=!0,Re.value="Joueur mis  jour avec succs !",setTimeout(()=>{ge.value=!1},3e3)}catch(Q){console.error("Erreur lors de l'dition du joueur:",Q),alert("Erreur lors de l'dition du joueur. Veuillez ressayer.")}}async function Js(){try{await Promise.all([ch(l.value),xa(ft.value,ot.value,l.value),Pa(l.value)]).then(([P,v,Q])=>{if(ft.value=P,It.value=v,pt.value=Q,Pe(),O.value){const he=P.find(ye=>ye.id===O.value.id);he&&(O.value=he)}}),ge.value=!0,Re.value="Donnes mises  jour !",setTimeout(()=>{ge.value=!1},3e3)}catch(P){console.error("Erreur lors du rafrachissement:",P)}}function Td(P){if(!P)return{availability:0,selection:0,ratio:0};const v=is(P.name),Q=ur(P.name),he=v===0?0:Math.round(Q/v*100);return{availability:v,selection:Q,ratio:he}}function $i(P){const v=pt.value[P]||[],Q=ot.value.find(Ue=>Ue.id===P),he=(Q==null?void 0:Q.playerCount)||6,ye=Un(P);if(v.length>0){const Ue=v.some(Ge=>!Fn(Ge,P)),Le=ye<he;if(Ue||Le)return{type:"incomplete",hasUnavailablePlayers:Ue,hasInsufficientPlayers:Le,unavailablePlayers:v.filter(Ge=>!Fn(Ge,P)),availableCount:ye,requiredCount:he}}return ye<he?{type:"insufficient",availableCount:ye,requiredCount:he}:v.length===0?{type:"ready",availableCount:ye,requiredCount:he}:{type:"complete",availableCount:ye,requiredCount:he}}function Ad(P){const v=$i(P);return v.type==="incomplete"||v.type==="insufficient"}function ac(P){const v=$i(P);switch(v.type){case"incomplete":return v.hasUnavailablePlayers?v.unavailablePlayers.length===1?`Slection incomplte : ${v.unavailablePlayers[0]} n'est plus disponible`:`Slection incomplte : ${v.unavailablePlayers.length} joueurs ne sont plus disponibles`:`Slection incomplte : ${v.availableCount} joueurs disponibles pour ${v.requiredCount} requis`;case"insufficient":return`Pas assez de joueurs : ${v.availableCount} disponibles pour ${v.requiredCount} requis`;case"ready":return`Prt pour la slection : ${v.availableCount} joueurs disponibles`;case"complete":return`Slection complte : ${v.availableCount} joueurs disponibles`;default:return""}}async function da({eventId:P,eventData:v,reason:Q}){if(!l.value)return;const he={id:P,...v},ye=[];for(const Ue of ft.value){if(!await di(Ue.id,l.value))continue;const Ge=await Gb(Ue.id,l.value);if(Ge)try{const at=await W_({seasonId:l.value,playerId:Ue.id,eventId:he.id,action:"yes"}),Kt=await W_({seasonId:l.value,playerId:Ue.id,eventId:he.id,action:"no"}),yt=`${at.url}&slug=${encodeURIComponent(o)}`,Be=`${Kt.url}&slug=${encodeURIComponent(o)}`;await QN({toEmail:Ge,playerName:Ue.name,eventTitle:he.title,eventDate:Li(he.date),yesUrl:yt,noUrl:Be,reason:Q})}catch(at){console.error("Email non envoy pour",Ue.name,(at==null?void 0:at.message)||at),ye.push(Ue.id)}}ge.value=!0,Re.value=ye.length>0?`Emails envoys (avec ${ye.length} chec(s))`:"Emails envoys aux joueurs protgs.",setTimeout(()=>{ge.value=!1},3e3)}async function lc(P){await da({eventId:P.id,eventData:P,reason:"manual"})}function Ys(P){if(!P)return{};const v={};return ft.value.forEach(Q=>{v[Q.name]=Fn(Q.name,P)}),v}function Bn(P){E.value=P,b.value=!0}function ha(){b.value=!1,E.value=null}async function cc(){if(!E.value)return;const P=E.value.id,v=E.value.playerCount||6;if(Un(P)===0){ge.value=!0,Re.value="Aucun joueur disponible pour cet vnement",setTimeout(()=>{ge.value=!1},3e3);return}await Hs({type:"launchSelection",data:{eventId:P,count:v}})}function uc(){ha(),ge.value=!0,Re.value="Slection valide !",setTimeout(()=>{ge.value=!1},3e3)}return(P,v)=>{var Q,he,ye,Ue,Le,Ge,at,Kt,yt,Be;return H(),W(Nt,null,[m("div",GO,[m("div",{ref_key:"pageHeaderRef",ref:e,class:"sticky top-0 z-[70] text-center py-4 md:py-6 px-4 relative bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900/95 backdrop-blur-sm border-b border-white/10"},[m("button",{onClick:er,class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Retour  l'accueil"},v[38]||(v[38]=[m("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),m("h1",KO,we(a.value?a.value:"Chargement..."),1)],512),m("div",HO,[m("div",{ref_key:"headerBarRef",ref:ee,class:"sticky top-0 z-[80] bg-gray-900 overflow-hidden"},[m("div",WO,[m("div",{class:"col-left flex-shrink-0 p-3 md:p-4 sticky left-0 z-[81] bg-gray-900 h-full"},[m("div",{class:"flex items-center justify-center h-full"},[m("button",{onClick:Zo,class:"flex items-center space-x-2 px-3 py-2 md:px-4 md:py-2 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl text-sm md:text-base font-medium",title:"Ajouter un nouvel vnement"},v[39]||(v[39]=[m("span",{class:"text-lg"},"",-1),m("span",{class:"hidden sm:inline"},"Ajouter un vnement",-1),m("span",{class:"sm:hidden"},"vnement",-1)]))])]),m("div",QO,[m("div",{ref_key:"headerEventsRef",ref:Ae,class:"flex relative z-[60]",style:Cu({transform:`translateX(-${ne.value}px)`})},[(H(!0),W(Nt,null,Mr(cr.value,te=>(H(),W("div",{key:"h-"+te.id,class:"col-event flex-shrink-0 p-3 text-center cursor-pointer",onClick:$e=>Bi(te)},[m("div",{class:"header-date text-[16px] md:text-base text-gray-300",title:Li(te.date)},we(Mi(te.date)),9,YO),m("div",{class:"header-title text-[22px] md:text-2xl leading-snug text-white text-center clamp-2",title:te.title},we(te.title||"Sans titre"),9,XO),Ad(te.id)?(H(),W("div",{key:0,class:"mt-1 w-4 h-4 bg-yellow-500 rounded-full mx-auto flex items-center justify-center hover:bg-yellow-400 transition-colors duration-200",title:ac(te.id)+" - Cliquez pour ouvrir la slection",onClick:Dn($e=>Bn(te),["stop"])},v[40]||(v[40]=[m("span",{class:"text-xs text-white font-bold"},"",-1)]),8,ZO)):$i(te.id).type==="ready"?(H(),W("div",{key:1,class:"mt-1 w-4 h-4 bg-green-500 rounded-full mx-auto flex items-center justify-center hover:bg-green-400 transition-colors duration-200",title:ac(te.id)+" - Cliquez pour ouvrir la slection",onClick:Dn($e=>Bn(te),["stop"])},v[41]||(v[41]=[m("span",{class:"text-xs text-white font-bold"},"",-1)]),8,e2)):xe("",!0)],8,JO))),128))],4)]),v[42]||(v[42]=m("div",{class:"col-right flex-shrink-0 p-3 sticky right-0 z-[81] bg-gray-900 h-full"},null,-1)),gt(m("button",{onClick:v[0]||(v[0]=Dn(te=>P.scrollHeaderBy(-1),["prevent"])),class:"absolute left-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"vnements prcdents  cliquez pour dfiler"},"  ",512),[[Fd,fe.value]]),gt(m("button",{onClick:v[1]||(v[1]=Dn(te=>P.scrollHeaderBy(1),["prevent"])),class:"absolute right-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"vnements suivants  cliquez pour dfiler"},"  ",512),[[Fd,oe.value]])])],512),gt(m("div",{ref_key:"gridboardRef",ref:Z,class:"gridboard overflow-x-auto bg-gradient-to-br from-blue-900/50 via-purple-900/50 to-indigo-900/50"},[m("table",t2,[m("colgroup",null,[v[43]||(v[43]=m("col",{class:"col-left"},null,-1)),(H(!0),W(Nt,null,Mr(cr.value,(te,$e)=>(H(),W("col",{key:"c"+$e,class:"col-event"}))),128)),v[44]||(v[44]=m("col",{class:"col-right"},null,-1))]),v[48]||(v[48]=m("thead",{class:"hidden"},null,-1)),m("tbody",null,[(H(!0),W(Nt,null,Mr(Yl.value,te=>(H(),W("tr",{key:te.id,class:rr(["border-b border-white/10 hover:bg-white/5 transition-all duration-200",{"highlighted-player":te.id===L.value}]),"data-player-id":te.id},[m("td",r2,[m("div",s2,[Ce(te.id)?(H(),W("span",i2,"  ")):xe("",!0),m("span",{onClick:$e=>ct(te),class:"player-name hover:border-b-2 hover:border-dashed hover:border-purple-400 cursor-pointer transition-colors duration-200 text-[22px] md:text-2xl leading-tight",title:"Cliquez pour voir les dtails : "+te.name},we(te.name),9,o2)])]),(H(!0),W(Nt,null,Mr(cr.value,$e=>(H(),W("td",{key:$e.id,class:"p-3 md:p-5 text-center cursor-pointer hover:bg-white/10 transition-all duration-200 min-h-20",onClick:Je=>zs(te.name,$e.id)},[m("div",l2,[Tr(te.name,$e.id)?(H(),W("span",{key:0,class:"text-2xl md:text-3xl hover:scale-110 transition-transform duration-200",title:Gs(te,$e.id)},"  ",8,c2)):Fn(te.name,$e.id)?(H(),W("span",{key:1,class:"text-2xl md:text-3xl hover:scale-110 transition-transform duration-200",title:Gs(te,$e.id)},"  ",8,u2)):Fn(te.name,$e.id)===!1?(H(),W("span",{key:2,class:"text-2xl md:text-3xl hover:scale-110 transition-transform duration-200",title:Gs(te,$e.id)},"  ",8,d2)):(H(),W("span",{key:3,class:"text-gray-500 hover:text-white transition-colors duration-200 text-xl",title:Gs(te,$e.id)},"  ",8,h2))])],8,a2))),128)),v[45]||(v[45]=m("td",{class:"p-3 md:p-4"},null,-1))],10,n2))),128)),m("tr",f2,[m("td",p2,[m("div",m2,[m("button",{onClick:v[2]||(v[2]=te=>x.value=!0),class:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 text-sm md:text-base font-medium",title:"Ajouter un nouveau joueur"},v[46]||(v[46]=[m("span",{class:"text-lg"},"",-1),m("span",{class:"hidden sm:inline"},"Ajouter un joueur",-1),m("span",{class:"sm:hidden"},"Joueur",-1)]))])]),(H(!0),W(Nt,null,Mr(cr.value,te=>(H(),W("td",{key:"add-row-"+te.id,class:"p-3 md:p-5"}))),128)),v[47]||(v[47]=m("td",{class:"p-3 md:p-4"},null,-1))])])])],512),[[Fd,!G.value]])])]),G.value?(H(),W("div",g2,v[49]||(v[49]=[Dr('<div class="text-center"><div class="w-20 h-20 rounded-full bg-gradient-to-br from-pink-500 to-purple-600 animate-pulse mx-auto mb-6 flex items-center justify-center shadow-2xl"><span class="text-3xl"></span></div><p class="text-white text-lg">Prparation de la grille</p><p class="text-white/70 text-sm mt-1">Un instant</p></div>',1)]))):xe("",!0),ge.value?(H(),W("div",_2,[m("div",y2,[v[50]||(v[50]=m("span",{class:"text-xl"},"",-1)),m("span",null,we(Re.value),1)])])):xe("",!0),Dt.value?(H(),W("div",v2,[m("div",w2,[v[55]||(v[55]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Nouvel vnement",-1)),m("div",b2,[v[51]||(v[51]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),gt(m("input",{"onUpdate:modelValue":v[3]||(v[3]=te=>Yt.value=te),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Titre de l'vnement"},null,512),[[Rt,Yt.value]])]),m("div",I2,[v[52]||(v[52]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),gt(m("input",{"onUpdate:modelValue":v[4]||(v[4]=te=>Zn.value=te),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white"},null,512),[[Rt,Zn.value]])]),m("div",E2,[v[53]||(v[53]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),gt(m("textarea",{"onUpdate:modelValue":v[5]||(v[5]=te=>Er.value=te),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'vnement (optionnel)"},null,512),[[Rt,Er.value]])]),m("div",T2,[v[54]||(v[54]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs  slectionner",-1)),gt(m("input",{"onUpdate:modelValue":v[6]||(v[6]=te=>ss.value=te),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",placeholder:"6"},null,512),[[Rt,ss.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Xo,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:Jl,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Crer ")])])])):xe("",!0),x.value?(H(),W("div",A2,[m("div",x2,[v[57]||(v[57]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Nouveau joueur",-1)),m("div",P2,[v[56]||(v[56]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),gt(m("input",{"onUpdate:modelValue":v[7]||(v[7]=te=>R.value=te),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nom du joueur"},null,512),[[Rt,R.value]])]),m("div",S2,[m("button",{onClick:v[8]||(v[8]=te=>x.value=!1),class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:lr,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ajouter ")])])])):xe("",!0),u.value?(H(),W("div",R2,[m("div",C2,[v[58]||(v[58]=Dr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">tes-vous sr de vouloir supprimer cet vnement ?</p></div>',1)),m("div",k2,[m("button",{onClick:An,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:v[9]||(v[9]=()=>Mt()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):xe("",!0),Ar.value?(H(),W("div",D2,[m("div",N2,[v[59]||(v[59]=Dr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">tes-vous sr de vouloir supprimer ce joueur ?</p></div>',1)),m("div",V2,[m("button",{onClick:ia,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),m("button",{onClick:v[10]||(v[10]=()=>ec()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"Supprimer")])])])):xe("",!0),B.value?(H(),W("div",O2,[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},[v[60]||(v[60]=Dr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Attention, toute la slection sera refaite en fonction des disponibilits actuelles.</p></div><p class="mb-6 text-sm text-yellow-400 bg-yellow-900/20 p-3 rounded-lg border border-yellow-500/20">  Pensez  prvenir les gens du changement ! </p>',2)),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:oa,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),m("button",{onClick:xr,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"},"Confirmer")])])])):xe("",!0),ue.value?(H(),W("div",{key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:Pr},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:v[19]||(v[19]=Dn(()=>{},["stop"]))},[m("div",M2,[m("button",{onClick:Pr,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),v[61]||(v[61]=m("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[m("span",{class:"text-2xl md:text-3xl"},"")],-1)),m("h2",L2,we((Q=ie.value)==null?void 0:Q.title),1),m("p",F2,we(Li((he=ie.value)==null?void 0:he.date)),1)]),m("div",U2,[(ye=ie.value)!=null&&ye.description?(H(),W("div",B2,[m("p",$2,we(ie.value.description),1)])):xe("",!0),m("div",j2,[m("div",q2,[m("div",z2,we(Un((Ue=ie.value)==null?void 0:Ue.id)),1),v[62]||(v[62]=m("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibles",-1))]),m("div",G2,[m("div",K2,we(na((Le=ie.value)==null?void 0:Le.id)),1),v[63]||(v[63]=m("div",{class:"text-xs md:text-sm text-gray-300"},"Slectionns",-1))]),m("div",H2,[m("div",W2,we(((Ge=ie.value)==null?void 0:Ge.playerCount)||6),1),v[64]||(v[64]=m("div",{class:"text-xs md:text-sm text-gray-300"}," slectionner",-1))])]),m("div",Q2,[m("button",{onClick:ua,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},v[65]||(v[65]=[m("span",null,"",-1),m("span",null,"Modifier",-1)])),m("button",{onClick:v[11]||(v[11]=te=>lc(ie.value)),class:"px-5 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-lg hover:from-amber-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2",title:"Envoyer un email aux joueurs protgs pour indiquer leur disponibilit"},v[66]||(v[66]=[m("span",null,"",-1),m("span",null,"Relancer",-1)])),m("button",{onClick:v[12]||(v[12]=te=>Bn(ie.value)),class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center gap-2",title:"Grer la slection"},v[67]||(v[67]=[m("span",null,"",-1),m("span",null,"Slection",-1)])),m("button",{onClick:v[13]||(v[13]=te=>{var $e;return Gt(($e=ie.value)==null?void 0:$e.id)}),class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},v[68]||(v[68]=[m("span",null,"",-1),m("span",null,"Supprimer",-1)])),m("button",{onClick:Pr,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer")]),ze.value?(H(),W("div",J2,[m("button",{onClick:v[14]||(v[14]=te=>{ua(),ze.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"}," Modifier"),m("button",{onClick:v[15]||(v[15]=te=>{lc(ie.value),ze.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-amber-600/20 text-amber-200 border border-amber-500/30"}," Relancer"),m("button",{onClick:v[16]||(v[16]=te=>{var $e;Gt(($e=ie.value)==null?void 0:$e.id),ze.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"}," Supprimer")])):xe("",!0)]),m("div",Y2,[m("button",{onClick:v[17]||(v[17]=te=>Bn(ie.value)),class:"h-12 px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex-[1.4]"}," Slection"),m("button",{onClick:Pr,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"},"Fermer"),m("button",{onClick:v[18]||(v[18]=te=>ze.value=!ze.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"},"")])])])):xe("",!0),f.value?(H(),W("div",X2,[m("div",Z2,[v[73]||(v[73]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Modifier l'vnement",-1)),m("div",eM,[v[69]||(v[69]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),gt(m("input",{"onUpdate:modelValue":v[20]||(v[20]=te=>g.value=te),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Pn(Xn,["esc"]),Pn(St,["enter"])],ref:"editTitleInput"},null,544),[[Rt,g.value]])]),m("div",tM,[v[70]||(v[70]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),gt(m("input",{"onUpdate:modelValue":v[21]||(v[21]=te=>_.value=te),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:[Pn(Xn,["esc"]),Pn(St,["enter"])]},null,544),[[Rt,_.value]])]),m("div",nM,[v[71]||(v[71]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),gt(m("textarea",{"onUpdate:modelValue":v[22]||(v[22]=te=>Oe.value=te),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'vnement (optionnel)",onKeydown:Pn(Xn,["esc"])},null,544),[[Rt,Oe.value]])]),m("div",rM,[v[72]||(v[72]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs  slectionner",-1)),gt(m("input",{"onUpdate:modelValue":v[23]||(v[23]=te=>C.value=te),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:Pn(Xn,["esc"])},null,544),[[Rt,C.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Xn,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:St,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):xe("",!0),Ut(qb,{show:se.value,message:bd(),error:w.value,"session-info":Ed(),onSubmit:aa,onCancel:la},null,8,["show","message","error","session-info"]),I.value?(H(),W("div",sM,[m("div",iM,[v[75]||(v[75]=Dr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Vrification requise</h2><p class="text-lg text-gray-300">Suppression de joueur protg</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protg par mot de passe</p></div>',1)),m("div",oM,[m("div",aM,[m("div",null,[v[74]||(v[74]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),gt(m("input",{"onUpdate:modelValue":v[24]||(v[24]=te=>D.value=te),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:v[25]||(v[25]=Pn(te=>ca(D.value),["enter"])),ref_key:"playerPasswordInputRef",ref:Jt},null,544),[[Rt,D.value]])])]),m("button",{onClick:v[26]||(v[26]=te=>ca(D.value)),disabled:!D.value||A.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[A.value?(H(),W("span",cM,"")):(H(),W("span",uM,"")),m("span",null,we(A.value?"Vrification...":"Vrifier et supprimer"),1)],8,lM)]),m("div",dM,[m("button",{onClick:v[27]||(v[27]=te=>Tn.value=!0),class:"text-sm text-red-400 hover:text-red-300 transition-colors underline"}," Mot de passe oubli ? ")]),k.value?(H(),W("div",hM,[m("div",fM,we(k.value),1)])):xe("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:rc,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):xe("",!0),qt.value?(H(),W("div",pM,[m("div",mM,[v[78]||(v[78]=Dr('<div class="text-center p-6 pb-4 border-b border-white/10"><div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-1">Vrification requise</h2><p class="text-base text-gray-300">Modification de disponibilit</p><p class="text-sm text-gray-400 mt-1">Ce joueur est protg par mot de passe</p></div>',1)),m("div",gM,[m("div",_M,[m("div",null,[v[76]||(v[76]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),gt(m("input",{"onUpdate:modelValue":v[28]||(v[28]=te=>K.value=te),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:v[29]||(v[29]=Pn(te=>sc(K.value),["enter"])),ref_key:"availabilityPasswordInputRef",ref:De},null,544),[[Rt,K.value]])])]),m("div",yM,[m("button",{onClick:v[30]||(v[30]=te=>Qe.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oubli ? ")]),ce.value?(H(),W("div",vM,[m("div",wM,we(ce.value),1)])):xe("",!0)]),m("div",bM,[m("button",{onClick:Id,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300 flex-1 text-sm md:text-base whitespace-nowrap"}," Annuler "),m("button",{onClick:v[31]||(v[31]=te=>sc(K.value)),disabled:!K.value||Se.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 flex-1 text-sm md:text-base whitespace-nowrap"},[Se.value?(H(),W("span",EM,"")):(H(),W("span",TM,"")),m("span",null,[qn(we(Se.value?"Vrification...":"Vrifier"),1),v[77]||(v[77]=m("span",{class:"hidden sm:inline"}," et modifier",-1))])],8,IM)])])])):xe("",!0),Qe.value?(H(),W("div",{key:11,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:v[34]||(v[34]=te=>Qe.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:v[33]||(v[33]=Dn(()=>{},["stop"]))},[v[80]||(v[80]=Dr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oubli</h2><p class="text-lg text-gray-300">Modification de disponibilit</p></div>',1)),m("div",AM,[v[79]||(v[79]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de rinitialisation sera envoy  l'adresse associe  ce joueur. ",-1)),m("button",{onClick:ic,disabled:Ve.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Ve.value?(H(),W("span",PM,"")):(H(),W("span",SM,"")),m("span",null,we(Ve.value?"Envoi...":"Envoyer l'email"),1)],8,xM)]),Ye.value?(H(),W("div",RM,[m("div",CM,we(Ye.value),1)])):xe("",!0),hn.value?(H(),W("div",kM,[m("div",DM,we(hn.value),1)])):xe("",!0),m("div",NM,[m("button",{onClick:v[32]||(v[32]=te=>Qe.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):xe("",!0),Tn.value?(H(),W("div",{key:12,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:v[37]||(v[37]=te=>Tn.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:v[36]||(v[36]=Dn(()=>{},["stop"]))},[v[82]||(v[82]=Dr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oubli</h2><p class="text-lg text-gray-300">Suppression de joueur protg</p></div>',1)),m("div",VM,[v[81]||(v[81]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de rinitialisation sera envoy  l'adresse associe  ce joueur. ",-1)),m("button",{onClick:oc,disabled:zt.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[zt.value?(H(),W("span",MM,"")):(H(),W("span",LM,"")),m("span",null,we(zt.value?"Envoi...":"Envoyer l'email"),1)],8,OM)]),z.value?(H(),W("div",FM,[m("div",UM,we(z.value),1)])):xe("",!0),me.value?(H(),W("div",BM,[m("div",$M,we(me.value),1)])):xe("",!0),m("div",jM,[m("button",{onClick:v[35]||(v[35]=te=>Tn.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):xe("",!0),Ut(iO,{show:j.value,player:O.value,stats:Td(O.value),seasonId:l.value,onClose:Ws,onUpdate:Qs,onDelete:Ks,onRefresh:Js},null,8,["show","player","stats","seasonId"]),Ut(zO,{ref_key:"selectionModalRef",ref:M,show:b.value,event:E.value,"current-selection":pt.value[(at=E.value)==null?void 0:at.id]||[],"available-count":Un((Kt=E.value)==null?void 0:Kt.id),"selected-count":na((yt=E.value)==null?void 0:yt.id),"player-availability":Ys((Be=E.value)==null?void 0:Be.id),onClose:ha,onSelection:cc,onPerfect:uc},null,8,["show","event","current-selection","available-count","selected-count","player-availability"])],64)}}},zM={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},GM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},KM={key:0,class:"text-center py-8"},HM={key:1,class:"text-center py-8"},WM={class:"text-gray-300 mb-6"},QM={key:2,class:"space-y-6"},JM={class:"text-center"},YM={class:"text-gray-300"},XM={class:"font-semibold text-white"},ZM={class:"space-y-4"},eL=["disabled"],tL={key:0,class:"animate-spin"},nL={key:1},rL={key:0,class:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},sL={class:"text-red-300 text-sm"},iL={key:1,class:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},oL={class:"text-green-300 text-sm"},aL={__name:"PasswordReset",setup(n){const e=fv(),t=Bu(),r=q(!0),s=q(""),i=q(""),o=q(""),a=q(""),l=q(""),u=q(!1),d=q(""),f=q(""),g=Lt(()=>a.value&&l.value&&a.value===l.value&&a.value.length>=6);go(async()=>{try{const{oobCode:x}=e.query;if(console.log(" [DEBUG] Token reu:",x),!x){s.value="Lien de rinitialisation incomplet",r.value=!1;return}o.value=x,i.value="patrice.lamarque+ron@gmail.com",r.value=!1}catch(x){console.error("Erreur lors de la vrification du lien:",x),s.value="Erreur lors de la vrification du lien",r.value=!1}});async function _(){if(g.value){u.value=!0,d.value="",f.value="";try{console.log(" [DEBUG] Dbut rinitialisation avec token:",o.value),await j1(Oi,o.value,a.value),console.log(" [DEBUG] Mot de passe Firebase Auth mis  jour"),console.log(" [DEBUG] Rinitialisation termine avec Firebase Auth"),f.value="Mot de passe rinitialis avec succs ! Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.",setTimeout(()=>{C()},3e3)}catch(x){console.error(" [ERROR] Erreur lors de la rinitialisation:",x),x.code==="auth/weak-password"?d.value="Le mot de passe doit contenir au moins 6 caractres":x.code==="auth/invalid-action-code"?d.value="Lien de rinitialisation invalide ou expir":d.value="Erreur lors de la rinitialisation. Veuillez ressayer."}finally{u.value=!1}}}function C(){t.push("/")}return(x,R)=>(H(),W("div",zM,[m("div",GM,[R[8]||(R[8]=Dr('<div class="text-center mb-6"><div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-3xl"></span></div><h1 class="text-3xl font-bold text-white mb-2">Rinitialisation</h1><p class="text-lg text-gray-300">Nouveau mot de passe</p></div>',1)),r.value?(H(),W("div",KM,R[2]||(R[2]=[m("div",{class:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),m("p",{class:"text-gray-300"},"Vrification du lien...",-1)]))):s.value?(H(),W("div",HM,[R[3]||(R[3]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"")],-1)),R[4]||(R[4]=m("h2",{class:"text-xl font-bold text-white mb-2"},"Lien invalide",-1)),m("p",WM,we(s.value),1),m("button",{onClick:C,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300"}," Retour  l'accueil ")])):i.value?(H(),W("div",QM,[m("div",JM,[m("p",YM,[R[5]||(R[5]=qn("Email : ")),m("span",XM,we(i.value),1)])]),m("div",ZM,[m("div",null,[R[6]||(R[6]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nouveau mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":R[0]||(R[0]=L=>a.value=L),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nouveau mot de passe",onKeydown:Pn(_,["enter"])},null,544),[[Rt,a.value]])]),m("div",null,[R[7]||(R[7]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),gt(m("input",{"onUpdate:modelValue":R[1]||(R[1]=L=>l.value=L),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe",onKeydown:Pn(_,["enter"])},null,544),[[Rt,l.value]])])]),m("button",{onClick:_,disabled:!g.value||u.value,class:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[u.value?(H(),W("span",tL,"")):(H(),W("span",nL,"")),m("span",null,we(u.value?"Rinitialisation...":"Rinitialiser le mot de passe"),1)],8,eL),d.value?(H(),W("div",rL,[m("div",sL,we(d.value),1)])):xe("",!0),f.value?(H(),W("div",iL,[m("div",oL,we(f.value),1)])):xe("",!0)])):xe("",!0)])]))}},lL={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},cL={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center"},uL={class:"text-3xl"},dL={class:"text-2xl font-bold text-white mb-2"},hL={class:"text-gray-300 mb-6"},fL={__name:"MagicLink",setup(n){const e=fv(),t=Bu(),r=q("loading"),s=q("Traitement en cours..."),i=q("Merci de patienter pendant la validation du lien."),o=Lt(()=>r.value==="loading"?"":r.value==="ok"?"":"");function a(){const l=e.query.slug;l?t.push(`/season/${l}`):t.push("/")}return go(async()=>{try{const l=String(e.query.sid||""),u=String(e.query.pid||""),d=String(e.query.eid||""),f=String(e.query.t||""),g=String(e.query.a||""),_=String(e.query.slug||"");if(!l||!u||!d||!f||!g){r.value="error",s.value="Lien invalide",i.value="Paramtres manquants.";return}if(!(await HN({seasonId:l,playerId:u,eventId:d,token:f,action:g})).valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expir.";return}const x=Me(ve,"seasons",l,"players",u),R=await Di(x),L=R.exists()&&R.data().name||"";if(!L){r.value="error",s.value="Lien invalide",i.value="Joueur introuvable.";return}await MN({seasonId:l,playerName:L,eventId:d,value:g==="yes"}),await WN({seasonId:l,playerId:u,eventId:d}),r.value="ok",s.value="Merci !",i.value=g==="yes"?"Votre disponibilit a t enregistre: Disponible.":"Votre disponibilit a t enregistre: Non disponible.",setTimeout(()=>a(),2e3)}catch(l){console.error("Magic link error:",l),r.value="error",s.value="Erreur",i.value="Impossible de traiter votre lien."}}),(l,u)=>(H(),W("div",lL,[m("div",cL,[m("div",{class:rr(["w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center",r.value==="ok"?"bg-green-500":r.value==="loading"?"bg-blue-500":"bg-red-500"])},[m("span",uL,we(o.value),1)],2),m("h1",dL,we(s.value),1),m("p",hL,we(i.value),1),m("button",{onClick:a,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ouvrir la saison ")])]))}},pL=[{path:"/",component:RN},{path:"/season/:slug",component:qM,props:!0},{path:"/reset-password",component:aL},{path:"/magic",component:fL}],mL=mA({history:zT("/impro-selector/"),routes:pL});uT(fT).use(mL).mount("#app");export{tt as $,Hw as A,Ai as B,wr as C,jt as D,wF as E,Si as F,dp as G,vF as H,wL as I,Jn as J,sC as K,oC as L,Ww as M,KL as N,HL as O,DC as P,dn as Q,LL as R,AL as S,Ct as T,dF as U,rd as V,CC as W,uF as X,GL as Y,SL as Z,Mv as _,pl as a,Kl as a$,EL as a0,iC as a1,yC as a2,yF as a3,_l as a4,cF as a5,kL as a6,_F as a7,Me as a8,OL as a9,VL as aA,ZL as aB,eF as aC,ML as aD,gC as aE,iF as aF,oF as aG,SC as aH,qw as aI,Dw as aJ,TL as aK,lF as aL,Ip as aM,Rn as aN,pF as aO,gL as aP,WL as aQ,$L as aR,BL as aS,zL as aT,DL as aU,wC as aV,fF as aW,RL as aX,mC as aY,Qw as aZ,xF as a_,lC as aa,PL as ab,CL as ac,gF as ad,qL as ae,jL as af,kt as ag,jl as ah,bC as ai,tF as aj,Di as ak,QL as al,JL as am,xt as an,YL as ao,XL as ap,aC as aq,mF as ar,hF as as,xL as at,FL as au,UL as av,NL as aw,nF as ax,sF as ay,rF as az,cC as b,L1 as b$,Gl as b0,SF as b1,bl as b2,Ni as b3,gs as b4,IF as b5,ys as b6,_s as b7,Qr as b8,Kc as b9,GC as bA,ZF as bB,h4 as bC,R_ as bD,bk as bE,h1 as bF,GF as bG,MF as bH,F1 as bI,r4 as bJ,l4 as bK,d4 as bL,e4 as bM,HF as bN,ek as bO,CF as bP,VC as bQ,U1 as bR,s4 as bS,a4 as bT,u4 as bU,WC as bV,YF as bW,UF as bX,$1 as bY,OF as bZ,zF as b_,AF as ba,mi as bb,po as bc,TD as bd,EF as be,t4 as bf,Yh as bg,TF as bh,AD as bi,qp as bj,vs as bk,NF as bl,tk as bm,ck as bn,ED as bo,Cb as bp,q1 as bq,j1 as br,p1 as bs,z1 as bt,PF as bu,XF as bv,FF as bw,qF as bx,DD as by,RF as bz,Oo as c,Dp as c0,DF as c1,G1 as c2,LF as c3,n4 as c4,o4 as c5,c4 as c6,JF as c7,kF as c8,QF as c9,jF as ca,W1 as cb,i4 as cc,$F as cd,WF as ce,KF as cf,BF as cg,VF as ch,Ri as d,ht as e,X as f,Wo as g,Bl as h,qc as i,ud as j,$l as k,ld as l,wp as m,Mo as n,cd as o,ci as p,kC as q,Vt as r,_i as s,pe as t,yL as u,Yx as v,Tt as w,bF as x,qe as y,_L as z};
