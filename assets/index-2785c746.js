(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Ip(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const wt={},da=[],Vr=()=>{},KE=()=>!1,zd=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Ep=n=>n.startsWith("onUpdate:"),In=Object.assign,Tp=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},HE=Object.prototype.hasOwnProperty,pt=(n,e)=>HE.call(n,e),Me=Array.isArray,ha=n=>Nu(n)==="[object Map]",Ga=n=>Nu(n)==="[object Set]",Rg=n=>Nu(n)==="[object Date]",Ge=n=>typeof n=="function",nn=n=>typeof n=="string",Xr=n=>typeof n=="symbol",At=n=>n!==null&&typeof n=="object",I_=n=>(At(n)||Ge(n))&&Ge(n.then)&&Ge(n.catch),E_=Object.prototype.toString,Nu=n=>E_.call(n),WE=n=>Nu(n).slice(8,-1),T_=n=>Nu(n)==="[object Object]",xp=n=>nn(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,zl=Ip(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gd=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},QE=/-(\w)/g,Ir=Gd(n=>n.replace(QE,(e,t)=>t?t.toUpperCase():"")),JE=/\B([A-Z])/g,Ri=Gd(n=>n.replace(JE,"-$1").toLowerCase()),Kd=Gd(n=>n.charAt(0).toUpperCase()+n.slice(1)),Wh=Gd(n=>n?`on${Kd(n)}`:""),di=(n,e)=>!Object.is(n,e),Gc=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Af=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},hd=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let Cg;const Hd=()=>Cg||(Cg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ds(n){if(Me(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=nn(r)?eT(r):ds(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(nn(n)||At(n))return n}const YE=/;(?![^(]*\))/g,XE=/:([^]+)/,ZE=/\/\*[^]*?\*\//g;function eT(n){const e={};return n.replace(ZE,"").split(YE).forEach(t=>{if(t){const r=t.split(XE);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function zt(n){let e="";if(nn(n))e=n;else if(Me(n))for(let t=0;t<n.length;t++){const r=zt(n[t]);r&&(e+=r+" ")}else if(At(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const tT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",nT=Ip(tT);function x_(n){return!!n||n===""}function rT(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=Ou(n[r],e[r]);return t}function Ou(n,e){if(n===e)return!0;let t=Rg(n),r=Rg(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=Xr(n),r=Xr(e),t||r)return n===e;if(t=Me(n),r=Me(e),t||r)return t&&r?rT(n,e):!1;if(t=At(n),r=At(e),t||r){if(!t||!r)return!1;const s=Object.keys(n).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Ou(n[o],e[o]))return!1}}return String(n)===String(e)}function Ap(n,e){return n.findIndex(t=>Ou(t,e))}const A_=n=>!!(n&&n.__v_isRef===!0),ue=n=>nn(n)?n:n==null?"":Me(n)||At(n)&&(n.toString===E_||!Ge(n.toString))?A_(n)?ue(n.value):JSON.stringify(n,S_,2):String(n),S_=(n,e)=>A_(e)?S_(n,e.value):ha(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[Qh(r,i)+" =>"]=s,t),{})}:Ga(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Qh(t))}:Xr(e)?Qh(e):At(e)&&!Me(e)&&!T_(e)?String(e):e,Qh=(n,e="")=>{var t;return Xr(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let tr;class sT{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=tr,!e&&tr&&(this.index=(tr.scopes||(tr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=tr;try{return tr=this,e()}finally{tr=t}}}on(){++this._on===1&&(this.prevScope=tr,tr=this)}off(){this._on>0&&--this._on===0&&(tr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function iT(){return tr}let Tt;const Jh=new WeakSet;class P_{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,tr&&tr.active&&tr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Jh.has(this)&&(Jh.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||C_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,kg(this),k_(this);const e=Tt,t=Nr;Tt=this,Nr=!0;try{return this.fn()}finally{D_(this),Tt=e,Nr=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Rp(e);this.deps=this.depsTail=void 0,kg(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Jh.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Sf(this)&&this.run()}get dirty(){return Sf(this)}}let R_=0,Gl,Kl;function C_(n,e=!1){if(n.flags|=8,e){n.next=Kl,Kl=n;return}n.next=Gl,Gl=n}function Sp(){R_++}function Pp(){if(--R_>0)return;if(Kl){let e=Kl;for(Kl=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Gl;){let e=Gl;for(Gl=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function k_(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function D_(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),Rp(r),oT(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function Sf(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(V_(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function V_(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ou)||(n.globalVersion=ou,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Sf(n))))return;n.flags|=2;const e=n.dep,t=Tt,r=Nr;Tt=n,Nr=!0;try{k_(n);const s=n.fn(n._value);(e.version===0||di(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{Tt=t,Nr=r,D_(n),n.flags&=-3}}function Rp(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Rp(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function oT(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let Nr=!0;const N_=[];function ws(){N_.push(Nr),Nr=!1}function Is(){const n=N_.pop();Nr=n===void 0?!0:n}function kg(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Tt;Tt=void 0;try{e()}finally{Tt=t}}}let ou=0;class aT{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Cp{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Tt||!Nr||Tt===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Tt)t=this.activeLink=new aT(Tt,this),Tt.deps?(t.prevDep=Tt.depsTail,Tt.depsTail.nextDep=t,Tt.depsTail=t):Tt.deps=Tt.depsTail=t,O_(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Tt.depsTail,t.nextDep=void 0,Tt.depsTail.nextDep=t,Tt.depsTail=t,Tt.deps===t&&(Tt.deps=r)}return t}trigger(e){this.version++,ou++,this.notify(e)}notify(e){Sp();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Pp()}}}function O_(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)O_(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Pf=new WeakMap,ho=Symbol(""),Rf=Symbol(""),au=Symbol("");function Ln(n,e,t){if(Nr&&Tt){let r=Pf.get(n);r||Pf.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new Cp),s.map=r,s.key=t),s.track()}}function hs(n,e,t,r,s,i){const o=Pf.get(n);if(!o){ou++;return}const a=l=>{l&&l.trigger()};if(Sp(),e==="clear")o.forEach(a);else{const l=Me(n),c=l&&xp(t);if(l&&t==="length"){const d=Number(r);o.forEach((f,g)=>{(g==="length"||g===au||!Xr(g)&&g>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(au)),e){case"add":l?c&&a(o.get("length")):(a(o.get(ho)),ha(n)&&a(o.get(Rf)));break;case"delete":l||(a(o.get(ho)),ha(n)&&a(o.get(Rf)));break;case"set":ha(n)&&a(o.get(ho));break}}Pp()}function Zo(n){const e=ft(n);return e===n?e:(Ln(e,"iterate",au),wr(n)?e:e.map(An))}function Wd(n){return Ln(n=ft(n),"iterate",au),n}const lT={__proto__:null,[Symbol.iterator](){return Yh(this,Symbol.iterator,An)},concat(...n){return Zo(this).concat(...n.map(e=>Me(e)?Zo(e):e))},entries(){return Yh(this,"entries",n=>(n[1]=An(n[1]),n))},every(n,e){return ls(this,"every",n,e,void 0,arguments)},filter(n,e){return ls(this,"filter",n,e,t=>t.map(An),arguments)},find(n,e){return ls(this,"find",n,e,An,arguments)},findIndex(n,e){return ls(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return ls(this,"findLast",n,e,An,arguments)},findLastIndex(n,e){return ls(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return ls(this,"forEach",n,e,void 0,arguments)},includes(...n){return Xh(this,"includes",n)},indexOf(...n){return Xh(this,"indexOf",n)},join(n){return Zo(this).join(n)},lastIndexOf(...n){return Xh(this,"lastIndexOf",n)},map(n,e){return ls(this,"map",n,e,void 0,arguments)},pop(){return xl(this,"pop")},push(...n){return xl(this,"push",n)},reduce(n,...e){return Dg(this,"reduce",n,e)},reduceRight(n,...e){return Dg(this,"reduceRight",n,e)},shift(){return xl(this,"shift")},some(n,e){return ls(this,"some",n,e,void 0,arguments)},splice(...n){return xl(this,"splice",n)},toReversed(){return Zo(this).toReversed()},toSorted(n){return Zo(this).toSorted(n)},toSpliced(...n){return Zo(this).toSpliced(...n)},unshift(...n){return xl(this,"unshift",n)},values(){return Yh(this,"values",An)}};function Yh(n,e,t){const r=Wd(n),s=r[e]();return r!==n&&!wr(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const uT=Array.prototype;function ls(n,e,t,r,s,i){const o=Wd(n),a=o!==n&&!wr(n),l=o[e];if(l!==uT[e]){const f=l.apply(n,i);return a?An(f):f}let c=t;o!==n&&(a?c=function(f,g){return t.call(this,An(f),g,n)}:t.length>2&&(c=function(f,g){return t.call(this,f,g,n)}));const d=l.call(o,c,r);return a&&s?s(d):d}function Dg(n,e,t,r){const s=Wd(n);let i=t;return s!==n&&(wr(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,An(a),l,n)}),s[e](i,...r)}function Xh(n,e,t){const r=ft(n);Ln(r,"iterate",au);const s=r[e](...t);return(s===-1||s===!1)&&Vp(t[0])?(t[0]=ft(t[0]),r[e](...t)):s}function xl(n,e,t=[]){ws(),Sp();const r=ft(n)[e].apply(n,t);return Pp(),Is(),r}const cT=Ip("__proto__,__v_isRef,__isVue"),M_=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Xr));function dT(n){Xr(n)||(n=String(n));const e=ft(this);return Ln(e,"has",n),e.hasOwnProperty(n)}class L_{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?wT:j_:i?U_:$_).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Me(e);if(!s){let l;if(o&&(l=lT[t]))return l;if(t==="hasOwnProperty")return dT}const a=Reflect.get(e,t,Un(e)?e:r);return(Xr(t)?M_.has(t):cT(t))||(s||Ln(e,"get",t),i)?a:Un(a)?o&&xp(t)?a:a.value:At(a)?s?q_(a):Qd(a):a}}class F_ extends L_{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=yi(i);if(!wr(r)&&!yi(r)&&(i=ft(i),r=ft(r)),!Me(e)&&Un(i)&&!Un(r))return l?!1:(i.value=r,!0)}const o=Me(e)&&xp(t)?Number(t)<e.length:pt(e,t),a=Reflect.set(e,t,r,Un(e)?e:s);return e===ft(s)&&(o?di(r,i)&&hs(e,"set",t,r):hs(e,"add",t,r)),a}deleteProperty(e,t){const r=pt(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&hs(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!Xr(t)||!M_.has(t))&&Ln(e,"has",t),r}ownKeys(e){return Ln(e,"iterate",Me(e)?"length":ho),Reflect.ownKeys(e)}}class hT extends L_{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const fT=new F_,pT=new hT,mT=new F_(!0);const Cf=n=>n,kc=n=>Reflect.getPrototypeOf(n);function gT(n,e,t){return function(...r){const s=this.__v_raw,i=ft(s),o=ha(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),d=t?Cf:e?fd:An;return!e&&Ln(i,"iterate",l?Rf:ho),{next(){const{value:f,done:g}=c.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function Dc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function vT(n,e){const t={get(s){const i=this.__v_raw,o=ft(i),a=ft(s);n||(di(s,a)&&Ln(o,"get",s),Ln(o,"get",a));const{has:l}=kc(o),c=e?Cf:n?fd:An;if(l.call(o,s))return c(i.get(s));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&Ln(ft(s),"iterate",ho),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=ft(i),a=ft(s);return n||(di(s,a)&&Ln(o,"has",s),Ln(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=ft(a),c=e?Cf:n?fd:An;return!n&&Ln(l,"iterate",ho),a.forEach((d,f)=>s.call(i,c(d),c(f),o))}};return In(t,n?{add:Dc("add"),set:Dc("set"),delete:Dc("delete"),clear:Dc("clear")}:{add(s){!e&&!wr(s)&&!yi(s)&&(s=ft(s));const i=ft(this);return kc(i).has.call(i,s)||(i.add(s),hs(i,"add",s,s)),this},set(s,i){!e&&!wr(i)&&!yi(i)&&(i=ft(i));const o=ft(this),{has:a,get:l}=kc(o);let c=a.call(o,s);c||(s=ft(s),c=a.call(o,s));const d=l.call(o,s);return o.set(s,i),c?di(i,d)&&hs(o,"set",s,i):hs(o,"add",s,i),this},delete(s){const i=ft(this),{has:o,get:a}=kc(i);let l=o.call(i,s);l||(s=ft(s),l=o.call(i,s)),a&&a.call(i,s);const c=i.delete(s);return l&&hs(i,"delete",s,void 0),c},clear(){const s=ft(this),i=s.size!==0,o=s.clear();return i&&hs(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=gT(s,n,e)}),t}function kp(n,e){const t=vT(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(pt(t,s)&&s in r?t:r,s,i)}const yT={get:kp(!1,!1)},_T={get:kp(!1,!0)},bT={get:kp(!0,!1)};const $_=new WeakMap,U_=new WeakMap,j_=new WeakMap,wT=new WeakMap;function IT(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ET(n){return n.__v_skip||!Object.isExtensible(n)?0:IT(WE(n))}function Qd(n){return yi(n)?n:Dp(n,!1,fT,yT,$_)}function B_(n){return Dp(n,!1,mT,_T,U_)}function q_(n){return Dp(n,!0,pT,bT,j_)}function Dp(n,e,t,r,s){if(!At(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=ET(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function fa(n){return yi(n)?fa(n.__v_raw):!!(n&&n.__v_isReactive)}function yi(n){return!!(n&&n.__v_isReadonly)}function wr(n){return!!(n&&n.__v_isShallow)}function Vp(n){return n?!!n.__v_raw:!1}function ft(n){const e=n&&n.__v_raw;return e?ft(e):n}function TT(n){return!pt(n,"__v_skip")&&Object.isExtensible(n)&&Af(n,"__v_skip",!0),n}const An=n=>At(n)?Qd(n):n,fd=n=>At(n)?q_(n):n;function Un(n){return n?n.__v_isRef===!0:!1}function O(n){return z_(n,!1)}function xT(n){return z_(n,!0)}function z_(n,e){return Un(n)?n:new AT(n,e)}class AT{constructor(e,t){this.dep=new Cp,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:ft(e),this._value=t?e:An(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||wr(e)||yi(e);e=r?e:ft(e),di(e,t)&&(this._rawValue=e,this._value=r?e:An(e),this.dep.trigger())}}function ys(n){return Un(n)?n.value:n}const ST={get:(n,e,t)=>e==="__v_raw"?n:ys(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return Un(s)&&!Un(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function G_(n){return fa(n)?n:new Proxy(n,ST)}class PT{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Cp(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ou-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Tt!==this)return C_(this,!0),!0}get value(){const e=this.dep.track();return V_(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function RT(n,e,t=!1){let r,s;return Ge(n)?r=n:(r=n.get,s=n.set),new PT(r,s,t)}const Vc={},pd=new WeakMap;let eo;function CT(n,e=!1,t=eo){if(t){let r=pd.get(t);r||pd.set(t,r=[]),r.push(n)}}function kT(n,e,t=wt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,c=G=>s?G:wr(G)||s===!1||s===0?fs(G,1):fs(G);let d,f,g,y,x=!1,S=!1;if(Un(n)?(f=()=>n.value,x=wr(n)):fa(n)?(f=()=>c(n),x=!0):Me(n)?(S=!0,x=n.some(G=>fa(G)||wr(G)),f=()=>n.map(G=>{if(Un(G))return G.value;if(fa(G))return c(G);if(Ge(G))return l?l(G,2):G()})):Ge(n)?e?f=l?()=>l(n,2):n:f=()=>{if(g){ws();try{g()}finally{Is()}}const G=eo;eo=d;try{return l?l(n,3,[y]):n(y)}finally{eo=G}}:f=Vr,e&&s){const G=f,Z=s===!0?1/0:s;f=()=>fs(G(),Z)}const P=iT(),j=()=>{d.stop(),P&&P.active&&Tp(P.effects,d)};if(i&&e){const G=e;e=(...Z)=>{G(...Z),j()}}let U=S?new Array(n.length).fill(Vc):Vc;const D=G=>{if(!(!(d.flags&1)||!d.dirty&&!G))if(e){const Z=d.run();if(s||x||(S?Z.some((me,T)=>di(me,U[T])):di(Z,U))){g&&g();const me=eo;eo=d;try{const T=[Z,U===Vc?void 0:S&&U[0]===Vc?[]:U,y];U=Z,l?l(e,3,T):e(...T)}finally{eo=me}}}else d.run()};return a&&a(D),d=new P_(f),d.scheduler=o?()=>o(D,!1):D,y=G=>CT(G,!1,d),g=d.onStop=()=>{const G=pd.get(d);if(G){if(l)l(G,4);else for(const Z of G)Z();pd.delete(d)}},e?r?D(!0):U=d.run():o?o(D.bind(null,!0),!0):d.run(),j.pause=d.pause.bind(d),j.resume=d.resume.bind(d),j.stop=j,j}function fs(n,e=1/0,t){if(e<=0||!At(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Un(n))fs(n.value,e,t);else if(Me(n))for(let r=0;r<n.length;r++)fs(n[r],e,t);else if(Ga(n)||ha(n))n.forEach(r=>{fs(r,e,t)});else if(T_(n)){for(const r in n)fs(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&fs(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Mu(n,e,t,r){try{return r?n(...r):n()}catch(s){Jd(s,e,t)}}function Zr(n,e,t,r){if(Ge(n)){const s=Mu(n,e,t,r);return s&&I_(s)&&s.catch(i=>{Jd(i,e,t)}),s}if(Me(n)){const s=[];for(let i=0;i<n.length;i++)s.push(Zr(n[i],e,t,r));return s}}function Jd(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||wt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,l,c)===!1)return}a=a.parent}if(i){ws(),Mu(i,null,10,[n,l,c]),Is();return}}DT(n,t,s,r,o)}function DT(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Jn=[];let zr=-1;const pa=[];let Zs=null,sa=0;const K_=Promise.resolve();let md=null;function cn(n){const e=md||K_;return n?e.then(this?n.bind(this):n):e}function VT(n){let e=zr+1,t=Jn.length;for(;e<t;){const r=e+t>>>1,s=Jn[r],i=lu(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function Np(n){if(!(n.flags&1)){const e=lu(n),t=Jn[Jn.length-1];!t||!(n.flags&2)&&e>=lu(t)?Jn.push(n):Jn.splice(VT(e),0,n),n.flags|=1,H_()}}function H_(){md||(md=K_.then(Q_))}function NT(n){Me(n)?pa.push(...n):Zs&&n.id===-1?Zs.splice(sa+1,0,n):n.flags&1||(pa.push(n),n.flags|=1),H_()}function Vg(n,e,t=zr+1){for(;t<Jn.length;t++){const r=Jn[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Jn.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function W_(n){if(pa.length){const e=[...new Set(pa)].sort((t,r)=>lu(t)-lu(r));if(pa.length=0,Zs){Zs.push(...e);return}for(Zs=e,sa=0;sa<Zs.length;sa++){const t=Zs[sa];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Zs=null,sa=0}}const lu=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Q_(n){const e=Vr;try{for(zr=0;zr<Jn.length;zr++){const t=Jn[zr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Mu(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;zr<Jn.length;zr++){const t=Jn[zr];t&&(t.flags&=-2)}zr=-1,Jn.length=0,W_(),md=null,(Jn.length||pa.length)&&Q_()}}let cr=null,J_=null;function gd(n){const e=cr;return cr=n,J_=n&&n.type.__scopeId||null,e}function OT(n,e=cr,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&Gg(-1);const i=gd(e);let o;try{o=n(...s)}finally{gd(i),r._d&&Gg(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Ze(n,e){if(cr===null)return n;const t=eh(cr),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=wt]=e[s];i&&(Ge(i)&&(i={mounted:i,updated:i}),i.deep&&fs(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Yi(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(ws(),Zr(l,t,8,[n.el,a,n,e]),Is())}}const Y_=Symbol("_vte"),MT=n=>n.__isTeleport,Hl=n=>n&&(n.disabled||n.disabled===""),Ng=n=>n&&(n.defer||n.defer===""),Og=n=>typeof SVGElement<"u"&&n instanceof SVGElement,Mg=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,kf=(n,e)=>{const t=n&&n.to;return nn(t)?e?e(t):null:t},X_={name:"Teleport",__isTeleport:!0,process(n,e,t,r,s,i,o,a,l,c){const{mc:d,pc:f,pbc:g,o:{insert:y,querySelector:x,createText:S,createComment:P}}=c,j=Hl(e.props);let{shapeFlag:U,children:D,dynamicChildren:G}=e;if(n==null){const Z=e.el=S(""),me=e.anchor=S("");y(Z,t,r),y(me,t,r);const T=(I,C)=>{U&16&&(s&&s.isCE&&(s.ce._teleportTarget=I),d(D,I,C,s,i,o,a,l))},w=()=>{const I=e.target=kf(e.props,x),C=Z_(I,e,S,y);I&&(o!=="svg"&&Og(I)?o="svg":o!=="mathml"&&Mg(I)&&(o="mathml"),j||(T(I,C),Kc(e,!1)))};j&&(T(t,me),Kc(e,!0)),Ng(e.props)?(e.el.__isMounted=!1,Qn(()=>{w(),delete e.el.__isMounted},i)):w()}else{if(Ng(e.props)&&n.el.__isMounted===!1){Qn(()=>{X_.process(n,e,t,r,s,i,o,a,l,c)},i);return}e.el=n.el,e.targetStart=n.targetStart;const Z=e.anchor=n.anchor,me=e.target=n.target,T=e.targetAnchor=n.targetAnchor,w=Hl(n.props),I=w?t:me,C=w?Z:T;if(o==="svg"||Og(me)?o="svg":(o==="mathml"||Mg(me))&&(o="mathml"),G?(g(n.dynamicChildren,G,I,s,i,o,a),$p(n,e,!0)):l||f(n,e,I,C,s,i,o,a,!1),j)w?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Nc(e,t,Z,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const N=e.target=kf(e.props,x);N&&Nc(e,N,null,c,0)}else w&&Nc(e,me,T,c,1);Kc(e,j)}},remove(n,e,t,{um:r,o:{remove:s}},i){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:d,target:f,props:g}=n;if(f&&(s(c),s(d)),i&&s(l),o&16){const y=i||!Hl(g);for(let x=0;x<a.length;x++){const S=a[x];r(S,e,t,y,!!S.dynamicChildren)}}},move:Nc,hydrate:LT};function Nc(n,e,t,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:d}=n,f=i===2;if(f&&r(o,e,t),(!f||Hl(d))&&l&16)for(let g=0;g<c.length;g++)s(c[g],e,t,2);f&&r(a,e,t)}function LT(n,e,t,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:d}},f){const g=e.target=kf(e.props,l);if(g){const y=Hl(e.props),x=g._lpa||g.firstChild;if(e.shapeFlag&16)if(y)e.anchor=f(o(n),e,a(n),t,r,s,i),e.targetStart=x,e.targetAnchor=x&&o(x);else{e.anchor=o(n);let S=x;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")e.targetStart=S;else if(S.data==="teleport anchor"){e.targetAnchor=S,g._lpa=e.targetAnchor&&o(e.targetAnchor);break}}S=o(S)}e.targetAnchor||Z_(g,e,d,c),f(x&&o(x),e,g,t,r,s,i)}Kc(e,y)}return e.anchor&&o(e.anchor)}const FT=X_;function Kc(n,e){const t=n.ctx;if(t&&t.ut){let r,s;for(e?(r=n.el,s=n.anchor):(r=n.targetStart,s=n.targetAnchor);r&&r!==s;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function Z_(n,e,t,r){const s=e.targetStart=t(""),i=e.targetAnchor=t("");return s[Y_]=i,n&&(r(s,n),r(i,n)),i}function Op(n,e){n.shapeFlag&6&&n.component?(n.transition=e,Op(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function e0(n,e){return Ge(n)?(()=>In({name:n.name},e,{setup:n}))():n}function t0(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Wl(n,e,t,r,s=!1){if(Me(n)){n.forEach((x,S)=>Wl(x,e&&(Me(e)?e[S]:e),t,r,s));return}if(Ql(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Wl(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?eh(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,d=a.refs===wt?a.refs={}:a.refs,f=a.setupState,g=ft(f),y=f===wt?()=>!1:x=>pt(g,x);if(c!=null&&c!==l&&(nn(c)?(d[c]=null,y(c)&&(f[c]=null)):Un(c)&&(c.value=null)),Ge(l))Mu(l,a,12,[o,d]);else{const x=nn(l),S=Un(l);if(x||S){const P=()=>{if(n.f){const j=x?y(l)?f[l]:d[l]:l.value;s?Me(j)&&Tp(j,i):Me(j)?j.includes(i)||j.push(i):x?(d[l]=[i],y(l)&&(f[l]=d[l])):(l.value=[i],n.k&&(d[n.k]=l.value))}else x?(d[l]=o,y(l)&&(f[l]=o)):S&&(l.value=o,n.k&&(d[n.k]=o))};o?(P.id=-1,Qn(P,t)):P()}}}Hd().requestIdleCallback;Hd().cancelIdleCallback;const Ql=n=>!!n.type.__asyncLoader,n0=n=>n.type.__isKeepAlive;function $T(n,e){r0(n,"a",e)}function UT(n,e){r0(n,"da",e)}function r0(n,e,t=$n){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Yd(e,r,t),t){let s=t.parent;for(;s&&s.parent;)n0(s.parent.vnode)&&jT(r,e,t,s),s=s.parent}}function jT(n,e,t,r){const s=Yd(e,n,r,!0);ca(()=>{Tp(r[e],s)},t)}function Yd(n,e,t=$n,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{ws();const a=Lu(t),l=Zr(e,t,n,o);return a(),Is(),l});return r?s.unshift(i):s.push(i),i}}const Rs=n=>(e,t=$n)=>{(!du||n==="sp")&&Yd(n,(...r)=>e(...r),t)},BT=Rs("bm"),br=Rs("m"),qT=Rs("bu"),zT=Rs("u"),GT=Rs("bum"),ca=Rs("um"),KT=Rs("sp"),HT=Rs("rtg"),WT=Rs("rtc");function QT(n,e=$n){Yd("ec",n,e)}const s0="components";function JT(n,e){return XT(s0,n,!0,e)||n}const YT=Symbol.for("v-ndc");function XT(n,e,t=!0,r=!1){const s=cr||$n;if(s){const i=s.type;if(n===s0){const a=Fx(i,!1);if(a&&(a===e||a===Ir(e)||a===Kd(Ir(e))))return i}const o=Lg(s[n]||i[n],e)||Lg(s.appContext[n],e);return!o&&r?i:o}}function Lg(n,e){return n&&(n[e]||n[Ir(e)]||n[Kd(Ir(e))])}function ur(n,e,t,r){let s;const i=t&&t[r],o=Me(n);if(o||nn(n)){const a=o&&fa(n);let l=!1,c=!1;a&&(l=!wr(n),c=yi(n),n=Wd(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(l?c?fd(An(n[d])):An(n[d]):n[d],d,void 0,i&&i[d])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(At(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i&&i[l]));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const d=a[l];s[l]=e(n[d],d,l,i&&i[l])}}else s=[];return t&&(t[r]=s),s}const Df=n=>n?I0(n)?eh(n):Df(n.parent):null,Jl=In(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Df(n.parent),$root:n=>Df(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>Mp(n),$forceUpdate:n=>n.f||(n.f=()=>{Np(n.update)}),$nextTick:n=>n.n||(n.n=cn.bind(n.proxy)),$watch:n=>_x.bind(n)}),Zh=(n,e)=>n!==wt&&!n.__isScriptSetup&&pt(n,e),ZT={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Zh(r,e))return o[e]=1,r[e];if(s!==wt&&pt(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&pt(c,e))return o[e]=3,i[e];if(t!==wt&&pt(t,e))return o[e]=4,t[e];Vf&&(o[e]=0)}}const d=Jl[e];let f,g;if(d)return e==="$attrs"&&Ln(n.attrs,"get",""),d(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==wt&&pt(t,e))return o[e]=4,t[e];if(g=l.config.globalProperties,pt(g,e))return g[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Zh(s,e)?(s[e]=t,!0):r!==wt&&pt(r,e)?(r[e]=t,!0):pt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==wt&&pt(n,o)||Zh(e,o)||(a=i[0])&&pt(a,o)||pt(r,o)||pt(Jl,o)||pt(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:pt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function Fg(n){return Me(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Vf=!0;function ex(n){const e=Mp(n),t=n.proxy,r=n.ctx;Vf=!1,e.beforeCreate&&$g(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:f,mounted:g,beforeUpdate:y,updated:x,activated:S,deactivated:P,beforeDestroy:j,beforeUnmount:U,destroyed:D,unmounted:G,render:Z,renderTracked:me,renderTriggered:T,errorCaptured:w,serverPrefetch:I,expose:C,inheritAttrs:N,components:B,directives:R,filters:Pt}=e;if(c&&tx(c,r,null),o)for(const Le in o){const Ue=o[Le];Ge(Ue)&&(r[Le]=Ue.bind(t))}if(s){const Le=s.call(t,t);At(Le)&&(n.data=Qd(Le))}if(Vf=!0,i)for(const Le in i){const Ue=i[Le],hn=Ge(Ue)?Ue.bind(t,t):Ge(Ue.get)?Ue.get.bind(t,t):Vr,rn=!Ge(Ue)&&Ge(Ue.set)?Ue.set.bind(t):Vr,Rt=$e({get:hn,set:rn});Object.defineProperty(r,Le,{enumerable:!0,configurable:!0,get:()=>Rt.value,set:fe=>Rt.value=fe})}if(a)for(const Le in a)i0(a[Le],r,t,Le);if(l){const Le=Ge(l)?l.call(t):l;Reflect.ownKeys(Le).forEach(Ue=>{Hc(Ue,Le[Ue])})}d&&$g(d,n,"c");function Xe(Le,Ue){Me(Ue)?Ue.forEach(hn=>Le(hn.bind(t))):Ue&&Le(Ue.bind(t))}if(Xe(BT,f),Xe(br,g),Xe(qT,y),Xe(zT,x),Xe($T,S),Xe(UT,P),Xe(QT,w),Xe(WT,me),Xe(HT,T),Xe(GT,U),Xe(ca,G),Xe(KT,I),Me(C))if(C.length){const Le=n.exposed||(n.exposed={});C.forEach(Ue=>{Object.defineProperty(Le,Ue,{get:()=>t[Ue],set:hn=>t[Ue]=hn})})}else n.exposed||(n.exposed={});Z&&n.render===Vr&&(n.render=Z),N!=null&&(n.inheritAttrs=N),B&&(n.components=B),R&&(n.directives=R),I&&t0(n)}function tx(n,e,t=Vr){Me(n)&&(n=Nf(n));for(const r in n){const s=n[r];let i;At(s)?"default"in s?i=Or(s.from||r,s.default,!0):i=Or(s.from||r):i=Or(s),Un(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function $g(n,e,t){Zr(Me(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function i0(n,e,t,r){let s=r.includes(".")?v0(t,r):()=>t[r];if(nn(n)){const i=e[n];Ge(i)&&Nt(s,i)}else if(Ge(n))Nt(s,n.bind(t));else if(At(n))if(Me(n))n.forEach(i=>i0(i,e,t,r));else{const i=Ge(n.handler)?n.handler.bind(t):e[n.handler];Ge(i)&&Nt(s,i,n)}}function Mp(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>vd(l,c,o,!0)),vd(l,e,o)),At(e)&&i.set(e,l),l}function vd(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&vd(n,i,t,!0),s&&s.forEach(o=>vd(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=nx[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const nx={data:Ug,props:jg,emits:jg,methods:Ml,computed:Ml,beforeCreate:Wn,created:Wn,beforeMount:Wn,mounted:Wn,beforeUpdate:Wn,updated:Wn,beforeDestroy:Wn,beforeUnmount:Wn,destroyed:Wn,unmounted:Wn,activated:Wn,deactivated:Wn,errorCaptured:Wn,serverPrefetch:Wn,components:Ml,directives:Ml,watch:sx,provide:Ug,inject:rx};function Ug(n,e){return e?n?function(){return In(Ge(n)?n.call(this,this):n,Ge(e)?e.call(this,this):e)}:e:n}function rx(n,e){return Ml(Nf(n),Nf(e))}function Nf(n){if(Me(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Wn(n,e){return n?[...new Set([].concat(n,e))]:e}function Ml(n,e){return n?In(Object.create(null),n,e):e}function jg(n,e){return n?Me(n)&&Me(e)?[...new Set([...n,...e])]:In(Object.create(null),Fg(n),Fg(e??{})):e}function sx(n,e){if(!n)return e;if(!e)return n;const t=In(Object.create(null),n);for(const r in e)t[r]=Wn(n[r],e[r]);return t}function o0(){return{app:null,config:{isNativeTag:KE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ix=0;function ox(n,e){return function(r,s=null){Ge(r)||(r=In({},r)),s!=null&&!At(s)&&(s=null);const i=o0(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:ix++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Ux,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&Ge(d.install)?(o.add(d),d.install(c,...f)):Ge(d)&&(o.add(d),d(c,...f))),c},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),c},component(d,f){return f?(i.components[d]=f,c):i.components[d]},directive(d,f){return f?(i.directives[d]=f,c):i.directives[d]},mount(d,f,g){if(!l){const y=c._ceVNode||ut(r,s);return y.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),f&&e?e(y,d):n(y,d,g),l=!0,c._container=d,d.__vue_app__=c,eh(y.component)}},onUnmount(d){a.push(d)},unmount(){l&&(Zr(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(d,f){return i.provides[d]=f,c},runWithContext(d){const f=ma;ma=c;try{return d()}finally{ma=f}}};return c}}let ma=null;function Hc(n,e){if($n){let t=$n.provides;const r=$n.parent&&$n.parent.provides;r===t&&(t=$n.provides=Object.create(r)),t[n]=e}}function Or(n,e,t=!1){const r=$n||cr;if(r||ma){let s=ma?ma._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&Ge(e)?e.call(r&&r.proxy):e}}const a0={},l0=()=>Object.create(a0),u0=n=>Object.getPrototypeOf(n)===a0;function ax(n,e,t,r=!1){const s={},i=l0();n.propsDefaults=Object.create(null),c0(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:B_(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function lx(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=ft(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(Xd(n.emitsOptions,g))continue;const y=e[g];if(l)if(pt(i,g))y!==i[g]&&(i[g]=y,c=!0);else{const x=Ir(g);s[x]=Of(l,a,x,y,n,!1)}else y!==i[g]&&(i[g]=y,c=!0)}}}else{c0(n,e,s,i)&&(c=!0);let d;for(const f in a)(!e||!pt(e,f)&&((d=Ri(f))===f||!pt(e,d)))&&(l?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=Of(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!pt(e,f))&&(delete i[f],c=!0)}c&&hs(n.attrs,"set","")}function c0(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(zl(l))continue;const c=e[l];let d;s&&pt(s,d=Ir(l))?!i||!i.includes(d)?t[d]=c:(a||(a={}))[d]=c:Xd(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=ft(t),c=a||wt;for(let d=0;d<i.length;d++){const f=i[d];t[f]=Of(s,l,f,c[f],n,!pt(c,f))}}return o}function Of(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=pt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ge(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const d=Lu(s);r=c[t]=l.call(null,e),d()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Ri(t))&&(r=!0))}return r}const ux=new WeakMap;function d0(n,e,t=!1){const r=t?ux:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!Ge(n)){const d=f=>{l=!0;const[g,y]=d0(f,e,!0);In(o,g),y&&a.push(...y)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!l)return At(n)&&r.set(n,da),da;if(Me(i))for(let d=0;d<i.length;d++){const f=Ir(i[d]);Bg(f)&&(o[f]=wt)}else if(i)for(const d in i){const f=Ir(d);if(Bg(f)){const g=i[d],y=o[f]=Me(g)||Ge(g)?{type:g}:In({},g),x=y.type;let S=!1,P=!0;if(Me(x))for(let j=0;j<x.length;++j){const U=x[j],D=Ge(U)&&U.name;if(D==="Boolean"){S=!0;break}else D==="String"&&(P=!1)}else S=Ge(x)&&x.name==="Boolean";y[0]=S,y[1]=P,(S||pt(y,"default"))&&a.push(f)}}const c=[o,a];return At(n)&&r.set(n,c),c}function Bg(n){return n[0]!=="$"&&!zl(n)}const Lp=n=>n[0]==="_"||n==="$stable",Fp=n=>Me(n)?n.map(Gr):[Gr(n)],cx=(n,e,t)=>{if(e._n)return e;const r=OT((...s)=>Fp(e(...s)),t);return r._c=!1,r},h0=(n,e,t)=>{const r=n._ctx;for(const s in n){if(Lp(s))continue;const i=n[s];if(Ge(i))e[s]=cx(s,i,r);else if(i!=null){const o=Fp(i);e[s]=()=>o}}},f0=(n,e)=>{const t=Fp(e);n.slots.default=()=>t},p0=(n,e,t)=>{for(const r in e)(t||!Lp(r))&&(n[r]=e[r])},dx=(n,e,t)=>{const r=n.slots=l0();if(n.vnode.shapeFlag&32){const s=e.__;s&&Af(r,"__",s,!0);const i=e._;i?(p0(r,e,t),t&&Af(r,"_",i,!0)):h0(e,r)}else e&&f0(n,e)},hx=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=wt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:p0(s,e,t):(i=!e.$stable,h0(e,s)),o=e}else e&&(f0(n,e),o={default:1});if(i)for(const a in s)!Lp(a)&&o[a]==null&&delete s[a]},Qn=Ax;function fx(n){return px(n)}function px(n,e){const t=Hd();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:f,nextSibling:g,setScopeId:y=Vr,insertStaticContent:x}=n,S=(E,A,M,ee=null,Y=null,te=null,ve=void 0,de=null,he=!!A.dynamicChildren)=>{if(E===A)return;E&&!Al(E,A)&&(ee=k(E),fe(E,Y,te,!0),E=null),A.patchFlag===-2&&(he=!1,A.dynamicChildren=null);const{type:ae,ref:Ee,shapeFlag:we}=A;switch(ae){case Zd:P(E,A,M,ee);break;case _i:j(E,A,M,ee);break;case Wc:E==null&&U(A,M,ee,ve);break;case vt:B(E,A,M,ee,Y,te,ve,de,he);break;default:we&1?Z(E,A,M,ee,Y,te,ve,de,he):we&6?R(E,A,M,ee,Y,te,ve,de,he):(we&64||we&128)&&ae.process(E,A,M,ee,Y,te,ve,de,he,X)}Ee!=null&&Y?Wl(Ee,E&&E.ref,te,A||E,!A):Ee==null&&E&&E.ref!=null&&Wl(E.ref,null,te,E,!0)},P=(E,A,M,ee)=>{if(E==null)r(A.el=a(A.children),M,ee);else{const Y=A.el=E.el;A.children!==E.children&&c(Y,A.children)}},j=(E,A,M,ee)=>{E==null?r(A.el=l(A.children||""),M,ee):A.el=E.el},U=(E,A,M,ee)=>{[E.el,E.anchor]=x(E.children,A,M,ee,E.el,E.anchor)},D=({el:E,anchor:A},M,ee)=>{let Y;for(;E&&E!==A;)Y=g(E),r(E,M,ee),E=Y;r(A,M,ee)},G=({el:E,anchor:A})=>{let M;for(;E&&E!==A;)M=g(E),s(E),E=M;s(A)},Z=(E,A,M,ee,Y,te,ve,de,he)=>{A.type==="svg"?ve="svg":A.type==="math"&&(ve="mathml"),E==null?me(A,M,ee,Y,te,ve,de,he):I(E,A,Y,te,ve,de,he)},me=(E,A,M,ee,Y,te,ve,de)=>{let he,ae;const{props:Ee,shapeFlag:we,transition:Te,dirs:Re}=E;if(he=E.el=o(E.type,te,Ee&&Ee.is,Ee),we&8?d(he,E.children):we&16&&w(E.children,he,null,ee,Y,ef(E,te),ve,de),Re&&Yi(E,null,ee,"created"),T(he,E,E.scopeId,ve,ee),Ee){for(const Be in Ee)Be!=="value"&&!zl(Be)&&i(he,Be,null,Ee[Be],te,ee);"value"in Ee&&i(he,"value",null,Ee.value,te),(ae=Ee.onVnodeBeforeMount)&&qr(ae,ee,E)}Re&&Yi(E,null,ee,"beforeMount");const Ne=mx(Y,Te);Ne&&Te.beforeEnter(he),r(he,A,M),((ae=Ee&&Ee.onVnodeMounted)||Ne||Re)&&Qn(()=>{ae&&qr(ae,ee,E),Ne&&Te.enter(he),Re&&Yi(E,null,ee,"mounted")},Y)},T=(E,A,M,ee,Y)=>{if(M&&y(E,M),ee)for(let te=0;te<ee.length;te++)y(E,ee[te]);if(Y){let te=Y.subTree;if(A===te||_0(te.type)&&(te.ssContent===A||te.ssFallback===A)){const ve=Y.vnode;T(E,ve,ve.scopeId,ve.slotScopeIds,Y.parent)}}},w=(E,A,M,ee,Y,te,ve,de,he=0)=>{for(let ae=he;ae<E.length;ae++){const Ee=E[ae]=de?ei(E[ae]):Gr(E[ae]);S(null,Ee,A,M,ee,Y,te,ve,de)}},I=(E,A,M,ee,Y,te,ve)=>{const de=A.el=E.el;let{patchFlag:he,dynamicChildren:ae,dirs:Ee}=A;he|=E.patchFlag&16;const we=E.props||wt,Te=A.props||wt;let Re;if(M&&Xi(M,!1),(Re=Te.onVnodeBeforeUpdate)&&qr(Re,M,A,E),Ee&&Yi(A,E,M,"beforeUpdate"),M&&Xi(M,!0),(we.innerHTML&&Te.innerHTML==null||we.textContent&&Te.textContent==null)&&d(de,""),ae?C(E.dynamicChildren,ae,de,M,ee,ef(A,Y),te):ve||Ue(E,A,de,null,M,ee,ef(A,Y),te,!1),he>0){if(he&16)N(de,we,Te,M,Y);else if(he&2&&we.class!==Te.class&&i(de,"class",null,Te.class,Y),he&4&&i(de,"style",we.style,Te.style,Y),he&8){const Ne=A.dynamicProps;for(let Be=0;Be<Ne.length;Be++){const Je=Ne[Be],Ht=we[Je],Ft=Te[Je];(Ft!==Ht||Je==="value")&&i(de,Je,Ht,Ft,Y,M)}}he&1&&E.children!==A.children&&d(de,A.children)}else!ve&&ae==null&&N(de,we,Te,M,Y);((Re=Te.onVnodeUpdated)||Ee)&&Qn(()=>{Re&&qr(Re,M,A,E),Ee&&Yi(A,E,M,"updated")},ee)},C=(E,A,M,ee,Y,te,ve)=>{for(let de=0;de<A.length;de++){const he=E[de],ae=A[de],Ee=he.el&&(he.type===vt||!Al(he,ae)||he.shapeFlag&198)?f(he.el):M;S(he,ae,Ee,null,ee,Y,te,ve,!0)}},N=(E,A,M,ee,Y)=>{if(A!==M){if(A!==wt)for(const te in A)!zl(te)&&!(te in M)&&i(E,te,A[te],null,Y,ee);for(const te in M){if(zl(te))continue;const ve=M[te],de=A[te];ve!==de&&te!=="value"&&i(E,te,de,ve,Y,ee)}"value"in M&&i(E,"value",A.value,M.value,Y)}},B=(E,A,M,ee,Y,te,ve,de,he)=>{const ae=A.el=E?E.el:a(""),Ee=A.anchor=E?E.anchor:a("");let{patchFlag:we,dynamicChildren:Te,slotScopeIds:Re}=A;Re&&(de=de?de.concat(Re):Re),E==null?(r(ae,M,ee),r(Ee,M,ee),w(A.children||[],M,Ee,Y,te,ve,de,he)):we>0&&we&64&&Te&&E.dynamicChildren?(C(E.dynamicChildren,Te,M,Y,te,ve,de),(A.key!=null||Y&&A===Y.subTree)&&$p(E,A,!0)):Ue(E,A,M,Ee,Y,te,ve,de,he)},R=(E,A,M,ee,Y,te,ve,de,he)=>{A.slotScopeIds=de,E==null?A.shapeFlag&512?Y.ctx.activate(A,M,ee,ve,he):Pt(A,M,ee,Y,te,ve,he):Et(E,A,he)},Pt=(E,A,M,ee,Y,te,ve)=>{const de=E.component=Vx(E,ee,Y);if(n0(E)&&(de.ctx.renderer=X),Nx(de,!1,ve),de.asyncDep){if(Y&&Y.registerDep(de,Xe,ve),!E.el){const he=de.subTree=ut(_i);j(null,he,A,M)}}else Xe(de,E,A,M,Y,te,ve)},Et=(E,A,M)=>{const ee=A.component=E.component;if(Tx(E,A,M))if(ee.asyncDep&&!ee.asyncResolved){Le(ee,A,M);return}else ee.next=A,ee.update();else A.el=E.el,ee.vnode=A},Xe=(E,A,M,ee,Y,te,ve)=>{const de=()=>{if(E.isMounted){let{next:we,bu:Te,u:Re,parent:Ne,vnode:Be}=E;{const Ct=m0(E);if(Ct){we&&(we.el=Be.el,Le(E,we,ve)),Ct.asyncDep.then(()=>{E.isUnmounted||de()});return}}let Je=we,Ht;Xi(E,!1),we?(we.el=Be.el,Le(E,we,ve)):we=Be,Te&&Gc(Te),(Ht=we.props&&we.props.onVnodeBeforeUpdate)&&qr(Ht,Ne,we,Be),Xi(E,!0);const Ft=tf(E),vn=E.subTree;E.subTree=Ft,S(vn,Ft,f(vn.el),k(vn),E,Y,te),we.el=Ft.el,Je===null&&xx(E,Ft.el),Re&&Qn(Re,Y),(Ht=we.props&&we.props.onVnodeUpdated)&&Qn(()=>qr(Ht,Ne,we,Be),Y)}else{let we;const{el:Te,props:Re}=A,{bm:Ne,m:Be,parent:Je,root:Ht,type:Ft}=E,vn=Ql(A);if(Xi(E,!1),Ne&&Gc(Ne),!vn&&(we=Re&&Re.onVnodeBeforeMount)&&qr(we,Je,A),Xi(E,!0),Te&&Oe){const Ct=()=>{E.subTree=tf(E),Oe(Te,E.subTree,E,Y,null)};vn&&Ft.__asyncHydrate?Ft.__asyncHydrate(Te,E,Ct):Ct()}else{Ht.ce&&Ht.ce._def.shadowRoot!==!1&&Ht.ce._injectChildStyle(Ft);const Ct=E.subTree=tf(E);S(null,Ct,M,ee,E,Y,te),A.el=Ct.el}if(Be&&Qn(Be,Y),!vn&&(we=Re&&Re.onVnodeMounted)){const Ct=A;Qn(()=>qr(we,Je,Ct),Y)}(A.shapeFlag&256||Je&&Ql(Je.vnode)&&Je.vnode.shapeFlag&256)&&E.a&&Qn(E.a,Y),E.isMounted=!0,A=M=ee=null}};E.scope.on();const he=E.effect=new P_(de);E.scope.off();const ae=E.update=he.run.bind(he),Ee=E.job=he.runIfDirty.bind(he);Ee.i=E,Ee.id=E.uid,he.scheduler=()=>Np(Ee),Xi(E,!0),ae()},Le=(E,A,M)=>{A.component=E;const ee=E.vnode.props;E.vnode=A,E.next=null,lx(E,A.props,ee,M),hx(E,A.children,M),ws(),Vg(E),Is()},Ue=(E,A,M,ee,Y,te,ve,de,he=!1)=>{const ae=E&&E.children,Ee=E?E.shapeFlag:0,we=A.children,{patchFlag:Te,shapeFlag:Re}=A;if(Te>0){if(Te&128){rn(ae,we,M,ee,Y,te,ve,de,he);return}else if(Te&256){hn(ae,we,M,ee,Y,te,ve,de,he);return}}Re&8?(Ee&16&&dt(ae,Y,te),we!==ae&&d(M,we)):Ee&16?Re&16?rn(ae,we,M,ee,Y,te,ve,de,he):dt(ae,Y,te,!0):(Ee&8&&d(M,""),Re&16&&w(we,M,ee,Y,te,ve,de,he))},hn=(E,A,M,ee,Y,te,ve,de,he)=>{E=E||da,A=A||da;const ae=E.length,Ee=A.length,we=Math.min(ae,Ee);let Te;for(Te=0;Te<we;Te++){const Re=A[Te]=he?ei(A[Te]):Gr(A[Te]);S(E[Te],Re,M,null,Y,te,ve,de,he)}ae>Ee?dt(E,Y,te,!0,!1,we):w(A,M,ee,Y,te,ve,de,he,we)},rn=(E,A,M,ee,Y,te,ve,de,he)=>{let ae=0;const Ee=A.length;let we=E.length-1,Te=Ee-1;for(;ae<=we&&ae<=Te;){const Re=E[ae],Ne=A[ae]=he?ei(A[ae]):Gr(A[ae]);if(Al(Re,Ne))S(Re,Ne,M,null,Y,te,ve,de,he);else break;ae++}for(;ae<=we&&ae<=Te;){const Re=E[we],Ne=A[Te]=he?ei(A[Te]):Gr(A[Te]);if(Al(Re,Ne))S(Re,Ne,M,null,Y,te,ve,de,he);else break;we--,Te--}if(ae>we){if(ae<=Te){const Re=Te+1,Ne=Re<Ee?A[Re].el:ee;for(;ae<=Te;)S(null,A[ae]=he?ei(A[ae]):Gr(A[ae]),M,Ne,Y,te,ve,de,he),ae++}}else if(ae>Te)for(;ae<=we;)fe(E[ae],Y,te,!0),ae++;else{const Re=ae,Ne=ae,Be=new Map;for(ae=Ne;ae<=Te;ae++){const sn=A[ae]=he?ei(A[ae]):Gr(A[ae]);sn.key!=null&&Be.set(sn.key,ae)}let Je,Ht=0;const Ft=Te-Ne+1;let vn=!1,Ct=0;const fr=new Array(Ft);for(ae=0;ae<Ft;ae++)fr[ae]=0;for(ae=Re;ae<=we;ae++){const sn=E[ae];if(Ht>=Ft){fe(sn,Y,te,!0);continue}let Rn;if(sn.key!=null)Rn=Be.get(sn.key);else for(Je=Ne;Je<=Te;Je++)if(fr[Je-Ne]===0&&Al(sn,A[Je])){Rn=Je;break}Rn===void 0?fe(sn,Y,te,!0):(fr[Rn-Ne]=ae+1,Rn>=Ct?Ct=Rn:vn=!0,S(sn,A[Rn],M,null,Y,te,ve,de,he),Ht++)}const Lr=vn?gx(fr):da;for(Je=Lr.length-1,ae=Ft-1;ae>=0;ae--){const sn=Ne+ae,Rn=A[sn],Oi=sn+1<Ee?A[sn+1].el:ee;fr[ae]===0?S(null,Rn,M,Oi,Y,te,ve,de,he):vn&&(Je<0||ae!==Lr[Je]?Rt(Rn,M,Oi,2):Je--)}}},Rt=(E,A,M,ee,Y=null)=>{const{el:te,type:ve,transition:de,children:he,shapeFlag:ae}=E;if(ae&6){Rt(E.component.subTree,A,M,ee);return}if(ae&128){E.suspense.move(A,M,ee);return}if(ae&64){ve.move(E,A,M,X);return}if(ve===vt){r(te,A,M);for(let we=0;we<he.length;we++)Rt(he[we],A,M,ee);r(E.anchor,A,M);return}if(ve===Wc){D(E,A,M);return}if(ee!==2&&ae&1&&de)if(ee===0)de.beforeEnter(te),r(te,A,M),Qn(()=>de.enter(te),Y);else{const{leave:we,delayLeave:Te,afterLeave:Re}=de,Ne=()=>{E.ctx.isUnmounted?s(te):r(te,A,M)},Be=()=>{we(te,()=>{Ne(),Re&&Re()})};Te?Te(te,Ne,Be):Be()}else r(te,A,M)},fe=(E,A,M,ee=!1,Y=!1)=>{const{type:te,props:ve,ref:de,children:he,dynamicChildren:ae,shapeFlag:Ee,patchFlag:we,dirs:Te,cacheIndex:Re}=E;if(we===-2&&(Y=!1),de!=null&&(ws(),Wl(de,null,M,E,!0),Is()),Re!=null&&(A.renderCache[Re]=void 0),Ee&256){A.ctx.deactivate(E);return}const Ne=Ee&1&&Te,Be=!Ql(E);let Je;if(Be&&(Je=ve&&ve.onVnodeBeforeUnmount)&&qr(Je,A,E),Ee&6)rt(E.component,M,ee);else{if(Ee&128){E.suspense.unmount(M,ee);return}Ne&&Yi(E,null,A,"beforeUnmount"),Ee&64?E.type.remove(E,A,M,X,ee):ae&&!ae.hasOnce&&(te!==vt||we>0&&we&64)?dt(ae,A,M,!1,!0):(te===vt&&we&384||!Y&&Ee&16)&&dt(he,A,M),ee&&oe(E)}(Be&&(Je=ve&&ve.onVnodeUnmounted)||Ne)&&Qn(()=>{Je&&qr(Je,A,E),Ne&&Yi(E,null,A,"unmounted")},M)},oe=E=>{const{type:A,el:M,anchor:ee,transition:Y}=E;if(A===vt){ze(M,ee);return}if(A===Wc){G(E);return}const te=()=>{s(M),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(E.shapeFlag&1&&Y&&!Y.persisted){const{leave:ve,delayLeave:de}=Y,he=()=>ve(M,te);de?de(E.el,te,he):he()}else te()},ze=(E,A)=>{let M;for(;E!==A;)M=g(E),s(E),E=M;s(A)},rt=(E,A,M)=>{const{bum:ee,scope:Y,job:te,subTree:ve,um:de,m:he,a:ae,parent:Ee,slots:{__:we}}=E;qg(he),qg(ae),ee&&Gc(ee),Ee&&Me(we)&&we.forEach(Te=>{Ee.renderCache[Te]=void 0}),Y.stop(),te&&(te.flags|=8,fe(ve,E,A,M)),de&&Qn(de,A),Qn(()=>{E.isUnmounted=!0},A),A&&A.pendingBranch&&!A.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===A.pendingId&&(A.deps--,A.deps===0&&A.resolve())},dt=(E,A,M,ee=!1,Y=!1,te=0)=>{for(let ve=te;ve<E.length;ve++)fe(E[ve],A,M,ee,Y)},k=E=>{if(E.shapeFlag&6)return k(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const A=g(E.anchor||E.el),M=A&&A[Y_];return M?g(M):A};let L=!1;const J=(E,A,M)=>{E==null?A._vnode&&fe(A._vnode,null,null,!0):S(A._vnode||null,E,A,null,null,null,M),A._vnode=E,L||(L=!0,Vg(),W_(),L=!1)},X={p:S,um:fe,m:Rt,r:oe,mt:Pt,mc:w,pc:Ue,pbc:C,n:k,o:n};let Pe,Oe;return e&&([Pe,Oe]=e(X)),{render:J,hydrate:Pe,createApp:ox(J,Pe)}}function ef({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Xi({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function mx(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function $p(n,e,t=!1){const r=n.children,s=e.children;if(Me(r)&&Me(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=ei(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&$p(o,a)),a.type===Zd&&(a.el=o.el),a.type===_i&&!a.el&&(a.el=o.el)}}function gx(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function m0(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:m0(e)}function qg(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const vx=Symbol.for("v-scx"),yx=()=>Or(vx);function Nt(n,e,t){return g0(n,e,t)}function g0(n,e,t=wt){const{immediate:r,deep:s,flush:i,once:o}=t,a=In({},t),l=e&&r||!e&&i!=="post";let c;if(du){if(i==="sync"){const y=yx();c=y.__watcherHandles||(y.__watcherHandles=[])}else if(!l){const y=()=>{};return y.stop=Vr,y.resume=Vr,y.pause=Vr,y}}const d=$n;a.call=(y,x,S)=>Zr(y,d,x,S);let f=!1;i==="post"?a.scheduler=y=>{Qn(y,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(y,x)=>{x?y():Np(y)}),a.augmentJob=y=>{e&&(y.flags|=4),f&&(y.flags|=2,d&&(y.id=d.uid,y.i=d))};const g=kT(n,e,a);return du&&(c?c.push(g):l&&g()),g}function _x(n,e,t){const r=this.proxy,s=nn(n)?n.includes(".")?v0(r,n):()=>r[n]:n.bind(r,r);let i;Ge(e)?i=e:(i=e.handler,t=e);const o=Lu(this),a=g0(s,i.bind(r),t);return o(),a}function v0(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const bx=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${Ir(e)}Modifiers`]||n[`${Ri(e)}Modifiers`];function wx(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||wt;let s=t;const i=e.startsWith("update:"),o=i&&bx(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>nn(d)?d.trim():d)),o.number&&(s=t.map(hd)));let a,l=r[a=Wh(e)]||r[a=Wh(Ir(e))];!l&&i&&(l=r[a=Wh(Ri(e))]),l&&Zr(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Zr(c,n,6,s)}}function y0(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!Ge(n)){const l=c=>{const d=y0(c,e,!0);d&&(a=!0,In(o,d))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(At(n)&&r.set(n,null),null):(Me(i)?i.forEach(l=>o[l]=null):In(o,i),At(n)&&r.set(n,o),o)}function Xd(n,e){return!n||!zd(e)?!1:(e=e.slice(2).replace(/Once$/,""),pt(n,e[0].toLowerCase()+e.slice(1))||pt(n,Ri(e))||pt(n,e))}function tf(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:d,props:f,data:g,setupState:y,ctx:x,inheritAttrs:S}=n,P=gd(n);let j,U;try{if(t.shapeFlag&4){const G=s||r,Z=G;j=Gr(c.call(Z,G,d,f,y,g,x)),U=a}else{const G=e;j=Gr(G.length>1?G(f,{attrs:a,slots:o,emit:l}):G(f,null)),U=e.props?a:Ix(a)}}catch(G){Yl.length=0,Jd(G,n,1),j=ut(_i)}let D=j;if(U&&S!==!1){const G=Object.keys(U),{shapeFlag:Z}=D;G.length&&Z&7&&(i&&G.some(Ep)&&(U=Ex(U,i)),D=Ia(D,U,!1,!0))}return t.dirs&&(D=Ia(D,null,!1,!0),D.dirs=D.dirs?D.dirs.concat(t.dirs):t.dirs),t.transition&&Op(D,t.transition),j=D,gd(P),j}const Ix=n=>{let e;for(const t in n)(t==="class"||t==="style"||zd(t))&&((e||(e={}))[t]=n[t]);return e},Ex=(n,e)=>{const t={};for(const r in n)(!Ep(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function Tx(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?zg(r,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(o[g]!==r[g]&&!Xd(c,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?zg(r,o,c):!0:!!o;return!1}function zg(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Xd(t,i))return!0}return!1}function xx({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const _0=n=>n.__isSuspense;function Ax(n,e){e&&e.pendingBranch?Me(n)?e.effects.push(...n):e.effects.push(n):NT(n)}const vt=Symbol.for("v-fgt"),Zd=Symbol.for("v-txt"),_i=Symbol.for("v-cmt"),Wc=Symbol.for("v-stc"),Yl=[];let dr=null;function F(n=!1){Yl.push(dr=n?null:[])}function Sx(){Yl.pop(),dr=Yl[Yl.length-1]||null}let uu=1;function Gg(n,e=!1){uu+=n,n<0&&dr&&e&&(dr.hasOnce=!0)}function b0(n){return n.dynamicChildren=uu>0?dr||da:null,Sx(),uu>0&&dr&&dr.push(n),n}function $(n,e,t,r,s,i){return b0(h(n,e,t,r,s,i,!0))}function cu(n,e,t,r,s){return b0(ut(n,e,t,r,s,!0))}function yd(n){return n?n.__v_isVNode===!0:!1}function Al(n,e){return n.type===e.type&&n.key===e.key}const w0=({key:n})=>n??null,Qc=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?nn(n)||Un(n)||Ge(n)?{i:cr,r:n,k:e,f:!!t}:n:null);function h(n,e=null,t=null,r=0,s=null,i=n===vt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&w0(e),ref:e&&Qc(e),scopeId:J_,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:cr};return a?(Up(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=nn(t)?8:16),uu>0&&!o&&dr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&dr.push(l),l}const ut=Px;function Px(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===YT)&&(n=_i),yd(n)){const a=Ia(n,e,!0);return t&&Up(a,t),uu>0&&!i&&dr&&(a.shapeFlag&6?dr[dr.indexOf(n)]=a:dr.push(a)),a.patchFlag=-2,a}if($x(n)&&(n=n.__vccOpts),e){e=Rx(e);let{class:a,style:l}=e;a&&!nn(a)&&(e.class=zt(a)),At(l)&&(Vp(l)&&!Me(l)&&(l=In({},l)),e.style=ds(l))}const o=nn(n)?1:_0(n)?128:MT(n)?64:At(n)?4:Ge(n)?2:0;return h(n,e,t,r,s,o,i,!0)}function Rx(n){return n?Vp(n)||u0(n)?In({},n):n:null}function Ia(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?Cx(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&w0(c),ref:e&&e.ref?t&&i?Me(i)?i.concat(Qc(e)):[i,Qc(e)]:Qc(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==vt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ia(n.ssContent),ssFallback:n.ssFallback&&Ia(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&Op(d,l.clone(d)),d}function Fn(n=" ",e=0){return ut(Zd,null,n,e)}function nr(n,e){const t=ut(Wc,null,n);return t.staticCount=e,t}function ce(n="",e=!1){return e?(F(),cu(_i,null,n)):ut(_i,null,n)}function Gr(n){return n==null||typeof n=="boolean"?ut(_i):Me(n)?ut(vt,null,n.slice()):yd(n)?ei(n):ut(Zd,null,String(n))}function ei(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ia(n)}function Up(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Me(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Up(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!u0(e)?e._ctx=cr:s===3&&cr&&(cr.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Ge(e)?(e={default:e,_ctx:cr},t=32):(e=String(e),r&64?(t=16,e=[Fn(e)]):t=8);n.children=e,n.shapeFlag|=t}function Cx(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=zt([e.class,r.class]));else if(s==="style")e.style=ds([e.style,r.style]);else if(zd(s)){const i=e[s],o=r[s];o&&i!==o&&!(Me(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function qr(n,e,t,r=null){Zr(n,e,7,[t,r])}const kx=o0();let Dx=0;function Vx(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||kx,i={uid:Dx++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new sT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:d0(r,s),emitsOptions:y0(r,s),emit:null,emitted:null,propsDefaults:wt,inheritAttrs:r.inheritAttrs,ctx:wt,data:wt,props:wt,attrs:wt,slots:wt,refs:wt,setupState:wt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=wx.bind(null,i),n.ce&&n.ce(i),i}let $n=null,_d,Mf;{const n=Hd(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};_d=e("__VUE_INSTANCE_SETTERS__",t=>$n=t),Mf=e("__VUE_SSR_SETTERS__",t=>du=t)}const Lu=n=>{const e=$n;return _d(n),n.scope.on(),()=>{n.scope.off(),_d(e)}},Kg=()=>{$n&&$n.scope.off(),_d(null)};function I0(n){return n.vnode.shapeFlag&4}let du=!1;function Nx(n,e=!1,t=!1){e&&Mf(e);const{props:r,children:s}=n.vnode,i=I0(n);ax(n,r,i,e),dx(n,s,t||e);const o=i?Ox(n,e):void 0;return e&&Mf(!1),o}function Ox(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,ZT);const{setup:r}=t;if(r){ws();const s=n.setupContext=r.length>1?Lx(n):null,i=Lu(n),o=Mu(r,n,0,[n.props,s]),a=I_(o);if(Is(),i(),(a||n.sp)&&!Ql(n)&&t0(n),a){if(o.then(Kg,Kg),e)return o.then(l=>{Hg(n,l,e)}).catch(l=>{Jd(l,n,0)});n.asyncDep=o}else Hg(n,o,e)}else E0(n,e)}function Hg(n,e,t){Ge(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:At(e)&&(n.setupState=G_(e)),E0(n,t)}let Wg;function E0(n,e,t){const r=n.type;if(!n.render){if(!e&&Wg&&!r.render){const s=r.template||Mp(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=In(In({isCustomElement:i,delimiters:a},o),l);r.render=Wg(s,c)}}n.render=r.render||Vr}{const s=Lu(n);ws();try{ex(n)}finally{Is(),s()}}}const Mx={get(n,e){return Ln(n,"get",""),n[e]}};function Lx(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,Mx),slots:n.slots,emit:n.emit,expose:e}}function eh(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(G_(TT(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Jl)return Jl[t](n)},has(e,t){return t in e||t in Jl}})):n.proxy}function Fx(n,e=!0){return Ge(n)?n.displayName||n.name:n.name||e&&n.__name}function $x(n){return Ge(n)&&"__vccOpts"in n}const $e=(n,e)=>RT(n,e,du);function T0(n,e,t){const r=arguments.length;return r===2?At(e)&&!Me(e)?yd(e)?ut(n,null,[e]):ut(n,e):ut(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&yd(t)&&(t=[t]),ut(n,e,t))}const Ux="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Lf;const Qg=typeof window<"u"&&window.trustedTypes;if(Qg)try{Lf=Qg.createPolicy("vue",{createHTML:n=>n})}catch{}const x0=Lf?n=>Lf.createHTML(n):n=>n,jx="http://www.w3.org/2000/svg",Bx="http://www.w3.org/1998/Math/MathML",cs=typeof document<"u"?document:null,Jg=cs&&cs.createElement("template"),qx={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?cs.createElementNS(jx,n):e==="mathml"?cs.createElementNS(Bx,n):t?cs.createElement(n,{is:t}):cs.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>cs.createTextNode(n),createComment:n=>cs.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>cs.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Jg.innerHTML=x0(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Jg.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},zx=Symbol("_vtc");function Gx(n,e,t){const r=n[zx];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const bd=Symbol("_vod"),A0=Symbol("_vsh"),nf={beforeMount(n,{value:e},{transition:t}){n[bd]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Sl(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),Sl(n,!0),r.enter(n)):r.leave(n,()=>{Sl(n,!1)}):Sl(n,e))},beforeUnmount(n,{value:e}){Sl(n,e)}};function Sl(n,e){n.style.display=e?n[bd]:"none",n[A0]=!e}const Kx=Symbol(""),Hx=/(^|;)\s*display\s*:/;function Wx(n,e,t){const r=n.style,s=nn(t);let i=!1;if(t&&!s){if(e)if(nn(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Jc(r,a,"")}else for(const o in e)t[o]==null&&Jc(r,o,"");for(const o in t)o==="display"&&(i=!0),Jc(r,o,t[o])}else if(s){if(e!==t){const o=r[Kx];o&&(t+=";"+o),r.cssText=t,i=Hx.test(t)}}else e&&n.removeAttribute("style");bd in n&&(n[bd]=i?r.display:"",n[A0]&&(r.display="none"))}const Yg=/\s*!important$/;function Jc(n,e,t){if(Me(t))t.forEach(r=>Jc(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=Qx(n,e);Yg.test(t)?n.setProperty(Ri(r),t.replace(Yg,""),"important"):n[r]=t}}const Xg=["Webkit","Moz","ms"],rf={};function Qx(n,e){const t=rf[e];if(t)return t;let r=Ir(e);if(r!=="filter"&&r in n)return rf[e]=r;r=Kd(r);for(let s=0;s<Xg.length;s++){const i=Xg[s]+r;if(i in n)return rf[e]=i}return e}const Zg="http://www.w3.org/1999/xlink";function ev(n,e,t,r,s,i=nT(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Zg,e.slice(6,e.length)):n.setAttributeNS(Zg,e,t):t==null||i&&!x_(t)?n.removeAttribute(e):n.setAttribute(e,i?"":Xr(t)?String(t):t)}function tv(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?x0(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=x_(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function ni(n,e,t,r){n.addEventListener(e,t,r)}function Jx(n,e,t,r){n.removeEventListener(e,t,r)}const nv=Symbol("_vei");function Yx(n,e,t,r,s=null){const i=n[nv]||(n[nv]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=Xx(e);if(r){const c=i[e]=tA(r,s);ni(n,a,c,l)}else o&&(Jx(n,a,o,l),i[e]=void 0)}}const rv=/(?:Once|Passive|Capture)$/;function Xx(n){let e;if(rv.test(n)){e={};let r;for(;r=n.match(rv);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Ri(n.slice(2)),e]}let sf=0;const Zx=Promise.resolve(),eA=()=>sf||(Zx.then(()=>sf=0),sf=Date.now());function tA(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Zr(nA(r,t.value),e,5,[r])};return t.value=n,t.attached=eA(),t}function nA(n,e){if(Me(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const sv=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,rA=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?Gx(n,r,o):e==="style"?Wx(n,t,r):zd(e)?Ep(e)||Yx(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):sA(n,e,r,o))?(tv(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ev(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!nn(r))?tv(n,Ir(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),ev(n,e,r,o))};function sA(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&sv(e)&&Ge(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return sv(e)&&nn(t)?!1:e in n}const Ea=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Me(e)?t=>Gc(e,t):e};function iA(n){n.target.composing=!0}function iv(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const _s=Symbol("_assign"),xt={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[_s]=Ea(s);const i=r||s.props&&s.props.type==="number";ni(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=hd(a)),n[_s](a)}),t&&ni(n,"change",()=>{n.value=n.value.trim()}),e||(ni(n,"compositionstart",iA),ni(n,"compositionend",iv),ni(n,"change",iv))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[_s]=Ea(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?hd(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},Ta={deep:!0,created(n,e,t){n[_s]=Ea(t),ni(n,"change",()=>{const r=n._modelValue,s=hu(n),i=n.checked,o=n[_s];if(Me(r)){const a=Ap(r,s),l=a!==-1;if(i&&!l)o(r.concat(s));else if(!i&&l){const c=[...r];c.splice(a,1),o(c)}}else if(Ga(r)){const a=new Set(r);i?a.add(s):a.delete(s),o(a)}else o(S0(n,i))})},mounted:ov,beforeUpdate(n,e,t){n[_s]=Ea(t),ov(n,e,t)}};function ov(n,{value:e,oldValue:t},r){n._modelValue=e;let s;if(Me(e))s=Ap(e,r.props.value)>-1;else if(Ga(e))s=e.has(r.props.value);else{if(e===t)return;s=Ou(e,S0(n,!0))}n.checked!==s&&(n.checked=s)}const oA={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const s=Ga(e);ni(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?hd(hu(o)):hu(o));n[_s](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,cn(()=>{n._assigning=!1})}),n[_s]=Ea(r)},mounted(n,{value:e}){av(n,e)},beforeUpdate(n,e,t){n[_s]=Ea(t)},updated(n,{value:e}){n._assigning||av(n,e)}};function av(n,e){const t=n.multiple,r=Me(e);if(!(t&&!r&&!Ga(e))){for(let s=0,i=n.options.length;s<i;s++){const o=n.options[s],a=hu(o);if(t)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=Ap(e,a)>-1}else o.selected=e.has(a);else if(Ou(hu(o),e)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function hu(n){return"_value"in n?n._value:n.value}function S0(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const aA=["ctrl","shift","alt","meta"],lA={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>aA.some(t=>n[`${t}Key`]&&!e.includes(t))},Vt=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=lA[e[o]];if(a&&a(s,e))return}return n(s,...i)})},uA={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},On=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Ri(s.key);if(e.some(o=>o===i||uA[o]===i))return n(s)})},cA=In({patchProp:rA},qx);let lv;function dA(){return lv||(lv=fx(cA))}const hA=(...n)=>{const e=dA().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=pA(r);if(!s)return;const i=e._component;!Ge(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,fA(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function fA(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function pA(n){return nn(n)?document.querySelector(n):n}const mA={__name:"App",setup(n){return(e,t)=>{const r=JT("router-view");return F(),cu(r)}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const ia=typeof document<"u";function P0(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function gA(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&P0(n.default)}const ht=Object.assign;function of(n,e){const t={};for(const r in e){const s=e[r];t[r]=Mr(s)?s.map(n):n(s)}return t}const Xl=()=>{},Mr=Array.isArray,R0=/#/g,vA=/&/g,yA=/\//g,_A=/=/g,bA=/\?/g,C0=/\+/g,wA=/%5B/g,IA=/%5D/g,k0=/%5E/g,EA=/%60/g,D0=/%7B/g,TA=/%7C/g,V0=/%7D/g,xA=/%20/g;function jp(n){return encodeURI(""+n).replace(TA,"|").replace(wA,"[").replace(IA,"]")}function AA(n){return jp(n).replace(D0,"{").replace(V0,"}").replace(k0,"^")}function Ff(n){return jp(n).replace(C0,"%2B").replace(xA,"+").replace(R0,"%23").replace(vA,"%26").replace(EA,"`").replace(D0,"{").replace(V0,"}").replace(k0,"^")}function SA(n){return Ff(n).replace(_A,"%3D")}function PA(n){return jp(n).replace(R0,"%23").replace(bA,"%3F")}function RA(n){return n==null?"":PA(n).replace(yA,"%2F")}function fu(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const CA=/\/$/,kA=n=>n.replace(CA,"");function af(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=OA(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:fu(o)}}function DA(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function uv(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function VA(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&xa(e.matched[r],t.matched[s])&&N0(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function xa(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function N0(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!NA(n[t],e[t]))return!1;return!0}function NA(n,e){return Mr(n)?cv(n,e):Mr(e)?cv(e,n):n===e}function cv(n,e){return Mr(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function OA(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const Qs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var pu;(function(n){n.pop="pop",n.push="push"})(pu||(pu={}));var Zl;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Zl||(Zl={}));function MA(n){if(!n)if(ia){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),kA(n)}const LA=/^[^#]+#/;function FA(n,e){return n.replace(LA,"#")+e}function $A(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const th=()=>({left:window.scrollX,top:window.scrollY});function UA(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=$A(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function dv(n,e){return(history.state?history.state.position-e:-1)+n}const $f=new Map;function jA(n,e){$f.set(n,e)}function BA(n){const e=$f.get(n);return $f.delete(n),e}let qA=()=>location.protocol+"//"+location.host;function O0(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),uv(l,"")}return uv(t,n)+r+s}function zA(n,e,t,r){let s=[],i=[],o=null;const a=({state:g})=>{const y=O0(n,location),x=t.value,S=e.value;let P=0;if(g){if(t.value=y,e.value=g,o&&o===x){o=null;return}P=S?g.position-S.position:0}else r(y);s.forEach(j=>{j(t.value,x,{delta:P,type:pu.pop,direction:P?P>0?Zl.forward:Zl.back:Zl.unknown})})};function l(){o=t.value}function c(g){s.push(g);const y=()=>{const x=s.indexOf(g);x>-1&&s.splice(x,1)};return i.push(y),y}function d(){const{history:g}=window;g.state&&g.replaceState(ht({},g.state,{scroll:th()}),"")}function f(){for(const g of i)g();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function hv(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?th():null}}function GA(n){const{history:e,location:t}=window,r={value:O0(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,d){const f=n.indexOf("#"),g=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:qA()+n+l;try{e[d?"replaceState":"pushState"](c,"",g),s.value=c}catch(y){console.error(y),t[d?"replace":"assign"](g)}}function o(l,c){const d=ht({},e.state,hv(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,d,!0),r.value=l}function a(l,c){const d=ht({},s.value,e.state,{forward:l,scroll:th()});i(d.current,d,!0);const f=ht({},hv(r.value,l,null),{position:d.position+1},c);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function KA(n){n=MA(n);const e=GA(n),t=zA(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=ht({location:"",base:n,go:r,createHref:FA.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function HA(n){return typeof n=="string"||n&&typeof n=="object"}function M0(n){return typeof n=="string"||typeof n=="symbol"}const L0=Symbol("");var fv;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(fv||(fv={}));function Aa(n,e){return ht(new Error,{type:n,[L0]:!0},e)}function us(n,e){return n instanceof Error&&L0 in n&&(e==null||!!(n.type&e))}const pv="[^/]+?",WA={sensitive:!1,strict:!1,start:!0,end:!0},QA=/[.+*?^${}()[\]/\\]/g;function JA(n,e){const t=ht({},WA,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const d=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const g=c[f];let y=40+(t.sensitive?.25:0);if(g.type===0)f||(s+="/"),s+=g.value.replace(QA,"\\$&"),y+=40;else if(g.type===1){const{value:x,repeatable:S,optional:P,regexp:j}=g;i.push({name:x,repeatable:S,optional:P});const U=j||pv;if(U!==pv){y+=10;try{new RegExp(`(${U})`)}catch(G){throw new Error(`Invalid custom RegExp for param "${x}" (${U}): `+G.message)}}let D=S?`((?:${U})(?:/(?:${U}))*)`:`(${U})`;f||(D=P&&c.length<2?`(?:/${D})`:"/"+D),P&&(D+="?"),s+=D,y+=20,P&&(y+=-8),S&&(y+=-20),U===".*"&&(y+=-50)}d.push(y)}r.push(d)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const d=c.match(o),f={};if(!d)return null;for(let g=1;g<d.length;g++){const y=d[g]||"",x=i[g-1];f[x.name]=y&&x.repeatable?y.split("/"):y}return f}function l(c){let d="",f=!1;for(const g of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const y of g)if(y.type===0)d+=y.value;else if(y.type===1){const{value:x,repeatable:S,optional:P}=y,j=x in c?c[x]:"";if(Mr(j)&&!S)throw new Error(`Provided param "${x}" is an array but it is not repeatable (* or + modifiers)`);const U=Mr(j)?j.join("/"):j;if(!U)if(P)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${x}"`);d+=U}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function YA(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function F0(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=YA(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(mv(r))return 1;if(mv(s))return-1}return s.length-r.length}function mv(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const XA={type:0,value:""},ZA=/[a-zA-Z0-9_]/;function eS(n){if(!n)return[[]];if(n==="/")return[[XA]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(y){throw new Error(`ERR (${t})/"${c}": ${y}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",d="";function f(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function g(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&f(),o()):l===":"?(f(),t=1):g();break;case 4:g(),t=r;break;case 1:l==="("?t=2:ZA.test(l)?g():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:t=3:d+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),s}function tS(n,e,t){const r=JA(eS(n.path),t),s=ht(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function nS(n,e){const t=[],r=new Map;e=_v({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,g,y){const x=!y,S=vv(f);S.aliasOf=y&&y.record;const P=_v(e,f),j=[S];if("alias"in f){const G=typeof f.alias=="string"?[f.alias]:f.alias;for(const Z of G)j.push(vv(ht({},S,{components:y?y.record.components:S.components,path:Z,aliasOf:y?y.record:S})))}let U,D;for(const G of j){const{path:Z}=G;if(g&&Z[0]!=="/"){const me=g.record.path,T=me[me.length-1]==="/"?"":"/";G.path=g.record.path+(Z&&T+Z)}if(U=tS(G,g,P),y?y.alias.push(U):(D=D||U,D!==U&&D.alias.push(U),x&&f.name&&!yv(U)&&o(f.name)),$0(U)&&l(U),S.children){const me=S.children;for(let T=0;T<me.length;T++)i(me[T],U,y&&y.children[T])}y=y||U}return D?()=>{o(D)}:Xl}function o(f){if(M0(f)){const g=r.get(f);g&&(r.delete(f),t.splice(t.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=t.indexOf(f);g>-1&&(t.splice(g,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const g=iS(f,t);t.splice(g,0,f),f.record.name&&!yv(f)&&r.set(f.record.name,f)}function c(f,g){let y,x={},S,P;if("name"in f&&f.name){if(y=r.get(f.name),!y)throw Aa(1,{location:f});P=y.record.name,x=ht(gv(g.params,y.keys.filter(D=>!D.optional).concat(y.parent?y.parent.keys.filter(D=>D.optional):[]).map(D=>D.name)),f.params&&gv(f.params,y.keys.map(D=>D.name))),S=y.stringify(x)}else if(f.path!=null)S=f.path,y=t.find(D=>D.re.test(S)),y&&(x=y.parse(S),P=y.record.name);else{if(y=g.name?r.get(g.name):t.find(D=>D.re.test(g.path)),!y)throw Aa(1,{location:f,currentLocation:g});P=y.record.name,x=ht({},g.params,f.params),S=y.stringify(x)}const j=[];let U=y;for(;U;)j.unshift(U.record),U=U.parent;return{name:P,path:S,params:x,matched:j,meta:sS(j)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function gv(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function vv(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:rS(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function rS(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function yv(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function sS(n){return n.reduce((e,t)=>ht(e,t.meta),{})}function _v(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function iS(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;F0(n,e[i])<0?r=i:t=i+1}const s=oS(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function oS(n){let e=n;for(;e=e.parent;)if($0(e)&&F0(n,e)===0)return e}function $0({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function aS(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(C0," "),o=i.indexOf("="),a=fu(o<0?i:i.slice(0,o)),l=o<0?null:fu(i.slice(o+1));if(a in e){let c=e[a];Mr(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function bv(n){let e="";for(let t in n){const r=n[t];if(t=SA(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Mr(r)?r.map(i=>i&&Ff(i)):[r&&Ff(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function lS(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Mr(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const uS=Symbol(""),wv=Symbol(""),nh=Symbol(""),Bp=Symbol(""),Uf=Symbol("");function Pl(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ti(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=g=>{g===!1?l(Aa(4,{from:t,to:e})):g instanceof Error?l(g):HA(g)?l(Aa(2,{from:e,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),a())},d=i(()=>n.call(r&&r.instances[s],e,t,c));let f=Promise.resolve(d);n.length<3&&(f=f.then(c)),f.catch(g=>l(g))})}function lf(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(P0(l)){const d=(l.__vccOpts||l)[e];d&&i.push(ti(d,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=gA(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const y=(f.__vccOpts||f)[e];return y&&ti(y,t,r,o,a,s)()}))}}return i}function Iv(n){const e=Or(nh),t=Or(Bp),r=$e(()=>{const l=ys(n.to);return e.resolve(l)}),s=$e(()=>{const{matched:l}=r.value,{length:c}=l,d=l[c-1],f=t.matched;if(!d||!f.length)return-1;const g=f.findIndex(xa.bind(null,d));if(g>-1)return g;const y=Ev(l[c-2]);return c>1&&Ev(d)===y&&f[f.length-1].path!==y?f.findIndex(xa.bind(null,l[c-2])):g}),i=$e(()=>s.value>-1&&pS(t.params,r.value.params)),o=$e(()=>s.value>-1&&s.value===t.matched.length-1&&N0(t.params,r.value.params));function a(l={}){if(fS(l)){const c=e[ys(n.replace)?"replace":"push"](ys(n.to)).catch(Xl);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:$e(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function cS(n){return n.length===1?n[0]:n}const dS=e0({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Iv,setup(n,{slots:e}){const t=Qd(Iv(n)),{options:r}=Or(nh),s=$e(()=>({[Tv(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Tv(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&cS(e.default(t));return n.custom?i:T0("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),hS=dS;function fS(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function pS(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Mr(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Ev(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Tv=(n,e,t)=>n??e??t,mS=e0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Or(Uf),s=$e(()=>n.route||r.value),i=Or(wv,0),o=$e(()=>{let c=ys(i);const{matched:d}=s.value;let f;for(;(f=d[c])&&!f.components;)c++;return c}),a=$e(()=>s.value.matched[o.value]);Hc(wv,$e(()=>o.value+1)),Hc(uS,a),Hc(Uf,s);const l=O();return Nt(()=>[l.value,a.value,n.name],([c,d,f],[g,y,x])=>{d&&(d.instances[f]=c,y&&y!==d&&c&&c===g&&(d.leaveGuards.size||(d.leaveGuards=y.leaveGuards),d.updateGuards.size||(d.updateGuards=y.updateGuards))),c&&d&&(!y||!xa(d,y)||!g)&&(d.enterCallbacks[f]||[]).forEach(S=>S(c))},{flush:"post"}),()=>{const c=s.value,d=n.name,f=a.value,g=f&&f.components[d];if(!g)return xv(t.default,{Component:g,route:c});const y=f.props[d],x=y?y===!0?c.params:typeof y=="function"?y(c):y:null,P=T0(g,ht({},x,e,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(f.instances[d]=null)},ref:l}));return xv(t.default,{Component:P,route:c})||P}}});function xv(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const gS=mS;function vS(n){const e=nS(n.routes,n),t=n.parseQuery||aS,r=n.stringifyQuery||bv,s=n.history,i=Pl(),o=Pl(),a=Pl(),l=xT(Qs);let c=Qs;ia&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=of.bind(null,k=>""+k),f=of.bind(null,RA),g=of.bind(null,fu);function y(k,L){let J,X;return M0(k)?(J=e.getRecordMatcher(k),X=L):X=k,e.addRoute(X,J)}function x(k){const L=e.getRecordMatcher(k);L&&e.removeRoute(L)}function S(){return e.getRoutes().map(k=>k.record)}function P(k){return!!e.getRecordMatcher(k)}function j(k,L){if(L=ht({},L||l.value),typeof k=="string"){const A=af(t,k,L.path),M=e.resolve({path:A.path},L),ee=s.createHref(A.fullPath);return ht(A,M,{params:g(M.params),hash:fu(A.hash),redirectedFrom:void 0,href:ee})}let J;if(k.path!=null)J=ht({},k,{path:af(t,k.path,L.path).path});else{const A=ht({},k.params);for(const M in A)A[M]==null&&delete A[M];J=ht({},k,{params:f(A)}),L.params=f(L.params)}const X=e.resolve(J,L),Pe=k.hash||"";X.params=d(g(X.params));const Oe=DA(r,ht({},k,{hash:AA(Pe),path:X.path})),E=s.createHref(Oe);return ht({fullPath:Oe,hash:Pe,query:r===bv?lS(k.query):k.query||{}},X,{redirectedFrom:void 0,href:E})}function U(k){return typeof k=="string"?af(t,k,l.value.path):ht({},k)}function D(k,L){if(c!==k)return Aa(8,{from:L,to:k})}function G(k){return T(k)}function Z(k){return G(ht(U(k),{replace:!0}))}function me(k){const L=k.matched[k.matched.length-1];if(L&&L.redirect){const{redirect:J}=L;let X=typeof J=="function"?J(k):J;return typeof X=="string"&&(X=X.includes("?")||X.includes("#")?X=U(X):{path:X},X.params={}),ht({query:k.query,hash:k.hash,params:X.path!=null?{}:k.params},X)}}function T(k,L){const J=c=j(k),X=l.value,Pe=k.state,Oe=k.force,E=k.replace===!0,A=me(J);if(A)return T(ht(U(A),{state:typeof A=="object"?ht({},Pe,A.state):Pe,force:Oe,replace:E}),L||J);const M=J;M.redirectedFrom=L;let ee;return!Oe&&VA(r,X,J)&&(ee=Aa(16,{to:M,from:X}),Rt(X,X,!0,!1)),(ee?Promise.resolve(ee):C(M,X)).catch(Y=>us(Y)?us(Y,2)?Y:rn(Y):Ue(Y,M,X)).then(Y=>{if(Y){if(us(Y,2))return T(ht({replace:E},U(Y.to),{state:typeof Y.to=="object"?ht({},Pe,Y.to.state):Pe,force:Oe}),L||M)}else Y=B(M,X,!0,E,Pe);return N(M,X,Y),Y})}function w(k,L){const J=D(k,L);return J?Promise.reject(J):Promise.resolve()}function I(k){const L=ze.values().next().value;return L&&typeof L.runWithContext=="function"?L.runWithContext(k):k()}function C(k,L){let J;const[X,Pe,Oe]=yS(k,L);J=lf(X.reverse(),"beforeRouteLeave",k,L);for(const A of X)A.leaveGuards.forEach(M=>{J.push(ti(M,k,L))});const E=w.bind(null,k,L);return J.push(E),dt(J).then(()=>{J=[];for(const A of i.list())J.push(ti(A,k,L));return J.push(E),dt(J)}).then(()=>{J=lf(Pe,"beforeRouteUpdate",k,L);for(const A of Pe)A.updateGuards.forEach(M=>{J.push(ti(M,k,L))});return J.push(E),dt(J)}).then(()=>{J=[];for(const A of Oe)if(A.beforeEnter)if(Mr(A.beforeEnter))for(const M of A.beforeEnter)J.push(ti(M,k,L));else J.push(ti(A.beforeEnter,k,L));return J.push(E),dt(J)}).then(()=>(k.matched.forEach(A=>A.enterCallbacks={}),J=lf(Oe,"beforeRouteEnter",k,L,I),J.push(E),dt(J))).then(()=>{J=[];for(const A of o.list())J.push(ti(A,k,L));return J.push(E),dt(J)}).catch(A=>us(A,8)?A:Promise.reject(A))}function N(k,L,J){a.list().forEach(X=>I(()=>X(k,L,J)))}function B(k,L,J,X,Pe){const Oe=D(k,L);if(Oe)return Oe;const E=L===Qs,A=ia?history.state:{};J&&(X||E?s.replace(k.fullPath,ht({scroll:E&&A&&A.scroll},Pe)):s.push(k.fullPath,Pe)),l.value=k,Rt(k,L,J,E),rn()}let R;function Pt(){R||(R=s.listen((k,L,J)=>{if(!rt.listening)return;const X=j(k),Pe=me(X);if(Pe){T(ht(Pe,{replace:!0,force:!0}),X).catch(Xl);return}c=X;const Oe=l.value;ia&&jA(dv(Oe.fullPath,J.delta),th()),C(X,Oe).catch(E=>us(E,12)?E:us(E,2)?(T(ht(U(E.to),{force:!0}),X).then(A=>{us(A,20)&&!J.delta&&J.type===pu.pop&&s.go(-1,!1)}).catch(Xl),Promise.reject()):(J.delta&&s.go(-J.delta,!1),Ue(E,X,Oe))).then(E=>{E=E||B(X,Oe,!1),E&&(J.delta&&!us(E,8)?s.go(-J.delta,!1):J.type===pu.pop&&us(E,20)&&s.go(-1,!1)),N(X,Oe,E)}).catch(Xl)}))}let Et=Pl(),Xe=Pl(),Le;function Ue(k,L,J){rn(k);const X=Xe.list();return X.length?X.forEach(Pe=>Pe(k,L,J)):console.error(k),Promise.reject(k)}function hn(){return Le&&l.value!==Qs?Promise.resolve():new Promise((k,L)=>{Et.add([k,L])})}function rn(k){return Le||(Le=!k,Pt(),Et.list().forEach(([L,J])=>k?J(k):L()),Et.reset()),k}function Rt(k,L,J,X){const{scrollBehavior:Pe}=n;if(!ia||!Pe)return Promise.resolve();const Oe=!J&&BA(dv(k.fullPath,0))||(X||!J)&&history.state&&history.state.scroll||null;return cn().then(()=>Pe(k,L,Oe)).then(E=>E&&UA(E)).catch(E=>Ue(E,k,L))}const fe=k=>s.go(k);let oe;const ze=new Set,rt={currentRoute:l,listening:!0,addRoute:y,removeRoute:x,clearRoutes:e.clearRoutes,hasRoute:P,getRoutes:S,resolve:j,options:n,push:G,replace:Z,go:fe,back:()=>fe(-1),forward:()=>fe(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Xe.add,isReady:hn,install(k){const L=this;k.component("RouterLink",hS),k.component("RouterView",gS),k.config.globalProperties.$router=L,Object.defineProperty(k.config.globalProperties,"$route",{enumerable:!0,get:()=>ys(l)}),ia&&!oe&&l.value===Qs&&(oe=!0,G(s.location).catch(Pe=>{}));const J={};for(const Pe in Qs)Object.defineProperty(J,Pe,{get:()=>l.value[Pe],enumerable:!0});k.provide(nh,L),k.provide(Bp,B_(J)),k.provide(Uf,l);const X=k.unmount;ze.add(k),k.unmount=function(){ze.delete(k),ze.size<1&&(c=Qs,R&&R(),R=null,l.value=Qs,oe=!1,Le=!1),X()}}};function dt(k){return k.reduce((L,J)=>L.then(()=>I(J)),Promise.resolve())}return rt}function yS(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>xa(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>xa(c,l))||s.push(l))}return[t,r,s]}function Fu(){return Or(nh)}function Ka(n){return Or(Bp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},_S=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},j0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let g=(a&15)<<2|c>>6,y=c&63;l||(y=64,o||(g=64)),r.push(t[d],t[f],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(U0(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_S(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new bS;const g=i<<2|a>>4;if(r.push(g),c!==64){const y=a<<4&240|c>>2;if(r.push(y),f!==64){const x=c<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wS=function(n){const e=U0(n);return j0.encodeByteArray(e,!0)},wd=function(n){return wS(n).replace(/\./g,"")},B0=function(n){try{return j0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES=()=>IS().__FIREBASE_DEFAULTS__,TS=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&B0(n[1]);return e&&JSON.parse(e)},rh=()=>{try{return ES()||TS()||xS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},q0=n=>{var e,t;return(t=(e=rh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},AS=n=>{const e=q0(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},z0=()=>{var n;return(n=rh())===null||n===void 0?void 0:n.config},G0=n=>{var e;return(e=rh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[wd(JSON.stringify(t)),wd(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mn())}function CS(){var n;const e=(n=rh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DS(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function VS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NS(){const n=mn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function K0(){return!CS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function H0(){try{return typeof indexedDB=="object"}catch{return!1}}function OS(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="FirebaseError";class Cs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=MS,Object.setPrototypeOf(this,Cs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$u.prototype.create)}}class $u{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?LS(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Cs(s,a,r)}}function LS(n,e){return n.replace(FS,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const FS=/\{\$([^}]+)}/g;function $S(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Av(i)&&Av(o)){if(!bi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Av(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ha(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ll(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Fl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function US(n,e){const t=new jS(n,e);return t.subscribe.bind(t)}class jS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");BS(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=uf),s.error===void 0&&(s.error=uf),s.complete===void 0&&(s.complete=uf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function BS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function uf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(n){return n&&n._delegate?n._delegate:n}class vo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new SS;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(GS(e))try{this.getOrInitializeService({instanceIdentifier:to})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=to){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=to){return this.instances.has(e)}getOptions(e=to){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:zS(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=to){return this.component?this.component.multipleInstances?e:to:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zS(n){return n===to?void 0:n}function GS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new qS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(et||(et={}));const HS={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},WS=et.INFO,QS={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},JS=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=QS[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qp{constructor(e){this.name=e,this._logLevel=WS,this._logHandler=JS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}}const YS=(n,e)=>e.some(t=>n instanceof t);let Sv,Pv;function XS(){return Sv||(Sv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZS(){return Pv||(Pv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const W0=new WeakMap,jf=new WeakMap,Q0=new WeakMap,cf=new WeakMap,zp=new WeakMap;function eP(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(hi(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&W0.set(t,n)}).catch(()=>{}),zp.set(e,n),e}function tP(n){if(jf.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});jf.set(n,e)}let Bf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return jf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Q0.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return hi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nP(n){Bf=n(Bf)}function rP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(df(this),e,...t);return Q0.set(r,e.sort?e.sort():[e]),hi(r)}:ZS().includes(n)?function(...e){return n.apply(df(this),e),hi(W0.get(this))}:function(...e){return hi(n.apply(df(this),e))}}function sP(n){return typeof n=="function"?rP(n):(n instanceof IDBTransaction&&tP(n),YS(n,XS())?new Proxy(n,Bf):n)}function hi(n){if(n instanceof IDBRequest)return eP(n);if(cf.has(n))return cf.get(n);const e=sP(n);return e!==n&&(cf.set(n,e),zp.set(e,n)),e}const df=n=>zp.get(n);function iP(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=hi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(hi(o.result),l.oldVersion,l.newVersion,hi(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const oP=["get","getKey","getAll","getAllKeys","count"],aP=["put","add","delete","clear"],hf=new Map;function Rv(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hf.get(e))return hf.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=aP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||oP.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return hf.set(e,i),i}nP(n=>({...n,get:(e,t,r)=>Rv(e,t)||n.get(e,t,r),has:(e,t)=>!!Rv(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(uP(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function uP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qf="@firebase/app",Cv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es=new qp("@firebase/app"),cP="@firebase/app-compat",dP="@firebase/analytics-compat",hP="@firebase/analytics",fP="@firebase/app-check-compat",pP="@firebase/app-check",mP="@firebase/auth",gP="@firebase/auth-compat",vP="@firebase/database",yP="@firebase/data-connect",_P="@firebase/database-compat",bP="@firebase/functions",wP="@firebase/functions-compat",IP="@firebase/installations",EP="@firebase/installations-compat",TP="@firebase/messaging",xP="@firebase/messaging-compat",AP="@firebase/performance",SP="@firebase/performance-compat",PP="@firebase/remote-config",RP="@firebase/remote-config-compat",CP="@firebase/storage",kP="@firebase/storage-compat",DP="@firebase/firestore",VP="@firebase/vertexai-preview",NP="@firebase/firestore-compat",OP="firebase",MP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id="[DEFAULT]",LP={[qf]:"fire-core",[cP]:"fire-core-compat",[hP]:"fire-analytics",[dP]:"fire-analytics-compat",[pP]:"fire-app-check",[fP]:"fire-app-check-compat",[mP]:"fire-auth",[gP]:"fire-auth-compat",[vP]:"fire-rtdb",[yP]:"fire-data-connect",[_P]:"fire-rtdb-compat",[bP]:"fire-fn",[wP]:"fire-fn-compat",[IP]:"fire-iid",[EP]:"fire-iid-compat",[TP]:"fire-fcm",[xP]:"fire-fcm-compat",[AP]:"fire-perf",[SP]:"fire-perf-compat",[PP]:"fire-rc",[RP]:"fire-rc-compat",[CP]:"fire-gcs",[kP]:"fire-gcs-compat",[DP]:"fire-fst",[NP]:"fire-fst-compat",[VP]:"fire-vertex","fire-js":"fire-js",[OP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed=new Map,FP=new Map,zf=new Map;function kv(n,e){try{n.container.addComponent(e)}catch(t){Es.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Sa(n){const e=n.name;if(zf.has(e))return Es.debug(`There were multiple attempts to register component ${e}.`),!1;zf.set(e,n);for(const t of Ed.values())kv(t,n);for(const t of FP.values())kv(t,n);return!0}function Uu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $P(n,e,t=Id){Uu(n,e).clearInstance(t)}function Zt(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fi=new $u("app","Firebase",UP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=MP;function J0(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Id,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw fi.create("bad-app-name",{appName:String(s)});if(t||(t=z0()),!t)throw fi.create("no-options");const i=Ed.get(s);if(i){if(bi(t,i.options)&&bi(r,i.config))return i;throw fi.create("duplicate-app",{appName:s})}const o=new KS(s);for(const l of zf.values())o.addComponent(l);const a=new jP(t,r,o);return Ed.set(s,a),a}function Y0(n=Id){const e=Ed.get(n);if(!e&&n===Id&&z0())return J0();if(!e)throw fi.create("no-app",{appName:n});return e}function pi(n,e,t){var r;let s=(r=LP[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Es.warn(a.join(" "));return}Sa(new vo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP="firebase-heartbeat-database",qP=1,mu="firebase-heartbeat-store";let ff=null;function X0(){return ff||(ff=iP(BP,qP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(mu)}catch(t){console.warn(t)}}}}).catch(n=>{throw fi.create("idb-open",{originalErrorMessage:n.message})})),ff}async function zP(n){try{const t=(await X0()).transaction(mu),r=await t.objectStore(mu).get(Z0(n));return await t.done,r}catch(e){if(e instanceof Cs)Es.warn(e.message);else{const t=fi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Es.warn(t.message)}}}async function Dv(n,e){try{const r=(await X0()).transaction(mu,"readwrite");await r.objectStore(mu).put(e,Z0(n)),await r.done}catch(t){if(t instanceof Cs)Es.warn(t.message);else{const r=fi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Es.warn(r.message)}}}function Z0(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=1024,KP=30*24*60*60*1e3;class HP{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new QP(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Vv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=KP}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Es.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Vv(),{heartbeatsToSend:r,unsentEntries:s}=WP(this._heartbeatsCache.heartbeats),i=wd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Es.warn(t),""}}}function Vv(){return new Date().toISOString().substring(0,10)}function WP(n,e=GP){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Nv(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Nv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class QP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return H0()?OS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zP(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Nv(n){return wd(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(n){Sa(new vo("platform-logger",e=>new lP(e),"PRIVATE")),Sa(new vo("heartbeat",e=>new HP(e),"PRIVATE")),pi(qf,Cv,n),pi(qf,Cv,"esm2017"),pi("fire-js","")}JP("");var YP="firebase",XP="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pi(YP,XP,"app");var Ov=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fo,eb;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,w){function I(){}I.prototype=w.prototype,T.D=w.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(C,N,B){for(var R=Array(arguments.length-2),Pt=2;Pt<arguments.length;Pt++)R[Pt-2]=arguments[Pt];return w.prototype[N].apply(C,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,w,I){I||(I=0);var C=Array(16);if(typeof w=="string")for(var N=0;16>N;++N)C[N]=w.charCodeAt(I++)|w.charCodeAt(I++)<<8|w.charCodeAt(I++)<<16|w.charCodeAt(I++)<<24;else for(N=0;16>N;++N)C[N]=w[I++]|w[I++]<<8|w[I++]<<16|w[I++]<<24;w=T.g[0],I=T.g[1],N=T.g[2];var B=T.g[3],R=w+(B^I&(N^B))+C[0]+3614090360&4294967295;w=I+(R<<7&4294967295|R>>>25),R=B+(N^w&(I^N))+C[1]+3905402710&4294967295,B=w+(R<<12&4294967295|R>>>20),R=N+(I^B&(w^I))+C[2]+606105819&4294967295,N=B+(R<<17&4294967295|R>>>15),R=I+(w^N&(B^w))+C[3]+3250441966&4294967295,I=N+(R<<22&4294967295|R>>>10),R=w+(B^I&(N^B))+C[4]+4118548399&4294967295,w=I+(R<<7&4294967295|R>>>25),R=B+(N^w&(I^N))+C[5]+1200080426&4294967295,B=w+(R<<12&4294967295|R>>>20),R=N+(I^B&(w^I))+C[6]+2821735955&4294967295,N=B+(R<<17&4294967295|R>>>15),R=I+(w^N&(B^w))+C[7]+4249261313&4294967295,I=N+(R<<22&4294967295|R>>>10),R=w+(B^I&(N^B))+C[8]+1770035416&4294967295,w=I+(R<<7&4294967295|R>>>25),R=B+(N^w&(I^N))+C[9]+2336552879&4294967295,B=w+(R<<12&4294967295|R>>>20),R=N+(I^B&(w^I))+C[10]+4294925233&4294967295,N=B+(R<<17&4294967295|R>>>15),R=I+(w^N&(B^w))+C[11]+2304563134&4294967295,I=N+(R<<22&4294967295|R>>>10),R=w+(B^I&(N^B))+C[12]+1804603682&4294967295,w=I+(R<<7&4294967295|R>>>25),R=B+(N^w&(I^N))+C[13]+4254626195&4294967295,B=w+(R<<12&4294967295|R>>>20),R=N+(I^B&(w^I))+C[14]+2792965006&4294967295,N=B+(R<<17&4294967295|R>>>15),R=I+(w^N&(B^w))+C[15]+1236535329&4294967295,I=N+(R<<22&4294967295|R>>>10),R=w+(N^B&(I^N))+C[1]+4129170786&4294967295,w=I+(R<<5&4294967295|R>>>27),R=B+(I^N&(w^I))+C[6]+3225465664&4294967295,B=w+(R<<9&4294967295|R>>>23),R=N+(w^I&(B^w))+C[11]+643717713&4294967295,N=B+(R<<14&4294967295|R>>>18),R=I+(B^w&(N^B))+C[0]+3921069994&4294967295,I=N+(R<<20&4294967295|R>>>12),R=w+(N^B&(I^N))+C[5]+3593408605&4294967295,w=I+(R<<5&4294967295|R>>>27),R=B+(I^N&(w^I))+C[10]+38016083&4294967295,B=w+(R<<9&4294967295|R>>>23),R=N+(w^I&(B^w))+C[15]+3634488961&4294967295,N=B+(R<<14&4294967295|R>>>18),R=I+(B^w&(N^B))+C[4]+3889429448&4294967295,I=N+(R<<20&4294967295|R>>>12),R=w+(N^B&(I^N))+C[9]+568446438&4294967295,w=I+(R<<5&4294967295|R>>>27),R=B+(I^N&(w^I))+C[14]+3275163606&4294967295,B=w+(R<<9&4294967295|R>>>23),R=N+(w^I&(B^w))+C[3]+4107603335&4294967295,N=B+(R<<14&4294967295|R>>>18),R=I+(B^w&(N^B))+C[8]+1163531501&4294967295,I=N+(R<<20&4294967295|R>>>12),R=w+(N^B&(I^N))+C[13]+2850285829&4294967295,w=I+(R<<5&4294967295|R>>>27),R=B+(I^N&(w^I))+C[2]+4243563512&4294967295,B=w+(R<<9&4294967295|R>>>23),R=N+(w^I&(B^w))+C[7]+1735328473&4294967295,N=B+(R<<14&4294967295|R>>>18),R=I+(B^w&(N^B))+C[12]+2368359562&4294967295,I=N+(R<<20&4294967295|R>>>12),R=w+(I^N^B)+C[5]+4294588738&4294967295,w=I+(R<<4&4294967295|R>>>28),R=B+(w^I^N)+C[8]+2272392833&4294967295,B=w+(R<<11&4294967295|R>>>21),R=N+(B^w^I)+C[11]+1839030562&4294967295,N=B+(R<<16&4294967295|R>>>16),R=I+(N^B^w)+C[14]+4259657740&4294967295,I=N+(R<<23&4294967295|R>>>9),R=w+(I^N^B)+C[1]+2763975236&4294967295,w=I+(R<<4&4294967295|R>>>28),R=B+(w^I^N)+C[4]+1272893353&4294967295,B=w+(R<<11&4294967295|R>>>21),R=N+(B^w^I)+C[7]+4139469664&4294967295,N=B+(R<<16&4294967295|R>>>16),R=I+(N^B^w)+C[10]+3200236656&4294967295,I=N+(R<<23&4294967295|R>>>9),R=w+(I^N^B)+C[13]+681279174&4294967295,w=I+(R<<4&4294967295|R>>>28),R=B+(w^I^N)+C[0]+3936430074&4294967295,B=w+(R<<11&4294967295|R>>>21),R=N+(B^w^I)+C[3]+3572445317&4294967295,N=B+(R<<16&4294967295|R>>>16),R=I+(N^B^w)+C[6]+76029189&4294967295,I=N+(R<<23&4294967295|R>>>9),R=w+(I^N^B)+C[9]+3654602809&4294967295,w=I+(R<<4&4294967295|R>>>28),R=B+(w^I^N)+C[12]+3873151461&4294967295,B=w+(R<<11&4294967295|R>>>21),R=N+(B^w^I)+C[15]+530742520&4294967295,N=B+(R<<16&4294967295|R>>>16),R=I+(N^B^w)+C[2]+3299628645&4294967295,I=N+(R<<23&4294967295|R>>>9),R=w+(N^(I|~B))+C[0]+4096336452&4294967295,w=I+(R<<6&4294967295|R>>>26),R=B+(I^(w|~N))+C[7]+1126891415&4294967295,B=w+(R<<10&4294967295|R>>>22),R=N+(w^(B|~I))+C[14]+2878612391&4294967295,N=B+(R<<15&4294967295|R>>>17),R=I+(B^(N|~w))+C[5]+4237533241&4294967295,I=N+(R<<21&4294967295|R>>>11),R=w+(N^(I|~B))+C[12]+1700485571&4294967295,w=I+(R<<6&4294967295|R>>>26),R=B+(I^(w|~N))+C[3]+2399980690&4294967295,B=w+(R<<10&4294967295|R>>>22),R=N+(w^(B|~I))+C[10]+4293915773&4294967295,N=B+(R<<15&4294967295|R>>>17),R=I+(B^(N|~w))+C[1]+2240044497&4294967295,I=N+(R<<21&4294967295|R>>>11),R=w+(N^(I|~B))+C[8]+1873313359&4294967295,w=I+(R<<6&4294967295|R>>>26),R=B+(I^(w|~N))+C[15]+4264355552&4294967295,B=w+(R<<10&4294967295|R>>>22),R=N+(w^(B|~I))+C[6]+2734768916&4294967295,N=B+(R<<15&4294967295|R>>>17),R=I+(B^(N|~w))+C[13]+1309151649&4294967295,I=N+(R<<21&4294967295|R>>>11),R=w+(N^(I|~B))+C[4]+4149444226&4294967295,w=I+(R<<6&4294967295|R>>>26),R=B+(I^(w|~N))+C[11]+3174756917&4294967295,B=w+(R<<10&4294967295|R>>>22),R=N+(w^(B|~I))+C[2]+718787259&4294967295,N=B+(R<<15&4294967295|R>>>17),R=I+(B^(N|~w))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(N+(R<<21&4294967295|R>>>11))&4294967295,T.g[2]=T.g[2]+N&4294967295,T.g[3]=T.g[3]+B&4294967295}r.prototype.u=function(T,w){w===void 0&&(w=T.length);for(var I=w-this.blockSize,C=this.B,N=this.h,B=0;B<w;){if(N==0)for(;B<=I;)s(this,T,B),B+=this.blockSize;if(typeof T=="string"){for(;B<w;)if(C[N++]=T.charCodeAt(B++),N==this.blockSize){s(this,C),N=0;break}}else for(;B<w;)if(C[N++]=T[B++],N==this.blockSize){s(this,C),N=0;break}}this.h=N,this.o+=w},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;var I=8*this.o;for(w=T.length-8;w<T.length;++w)T[w]=I&255,I/=256;for(this.u(T),T=Array(16),w=I=0;4>w;++w)for(var C=0;32>C;C+=8)T[I++]=this.g[w]>>>C&255;return T};function i(T,w){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=w(T)}function o(T,w){this.h=w;for(var I=[],C=!0,N=T.length-1;0<=N;N--){var B=T[N]|0;C&&B==w||(I[N]=B,C=!1)}this.g=I}var a={};function l(T){return-128<=T&&128>T?i(T,function(w){return new o([w|0],0>w?-1:0)}):new o([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return f;if(0>T)return P(c(-T));for(var w=[],I=1,C=0;T>=I;C++)w[C]=T/I|0,I*=4294967296;return new o(w,0)}function d(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return P(d(T.substring(1),w));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=c(Math.pow(w,8)),C=f,N=0;N<T.length;N+=8){var B=Math.min(8,T.length-N),R=parseInt(T.substring(N,N+B),w);8>B?(B=c(Math.pow(w,B)),C=C.j(B).add(c(R))):(C=C.j(I),C=C.add(c(R)))}return C}var f=l(0),g=l(1),y=l(16777216);n=o.prototype,n.m=function(){if(S(this))return-P(this).m();for(var T=0,w=1,I=0;I<this.g.length;I++){var C=this.i(I);T+=(0<=C?C:4294967296+C)*w,w*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(x(this))return"0";if(S(this))return"-"+P(this).toString(T);for(var w=c(Math.pow(T,6)),I=this,C="";;){var N=G(I,w).g;I=j(I,N.j(w));var B=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=N,x(I))return B+C;for(;6>B.length;)B="0"+B;C=B+C}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function x(T){if(T.h!=0)return!1;for(var w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function S(T){return T.h==-1}n.l=function(T){return T=j(this,T),S(T)?-1:x(T)?0:1};function P(T){for(var w=T.g.length,I=[],C=0;C<w;C++)I[C]=~T.g[C];return new o(I,~T.h).add(g)}n.abs=function(){return S(this)?P(this):this},n.add=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],C=0,N=0;N<=w;N++){var B=C+(this.i(N)&65535)+(T.i(N)&65535),R=(B>>>16)+(this.i(N)>>>16)+(T.i(N)>>>16);C=R>>>16,B&=65535,R&=65535,I[N]=R<<16|B}return new o(I,I[I.length-1]&-2147483648?-1:0)};function j(T,w){return T.add(P(w))}n.j=function(T){if(x(this)||x(T))return f;if(S(this))return S(T)?P(this).j(P(T)):P(P(this).j(T));if(S(T))return P(this.j(P(T)));if(0>this.l(y)&&0>T.l(y))return c(this.m()*T.m());for(var w=this.g.length+T.g.length,I=[],C=0;C<2*w;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var N=0;N<T.g.length;N++){var B=this.i(C)>>>16,R=this.i(C)&65535,Pt=T.i(N)>>>16,Et=T.i(N)&65535;I[2*C+2*N]+=R*Et,U(I,2*C+2*N),I[2*C+2*N+1]+=B*Et,U(I,2*C+2*N+1),I[2*C+2*N+1]+=R*Pt,U(I,2*C+2*N+1),I[2*C+2*N+2]+=B*Pt,U(I,2*C+2*N+2)}for(C=0;C<w;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=w;C<2*w;C++)I[C]=0;return new o(I,0)};function U(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function D(T,w){this.g=T,this.h=w}function G(T,w){if(x(w))throw Error("division by zero");if(x(T))return new D(f,f);if(S(T))return w=G(P(T),w),new D(P(w.g),P(w.h));if(S(w))return w=G(T,P(w)),new D(P(w.g),w.h);if(30<T.g.length){if(S(T)||S(w))throw Error("slowDivide_ only works with positive integers.");for(var I=g,C=w;0>=C.l(T);)I=Z(I),C=Z(C);var N=me(I,1),B=me(C,1);for(C=me(C,2),I=me(I,2);!x(C);){var R=B.add(C);0>=R.l(T)&&(N=N.add(I),B=R),C=me(C,1),I=me(I,1)}return w=j(T,N.j(w)),new D(N,w)}for(N=f;0<=T.l(w);){for(I=Math.max(1,Math.floor(T.m()/w.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),B=c(I),R=B.j(w);S(R)||0<R.l(T);)I-=C,B=c(I),R=B.j(w);x(B)&&(B=g),N=N.add(B),T=j(T,R)}return new D(N,T)}n.A=function(T){return G(this,T).h},n.and=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],C=0;C<w;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},n.or=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],C=0;C<w;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},n.xor=function(T){for(var w=Math.max(this.g.length,T.g.length),I=[],C=0;C<w;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function Z(T){for(var w=T.g.length+1,I=[],C=0;C<w;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function me(T,w){var I=w>>5;w%=32;for(var C=T.g.length-I,N=[],B=0;B<C;B++)N[B]=0<w?T.i(B+I)>>>w|T.i(B+I+1)<<32-w:T.i(B+I);return new o(N,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,eb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,fo=o}).apply(typeof Ov<"u"?Ov:typeof self<"u"?self:typeof window<"u"?window:{});var Oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var tb,$l,nb,Yc,Gf,rb,sb,ib;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,v){return u==Array.prototype||u==Object.prototype||(u[p]=v.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Oc=="object"&&Oc];for(var p=0;p<u.length;++p){var v=u[p];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=t(this);function s(u,p){if(p)e:{var v=r;u=u.split(".");for(var b=0;b<u.length-1;b++){var q=u[b];if(!(q in v))break e;v=v[q]}u=u[u.length-1],b=v[u],p=p(b),p!=b&&p!=null&&e(v,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var v=0,b=!1,q={next:function(){if(!b&&v<u.length){var H=v++;return{value:p(H,u[H]),done:!1}}return b=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function d(u,p,v){return u.call.apply(u.bind,arguments)}function f(u,p,v){if(!u)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,b),u.apply(p,q)}}return function(){return u.apply(p,arguments)}}function g(u,p,v){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function y(u,p){var v=Array.prototype.slice.call(arguments,1);return function(){var b=v.slice();return b.push.apply(b,arguments),u.apply(this,b)}}function x(u,p){function v(){}v.prototype=p.prototype,u.aa=p.prototype,u.prototype=new v,u.prototype.constructor=u,u.Qb=function(b,q,H){for(var _e=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)_e[gt-2]=arguments[gt];return p.prototype[q].apply(b,_e)}}function S(u){const p=u.length;if(0<p){const v=Array(p);for(let b=0;b<p;b++)v[b]=u[b];return v}return[]}function P(u,p){for(let v=1;v<arguments.length;v++){const b=arguments[v];if(l(b)){const q=u.length||0,H=b.length||0;u.length=q+H;for(let _e=0;_e<H;_e++)u[q+_e]=b[_e]}else u.push(b)}}class j{constructor(p,v){this.i=p,this.j=v,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function U(u){return/^[\s\xa0]*$/.test(u)}function D(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function G(u){return G[" "](u),u}G[" "]=function(){};var Z=D().indexOf("Gecko")!=-1&&!(D().toLowerCase().indexOf("webkit")!=-1&&D().indexOf("Edge")==-1)&&!(D().indexOf("Trident")!=-1||D().indexOf("MSIE")!=-1)&&D().indexOf("Edge")==-1;function me(u,p,v){for(const b in u)p.call(v,u[b],b,u)}function T(u,p){for(const v in u)p.call(void 0,u[v],v,u)}function w(u){const p={};for(const v in u)p[v]=u[v];return p}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let v,b;for(let q=1;q<arguments.length;q++){b=arguments[q];for(v in b)u[v]=b[v];for(let H=0;H<I.length;H++)v=I[H],Object.prototype.hasOwnProperty.call(b,v)&&(u[v]=b[v])}}function N(u){var p=1;u=u.split(":");const v=[];for(;0<p&&u.length;)v.push(u.shift()),p--;return u.length&&v.push(u.join(":")),v}function B(u){a.setTimeout(()=>{throw u},0)}function R(){var u=hn;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Pt{constructor(){this.h=this.g=null}add(p,v){const b=Et.get();b.set(p,v),this.h?this.h.next=b:this.g=b,this.h=b}}var Et=new j(()=>new Xe,u=>u.reset());class Xe{constructor(){this.next=this.g=this.h=null}set(p,v){this.h=p,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Le,Ue=!1,hn=new Pt,rn=()=>{const u=a.Promise.resolve(void 0);Le=()=>{u.then(Rt)}};var Rt=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(v){B(v)}var p=Et;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}Ue=!1};function fe(){this.s=this.s,this.C=this.C}fe.prototype.s=!1,fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oe(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var ze=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const v=()=>{};a.addEventListener("test",v,p),a.removeEventListener("test",v,p)}catch{}return u}();function rt(u,p){if(oe.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var v=this.type=u.type,b=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(Z){e:{try{G(p.nodeName);var q=!0;break e}catch{}q=!1}q||(p=null)}}else v=="mouseover"?p=u.fromElement:v=="mouseout"&&(p=u.toElement);this.relatedTarget=p,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:dt[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&rt.aa.h.call(this)}}x(rt,oe);var dt={2:"touch",3:"pen",4:"mouse"};rt.prototype.h=function(){rt.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var k="closure_listenable_"+(1e6*Math.random()|0),L=0;function J(u,p,v,b,q){this.listener=u,this.proxy=null,this.src=p,this.type=v,this.capture=!!b,this.ha=q,this.key=++L,this.da=this.fa=!1}function X(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Pe(u){this.src=u,this.g={},this.h=0}Pe.prototype.add=function(u,p,v,b,q){var H=u.toString();u=this.g[H],u||(u=this.g[H]=[],this.h++);var _e=E(u,p,b,q);return-1<_e?(p=u[_e],v||(p.fa=!1)):(p=new J(p,this.src,H,!!b,q),p.fa=v,u.push(p)),p};function Oe(u,p){var v=p.type;if(v in u.g){var b=u.g[v],q=Array.prototype.indexOf.call(b,p,void 0),H;(H=0<=q)&&Array.prototype.splice.call(b,q,1),H&&(X(p),u.g[v].length==0&&(delete u.g[v],u.h--))}}function E(u,p,v,b){for(var q=0;q<u.length;++q){var H=u[q];if(!H.da&&H.listener==p&&H.capture==!!v&&H.ha==b)return q}return-1}var A="closure_lm_"+(1e6*Math.random()|0),M={};function ee(u,p,v,b,q){if(b&&b.once)return ve(u,p,v,b,q);if(Array.isArray(p)){for(var H=0;H<p.length;H++)ee(u,p[H],v,b,q);return null}return v=Re(v),u&&u[k]?u.K(p,v,c(b)?!!b.capture:!!b,q):Y(u,p,v,!1,b,q)}function Y(u,p,v,b,q,H){if(!p)throw Error("Invalid event type");var _e=c(q)?!!q.capture:!!q,gt=we(u);if(gt||(u[A]=gt=new Pe(u)),v=gt.add(p,v,b,_e,H),v.proxy)return v;if(b=te(),v.proxy=b,b.src=u,b.listener=v,u.addEventListener)ze||(q=_e),q===void 0&&(q=!1),u.addEventListener(p.toString(),b,q);else if(u.attachEvent)u.attachEvent(ae(p.toString()),b);else if(u.addListener&&u.removeListener)u.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return v}function te(){function u(v){return p.call(u.src,u.listener,v)}const p=Ee;return u}function ve(u,p,v,b,q){if(Array.isArray(p)){for(var H=0;H<p.length;H++)ve(u,p[H],v,b,q);return null}return v=Re(v),u&&u[k]?u.L(p,v,c(b)?!!b.capture:!!b,q):Y(u,p,v,!0,b,q)}function de(u,p,v,b,q){if(Array.isArray(p))for(var H=0;H<p.length;H++)de(u,p[H],v,b,q);else b=c(b)?!!b.capture:!!b,v=Re(v),u&&u[k]?(u=u.i,p=String(p).toString(),p in u.g&&(H=u.g[p],v=E(H,v,b,q),-1<v&&(X(H[v]),Array.prototype.splice.call(H,v,1),H.length==0&&(delete u.g[p],u.h--)))):u&&(u=we(u))&&(p=u.g[p.toString()],u=-1,p&&(u=E(p,v,b,q)),(v=-1<u?p[u]:null)&&he(v))}function he(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[k])Oe(p.i,u);else{var v=u.type,b=u.proxy;p.removeEventListener?p.removeEventListener(v,b,u.capture):p.detachEvent?p.detachEvent(ae(v),b):p.addListener&&p.removeListener&&p.removeListener(b),(v=we(p))?(Oe(v,u),v.h==0&&(v.src=null,p[A]=null)):X(u)}}}function ae(u){return u in M?M[u]:M[u]="on"+u}function Ee(u,p){if(u.da)u=!0;else{p=new rt(p,this);var v=u.listener,b=u.ha||u.src;u.fa&&he(u),u=v.call(b,p)}return u}function we(u){return u=u[A],u instanceof Pe?u:null}var Te="__closure_events_fn_"+(1e9*Math.random()>>>0);function Re(u){return typeof u=="function"?u:(u[Te]||(u[Te]=function(p){return u.handleEvent(p)}),u[Te])}function Ne(){fe.call(this),this.i=new Pe(this),this.M=this,this.F=null}x(Ne,fe),Ne.prototype[k]=!0,Ne.prototype.removeEventListener=function(u,p,v,b){de(this,u,p,v,b)};function Be(u,p){var v,b=u.F;if(b)for(v=[];b;b=b.F)v.push(b);if(u=u.M,b=p.type||p,typeof p=="string")p=new oe(p,u);else if(p instanceof oe)p.target=p.target||u;else{var q=p;p=new oe(b,u),C(p,q)}if(q=!0,v)for(var H=v.length-1;0<=H;H--){var _e=p.g=v[H];q=Je(_e,b,!0,p)&&q}if(_e=p.g=u,q=Je(_e,b,!0,p)&&q,q=Je(_e,b,!1,p)&&q,v)for(H=0;H<v.length;H++)_e=p.g=v[H],q=Je(_e,b,!1,p)&&q}Ne.prototype.N=function(){if(Ne.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var v=u.g[p],b=0;b<v.length;b++)X(v[b]);delete u.g[p],u.h--}}this.F=null},Ne.prototype.K=function(u,p,v,b){return this.i.add(String(u),p,!1,v,b)},Ne.prototype.L=function(u,p,v,b){return this.i.add(String(u),p,!0,v,b)};function Je(u,p,v,b){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var q=!0,H=0;H<p.length;++H){var _e=p[H];if(_e&&!_e.da&&_e.capture==v){var gt=_e.listener,an=_e.ha||_e.src;_e.fa&&Oe(u.i,_e),q=gt.call(an,b)!==!1&&q}}return q&&!b.defaultPrevented}function Ht(u,p,v){if(typeof u=="function")v&&(u=g(u,v));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function Ft(u){u.g=Ht(()=>{u.g=null,u.i&&(u.i=!1,Ft(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class vn extends fe{constructor(p,v){super(),this.m=p,this.l=v,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Ft(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(u){fe.call(this),this.h=u,this.g={}}x(Ct,fe);var fr=[];function Lr(u){me(u.g,function(p,v){this.g.hasOwnProperty(v)&&he(p)},u),u.g={}}Ct.prototype.N=function(){Ct.aa.N.call(this),Lr(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sn=a.JSON.stringify,Rn=a.JSON.parse,Oi=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function dl(){}dl.prototype.h=null;function uc(u){return u.h||(u.h=u.i())}function cc(){}var Mi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function hl(){oe.call(this,"d")}x(hl,oe);function xr(){oe.call(this,"c")}x(xr,oe);var Xn={},Ar=null;function Sr(){return Ar=Ar||new Ne}Xn.La="serverreachability";function Pr(u){oe.call(this,Xn.La,u)}x(Pr,oe);function Ls(u){const p=Sr();Be(p,new Pr(p))}Xn.STAT_EVENT="statevent";function Li(u,p){oe.call(this,Xn.STAT_EVENT,u),this.stat=p}x(Li,oe);function on(u){const p=Sr();Be(p,new Li(p,u))}Xn.Ma="timingevent";function dc(u,p){oe.call(this,Xn.Ma,u),this.size=p}x(dc,oe);function Cn(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function Fs(){this.g=!0}Fs.prototype.xa=function(){this.g=!1};function hc(u,p,v,b,q,H){u.info(function(){if(u.g)if(H)for(var _e="",gt=H.split("&"),an=0;an<gt.length;an++){var it=gt[an].split("=");if(1<it.length){var ln=it[0];it=it[1];var fn=ln.split("_");_e=2<=fn.length&&fn[1]=="type"?_e+(ln+"="+it+"&"):_e+(ln+"=redacted&")}}else _e=null;else _e=H;return"XMLHTTP REQ ("+b+") [attempt "+q+"]: "+p+`
`+v+`
`+_e})}function fl(u,p,v,b,q,H,_e){u.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+q+"]: "+p+`
`+v+`
`+H+" "+_e})}function $s(u,p,v,b){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+No(u,v)+(b?" "+b:"")})}function zn(u,p){u.info(function(){return"TIMEOUT: "+p})}Fs.prototype.info=function(){};function No(u,p){if(!u.g)return p;if(!p)return null;try{var v=JSON.parse(p);if(v){for(u=0;u<v.length;u++)if(Array.isArray(v[u])){var b=v[u];if(!(2>b.length)){var q=b[1];if(Array.isArray(q)&&!(1>q.length)){var H=q[0];if(H!="noop"&&H!="stop"&&H!="close")for(var _e=1;_e<q.length;_e++)q[_e]=""}}}}return sn(v)}catch{return p}}var Gn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Oo;function Fr(){}x(Fr,dl),Fr.prototype.g=function(){return new XMLHttpRequest},Fr.prototype.i=function(){return{}},Oo=new Fr;function Zn(u,p,v,b){this.j=u,this.i=p,this.l=v,this.R=b||1,this.U=new Ct(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fi}function Fi(){this.i=null,this.g="",this.h=!1}var ts={},Mo={};function Us(u,p,v){u.L=1,u.v=Ur(vr(p)),u.m=v,u.P=!0,pr(u,null)}function pr(u,p){u.F=Date.now(),Lo(u),u.A=vr(u.v);var v=u.A,b=u.R;Array.isArray(b)||(b=[String(b)]),Bt(v.i,"t",b),u.C=0,v=u.j.J,u.h=new Fi,u.g=Tl(u.j,v?p:null,!u.m),0<u.O&&(u.M=new vn(g(u.Y,u,u.g),u.O)),p=u.U,v=u.g,b=u.ca;var q="readystatechange";Array.isArray(q)||(q&&(fr[0]=q.toString()),q=fr);for(var H=0;H<q.length;H++){var _e=ee(v,q[H],b||p.handleEvent,!1,p.h||p);if(!_e)break;p.g[_e.key]=_e}p=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Ls(),hc(u.i,u.u,u.A,u.l,u.R,u.m)}Zn.prototype.ca=function(u){u=u.target;const p=this.M;p&&kr(u)==3?p.j():this.Y(u)},Zn.prototype.Y=function(u){try{if(u==this.g)e:{const fn=kr(this.g);var p=this.g.Ba();const Hs=this.g.Z();if(!(3>fn)&&(fn!=3||this.g&&(this.h.h||this.g.oa()||Wo(this.g)))){this.J||fn!=4||p==7||(p==8||0>=Hs?Ls(3):Ls(2)),mr(this);var v=this.g.Z();this.X=v;t:if(fc(this)){var b=Wo(this.g);u="";var q=b.length,H=kr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$r(this),ns(this);var _e="";break t}this.h.i=new a.TextDecoder}for(p=0;p<q;p++)this.h.h=!0,u+=this.h.i.decode(b[p],{stream:!(H&&p==q-1)});b.length=0,this.h.g+=u,this.C=0,_e=this.h.g}else _e=this.g.oa();if(this.o=v==200,fl(this.i,this.u,this.A,this.l,this.R,fn,v),this.o){if(this.T&&!this.K){t:{if(this.g){var gt,an=this.g;if((gt=an.g?an.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(gt)){var it=gt;break t}}it=null}if(v=it)$s(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fo(this,v);else{this.o=!1,this.s=3,on(12),$r(this),ns(this);break e}}if(this.P){v=!0;let ar;for(;!this.J&&this.C<_e.length;)if(ar=$h(this,_e),ar==Mo){fn==4&&(this.s=4,on(14),v=!1),$s(this.i,this.l,null,"[Incomplete Response]");break}else if(ar==ts){this.s=4,on(15),$s(this.i,this.l,_e,"[Invalid Chunk]"),v=!1;break}else $s(this.i,this.l,ar,null),Fo(this,ar);if(fc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fn!=4||_e.length!=0||this.h.h||(this.s=1,on(16),v=!1),this.o=this.o&&v,!v)$s(this.i,this.l,_e,"[Invalid Chunked Response]"),$r(this),ns(this);else if(0<_e.length&&!this.W){this.W=!0;var ln=this.j;ln.g==this&&ln.ba&&!ln.M&&(ln.j.info("Great, no buffering proxy detected. Bytes received: "+_e.length),El(ln),ln.M=!0,on(11))}}else $s(this.i,this.l,_e,null),Fo(this,_e);fn==4&&$r(this),this.o&&!this.J&&(fn==4?Tc(this.j,this):(this.o=!1,Lo(this)))}else zs(this.g),v==400&&0<_e.indexOf("Unknown SID")?(this.s=3,on(12)):(this.s=0,on(13)),$r(this),ns(this)}}}catch{}finally{}};function fc(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function $h(u,p){var v=u.C,b=p.indexOf(`
`,v);return b==-1?Mo:(v=Number(p.substring(v,b)),isNaN(v)?ts:(b+=1,b+v>p.length?Mo:(p=p.slice(b,b+v),u.C=b+v,p)))}Zn.prototype.cancel=function(){this.J=!0,$r(this)};function Lo(u){u.S=Date.now()+u.I,ml(u,u.I)}function ml(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Cn(g(u.ba,u),p)}function mr(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Zn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(zn(this.i,this.A),this.L!=2&&(Ls(),on(17)),$r(this),this.s=2,ns(this)):ml(this,this.S-u)};function ns(u){u.j.G==0||u.J||Tc(u.j,u)}function $r(u){mr(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Lr(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Fo(u,p){try{var v=u.j;if(v.G!=0&&(v.g==u||Uo(v.h,u))){if(!u.K&&Uo(v.h,u)&&v.G==3){try{var b=v.Da.g.parse(p)}catch{b=null}if(Array.isArray(b)&&b.length==3){var q=b;if(q[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<u.F)Yo(v),Wi(v);else break e;Il(v),on(18)}}else v.za=q[1],0<v.za-v.T&&37500>q[2]&&v.F&&v.v==0&&!v.C&&(v.C=Cn(g(v.Za,v),6e3));if(1>=vl(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else os(v,11)}else if((u.K||v.g==u)&&Yo(v),!U(p))for(q=v.Da.g.parse(p),p=0;p<q.length;p++){let it=q[p];if(v.T=it[0],it=it[1],v.G==2)if(it[0]=="c"){v.K=it[1],v.ia=it[2];const ln=it[3];ln!=null&&(v.la=ln,v.j.info("VER="+v.la));const fn=it[4];fn!=null&&(v.Aa=fn,v.j.info("SVER="+v.Aa));const Hs=it[5];Hs!=null&&typeof Hs=="number"&&0<Hs&&(b=1.5*Hs,v.L=b,v.j.info("backChannelRequestTimeoutMs_="+b)),b=v;const ar=u.g;if(ar){const Xo=ar.g?ar.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xo){var H=b.h;H.g||Xo.indexOf("spdy")==-1&&Xo.indexOf("quic")==-1&&Xo.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(js(H,H.h),H.h=null))}if(b.D){const as=ar.g?ar.g.getResponseHeader("X-HTTP-Session-Id"):null;as&&(b.ya=as,bt(b.I,b.D,as))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-u.F,v.j.info("Handshake RTT: "+v.R+"ms")),b=v;var _e=u;if(b.qa=Ac(b,b.J?b.ia:null,b.W),_e.K){$i(b.h,_e);var gt=_e,an=b.L;an&&(gt.I=an),gt.B&&(mr(gt),Lo(gt)),b.g=_e}else Ic(b);0<v.i.length&&Qo(v)}else it[0]!="stop"&&it[0]!="close"||os(v,7);else v.G==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?os(v,7):Hi(v):it[0]!="noop"&&v.l&&v.l.ta(it),v.v=0)}}Ls(4)}catch{}}var gl=class{constructor(u,p){this.g=u,this.map=p}};function pc(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $o(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function vl(u){return u.h?1:u.g?u.g.size:0}function Uo(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function js(u,p){u.g?u.g.add(p):u.h=p}function $i(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}pc.prototype.cancel=function(){if(this.i=Ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Ui(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const v of u.g.values())p=p.concat(v.D);return p}return S(u.i)}function yl(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],v=u.length,b=0;b<v;b++)p.push(u[b]);return p}p=[],v=0;for(b in u)p[v++]=u[b];return p}function Ce(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var v=0;v<u;v++)p.push(v);return p}p=[],v=0;for(const b in u)p[v++]=b;return p}}}function at(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var v=Ce(u),b=yl(u),q=b.length,H=0;H<q;H++)p.call(void 0,b[H],v&&v[H],u)}var gr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ji(u,p){if(u){u=u.split("&");for(var v=0;v<u.length;v++){var b=u[v].indexOf("="),q=null;if(0<=b){var H=u[v].substring(0,b);q=u[v].substring(b+1)}else H=u[v];p(H,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function rs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof rs){this.h=u.h,jo(this,u.j),this.o=u.o,this.g=u.g,Bo(this,u.s),this.l=u.l;var p=u.i,v=new qi;v.i=p.i,p.g&&(v.g=new Map(p.g),v.h=p.h),qo(this,v),this.m=u.m}else u&&(p=String(u).match(gr))?(this.h=!1,jo(this,p[1]||"",!0),this.o=jr(p[2]||""),this.g=jr(p[3]||"",!0),Bo(this,p[4]),this.l=jr(p[5]||"",!0),qo(this,p[6]||"",!0),this.m=jr(p[7]||"")):(this.h=!1,this.i=new qi(null,this.h))}rs.prototype.toString=function(){var u=[],p=this.j;p&&u.push(yr(p,qs,!0),":");var v=this.g;return(v||p=="file")&&(u.push("//"),(p=this.o)&&u.push(yr(p,qs,!0),"@"),u.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&u.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&u.push("/"),u.push(yr(v,v.charAt(0)=="/"?zo:Bi,!0))),(v=this.i.toString())&&u.push("?",v),(v=this.m)&&u.push("#",yr(v,jh)),u.join("")};function vr(u){return new rs(u)}function jo(u,p,v){u.j=v?jr(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Bo(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function qo(u,p,v){p instanceof qi?(u.i=p,Bh(u.i,u.h)):(v||(p=yr(p,Uh)),u.i=new qi(p,u.h))}function bt(u,p,v){u.i.set(p,v)}function Ur(u){return bt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function jr(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function yr(u,p,v){return typeof u=="string"?(u=encodeURI(u).replace(p,Bs),v&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Bs(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var qs=/[#\/\?@]/g,Bi=/[#\?:]/g,zo=/[#\?]/g,Uh=/[#\?@]/g,jh=/#/g;function qi(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Rr(u){u.g||(u.g=new Map,u.h=0,u.i&&ji(u.i,function(p,v){u.add(decodeURIComponent(p.replace(/\+/g," ")),v)}))}n=qi.prototype,n.add=function(u,p){Rr(this),this.i=null,u=st(this,u);var v=this.g.get(u);return v||this.g.set(u,v=[]),v.push(p),this.h+=1,this};function qe(u,p){Rr(u),p=st(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function Qe(u,p){return Rr(u),p=st(u,p),u.g.has(p)}n.forEach=function(u,p){Rr(this),this.g.forEach(function(v,b){v.forEach(function(q){u.call(p,q,b,this)},this)},this)},n.na=function(){Rr(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),v=[];for(let b=0;b<p.length;b++){const q=u[b];for(let H=0;H<q.length;H++)v.push(p[b])}return v},n.V=function(u){Rr(this);let p=[];if(typeof u=="string")Qe(this,u)&&(p=p.concat(this.g.get(st(this,u))));else{u=Array.from(this.g.values());for(let v=0;v<u.length;v++)p=p.concat(u[v])}return p},n.set=function(u,p){return Rr(this),this.i=null,u=st(this,u),Qe(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Bt(u,p,v){qe(u,p),0<v.length&&(u.i=null,u.g.set(st(u,p),S(v)),u.h+=v.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var v=0;v<p.length;v++){var b=p[v];const H=encodeURIComponent(String(b)),_e=this.V(b);for(b=0;b<_e.length;b++){var q=H;_e[b]!==""&&(q+="="+encodeURIComponent(String(_e[b]))),u.push(q)}}return this.i=u.join("&")};function st(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function Bh(u,p){p&&!u.j&&(Rr(u),u.i=null,u.g.forEach(function(v,b){var q=b.toLowerCase();b!=q&&(qe(this,b),Bt(this,q,v))},u)),u.j=p}function _l(u,p){const v=new Fs;if(a.Image){const b=new Image;b.onload=y(Kn,v,"TestLoadImage: loaded",!0,p,b),b.onerror=y(Kn,v,"TestLoadImage: error",!1,p,b),b.onabort=y(Kn,v,"TestLoadImage: abort",!1,p,b),b.ontimeout=y(Kn,v,"TestLoadImage: timeout",!1,p,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=u}else p(!1)}function mc(u,p){const v=new Fs,b=new AbortController,q=setTimeout(()=>{b.abort(),Kn(v,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:b.signal}).then(H=>{clearTimeout(q),H.ok?Kn(v,"TestPingServer: ok",!0,p):Kn(v,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(q),Kn(v,"TestPingServer: error",!1,p)})}function Kn(u,p,v,b,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),b(v)}catch{}}function Go(){this.g=new Oi}function qh(u,p,v){const b=v||"";try{at(u,function(q,H){let _e=q;c(q)&&(_e=sn(q)),p.push(b+H+"="+encodeURIComponent(_e))})}catch(q){throw p.push(b+"type="+encodeURIComponent("_badmap")),q}}function Cr(u){this.l=u.Ub||null,this.j=u.eb||!1}x(Cr,dl),Cr.prototype.g=function(){return new kn(this.l,this.j)},Cr.prototype.i=function(u){return function(){return u}}({});function kn(u,p){Ne.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(kn,Ne),n=kn.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,zi(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ss(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,zi(this)),this.g&&(this.readyState=3,zi(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function gc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?ss(this):zi(this),this.readyState==3&&gc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,ss(this))},n.Qa=function(u){this.g&&(this.response=u,ss(this))},n.ga=function(){this.g&&ss(this)};function ss(u){u.readyState=4,u.l=null,u.j=null,u.v=null,zi(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var v=p.next();!v.done;)v=v.value,u.push(v[0]+": "+v[1]),v=p.next();return u.join(`\r
`)};function zi(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(kn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function vc(u){let p="";return me(u,function(v,b){p+=b,p+=":",p+=v,p+=`\r
`}),p}function bl(u,p,v){e:{for(b in v){var b=!1;break e}b=!0}b||(v=vc(v),typeof u=="string"?v!=null&&encodeURIComponent(String(v)):bt(u,p,v))}function kt(u){Ne.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(kt,Ne);var Ko=/^https?$/i,wl=["POST","PUT"];n=kt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,v,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Oo.g(),this.v=this.o?uc(this.o):uc(Oo),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(H){_r(this,H);return}if(u=v||"",v=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var q in b)v.set(q,b[q]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const H of b.keys())v.set(H,b.get(H));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(v.keys()).find(H=>H.toLowerCase()=="content-type"),q=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(wl,p,void 0))||b||q||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,_e]of v)this.g.setRequestHeader(H,_e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ho(this),this.u=!0,this.g.send(u),this.u=!1}catch(H){_r(this,H)}};function _r(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,yc(u),Gi(u)}function yc(u){u.A||(u.A=!0,Be(u,"complete"),Be(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Be(this,"complete"),Be(this,"abort"),Gi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gi(this,!0)),kt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?_c(this):this.bb())},n.bb=function(){_c(this)};function _c(u){if(u.h&&typeof o<"u"&&(!u.v[1]||kr(u)!=4||u.Z()!=2)){if(u.u&&kr(u)==4)Ht(u.Ea,0,u);else if(Be(u,"readystatechange"),kr(u)==4){u.h=!1;try{const _e=u.Z();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var v;if(!(v=p)){var b;if(b=_e===0){var q=String(u.D).match(gr)[1]||null;!q&&a.self&&a.self.location&&(q=a.self.location.protocol.slice(0,-1)),b=!Ko.test(q?q.toLowerCase():"")}v=b}if(v)Be(u,"complete"),Be(u,"success");else{u.m=6;try{var H=2<kr(u)?u.g.statusText:""}catch{H=""}u.l=H+" ["+u.Z()+"]",yc(u)}}finally{Gi(u)}}}}function Gi(u,p){if(u.g){Ho(u);const v=u.g,b=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Be(u,"ready");try{v.onreadystatechange=b}catch{}}}function Ho(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function kr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<kr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Rn(p)}};function Wo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function zs(u){const p={};u=(u.g&&2<=kr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<u.length;b++){if(U(u[b]))continue;var v=N(u[b]);const q=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const H=p[q]||[];p[q]=H,H.push(v)}T(p,function(b){return b.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function is(u,p,v){return v&&v.internalChannelParams&&v.internalChannelParams[u]||p}function Ki(u){this.Aa=0,this.i=[],this.j=new Fs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=is("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=is("baseRetryDelayMs",5e3,u),this.cb=is("retryDelaySeedMs",1e4,u),this.Wa=is("forwardChannelMaxRetries",2,u),this.wa=is("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new pc(u&&u.concurrentRequestLimit),this.Da=new Go,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ki.prototype,n.la=8,n.G=1,n.connect=function(u,p,v,b){on(0),this.W=u,this.H=p||{},v&&b!==void 0&&(this.H.OSID=v,this.H.OAID=b),this.F=this.X,this.I=Ac(this,null,this.W),Qo(this)};function Hi(u){if(bc(u),u.G==3){var p=u.U++,v=vr(u.I);if(bt(v,"SID",u.K),bt(v,"RID",p),bt(v,"TYPE","terminate"),Br(u,v),p=new Zn(u,u.j,p),p.L=2,p.v=Ur(vr(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!v&&a.Image&&(new Image().src=p.v,v=!0),v||(p.g=Tl(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Lo(p)}xc(u)}function Wi(u){u.g&&(El(u),u.g.cancel(),u.g=null)}function bc(u){Wi(u),u.u&&(a.clearTimeout(u.u),u.u=null),Yo(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Qo(u){if(!$o(u.h)&&!u.s){u.s=!0;var p=u.Ga;Le||rn(),Ue||(Le(),Ue=!0),hn.add(p,u),u.B=0}}function wc(u,p){return vl(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Cn(g(u.Ga,u,p),Gs(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const q=new Zn(this,this.j,u);let H=this.o;if(this.S&&(H?(H=w(H),C(H,this.S)):H=this.S),this.m!==null||this.O||(q.H=H,H=null),this.P)e:{for(var p=0,v=0;v<this.i.length;v++){t:{var b=this.i[v];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(p+=b,4096<p){p=v;break e}if(p===4096||v===this.i.length-1){p=v+1;break e}}p=1e3}else p=1e3;p=Qi(this,q,p),v=vr(this.I),bt(v,"RID",u),bt(v,"CVER",22),this.D&&bt(v,"X-HTTP-Session-Id",this.D),Br(this,v),H&&(this.O?p="headers="+encodeURIComponent(String(vc(H)))+"&"+p:this.m&&bl(v,this.m,H)),js(this.h,q),this.Ua&&bt(v,"TYPE","init"),this.P?(bt(v,"$req",p),bt(v,"SID","null"),q.T=!0,Us(q,v,null)):Us(q,v,p),this.G=2}}else this.G==3&&(u?Jo(this,u):this.i.length==0||$o(this.h)||Jo(this))};function Jo(u,p){var v;p?v=p.l:v=u.U++;const b=vr(u.I);bt(b,"SID",u.K),bt(b,"RID",v),bt(b,"AID",u.T),Br(u,b),u.m&&u.o&&bl(b,u.m,u.o),v=new Zn(u,u.j,v,u.B+1),u.m===null&&(v.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Qi(u,v,1e3),v.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),js(u.h,v),Us(v,b,p)}function Br(u,p){u.H&&me(u.H,function(v,b){bt(p,b,v)}),u.l&&at({},function(v,b){bt(p,b,v)})}function Qi(u,p,v){v=Math.min(u.i.length,v);var b=u.l?g(u.l.Na,u.l,u):null;e:{var q=u.i;let H=-1;for(;;){const _e=["count="+v];H==-1?0<v?(H=q[0].g,_e.push("ofs="+H)):H=0:_e.push("ofs="+H);let gt=!0;for(let an=0;an<v;an++){let it=q[an].g;const ln=q[an].map;if(it-=H,0>it)H=Math.max(0,q[an].g-100),gt=!1;else try{qh(ln,_e,"req"+it+"_")}catch{b&&b(ln)}}if(gt){b=_e.join("&");break e}}}return u=u.i.splice(0,v),p.D=u,b}function Ic(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;Le||rn(),Ue||(Le(),Ue=!0),hn.add(p,u),u.v=0}}function Il(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Cn(g(u.Fa,u),Gs(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Ec(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Cn(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,on(10),Wi(this),Ec(this))};function El(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Ec(u){u.g=new Zn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=vr(u.qa);bt(p,"RID","rpc"),bt(p,"SID",u.K),bt(p,"AID",u.T),bt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&bt(p,"TO",u.ja),bt(p,"TYPE","xmlhttp"),Br(u,p),u.m&&u.o&&bl(p,u.m,u.o),u.L&&(u.g.I=u.L);var v=u.g;u=u.ia,v.L=1,v.v=Ur(vr(p)),v.m=null,v.P=!0,pr(v,u)}n.Za=function(){this.C!=null&&(this.C=null,Wi(this),Il(this),on(19))};function Yo(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Tc(u,p){var v=null;if(u.g==p){Yo(u),El(u),u.g=null;var b=2}else if(Uo(u.h,p))v=p.D,$i(u.h,p),b=1;else return;if(u.G!=0){if(p.o)if(b==1){v=p.m?p.m.length:0,p=Date.now()-p.F;var q=u.B;b=Sr(),Be(b,new dc(b,v)),Qo(u)}else Ic(u);else if(q=p.s,q==3||q==0&&0<p.X||!(b==1&&wc(u,p)||b==2&&Il(u)))switch(v&&0<v.length&&(p=u.h,p.i=p.i.concat(v)),q){case 1:os(u,5);break;case 4:os(u,10);break;case 3:os(u,6);break;default:os(u,2)}}}function Gs(u,p){let v=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(v*=2),v*p}function os(u,p){if(u.j.info("Error code "+p),p==2){var v=g(u.fb,u),b=u.Xa;const q=!b;b=new rs(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||jo(b,"https"),Ur(b),q?_l(b.toString(),v):mc(b.toString(),v)}else on(2);u.G=0,u.l&&u.l.sa(p),xc(u),bc(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),on(2)):(this.j.info("Failed to ping google.com"),on(1))};function xc(u){if(u.G=0,u.ka=[],u.l){const p=Ui(u.h);(p.length!=0||u.i.length!=0)&&(P(u.ka,p),P(u.ka,u.i),u.h.i.length=0,S(u.i),u.i.length=0),u.l.ra()}}function Ac(u,p,v){var b=v instanceof rs?vr(v):new rs(v);if(b.g!="")p&&(b.g=p+"."+b.g),Bo(b,b.s);else{var q=a.location;b=q.protocol,p=p?p+"."+q.hostname:q.hostname,q=+q.port;var H=new rs(null);b&&jo(H,b),p&&(H.g=p),q&&Bo(H,q),v&&(H.l=v),b=H}return v=u.D,p=u.ya,v&&p&&bt(b,v,p),bt(b,"VER",u.la),Br(u,b),b}function Tl(u,p,v){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new kt(new Cr({eb:v})):new kt(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sc(){}n=Sc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ji(){}Ji.prototype.g=function(u,p){return new Hn(u,p)};function Hn(u,p){Ne.call(this),this.g=new Ki(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!U(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!U(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ks(this)}x(Hn,Ne),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){Hi(this.g)},Hn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var v={};v.__data__=u,u=v}else this.u&&(v={},v.__data__=sn(u),u=v);p.i.push(new gl(p.Ya++,u)),p.G==3&&Qo(p)},Hn.prototype.N=function(){this.g.l=null,delete this.j,Hi(this.g),delete this.g,Hn.aa.N.call(this)};function Pc(u){hl.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const v in p){u=v;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}x(Pc,hl);function Rc(){xr.call(this),this.status=1}x(Rc,xr);function Ks(u){this.g=u}x(Ks,Sc),Ks.prototype.ua=function(){Be(this.g,"a")},Ks.prototype.ta=function(u){Be(this.g,new Pc(u))},Ks.prototype.sa=function(u){Be(this.g,new Rc)},Ks.prototype.ra=function(){Be(this.g,"b")},Ji.prototype.createWebChannel=Ji.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,ib=function(){return new Ji},sb=function(){return Sr()},rb=Xn,Gf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gn.NO_ERROR=0,Gn.TIMEOUT=8,Gn.HTTP_ERROR=6,Yc=Gn,pl.COMPLETE="complete",nb=pl,cc.EventType=Mi,Mi.OPEN="a",Mi.CLOSE="b",Mi.ERROR="c",Mi.MESSAGE="d",Ne.prototype.listen=Ne.prototype.K,$l=cc,kt.prototype.listenOnce=kt.prototype.L,kt.prototype.getLastError=kt.prototype.Ka,kt.prototype.getLastErrorCode=kt.prototype.Ba,kt.prototype.getStatus=kt.prototype.Z,kt.prototype.getResponseJson=kt.prototype.Oa,kt.prototype.getResponseText=kt.prototype.oa,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Ha,tb=kt}).apply(typeof Oc<"u"?Oc:typeof self<"u"?self:typeof window<"u"?window:{});const Mv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_n.UNAUTHENTICATED=new _n(null),_n.GOOGLE_CREDENTIALS=new _n("google-credentials-uid"),_n.FIRST_PARTY=new _n("first-party-uid"),_n.MOCK_USER=new _n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qa="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi=new qp("@firebase/firestore");function oa(){return wi.logLevel}function B$(n){wi.setLogLevel(n)}function se(n,...e){if(wi.logLevel<=et.DEBUG){const t=e.map(Gp);wi.debug(`Firestore (${Qa}): ${n}`,...t)}}function Xt(n,...e){if(wi.logLevel<=et.ERROR){const t=e.map(Gp);wi.error(`Firestore (${Qa}): ${n}`,...t)}}function Er(n,...e){if(wi.logLevel<=et.WARN){const t=e.map(Gp);wi.warn(`Firestore (${Qa}): ${n}`,...t)}}function Gp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(n="Unexpected state"){const e=`FIRESTORE (${Qa}) INTERNAL ASSERTION FAILED: `+n;throw Xt(e),new Error(e)}function Se(n,e){n||Ae()}function q$(n,e){n||Ae()}function be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends Cs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ZP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_n.UNAUTHENTICATED))}shutdown(){}}class e1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class t1{constructor(e){this.t=e,this.currentUser=_n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Se(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new bn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new bn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new bn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Se(typeof r.accessToken=="string"),new ob(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Se(e===null||typeof e=="string"),new _n(e)}}class n1{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=_n.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class r1{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new n1(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(_n.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ab{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class s1{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Se(this.o===void 0);const r=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Se(typeof t.token=="string"),this.R=t.token,new ab(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class z${getToken(){return Promise.resolve(new ab(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=i1(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function je(n,e){return n<e?-1:n>e?1:0}function Pa(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function ub(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ie(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ie(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ie(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Gt(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ke(e)}static min(){return new ke(new Gt(0,0))}static max(){return new ke(new Gt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ae(),r===void 0?r=e.length-t:r>e.length-t&&Ae(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return gu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gu?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class tt extends gu{construct(e,t,r){return new tt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new tt(t)}static emptyPath(){return new tt([])}}const o1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ut extends gu{construct(e,t,r){return new Ut(e,t,r)}static isValidIdentifier(e){return o1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ut.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ut(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ie(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ie(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ie(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ie(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ut(t)}static emptyPath(){return new Ut([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(tt.fromString(e))}static fromName(e){return new Ie(tt.fromString(e).popFirst(5))}static empty(){return new Ie(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new tt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Kf(n){return n.fields.find(e=>e.kind===2)}function no(n){return n.fields.filter(e=>e.kind!==2)}function a1(n,e){let t=je(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=l1(n.fields[r],e.fields[r]),t!==0)return t;return je(n.fields.length,e.fields.length)}Ra.UNKNOWN_ID=-1;class po{constructor(e,t){this.fieldPath=e,this.kind=t}}function l1(n,e){const t=Ut.comparator(n.fieldPath,e.fieldPath);return t!==0?t:je(n.kind,e.kind)}class Ca{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ca(0,hr.min())}}function cb(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ke.fromTimestamp(r===1e9?new Gt(t+1,0):new Gt(t,r));return new hr(s,Ie.empty(),e)}function db(n){return new hr(n.readTime,n.key,-1)}class hr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new hr(ke.min(),Ie.empty(),-1)}static max(){return new hr(ke.max(),Ie.empty(),-1)}}function Kp(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ie.comparator(n.documentKey,e.documentKey),t!==0?t:je(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ci(n){if(n.code!==K.FAILED_PRECONDITION||n.message!==hb)throw n;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):z.reject(t)}static resolve(e){return new z((t,r)=>{t(e)})}static reject(e){return new z((t,r)=>{r(e)})}static waitFor(e){return new z((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next(s=>s?z.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new z((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new z((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new bn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new eu(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=Hp(r.target.error);this.V.reject(new eu(e,s))}}static open(e,t,r,s){try{return new sh(t,e.transaction(s,r))}catch(i){throw new eu(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(se("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new c1(t)}}class Qr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Qr.S(mn())===12.2&&Xt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return se("SimpleDb","Removing database:",e),io(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!H0())return!1;if(Qr.v())return!0;const e=mn(),t=Qr.S(e),r=0<t&&t<10,s=pb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(se("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new eu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new ie(K.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ie(K.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new eu(e,o))},s.onupgradeneeded=i=>{se("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{se("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=sh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),z.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(se("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function pb(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class u1{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return io(this.B.delete())}}class eu extends ie{constructor(e,t){super(K.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ki(n){return n.name==="IndexedDbTransactionError"}class c1{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(se("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(se("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),io(r)}add(e){return se("SimpleDb","ADD",this.store.name,e,e),io(this.store.add(e))}get(e){return io(this.store.get(e)).next(t=>(t===void 0&&(t=null),se("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return se("SimpleDb","DELETE",this.store.name,e),io(this.store.delete(e))}count(){return se("SimpleDb","COUNT",this.store.name),io(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new z((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new z((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){se("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new z((r,s)=>{t.onerror=i=>{const o=Hp(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new z((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new u1(a),c=t(a.primaryKey,a.value,l);if(c instanceof z){const d=c.catch(f=>(l.done(),z.reject(f)));r.push(d)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>z.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function io(n){return new z((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=Hp(r.target.error);t(s)}})}let Lv=!1;function Hp(n){const e=Qr.S(mn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Lv||(Lv=!0,setTimeout(()=>{throw r},0)),r}}return n}class d1{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){se("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{se("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){ki(t)?se("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ci(t)}await this.X(6e4)})}}class h1{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return z.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return se("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(se("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=db(i);Kp(o,r)>0&&(r=o)}),new hr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}rr.oe=-1;function ju(n){return n==null}function vu(n){return n===0&&1/n==-1/0}function mb(n){return typeof n=="number"&&Number.isInteger(n)&&!vu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Fv(e)),e=f1(n.get(t),e);return Fv(e)}function f1(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function Fv(n){return n+""}function Kr(n){const e=n.length;if(Se(e>=2),e===2)return Se(n.charAt(0)===""&&n.charAt(1)===""),tt.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&Ae(),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:Ae()}i=o+2}return new tt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xc(n,e){return[n,jn(e)]}function gb(n,e,t){return[n,jn(e),t]}const p1={},m1=["prefixPath","collectionGroup","readTime","documentId"],g1=["prefixPath","collectionGroup","documentId"],v1=["collectionGroup","readTime","prefixPath","documentId"],y1=["canonicalId","targetId"],_1=["targetId","path"],b1=["path","targetId"],w1=["collectionId","parent"],I1=["indexId","uid"],E1=["uid","sequenceNumber"],T1=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],x1=["indexId","uid","orderedDocumentKey"],A1=["userId","collectionPath","documentId"],S1=["userId","collectionPath","largestBatchId"],P1=["userId","collectionGroup","largestBatchId"],vb=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],R1=[...vb,"documentOverlays"],yb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],_b=yb,Wp=[..._b,"indexConfiguration","indexState","indexEntries"],C1=Wp,k1=[...Wp,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf extends fb{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function gn(n,e){const t=be(n);return Qr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Di(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function bb(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function wb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t){this.comparator=e,this.root=t||xn.EMPTY}insert(e,t){return new St(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xn.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mc(this.root,e,this.comparator,!0)}}class Mc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xn{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??xn.RED,this.left=s??xn.EMPTY,this.right=i??xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new xn(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return xn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ae();const e=this.left.check();if(e!==this.right.check())throw Ae();return e+(this.isRed()?0:1)}}xn.EMPTY=null,xn.RED=!0,xn.BLACK=!1;xn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae()}get value(){throw Ae()}get color(){throw Ae()}get left(){throw Ae()}get right(){throw Ae()}copy(e,t,r,s,i){return this}insert(e,t,r){return new xn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jv(this.data.getIterator())}getIteratorFrom(e){return new jv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof _t)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new _t(this.comparator);return t.data=e,t}}class jv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ea(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.fields=e,e.sort(Ut.comparator)}static empty(){return new sr([])}unionWith(e){let t=new _t(Ut.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new sr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pa(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K$(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ib("Invalid base64 string: "+i):i}}(e);return new Wt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Wt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const D1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ts(n){if(Se(!!n),typeof n=="string"){let e=0;const t=D1.exec(n);if(Se(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$t(n.seconds),nanos:$t(n.nanos)}}function $t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xs(n){return typeof n=="string"?Wt.fromBase64String(n):Wt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function oh(n){const e=n.mapValue.fields.__previous_value__;return ih(e)?oh(e):e}function yu(n){const e=Ts(n.mapValue.fields.__local_write_time__.timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class yo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new yo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof yo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Zc={nullValue:"NULL_VALUE"};function Ii(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ih(n)?4:Eb(n)?9007199254740991:ah(n)?10:11:Ae()}function es(n,e){if(n===e)return!0;const t=Ii(n);if(t!==Ii(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return yu(n).isEqual(yu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ts(s.timestampValue),a=Ts(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return xs(s.bytesValue).isEqual(xs(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return $t(s.geoPointValue.latitude)===$t(i.geoPointValue.latitude)&&$t(s.geoPointValue.longitude)===$t(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return $t(s.integerValue)===$t(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=$t(s.doubleValue),a=$t(i.doubleValue);return o===a?vu(o)===vu(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Pa(n.arrayValue.values||[],e.arrayValue.values||[],es);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Uv(o)!==Uv(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!es(o[l],a[l])))return!1;return!0}(n,e);default:return Ae()}}function _u(n,e){return(n.values||[]).find(t=>es(t,e))!==void 0}function Ei(n,e){if(n===e)return 0;const t=Ii(n),r=Ii(e);if(t!==r)return je(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return je(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=$t(i.integerValue||i.doubleValue),l=$t(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Bv(n.timestampValue,e.timestampValue);case 4:return Bv(yu(n),yu(e));case 5:return je(n.stringValue,e.stringValue);case 6:return function(i,o){const a=xs(i),l=xs(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=je(a[c],l[c]);if(d!==0)return d}return je(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=je($t(i.latitude),$t(o.latitude));return a!==0?a:je($t(i.longitude),$t(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return qv(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,d;const f=i.fields||{},g=o.fields||{},y=(a=f.value)===null||a===void 0?void 0:a.arrayValue,x=(l=g.value)===null||l===void 0?void 0:l.arrayValue,S=je(((c=y==null?void 0:y.values)===null||c===void 0?void 0:c.length)||0,((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0);return S!==0?S:qv(y,x)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===ci.mapValue&&o===ci.mapValue)return 0;if(i===ci.mapValue)return 1;if(o===ci.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const g=je(l[f],d[f]);if(g!==0)return g;const y=Ei(a[l[f]],c[d[f]]);if(y!==0)return y}return je(l.length,d.length)}(n.mapValue,e.mapValue);default:throw Ae()}}function Bv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return je(n,e);const t=Ts(n),r=Ts(e),s=je(t.seconds,r.seconds);return s!==0?s:je(t.nanos,r.nanos)}function qv(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Ei(t[s],r[s]);if(i)return i}return je(t.length,r.length)}function ka(n){return Wf(n)}function Wf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ts(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return xs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ie.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Wf(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Wf(t.fields[o])}`;return s+"}"}(n.mapValue):Ae()}function ed(n){switch(Ii(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=oh(n);return e?16+ed(e):16;case 5:return 2*n.stringValue.length;case 6:return xs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ed(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Di(r.fields,(i,o)=>{s+=i.length+ed(o)}),s}(n.mapValue);default:throw Ae()}}function _o(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Qf(n){return!!n&&"integerValue"in n}function bu(n){return!!n&&"arrayValue"in n}function zv(n){return!!n&&"nullValue"in n}function Gv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function td(n){return!!n&&"mapValue"in n}function ah(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function tu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Di(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=tu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=tu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Eb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const Tb={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function N1(n){return"nullValue"in n?Zc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?_o(yo.empty(),Ie.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ah(n)?Tb:{mapValue:{}}:Ae()}function O1(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?_o(yo.empty(),Ie.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Tb:"mapValue"in n?ah(n)?{mapValue:{}}:ci:Ae()}function Kv(n,e){const t=Ei(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Hv(n,e){const t=Ei(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.value=e}static empty(){return new Sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!td(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=tu(t)}setAll(e){let t=Ut.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=tu(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());td(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return es(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];td(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Di(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Sn(tu(this.value))}}function xb(n){const e=[];return Di(n.fields,(t,r)=>{const s=new Ut([t]);if(td(r)){const i=xb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ot(e,0,ke.min(),ke.min(),ke.min(),Sn.empty(),0)}static newFoundDocument(e,t,r,s){return new Ot(e,1,t,ke.min(),r,s,0)}static newNoDocument(e,t){return new Ot(e,2,t,ke.min(),ke.min(),Sn.empty(),0)}static newUnknownDocument(e,t){return new Ot(e,3,t,ke.min(),ke.min(),Sn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ot&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ot(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,t){this.position=e,this.inclusive=t}}function Wv(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=Ie.comparator(Ie.fromName(o.referenceValue),t.key):r=Ei(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Qv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!es(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,t="asc"){this.field=e,this.dir=t}}function M1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{}class nt extends Ab{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new L1(e,t,r):t==="array-contains"?new U1(e,r):t==="in"?new Db(e,r):t==="not-in"?new j1(e,r):t==="array-contains-any"?new B1(e,r):new nt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new F1(e,r):new $1(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ei(t,this.value)):t!==null&&Ii(this.value)===Ii(t)&&this.matchesComparison(Ei(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yt extends Ab{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new yt(e,t)}matches(e){return Da(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Da(n){return n.op==="and"}function Jf(n){return n.op==="or"}function Qp(n){return Sb(n)&&Da(n)}function Sb(n){for(const e of n.filters)if(e instanceof yt)return!1;return!0}function Yf(n){if(n instanceof nt)return n.field.canonicalString()+n.op.toString()+ka(n.value);if(Qp(n))return n.filters.map(e=>Yf(e)).join(",");{const e=n.filters.map(t=>Yf(t)).join(",");return`${n.op}(${e})`}}function Pb(n,e){return n instanceof nt?function(r,s){return s instanceof nt&&r.op===s.op&&r.field.isEqual(s.field)&&es(r.value,s.value)}(n,e):n instanceof yt?function(r,s){return s instanceof yt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Pb(o,s.filters[a]),!0):!1}(n,e):void Ae()}function Rb(n,e){const t=n.filters.concat(e);return yt.create(t,n.op)}function Cb(n){return n instanceof nt?function(t){return`${t.field.canonicalString()} ${t.op} ${ka(t.value)}`}(n):n instanceof yt?function(t){return t.op.toString()+" {"+t.getFilters().map(Cb).join(" ,")+"}"}(n):"Filter"}class L1 extends nt{constructor(e,t,r){super(e,t,r),this.key=Ie.fromName(r.referenceValue)}matches(e){const t=Ie.comparator(e.key,this.key);return this.matchesComparison(t)}}class F1 extends nt{constructor(e,t){super(e,"in",t),this.keys=kb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class $1 extends nt{constructor(e,t){super(e,"not-in",t),this.keys=kb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function kb(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Ie.fromName(r.referenceValue))}class U1 extends nt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bu(t)&&_u(t.arrayValue,this.value)}}class Db extends nt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&_u(this.value.arrayValue,t)}}class j1 extends nt{constructor(e,t){super(e,"not-in",t)}matches(e){if(_u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!_u(this.value.arrayValue,t)}}class B1 extends nt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>_u(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Xf(n,e=null,t=[],r=[],s=null,i=null,o=null){return new q1(n,e,t,r,s,i,o)}function bo(n){const e=be(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Yf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ju(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ka(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ka(r)).join(",")),e.ue=t}return e.ue}function Bu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!M1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Pb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Qv(n.startAt,e.startAt)&&Qv(n.endAt,e.endAt)}function Td(n){return Ie.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function xd(n,e){return n.filters.filter(t=>t instanceof nt&&t.field.isEqual(e))}function Jv(n,e,t){let r=Zc,s=!0;for(const i of xd(n,e)){let o=Zc,a=!0;switch(i.op){case"<":case"<=":o=N1(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Zc}Kv({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Kv({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Yv(n,e,t){let r=ci,s=!0;for(const i of xd(n,e)){let o=ci,a=!0;switch(i.op){case">=":case">":o=O1(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=ci}Hv({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Hv({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Vb(n,e,t,r,s,i,o,a){return new ks(n,e,t,r,s,i,o,a)}function Ja(n){return new ks(n)}function Xv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Jp(n){return n.collectionGroup!==null}function ga(n){const e=be(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new _t(Ut.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new wu(i,r))}),t.has(Ut.keyField().canonicalString())||e.ce.push(new wu(Ut.keyField(),r))}return e.ce}function Bn(n){const e=be(n);return e.le||(e.le=Ob(e,ga(n))),e.le}function Nb(n){const e=be(n);return e.he||(e.he=Ob(e,n.explicitOrderBy)),e.he}function Ob(n,e){if(n.limitType==="F")return Xf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new wu(s.field,i)});const t=n.endAt?new Ti(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ti(n.startAt.position,n.startAt.inclusive):null;return Xf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Zf(n,e){const t=n.filters.concat([e]);return new ks(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ad(n,e,t){return new ks(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qu(n,e){return Bu(Bn(n),Bn(e))&&n.limitType===e.limitType}function Mb(n){return`${bo(Bn(n))}|lt:${n.limitType}`}function aa(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>Cb(s)).join(", ")}]`),ju(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>ka(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>ka(s)).join(",")),`Target(${r})`}(Bn(n))}; limitType=${n.limitType})`}function zu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ie.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of ga(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=Wv(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,ga(r),s)||r.endAt&&!function(o,a,l){const c=Wv(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,ga(r),s))}(n,e)}function Lb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Fb(n){return(e,t)=>{let r=!1;for(const s of ga(n)){const i=z1(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function z1(n,e,t){const r=n.field.isKeyField()?Ie.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ei(l,c):Ae()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Di(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return wb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1=new St(Ie.comparator);function ir(){return G1}const $b=new St(Ie.comparator);function Ul(...n){let e=$b;for(const t of n)e=e.insert(t.key,t);return e}function Ub(n){let e=$b;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Hr(){return nu()}function jb(){return nu()}function nu(){return new Ds(n=>n.toString(),(n,e)=>n.isEqual(e))}const K1=new St(Ie.comparator),H1=new _t(Ie.comparator);function Ke(...n){let e=H1;for(const t of n)e=e.add(t);return e}const W1=new _t(je);function Yp(){return W1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vu(e)?"-0":e}}function Bb(n){return{integerValue:""+n}}function qb(n,e){return mb(e)?Bb(e):Xp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(){this._=void 0}}function Q1(n,e,t){return n instanceof Va?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ih(i)&&(i=oh(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof wo?Gb(n,e):n instanceof Io?Kb(n,e):function(s,i){const o=zb(s,i),a=Zv(o)+Zv(s.Pe);return Qf(o)&&Qf(s.Pe)?Bb(a):Xp(s.serializer,a)}(n,e)}function J1(n,e,t){return n instanceof wo?Gb(n,e):n instanceof Io?Kb(n,e):t}function zb(n,e){return n instanceof Na?function(r){return Qf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Va extends lh{}class wo extends lh{constructor(e){super(),this.elements=e}}function Gb(n,e){const t=Hb(e);for(const r of n.elements)t.some(s=>es(s,r))||t.push(r);return{arrayValue:{values:t}}}class Io extends lh{constructor(e){super(),this.elements=e}}function Kb(n,e){let t=Hb(e);for(const r of n.elements)t=t.filter(s=>!es(s,r));return{arrayValue:{values:t}}}class Na extends lh{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Zv(n){return $t(n.integerValue||n.doubleValue)}function Hb(n){return bu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e,t){this.field=e,this.transform=t}}function Y1(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof wo&&s instanceof wo||r instanceof Io&&s instanceof Io?Pa(r.elements,s.elements,es):r instanceof Na&&s instanceof Na?es(r.Pe,s.Pe):r instanceof Va&&s instanceof Va}(n.transform,e.transform)}class X1{constructor(e,t){this.version=e,this.transformResults=t}}class jt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new jt}static exists(e){return new jt(void 0,e)}static updateTime(e){return new jt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class uh{}function Wb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xa(n.key,jt.none()):new Ya(n.key,n.data,jt.none());{const t=n.data,r=Sn.empty();let s=new _t(Ut.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Vs(n.key,r,new sr(s.toArray()),jt.none())}}function Z1(n,e,t){n instanceof Ya?function(s,i,o){const a=s.value.clone(),l=ty(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Vs?function(s,i,o){if(!nd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=ty(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Qb(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ru(n,e,t,r){return n instanceof Ya?function(i,o,a,l){if(!nd(i.precondition,o))return a;const c=i.value.clone(),d=ny(i.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Vs?function(i,o,a,l){if(!nd(i.precondition,o))return a;const c=ny(i.fieldTransforms,l,o),d=o.data;return d.setAll(Qb(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return nd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function eR(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=zb(r.transform,s||null);i!=null&&(t===null&&(t=Sn.empty()),t.set(r.field,i))}return t||null}function ey(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Pa(r,s,(i,o)=>Y1(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ya extends uh{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Vs extends uh{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Qb(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function ty(n,e,t){const r=new Map;Se(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,J1(o,a,t[s]))}return r}function ny(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,Q1(i,o,e))}return r}class Xa extends uh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zp extends uh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Z1(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ru(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ru(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=jb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=Wb(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ke.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ke())}isEqual(e){return this.batchId===e.batchId&&Pa(this.mutations,e.mutations,(t,r)=>ey(t,r))&&Pa(this.baseMutations,e.baseMutations,(t,r)=>ey(t,r))}}class tm{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Se(e.mutations.length===r.length);let s=function(){return K1}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new tm(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var un,lt;function Yb(n){switch(n){default:return Ae();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function Xb(n){if(n===void 0)return Xt("GRPC error has no .code"),K.UNKNOWN;switch(n){case un.OK:return K.OK;case un.CANCELLED:return K.CANCELLED;case un.UNKNOWN:return K.UNKNOWN;case un.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case un.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case un.INTERNAL:return K.INTERNAL;case un.UNAVAILABLE:return K.UNAVAILABLE;case un.UNAUTHENTICATED:return K.UNAUTHENTICATED;case un.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case un.NOT_FOUND:return K.NOT_FOUND;case un.ALREADY_EXISTS:return K.ALREADY_EXISTS;case un.PERMISSION_DENIED:return K.PERMISSION_DENIED;case un.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case un.ABORTED:return K.ABORTED;case un.OUT_OF_RANGE:return K.OUT_OF_RANGE;case un.UNIMPLEMENTED:return K.UNIMPLEMENTED;case un.DATA_LOSS:return K.DATA_LOSS;default:return Ae()}}(lt=un||(un={}))[lt.OK=0]="OK",lt[lt.CANCELLED=1]="CANCELLED",lt[lt.UNKNOWN=2]="UNKNOWN",lt[lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lt[lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lt[lt.NOT_FOUND=5]="NOT_FOUND",lt[lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",lt[lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",lt[lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",lt[lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lt[lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lt[lt.ABORTED=10]="ABORTED",lt[lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",lt[lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",lt[lt.INTERNAL=13]="INTERNAL",lt[lt.UNAVAILABLE=14]="UNAVAILABLE",lt[lt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sd=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=new fo([4294967295,4294967295],0);function ry(n){const e=Zb().encode(n),t=new eb;return t.update(e),new Uint8Array(t.digest())}function sy(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new fo([t,r],0),new fo([s,i],0)]}class rm{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new jl(`Invalid padding: ${t}`);if(r<0)throw new jl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new jl(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new jl(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=fo.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(fo.fromNumber(r)));return s.compare(nR)===1&&(s=new fo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=ry(e),[r,s]=sy(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new rm(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=ry(e),[r,s]=sy(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class jl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Hu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ku(ke.min(),s,new St(je),ir(),Ke())}}class Hu{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Hu(r,t,Ke(),Ke(),Ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class ew{constructor(e,t){this.targetId=e,this.me=t}}class tw{constructor(e,t,r=Wt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class iy{constructor(){this.fe=0,this.ge=ay(),this.pe=Wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ke(),t=Ke(),r=Ke();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Ae()}}),new Hu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=ay()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Se(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class rR{constructor(e){this.Le=e,this.Be=new Map,this.ke=ir(),this.qe=oy(),this.Qe=new St(je)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Td(i))if(r===0){const o=new Ie(i.path);this.Ue(t,o,Ot.newNoDocument(o,ke.min()))}else Se(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}Sd==null||Sd.et(function(d,f,g,y,x){var S,P,j,U,D,G;const Z={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},me=f.unchangedNames;return me&&(Z.bloomFilter={applied:x===0,hashCount:(S=me==null?void 0:me.hashCount)!==null&&S!==void 0?S:0,bitmapLength:(U=(j=(P=me==null?void 0:me.bits)===null||P===void 0?void 0:P.bitmap)===null||j===void 0?void 0:j.length)!==null&&U!==void 0?U:0,padding:(G=(D=me==null?void 0:me.bits)===null||D===void 0?void 0:D.padding)!==null&&G!==void 0?G:0,mightContain:T=>{var w;return(w=y==null?void 0:y.mightContain(T))!==null&&w!==void 0&&w}}),Z}(o,e.me,this.Le.tt(),a,l))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=xs(r).toUint8Array()}catch(l){if(l instanceof Ib)return Er("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new rm(o,s,i)}catch(l){return Er(l instanceof jl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Td(a.target)){const l=new Ie(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ot.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=Ke();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Ku(e,t,this.Qe,this.ke,r);return this.ke=ir(),this.qe=oy(),this.Qe=new St(je),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new iy,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new _t(je),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||se("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new iy),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function oy(){return new St(Ie.comparator)}function ay(){return new St(Ie.comparator)}const sR=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),iR=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),oR=(()=>({and:"AND",or:"OR"}))();class aR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ep(n,e){return n.useProto3Json||ju(e)?e:{value:e}}function Oa(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function lR(n,e){return Oa(n,e.toTimestamp())}function en(n){return Se(!!n),ke.fromTimestamp(function(t){const r=Ts(t);return new Gt(r.seconds,r.nanos)}(n))}function sm(n,e){return tp(n,e).canonicalString()}function tp(n,e){const t=function(s){return new tt(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function rw(n){const e=tt.fromString(n);return Se(fw(e)),e}function Iu(n,e){return sm(n.databaseId,e.path)}function Jr(n,e){const t=rw(e);if(t.get(1)!==n.databaseId.projectId)throw new ie(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ie(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ie(ow(t))}function sw(n,e){return sm(n.databaseId,e)}function iw(n){const e=rw(n);return e.length===4?tt.emptyPath():ow(e)}function np(n){return new tt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ow(n){return Se(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function ly(n,e,t){return{name:Iu(n,e),fields:t.value.mapValue.fields}}function aw(n,e,t){const r=Jr(n,e.name),s=en(e.updateTime),i=e.createTime?en(e.createTime):ke.min(),o=new Sn({mapValue:{fields:e.fields}}),a=Ot.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function uR(n,e){return"found"in e?function(r,s){Se(!!s.found),s.found.name,s.found.updateTime;const i=Jr(r,s.found.name),o=en(s.found.updateTime),a=s.found.createTime?en(s.found.createTime):ke.min(),l=new Sn({mapValue:{fields:s.found.fields}});return Ot.newFoundDocument(i,o,a,l)}(n,e):"missing"in e?function(r,s){Se(!!s.missing),Se(!!s.readTime);const i=Jr(r,s.missing),o=en(s.readTime);return Ot.newNoDocument(i,o)}(n,e):Ae()}function cR(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Se(d===void 0||typeof d=="string"),Wt.fromBase64String(d||"")):(Se(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?K.UNKNOWN:Xb(c.code);return new ie(d,c.message||"")}(o);t=new tw(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Jr(n,r.document.name),i=en(r.document.updateTime),o=r.document.createTime?en(r.document.createTime):ke.min(),a=new Sn({mapValue:{fields:r.document.fields}}),l=Ot.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new rd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Jr(n,r.document),i=r.readTime?en(r.readTime):ke.min(),o=Ot.newNoDocument(s,i),a=r.removedTargetIds||[];t=new rd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Jr(n,r.document),i=r.removedTargetIds||[];t=new rd([],i,s,null)}else{if(!("filter"in e))return Ae();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new tR(s,i),a=r.targetId;t=new ew(a,o)}}return t}function Eu(n,e){let t;if(e instanceof Ya)t={update:ly(n,e.key,e.value)};else if(e instanceof Xa)t={delete:Iu(n,e.key)};else if(e instanceof Vs)t={update:ly(n,e.key,e.data),updateMask:gR(e.fieldMask)};else{if(!(e instanceof Zp))return Ae();t={verify:Iu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Va)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof wo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Io)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Na)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Ae()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:lR(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ae()}(n,e.precondition)),t}function rp(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?jt.updateTime(en(i.updateTime)):i.exists!==void 0?jt.exists(i.exists):jt.none()}(e.currentDocument):jt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Se(a.setToServerValue==="REQUEST_TIME"),l=new Va;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new wo(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Io(d)}else"increment"in a?l=new Na(o,a.increment):Ae();const c=Ut.fromServerFormat(a.fieldPath);return new Gu(c,l)}(n,s)):[];if(e.update){e.update.name;const s=Jr(n,e.update.name),i=new Sn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new sr(c.map(d=>Ut.fromServerFormat(d)))}(e.updateMask);return new Vs(s,i,o,t,r)}return new Ya(s,i,t,r)}if(e.delete){const s=Jr(n,e.delete);return new Xa(s,t)}if(e.verify){const s=Jr(n,e.verify);return new Zp(s,t)}return Ae()}function dR(n,e){return n&&n.length>0?(Se(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?en(s.updateTime):en(i);return o.isEqual(ke.min())&&(o=en(i)),new X1(o,s.transformResults||[])}(t,e))):[]}function lw(n,e){return{documents:[sw(n,e.path)]}}function ch(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=sw(n,s);const i=function(c){if(c.length!==0)return hw(yt.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:ri(g.field),direction:fR(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=ep(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function uw(n,e,t,r){const{_t:s,parent:i}=ch(n,e),o={},a=[];let l=0;return t.forEach(c=>{const d=r?c.alias:"aggregate_"+l++;o[d]=c.alias,c.aggregateType==="count"?a.push({alias:d,count:{}}):c.aggregateType==="avg"?a.push({alias:d,avg:{field:ri(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:d,sum:{field:ri(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function cw(n){let e=iw(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Se(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const g=dw(f);return g instanceof yt&&Qp(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(x){return new wu(la(x.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,ju(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(f){const g=!!f.before,y=f.values||[];return new Ti(y,g)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const g=!f.before,y=f.values||[];return new Ti(y,g)}(t.endAt)),Vb(e,s,o,i,a,"F",l,c)}function hR(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function dw(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=la(t.unaryFilter.field);return nt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=la(t.unaryFilter.field);return nt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=la(t.unaryFilter.field);return nt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=la(t.unaryFilter.field);return nt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ae()}}(n):n.fieldFilter!==void 0?function(t){return nt.create(la(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ae()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return yt.create(t.compositeFilter.filters.map(r=>dw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ae()}}(t.compositeFilter.op))}(n):Ae()}function fR(n){return sR[n]}function pR(n){return iR[n]}function mR(n){return oR[n]}function ri(n){return{fieldPath:n.canonicalString()}}function la(n){return Ut.fromServerFormat(n.fieldPath)}function hw(n){return n instanceof nt?function(t){if(t.op==="=="){if(Gv(t.value))return{unaryFilter:{field:ri(t.field),op:"IS_NAN"}};if(zv(t.value))return{unaryFilter:{field:ri(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Gv(t.value))return{unaryFilter:{field:ri(t.field),op:"IS_NOT_NAN"}};if(zv(t.value))return{unaryFilter:{field:ri(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ri(t.field),op:pR(t.op),value:t.value}}}(n):n instanceof yt?function(t){const r=t.getFilters().map(s=>hw(s));return r.length===1?r[0]:{compositeFilter:{op:mR(t.op),filters:r}}}(n):Ae()}function gR(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function fw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,t,r,s,i=ke.min(),o=ke.min(),a=Wt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e){this.ct=e}}function vR(n,e){let t;if(e.document)t=aw(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ie.fromSegments(e.noDocument.path),s=To(e.noDocument.readTime);t=Ot.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae();{const r=Ie.fromSegments(e.unknownDocument.path),s=To(e.unknownDocument.version);t=Ot.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Gt(s[0],s[1]);return ke.fromTimestamp(i)}(e.readTime)),t}function uy(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Iu(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Oa(i,o.version.toTimestamp()),createTime:Oa(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Eo(e.version)};else{if(!e.isUnknownDocument())return Ae();r.unknownDocument={path:t.path.toArray(),version:Eo(e.version)}}return r}function Pd(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Eo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function To(n){const e=new Gt(n.seconds,n.nanoseconds);return ke.fromTimestamp(e)}function oo(n,e){const t=(e.baseMutations||[]).map(i=>rp(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>rp(n.ct,i)),s=Gt.fromMillis(e.localWriteTimeMs);return new em(e.batchId,s,t,r)}function Bl(n){const e=To(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?To(n.lastLimboFreeSnapshotVersion):ke.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return Se(i.documents.length===1),Bn(Ja(iw(i.documents[0])))}(n.query):function(i){return Bn(cw(i))}(n.query),new ps(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Wt.fromBase64String(n.resumeToken))}function mw(n,e){const t=Eo(e.snapshotVersion),r=Eo(e.lastLimboFreeSnapshotVersion);let s;s=Td(e.target)?lw(n.ct,e.target):ch(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:bo(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function im(n){const e=cw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ad(e,e.limit,"L"):e}function pf(n,e){return new nm(e.largestBatchId,rp(n.ct,e.overlayMutation))}function cy(n,e){const t=e.path.lastSegment();return[n,jn(e.path.popLast()),t]}function dy(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Eo(r.readTime),documentKey:jn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{getBundleMetadata(e,t){return hy(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:To(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return hy(e).put(function(s){return{bundleId:s.id,createTime:Eo(en(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return fy(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:im(i.bundledQuery),readTime:To(i.readTime)}}(r)})}saveNamedQuery(e,t){return fy(e).put(function(s){return{name:s.name,readTime:Eo(en(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function hy(n){return gn(n,"bundles")}function fy(n){return gn(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new dh(e,r)}getOverlay(e,t){return Rl(e).get(cy(this.userId,t)).next(r=>r?pf(this.serializer,r):null)}getOverlays(e,t){const r=Hr();return z.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new nm(t,o);s.push(this.ht(e,a))}),z.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(jn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Rl(e).j("collectionPathOverlayIndex",a))}),z.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Hr(),i=jn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Rl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=pf(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Hr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Rl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const f=pf(this.serializer,c);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return Rl(e).put(function(s,i,o){const[a,l,c]=cy(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Eu(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Rl(n){return gn(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{Pt(e){return gn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Wt.fromUint8Array(r):Wt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At($t(e.integerValue));else if("doubleValue"in e){const r=$t(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),vu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ts(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(xs(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Eb(e)?this.dt(t,Number.MAX_SAFE_INTEGER):ah(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ae()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At($t(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),Ie.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ao.vt=new ao;function bR(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function py(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=bR(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class wR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=py(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=py(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class IR{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class ER{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Cl{constructor(){this.jt=new wR,this.Ht=new IR(this.jt),this.Jt=new ER(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new lo(this.indexId,this.documentKey,this.arrayValue,r)}}function Js(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=my(n.arrayValue,e.arrayValue),t!==0?t:(t=my(n.directionalValue,e.directionalValue),t!==0?t:Ie.comparator(n.documentKey,e.documentKey)))}function my(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e){this.Xt=new _t((t,r)=>Ut.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Se(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Kf(e);if(t!==void 0&&!this.sn(t))return!1;const r=no(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new _t(Ut.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new po(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new po(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new po(r.field,r.dir==="asc"?0:1)));return new Ra(Ra.UNKNOWN_ID,this.collectionId,t,Ca.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(n){var e,t;if(Se(n instanceof nt||n instanceof yt),n instanceof nt){if(n instanceof Db){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>nt.create(n.field,"==",i)))||[];return yt.create(s,"or")}return n}const r=n.filters.map(s=>gw(s));return yt.create(r,n.op)}function TR(n){if(n.getFilters().length===0)return[];const e=op(gw(n));return Se(vw(e)),sp(e)||ip(e)?[e]:e.getFilters()}function sp(n){return n instanceof nt}function ip(n){return n instanceof yt&&Qp(n)}function vw(n){return sp(n)||ip(n)||function(t){if(t instanceof yt&&Jf(t)){for(const r of t.getFilters())if(!sp(r)&&!ip(r))return!1;return!0}return!1}(n)}function op(n){if(Se(n instanceof nt||n instanceof yt),n instanceof nt)return n;if(n.filters.length===1)return op(n.filters[0]);const e=n.filters.map(r=>op(r));let t=yt.create(e,n.op);return t=Rd(t),vw(t)?t:(Se(t instanceof yt),Se(Da(t)),Se(t.filters.length>1),t.filters.reduce((r,s)=>om(r,s)))}function om(n,e){let t;return Se(n instanceof nt||n instanceof yt),Se(e instanceof nt||e instanceof yt),t=n instanceof nt?e instanceof nt?function(s,i){return yt.create([s,i],"and")}(n,e):vy(n,e):e instanceof nt?vy(e,n):function(s,i){if(Se(s.filters.length>0&&i.filters.length>0),Da(s)&&Da(i))return Rb(s,i.getFilters());const o=Jf(s)?s:i,a=Jf(s)?i:s,l=o.filters.map(c=>om(c,a));return yt.create(l,"or")}(n,e),Rd(t)}function vy(n,e){if(Da(e))return Rb(e,n.getFilters());{const t=e.filters.map(r=>om(n,r));return yt.create(t,"or")}}function Rd(n){if(Se(n instanceof nt||n instanceof yt),n instanceof nt)return n;const e=n.getFilters();if(e.length===1)return Rd(e[0]);if(Sb(n))return n;const t=e.map(s=>Rd(s)),r=[];return t.forEach(s=>{s instanceof nt?r.push(s):s instanceof yt&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:yt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(){this.un=new am}addToCollectionParentIndex(e,t){return this.un.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(hr.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(hr.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class am{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new _t(tt.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new _t(tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc=new Uint8Array(0);class AR{constructor(e,t){this.databaseId=t,this.cn=new am,this.ln=new Ds(r=>bo(r),(r,s)=>Bu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:jn(s)};return yy(e).put(i)}return z.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[ub(t),""],!1,!0);return yy(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Kr(o.parent))}return r})}addFieldIndex(e,t){const r=kl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=na(e);return i.next(a=>{o.put(dy(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=kl(e),s=na(e),i=ta(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=kl(e),r=ta(e),s=na(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return z.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new gy(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=ta(e);let s=!0;const i=new Map;return z.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ke();const a=[];return z.forEach(i,(l,c)=>{se("IndexedDbIndexManager",`Using index ${function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map(G=>`${G.fieldPath}:${G.kind}`).join(",")}`}(l)} to execute ${bo(t)}`);const d=function(D,G){const Z=Kf(G);if(Z===void 0)return null;for(const me of xd(D,Z.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(c,l),f=function(D,G){const Z=new Map;for(const me of no(G))for(const T of xd(D,me.fieldPath))switch(T.op){case"==":case"in":Z.set(me.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return Z.set(me.fieldPath.canonicalString(),T.value),Array.from(Z.values())}return null}(c,l),g=function(D,G){const Z=[];let me=!0;for(const T of no(G)){const w=T.kind===0?Jv(D,T.fieldPath,D.startAt):Yv(D,T.fieldPath,D.startAt);Z.push(w.value),me&&(me=w.inclusive)}return new Ti(Z,me)}(c,l),y=function(D,G){const Z=[];let me=!0;for(const T of no(G)){const w=T.kind===0?Yv(D,T.fieldPath,D.endAt):Jv(D,T.fieldPath,D.endAt);Z.push(w.value),me&&(me=w.inclusive)}return new Ti(Z,me)}(c,l),x=this.In(l,c,g),S=this.In(l,c,y),P=this.Tn(l,c,f),j=this.En(l.indexId,d,x,g.inclusive,S,y.inclusive,P);return z.forEach(j,U=>r.G(U,t.limit).next(D=>{D.forEach(G=>{const Z=Ie.fromSegments(G.documentKey);o.has(Z)||(o=o.add(Z),a.push(Z))})}))}).next(()=>a)}return z.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=TR(yt.create(e.filters,"and")).map(r=>Xf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),c=l/(t!=null?t.length:1),d=[];for(let f=0;f<l;++f){const g=t?this.dn(t[f/c]):Lc,y=this.An(e,g,r[f%c],s),x=this.Rn(e,g,i[f%c],o),S=a.map(P=>this.An(e,g,P,!0));d.push(...this.createRange(y,x,S))}return d}An(e,t,r,s){const i=new lo(e,Ie.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new lo(e,Ie.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new gy(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return z.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new _t(Ut.comparator),d=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:c=c.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new Cl;for(const s of no(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);ao.vt.It(i,o)}return r.zt()}dn(e){const t=new Cl;return ao.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Cl;return ao.vt.It(_o(this.databaseId,t),r.Yt(function(i){const o=no(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new Cl);let i=0;for(const o of no(e)){const a=r[i++];for(const l of s)if(this.fn(t,o.fieldPath)&&bu(a))s=this.gn(s,o,a);else{const c=l.Yt(o.kind);ao.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Cl;l.seed(a.zt()),ao.vt.It(o,l.Yt(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof nt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=kl(e),s=na(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return z.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(d,f){const g=f?new Ca(f.sequenceNumber,new hr(To(f.readTime),new Ie(Kr(f.documentKey)),f.largestBatchId)):Ca.empty(),y=d.fields.map(([x,S])=>new po(Ut.fromServerFormat(x),S));return new Ra(d.indexId,d.collectionGroup,y,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:je(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=kl(e),i=na(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>z.forEach(a,l=>i.put(dy(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return z.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?z.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),z.forEach(a,l=>this.wn(e,s,l).next(c=>{const d=this.Sn(i,l);return c.isEqual(d)?z.resolve():this.bn(e,i,l,c,d)}))))})}Dn(e,t,r,s){return ta(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return ta(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=ta(e);let i=new _t(Js);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new lo(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new _t(Js);const s=this.Vn(t,e);if(s==null)return r;const i=Kf(t);if(i!=null){const o=e.data.field(i.fieldPath);if(bu(o))for(const a of o.arrayValue.values||[])r=r.add(new lo(t.indexId,e.key,this.dn(a),s))}else r=r.add(new lo(t.indexId,e.key,Lc,s));return r}bn(e,t,r,s,i){se("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,c,d,f,g){const y=l.getIterator(),x=c.getIterator();let S=ea(y),P=ea(x);for(;S||P;){let j=!1,U=!1;if(S&&P){const D=d(S,P);D<0?U=!0:D>0&&(j=!0)}else S!=null?U=!0:j=!0;j?(f(P),P=ea(x)):U?(g(S),S=ea(y)):(S=ea(y),P=ea(x))}}(s,i,Js,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),z.waitFor(o)}yn(e){let t=1;return na(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Js(o,a)).filter((o,a,l)=>!a||Js(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Js(o,e),l=Js(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Lc,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Lc,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,t){return Js(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(_y)}getMinOffset(e,t){return z.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||Ae())).next(_y)}}function yy(n){return gn(n,"collectionParents")}function ta(n){return gn(n,"indexEntries")}function kl(n){return gn(n,"indexConfiguration")}function na(n){return gn(n,"indexState")}function _y(n){Se(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Kp(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new hr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Mn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Mn(e,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(d,f,g)=>(a++,g.delete()));i.push(l.next(()=>{Se(a===1)}));const c=[];for(const d of t.mutations){const f=gb(e,d.key.path,t.batchId);i.push(s.delete(f)),c.push(d.key)}return z.waitFor(i).next(()=>c)}function Cd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ae();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn.DEFAULT_COLLECTION_PERCENTILE=10,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mn.DEFAULT=new Mn(41943040,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mn.DISABLED=new Mn(-1,0,0);class hh{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){Se(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new hh(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ys(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=ua(e),o=Ys(e);return o.add({}).next(a=>{Se(typeof a=="number");const l=new em(a,t,r,s),c=function(y,x,S){const P=S.baseMutations.map(U=>Eu(y.ct,U)),j=S.mutations.map(U=>Eu(y.ct,U));return{userId:x,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:P,mutations:j}}(this.serializer,this.userId,l),d=[];let f=new _t((g,y)=>je(g.canonicalString(),y.canonicalString()));for(const g of s){const y=gb(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(c)),d.push(i.put(y,p1))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),z.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return Ys(e).get(t).next(r=>r?(Se(r.userId===this.userId),oo(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?z.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ys(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(Se(a.batchId>=r),i=oo(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ys(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ys(e).U("userMutationsIndex",t).next(r=>r.map(s=>oo(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Xc(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return ua(e).J({range:s},(o,a,l)=>{const[c,d,f]=o,g=Kr(d);if(c===this.userId&&t.path.isEqual(g))return Ys(e).get(f).next(y=>{if(!y)throw Ae();Se(y.userId===this.userId),i.push(oo(this.serializer,y))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new _t(je);const s=[];return t.forEach(i=>{const o=Xc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=ua(e).J({range:a},(c,d,f)=>{const[g,y,x]=c,S=Kr(y);g===this.userId&&i.path.isEqual(S)?r=r.add(x):f.done()});s.push(l)}),z.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Xc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new _t(je);return ua(e).J({range:o},(l,c,d)=>{const[f,g,y]=l,x=Kr(g);f===this.userId&&r.isPrefixOf(x)?x.length===s&&(a=a.add(y)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(Ys(e).get(i).next(o=>{if(o===null)throw Ae();Se(o.userId===this.userId),r.push(oo(this.serializer,o))}))}),z.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return yw(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),z.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return z.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ua(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Kr(i[1]);s.push(l)}else a.done()}).next(()=>{Se(s.length===0)})})}containsKey(e,t){return _w(e,this.userId,t)}Nn(e){return bw(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function _w(n,e,t){const r=Xc(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ua(n).J({range:i,H:!0},(a,l,c)=>{const[d,f,g]=a;d===e&&f===s&&(o=!0),c.done()}).next(()=>o)}function Ys(n){return gn(n,"mutations")}function ua(n){return gn(n,"documentMutations")}function bw(n){return gn(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new xo(0)}static kn(){return new xo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new xo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ke.fromTimestamp(new Gt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ra(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Se(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return ra(e).J((o,a)=>{const l=Bl(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>z.waitFor(i)).next(()=>s)}forEachTarget(e,t){return ra(e).J((r,s)=>{const i=Bl(s);t(i)})}qn(e){return wy(e).get("targetGlobalKey").next(t=>(Se(t!==null),t))}Qn(e,t){return wy(e).put("targetGlobalKey",t)}Kn(e,t){return ra(e).put(mw(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=bo(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ra(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const c=Bl(a);Bu(t,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=si(e);return t.forEach(o=>{const a=jn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),z.waitFor(s)}removeMatchingKeys(e,t,r){const s=si(e);return z.forEach(t,i=>{const o=jn(i.path);return z.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=si(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=si(e);let i=Ke();return s.J({range:r,H:!0},(o,a,l)=>{const c=Kr(o[1]),d=new Ie(c);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=jn(t.path),s=IDBKeyRange.bound([r],[ub(r)],!1,!0);let i=0;return si(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return ra(e).get(t).next(r=>r?Bl(r):null)}}function ra(n){return gn(n,"targets")}function wy(n){return gn(n,"targetGlobal")}function si(n){return gn(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy([n,e],[t,r]){const s=je(n,t);return s===0?je(e,r):s}class PR{constructor(e){this.Un=e,this.buffer=new _t(Iy),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Iy(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ww{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){se("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ki(t)?se("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ci(t)}await this.Hn(3e5)})}}class RR{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return z.resolve(rr.oe);const r=new PR(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(se("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(by)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(se("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),by):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),oa()<=et.DEBUG&&se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function Iw(n,e){return new RR(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,t){this.db=e,this.garbageCollector=Iw(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Fc(e,r)}removeReference(e,t,r){return Fc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Fc(e,t)}nr(e,t){return function(s,i){let o=!1;return bw(s).Y(a=>_w(s,a,i).next(l=>(l&&(o=!0),z.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ke.min()),si(e).delete(function(f){return[0,jn(f.path)]}(o))))});s.push(l)}}).next(()=>z.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Fc(e,t)}tr(e,t){const r=si(e);let s,i=rr.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==rr.oe&&t(new Ie(Kr(s)),i),i=c,s=l):i=rr.oe}).next(()=>{i!==rr.oe&&t(new Ie(Kr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Fc(n,e){return si(n).put(function(r,s){return{targetId:0,path:jn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(){this.changes=new Ds(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ot.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Zi(e).put(r)}removeEntry(e,t,r){return Zi(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Pd(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ot.newInvalidDocument(t);return Zi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Dl(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:Ot.newInvalidDocument(t)};return Zi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Dl(t))},(s,i)=>{r={document:this.ir(t,i),size:Cd(i)}}).next(()=>r)}getEntries(e,t){let r=ir();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=ir(),s=new St(Ie.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Cd(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return z.resolve();let s=new _t(xy);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Dl(s.first()),Dl(s.last())),o=s.getIterator();let a=o.getNext();return Zi(e).J({index:"documentKeyIndex",range:i},(l,c,d)=>{const f=Ie.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&xy(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Dl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Pd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zi(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=ir();for(const f of c){const g=this.ir(Ie.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(zu(t,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=ir();const o=Ty(t,r),a=Ty(t,hr.max());return Zi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const f=this.ir(Ie.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new DR(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Ey(e).get("remoteDocumentGlobalKey").next(t=>(Se(!!t),t))}rr(e,t){return Ey(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=vR(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ke.min())))return r}return Ot.newInvalidDocument(e)}}function Tw(n){return new kR(n)}class DR extends Ew{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Ds(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new _t((i,o)=>je(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=uy(this.cr.serializer,o);s=s.add(i.path.popLast());const c=Cd(l);r+=c-a.size,t.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=uy(this.cr.serializer,o.convertToNoDocument(ke.min()));t.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),z.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Ey(n){return gn(n,"remoteDocumentGlobal")}function Zi(n){return gn(n,"remoteDocumentsV14")}function Dl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ty(n,e){const t=e.documentKey.path.toArray();return[n,Pd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function xy(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=je(t[i],r[i]),s)return s;return s=je(t.length,r.length),s||(s=je(t[t.length-2],r[r.length-2]),s||je(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&ru(r.mutation,s,sr.empty(),Gt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ke()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ke()){const s=Hr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Ul();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Hr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ke()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=ir();const o=nu(),a=function(){return nu()}();return t.forEach((l,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof Vs)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),ru(d.mutation,c,d.mutation.getFieldMask(),Gt.now())):o.set(c.key,sr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var f;return a.set(c,new VR(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=nu();let s=new St((o,a)=>o-a),i=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let d=r.get(l)||sr.empty();d=a.applyToLocalView(c,d),r.set(l,d);const f=(s.get(a.batchId)||Ke()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,f=jb();d.forEach(g=>{if(!i.has(g)){const y=Wb(t.get(g),r.get(g));y!==null&&f.set(g,y),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return Ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Jp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):z.resolve(Hr());let a=-1,l=i;return o.next(c=>z.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?z.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ke())).next(d=>({batchId:a,changes:Ub(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ie(t)).next(r=>{let s=Ul();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Ul();return this.indexManager.getCollectionParents(e,i).next(a=>z.forEach(a,l=>{const c=function(f,g){return new ks(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Ot.newInvalidDocument(d)))});let a=Ul();return o.forEach((l,c)=>{const d=i.get(l);d!==void 0&&ru(d.mutation,c,sr.empty(),Gt.now()),zu(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return z.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:en(s.createTime)}}(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:im(s.bundledQuery),readTime:en(s.readTime)}}(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(){this.overlays=new St(Ie.comparator),this.Ir=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Hr();return z.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),z.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const s=Hr(),i=t.length+1,o=new Ie(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new St((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=Hr(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Hr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return z.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new nm(t,r));let i=this.Ir.get(t);i===void 0&&(i=Ke(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(){this.Tr=new _t(yn.Er),this.dr=new _t(yn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new yn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new yn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Ie(new tt([])),r=new yn(t,e),s=new yn(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Ie(new tt([])),r=new yn(t,e),s=new yn(t,e+1);let i=Ke();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new yn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class yn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Ie.comparator(e.key,t.key)||je(e.wr,t.wr)}static Ar(e,t){return je(e.wr,t.wr)||Ie.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new _t(yn.Er)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new em(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new yn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,t){return z.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new yn(t,0),s=new yn(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new _t(je);return t.forEach(s=>{const i=new yn(s,0),o=new yn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Ie.isDocumentKey(i)||(i=i.child(""));const o=new yn(new Ie(i),0);let a=new _t(je);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.wr)),!0)},o),z.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Se(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return z.forEach(t.mutations,s=>{const i=new yn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new yn(t,0),s=this.br.firstAfterOrEqual(r);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e){this.Mr=e,this.docs=function(){return new St(Ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():Ot.newInvalidDocument(t))}getEntries(e,t){let r=ir();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ot.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=ir();const o=t.path,a=new Ie(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Kp(db(d),r)<=0||(s.has(d.key)||zu(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Ae()}Or(e,t){return z.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new $R(this)}getSize(e){return z.resolve(this.size)}}class $R extends Ew{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),z.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e){this.persistence=e,this.Nr=new Ds(t=>bo(t),Bu),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.Lr=0,this.Br=new lm,this.targetCount=0,this.kr=xo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),z.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new xo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.Kn(t),z.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),z.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,t){this.qr={},this.overlays={},this.Qr=new rr(0),this.Kr=!1,this.Kr=!0,this.$r=new MR,this.referenceDelegate=e(this),this.Ur=new UR(this),this.indexManager=new xR,this.remoteDocumentCache=function(s){return new FR(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new pw(t),this.Gr=new NR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new OR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new LR(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){se("MemoryPersistence","Starting transaction:",e);const s=new jR(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class jR extends fb{constructor(e){super(),this.currentSequenceNumber=e}}class fh{constructor(e){this.persistence=e,this.Jr=new lm,this.Yr=null}static Zr(e){return new fh(e)}get Xr(){if(this.Yr)return this.Yr;throw Ae()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),z.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Xr,r=>{const s=Ie.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,ke.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return z.or([()=>z.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class kd{constructor(e,t){this.persistence=e,this.ti=new Ds(r=>jn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=Iw(this,t)}static Zr(e,t){return new kd(e,t)}zr(){}jr(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return z.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?z.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,ke.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),z.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ed(e.data.value)),t}nr(e,t,r){return z.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ti.get(t);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e){this.serializer=e}O(e,t,r,s){const i=new sh("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$v,{unique:!0}),l.createObjectStore("documentMutations")}(e),Ay(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=z.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),Ay(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ke.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$v,{unique:!0});const f=c.store("mutations"),g=d.map(y=>f.put(y));return z.waitFor(g)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:A1});c.createIndex("collectionPathOverlayIndex",S1,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",P1,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:m1});c.createIndex("documentKeyIndex",g1),c.createIndex("collectionGroupIndex",v1)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:I1}).createIndex("sequenceNumberIndex",E1,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:T1}).createIndex("documentKeyIndex",x1,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Cd(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>z.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>z.forEach(a,l=>{Se(l.userId===i.userId);const c=oo(this.serializer,l);return yw(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new tt(o),c=function(f){return[0,jn(f)]}(l);i.push(t.get(c).next(d=>d?z.resolve():(f=>t.put({targetId:0,path:jn(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>z.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:w1});const r=t.store("collectionParents"),s=new am,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:jn(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new tt(o);return i(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Kr(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Bl(s),o=mw(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),l=function(f){return f.document?new Ie(tt.fromString(f.document.name).popFirst(5)):f.noDocument?Ie.fromSegments(f.noDocument.path):f.unknownDocument?Ie.fromSegments(f.unknownDocument.path):Ae()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>z.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=Tw(this.serializer),i=new um(fh.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:Ke();oo(this.serializer,l).keys().forEach(f=>d=d.add(f)),a.set(l.userId,d)}),z.forEach(a,(l,c)=>{const d=new _n(c),f=dh.lt(this.serializer,d),g=i.getIndexManager(d),y=hh.lt(d,this.serializer,g,i.referenceDelegate);return new xw(s,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new Hf(t,rr.oe),l).next()})})}}function Ay(n){n.createObjectStore("targetDocuments",{keyPath:_1}).createIndex("documentTargetsIndex",b1,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",y1,{unique:!0}),n.createObjectStore("targetGlobal")}const mf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class cm{constructor(e,t,r,s,i,o,a,l,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!cm.D())throw new ie(K.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new CR(this,s),this.Ai=t+"main",this.serializer=new pw(l),this.Ri=new Qr(this.Ai,this.hi,new BR(this.serializer)),this.$r=new _R,this.Ur=new SR(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Tw(this.serializer),this.Gr=new yR,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Xt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(K.FAILED_PRECONDITION,mf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new rr(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$c(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(ki(e))return se("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return se("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Vl(e).get("owner").next(t=>z.resolve(this.vi(t)))}Ci(e){return $c(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=gn(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return z.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?z.resolve(!0):Vl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ie(K.FAILED_PRECONDITION,mf);return!1}}return!(!this.networkEnabled||!this.inForeground)||$c(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&se("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Hf(e,rr.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>$c(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return hh.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new AR(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return dh.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){se("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===17?k1:l===16?C1:l===15?Wp:l===14?_b:l===13?yb:l===12?R1:l===11?vb:void Ae()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new Hf(a,this.Qr?this.Qr.next():rr.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Xt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ie(K.FAILED_PRECONDITION,hb);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Vl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ie(K.FAILED_PRECONDITION,mf)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vl(e).put("owner",t)}static D(){return Qr.D()}bi(e){const t=Vl(e);return t.get("owner").next(r=>this.vi(r)?(se("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):z.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Xt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;K0()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return se("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Xt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Xt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vl(n){return gn(n,"owner")}function $c(n){return gn(n,"clientMetadata")}function dm(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Ke(),s=Ke();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hm(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return K0()?8:pb(mn())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new qR;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(oa()<=et.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",aa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),z.resolve()):(oa()<=et.DEBUG&&se("QueryEngine","Query:",aa(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(oa()<=et.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",aa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bn(t))):z.resolve())}Yi(e,t){if(Xv(t))return z.resolve(null);let r=Bn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Ad(t,null,"F"),r=Bn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ke(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,o,l.readTime)?this.Yi(e,Ad(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,s){return Xv(t)||s.isEqual(ke.min())?z.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?z.resolve(null):(oa()<=et.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),aa(t)),this.rs(e,o,t,cb(s,-1)).next(a=>a))})}ts(e,t){let r=new _t(Fb(e));return t.forEach((s,i)=>{zu(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return oa()<=et.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",aa(t)),this.Ji.getDocumentsMatchingQuery(e,t,hr.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new St(je),this._s=new Ds(i=>bo(i),Bu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xw(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function Sw(n,e,t,r){return new zR(n,e,t,r)}async function Pw(n,e){const t=be(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ke();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function GR(n,e){const t=be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const f=c.batch,g=f.keys();let y=z.resolve();return g.forEach(x=>{y=y.next(()=>d.getEntry(l,x)).next(S=>{const P=c.docVersions.get(x);Se(P!==null),S.version.compareTo(P)<0&&(f.applyToRemoteDocument(S,c),S.isValidDocument()&&(S.setReadTime(c.commitVersion),d.addEntry(S)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ke();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function Rw(n){const e=be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function KR(n,e){const t=be(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let y=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Wt.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),s=s.insert(f,y),function(S,P,j){return S.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=3e8?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(g,y,d)&&a.push(t.Ur.updateTargetData(i,y))});let l=ir(),c=Ke();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(Cw(i,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(ke.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return z.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.os=s,i))}function Cw(n,e,t){let r=Ke(),s=Ke();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=ir();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ke.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):se("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function HR(n,e){const t=be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ma(n,e){const t=be(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new ps(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function La(n,e,t){const r=be(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ki(o))throw o;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Dd(n,e,t){const r=be(n);let s=ke.min(),i=Ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const f=be(l),g=f._s.get(d);return g!==void 0?z.resolve(f.os.get(g)):f.Ur.getTargetData(c,d)}(r,o,Bn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:ke.min(),t?i:Ke())).next(a=>(Vw(r,Lb(e),a),{documents:a,Ts:i})))}function kw(n,e){const t=be(n),r=be(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function Dw(n,e){const t=be(n),r=t.us.get(e)||ke.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,cb(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(Vw(t,e,s),s))}function Vw(n,e,t){let r=n.us.get(e)||ke.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function WR(n,e,t,r){const s=be(n);let i=Ke(),o=ir();for(const c of t){const d=e.Es(c.metadata.name);c.document&&(i=i.add(d));const f=e.ds(c);f.setReadTime(e.As(c.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),l=await Ma(s,function(d){return Bn(Ja(tt.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>Cw(c,a,o).next(d=>(a.apply(c),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(c,l.targetId).next(()=>s.Ur.addMatchingKeys(c,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,d.Ps,d.Is)).next(()=>d.Ps)))}async function QR(n,e,t=Ke()){const r=await Ma(n,Bn(im(e.bundledQuery))),s=be(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=en(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(Wt.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function Sy(n,e){return`firestore_clients_${n}_${e}`}function Py(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function gf(n,e){return`firestore_targets_${n}_${e}`}class Vd{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new ie(s.error.code,s.error.message))),o?new Vd(e,t,s.state,i):(Xt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class su{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new ie(r.error.code,r.error.message))),i?new su(e,r.state,s):(Xt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Nd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Yp();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=mb(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Nd(e,i):(Xt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class fm{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new fm(t.clientId,t.onlineState):(Xt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ap{constructor(){this.activeTargetIds=Yp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vf{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new St(je),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=Sy(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ap),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(Sy(this.persistenceKey,r));if(s){const i=Nd.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(gf(this.persistenceKey,e));if(s){const i=su.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(gf(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return se("SharedClientState","READ",e,t),t}setItem(e,t){se("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){se("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(se("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Xt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=rr.oe;if(i!=null)try{const a=JSON.parse(i);Se(typeof a=="number"),o=a}catch(a){Xt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==rr.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new Vd(this.currentUser,e,t,r),i=Py(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=Py(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=gf(this.persistenceKey,e),i=new su(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Nd.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Vd.Rs(new _n(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return su.Rs(s,t)}Ls(e){return fm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);se("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Yp();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class Nw{constructor(){this.so=new ap,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ap,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc=null;function yf(){return Uc===null?Uc=function(){return 268435456+Math.round(2147483648*Math.random())}():Uc++,"0x"+Uc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nn="WebChannelConnection";class ZR extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=yf(),l=this.xo(t,r.toUriEncodedString());se("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,l,c,s).then(d=>(se("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Er("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Qa}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=YR[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=yf();return new Promise((o,a)=>{const l=new tb;l.setWithCredentials(!0),l.listenOnce(nb.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Yc.NO_ERROR:const d=l.getResponseJson();se(Nn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Yc.TIMEOUT:se(Nn,`RPC '${e}' ${i} timed out`),a(new ie(K.DEADLINE_EXCEEDED,"Request time out"));break;case Yc.HTTP_ERROR:const f=l.getStatus();if(se(Nn,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g==null?void 0:g.error;if(y&&y.status&&y.message){const x=function(P){const j=P.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(j)>=0?j:K.UNKNOWN}(y.status);a(new ie(x,y.message))}else a(new ie(K.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ie(K.UNAVAILABLE,"Connection failed."));break;default:Ae()}}finally{se(Nn,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);se(Nn,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=yf(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ib(),a=sb(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");se(Nn,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let g=!1,y=!1;const x=new XR({Io:P=>{y?se(Nn,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(se(Nn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),se(Nn,`RPC '${e}' stream ${s} sending:`,P),f.send(P))},To:()=>f.close()}),S=(P,j,U)=>{P.listen(j,D=>{try{U(D)}catch(G){setTimeout(()=>{throw G},0)}})};return S(f,$l.EventType.OPEN,()=>{y||(se(Nn,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),S(f,$l.EventType.CLOSE,()=>{y||(y=!0,se(Nn,`RPC '${e}' stream ${s} transport closed`),x.So())}),S(f,$l.EventType.ERROR,P=>{y||(y=!0,Er(Nn,`RPC '${e}' stream ${s} transport errored:`,P),x.So(new ie(K.UNAVAILABLE,"The operation could not be completed")))}),S(f,$l.EventType.MESSAGE,P=>{var j;if(!y){const U=P.data[0];Se(!!U);const D=U,G=D.error||((j=D[0])===null||j===void 0?void 0:j.error);if(G){se(Nn,`RPC '${e}' stream ${s} received error:`,G);const Z=G.status;let me=function(I){const C=un[I];if(C!==void 0)return Xb(C)}(Z),T=G.message;me===void 0&&(me=K.INTERNAL,T="Unknown error status: "+Z+" with message "+G.message),y=!0,x.So(new ie(me,T)),f.close()}else se(Nn,`RPC '${e}' stream ${s} received:`,U),x.bo(U)}}),S(a,rb.STAT_EVENT,P=>{P.stat===Gf.PROXY?se(Nn,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Gf.NOPROXY&&se(Nn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(){return typeof window<"u"?window:null}function sd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(n){return new aR(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new pm(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===K.RESOURCE_EXHAUSTED?(Xt(t.toString()),Xt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new ie(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eC extends Mw{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=cR(this.serializer,e),r=function(i){if(!("targetChange"in i))return ke.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ke.min():o.readTime?en(o.readTime):ke.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=np(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Td(l)?{documents:lw(i,l)}:{query:ch(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=nw(i,o.resumeToken);const c=ep(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ke.min())>0){a.readTime=Oa(i,o.snapshotVersion.toTimestamp());const c=ep(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=hR(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=np(this.serializer),t.removeTarget=e,this.a_(t)}}class tC extends Mw{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Se(!!e.streamToken),this.lastStreamToken=e.streamToken,Se(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=dR(e.writeResults,e.commitTime),r=en(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=np(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Eu(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ie(K.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,tp(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ie(K.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,tp(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(K.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Xt(t),this.D_=!1):se("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Vi(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=be(l);c.L_.add(4),await Za(c),c.q_.set("Unknown"),c.L_.delete(4),await Qu(c)}(this))})}),this.q_=new rC(r,s)}}async function Qu(n){if(Vi(n))for(const e of n.B_)await e(!0)}async function Za(n){for(const e of n.B_)await e(!1)}function ph(n,e){const t=be(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),vm(t)?gm(t):tl(t).r_()&&mm(t,e))}function Fa(n,e){const t=be(n),r=tl(t);t.N_.delete(e),r.r_()&&Lw(t,e),t.N_.size===0&&(r.r_()?r.o_():Vi(t)&&t.q_.set("Unknown"))}function mm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tl(n).A_(e)}function Lw(n,e){n.Q_.xe(e),tl(n).R_(e)}function gm(n){n.Q_=new rR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),tl(n).start(),n.q_.v_()}function vm(n){return Vi(n)&&!tl(n).n_()&&n.N_.size>0}function Vi(n){return be(n).L_.size===0}function Fw(n){n.Q_=void 0}async function iC(n){n.q_.set("Online")}async function oC(n){n.N_.forEach((e,t)=>{mm(n,e)})}async function aC(n,e){Fw(n),vm(n)?(n.q_.M_(e),gm(n)):n.q_.set("Unknown")}async function lC(n,e,t){if(n.q_.set("Online"),e instanceof tw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Od(n,r)}else if(e instanceof rd?n.Q_.Ke(e):e instanceof ew?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ke.min()))try{const r=await Rw(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(c);d&&i.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(Wt.EMPTY_BYTE_STRING,d.snapshotVersion)),Lw(i,l);const f=new ps(d.target,l,c,d.sequenceNumber);mm(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){se("RemoteStore","Failed to raise snapshot:",r),await Od(n,r)}}async function Od(n,e,t){if(!ki(e))throw e;n.L_.add(1),await Za(n),n.q_.set("Offline"),t||(t=()=>Rw(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Qu(n)})}function $w(n,e){return e().catch(t=>Od(n,t,e))}async function el(n){const e=be(n),t=xi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uC(e);)try{const s=await HR(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,cC(e,s)}catch(s){await Od(e,s)}Uw(e)&&jw(e)}function uC(n){return Vi(n)&&n.O_.length<10}function cC(n,e){n.O_.push(e);const t=xi(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Uw(n){return Vi(n)&&!xi(n).n_()&&n.O_.length>0}function jw(n){xi(n).start()}async function dC(n){xi(n).p_()}async function hC(n){const e=xi(n);for(const t of n.O_)e.m_(t.mutations)}async function fC(n,e,t){const r=n.O_.shift(),s=tm.from(r,e,t);await $w(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await el(n)}async function pC(n,e){e&&xi(n).V_&&await async function(r,s){if(function(o){return Yb(o)&&o!==K.ABORTED}(s.code)){const i=r.O_.shift();xi(r).s_(),await $w(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await el(r)}}(n,e),Uw(n)&&jw(n)}async function Cy(n,e){const t=be(n);t.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const r=Vi(t);t.L_.add(3),await Za(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Qu(t)}async function lp(n,e){const t=be(n);e?(t.L_.delete(2),await Qu(t)):e||(t.L_.add(2),await Za(t),t.q_.set("Unknown"))}function tl(n){return n.K_||(n.K_=function(t,r,s){const i=be(t);return i.w_(),new eC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:iC.bind(null,n),Ro:oC.bind(null,n),mo:aC.bind(null,n),d_:lC.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),vm(n)?gm(n):n.q_.set("Unknown")):(await n.K_.stop(),Fw(n))})),n.K_}function xi(n){return n.U_||(n.U_=function(t,r,s){const i=be(t);return i.w_(),new tC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dC.bind(null,n),mo:pC.bind(null,n),f_:hC.bind(null,n),g_:fC.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await el(n)):(await n.U_.stop(),n.O_.length>0&&(se("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new bn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new ym(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nl(n,e){if(Xt("AsyncQueue",`${e}: ${n}`),ki(n))return new ie(K.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ie.comparator(t.key,r.key):(t,r)=>Ie.comparator(t.key,r.key),this.keyedMap=Ul(),this.sortedSet=new St(this.comparator)}static emptySet(e){return new va(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof va)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new va;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(){this.W_=new St(Ie.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ae():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class $a{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new $a(e,t,va.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class gC{constructor(){this.queries=Dy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=be(t),i=s.queries;s.queries=Dy(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new ie(K.ABORTED,"Firestore shutting down"))}}function Dy(){return new Ds(n=>Mb(n),qu)}async function _m(n,e){const t=be(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new mC,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=nl(o,`Initialization of query '${aa(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&wm(t)}async function bm(n,e){const t=be(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function vC(n,e){const t=be(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&wm(t)}function yC(n,e,t){const r=be(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function wm(n){n.Y_.forEach(e=>{e.next()})}var up,Vy;(Vy=up||(up={})).ea="default",Vy.Cache="cache";class Im{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==up.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e){this.serializer=e}Es(e){return Jr(this.serializer,e)}ds(e){return e.metadata.exists?aw(this.serializer,e.document,!1):Ot.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return en(e)}}class bC{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Bw(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=tt.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new Ny(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||Ke()).add(i);t.set(o,a)}}return t}async complete(){const e=await WR(this.localStore,new Ny(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await QR(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function Bw(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e){this.key=e}}class zw{constructor(e){this.key=e}}class Gw{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ke(),this.mutatedKeys=Ke(),this.Aa=Fb(e),this.Ra=new va(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new ky,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),y=zu(this.query,f)?f:null,x=!!g&&this.mutatedKeys.has(g.key),S=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let P=!1;g&&y?g.data.isEqual(y.data)?x!==S&&(r.track({type:3,doc:y}),P=!0):this.ga(g,y)||(r.track({type:2,doc:y}),P=!0,(l&&this.Aa(y,l)>0||c&&this.Aa(y,c)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),P=!0):g&&!y&&(r.track({type:1,doc:g}),P=!0,(l||c)&&(a=!0)),P&&(y?(o=o.add(y),i=S?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(y,x){const S=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae()}};return S(y)-S(x)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new $a(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ky,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ke(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new zw(r))}),this.da.forEach(r=>{e.has(r)||t.push(new qw(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ke();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return $a.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wC{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class IC{constructor(e){this.key=e,this.va=!1}}class EC{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ds(a=>Mb(a),qu),this.Ma=new Map,this.xa=new Set,this.Oa=new St(Ie.comparator),this.Na=new Map,this.La=new lm,this.Ba={},this.ka=new Map,this.qa=xo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TC(n,e,t=!0){const r=mh(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Kw(r,e,t,!0),s}async function xC(n,e){const t=mh(n);await Kw(t,e,!0,!1)}async function Kw(n,e,t,r){const s=await Ma(n.localStore,Bn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Em(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&ph(n.remoteStore,s),a}async function Em(n,e,t,r,s){n.Ka=(f,g,y)=>async function(S,P,j,U){let D=P.view.ma(j);D.ns&&(D=await Dd(S.localStore,P.query,!1).then(({documents:T})=>P.view.ma(T,D)));const G=U&&U.targetChanges.get(P.targetId),Z=U&&U.targetMismatches.get(P.targetId)!=null,me=P.view.applyChanges(D,S.isPrimaryClient,G,Z);return cp(S,P.targetId,me.wa),me.snapshot}(n,f,g,y);const i=await Dd(n.localStore,e,!0),o=new Gw(e,i.Ts),a=o.ma(i.documents),l=Hu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);cp(n,t,c.wa);const d=new wC(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function AC(n,e,t){const r=be(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!qu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await La(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Fa(r.remoteStore,s.targetId),Ua(r,s.targetId)}).catch(Ci)):(Ua(r,s.targetId),await La(r.localStore,s.targetId,!0))}async function SC(n,e){const t=be(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Fa(t.remoteStore,r.targetId))}async function PC(n,e,t){const r=Sm(n);try{const s=await function(o,a){const l=be(o),c=Gt.now(),d=a.reduce((y,x)=>y.add(x.key),Ke());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let x=ir(),S=Ke();return l.cs.getEntries(y,d).next(P=>{x=P,x.forEach((j,U)=>{U.isValidDocument()||(S=S.add(j))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,x)).next(P=>{f=P;const j=[];for(const U of a){const D=eR(U,f.get(U.key).overlayedDocument);D!=null&&j.push(new Vs(U.key,D,xb(D.value.mapValue),jt.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,j,a)}).next(P=>{g=P;const j=P.applyToLocalDocumentSet(f,S);return l.documentOverlayCache.saveOverlays(y,P.batchId,j)})}).then(()=>({batchId:g.batchId,changes:Ub(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new St(je)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await Ns(r,s.changes),await el(r.remoteStore)}catch(s){const i=nl(s,"Failed to persist write");t.reject(i)}}async function Hw(n,e){const t=be(n);try{const r=await KR(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(Se(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Se(o.va):s.removedDocuments.size>0&&(Se(o.va),o.va=!1))}),await Ns(t,r,e)}catch(r){await Ci(r)}}function Oy(n,e,t){const r=be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=be(o);l.onlineState=a;let c=!1;l.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(a)&&(c=!0)}),c&&wm(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RC(n,e,t){const r=be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new St(Ie.comparator);o=o.insert(i,Ot.newNoDocument(i,ke.min()));const a=Ke().add(i),l=new Ku(ke.min(),new Map,new St(je),o,a);await Hw(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Am(r)}else await La(r.localStore,e,!1).then(()=>Ua(r,e,t)).catch(Ci)}async function CC(n,e){const t=be(n),r=e.batch.batchId;try{const s=await GR(t.localStore,e);xm(t,r,null),Tm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ns(t,s)}catch(s){await Ci(s)}}async function kC(n,e,t){const r=be(n);try{const s=await function(o,a){const l=be(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Se(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);xm(r,e,t),Tm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ns(r,s)}catch(s){await Ci(s)}}async function DC(n,e){const t=be(n);Vi(t.remoteStore)||se("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=be(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=nl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Tm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function xm(n,e,t){const r=be(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ua(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Ww(n,r)})}function Ww(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Fa(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Am(n))}function cp(n,e,t){for(const r of t)r instanceof qw?(n.La.addReference(r.key,e),VC(n,r)):r instanceof zw?(se("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Ww(n,r.key)):Ae()}function VC(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(se("SyncEngine","New document in limbo: "+t),n.xa.add(r),Am(n))}function Am(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Ie(tt.fromString(e)),r=n.qa.next();n.Na.set(r,new IC(t)),n.Oa=n.Oa.insert(t,r),ph(n.remoteStore,new ps(Bn(Ja(t.path)),r,"TargetPurposeLimboResolution",rr.oe))}}async function Ns(n,e,t){const r=be(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=hm.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,c){const d=be(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>z.forEach(c,g=>z.forEach(g.$i,y=>d.persistence.referenceDelegate.addReference(f,g.targetId,y)).next(()=>z.forEach(g.Ui,y=>d.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))}catch(f){if(!ki(f))throw f;se("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const g=f.targetId;if(!f.fromCache){const y=d.os.get(g),x=y.snapshotVersion,S=y.withLastLimboFreeSnapshotVersion(x);d.os=d.os.insert(g,S)}}}(r.localStore,i))}async function NC(n,e){const t=be(n);if(!t.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const r=await Pw(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new ie(K.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ns(t,r.hs)}}function OC(n,e){const t=be(n),r=t.Na.get(e);if(r&&r.va)return Ke().add(r.key);{let s=Ke();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function MC(n,e){const t=be(n),r=await Dd(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&cp(t,e.targetId,s.wa),s}async function LC(n,e){const t=be(n);return Dw(t.localStore,e).then(r=>Ns(t,r))}async function FC(n,e,t,r){const s=be(n),i=await function(a,l){const c=be(a),d=be(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,l).next(g=>g?c.localDocuments.getDocuments(f,g):z.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await el(s.remoteStore):t==="acknowledged"||t==="rejected"?(xm(s,e,r||null),Tm(s,e),function(a,l){be(be(a).mutationQueue).On(l)}(s.localStore,e)):Ae(),await Ns(s,i)):se("SyncEngine","Cannot apply mutation batch with id: "+e)}async function $C(n,e){const t=be(n);if(mh(t),Sm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await My(t,r.toArray());t.Qa=!0,await lp(t.remoteStore,!0);for(const i of s)ph(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Ua(t,o),La(t.localStore,o,!0))),Fa(t.remoteStore,o)}),await s,await My(t,r),function(o){const a=be(o);a.Na.forEach((l,c)=>{Fa(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new St(Ie.comparator)}(t),t.Qa=!1,await lp(t.remoteStore,!1)}}async function My(n,e,t){const r=be(n),s=[],i=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await Ma(r.localStore,Bn(l[0]));for(const c of l){const d=r.Fa.get(c),f=await MC(r,d);f.snapshot&&i.push(f.snapshot)}}else{const c=await kw(r.localStore,o);a=await Ma(r.localStore,c),await Em(r,Qw(c),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function Qw(n){return Vb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function UC(n){return function(t){return be(be(t).persistence).Qi()}(be(n).localStore)}async function jC(n,e,t,r){const s=be(n);if(s.Qa)return void se("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await Dw(s.localStore,Lb(i[0])),a=Ku.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Wt.EMPTY_BYTE_STRING);await Ns(s,o,a);break}case"rejected":await La(s.localStore,e,!0),Ua(s,e,r);break;default:Ae()}}async function BC(n,e,t){const r=mh(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){se("SyncEngine","Adding an already active target "+s);continue}const i=await kw(r.localStore,s),o=await Ma(r.localStore,i);await Em(r,Qw(i),o.targetId,!1,o.resumeToken),ph(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await La(r.localStore,s,!1).then(()=>{Fa(r.remoteStore,s),Ua(r,s)}).catch(Ci)}}function mh(n){const e=be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RC.bind(null,e),e.Ca.d_=vC.bind(null,e.eventManager),e.Ca.$a=yC.bind(null,e.eventManager),e}function Sm(n){const e=be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kC.bind(null,e),e}function qC(n,e,t){const r=be(n);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(y,x){const S=be(y),P=en(x.createTime);return S.persistence.runTransaction("hasNewerBundle","readonly",j=>S.Gr.getBundleMetadata(j,x.id)).then(j=>!!j&&j.createTime.compareTo(P)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(Bw(l));const c=new bC(l,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await c.la(d);g&&a._updateProgress(g),d=await o.Ua()}const f=await c.complete();return await Ns(i,f.Ia,void 0),await function(y,x){const S=be(y);return S.persistence.runTransaction("Save bundle","readwrite",P=>S.Gr.saveBundleMetadata(P,x))}(i.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(l){return Er("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Ai{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Sw(this.persistence,new Aw,e.initialUser,this.serializer)}Ga(e){return new um(fh.Zr,this.serializer)}Wa(e){return new Nw}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ai.provider={build:()=>new Ai};class zC extends Ai{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){Se(this.persistence.referenceDelegate instanceof kd);const r=this.persistence.referenceDelegate.garbageCollector;return new ww(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?Mn.withCacheSize(this.cacheSizeBytes):Mn.DEFAULT;return new um(r=>kd.Zr(r,t),this.serializer)}}class Pm extends Ai{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Sm(this.Ja.syncEngine),await el(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return Sw(this.persistence,new Aw,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new ww(r,e.asyncQueue,t)}Ha(e,t){const r=new h1(t,this.persistence);return new d1(e.asyncQueue,r)}Ga(e){const t=dm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Mn.withCacheSize(this.cacheSizeBytes):Mn.DEFAULT;return new cm(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Ow(),sd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Nw}}class Jw extends Pm{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof vf&&(this.sharedClientState.syncEngine={no:FC.bind(null,t),ro:jC.bind(null,t),io:BC.bind(null,t),Qi:UC.bind(null,t),eo:LC.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await $C(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=Ow();if(!vf.D(t))throw new ie(K.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=dm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new vf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Si{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Oy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=NC.bind(null,this.syncEngine),await lp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new gC}()}createDatastore(e){const t=Wu(e.databaseInfo.databaseId),r=function(i){return new ZR(i)}(e.databaseInfo);return function(i,o,a,l){return new nC(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new sC(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Oy(this.syncEngine,t,0),function(){return Ry.D()?new Ry:new JR}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,d){const f=new EC(s,i,o,a,l,c);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=be(s);se("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Za(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Si.provider={build:()=>new Si};function Ly(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Xt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new bn,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new _C(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ie(K.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=be(s),a={documents:i.map(f=>Iu(o.serializer,f))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,tt.emptyPath(),a,i.length),c=new Map;l.forEach(f=>{const g=uR(o.serializer,f);c.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=c.get(f.toString());Se(!!g),d.push(g)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xa(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=Ie.fromPath(r);this.mutations.push(new Zp(s,this.precondition(s)))}),await async function(r,s){const i=be(r),o={writes:s.map(a=>Eu(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,tt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae();t=ke.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ie(K.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ke.min())?jt.exists(!1):jt.updateTime(t):jt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ke.min()))throw new ie(K.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return jt.updateTime(t)}return jt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new pm(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new KC(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!ju(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Yb(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=_n.UNAUTHENTICATED,this.clientId=lb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{se("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(se("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=nl(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function _f(n,e){n.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Pw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Fy(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Rm(n);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Cy(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Cy(e.remoteStore,s)),n._onlineComponents=e}async function Rm(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await _f(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===K.FAILED_PRECONDITION||s.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Er("Error using user provided cache. Falling back to memory cache: "+t),await _f(n,new Ai)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await _f(n,new Ai);return n._offlineComponents}async function vh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await Fy(n,n._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await Fy(n,new Si))),n._onlineComponents}function Yw(n){return Rm(n).then(e=>e.persistence)}function rl(n){return Rm(n).then(e=>e.localStore)}function Xw(n){return vh(n).then(e=>e.remoteStore)}function Cm(n){return vh(n).then(e=>e.syncEngine)}function Zw(n){return vh(n).then(e=>e.datastore)}async function ja(n){const e=await vh(n),t=e.eventManager;return t.onListen=TC.bind(null,e.syncEngine),t.onUnlisten=AC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=SC.bind(null,e.syncEngine),t}function QC(n){return n.asyncQueue.enqueue(async()=>{const e=await Yw(n),t=await Xw(n);return e.setNetworkEnabled(!0),function(s){const i=be(s);return i.L_.delete(0),Qu(i)}(t)})}function JC(n){return n.asyncQueue.enqueue(async()=>{const e=await Yw(n),t=await Xw(n);return e.setNetworkEnabled(!1),async function(s){const i=be(s);i.L_.add(0),await Za(i),i.q_.set("Offline")}(t)})}function YC(n,e){const t=new bn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,d){const f=be(c);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new ie(K.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=nl(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await rl(n),e,t)),t.promise}function eI(n,e,t={}){const r=new bn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new gh({next:g=>{d.Za(),o.enqueueAndForget(()=>bm(i,f));const y=g.docs.has(a);!y&&g.fromCache?c.reject(new ie(K.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&l&&l.source==="server"?c.reject(new ie(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Im(Ja(a.path),d,{includeMetadataChanges:!0,_a:!0});return _m(i,f)}(await ja(n),n.asyncQueue,e,t,r)),r.promise}function XC(n,e){const t=new bn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await Dd(s,i,!0),l=new Gw(i,a.Ts),c=l.ma(a.documents),d=l.applyChanges(c,!1);o.resolve(d.snapshot)}catch(a){const l=nl(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await rl(n),e,t)),t.promise}function tI(n,e,t={}){const r=new bn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new gh({next:g=>{d.Za(),o.enqueueAndForget(()=>bm(i,f)),g.fromCache&&l.source==="server"?c.reject(new ie(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Im(a,d,{includeMetadataChanges:!0,_a:!0});return _m(i,f)}(await ja(n),n.asyncQueue,e,t,r)),r.promise}function ZC(n,e,t){const r=new bn;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await Zw(n);r.resolve(async function(o,a,l){var c;const d=be(o),{request:f,ut:g,parent:y}=uw(d.serializer,Nb(a),l);d.connection.Fo||delete f.parent;const x=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,y,f,1)).filter(P=>!!P.result);Se(x.length===1);const S=(c=x[0].result)===null||c===void 0?void 0:c.aggregateFields;return Object.keys(S).reduce((P,j)=>(P[g[j]]=S[j],P),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function ek(n,e){const t=new gh(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){be(s).Y_.add(i),i.next()}(await ja(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){be(s).Y_.delete(i)}(await ja(n),t))}}function tk(n,e,t,r){const s=function(o,a){let l;return l=typeof o=="string"?Zb().encode(o):o,function(d,f){return new GC(d,f)}(function(d,f){if(d instanceof Uint8Array)return Ly(d,f);if(d instanceof ArrayBuffer)return Ly(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,Wu(e));n.asyncQueue.enqueueAndForget(async()=>{qC(await Cm(n),s,r)})}function nk(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=be(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await rl(n),e))}function rk(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=be(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(c=>function(f,g,y,x,S){f=[...f],g=[...g],f.sort(y),g.sort(y);const P=f.length,j=g.length;let U=0,D=0;for(;U<j&&D<P;){const G=y(f[D],g[U]);G<0?S(f[D++]):G>0?x(g[U++]):(U++,D++)}for(;U<j;)x(g[U++]);for(;D<P;)S(f[D++])}(c,s,a1,d=>{a.push(o.addFieldIndex(l,d))},d=>{a.push(o.deleteFieldIndex(l,d))})).next(()=>z.waitFor(a)))}(await rl(n),e))}function sk(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){be(r).ss.zi=s}(await rl(n),e))}function ik(n){return n.asyncQueue.enqueue(async()=>function(t){const r=be(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await rl(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(n,e,t){if(!t)throw new ie(K.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ok(n,e,t,r){if(e===!0&&r===!0)throw new ie(K.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Uy(n){if(!Ie.isDocumentKey(n))throw new ie(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function jy(n){if(Ie.isDocumentKey(n))throw new ie(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function yh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae()}function Ye(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ie(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=yh(n);throw new ie(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function rI(n,e){if(e<=0)throw new ie(K.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ie(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ie(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ok("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ie(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ie(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ie(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ju{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new By({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new By(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ZP;switch(r.type){case"firstParty":return new r1(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=$y.get(t);r&&(se("ComponentProvider","Removing Datastore"),$y.delete(t),r.terminate())}(this),Promise.resolve()}}function ak(n,e,t,r={}){var s;const i=(n=Ye(n,Ju))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Er("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=_n.MOCK_USER;else{a=PS(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new ie(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new _n(c)}n._authCredentials=new e1(new ob(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Pn(this.firestore,e,this._query)}}class tn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tn(this.firestore,e,this._key)}}class Yr extends Pn{constructor(e,t,r){super(e,t,Ja(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tn(this.firestore,null,new Ie(e))}withConverter(e){return new Yr(this.firestore,e,this._path)}}function He(n,e,...t){if(n=De(n),km("collection","path",e),n instanceof Ju){const r=tt.fromString(e,...t);return jy(r),new Yr(n,null,r)}{if(!(n instanceof tn||n instanceof Yr))throw new ie(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(tt.fromString(e,...t));return jy(r),new Yr(n.firestore,null,r)}}function Q$(n,e){if(n=Ye(n,Ju),km("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ie(K.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Pn(n,null,function(r){return new ks(tt.emptyPath(),r)}(e))}function xe(n,e,...t){if(n=De(n),arguments.length===1&&(e=lb.newId()),km("doc","path",e),n instanceof Ju){const r=tt.fromString(e,...t);return Uy(r),new tn(n,null,new Ie(r))}{if(!(n instanceof tn||n instanceof Yr))throw new ie(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(tt.fromString(e,...t));return Uy(r),new tn(n.firestore,n instanceof Yr?n.converter:null,new Ie(r))}}function J$(n,e){return n=De(n),e=De(e),(n instanceof tn||n instanceof Yr)&&(e instanceof tn||e instanceof Yr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function sI(n,e){return n=De(n),e=De(e),n instanceof Pn&&e instanceof Pn&&n.firestore===e.firestore&&qu(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new pm(this,"async_queue_retry"),this.Vu=()=>{const r=sd();r&&se("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=sd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=sd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new bn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ki(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Xt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=ym.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function dp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class lk{constructor(){this._progressObserver={},this._taskCompletionResolver=new bn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$=-1;class It extends Ju{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new qy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qy(e),this._firestoreClient=void 0,await e}}}function X$(n,e,t){t||(t="(default)");const r=Uu(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(bi(i,e))return s;throw new ie(K.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ie(K.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ie(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function uk(n,e){const t=typeof n=="object"?n:Y0(),r=typeof n=="string"?n:e||"(default)",s=Uu(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=AS("firestore");i&&ak(s,...i)}return s}function Kt(n){if(n._terminated)throw new ie(K.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||iI(n),n._firestoreClient}function iI(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,d){return new V1(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,nI(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new WC(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function ck(n,e){Er("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return oI(n,Si.provider,{build:r=>new Pm(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function Z$(n){Er("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();oI(n,Si.provider,{build:t=>new Jw(t,e.cacheSizeBytes)})}function oI(n,e,t){if((n=Ye(n,It))._firestoreClient||n._terminated)throw new ie(K.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ie(K.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},iI(n)}function eU(n){if(n._initialized&&!n._terminated)throw new ie(K.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new bn;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Qr.D())return Promise.resolve();const s=r+"main";await Qr.delete(s)}(dm(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function tU(n){return function(t){const r=new bn;return t.asyncQueue.enqueueAndForget(async()=>DC(await Cm(t),r)),r.promise}(Kt(n=Ye(n,It)))}function nU(n){return QC(Kt(n=Ye(n,It)))}function rU(n){return JC(Kt(n=Ye(n,It)))}function sU(n){return $P(n.app,"firestore",n._databaseId.database),n._delete()}function iU(n,e){const t=Kt(n=Ye(n,It)),r=new lk;return tk(t,n._databaseId,e,r),r}function oU(n,e){return nk(Kt(n=Ye(n,It)),e).then(t=>t?new Pn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class dk{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ao(Wt.fromBase64String(e))}catch(t){throw new ie(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ao(Wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ie(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function aU(){return new Po("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ie(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ie(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk=/^__.*__$/;class fk{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Vs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ya(e,this.data,t,this.fieldTransforms)}}class aI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Vs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function lI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae()}}class bh{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new bh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Md(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(lI(this.Cu)&&hk.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class pk{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Wu(e)}Qu(e,t,r,s=!1){return new bh({Cu:e,methodName:t,qu:r,path:Ut.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Co(n){const e=n._freezeSettings(),t=Wu(n._databaseId);return new pk(n._databaseId,!!e.ignoreUndefinedProperties,t)}function wh(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);$m("Data must be an object, but it was:",o,r);const a=dI(r,o);let l,c;if(i.merge)l=new sr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=xu(e,f,t);if(!o.contains(g))throw new ie(K.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);fI(d,g)||d.push(g)}l=new sr(d),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new fk(new Sn(a),l,c)}class Yu extends Ro{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Yu}}function uI(n,e,t){return new bh({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Vm extends Ro{_toFieldTransform(e){return new Gu(e.path,new Va)}isEqual(e){return e instanceof Vm}}class Nm extends Ro{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=uI(this,e,!0),r=this.Ku.map(i=>ko(i,t)),s=new wo(r);return new Gu(e.path,s)}isEqual(e){return e instanceof Nm&&bi(this.Ku,e.Ku)}}class Om extends Ro{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=uI(this,e,!0),r=this.Ku.map(i=>ko(i,t)),s=new Io(r);return new Gu(e.path,s)}isEqual(e){return e instanceof Om&&bi(this.Ku,e.Ku)}}class Mm extends Ro{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Na(e.serializer,qb(e.serializer,this.$u));return new Gu(e.path,t)}isEqual(e){return e instanceof Mm&&this.$u===e.$u}}function Lm(n,e,t,r){const s=n.Qu(1,e,t);$m("Data must be an object, but it was:",s,r);const i=[],o=Sn.empty();Di(r,(l,c)=>{const d=Ih(e,l,t);c=De(c);const f=s.Nu(d);if(c instanceof Yu)i.push(d);else{const g=ko(c,f);g!=null&&(i.push(d),o.set(d,g))}});const a=new sr(i);return new aI(o,a,s.fieldTransforms)}function Fm(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[xu(e,r,t)],l=[s];if(i.length%2!=0)throw new ie(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(xu(e,i[g])),l.push(i[g+1]);const c=[],d=Sn.empty();for(let g=a.length-1;g>=0;--g)if(!fI(c,a[g])){const y=a[g];let x=l[g];x=De(x);const S=o.Nu(y);if(x instanceof Yu)c.push(y);else{const P=ko(x,S);P!=null&&(c.push(y),d.set(y,P))}}const f=new sr(c);return new aI(d,f,o.fieldTransforms)}function cI(n,e,t,r=!1){return ko(t,n.Qu(r?4:3,e))}function ko(n,e){if(hI(n=De(n)))return $m("Unsupported field value:",e,n),dI(n,e);if(n instanceof Ro)return function(r,s){if(!lI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=ko(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=De(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Gt.fromDate(r);return{timestampValue:Oa(s.serializer,i)}}if(r instanceof Gt){const i=new Gt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Oa(s.serializer,i)}}if(r instanceof Dm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ao)return{bytesValue:nw(s.serializer,r._byteString)};if(r instanceof tn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:sm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof _h)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Xp(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${yh(r)}`)}(n,e)}function dI(n,e){const t={};return wb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Di(n,(r,s)=>{const i=ko(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function hI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Gt||n instanceof Dm||n instanceof Ao||n instanceof tn||n instanceof Ro||n instanceof _h)}function $m(n,e,t){if(!hI(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=yh(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function xu(n,e,t){if((e=De(e))instanceof Po)return e._internalPath;if(typeof e=="string")return Ih(n,e);throw Md("Field path arguments must be of type string or ",n,!1,void 0,t)}const mk=new RegExp("[~\\*/\\[\\]]");function Ih(n,e,t){if(e.search(mk)>=0)throw Md(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Po(...e.split("."))._internalPath}catch{throw Md(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Md(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new ie(K.INVALID_ARGUMENT,a+n+l)}function fI(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Eh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class gk extends Au{data(){return super.data()}}function Eh(n,e){return typeof e=="string"?Ih(n,e):e instanceof Po?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ie(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Um{}class Xu extends Um{}function Su(n,e,...t){let r=[];e instanceof Um&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof sl).length,a=i.filter(l=>l instanceof Zu).length;if(o>1||o>0&&a>0)throw new ie(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class Zu extends Xu{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Zu(e,t,r)}_apply(e){const t=this._parse(e);return gI(e._query,t),new Pn(e.firestore,e.converter,Zf(e._query,t))}_parse(e){const t=Co(e.firestore);return function(i,o,a,l,c,d,f){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ie(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Gy(f,d);const y=[];for(const x of f)y.push(zy(l,i,x));g={arrayValue:{values:y}}}else g=zy(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Gy(f,d),g=cI(a,o,f,d==="in"||d==="not-in");return nt.create(c,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ld(n,e,t){const r=e,s=Eh("where",n);return Zu._create(s,r,t)}class sl extends Um{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sl(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:yt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)gI(o,l),o=Zf(o,l)}(e._query,t),new Pn(e.firestore,e.converter,Zf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function lU(...n){return n.forEach(e=>vI("or",e)),sl._create("or",n)}function uU(...n){return n.forEach(e=>vI("and",e)),sl._create("and",n)}class jm extends Xu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new jm(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new ie(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ie(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wu(i,o)}(e._query,this._field,this._direction);return new Pn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new ks(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function vk(n,e="asc"){const t=e,r=Eh("orderBy",n);return jm._create(r,t)}class Th extends Xu{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Th(e,t,r)}_apply(e){return new Pn(e.firestore,e.converter,Ad(e._query,this._limit,this._limitType))}}function cU(n){return rI("limit",n),Th._create("limit",n,"F")}function dU(n){return rI("limitToLast",n),Th._create("limitToLast",n,"L")}class xh extends Xu{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new xh(e,t,r)}_apply(e){const t=mI(e,this.type,this._docOrFields,this._inclusive);return new Pn(e.firestore,e.converter,function(s,i){return new ks(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function hU(...n){return xh._create("startAt",n,!0)}function fU(...n){return xh._create("startAfter",n,!1)}class Ah extends Xu{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Ah(e,t,r)}_apply(e){const t=mI(e,this.type,this._docOrFields,this._inclusive);return new Pn(e.firestore,e.converter,function(s,i){return new ks(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function pU(...n){return Ah._create("endBefore",n,!1)}function mU(...n){return Ah._create("endAt",n,!0)}function mI(n,e,t,r){if(t[0]=De(t[0]),t[0]instanceof Au)return function(i,o,a,l,c){if(!l)throw new ie(K.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of ga(i))if(f.field.isKeyField())d.push(_o(o,l.key));else{const g=l.data.field(f.field);if(ih(g))throw new ie(K.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const y=f.field.canonicalString();throw new ie(K.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new Ti(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Co(n.firestore);return function(o,a,l,c,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new ie(K.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let x=0;x<d.length;x++){const S=d[x];if(g[x].field.isKeyField()){if(typeof S!="string")throw new ie(K.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof S}`);if(!Jp(o)&&S.indexOf("/")!==-1)throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${S}' contains a slash.`);const P=o.path.child(tt.fromString(S));if(!Ie.isDocumentKey(P))throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const j=new Ie(P);y.push(_o(a,j))}else{const P=cI(l,c,S);y.push(P)}}return new Ti(y,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function zy(n,e,t){if(typeof(t=De(t))=="string"){if(t==="")throw new ie(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Jp(e)&&t.indexOf("/")!==-1)throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(tt.fromString(t));if(!Ie.isDocumentKey(r))throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _o(n,new Ie(r))}if(t instanceof tn)return _o(n,t._key);throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yh(t)}.`)}function Gy(n,e){if(!Array.isArray(n)||n.length===0)throw new ie(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function gI(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ie(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function vI(n,e){if(!(e instanceof Zu||e instanceof sl))throw new ie(K.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class yI{convertValue(e,t="none"){switch(Ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Di(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>$t(o.doubleValue));return new _h(i)}convertGeoPoint(e){return new Dm($t(e.latitude),$t(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=oh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(yu(e));default:return null}}convertTimestamp(e){const t=Ts(e);return new Gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=tt.fromString(e);Se(fw(r));const s=new yo(r.get(1),r.get(3)),i=new Ie(r.popFirst(5));return s.isEqual(t)||Xt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class yk extends yI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ao(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gU(n){return new Tu("sum",xu("sum",n))}function vU(n){return new Tu("avg",xu("average",n))}function _k(){return new Tu("count")}function yU(n,e){var t,r;return n instanceof Tu&&e instanceof Tu&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function _U(n,e){return sI(n.query,e.query)&&bi(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ba extends Au{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new id(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Eh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class id extends Ba{data(e={}){return super.data(e)}}class qa{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new uo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new id(this._firestore,this._userDataWriter,r.key,r,new uo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ie(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new id(s._firestore,s._userDataWriter,a.doc.key,a.doc,new uo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new id(s._firestore,s._userDataWriter,a.doc.key,a.doc,new uo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:bk(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function bk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae()}}function bU(n,e){return n instanceof Ba&&e instanceof Ba?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof qa&&e instanceof qa&&n._firestore===e._firestore&&sI(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(n){n=Ye(n,tn);const e=Ye(n.firestore,It);return eI(Kt(e),n._key).then(t=>Bm(e,n,t))}class Ni extends yI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ao(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tn(this.firestore,null,t)}}function wU(n){n=Ye(n,tn);const e=Ye(n.firestore,It),t=Kt(e),r=new Ni(e);return YC(t,n._key).then(s=>new Ba(e,r,n._key,s,new uo(s!==null&&s.hasLocalMutations,!0),n.converter))}function IU(n){n=Ye(n,tn);const e=Ye(n.firestore,It);return eI(Kt(e),n._key,{source:"server"}).then(t=>Bm(e,n,t))}function mt(n){n=Ye(n,Pn);const e=Ye(n.firestore,It),t=Kt(e),r=new Ni(e);return pI(n._query),tI(t,n._query).then(s=>new qa(e,r,n,s))}function EU(n){n=Ye(n,Pn);const e=Ye(n.firestore,It),t=Kt(e),r=new Ni(e);return XC(t,n._query).then(s=>new qa(e,r,n,s))}function TU(n){n=Ye(n,Pn);const e=Ye(n.firestore,It),t=Kt(e),r=new Ni(e);return tI(t,n._query,{source:"server"}).then(s=>new qa(e,r,n,s))}function pn(n,e,t){n=Ye(n,tn);const r=Ye(n.firestore,It),s=Sh(n.converter,e,t);return tc(r,[wh(Co(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,jt.none())])}function il(n,e,t,...r){n=Ye(n,tn);const s=Ye(n.firestore,It),i=Co(s);let o;return o=typeof(e=De(e))=="string"||e instanceof Po?Fm(i,"updateDoc",n._key,e,t,r):Lm(i,"updateDoc",n._key,e),tc(s,[o.toMutation(n._key,jt.exists(!0))])}function za(n){return tc(Ye(n.firestore,It),[new Xa(n._key,jt.none())])}function ec(n,e){const t=Ye(n.firestore,It),r=xe(n),s=Sh(n.converter,e);return tc(t,[wh(Co(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,jt.exists(!1))]).then(()=>r)}function xU(n,...e){var t,r,s;n=De(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||dp(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(dp(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,d;if(n instanceof tn)c=Ye(n.firestore,It),d=Ja(n._key.path),l={next:f=>{e[o]&&e[o](Bm(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Ye(n,Pn);c=Ye(f.firestore,It),d=f._query;const g=new Ni(c);l={next:y=>{e[o]&&e[o](new qa(c,g,f,y))},error:e[o+1],complete:e[o+2]},pI(n._query)}return function(g,y,x,S){const P=new gh(S),j=new Im(y,P,x);return g.asyncQueue.enqueueAndForget(async()=>_m(await ja(g),j)),()=>{P.Za(),g.asyncQueue.enqueueAndForget(async()=>bm(await ja(g),j))}}(Kt(c),d,a,l)}function AU(n,e){return ek(Kt(n=Ye(n,It)),dp(e)?e:{next:e})}function tc(n,e){return function(r,s){const i=new bn;return r.asyncQueue.enqueueAndForget(async()=>PC(await Cm(r),s,i)),i.promise}(Kt(n),e)}function Bm(n,e,t){const r=t.docs.get(e._key),s=new Ni(n);return new Ba(n,s,e._key,r,new uo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SU(n){return wk(n,{count:_k()})}function wk(n,e){const t=Ye(n.firestore,It),r=Kt(t),s=bb(e,(i,o)=>new Jb(o,i.aggregateType,i._internalFieldPath));return ZC(r,n._query,s).then(i=>function(a,l,c){const d=new Ni(a);return new dk(l,d,c)}(t,n,i))}class Ik{constructor(e){this.kind="memory",this._onlineComponentProvider=Si.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=Ai.provider}toJSON(){return{kind:this.kind}}}class Ek{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=Pk(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Tk{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Ai.provider}toJSON(){return{kind:this.kind}}}class xk{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new zC(e)}}toJSON(){return{kind:this.kind}}}function PU(){return new Tk}function RU(n){return new xk(n==null?void 0:n.cacheSizeBytes)}function CU(n){return new Ik(n)}function kU(n){return new Ek(n)}class Ak{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Si.provider,this._offlineComponentProvider={build:t=>new Pm(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Sk{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Si.provider,this._offlineComponentProvider={build:t=>new Jw(t,e==null?void 0:e.cacheSizeBytes)}}}function Pk(n){return new Ak(n==null?void 0:n.forceOwnership)}function DU(){return new Sk}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Co(e)}set(e,t,r){this._verifyNotCommitted();const s=ii(e,this._firestore),i=Sh(s.converter,t,r),o=wh(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,jt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=ii(e,this._firestore);let o;return o=typeof(t=De(t))=="string"||t instanceof Po?Fm(this._dataReader,"WriteBatch.update",i._key,t,r,s):Lm(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,jt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ii(e,this._firestore);return this._mutations=this._mutations.concat(new Xa(t._key,jt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ie(K.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ii(n,e){if((n=De(n)).firestore!==e)throw new ie(K.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Co(t)}get(t){const r=ii(t,this._firestore),s=new yk(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return Ae();const o=i[0];if(o.isFoundDocument())return new Au(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new Au(this._firestore,s,r._key,null,r.converter);throw Ae()})}set(t,r,s){const i=ii(t,this._firestore),o=Sh(i.converter,r,s),a=wh(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=ii(t,this._firestore);let a;return a=typeof(r=De(r))=="string"||r instanceof Po?Fm(this._dataReader,"Transaction.update",o._key,r,s,i):Lm(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=ii(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ii(e,this._firestore),r=new Ni(this._firestore);return super.get(e).then(s=>new Ba(this._firestore,r,t._key,s._document,new uo(!1,!1),t.converter))}}function NU(n,e,t){n=Ye(n,It);const r=Object.assign(Object.assign({},Rk),t);return function(i){if(i.maxAttempts<1)throw new ie(K.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new bn;return i.asyncQueue.enqueueAndForget(async()=>{const c=await Zw(i);new HC(i.asyncQueue,c,a,o,l).au()}),l.promise}(Kt(n),s=>e(new kk(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OU(){return new Yu("deleteField")}function ol(){return new Vm("serverTimestamp")}function MU(...n){return new Nm("arrayUnion",n)}function LU(...n){return new Om("arrayRemove",n)}function FU(n){return new Mm("increment",n)}function $U(n){return new _h(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(n){return Kt(n=Ye(n,It)),new Ck(n,e=>tc(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UU(n,e){const t=Kt(n=Ye(n,It));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Er("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(c){try{return JSON.parse(c)}catch(d){throw new ie(K.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const c=Ky(l,"collectionGroup"),d=[];if(Array.isArray(l.fields))for(const f of l.fields){const g=Ih("setIndexConfiguration",Ky(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new po(g,2)):f.order==="ASCENDING"?d.push(new po(g,0)):f.order==="DESCENDING"&&d.push(new po(g,1))}a.push(new Ra(Ra.UNKNOWN_ID,c,d,Ca.empty()))}return a}(e);return rk(t,r)}function Ky(n,e){if(typeof n[e]!="string")throw new ie(K.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function jU(n){var e;n=Ye(n,It);const t=Hy.get(n);if(t)return t;if(((e=Kt(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new Dk(n);return Hy.set(n,r),r}function BU(n){_I(n,!0)}function qU(n){_I(n,!1)}function zU(n){ik(Kt(n._firestore)).then(e=>se("deleting all persistent cache indexes succeeded")).catch(e=>Er("deleting all persistent cache indexes failed",e))}function _I(n,e){sk(Kt(n._firestore),e).then(t=>se(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>Er(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const Hy=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(n){var e;const t=(e=Kt(Ye(n.firestore,It))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:ch(t,Bn(n._query))._t}function KU(n,e){var t;const r=bb(e,(i,o)=>new Jb(o,i.aggregateType,i._internalFieldPath)),s=(t=Kt(Ye(n.firestore,It))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:uw(s,Nb(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return zm.instance.onExistenceFilterMismatch(e)}}class zm{constructor(){this.Uu=new Map}static get instance(){return jc||(jc=new zm,function(t){if(Sd)throw new Error("a TestingHooksSpi instance is already set");Sd=t}(jc)),jc}et(e){this.Uu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let jc=null;(function(e,t=!0){(function(s){Qa=s})(Wa),Sa(new vo("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new It(new t1(r.getProvider("auth-internal")),new s1(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ie(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yo(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),pi(Mv,"4.7.3",e),pi(Mv,"4.7.3","esm2017")})();function Gm(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU={PHONE:"phone",TOTP:"totp"},QU={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},JU={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},YU={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},XU={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vk(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function bI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZU=Vk,Nk=bI,wI=new $u("auth","Firebase",bI()),e6={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd=new qp("@firebase/auth");function Ok(n,...e){Fd.logLevel<=et.WARN&&Fd.warn(`Auth (${Wa}): ${n}`,...e)}function od(n,...e){Fd.logLevel<=et.ERROR&&Fd.error(`Auth (${Wa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(n,...e){throw Hm(n,...e)}function Yn(n,...e){return Hm(n,...e)}function Km(n,e,t){const r=Object.assign(Object.assign({},Nk()),{[e]:t});return new $u("auth","Firebase",r).create(e,{appName:n.name})}function wn(n){return Km(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function al(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&or(n,"argument-error"),Km(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Hm(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return wI.create(n,...e)}function ye(n,e,...t){if(!n)throw Hm(e,...t)}function Wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw od(e),new Error(e)}function As(n,e){n||Wr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Wm(){return Wy()==="http:"||Wy()==="https:"}function Wy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Wm()||DS()||"connection"in navigator)?navigator.onLine:!0}function Lk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t){this.shortDelay=e,this.longDelay=t,As(t>e,"Short delay should be less than long delay!"),this.isMobile=RS()||VS()}get(){return Mk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(n,e){As(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k=new nc(3e4,6e4);function Mt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Lt(n,e,t,r,s={}){return EI(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Ha(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return kS()||(c.referrerPolicy="no-referrer"),II.fetch()(TI(n,n.config.apiHost,t,a),c)})}async function EI(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},Fk),e);try{const s=new jk(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ql(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ql(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ql(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw ql(n,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Km(n,d,c);or(n,d)}}catch(s){if(s instanceof Cs)throw s;or(n,"network-request-failed",{message:String(s)})}}async function Os(n,e,t,r,s={}){const i=await Lt(n,e,t,r,s);return"mfaPendingCredential"in i&&or(n,"multi-factor-auth-required",{_serverResponse:i}),i}function TI(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?Qm(n.config,s):`${n.config.apiScheme}://${s}`}function Uk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jk{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Yn(this.auth,"network-request-failed")),$k.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ql(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Yn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(n){return n!==void 0&&n.getResponse!==void 0}function Jy(n){return n!==void 0&&n.enterprise!==void 0}class xI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Uk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bk(n){return(await Lt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function AI(n,e){return Lt(n,"GET","/v2/recaptchaConfig",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qk(n,e){return Lt(n,"POST","/v1/accounts:delete",e)}async function zk(n,e){return Lt(n,"POST","/v1/accounts:update",e)}async function SI(n,e){return Lt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(n,e=!1){return De(n).getIdToken(e)}async function Gk(n,e=!1){const t=De(n),r=await t.getIdToken(e),s=Ph(r);ye(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:iu(bf(s.auth_time)),issuedAtTime:iu(bf(s.iat)),expirationTime:iu(bf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function bf(n){return Number(n)*1e3}function Ph(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return od("JWT malformed, contained fewer than 3 sections"),null;try{const s=B0(t);return s?JSON.parse(s):(od("Failed to decode base64 JWT payload"),null)}catch(s){return od("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Yy(n){const e=Ph(n);return ye(e,"internal-error"),ye(typeof e.exp<"u","internal-error"),ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ss(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Cs&&Kk(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Kk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=iu(this.lastLoginAt),this.creationTime=iu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ru(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Ss(n,SI(t,{idToken:r}));ye(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?PI(i.providerUserInfo):[],a=Qk(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new hp(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function Wk(n){const e=De(n);await Ru(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Qk(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function PI(n){return n.map(e=>{var{providerId:t}=e,r=Gm(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jk(n,e){const t=await EI(n,{},async()=>{const r=Ha({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=TI(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",II.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Yk(n,e){return Lt(n,"POST","/v2/accounts:revokeToken",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ye(e.idToken,"internal-error"),ye(typeof e.idToken<"u","internal-error"),ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ye(e.length!==0,"internal-error");const t=Yy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Jk(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new ya;return r&&(ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ye(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ye(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ya,this.toJSON())}_performRefresh(){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xs(n,e){ye(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ms{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=Gm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ss(this,this.stsTokenManager.getToken(this.auth,e));return ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Gk(this,e)}reload(){return Wk(this)}_assign(e){this!==e&&(ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ms(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Ru(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zt(this.auth.app))return Promise.reject(wn(this.auth));const e=await this.getIdToken();return await Ss(this,qk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(s=t.email)!==null&&s!==void 0?s:void 0,y=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=t.photoURL)!==null&&o!==void 0?o:void 0,S=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,j=(c=t.createdAt)!==null&&c!==void 0?c:void 0,U=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:D,emailVerified:G,isAnonymous:Z,providerData:me,stsTokenManager:T}=t;ye(D&&T,e,"internal-error");const w=ya.fromJSON(this.name,T);ye(typeof D=="string",e,"internal-error"),Xs(f,e.name),Xs(g,e.name),ye(typeof G=="boolean",e,"internal-error"),ye(typeof Z=="boolean",e,"internal-error"),Xs(y,e.name),Xs(x,e.name),Xs(S,e.name),Xs(P,e.name),Xs(j,e.name),Xs(U,e.name);const I=new ms({uid:D,auth:e,email:g,emailVerified:G,displayName:f,isAnonymous:Z,photoURL:x,phoneNumber:y,tenantId:S,stsTokenManager:w,createdAt:j,lastLoginAt:U});return me&&Array.isArray(me)&&(I.providerData=me.map(C=>Object.assign({},C))),P&&(I._redirectEventId=P),I}static async _fromIdTokenResponse(e,t,r=!1){const s=new ya;s.updateFromServerResponse(t);const i=new ms({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ru(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ye(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?PI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new ya;a.updateFromIdToken(r);const l=new ms({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new hp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;function gs(n){As(n instanceof Function,"Expected a class definition");let e=Xy.get(n);return e?(As(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Xy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}RI.type="NONE";const Zy=RI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ad(n,e,t){return`firebase:${n}:${e}:${t}`}class _a{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ad(this.userKey,s.apiKey,i),this.fullPersistenceKey=ad("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ms._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new _a(gs(Zy),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||gs(Zy);const o=ad(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){const f=ms._fromJSON(e,d);c!==i&&(a=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new _a(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new _a(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(OI(e))return"Blackberry";if(MI(e))return"Webos";if(kI(e))return"Safari";if((e.includes("chrome/")||DI(e))&&!e.includes("edge/"))return"Chrome";if(NI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function CI(n=mn()){return/firefox\//i.test(n)}function kI(n=mn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function DI(n=mn()){return/crios\//i.test(n)}function VI(n=mn()){return/iemobile/i.test(n)}function NI(n=mn()){return/android/i.test(n)}function OI(n=mn()){return/blackberry/i.test(n)}function MI(n=mn()){return/webos/i.test(n)}function Jm(n=mn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Xk(n=mn()){var e;return Jm(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Zk(){return NS()&&document.documentMode===10}function LI(n=mn()){return Jm(n)||NI(n)||MI(n)||OI(n)||/windows phone/i.test(n)||VI(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(n,e=[]){let t;switch(n){case"Browser":t=e_(mn());break;case"Worker":t=`${e_(mn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tD(n,e={}){return Lt(n,"GET","/v2/passwordPolicy",Mt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=6;class rD{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:nD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new t_(this),this.idTokenSubscription=new t_(this),this.beforeStateQueue=new eD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gs(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await _a.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await SI(this,{idToken:e}),r=await ms._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Zt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ru(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Lk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zt(this.app))return Promise.reject(wn(this));const t=e?De(e):null;return t&&ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zt(this.app)?Promise.reject(wn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zt(this.app)?Promise.reject(wn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tD(this),t=new rD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $u("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Yk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gs(e)||this._popupRedirectResolver;ye(t,this,"argument-error"),this.redirectPersistenceManager=await _a.create(this,[gs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ye(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=FI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Ok(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Qt(n){return De(n)}class t_{constructor(e){this.auth=e,this.observer=null,this.addObserver=US(t=>this.observer=t)}get next(){return ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iD(n){rc=n}function Ym(n){return rc.loadJS(n)}function oD(){return rc.recaptchaV2Script}function aD(){return rc.recaptchaEnterpriseScript}function lD(){return rc.gapiScript}function $I(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const uD="recaptcha-enterprise",cD="NO_RECAPTCHA";class UI{constructor(e){this.type=uD,this.auth=Qt(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{AI(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new xI(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Jy(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(cD)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&Jy(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=aD();l.length!==0&&(l+=a),Ym(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function n_(n,e,t,r=!1){const s=new UI(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Cu(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await n_(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await n_(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}async function dD(n){const e=Qt(n),t=await AI(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new xI(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new UI(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(n,e){const t=Uu(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(bi(i,e??{}))return s;or(s,"already-initialized")}return t.initialize({options:e})}function fD(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(gs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function pD(n,e,t){const r=Qt(n);ye(r._canInitEmulator,r,"emulator-config-failed"),ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=jI(e),{host:o,port:a}=mD(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||gD()}function jI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mD(n){const e=jI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:r_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:r_(o)}}}function r_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wr("not implemented")}_getIdTokenResponse(e){return Wr("not implemented")}_linkToIdToken(e,t){return Wr("not implemented")}_getReauthenticationResolver(e){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BI(n,e){return Lt(n,"POST","/v1/accounts:resetPassword",Mt(n,e))}async function vD(n,e){return Lt(n,"POST","/v1/accounts:update",e)}async function yD(n,e){return Lt(n,"POST","/v1/accounts:signUp",e)}async function _D(n,e){return Lt(n,"POST","/v1/accounts:update",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bD(n,e){return Os(n,"POST","/v1/accounts:signInWithPassword",Mt(n,e))}async function Rh(n,e){return Lt(n,"POST","/v1/accounts:sendOobCode",Mt(n,e))}async function wD(n,e){return Rh(n,e)}async function ID(n,e){return Rh(n,e)}async function ED(n,e){return Rh(n,e)}async function TD(n,e){return Rh(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xD(n,e){return Os(n,"POST","/v1/accounts:signInWithEmailLink",Mt(n,e))}async function AD(n,e){return Os(n,"POST","/v1/accounts:signInWithEmailLink",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends sc{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new ku(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ku(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cu(e,t,"signInWithPassword",bD);case"emailLink":return xD(e,{email:this._email,oobCode:this._password});default:or(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cu(e,r,"signUpPassword",yD);case"emailLink":return AD(e,{idToken:t,email:this._email,oobCode:this._password});default:or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bs(n,e){return Os(n,"POST","/v1/accounts:signInWithIdp",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD="http://localhost";class Ps extends sc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ps(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):or("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=Gm(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ps(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return bs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,bs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,bs(e,t)}buildRequest(){const e={requestUri:SD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ha(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PD(n,e){return Lt(n,"POST","/v1/accounts:sendVerificationCode",Mt(n,e))}async function RD(n,e){return Os(n,"POST","/v1/accounts:signInWithPhoneNumber",Mt(n,e))}async function CD(n,e){const t=await Os(n,"POST","/v1/accounts:signInWithPhoneNumber",Mt(n,e));if(t.temporaryProof)throw ql(n,"account-exists-with-different-credential",t);return t}const kD={USER_NOT_FOUND:"user-not-found"};async function DD(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Os(n,"POST","/v1/accounts:signInWithPhoneNumber",Mt(n,t),kD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo extends sc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new mo({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new mo({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return RD(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return CD(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return DD(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new mo({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ND(n){const e=Ll(Fl(n)).link,t=e?Ll(Fl(e)).deep_link_id:null,r=Ll(Fl(n)).deep_link_id;return(r?Ll(Fl(r)).link:null)||r||t||e||n}class ic{constructor(e){var t,r,s,i,o,a;const l=Ll(Fl(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=VD((s=l.mode)!==null&&s!==void 0?s:null);ye(c&&d&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=ND(e);try{return new ic(t)}catch{return null}}}function n6(n){return ic.parseLink(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.providerId=Do.PROVIDER_ID}static credential(e,t){return ku._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ic.parseLink(t);return ye(r,"argument-error"),ku._fromEmailAndCode(e,r.code,r.tenantId)}}Do.PROVIDER_ID="password";Do.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Do.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll extends Ms{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ld extends ll{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ye("providerId"in t&&"signInMethod"in t,"argument-error"),Ps._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ye(e.idToken||e.accessToken,"argument-error"),Ps._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ld.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ld.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new ld(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends ll{constructor(){super("facebook.com")}static credential(e){return Ps._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.FACEBOOK_SIGN_IN_METHOD="facebook.com";oi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends ll{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ps._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ai.credential(t,r)}catch{return null}}}ai.GOOGLE_SIGN_IN_METHOD="google.com";ai.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li extends ll{constructor(){super("github.com")}static credential(e){return Ps._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return li.credential(e.oauthAccessToken)}catch{return null}}}li.GITHUB_SIGN_IN_METHOD="github.com";li.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD="http://localhost";class Du extends sc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return bs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,bs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,bs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new Du(r,i)}static _create(e,t){return new Du(e,t)}buildRequest(){return{requestUri:OD,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD="saml.";class fp extends Ms{constructor(e){ye(e.startsWith(MD),"argument-error"),super(e)}static credentialFromResult(e){return fp.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return fp.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Du.fromJSON(e);return ye(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Du._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui extends ll{constructor(){super("twitter.com")}static credential(e,t){return Ps._fromParams({providerId:ui.PROVIDER_ID,signInMethod:ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ui.credentialFromTaggedObject(e)}static credentialFromError(e){return ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ui.credential(t,r)}catch{return null}}}ui.TWITTER_SIGN_IN_METHOD="twitter.com";ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qI(n,e){return Os(n,"POST","/v1/accounts:signUp",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ms._fromIdTokenResponse(e,r,s),o=s_(r);return new Tr({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=s_(r);return new Tr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function s_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LD(n){var e;if(Zt(n.app))return Promise.reject(wn(n));const t=Qt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Tr({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await qI(t,{returnSecureToken:!0}),s=await Tr._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d extends Cs{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,$d.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new $d(e,t,r,s)}}function zI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?$d._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r6(n,e){const t=De(n);await Ch(!0,t,e);const{providerUserInfo:r}=await zk(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=GI(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Xm(n,e,t=!1){const r=await Ss(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Tr._forOperation(n,"link",r)}async function Ch(n,e,t){await Ru(e);const r=GI(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ye(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KI(n,e,t=!1){const{auth:r}=n;if(Zt(r.app))return Promise.reject(wn(r));const s="reauthenticate";try{const i=await Ss(n,zI(r,s,e,n),t);ye(i.idToken,r,"internal-error");const o=Ph(i.idToken);ye(o,r,"internal-error");const{sub:a}=o;return ye(n.uid===a,r,"user-mismatch"),Tr._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&or(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e,t=!1){if(Zt(n.app))return Promise.reject(wn(n));const r="signIn",s=await zI(n,r,e),i=await Tr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function Zm(n,e){return HI(Qt(n),e)}async function FD(n,e){const t=De(n);return await Ch(!1,t,e.providerId),Xm(t,e)}async function $D(n,e){return KI(De(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UD(n,e){return Os(n,"POST","/v1/accounts:signInWithCustomToken",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s6(n,e){if(Zt(n.app))return Promise.reject(wn(n));const t=Qt(n),r=await UD(t,{token:e,returnSecureToken:!0}),s=await Tr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?eg._fromServerResponse(e,t):"totpInfo"in t?tg._fromServerResponse(e,t):or(e,"internal-error")}}class eg extends oc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new eg(t)}}class tg extends oc{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new tg(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(n,e,t){var r;ye(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),ye(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ye(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ye(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ng(n){const e=Qt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function jD(n,e,t){const r=Qt(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&kh(r,s,t),await Cu(r,s,"getOobCode",ID)}async function BD(n,e,t){await BI(De(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ng(n),r})}async function i6(n,e){await _D(De(n),{oobCode:e})}async function qD(n,e){const t=De(n),r=await BI(t,{oobCode:e}),s=r.requestType;switch(ye(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ye(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ye(r.mfaInfo,t,"internal-error");default:ye(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=oc._fromServerResponse(Qt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function o6(n,e){const{data:t}=await qD(De(n),e);return t.email}async function zD(n,e,t){if(Zt(n.app))return Promise.reject(wn(n));const r=Qt(n),o=await Cu(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qI).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&ng(n),l}),a=await Tr._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function GD(n,e,t){return Zt(n.app)?Promise.reject(wn(n)):Zm(De(n),Do.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ng(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a6(n,e,t){const r=Qt(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){ye(a.handleCodeInApp,r,"argument-error"),a&&kh(r,o,a)}i(s,t),await Cu(r,s,"getOobCode",ED)}function l6(n,e){const t=ic.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function u6(n,e,t){if(Zt(n.app))return Promise.reject(wn(n));const r=De(n),s=Do.credentialWithLink(e,t||Pu());return ye(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Zm(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KD(n,e){return Lt(n,"POST","/v1/accounts:createAuthUri",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c6(n,e){const t=Wm()?Pu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await KD(De(n),r);return s||[]}async function d6(n,e){const t=De(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&kh(t.auth,s,e);const{email:i}=await wD(t.auth,s);i!==n.email&&await n.reload()}async function h6(n,e,t){const r=De(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&kh(r.auth,i,t);const{email:o}=await TD(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(n,e){return Lt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f6(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=De(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Ss(r,HD(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function WD(n,e){const t=De(n);return Zt(t.auth.app)?Promise.reject(wn(t.auth)):WI(t,e,null)}function QD(n,e){return WI(De(n),null,e)}async function WI(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await Ss(n,vD(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JD(n){var e,t;if(!n)return null;const{providerId:r}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=Ph(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ba(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new YD(i,s);case"github.com":return new XD(i,s);case"google.com":return new ZD(i,s);case"twitter.com":return new e2(i,s,n.screenName||null);case"custom":case"anonymous":return new ba(i,null);default:return new ba(i,r,s)}}class ba{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class QI extends ba{constructor(e,t,r,s){super(e,t,r),this.username=s}}class YD extends ba{constructor(e,t){super(e,"facebook.com",t)}}class XD extends QI{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class ZD extends ba{constructor(e,t){super(e,"google.com",t)}}class e2 extends QI{constructor(e,t,r){super(e,"twitter.com",t,r)}}function p6(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:JD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(n,e){return De(n).setPersistence(e)}function m6(n){return dD(n)}async function g6(n,e){return Qt(n).validatePassword(e)}function n2(n,e,t,r){return De(n).onIdTokenChanged(e,t,r)}function r2(n,e,t){return De(n).beforeAuthStateChanged(e,t)}function s2(n,e,t,r){return De(n).onAuthStateChanged(e,t,r)}function v6(n){De(n).useDeviceLanguage()}function y6(n,e){return De(n).updateCurrentUser(e)}function i2(n){return De(n).signOut()}function _6(n,e){return Qt(n).revokeAccessToken(e)}async function b6(n){return De(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new co("enroll",e,t)}static _fromMfaPendingCredential(e){return new co("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return co._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return co._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Qt(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>oc._fromServerResponse(r,a));ye(s.mfaPendingCredential,r,"internal-error");const o=co._fromMfaPendingCredential(s.mfaPendingCredential);return new rg(o,i,async a=>{const l=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const c=Object.assign(Object.assign({},s),{idToken:l.idToken,refreshToken:l.refreshToken});switch(t.operationType){case"signIn":const d=await Tr._fromIdTokenResponse(r,t.operationType,c);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return ye(t.user,r,"internal-error"),Tr._forOperation(t.user,t.operationType,c);default:or(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function w6(n,e){var t;const r=De(n),s=e;return ye(e.customData.operationType,r,"argument-error"),ye((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),rg._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(n,e){return Lt(n,"POST","/v2/accounts/mfaEnrollment:start",Mt(n,e))}function a2(n,e){return Lt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Mt(n,e))}function l2(n,e){return Lt(n,"POST","/v2/accounts/mfaEnrollment:start",Mt(n,e))}function u2(n,e){return Lt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Mt(n,e))}function c2(n,e){return Lt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Mt(n,e))}class sg{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>oc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new sg(e)}async getSession(){return co._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await Ss(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Ss(this.user,c2(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const wf=new WeakMap;function I6(n){const e=De(n);return wf.has(e)||wf.set(e,sg._fromUser(e)),wf.get(e)}const Ud="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ud,"1"),this.storage.removeItem(Ud),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=1e3,h2=10;class YI extends JI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Zk()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,h2):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},d2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}YI.type="LOCAL";const XI=YI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI extends JI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ZI.type="SESSION";const eE=ZI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f2(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Dh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await f2(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=Vh("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(){return window}function m2(n){dn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(){return typeof dn().WorkerGlobalScope<"u"&&typeof dn().importScripts=="function"}async function g2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function v2(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function y2(){return ig()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE="firebaseLocalStorageDb",_2=1,jd="firebaseLocalStorage",nE="fbase_key";class ac{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Nh(n,e){return n.transaction([jd],e?"readwrite":"readonly").objectStore(jd)}function b2(){const n=indexedDB.deleteDatabase(tE);return new ac(n).toPromise()}function pp(){const n=indexedDB.open(tE,_2);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(jd,{keyPath:nE})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(jd)?e(r):(r.close(),await b2(),e(await pp()))})})}async function i_(n,e,t){const r=Nh(n,!0).put({[nE]:e,value:t});return new ac(r).toPromise()}async function w2(n,e){const t=Nh(n,!1).get(e),r=await new ac(t).toPromise();return r===void 0?null:r.value}function o_(n,e){const t=Nh(n,!0).delete(e);return new ac(t).toPromise()}const I2=800,E2=3;class rE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>E2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ig()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dh._getInstance(y2()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await g2(),!this.activeServiceWorker)return;this.sender=new p2(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||v2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pp();return await i_(e,Ud,"1"),await o_(e,Ud),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>i_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>w2(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>o_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Nh(s,!1).getAll();return new ac(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),I2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rE.type="LOCAL";const T2=rE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(n,e){return Lt(n,"POST","/v2/accounts/mfaSignIn:start",Mt(n,e))}function A2(n,e){return Lt(n,"POST","/v2/accounts/mfaSignIn:finalize",Mt(n,e))}function S2(n,e){return Lt(n,"POST","/v2/accounts/mfaSignIn:finalize",Mt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2=500,R2=6e4,Bc=1e12;class C2{constructor(e){this.auth=e,this.counter=Bc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new k2(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Bc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Bc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Bc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class k2{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ye(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=D2(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},R2)},P2))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function D2(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=$I("rcb"),V2=new nc(3e4,6e4);class N2{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=dn().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return ye(O2(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Qy(dn().grecaptcha)?Promise.resolve(dn().grecaptcha):new Promise((r,s)=>{const i=dn().setTimeout(()=>{s(Yn(e,"network-request-failed"))},V2.get());dn()[If]=()=>{dn().clearTimeout(i),delete dn()[If];const a=dn().grecaptcha;if(!a||!Qy(a)){s(Yn(e,"internal-error"));return}const l=a.render;a.render=(c,d)=>{const f=l(c,d);return this.counter++,f},this.hostLanguage=t,r(a)};const o=`${oD()}?${Ha({onload:If,render:"explicit",hl:t})}`;Ym(o).catch(()=>{clearTimeout(i),s(Yn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=dn().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function O2(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class M2{async load(e){return new C2(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="recaptcha",L2={theme:"light",type:"image"};class E6{constructor(e,t,r=Object.assign({},L2)){this.parameters=r,this.type=sE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Qt(e),this.isInvisible=this.parameters.size==="invisible",ye(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ye(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new M2:new N2,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ye(!this.parameters.sitekey,this.auth,"argument-error"),ye(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ye(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=dn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ye(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ye(Wm()&&!ig(),this.auth,"internal-error"),await F2(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Bk(this.auth);ye(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ye(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function F2(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=mo._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function T6(n,e,t){if(Zt(n.app))return Promise.reject(wn(n));const r=Qt(n),s=await Oh(r,e,De(t));return new og(s,i=>Zm(r,i))}async function x6(n,e,t){const r=De(n);await Ch(!1,r,"phone");const s=await Oh(r.auth,e,De(t));return new og(s,i=>FD(r,i))}async function A6(n,e,t){const r=De(n);if(Zt(r.auth.app))return Promise.reject(wn(r.auth));const s=await Oh(r.auth,e,De(t));return new og(s,i=>$D(r,i))}async function Oh(n,e,t){var r;const s=await t.verify();try{ye(typeof s=="string",n,"argument-error"),ye(t.type===sE,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return ye(o.type==="enroll",n,"internal-error"),(await o2(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{ye(o.type==="signin",n,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return ye(a,n,"missing-multi-factor-info"),(await x2(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await PD(n,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{t._reset()}}async function S6(n,e){const t=De(n);if(Zt(t.auth.app))return Promise.reject(wn(t.auth));await Xm(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.providerId=wa.PROVIDER_ID,this.auth=Qt(e)}verifyPhoneNumber(e,t){return Oh(this.auth,e,De(t))}static credential(e,t){return mo._fromVerification(e,t)}static credentialFromResult(e){const t=e;return wa.credentialFromTaggedObject(t)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?mo._fromTokenResponse(t,r):null}}wa.PROVIDER_ID="phone";wa.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vo(n,e){return e?gs(e):(ye(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag extends sc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return bs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return bs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $2(n){return HI(n.auth,new ag(n),n.bypassAuthState)}function U2(n){const{auth:e,user:t}=n;return ye(t,e,"internal-error"),KI(t,new ag(n),n.bypassAuthState)}async function j2(n){const{auth:e,user:t}=n;return ye(t,e,"internal-error"),Xm(t,new ag(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $2;case"linkViaPopup":case"linkViaRedirect":return j2;case"reauthViaPopup":case"reauthViaRedirect":return U2;default:or(this.auth,"internal-error")}}resolve(e){As(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){As(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2=new nc(2e3,1e4);async function P6(n,e,t){if(Zt(n.app))return Promise.reject(Yn(n,"operation-not-supported-in-this-environment"));const r=Qt(n);al(n,e,Ms);const s=Vo(r,t);return new vs(r,"signInViaPopup",e,s).executeNotNull()}async function R6(n,e,t){const r=De(n);if(Zt(r.auth.app))return Promise.reject(Yn(r.auth,"operation-not-supported-in-this-environment"));al(r.auth,e,Ms);const s=Vo(r.auth,t);return new vs(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function C6(n,e,t){const r=De(n);al(r.auth,e,Ms);const s=Vo(r.auth,t);return new vs(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class vs extends iE{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,vs.currentPopupAction&&vs.currentPopupAction.cancel(),vs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ye(e,this.auth,"internal-error"),e}async onExecution(){As(this.filter.length===1,"Popup operations only handle one event");const e=Vh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Yn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Yn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,B2.get())};e()}}vs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2="pendingRedirect",ud=new Map;class z2 extends iE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const r=await G2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G2(n,e){const t=aE(e),r=oE(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function lg(n,e){return oE(n)._set(aE(e),"true")}function K2(n,e){ud.set(n._key(),e)}function oE(n){return gs(n._redirectPersistence)}function aE(n){return ad(q2,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k6(n,e,t){return H2(n,e,t)}async function H2(n,e,t){if(Zt(n.app))return Promise.reject(wn(n));const r=Qt(n);al(n,e,Ms),await r._initializationPromise;const s=Vo(r,t);return await lg(s,r),s._openRedirect(r,e,"signInViaRedirect")}function D6(n,e,t){return W2(n,e,t)}async function W2(n,e,t){const r=De(n);if(al(r.auth,e,Ms),Zt(r.auth.app))return Promise.reject(wn(r.auth));await r.auth._initializationPromise;const s=Vo(r.auth,t);await lg(s,r.auth);const i=await uE(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function V6(n,e,t){return Q2(n,e,t)}async function Q2(n,e,t){const r=De(n);al(r.auth,e,Ms),await r.auth._initializationPromise;const s=Vo(r.auth,t);await Ch(!1,r,e.providerId),await lg(s,r.auth);const i=await uE(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function N6(n,e){return await Qt(n)._initializationPromise,lE(n,e,!1)}async function lE(n,e,t=!1){if(Zt(n.app))return Promise.reject(wn(n));const r=Qt(n),s=Vo(r,e),o=await new z2(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function uE(n){const e=Vh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2=10*60*1e3;class Y2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!X2(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!cE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Yn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=J2&&this.cachedEventUids.clear(),this.cachedEventUids.has(a_(e))}saveEventToCache(e){this.cachedEventUids.add(a_(e)),this.lastProcessedEventTime=Date.now()}}function a_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function cE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function X2(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z2(n,e={}){return Lt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tV=/^https?/;async function nV(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Z2(n);for(const t of e)try{if(rV(t))return}catch{}or(n,"unauthorized-domain")}function rV(n){const e=Pu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!tV.test(t))return!1;if(eV.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV=new nc(3e4,6e4);function l_(){const n=dn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function iV(n){return new Promise((e,t)=>{var r,s,i;function o(){l_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{l_(),t(Yn(n,"network-request-failed"))},timeout:sV.get()})}if(!((s=(r=dn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=dn().gapi)===null||i===void 0)&&i.load)o();else{const a=$I("iframefcb");return dn()[a]=()=>{gapi.load?o():t(Yn(n,"network-request-failed"))},Ym(`${lD()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw cd=null,e})}let cd=null;function oV(n){return cd=cd||iV(n),cd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=new nc(5e3,15e3),lV="__/auth/iframe",uV="emulator/auth/iframe",cV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hV(n){const e=n.config;ye(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qm(e,uV):`https://${n.config.authDomain}/${lV}`,r={apiKey:e.apiKey,appName:n.name,v:Wa},s=dV.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ha(r).slice(1)}`}async function fV(n){const e=await oV(n),t=dn().gapi;return ye(t,n,"internal-error"),e.open({where:document.body,url:hV(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cV,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Yn(n,"network-request-failed"),a=dn().setTimeout(()=>{i(o)},aV.get());function l(){dn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mV=500,gV=600,vV="_blank",yV="http://localhost";class u_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _V(n,e,t,r=mV,s=gV){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},pV),{width:r.toString(),height:s.toString(),top:i,left:o}),c=mn().toLowerCase();t&&(a=DI(c)?vV:t),CI(c)&&(e=e||yV,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[y,x])=>`${g}${y}=${x},`,"");if(Xk(c)&&a!=="_self")return bV(e||"",a),new u_(null);const f=window.open(e||"",a,d);ye(f,n,"popup-blocked");try{f.focus()}catch{}return new u_(f)}function bV(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV="__/auth/handler",IV="emulator/auth/handler",EV=encodeURIComponent("fac");async function c_(n,e,t,r,s,i){ye(n.config.authDomain,n,"auth-domain-config-required"),ye(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Wa,eventId:s};if(e instanceof Ms){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",$S(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof ll){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),c=l?`#${EV}=${encodeURIComponent(l)}`:"";return`${TV(n)}?${Ha(a).slice(1)}${c}`}function TV({config:n}){return n.emulator?Qm(n,IV):`https://${n.authDomain}/${wV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef="webStorageSupport";class xV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eE,this._completeRedirectFn=lE,this._overrideRedirectResult=K2}async _openPopup(e,t,r,s){var i;As((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await c_(e,t,r,Pu(),s);return _V(e,o,Vh())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await c_(e,t,r,Pu(),s);return m2(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(As(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await fV(e),r=new Y2(e);return t.register("authEvent",s=>(ye(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ef,{type:Ef},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Ef];o!==void 0&&t(!!o),or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=nV(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return LI()||kI()||Jm()}}const AV=xV;class dE{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Wr("unexpected MultiFactorSessionType")}}}class ug extends dE{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ug(e)}_finalizeEnroll(e,t,r){return a2(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return A2(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class SV{constructor(){}static assertion(e){return ug._fromCredential(e)}}SV.FACTOR_ID="phone";class PV{static assertionForEnrollment(e,t){return Vu._fromSecret(e,t)}static assertionForSignIn(e,t){return Vu._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const r=e;ye(typeof((t=r.user)===null||t===void 0?void 0:t.auth)<"u","internal-error");const s=await l2(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return cg._fromStartTotpMfaEnrollmentResponse(s,r.user.auth)}}PV.FACTOR_ID="totp";class Vu extends dE{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new Vu(t,void 0,e)}static _fromEnrollmentId(e,t){return new Vu(t,e)}async _finalizeEnroll(e,t,r){return ye(typeof this.secret<"u",e,"argument-error"),u2(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){ye(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return S2(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class cg{constructor(e,t,r,s,i,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new cg(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let s=!1;return(qc(e)||qc(t))&&(s=!0),s&&(qc(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),qc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function qc(n){return typeof n>"u"||(n==null?void 0:n.length)===0}var d_="@firebase/auth",h_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CV(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kV(n){Sa(new vo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:FI(n)},c=new sD(r,s,i,l);return fD(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Sa(new vo("auth-internal",e=>{const t=Qt(e.getProvider("auth").getImmediate());return(r=>new RV(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pi(d_,h_,CV(n)),pi(d_,h_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV=5*60,VV=G0("authIdTokenMaxAge")||DV;let f_=null;const NV=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>VV)return;const s=t==null?void 0:t.token;f_!==s&&(f_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function OV(n=Y0()){const e=Uu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=hD(n,{popupRedirectResolver:AV,persistence:[T2,XI,eE]}),r=G0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=NV(i.toString());r2(t,o,()=>o(t.currentUser)),n2(t,a=>o(a))}}const s=q0("auth");return s&&pD(t,`http://${s}`),t}function MV(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}iD({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Yn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",MV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kV("Browser");const LV={apiKey:"AIzaSyDCqJRmxKiIzuAhgXsmXICCx_O65aujNa0",authDomain:"impro-selector.firebaseapp.com",projectId:"impro-selector",storageBucket:"impro-selector.appspot.com",messagingSenderId:"730278491306",appId:"1:730278491306:web:c966af1179221e91118cd3",measurementId:"G-3NB062D088"},hE=J0(LV),le=uk(hE),qt=OV(hE);try{ck(le)}catch{}try{t2(qt,XI)}catch{}s2(qt,n=>{n||LD(qt)});async function FV(n,e){try{return(await zD(qt,n,e)).user}catch(t){throw t}}async function fE(n,e){try{return(await GD(qt,n,e)).user}catch(t){throw t}}async function pE(n){try{await jD(qt,n)}catch(e){throw e}}async function $V(n){try{const e=qt.currentUser;if(e)await QD(e,n);else throw new Error("Aucun utilisateur connecté")}catch(e){throw e}}const mi=Object.freeze(Object.defineProperty({__proto__:null,auth:qt,createPlayerAccount:FV,db:le,resetPlayerPassword:pE,signInPlayer:fE,updatePlayerPassword:$V},Symbol.toStringTag,{value:"Module"})),ul="seasons";async function UV(n,e,t){return await ec(He(le,ul),{name:n,slug:e,pinCode:t,createdAt:ol()})}async function jV(n){return await za(xe(le,ul,n))}async function Tf(){const n=Su(He(le,ul),vk("createdAt","desc"));return(await mt(n)).docs.map(t=>({id:t.id,...t.data()}))}async function Bd(n,e){const t=await En(xe(le,ul,n));return t.exists()?t.data().pinCode===e:!1}async function mp(n){const e=await En(xe(le,ul,n));return e.exists()?e.data().pinCode:null}async function Nl(n,e){const t=xe(le,ul,n);await il(t,{sortOrder:e})}const xf=7*24*60*60*1e3,Ol="impro_selector_pin_session";class BV{constructor(){this.sessionData=this.loadSession()}loadSession(){try{const e=localStorage.getItem(Ol);if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<xf){try{t.timestamp=Date.now(),localStorage.setItem(Ol,JSON.stringify(t))}catch{}return t}else this.clearSession()}}catch{console.error("Erreur lors du chargement de la session PIN")}return null}saveSession(e,t){try{const r={seasonId:e,pinCode:t,timestamp:Date.now()};localStorage.setItem(Ol,JSON.stringify(r)),this.sessionData=r}catch{console.error("Erreur lors de la sauvegarde de la session PIN")}}isPinCached(e){if(!this.sessionData)return!1;const t=this.sessionData.seasonId===e&&this.sessionData.timestamp&&Date.now()-this.sessionData.timestamp<xf;if(t)try{this.sessionData.timestamp=Date.now(),localStorage.setItem(Ol,JSON.stringify(this.sessionData))}catch{}return t}getCachedPin(e){return this.isPinCached(e)?this.sessionData.pinCode:null}clearSession(){try{localStorage.removeItem(Ol),this.sessionData=null}catch{console.error("Erreur lors de la suppression de la session PIN")}}getTimeRemaining(){if(!this.sessionData||!this.sessionData.timestamp)return 0;const e=Date.now()-this.sessionData.timestamp,t=xf-e;return Math.max(0,Math.ceil(t/(60*1e3)))}isExpiringSoon(){return this.getTimeRemaining()<=2}}const Tn=new BV,qV={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},zV={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},GV={class:"text-center mb-6"},KV={class:"text-gray-300"},HV={key:0,class:"mt-2 p-2 bg-green-900/20 border border-green-500/30 rounded-lg"},WV={class:"text-sm text-green-400"},QV={class:"mb-6"},JV={class:"mb-4"},YV={key:0,class:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-center"},XV={class:"flex justify-end space-x-3"},ZV=["disabled"],mE={__name:"PinModal",props:{show:{type:Boolean,default:!1},message:{type:String,default:"Veuillez saisir le code PIN à 4 chiffres"},error:{type:String,default:""},sessionInfo:{type:Object,default:null}},emits:["submit","cancel"],setup(n,{emit:e}){const t=n,r=e,s=O(""),i=O(""),o=O(null);Nt(()=>t.show,d=>{d&&(s.value="",i.value="",cn(()=>{var f;(f=o.value)==null||f.focus()}))});function a(){s.value=s.value.replace(/[^0-9]/g,""),s.value.length>4&&(s.value=s.value.slice(0,4))}function l(){s.value.length===4&&r("submit",s.value)}function c(){r("cancel")}return(d,f)=>n.show?(F(),$("div",qV,[h("div",zV,[h("div",GV,[f[1]||(f[1]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"🔒")],-1)),f[2]||(f[2]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Code d'accès requis",-1)),h("p",KV,ue(n.message),1),n.sessionInfo?(F(),$("div",HV,[h("p",WV," Session active : "+ue(n.sessionInfo.timeRemaining)+" min restantes ",1)])):ce("",!0)]),h("div",QV,[h("div",JV,[f[3]||(f[3]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN",-1)),Ze(h("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g),type:"password",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-center text-2xl font-mono tracking-widest",placeholder:"••••",onInput:a,onKeydown:[On(l,["enter"]),On(c,["escape"])],ref_key:"pinInput",ref:o},null,544),[[xt,s.value]])]),f[4]||(f[4]=h("p",{class:"text-xs text-gray-400 text-center"},"Tapez directement votre code PIN à 4 chiffres",-1))]),i.value||t.error?(F(),$("div",YV,ue(i.value||t.error),1)):ce("",!0),h("div",XV,[h("button",{onClick:c,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:l,disabled:s.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Valider ",8,ZV)])])])):ce("",!0)}},eN={class:"relative p-6 pb-4 border-b border-white/10"},tN={class:"sticky bottom-0 p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex justify-end"},gE={__name:"AppHelpModal",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=e;return(r,s)=>n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[95] p-0 md:p-4",onClick:s[3]||(s[3]=i=>t("close"))},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:s[2]||(s[2]=Vt(()=>{},["stop"]))},[h("div",eN,[h("button",{onClick:s[0]||(s[0]=i=>t("close")),title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),s[4]||(s[4]=h("div",{class:"flex items-center gap-3"},[h("div",{class:"w-12 h-12 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-2xl"},"❓"),h("div",null,[h("h2",{class:"text-xl md:text-2xl font-bold text-white"},"Kezako ?"),h("p",{class:"text-sm text-purple-300"},"L'appli pour sélectionner les joueurs d'impro de manière simple et apaisée")])],-1))]),s[5]||(s[5]=nr('<div class="px-4 md:px-6 py-4 md:py-6 overflow-y-auto space-y-4 text-gray-200"><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-3"><h3 class="text-white font-semibold">C&#39;est quoi ?</h3><p> Tu joues quand ? est une appli conçue pour faciliter <span class="text-white">la sélection des joueurs d&#39;impro</span> pour les spectacles. L&#39;idée est née au sein de <span class="text-purple-300">La Malice</span> pour <span class="text-white">dépersonnaliser une tâche délicate</span> qui créait des tensions depuis des années. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-3"><h3 class="text-white font-semibold">Comment ça marche</h3><p> L&#39;asso déclare ses dates et le nombre de personnes nécessaires. Les joueurs indiquent leurs disponibilités. L&#39;appli propose des sélections. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Sélection auto ou manuelle</h3><p> Le <span class="text-white">mode sélection auto</span> s&#39;appuie sur le hasard (pondéré) pour simplifier la vie. Vous pouvez aussi repasser en mode <span class="text-white">manuel</span> si besoin. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Pensée mobile • Libre d&#39;utilisation</h3><p> L&#39;appli est <span class="text-white">pensée pour le mobile</span> et peut être utilisée librement par La Malice ou <span class="text-white">toute autre troupe</span>. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Comptes (facultatif)</h3><p> Les joueurs qui le souhaitent peuvent créer un compte via leur email pour <span class="text-white">recevoir des notifications</span>, <span class="text-white">protéger leurs saisies</span> et bénéficier d&#39;un meilleur confort d&#39;utilisation. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2 text-sm"><h3 class="text-white font-semibold">Statut &amp; licence</h3><p> Application <span class="text-white">en cours de développement</span>, <span class="text-white">sans garanties</span> à ce stade. Licence libre <span class="text-white">MIT</span>. </p><p>Contact &amp; retours : <a href="mailto:impropick@gmail.com" class="text-blue-300 underline">impropick@gmail.com</a></p></div></div>',1)),h("div",tN,[h("button",{onClick:s[1]||(s[1]=i=>t("close")),class:"h-10 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600"},"Compris")])])])):ce("",!0)}},nN=["pin","pinCode","password","motdepasse","mdp","token","oobCode","apiKey","apikey","key","secret","authorization","auth","bearer"];function rN(){var t,r,s,i;const n=((r=(t=import.meta)==null?void 0:t.env)==null?void 0:r.MODE)==="development"?"debug":"warn";return((i=(s=import.meta)==null?void 0:s.env)==null?void 0:i.VITE_LOG_LEVEL)||n}function vE(n){switch(n){case"debug":return 10;case"info":return 20;case"warn":return 30;case"error":return 40;case"silent":return 100;default:return 30}}function sN(n){return typeof n!="string"?n:n.length<=2?"••":n.length>=8?`${n.slice(0,2)}••••${n.slice(-2)}`:"••••"}function yE(n){if(!n)return!1;const e=String(n).toLowerCase();return nN.some(t=>e.includes(t.toLowerCase()))}function gp(n){if(n==null)return n;if(typeof n=="string"){if(n.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){const[r,s]=n.split("@"),i=r.length<=2?"••":`${r.slice(0,2)}••`,o=s.split("."),a=o[0].length<=2?"••":`${o[0].slice(0,2)}••`;return`${i}@${a}.${o.slice(1).join(".")}`}return n.length>=12&&!/\s/.test(n)?sN(n):n}if(typeof n=="number"){const e=String(n);return/^\d{4,6}$/.test(e)?"••••":n}if(Array.isArray(n))return n.map(e=>gp(e));if(typeof n=="object"){const e={};for(const[t,r]of Object.entries(n))e[t]=yE(t)?"••••":gp(r);return e}return n}function iN(n){const e=[];for(let t=0;t<n.length;t+=1){const r=n[t],s=t>0?n[t-1]:null;if(typeof s=="string"&&yE(s)&&(typeof r=="string"||typeof r=="number")){e.push("••••");continue}e.push(gp(r))}return e}const oN=vE(rN());function zc(n,e){const t=vE(n);return(...r)=>{if(t<oN)return;const s=iN(r);console[e](...s)}}const ge={debug:zc("debug","log"),info:zc("info","info"),warn:zc("warn","warn"),error:zc("error","error")};let qn="mock",gi=[{id:"p1",name:"Alice"},{id:"p2",name:"Bob"},{id:"p3",name:"Charlie"},{id:"p4",name:"David"},{id:"p5",name:"Eva"},{id:"p6",name:"Fanny"},{id:"p7",name:"Georges"},{id:"p8",name:"Hélène"},{id:"p9",name:"Ismaël"},{id:"p10",name:"Jade"},{id:"p11",name:"Karim"},{id:"p12",name:"Léa"},{id:"p13",name:"Marc"},{id:"p14",name:"Nina"},{id:"p15",name:"Oscar"}],So=[{id:"event1",title:"Apérock Septembre",date:"2025-09-08",description:"Soirée apéro-rock avec ambiance festive"},{id:"event2",title:"Match à Cambo",date:"2025-11-25",description:"Match d'improvisation compétitif à Cambo-les-Bains"},{id:"event3",title:"Impro des Familles",date:"2025-12-02",description:"Spectacle d'improvisation pour toute la famille"},{id:"event4",title:"Cabaret Surprise",date:"2026-01-20",description:"Cabaret avec des surprises et des performances uniques"},{id:"event5",title:"Impro Plage",date:"2026-03-10",description:"Improvisation en plein air avec vue sur la plage"}];function _E(n){qn=n}async function aN(){if(qn!=="firebase"||!(await mt(He(le,"seasons"))).empty)return;const e=xe(He(le,"seasons"));await pn(e,{name:"Malice 2025-2026",slug:"malice-2025-2026",createdAt:ol()});const t=await mt(He(le,"players"));for(const o of t.docs)await pn(xe(e,"players",o.id),o.data());const r=await mt(He(le,"events"));for(const o of r.docs)await pn(xe(e,"events",o.id),o.data());const s=await mt(He(le,"availability"));for(const o of s.docs)await pn(xe(e,"availability",o.id),o.data());const i=await mt(He(le,"selections"));for(const o of i.docs)await pn(xe(e,"selections",o.id),o.data())}async function lN(){qn==="firebase"&&await aN()}async function vp(n=null){return(qn==="firebase"?n?(await mt(He(le,"seasons",n,"events"))).docs.map(t=>({id:t.id,...t.data()})):(await mt(He(le,"events"))).docs.map(t=>({id:t.id,...t.data()})):So).sort((t,r)=>{const s=c=>{if(!c)return null;if(c instanceof Date)return c;if(typeof(c==null?void 0:c.toDate)=="function")return c.toDate();const d=new Date(c);return isNaN(d.getTime())?null:d},i=s(t.date),o=s(r.date),a=i?i.getTime():Number.POSITIVE_INFINITY,l=o?o.getTime():Number.POSITIVE_INFINITY;return a!==l?a-l:(t.title||"").localeCompare(r.title||"","fr",{sensitivity:"base"})})}async function dd(n=null){return(qn==="firebase"?n?(await mt(He(le,"seasons",n,"players"))).docs.map(t=>({id:t.id,...t.data()})):(await mt(He(le,"players"))).docs.map(t=>({id:t.id,...t.data()})):gi).sort((t,r)=>t.order<r.order?-1:t.order>r.order?1:t.name.localeCompare(r.name))}async function bE(n,e=null){if(qn==="firebase"){const t=xe(e?He(le,"seasons",e,"players"):He(le,"players"));return await pn(t,{name:n}),t.id}else{const t=`p${gi.length+1}`;return gi.push({id:t,name:n}),t}}async function uN(n,e=null){if(qn==="firebase"){const t=e?xe(le,"seasons",e,"players",n):xe(le,"players",n);await za(t);const r=e?await mt(He(le,"seasons",e,"availability")):await mt(He(le,"availability")),s=qm(le);r.forEach(i=>{const o=i.data();if(o[n]!==void 0){const a={...o};delete a[n],s.update(i.ref,a)}}),await s.commit()}else gi=gi.filter(t=>t.id!==n)}async function cN(n,e,t=null){if(qn==="firebase"){const r=t?xe(le,"seasons",t,"players",n):xe(le,"players",n),s=await En(r),i=s.exists()&&s.data().name||null;if(await pn(r,{name:e},{merge:!0}),i&&i!==e){const o=qm(le);try{const a=t?xe(le,"seasons",t,"availability",i):xe(le,"availability",i),l=await En(a);if(l.exists()){const c=l.data()||{},d=t?xe(le,"seasons",t,"availability",e):xe(le,"availability",e);o.set(d,c,{merge:!0}),o.delete(a)}}catch{}try{const a=t?He(le,"seasons",t,"selections"):He(le,"selections");(await mt(a)).forEach(c=>{var f;const d=Array.isArray((f=c.data())==null?void 0:f.players)?c.data().players:[];if(d.includes(i)){const g=d.map(y=>y===i?e:y);o.update(c.ref,{players:g})}})}catch{}await o.commit()}}else{const r=gi.findIndex(s=>s.id===n);r!==-1&&(gi[r]={...gi[r],name:e})}}async function ro(n,e,t=null){if(qn==="firebase"){const r=t?await mt(He(le,"seasons",t,"availability")):await mt(He(le,"availability")),s={};return r.forEach(i=>{s[i.id]=i.data()}),s}else{const r={};return n.forEach(s=>{r[s.name]={},e.forEach(i=>{r[s.name][i.id]=void 0})}),e.forEach(s=>{const i=[...n].sort(()=>.5-Math.random());i.slice(0,4).forEach(o=>{r[o.name][s.id]=!0}),i.slice(4).forEach(o=>{const a=Math.random();r[o.name][s.id]=a<.4?!0:a<.8?!1:void 0})}),r}}async function so(n=null){if(qn==="firebase"){const e=n?await mt(He(le,"seasons",n,"selections")):await mt(He(le,"selections")),t={};return e.forEach(r=>{t[r.id]=r.data().players||[]}),t}else return{}}async function p_(n,e,t=null){if(qn==="firebase"){const r=t?xe(le,"seasons",t,"availability",n):xe(le,"availability",n);await pn(r,e)}}async function dN({seasonId:n,playerName:e,eventId:t,value:r}){if(qn!=="firebase")return;const s=n?xe(le,"seasons",n,"availability",e):xe(le,"availability",e),i=await En(s),a={...i.exists()?i.data():{}};r===void 0?delete a[t]:a[t]=r,await pn(s,a)}async function m_(n,e,t=null){if(qn==="firebase"){const r=t?xe(le,"seasons",t,"selections",n):xe(le,"selections",n);await pn(r,{players:e})}}async function hN(n,e=null){if(ge.info("Suppression de l'événement",{eventId:n}),qn==="firebase")try{ge.debug("Suppression de l'événement dans Firestore");const t=e?xe(le,"seasons",e,"events",n):xe(le,"events",n);await za(t),ge.debug("Suppression de la sélection associée");const r=e?xe(le,"seasons",e,"selections",n):xe(le,"selections",n);await za(r),ge.debug("Suppression des disponibilités");const s=e?await mt(He(le,"seasons",e,"availability")):await mt(He(le,"availability")),i=qm(le);s.forEach(o=>{const a=o.data();if(a[n]!==void 0){ge.debug("Mise à jour de la disponibilité pour un joueur");const l={...a};delete l[n],i.update(o.ref,l)}}),await i.commit(),ge.info("Opérations de suppression terminées avec succès")}catch(t){throw ge.error("Erreur lors de la suppression",t),t}else So=So.filter(t=>t.id!==n)}async function fN(n,e=null){if(qn==="firebase"){const t=xe(e?He(le,"seasons",e,"events"):He(le,"events"));return await pn(t,n),t.id}else{const t=`event${So.length+1}`;return So.push({id:t,...n}),t}}async function g_(n,e,t=null){if(qn==="firebase"){const r=t?xe(le,"seasons",t,"events",n):xe(le,"events",n);await pn(r,e,{merge:!0})}else{const r=So.findIndex(s=>s.id===n);r!==-1&&(So[r]={id:n,...e})}}const pN={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},mN={class:"text-center py-16 px-4 relative"},gN=["aria-busy"],vN={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto animate-pulse"},yN={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto"},_N=["onClick"],bN={class:"text-2xl font-bold text-white mb-4 group-hover:text-purple-300 transition-colors"},wN={class:"absolute top-4 right-4"},IN=["onClick","aria-expanded"],EN={key:0,class:"absolute right-0 mt-2 w-44 bg-gray-900 border border-white/10 rounded-lg shadow-xl py-1 z-10",role:"menu"},TN=["onClick"],xN=["onClick"],AN=["onClick"],SN=["onClick"],PN={key:2,class:"flex justify-center mt-12"},RN={key:3,class:"text-center py-16"},CN={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},kN={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},DN={class:"mb-6"},VN={class:"mb-6"},NN={class:"mb-6"},ON={class:"flex justify-end space-x-3"},MN=["disabled"],LN={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},FN={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},$N={class:"text-center mb-6"},UN={class:"text-gray-300"},jN={__name:"Home",setup(n){const e=O([]),t=O(!0),r=Fu(),s=O(null),i=O(!1),o=O(!1),a=O(""),l=O(""),c=O(""),d=O(null),f=O(!1),g=O(null),y=O(""),x=O(!1);br(async()=>{var k;try{e.value=await Tf(),ge.info("Saisons chargées",{count:((k=e.value)==null?void 0:k.length)||0}),D().catch(L=>ge.error("Migration sortOrder échouée",L))}finally{t.value=!1}});const S=$e(()=>[...e.value].sort((k,L)=>{var E,A;const J=typeof k.sortOrder=="number"?k.sortOrder:Number.MAX_SAFE_INTEGER,X=typeof L.sortOrder=="number"?L.sortOrder:Number.MAX_SAFE_INTEGER;if(J!==X)return J-X;const Pe=(E=k.createdAt)!=null&&E.toMillis?k.createdAt.toMillis():0,Oe=(A=L.createdAt)!=null&&A.toMillis?L.createdAt.toMillis():0;return Pe!==Oe?Oe-Pe:(k.name||"").localeCompare(L.name||"")}));function P(k){r.push(`/season/${k}`)}function j(k){s.value=s.value===k?null:k}function U(){s.value=null}async function D(){if(!e.value.length)return;const k=e.value.map(J=>typeof J.sortOrder=="number"?J.sortOrder:null).filter(J=>J!==null);let L=k.length?Math.max(...k):0;for(const J of e.value)if(typeof J.sortOrder!="number"){L+=1;try{await Nl(J.id,L),J.sortOrder=L}catch(X){ge.error("Erreur migration sortOrder",{seasonName:J==null?void 0:J.name,error:X})}}}async function G(k){try{if(!(k!=null&&k.id)){alert("Saison introuvable");return}const[L,J]=await Promise.all([vp(k.id),dd(k.id)]),[X,Pe]=await Promise.all([ro(J,L,k.id),so(k.id)]),Oe=["Joueur",...L.map(de=>me(de))],E=[];for(const de of J){const he=(de==null?void 0:de.name)||"",ae=(X==null?void 0:X[he])||{},Ee=[he,...L.map(we=>N(ae[we.id],Pe==null?void 0:Pe[we.id],he))];E.push(Ee)}const A=w([Oe,...E]),M=new Blob(["\uFEFF"+A],{type:"text/csv;charset=utf-8;"}),ee=(k==null?void 0:k.name)||(k==null?void 0:k.slug)||"saison",Y=`${C(ee)}-disponibilites.csv`,te=URL.createObjectURL(M),ve=document.createElement("a");ve.href=te,ve.download=Y,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),URL.revokeObjectURL(te),ge.info("Export CSV saison",{seasonId:k.id,events:L.length,players:J.length})}catch(L){ge.error("Erreur export CSV",L),alert("Erreur lors de l'export CSV. Veuillez réessayer.")}}function Z(k){if(!k)return null;if(k instanceof Date)return k;if(typeof(k==null?void 0:k.toDate)=="function")return k.toDate();if(typeof k=="string"||typeof k=="number"){const L=new Date(k);return isNaN(L.getTime())?null:L}return null}function me(k){const L=Z(k==null?void 0:k.date),J=L?`${L.getFullYear()}-${String(L.getMonth()+1).padStart(2,"0")}-${String(L.getDate()).padStart(2,"0")}`:"",X=(k==null?void 0:k.title)||"Sans titre";return`${J} · ${X}`.trim()}function T(k){return k===!0||k==="oui"?"disponible":k===!1||k==="non"?"non disponible":""}function w(k){return k.map(L=>L.map(I).join(",")).join(`
`)}function I(k){const L=String(k??"");return/[",\n\r]/.test(L)?'"'+L.replace(/"/g,'""')+'"':L}function C(k){return String(k||"").normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\-_. ]+/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$|^\.+|\.+$/g,"")||"fichier"}function N(k,L,J){return Array.isArray(L)&&L.includes(J)?k===!1||k==="non"?"non disponible":"sélectionné":T(k)}async function B(k){if(U(),k<=0)return;const L=[...S.value],J=L[k],X=L[k-1],Pe=J.sortOrder;J.sortOrder=X.sortOrder,X.sortOrder=Pe;try{await Promise.all([Nl(J.id,J.sortOrder),Nl(X.id,X.sortOrder)])}catch(Oe){ge.error("Erreur lors du déplacement vers le haut",Oe)}}async function R(k){U();const L=[...S.value];if(k>=L.length-1)return;const J=L[k],X=L[k+1],Pe=J.sortOrder;J.sortOrder=X.sortOrder,X.sortOrder=Pe;try{await Promise.all([Nl(J.id,J.sortOrder),Nl(X.id,X.sortOrder)])}catch(Oe){ge.error("Erreur lors du déplacement vers le bas",Oe)}}function Pt(){a.value&&(l.value=a.value.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}function Et(){c.value=c.value.replace(/[^0-9]/g,""),c.value.length>4&&(c.value=c.value.slice(0,4))}async function Xe(){if(!a.value.trim()||!l.value.trim()||!c.value.trim()){alert("Veuillez remplir tous les champs, y compris le code PIN à 4 chiffres");return}if(c.value.length!==4){alert("Le code PIN doit contenir exactement 4 chiffres");return}try{await UV(a.value.trim(),l.value.trim(),c.value.trim()),e.value=await Tf(),await D(),Le()}catch(k){ge.error("Erreur lors de la création de la saison",k),alert("Erreur lors de la création de la saison. Veuillez réessayer.")}}function Le(){i.value=!1,a.value="",l.value="",c.value=""}function Ue(k){d.value=k,o.value=!0}async function hn(){o.value=!1,await fe({type:"deleteSeason",data:{seasonId:d.value.id,seasonName:d.value.name}})}function rn(){o.value=!1,d.value=null}function Rt(){return g.value?{deleteSeason:"Suppression de saison - Code PIN requis"}[g.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function fe(k){if(Tn.isPinCached(d.value.id)){const L=Tn.getCachedPin(d.value.id);if(ge.debug("PIN en cache trouvé, utilisation automatique"),await Bd(d.value.id,L)){await dt(k);return}else Tn.clearSession()}g.value=k,f.value=!0}async function oe(k){var L,J,X,Pe;ge.debug("PIN soumis pour l'opération",{operationType:(L=g.value)==null?void 0:L.type});try{const Oe=((X=(J=g.value)==null?void 0:J.data)==null?void 0:X.seasonId)||((Pe=d.value)==null?void 0:Pe.id),E=await Bd(Oe,k);if(ge.debug("PIN validé",{valid:E}),E){Tn.saveSession(Oe,k),ge.debug("PIN correct, fermeture de la modal et exécution de l'opération"),f.value=!1;const A=g.value;g.value=null,ge.debug("Appel de executePendingOperation",{operationType:A==null?void 0:A.type}),await dt(A)}else y.value="Code PIN incorrect",setTimeout(()=>{y.value=""},3e3)}catch(Oe){ge.error("Erreur lors de la vérification du PIN",Oe),y.value="Erreur lors de la vérification du code PIN"}}function ze(){f.value=!1,g.value=null,y.value=""}function rt(){return d.value&&Tn.isPinCached(d.value.id)?{timeRemaining:Tn.getTimeRemaining(),isExpiringSoon:Tn.isExpiringSoon()}:null}async function dt(k){var X;if(ge.debug("executePendingOperation appelé",{hasOperation:!!k}),!k){ge.warn("Aucune opération à exécuter");return}const{type:L,data:J}=k;ge.info("Exécution de l'opération",{type:L});try{switch(L){case"deleteSeason":ge.info("Suppression de la saison",{seasonId:J.seasonId}),await jV(J.seasonId),ge.info("Saison supprimée, rechargement de la liste"),e.value=await Tf(),ge.info("Liste des saisons rechargée",{count:((X=e.value)==null?void 0:X.length)||0});break;default:ge.warn("Type d'opération non reconnu",{type:L})}}catch(Pe){ge.error("Erreur lors de l'exécution de l'opération",Pe),alert("Erreur lors de l'opération. Veuillez réessayer.")}}return(k,L)=>{var J;return F(),$("div",pN,[h("div",mN,[h("button",{onClick:L[0]||(L[0]=X=>x.value=!0),class:"absolute right-4 top-4 text-white/90 hover:text-white p-2 rounded-full hover:bg-white/10",title:"Kezako ?","aria-label":"Kezako ?"},L[8]||(L[8]=[h("span",{class:"text-2xl"},"❓",-1)])),L[9]||(L[9]=h("h1",{class:"text-6xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent animate-pulse"}," Tu joues quand ? ",-1)),L[10]||(L[10]=h("p",{class:"text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed"},"Arrêtez de vous prendre la tête pour savoir qui sera sur scène quand. Laissez chacun indiquer ses dispos et le hasard choisir pour vous !",-1))]),h("div",{class:"container mx-auto px-4 pb-16","aria-busy":t.value},[t.value?(F(),$("div",vN,[(F(),$(vt,null,ur(8,X=>h("div",{key:"skeleton-"+X,class:"bg-gradient-to-br from-white/10 to-white/5 border border-white/10 rounded-2xl p-8"},L[11]||(L[11]=[h("div",{class:"w-16 h-16 bg-white/10 rounded-full mx-auto mb-6"},null,-1),h("div",{class:"h-6 bg-white/10 rounded mb-4 w-2/3 mx-auto"},null,-1),h("div",{class:"h-px bg-white/10 mb-4"},null,-1),h("div",{class:"h-4 bg-white/10 rounded w-1/2 mx-auto"},null,-1)]))),64))])):e.value.length>0?(F(),$("div",yN,[(F(!0),$(vt,null,ur(S.value,(X,Pe)=>(F(),$("div",{key:X.id,class:"group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm border border-white/20 rounded-2xl p-8 transition-all duration-300 hover:shadow-2xl hover:shadow-purple-500/20"},[h("div",{onClick:Oe=>P(X.slug),class:"text-center cursor-pointer"},[L[12]||(L[12]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg"},[h("span",{class:"text-2xl"},"🎭")],-1)),h("h2",bN,ue(X.name),1),L[13]||(L[13]=h("div",{class:"w-full bg-gradient-to-r from-transparent via-white/20 to-transparent h-px mb-4"},null,-1)),L[14]||(L[14]=h("p",{class:"text-gray-300 text-sm"}," Cliquez pour accéder ",-1))],8,_N),h("div",wN,[h("div",{class:"relative",onClick:L[1]||(L[1]=Vt(()=>{},["stop"]))},[h("button",{onClick:Oe=>j(Pe),class:"p-1 rounded-full text-gray-300 hover:text-white hover:bg-white/10","aria-expanded":s.value===Pe,"aria-haspopup":"true",title:"Options"},L[15]||(L[15]=[h("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.75a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"})],-1)]),8,IN),s.value===Pe?(F(),$("div",EN,[h("button",{onClick:Oe=>{G(X),U()},class:"w-full text-left px-4 py-2 text-sm text-emerald-300 hover:bg-white/10",role:"menuitem"}," Exporter CSV ",8,TN),L[16]||(L[16]=h("div",{class:"border-t border-white/10 my-1"},null,-1)),h("button",{onClick:Oe=>B(Pe),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Monter ",8,xN),h("button",{onClick:Oe=>R(Pe),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Descendre ",8,AN),L[17]||(L[17]=h("div",{class:"border-t border-white/10 my-1"},null,-1)),h("button",{onClick:Oe=>Ue(X),class:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-red-500/10",role:"menuitem"}," Supprimer ",8,SN)])):ce("",!0)])])]))),128))])):ce("",!0),!t.value&&e.value.length>0?(F(),$("div",PN,[h("button",{onClick:L[2]||(L[2]=X=>i.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-2xl hover:shadow-pink-500/25 transition-all duration-300 transform hover:scale-105"}," ✨ Nouvelle saison ")])):ce("",!0),!t.value&&e.value.length===0?(F(),$("div",RN,[L[18]||(L[18]=h("div",{class:"w-24 h-24 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[h("span",{class:"text-4xl"},"🎪")],-1)),L[19]||(L[19]=h("h3",{class:"text-2xl font-bold text-white mb-4"},"Aucune saison créée",-1)),L[20]||(L[20]=h("p",{class:"text-gray-300 mb-8"},"Commencez par créer votre première saison de spectacles !",-1)),h("button",{onClick:L[3]||(L[3]=X=>i.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-xl hover:shadow-pink-500/25 transition-all duration-300"}," Créer ma première saison ")])):ce("",!0)],8,gN),i.value?(F(),$("div",CN,[h("div",kN,[L[25]||(L[25]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvelle saison",-1)),h("div",DN,[L[21]||(L[21]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom de la saison",-1)),Ze(h("input",{"onUpdate:modelValue":L[4]||(L[4]=X=>a.value=X),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: La Malice 2025-2026",onInput:Pt},null,544),[[xt,a.value]])]),h("div",VN,[L[22]||(L[22]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Slug (URL)",-1)),Ze(h("input",{"onUpdate:modelValue":L[5]||(L[5]=X=>l.value=X),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: malice-2025-2026"},null,512),[[xt,l.value]])]),h("div",NN,[L[23]||(L[23]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN (4 chiffres)",-1)),Ze(h("input",{"onUpdate:modelValue":L[6]||(L[6]=X=>c.value=X),type:"text",inputmode:"numeric",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"1234",onInput:Et},null,544),[[xt,c.value]]),L[24]||(L[24]=h("p",{class:"text-xs text-gray-400 mt-1"},"Ce code protégera les opérations sensibles (suppressions, sélections)",-1))]),h("div",ON,[h("button",{onClick:Le,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Xe,disabled:!a.value.trim()||!l.value.trim()||!c.value.trim()||c.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Créer ",8,MN)])])])):ce("",!0),o.value?(F(),$("div",LN,[h("div",FN,[h("div",$N,[L[26]||(L[26]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"⚠️")],-1)),L[27]||(L[27]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Confirmation",-1)),h("p",UN,'Êtes-vous sûr de vouloir supprimer la saison "'+ue((J=d.value)==null?void 0:J.name)+'" ?',1)]),L[28]||(L[28]=h("p",{class:"mb-6 text-sm text-red-400 bg-red-900/20 p-3 rounded-lg border border-red-500/20"}," ⚠️ Cette action est irréversible et supprimera toutes les données de cette saison. ",-1)),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:rn,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:hn,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):ce("",!0),ut(mE,{show:f.value,message:Rt(),error:y.value,"session-info":rt(),onSubmit:oe,onCancel:ze},null,8,["show","message","error","session-info"]),ut(gE,{show:x.value,onClose:L[7]||(L[7]=X=>x.value=!1)},null,8,["show"]),L[29]||(L[29]=nr('<footer class="mt-16 border-t border-white/10"><div class="container mx-auto px-4 py-6 text-center text-xs text-gray-400"><span>© Patrice Lamarque 2025</span><span class="mx-2">•</span><span>Licence MIT</span><span class="mx-2">•</span><a href="https://github.com/plamarque/impro-selector" target="_blank" rel="noopener noreferrer" class="underline decoration-white/20 hover:decoration-white/40 hover:text-gray-200">GitHub</a></div></footer>',1))])}}},BN="modulepreload",qN=function(n){return"/"+n},v_={},Yt=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=qN(i),i in v_)return;v_[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":BN,o||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),o)return new Promise((d,f)=>{c.addEventListener("load",d),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Mh="magicLinks";function Lh({seasonId:n,playerId:e,eventId:t,action:r}){return`${n}__${e}__${t}__${r}`}function dg(n=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let r=0;r<n;r++)t+=e[Math.floor(Math.random()*e.length)];return t}async function yp({seasonId:n,playerId:e,eventId:t,action:r}){const s=Lh({seasonId:n,playerId:e,eventId:t,action:r}),i=dg(40),o=xe(le,Mh,s),a=Date.now()+1e3*60*60*24*7;await pn(o,{seasonId:n,playerId:e,eventId:t,token:i,action:r,expiresAt:a});const c=`${window.location.origin+"/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&eid=${encodeURIComponent(t)}&t=${encodeURIComponent(i)}&a=${encodeURIComponent(r)}`;return{id:s,token:i,url:c}}async function wE({seasonId:n,playerId:e,email:t}){const r="protection",s="verify_email",i=Lh({seasonId:n,playerId:e,eventId:r,action:s}),o=dg(40),a=xe(le,Mh,i),l=Date.now()+1e3*60*60*24*7;await pn(a,{seasonId:n,playerId:e,eventId:r,token:o,action:s,email:t,expiresAt:l});const d=`${window.location.origin+"/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&t=${encodeURIComponent(o)}&a=${encodeURIComponent(s)}`;return{id:i,token:o,url:d}}async function IE({seasonId:n,playerId:e,eventId:t,token:r,action:s}){const i=Lh({seasonId:n,playerId:e,eventId:t,action:s}),o=xe(le,Mh,i),a=await En(o);if(!a.exists())return{valid:!1,reason:"not_found"};const l=a.data();return l.token!==r?{valid:!1,reason:"token_mismatch"}:l.action!==s?{valid:!1,reason:"action_mismatch"}:typeof l.expiresAt=="number"&&Date.now()>l.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:l}}async function _p({seasonId:n,playerId:e,eventId:t,action:r}){const s=Lh({seasonId:n,playerId:e,eventId:t,action:r}),i=xe(le,Mh,s);await za(i)}const hg="accountMagicLinks";function Fh(n){return`account__${n}`}async function EE({currentEmail:n,newEmail:e}){const t=dg(40),r=Fh(t),s=xe(le,hg,r),i=Date.now()+1e3*60*60*24*7;await pn(s,{token:t,currentEmail:n,newEmail:e,action:"account_email_update",expiresAt:i});const a=`${window.location.origin+"/"}magic?a=account_email_update&t=${encodeURIComponent(t)}`;return{id:r,token:t,url:a}}async function TE({token:n}){const e=Fh(n),t=xe(le,hg,e),r=await En(t);if(!r.exists())return{valid:!1,reason:"not_found"};const s=r.data();return s.token!==n?{valid:!1,reason:"token_mismatch"}:typeof s.expiresAt=="number"&&Date.now()>s.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:s}}async function xE({token:n}){const e=Fh(n),t=xe(le,hg,e);await za(t)}const zN=Object.freeze(Object.defineProperty({__proto__:null,buildAccountId:Fh,consumeAccountEmailUpdateLink:xE,consumeMagicLink:_p,createAccountEmailUpdateLink:EE,createEmailVerificationLink:wE,createMagicLink:yp,verifyAccountEmailUpdateLink:TE,verifyMagicLink:IE},Symbol.toStringTag,{value:"Module"})),y_="impro_selector_trusted_players",__=180*24*60*60*1e3;class GN{constructor(){this.trustedMap=this.load()}load(){try{const e=localStorage.getItem(y_);if(!e)return{};const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}}persist(){try{localStorage.setItem(y_,JSON.stringify(this.trustedMap))}catch{}}isPasswordCached(e){if(!e)return!1;const t=this.trustedMap[e];if(!t)return!1;const r=Date.now(),s=r-t<__;return s?(this.trustedMap[e]=r,this.persist()):(delete this.trustedMap[e],this.persist()),s}getCachedPassword(e){return null}saveSession(e,t){e&&(this.trustedMap[e]=Date.now(),this.persist())}clearSession(e){e&&(delete this.trustedMap[e],this.persist())}clearExpiredSessions(){const e=Date.now();let t=!1;for(const[r,s]of Object.entries(this.trustedMap))e-s>__&&(delete this.trustedMap[r],t=!0);t&&this.persist()}clearAllSessions(){this.trustedMap={},this.persist()}}const Pi=new GN;function fg(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return e.toString()}function AE(n){return`seasonPreferredPlayer:${n||"global"}`}function bp(n,e){try{const t=AE(n),r=localStorage.getItem(t);if(!r){localStorage.setItem(t,JSON.stringify([e]));return}if(r.startsWith("[")){const s=JSON.parse(r);s.includes(e)||(s.push(e),localStorage.setItem(t,JSON.stringify(s)))}else r!==e&&localStorage.setItem(t,JSON.stringify([r,e]))}catch{}}function KN(n,e){try{const t=AE(n),r=localStorage.getItem(t);if(!r)return;if(r.startsWith("[")){const s=JSON.parse(r).filter(i=>i!==e);s.length===0?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(s))}else r===e&&localStorage.removeItem(t)}catch{}}async function SE(n,e,t,r=null){try{ge.info("Début protectPlayer",{playerId:n,seasonId:r});const s=await cl(n,r);if(s&&s.isProtected)throw new Error("Ce joueur est déjà protégé");const{collection:i,query:o,where:a,getDocs:l}=await Yt(()=>import("./index.esm-957a8d5d.js"),[]),{db:c}=await Yt(()=>Promise.resolve().then(()=>mi),void 0),d=r?i(c,"seasons",r,"playerProtection"):i(c,"playerProtection"),f=o(d,a("email","==",e)),g=await l(f);if(!g.empty&&g.docs.find(D=>D.id!==n))throw new Error("Cette adresse email est déjà utilisée par un autre joueur");ge.debug("Création du compte Firebase Auth...");const{createUserWithEmailAndPassword:y}=await Yt(()=>import("./index.esm-640473df.js"),[]),{auth:x}=await Yt(()=>Promise.resolve().then(()=>mi),void 0),S=await y(x,e,t);ge.info("Compte Firebase Auth créé",{uid:S.user.uid});const P=fg(t),j=r?xe(c,"seasons",r,"playerProtection",n):xe(c,"playerProtection",n);return await pn(j,{playerId:n,email:e,passwordHash:P,firebaseUid:S.user.uid,isProtected:!0,createdAt:new Date}),ge.info("Protection sauvegardée dans Firestore"),r&&bp(r,n),{success:!0}}catch(s){throw ge.error("Erreur lors de la protection du joueur",s),s}}async function PE({playerId:n,email:e,seasonId:t=null}){const r=t?xe(le,"seasons",t,"playerProtection",n):xe(le,"playerProtection",n);(await En(r)).exists()?await il(r,{email:e,updatedAt:new Date}):await pn(r,{playerId:n,email:e,isProtected:!1,createdAt:new Date});const{url:i}=await wE({seasonId:t,playerId:n,email:e});return{success:!0,url:i}}async function RE({playerId:n,seasonId:e=null}){const t=e?xe(le,"seasons",e,"playerProtection",n):xe(le,"playerProtection",n);if(!(await En(t)).exists())throw new Error("Protection introuvable");return await il(t,{emailVerifiedAt:new Date}),{success:!0}}async function CE({playerId:n,seasonId:e=null}){const t=e?xe(le,"seasons",e,"playerProtection",n):xe(le,"playerProtection",n);return await il(t,{emailVerifiedAt:null}),{success:!0}}async function kE(n,e=null){try{const t=e?xe(le,"seasons",e,"playerProtection",n):xe(le,"playerProtection",n);return await pn(t,{playerId:n,email:"",isProtected:!1,emailVerifiedAt:null,updatedAt:new Date}),e&&KN(e,n),{success:!0,email:""}}catch(t){throw ge.error("Erreur lors de la suppression de la protection",t),t}}async function vi(n,e=null){try{const t=e?xe(le,"seasons",e,"playerProtection",n):xe(le,"playerProtection",n),r=await En(t);return r.exists()?r.data().isProtected===!0:!1}catch(t){return ge.error("Erreur lors de la vérification de protection",t),!1}}async function cl(n,e=null){try{const t=e?xe(le,"seasons",e,"playerProtection",n):xe(le,"playerProtection",n),r=await En(t);return r.exists()?r.data():null}catch(t){return ge.error("Erreur lors de la récupération des données de protection",t),null}}async function DE(n,e=null){try{const t=await cl(n,e);return(t==null?void 0:t.email)||""}catch(t){return ge.error("Erreur lors de la récupération de l'email",t),""}}async function wp(n=null){try{const e=n?He(le,"seasons",n,"playerProtection"):He(le,"playerProtection");return(await mt(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return ge.error("Erreur lors du chargement des protections",e),[]}}async function pg(n){try{const e=[],t=Su(He(le,"playerProtection"),Ld("email","==",n));(await mt(t)).forEach(i=>{const o=i.data();o!=null&&o.isProtected&&e.push({seasonId:null,playerId:i.id,...o})});const s=await mt(He(le,"seasons"));for(const i of s.docs){const o=i.id,a=Su(He(le,"seasons",o,"playerProtection"),Ld("email","==",n));(await mt(a)).forEach(c=>{var f;const d=c.data();d!=null&&d.isProtected&&e.push({seasonId:o,seasonName:(f=i.data())==null?void 0:f.name,playerId:c.id,...d})})}return e}catch(e){return ge.error("Erreur listAssociationsForEmail",e),[]}}async function VE(n,e,t=null){try{const r=await cl(n,t);if(!r||!r.isProtected)return!1;if(r.email){ge.debug("Vérification avec Firebase Auth");try{const{signInWithEmailAndPassword:s}=await Yt(()=>import("./index.esm-640473df.js"),[]),{auth:i}=await Yt(()=>Promise.resolve().then(()=>mi),void 0);return await s(i,r.email,e),ge.debug("Mot de passe Firebase Auth valide"),Pi.saveSession(n),t&&bp(t,n),!0}catch(s){return ge.debug("Mot de passe Firebase Auth invalide",{code:s.code}),!1}}else{ge.debug("Vérification avec hash local");const s=fg(e),i=r.passwordHash===s;return i&&(Pi.saveSession(n),t&&bp(t,n)),i}}catch(r){return ge.error("Erreur lors de la vérification du mot de passe",r),!1}}async function NE({playerId:n,seasonId:e=null}){const t=e?xe(le,"seasons",e,"playerProtection",n):xe(le,"playerProtection",n),r=await En(t);if(!r.exists())throw new Error("Protection introuvable");const s=r.data();if(s!=null&&s.email)return await il(t,{isProtected:!0,updatedAt:new Date}),{success:!0};throw new Error("Email non défini pour cette protection")}function go(n){return Pi.isPasswordCached(n)}function HN(n){return null}async function OE(n,e=null){try{ge.info("Début sendPasswordResetEmail",{playerId:n,seasonId:e});const t=await cl(n,e);if(ge.debug("Protection data disponible"),!t||!t.isProtected)throw new Error("Joueur non protégé");if(ge.debug("Email à utiliser (masqué)"),t.firebaseUid){ge.debug("Utilisation du compte Firebase Auth existant");const{sendPasswordResetEmail:r}=await Yt(()=>import("./index.esm-640473df.js"),[]),{auth:s}=await Yt(()=>Promise.resolve().then(()=>mi),void 0);ge.debug("Tentative d'envoi d'email"),await r(s,t.email),ge.info("Email envoyé avec succès via Firebase Auth")}else{ge.debug("Pas de compte Firebase Auth, création temporaire...");const{createUserWithEmailAndPassword:r,sendPasswordResetEmail:s}=await Yt(()=>import("./index.esm-640473df.js"),[]),{auth:i}=await Yt(()=>Promise.resolve().then(()=>mi),void 0),o=Math.random().toString(36).slice(-8)+"A1!";try{const a=await r(i,t.email,o);ge.info("Compte temporaire créé",{uid:a.user.uid}),await s(i,t.email),ge.info("Email envoyé avec succès");const{updateDoc:l}=await Yt(()=>import("./index.esm-957a8d5d.js"),[]),{db:c}=await Yt(()=>Promise.resolve().then(()=>mi),void 0),d=e?xe(c,"seasons",e,"playerProtection",n):xe(c,"playerProtection",n);await l(d,{firebaseUid:a.user.uid})}catch(a){if(a.code==="auth/email-already-in-use")ge.debug("Email déjà utilisé, tentative d'envoi direct..."),await s(i,t.email),ge.info("Email envoyé avec succès");else throw a}}return{success:!0,message:"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}}catch(t){throw ge.error("Erreur lors de l'envoi de l'email de réinitialisation",{error:t}),t.code==="auth/user-not-found"?new Error("Aucun compte trouvé avec cette adresse email"):t.code==="auth/too-many-requests"?new Error("Trop de tentatives. Veuillez réessayer plus tard"):t.code==="auth/invalid-email"?new Error("Adresse email invalide"):new Error(`Erreur lors de l'envoi de l'email: ${t.message}`)}}async function WN(n,e,t=null){try{const r=fg(e),s=t?xe(le,"seasons",t,"playerProtection",n):xe(le,"playerProtection",n);return await il(s,{passwordHash:r,updatedAt:new Date}),{success:!0}}catch(r){throw ge.error("Erreur lors de la mise à jour du mot de passe",r),r}}async function QN(n){return new Promise((e,t)=>{ge.debug("Demande de mot de passe pour disponibilité"),t(new Error("Gestion de mot de passe à implémenter côté composant"))})}const lc=Object.freeze(Object.defineProperty({__proto__:null,clearEmailVerificationForProtection:CE,finalizeProtectionAfterVerification:NE,getCachedPlayerPassword:HN,getPlayerEmail:DE,getPlayerProtectionData:cl,isPlayerPasswordCached:go,isPlayerProtected:vi,listAssociationsForEmail:pg,listProtectedPlayers:wp,markEmailVerifiedForProtection:RE,protectPlayer:SE,requirePlayerPasswordForAvailability:QN,sendPasswordResetEmail:OE,startEmailVerificationForProtection:PE,unprotectPlayer:kE,updatePlayerPasswordInFirestore:WN,verifyPlayerPassword:VE},Symbol.toStringTag,{value:"Module"}));async function JN({toEmail:n,playerName:e,eventTitle:t,eventDate:r,yesUrl:s,noUrl:i,reason:o="new_event",fromEmail:a=void 0}){try{const f=xe(le,"userPreferences",n),g=await En(f);if(g.exists()){const y=g.data();if((y==null?void 0:y.notifyAvailability)===!1)return{success:!0,skipped:!0}}}catch{}const l=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>Disponibilité demandée</h2>
      <p>Bonjour ${e},</p>
      <p>Peux-tu indiquer ta disponibilité pour <strong>${t}</strong> (${r}) ?</p>
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;margin-right:8px;background:#16a34a;color:#fff;border-radius:8px;text-decoration:none;">Je suis dispo ✅</a>
        <a href="${i}" style="display:inline-block;padding:10px 16px;background:#dc2626;color:#fff;border-radius:8px;text-decoration:none;">Pas dispo ❌</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Motif: ${o}</p>
    </div>
  `,c=`Disponibilité demandée · ${t}`,d={to:n,message:{subject:c,html:l},createdAt:ol(),meta:{reason:o,eventTitle:t,eventDate:r,playerName:e}};return a&&(d.from=a,d.replyTo=a),await ec(He(le,"mail"),d),{success:!0}}async function ME({toEmail:n,verifyUrl:e,purpose:t="player_protection",displayName:r="utilisateur",fromEmail:s=void 0}){const i=t==="account_email_update",o=i?"Vérification de votre nouvelle adresse email":"Vérification de votre email",a=`Bonjour ${r},`,l=i?"Pour sécuriser votre compte, merci de confirmer que vous avez accès à cette nouvelle adresse email.":"Pour sécuriser votre joueur, merci de confirmer que vous avez accès à cette adresse email.",c=i?"Confirmer mon adresse email":"Vérifier mon email",d=i?"Confirmez votre nouvelle adresse email":"Confirmez votre email pour activer la protection",f=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>${o}</h2>
      <p>${a}</p>
      <p>${l}</p>
      <p>
        <a href="${e}" style="display:inline-block;padding:10px 16px;background:#3b82f6;color:#fff;border-radius:8px;text-decoration:none;">${c}</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Ce lien expirera dans 7 jours.</p>
    </div>
  `,g={to:n,message:{subject:d,html:f},createdAt:ol(),meta:{reason:t,displayName:r}};s&&(g.from=s,g.replyTo=s),await ec(He(le,"mail"),g)}async function YN({toEmail:n,playerName:e,verifyUrl:t,fromEmail:r=void 0}){return ME({toEmail:n,verifyUrl:t,purpose:"player_protection",displayName:e,fromEmail:r})}async function XN({toEmail:n,playerName:e,eventTitle:t,eventDate:r,eventUrl:s,html:i=void 0,subject:o=void 0,fromEmail:a=void 0}){try{const f=xe(le,"userPreferences",n),g=await En(f);if(g.exists()){const y=g.data();if((y==null?void 0:y.notifySelection)===!1)return{success:!0,skipped:!0}}}catch{}ge.debug("queueSelectionEmail",{forPlayer:e,hasCustomHtml:!!i,hasCustomSubject:!!o});const l=i||`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>🎭 Tu as été sélectionné(e) !</h2>
      <p>Bonjour ${e},</p>
      <p>Félicitations ! Tu as été sélectionné(e) pour <strong>${t}</strong> (${r}).</p>
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;background:#8b5cf6;color:#fff;border-radius:8px;text-decoration:none;">Voir les détails de l'événement</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Tu recevras bientôt plus d'informations sur l'organisation.</p>
    </div>
  `,c=o||`🎭 Sélection confirmée · ${t}`;ge.debug("queueSelectionEmail html/subject ready");const d={to:n,message:{subject:c,html:l},createdAt:ol(),meta:{reason:"selection",eventTitle:t,eventDate:r,playerName:e}};a&&(d.from=a,d.replyTo=a),ge.debug("queueSelectionEmail firestore payload ready");try{return await ec(He(le,"mail"),d),ge.info("Email ajouté à la queue Firestore",{playerName:e}),{success:!0}}catch(f){throw ge.error("Erreur lors de l'ajout à Firestore",{playerName:e,error:f}),f}}async function ZN({toEmail:n,playerName:e,eventTitle:t,eventDate:r,eventUrl:s,newSelectedPlayers:i=[],html:o=void 0,subject:a=void 0,fromEmail:l=void 0}){try{const y=xe(le,"userPreferences",n),x=await En(y);if(x.exists()){const S=x.data();if((S==null?void 0:S.notifySelection)===!1)return{success:!0,skipped:!0}}}catch{}const c=Array.isArray(i)?i.join(", "):"",d=o||`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>🎭 Sélection mise à jour</h2>
      <p>Bonjour ${e},</p>
      <p>La sélection pour <strong>${t}</strong> (${r}) a été mise à jour et tu n'en fais plus partie 😔.</p>
      ${c?`<p>Nouvelle sélection: <strong>${c}</strong>.</p>`:""}
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;background:#6b7280;color:#fff;border-radius:8px;text-decoration:none;">Voir les détails de l'événement</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Motif: mise à jour de sélection (relance auto ou ajustement manuel).</p>
    </div>
  `,f=a||`🎭 Tu n'es plus dans la sélection · ${t}`,g={to:n,message:{subject:f,html:d},createdAt:ol(),meta:{reason:"deselection",eventTitle:t,eventDate:r,playerName:e,newSelectedPlayers:i}};return l&&(g.from=l,g.replyTo=l),await ec(He(le,"mail"),g),{success:!0}}async function eO({eventId:n,eventData:e,selectedPlayers:t,seasonId:r,seasonSlug:s,players:i}){if(ge.info("sendSelectionEmailsForEvent",{eventId:n,seasonId:r,seasonSlug:s,playersCount:i==null?void 0:i.length,selectedCount:t==null?void 0:t.length}),!e||!t||t.length===0)throw new Error("Données manquantes pour l'envoi des emails de sélection");const{getPlayerEmail:o}=await Yt(()=>Promise.resolve().then(()=>lc),void 0),{createMagicLink:a}=await Yt(()=>Promise.resolve().then(()=>zN),void 0),l=`${window.location.origin}/season/${s}/event/${n}`,c=t.join(", "),d=`🎭 Sélection confirmée · ${e.title}`,f=[];for(const g of t){ge.debug("Traitement du joueur",{playerName:g});try{const y=i==null?void 0:i.find(D=>D.name===g);if(!y){ge.warn("Joueur non trouvé",{playerName:g});continue}ge.debug("Joueur trouvé");const x=await o(y.id,r);if(!x){ge.warn("Pas d'email pour le joueur",{playerName:g});continue}ge.debug("Email trouvé pour joueur");const P=`${(await a({seasonId:r,playerId:y.id,eventId:n,action:"no"})).url}&slug=${encodeURIComponent(s)}`,j=`
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
          <h2>🎭 Sélection confirmée</h2>
          <p>Bonjour <strong>${g}</strong>,</p>
          <p>Tu as été sélectionné(e) pour <strong>${e.title}</strong> (${qd(e.date)}).</p>
          <p>Sélection complète : <strong>${c}</strong>.</p>
          <p>Tu n'es plus disponible ? Signale le rapidement ici :</p>
          <p>
            <a href="${P}" style="display:inline-block;padding:10px 16px;background:#dc2626;color:#fff;border-radius:8px;text-decoration:none;">Signaler que je ne suis plus disponible</a>
          </p>
          <p>
            <a href="${l}" style="display:inline-block;padding:10px 16px;background:#8b5cf6;color:#fff;border-radius:8px;text-decoration:none;">Voir les détails de l'événement</a>
          </p>
        </div>
      `;ge.debug("HTML généré pour joueur");const U=XN({toEmail:x,playerName:g,eventTitle:e.title,eventDate:qd(e.date),eventUrl:l,html:j,subject:d});f.push(U),ge.info("Email ajouté à la queue",{playerName:g})}catch(y){ge.error("Erreur lors de l'envoi de l'email de sélection",{playerName:g,error:y})}}return ge.info("Nombre total d'emails à envoyer",{count:f.length}),await Promise.all(f),ge.info("Tous les emails ont été envoyés avec succès"),{success:!0,count:f.length}}async function tO({eventId:n,eventData:e,removedPlayers:t,newSelectedPlayers:r,seasonId:s,seasonSlug:i,players:o}){if(ge.info("sendDeselectionEmailsForEvent",{eventId:n,seasonId:s,removedCount:t==null?void 0:t.length}),!e||!t||t.length===0)return{success:!0,count:0};const{getPlayerEmail:a}=await Yt(()=>Promise.resolve().then(()=>lc),void 0),l=`${window.location.origin}/season/${i}/event/${n}`,c=[],d=Array.isArray(r)?r.join(", "):"";for(const f of t)try{const g=o==null?void 0:o.find(S=>S.name===f);if(!g){ge.warn("Joueur retiré non trouvé",{playerName:f});continue}const y=await a(g.id,s);if(!y){ge.warn("Pas d'email pour le joueur retiré",{playerName:f});continue}const x=`
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
          <h2>🎭 Sélection mise à jour</h2>
          <p>Bonjour <strong>${f}</strong>,</p>
          <p>Tu n'es plus sélectionné(e) pour <strong>${e.title}</strong> (${qd(e.date)}) 😔.</p>
          ${d?`<p>Nouvelle sélection: <strong>${d}</strong>.</p>`:""}
          <p>
            <a href="${l}" style="display:inline-block;padding:10px 16px;background:#6b7280;color:#fff;border-radius:8px;text-decoration:none;">Voir les détails de l'événement</a>
          </p>
        </div>
      `;c.push(ZN({toEmail:y,playerName:f,eventTitle:e.title,eventDate:qd(e.date),eventUrl:l,newSelectedPlayers:r,html:x}))}catch(g){ge.error("Erreur lors de l'envoi de l'email de désélection",{playerName:f,error:g})}return await Promise.all(c),ge.info("Emails de désélection envoyés",{count:c.length}),{success:!0,count:c.length}}function qd(n){var t;return n?(typeof n=="string"?new Date(n):((t=n.toDate)==null?void 0:t.call(n))||n).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}const nO={class:"relative p-5 pb-4 border-b border-white/10"},rO={class:"text-xl md:text-2xl font-bold text-white pr-10"},sO={key:0,class:"text-sm text-purple-300 mt-1"},iO={class:"px-4 md:px-6 py-4 md:py-6 space-y-6 overflow-y-auto"},oO={class:"bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20 p-3"},aO={class:"text-blue-200 text-sm"},lO={class:"flex space-x-1 bg-gray-800 rounded-lg p-1"},uO=["onClick"],cO={key:0,class:"space-y-4"},dO={class:"bg-gray-800 border border-gray-600 rounded-lg p-4 text-white whitespace-pre-line"},hO={class:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2"},fO={key:0,class:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 mb-3"},pO={class:"text-blue-200 text-sm"},mO={class:"bg-gray-800 border border-gray-600 rounded-lg p-3"},gO={key:0,class:"space-y-2"},vO={class:"flex flex-wrap gap-2"},yO={key:1,class:"text-amber-400 text-sm"},_O={key:1,class:"space-y-4"},bO={class:"relative"},wO=["value"],IO=["title"],EO={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},TO={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xO={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},AO=["disabled"],SO={key:0},PO={key:1},LE={__name:"EventAnnounceModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},players:{type:Array,default:()=>[]},mode:{type:String,default:"event",validator:n=>["event","selection"].includes(n)},selectedPlayers:{type:Array,default:()=>[]}},emits:["close","notifications-sent","send-email-notifications"],setup(n,{emit:e}){const t=n,r=e,s=O("email"),i=O(!1),o=O("Copier le message"),a=O(!1),l=O(!1),c=[{id:"email",label:"📧 Email"},{id:"copy",label:"📋 Copie"}],d=$e(()=>!t.event||!t.seasonSlug?"":`${window.location.origin}/season/${t.seasonSlug}/event/${t.event.id}`),f=$e(()=>{if(!t.event)return"";const D=P(t.event.date);if(t.mode==="selection"){const G=t.selectedPlayers.join(", ");return`Sélection pour ${t.event.title} du ${D} : ${G}`}else return`Bonjour !

Nouvel événement : ${t.event.title}
Date : ${D}

Lien direct vers l'événement : ${d.value}

Merci de confirmer votre disponibilité.`}),g=$e(()=>{if(!t.event||!t.selectedPlayers)return"";if(t.mode==="selection"){const D=t.selectedPlayers.join(", ");return`Sélection confirmée

Bonjour [Nom du joueur],

Tu as été sélectionné(e) pour ${t.event.title} (${P(t.event.date)}).

Sélection complète : ${D}.

Tu n'es plus disponible ? Signale le rapidement ici : [Lien de désistement]`}else return`Disponibilité demandée

Bonjour [Nom du joueur],

Peux-tu indiquer ta disponibilité pour ${t.event.title} (${P(t.event.date)}) ?`}),y=O([]);async function x(){if(!t.seasonId)return;let D=[];t.mode==="selection"?D=t.players.filter(Z=>t.selectedPlayers.includes(Z.name)):D=t.players.filter(Z=>Z.isProtected);const G=[];for(const Z of D)try{const{getPlayerEmail:me}=await Yt(()=>Promise.resolve().then(()=>lc),void 0),T=await me(Z.id,t.seasonId);T&&G.push({...Z,email:T})}catch(me){console.warn(`Impossible de charger l'email pour ${Z.name}:`,me)}y.value=G}function S(){r("close")}function P(D){var Z;return D?(typeof D=="string"?new Date(D):((Z=D.toDate)==null?void 0:Z.call(D))||D).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function j(){const D=f.value;navigator.clipboard.writeText(D).then(()=>{i.value=!0,o.value="Copié !",setTimeout(()=>{i.value=!1,o.value="Copier le message"},2e3)}).catch(G=>{console.warn("Erreur lors de la copie du texte"),alert("Impossible de copier le message.")})}async function U(){if(!(!t.event||y.value.length===0)){a.value=!0;try{t.mode==="selection"?r("send-email-notifications",{eventId:t.event.id,eventData:t.event,reason:"selection",selectedPlayers:t.selectedPlayers}):r("send-email-notifications",{eventId:t.event.id,eventData:t.event,reason:"manual"})}catch{console.error("Erreur lors de l'envoi des notifications"),alert("Erreur lors de l'envoi des notifications. Veuillez réessayer.")}finally{a.value=!1}}}return br(()=>{t.show&&(s.value="email",x())}),Nt(()=>t.show,D=>{D&&(s.value="email",x())}),Nt(()=>t.selectedPlayers,()=>{t.show&&t.mode==="selection"&&x()}),(D,G)=>n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:S},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-3xl max-h-[92vh] flex flex-col",onClick:G[1]||(G[1]=Vt(()=>{},["stop"]))},[h("div",nO,[h("button",{onClick:S,title:"Fermer",class:"absolute right-2.5 top-2.5 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),h("h2",rO,ue(n.mode==="selection"?"Annoncer la sélection":"Annoncer l'événement"),1),n.event?(F(),$("p",sO,ue(n.event.title)+" — "+ue(P(n.event.date)),1)):ce("",!0)]),h("div",iO,[h("div",oO,[h("p",aO,ue(n.mode==="selection"?"Choisis comment annoncer cette sélection aux joueurs :":"Choisis comment annoncer cet événement aux joueurs :"),1)]),h("div",lO,[(F(),$(vt,null,ur(c,Z=>h("button",{key:Z.id,onClick:me=>s.value=Z.id,class:zt(["flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",s.value===Z.id?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"])},ue(Z.label),11,uO)),64))]),s.value==="email"?(F(),$("div",cO,[h("div",null,[G[2]||(G[2]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Prévisualisation du message :",-1)),h("div",dO,ue(g.value),1)]),h("div",null,[h("label",hO,[G[3]||(G[3]=Fn(" Destinataires ")),h("button",{onClick:G[0]||(G[0]=Z=>l.value=!l.value),class:"text-blue-400 hover:text-blue-300 text-lg cursor-help",title:"Cliquer pour plus d'information"}," ? ")]),l.value?(F(),$("div",fO,[h("p",pO,ue(n.mode==="selection"?"Les destinataires sont les joueurs sélectionnés qui ont renseigné une adresse email en utilisant la fonction Protéger.":"Les destinataires sont les joueurs qui ont renseigné une adresse email en utilisant la fonction Protéger."),1)])):ce("",!0),h("div",mO,[y.value.length>0?(F(),$("div",gO,[h("div",vO,[(F(!0),$(vt,null,ur(y.value,Z=>(F(),$("span",{key:Z.id,class:"px-3 py-1 bg-gray-700 text-white rounded text-sm"},ue(Z.name),1))),128))])])):(F(),$("div",yO," ⚠️ "+ue(n.mode==="selection"?"Aucun joueur sélectionné avec email renseigné. Les notifications ne pourront pas être envoyées.":"Aucun joueur protégé avec email renseigné. Les notifications ne pourront pas être envoyées."),1))])])])):ce("",!0),s.value==="copy"?(F(),$("div",_O,[G[6]||(G[6]=h("div",{class:"bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/20 p-3"},[h("p",{class:"text-purple-200 text-sm"},"📋 Copie du message pour partage manuel")],-1)),h("div",bO,[h("textarea",{value:f.value,class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400 resize-none",rows:"6",readonly:""},null,8,wO),h("button",{onClick:j,class:"absolute top-2 right-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg p-2 hover:from-purple-600 hover:to-pink-700 transition-all duration-300",title:o.value},[i.value?(F(),$("svg",TO,G[5]||(G[5]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(F(),$("svg",EO,G[4]||(G[4]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2z"},null,-1)])))],8,IO)])])):ce("",!0)]),h("div",xO,[s.value==="email"?(F(),$("button",{key:0,onClick:U,disabled:y.value.length===0||a.value,class:"h-12 px-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600 flex-1"},[a.value?(F(),$("span",PO,"📧 Envoi en cours...")):(F(),$("span",SO,"📧 Envoyer les notifications email"))],8,AO)):ce("",!0),s.value==="copy"?(F(),$("button",{key:1,onClick:j,class:"h-12 px-6 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 flex-1"}," 📋 Copier le message ")):ce("",!0),h("button",{onClick:S,class:"h-12 px-4 bg-gray-700 text-white rounded-lg"}," Fermer ")])])])):ce("",!0)}},RO={class:"text-center mb-6"},CO={class:"text-lg text-gray-300"},kO={class:"mb-6"},DO={class:"space-y-4"},VO={class:"flex items-center gap-2 text-gray-300 text-sm"},NO=["disabled"],OO={key:0,class:"animate-spin"},MO={key:1},LO={class:"mb-6 text-center"},FO={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},$O={class:"text-red-300 text-sm"},UO={class:"text-center mb-6"},jO={class:"text-lg text-gray-300"},BO={class:"mb-6"},qO=["disabled"],zO={key:0,class:"animate-spin"},GO={key:1},KO={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},HO={class:"text-red-300 text-sm"},WO={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},QO={class:"text-green-300 text-sm"},JO={class:"flex justify-center"},mg={__name:"PasswordVerificationModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","verified"],setup(n,{emit:e}){const t=n,r=e,s=O(""),i=O(!1),o=O(""),a=O(!1),l=O(""),c=O(""),d=O(null),f=O(!0);async function g(){if(s.value){i.value=!0,o.value="";try{const S=await mp(t.seasonId);if(s.value===S){if(f.value)try{Pi.saveSession(t.player.id)}catch{}r("verified",{type:"season_pin"}),x();return}if(await VE(t.player.id,s.value,t.seasonId)){if(f.value)try{Pi.saveSession(t.player.id)}catch{}r("verified",{type:"player_password"}),x()}else o.value="Mot de passe incorrect. Veuillez réessayer."}catch(S){ge.error("Erreur lors de la vérification",S),o.value="Erreur lors de la vérification. Veuillez réessayer."}finally{i.value=!1}}}async function y(){i.value=!0,l.value="",c.value="";try{const S=await OE(t.player.id,t.seasonId);c.value=S.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(S){ge.error("Erreur lors de l'envoi de l'email",S),l.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{i.value=!1}}function x(){r("close"),s.value="",o.value="",a.value=!1,l.value="",c.value=""}return Nt(()=>t.show,S=>{S&&cn(()=>{d.value&&d.value.focus()})}),(S,P)=>{var j,U;return F(),$(vt,null,[n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4",onClick:x},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:P[3]||(P[3]=Vt(()=>{},["stop"]))},[h("div",RO,[P[7]||(P[7]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"🔐")],-1)),P[8]||(P[8]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Vérification requise",-1)),h("p",CO,ue((j=n.player)==null?void 0:j.name),1),P[9]||(P[9]=h("p",{class:"text-sm text-gray-400 mt-2"},"Ce joueur est protégé par mot de passe",-1))]),h("div",kO,[h("div",DO,[h("div",null,[P[10]||(P[10]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),Ze(h("input",{"onUpdate:modelValue":P[0]||(P[0]=D=>s.value=D),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:On(g,["enter"]),ref_key:"passwordInput",ref:d},null,544),[[xt,s.value]])]),h("div",VO,[Ze(h("input",{id:"staySignedIn",type:"checkbox","onUpdate:modelValue":P[1]||(P[1]=D=>f.value=D),class:"w-4 h-4"},null,512),[[Ta,f.value]]),P[11]||(P[11]=h("label",{for:"staySignedIn"},"Rester connecté sur cet appareil",-1))])]),h("button",{onClick:g,disabled:!s.value||i.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(F(),$("span",OO,"⏳")):(F(),$("span",MO,"🔓")),h("span",null,ue(i.value?"Vérification...":"Vérifier"),1)],8,NO)]),h("div",LO,[h("button",{onClick:P[2]||(P[2]=D=>a.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),o.value?(F(),$("div",FO,[h("div",$O,ue(o.value),1)])):ce("",!0),h("div",{class:"flex justify-center"},[h("button",{onClick:x,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):ce("",!0),a.value?(F(),$("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:P[6]||(P[6]=D=>a.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:P[5]||(P[5]=Vt(()=>{},["stop"]))},[h("div",UO,[P[12]||(P[12]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"📧")],-1)),P[13]||(P[13]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Mot de passe oublié",-1)),h("p",jO,ue((U=n.player)==null?void 0:U.name),1)]),h("div",BO,[P[14]||(P[14]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),h("button",{onClick:y,disabled:i.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(F(),$("span",zO,"⏳")):(F(),$("span",GO,"📧")),h("span",null,ue(i.value?"Envoi...":"Envoyer l'email"),1)],8,qO)]),l.value?(F(),$("div",KO,[h("div",HO,ue(l.value),1)])):ce("",!0),c.value?(F(),$("div",WO,[h("div",QO,ue(c.value),1)])):ce("",!0),h("div",JO,[h("button",{onClick:P[4]||(P[4]=D=>a.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ce("",!0)],64)}}},YO={class:"text-center mb-6"},XO={class:"text-sm text-gray-300"},ZO={key:0,class:"space-y-4"},eM={key:0,class:"p-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-200 text-sm flex items-center gap-2"},tM={key:1,class:"space-y-4"},nM=["disabled"],rM={key:0,class:"animate-spin"},sM={key:1},iM={key:2,class:"mt-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm"},oM={class:"mt-6 flex justify-center gap-3"},aM=["disabled"],lM={key:0,class:"animate-spin"},uM={key:1},FE={__name:"AccountClaimModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","success"],setup(n,{emit:e}){const t=n,r=e,s=O(1),i=O(""),o=O(""),a=O(""),l=O(!1),c=O(""),d=O(!1),f=Ka(),g=$e(()=>i.value&&i.value.includes("@")),y=$e(()=>o.value&&a.value&&o.value===a.value&&o.value.length>=6);async function x(){var U,D,G;if(!(!g.value||!((U=t.player)!=null&&U.id))){l.value=!0,c.value="";try{const Z=await PE({playerId:t.player.id,email:i.value.trim(),seasonId:t.seasonId}),me=(D=f.params)==null?void 0:D.slug,T=`${Z.url}${me?`&slug=${encodeURIComponent(me)}`:""}&player=${encodeURIComponent(t.player.id)}&open=protection`;await YN({toEmail:i.value,playerName:((G=t.player)==null?void 0:G.name)||"joueur",verifyUrl:T}),d.value=!0}catch{c.value="Impossible d'envoyer l'email de vérification"}finally{l.value=!1}}}async function S(){try{await CE({playerId:t.player.id,seasonId:t.seasonId})}catch{}s.value=1,d.value=!1,i.value="",o.value="",a.value=""}async function P(){var U;try{const D=await cl((U=t.player)==null?void 0:U.id,t.seasonId);D!=null&&D.email&&(D!=null&&D.emailVerifiedAt)?s.value=2:s.value=1}catch{s.value=1}}br(()=>{P()}),Nt(()=>t.show,U=>{U&&P()});async function j(){if(y.value){l.value=!0,c.value="";try{await SE(t.player.id,i.value.trim(),o.value,t.seasonId),r("success")}catch(U){c.value=(U==null?void 0:U.message)||"Erreur lors de l'association"}finally{l.value=!1}}}return(U,D)=>{var G;return n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[160] p-4",onClick:D[6]||(D[6]=Z=>U.$emit("close"))},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-md",onClick:D[5]||(D[5]=Vt(()=>{},["stop"]))},[h("button",{onClick:D[0]||(D[0]=Z=>U.$emit("close")),class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"}," ✖️ "),h("div",YO,[D[7]||(D[7]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"👤")],-1)),D[8]||(D[8]=h("h2",{class:"text-2xl font-bold text-white mb-1"},"Associer un compte",-1)),h("p",XO,"Pour sécuriser les saisies de "+ue((G=n.player)==null?void 0:G.name),1)]),s.value===1?(F(),$("div",ZO,[h("div",null,[D[9]||(D[9]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Adresse email",-1)),Ze(h("input",{"onUpdate:modelValue":D[1]||(D[1]=Z=>i.value=Z),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[xt,i.value]])]),d.value?(F(),$("div",eM,[D[10]||(D[10]=h("span",null,"✅",-1)),h("span",null,"Un email a été envoyé à "+ue(i.value)+". Cliquez sur le lien contenu dans l'email pour continuer.",1)])):ce("",!0)])):s.value===2?(F(),$("div",tM,[h("div",{class:"p-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-200 text-sm flex items-center gap-2"},[D[11]||(D[11]=h("span",null,"✅",-1)),D[12]||(D[12]=h("span",null,"Adresse email vérifiée",-1)),h("button",{type:"button",onClick:S,title:"Changer d'adresse email",class:"ml-auto px-2 py-1 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 text-white/80 hover:text-white transition-colors"},"✏️")]),h("div",null,[D[13]||(D[13]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),Ze(h("input",{"onUpdate:modelValue":D[2]||(D[2]=Z=>o.value=Z),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe sécurisé (min. 6 caractères)"},null,512),[[xt,o.value]])]),h("div",null,[D[14]||(D[14]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),Ze(h("input",{"onUpdate:modelValue":D[3]||(D[3]=Z=>a.value=Z),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe"},null,512),[[xt,a.value]])]),h("button",{onClick:j,disabled:!y.value||l.value,class:"w-full px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(F(),$("span",rM,"⏳")):(F(),$("span",sM,"🔒")),h("span",null,ue(l.value?"Association...":"Associer ce joueur"),1)],8,nM)])):ce("",!0),c.value?(F(),$("div",iM,ue(c.value),1)):ce("",!0),h("div",oM,[h("button",{onClick:D[4]||(D[4]=Z=>U.$emit("close")),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer"),s.value===1?(F(),$("button",{key:0,onClick:x,disabled:!g.value||l.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(F(),$("span",lM,"⏳")):(F(),$("span",uM,"✉️")),h("span",null,ue(l.value?"Envoi...":"Envoyer le lien de vérification"),1)],8,aM)):ce("",!0)])])])):ce("",!0)}}},cM={class:"mt-4"},dM={key:0,class:"mt-2 p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg text-sm text-gray-300 space-y-2"},$E={__name:"AccountBenefitsHint",setup(n){const e=O(!1);return(t,r)=>(F(),$("div",cM,[h("button",{onClick:r[0]||(r[0]=s=>e.value=!e.value),class:"w-full p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-all duration-200 flex items-center justify-between"},[r[1]||(r[1]=h("h3",{class:"text-sm font-semibold text-blue-300"},"💡 A quoi sert un compte ?",-1)),h("span",{class:zt(["text-blue-300 transition-transform duration-200",{"rotate-180":e.value}])},"▼",2)]),e.value?(F(),$("div",dM,r[2]||(r[2]=[h("div",{class:"text-gray-300"},"Ça fonctionne très bien sans compte. Mais si vous en créez un, vous aurez quelques trucs sympas en plus :",-1),h("div",null,[Fn("• "),h("span",{class:"text-blue-300"},"Protégez vos saisies :"),Fn(" vous êtes sûr que personne n'a changé vos dispos car vous êtes le seul à pouvoir les modifier")],-1),h("div",null,[Fn("• "),h("span",{class:"text-blue-300"},"Notifications :"),Fn(" nouveaux spectacles, disponibilités et sélections dans votre boite mail")],-1),h("div",null,[Fn("• "),h("span",{class:"text-blue-300"},"Saisie simplifiée :"),Fn(" votre joueur reste toujours en haut de la liste")],-1)]))):ce("",!0)]))}},hM={class:"text-center mb-6"},fM={class:"text-2xl font-bold text-white mb-2"},pM={class:"text-lg text-gray-300"},mM={class:"mb-6"},gM={class:"flex items-center space-x-3"},vM={class:"text-2xl"},yM={class:"font-semibold text-white"},_M={class:"text-sm text-gray-300"},bM={key:0,class:"mb-6"},wM={key:1,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},IM={class:"text-red-300 text-sm"},EM={key:2,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},TM={class:"text-green-300 text-sm"},xM={class:"flex justify-center gap-3"},AM=["disabled"],SM={__name:"PlayerClaimModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null},onboarding:{type:Boolean,default:!1}},emits:["close","update","onboarding-finished"],setup(n,{emit:e}){const t=n,r=e,s=O(!1),i=O(!1),o=O(!1),a=O(""),l=O(""),c=O(!1);Ka();const d=O(!1);$e(()=>!1),$e(()=>!1);function f(){l.value="Compte créé et joueur associé !",s.value=!0,c.value=!1,r("update")}async function g(){var j;if((j=t.player)!=null&&j.id){s.value=await vi(t.player.id,t.seasonId);try{const{isPlayerPasswordCached:U}=await Yt(()=>Promise.resolve().then(()=>lc),void 0);i.value=U(t.player.id)}catch{i.value=!1}}}function y(){var j;a.value="";try{if((j=t.player)!=null&&j.id&&go(t.player.id)){x();return}}catch{}d.value=!0}async function x(){o.value=!0,a.value="",l.value="";try{const j=await kE(t.player.id,t.seasonId);l.value="Joueur déverrouillé!",s.value=!1,j.email&&(email.value=j.email),r("update")}catch(j){logger.error("Erreur lors de la désactivation de la protection",j),a.value="Erreur lors de la désactivation de la protection. Veuillez réessayer."}finally{o.value=!1}}function S(){d.value=!1,x()}function P(){r("close")}return Nt(()=>t.player,()=>{t.show&&t.player&&g()},{immediate:!0}),Nt(()=>t.show,j=>{j&&t.player&&(a.value="",l.value="",d.value=!1,g(),t.onboarding&&cn(()=>{}))}),(j,U)=>{var D;return F(),$(vt,null,[n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4",onClick:P},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:U[1]||(U[1]=Vt(()=>{},["stop"]))},[h("button",{onClick:P,class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"}," ✖️ "),h("div",hM,[U[4]||(U[4]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"🔒")],-1)),h("h2",fM,ue(s.value?"Déverrouiller ce joueur":"Verrouiller ce joueur"),1),h("p",pM,ue((D=n.player)==null?void 0:D.name),1)]),h("div",mM,[h("div",{class:zt(["flex items-center justify-between p-4 rounded-lg",s.value?"bg-green-500/20 border border-green-500/30":"bg-gray-500/20 border border-gray-500/30"])},[h("div",gM,[h("span",vM,ue(s.value?"🔒":"🔓"),1),h("div",null,[h("div",yM,ue(s.value?i.value?"Joueur associé à votre compte":"Ce joueur est associé à un compte utilisateur":"Joueur sans compte"),1),h("div",_M,ue(s.value?i.value?"Seul vous pouvez modifier":"Seul le titulaire peut modifier les disponibilités":"Tout le monde peut modifier les disponibilités"),1)])])],2)]),s.value?ce("",!0):(F(),$("div",bM,U[5]||(U[5]=[h("div",{class:"text-sm text-gray-300"},"Vous pouvez protéger vos saisies de disponibilités avec un compte utilisateur.",-1)]))),a.value?(F(),$("div",wM,[h("div",IM,ue(a.value),1)])):ce("",!0),l.value?(F(),$("div",EM,[h("div",TM,ue(l.value),1)])):ce("",!0),h("div",xM,[h("button",{onClick:P,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer "),s.value?(F(),$("button",{key:1,onClick:y,disabled:o.value,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," 🔓 Dissocier ",8,AM)):(F(),$("button",{key:0,onClick:U[0]||(U[0]=G=>c.value=!0),class:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300"}," Associer un compte "))]),s.value?ce("",!0):(F(),cu($E,{key:3}))])])):ce("",!0),ut(FE,{show:c.value,player:n.player,"season-id":n.seasonId,onClose:U[2]||(U[2]=G=>c.value=!1),onSuccess:f},null,8,["show","player","season-id"]),ut(mg,{show:d.value,player:n.player,seasonId:n.seasonId,onClose:U[3]||(U[3]=G=>d.value=!1),onVerified:S},null,8,["show","player","seasonId"])],64)}}};const PM=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},RM={class:"relative text-center p-6 pb-4 border-b border-white/10"},CM={class:"text-2xl md:text-3xl font-bold text-white mb-1"},kM={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},DM={class:"grid grid-cols-3 gap-3 md:gap-4"},VM={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},NM={class:"text-xl md:text-2xl font-bold text-white"},OM={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},MM={class:"text-xl md:text-2xl font-bold text-white"},LM={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 md:p-4 rounded-lg border border-green-500/30"},FM={class:"text-xl md:text-2xl font-bold text-white"},$M={class:"hidden md:flex justify-center flex-wrap gap-3 mt-6"},UM={key:0,class:"md:hidden mt-3 space-y-2"},jM={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},BM={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},qM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},zM={class:"mb-6"},GM={__name:"PlayerModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},stats:{type:Object,default:()=>({availability:0,selection:0,ratio:0})},seasonId:{type:String,default:null},onboardingStep:{type:Number,default:0},onboardingPlayerId:{type:[String,null],default:null}},emits:["close","update","delete","refresh","advance-onboarding"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=O(!1),o=O(""),a=O(null),l=O(!1),c=O(!1),d=O(null),f=O(!1),g=O(!1),y=O(!1);function x(){s("close")}function S(){var w;o.value=((w=r.player)==null?void 0:w.name)||"",i.value=!0,cn(()=>{a.value&&a.value.focus()})}function P(){i.value=!1,o.value=""}async function j(){var I,C;if(!o.value.trim())return;if(await vi((I=r.player)==null?void 0:I.id,r.seasonId)){go((C=r.player)==null?void 0:C.id)?U():(d.value="update",c.value=!0);return}U()}function U(){var w;s("update",{playerId:(w=r.player)==null?void 0:w.id,newName:o.value.trim()}),i.value=!1,o.value=""}async function D(){var I,C;if(await vi((I=r.player)==null?void 0:I.id,r.seasonId)){go((C=r.player)==null?void 0:C.id)?G():(d.value="delete",c.value=!0);return}G()}function G(){var w;s("delete",(w=r.player)==null?void 0:w.id)}function Z(){s("refresh")}function me(w){d.value==="update"?U():d.value==="delete"&&G(),d.value=null}Nt(()=>r.show,w=>{var I;w||(i.value=!1,o.value="",d.value=null,l.value=!1),w&&((I=r.player)!=null&&I.id)&&(vi(r.player.id,r.seasonId).then(C=>{g.value=!!C}),Yt(()=>Promise.resolve().then(()=>lc),void 0).then(C=>{try{y.value=!!C.isPlayerPasswordCached(r.player.id)}catch{y.value=!1}}))}),e({openProtection(){l.value=!0}});const T=O({position:null});return Nt(()=>r.show,w=>{w&&r.onboardingStep===4?cn(()=>{const I=document.querySelectorAll("button");let C=null;if(I.forEach(N=>{!C&&N.textContent&&N.textContent.includes("Protection")&&(C=N)}),C){const N=C.getBoundingClientRect();T.value.position={x:Math.round(N.right+8),y:Math.round(N.top+window.scrollY-4)}}}):w||(T.value.position=null)}),(w,I)=>{var C;return F(),$(vt,null,[n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:x},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:I[5]||(I[5]=Vt(()=>{},["stop"]))},[h("div",RM,[h("button",{onClick:x,class:"absolute right-3 top-3 text-white/80 hover:text-white"},"✖️"),I[10]||(I[10]=h("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[h("span",{class:"text-2xl md:text-3xl"},"👤")],-1)),h("h2",CM,ue((C=n.player)==null?void 0:C.name),1)]),h("div",kM,[h("div",null,[h("div",DM,[h("div",VM,[h("div",NM,ue(r.stats.availability),1),I[11]||(I[11]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibilités",-1))]),h("div",OM,[h("div",MM,ue(r.stats.selection),1),I[12]||(I[12]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Sélections",-1))]),h("div",LM,[h("div",FM,ue(r.stats.ratio),1),I[13]||(I[13]=h("div",{class:"text-xs md:text-sm text-gray-300"},"% de sélection",-1))])])]),h("div",$M,[h("button",{onClick:S,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},I[14]||(I[14]=[h("span",null,"✏️",-1),h("span",null,"Renommer",-1)])),h("button",{onClick:I[0]||(I[0]=N=>l.value=!0),class:"px-5 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2"},[h("span",null,ue(g.value?"🔓":"🔒"),1),h("span",null,ue(g.value?"Déverrouiller":"Verrouiller"),1)]),h("button",{onClick:D,class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},I[15]||(I[15]=[h("span",null,"🗑️",-1),h("span",null,"Supprimer",-1)])),h("button",{onClick:x,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")]),f.value?(F(),$("div",UM,[h("button",{onClick:I[1]||(I[1]=N=>{S(),f.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"}," ✏️ Renommer "),h("button",{onClick:I[2]||(I[2]=N=>{D(),f.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"}," 🗑️ Supprimer ")])):ce("",!0)]),h("div",jM,[h("button",{onClick:I[3]||(I[3]=N=>l.value=!0),class:"h-12 px-4 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex-[1.4]"},ue(g.value?"🔓 Déverrouiller":"🔒 Verrouiller"),1),h("button",{onClick:x,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"}," Fermer "),h("button",{onClick:I[4]||(I[4]=N=>f.value=!f.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"}," ⋯ ")])])])):ce("",!0),i.value?(F(),$("div",BM,[h("div",qM,[I[17]||(I[17]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Renommer le joueur",-1)),h("div",zM,[I[16]||(I[16]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),Ze(h("input",{"onUpdate:modelValue":I[6]||(I[6]=N=>o.value=N),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[On(P,["esc"]),On(j,["enter"])],ref_key:"editNameInput",ref:a},null,544),[[xt,o.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:P,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:j,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):ce("",!0),ut(SM,{show:l.value,player:n.player,seasonId:n.seasonId,onboarding:n.onboardingStep===4,onClose:I[7]||(I[7]=N=>l.value=!1),onUpdate:Z,onOnboardingFinished:I[8]||(I[8]=N=>w.$emit("advance-onboarding",5))},null,8,["show","player","seasonId","onboarding"]),ut(mg,{show:c.value,player:n.player,seasonId:n.seasonId,onClose:I[9]||(I[9]=N=>c.value=!1),onVerified:me},null,8,["show","player","seasonId"])],64)}}},KM=PM(GM,[["__scopeId","data-v-731bb3fb"]]),HM={class:"relative p-6 pb-4 border-b border-white/10"},WM={class:"sticky bottom-0 p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex justify-end"},QM={__name:"HowItWorksModal",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=e;return(r,s)=>n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:s[3]||(s[3]=i=>t("close"))},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:s[2]||(s[2]=Vt(()=>{},["stop"]))},[h("div",HM,[h("button",{onClick:s[0]||(s[0]=i=>t("close")),title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),s[4]||(s[4]=h("div",{class:"flex items-center gap-3"},[h("div",{class:"w-12 h-12 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-2xl"},"❓"),h("div",null,[h("h2",{class:"text-xl md:text-2xl font-bold text-white"},"Comment fonctionne la sélection automatique ?"),h("p",{class:"text-sm text-blue-300"},"Tirage au sort pondéré pour favoriser l'équité")])],-1))]),s[5]||(s[5]=nr('<div class="px-4 md:px-6 py-4 md:py-6 overflow-y-auto space-y-4 text-gray-200"><div class="bg-white/5 border border-white/10 rounded-lg p-4"><h3 class="text-white font-semibold mb-2">En bref</h3><p>On tire au sort uniquement parmi les joueurs <span class="text-green-300">disponibles</span>. Ceux qui ont <span class="text-purple-300">moins joué</span> ont plus de chances d&#39;être tirés. À long terme, tout le monde joue à peu près autant.</p></div><div class="space-y-3"><h3 class="text-white font-semibold">Détails du tirage</h3><ol class="list-decimal list-inside space-y-2 text-gray-300"><li><span class="text-white">Qui participe ?</span> Tous les joueurs marqués « ✅ Disponible » pour l’événement.</li><li><span class="text-white">Un coup de pouce aux moins joués</span> : si vous avez moins joué récemment, le tirage vous favorise un peu plus.</li><li><span class="text-white">Comment se fait le tirage ?</span> On tire un nom au hasard en tenant compte de cet avantage, on le met de côté, puis on recommence jusqu’à avoir assez de joueurs.</li><li><span class="text-white">Si on relance</span> : on garde les joueurs encore disponibles et on complète seulement les places manquantes.</li><li><span class="text-white">Indisponibles</span> : ils ne sont jamais tirés au sort.</li></ol></div><div class="space-y-2"><h3 class="text-white font-semibold">Estimation des chances</h3><p>L’application peut afficher un pourcentage indicatif pour aider à comprendre : si Alice a moins joué que Bob, elle aura un pourcentage plus élevé. C’est une indication, pas une promesse : deux tirages peuvent donner des résultats différents.</p></div><div class="space-y-2"><h3 class="text-white font-semibold">Pourquoi c’est juste</h3><ul class="list-disc list-inside space-y-1 text-gray-300"><li>Ceux qui ont moins joué ont automatiquement plus de chances.</li><li>Après une sélection, vos chances diminuent un peu pour laisser la place aux autres.</li><li>Sur la durée, les sélections s’<span class="text-green-300">équilibrent naturellement</span>.</li></ul></div><div class="space-y-2"><h3 class="text-white font-semibold">Exemples rapides</h3><p> • Alice n’a encore jamais été sélectionnée, Bob a été sélectionné une fois, Charlie plusieurs fois. Pour 1 place, on aura environ : Alice 57 %, Bob 29 %, Charlie 14 %.<br> • S’il y a 2 places, les chances de chacun augmentent, mais l’ordre reste aléatoire : un tirage peut donner Alice + Bob, un autre Alice + Charlie. </p></div><div class="text-xs text-gray-400"> Remarque : l’algorithme favorise l’équité à long terme, mais <span class="text-gray-300">n’assure pas</span> une rotation parfaite à chaque événement. </div></div>',1)),h("div",WM,[h("button",{onClick:s[1]||(s[1]=i=>t("close")),class:"h-10 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600"},"Compris")])])])):ce("",!0)}},JM={class:"relative text-center p-6 pb-4 border-b border-white/10"},YM={class:"text-2xl md:text-3xl font-bold text-white mb-1"},XM={class:"text-sm md:text-base text-purple-300"},ZM={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},eL={class:"mb-3"},tL={class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-0"},nL={key:0,class:"flex items-center justify-between gap-2"},rL=["title"],sL={key:0,class:"text-purple-400 mr-2"},iL={key:1,class:"text-green-400 mr-2"},oL={key:2,class:"text-red-400 mr-2"},aL={key:3,class:"text-gray-400 mr-2"},lL=["onClick"],uL={key:1,class:"flex items-center justify-center"},cL=["onChange"],dL=["value"],hL=["onClick"],fL={key:0,class:"mb-3"},pL={class:"grid grid-cols-3 gap-2 md:gap-3 mb-3"},mL={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},gL={class:"text-cyan-300 text-lg md:text-xl font-semibold"},vL={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},yL={class:"text-green-400 text-lg md:text-xl font-semibold"},_L={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},bL={class:"text-purple-400 text-lg md:text-xl font-semibold"},wL={key:1,class:"mb-3"},IL={class:"flex items-center space-x-3 p-3 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20"},EL={class:"flex-1"},TL={class:"text-blue-300 text-sm font-medium"},xL={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},AL=["disabled","title"],SL=["disabled"],PL=["disabled"],RL={__name:"SelectionModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},currentSelection:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},selectedCount:{type:Number,default:0},playerAvailability:{type:Object,default:()=>({})},seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},players:{type:Array,default:()=>[]}},emits:["close","selection","perfect","send-email-notifications","update-selection"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=O(!1),o=O("Copier le message"),a=O(!1),l=O(!1),c=O(""),d=O(!1),f=O(!1),g=$e(()=>{var fe;return((fe=r.event)==null?void 0:fe.playerCount)||6}),y=O([]),x=O(null),S=$e(()=>Array.from({length:g.value},(oe,ze)=>{var rt;return((rt=r.currentSelection)==null?void 0:rt[ze])||null})),P=$e(()=>JSON.stringify(y.value)!==JSON.stringify(S.value)),j=$e(()=>(r.players||[]).map(fe=>fe.name).filter(fe=>{var oe;return((oe=r.playerAvailability)==null?void 0:oe[fe])===!0}).sort((fe,oe)=>fe.localeCompare(oe,"fr",{sensitivity:"base"})));function U(fe){const oe=new Set(y.value.filter(Boolean)),ze=y.value[fe];return ze&&oe.delete(ze),j.value.filter(rt=>!oe.has(rt))}function D(fe){x.value=fe}function G(){x.value=null}function Z(fe,oe){var rt;const ze=((rt=fe==null?void 0:fe.target)==null?void 0:rt.value)||"";ze&&(y.value[oe]=ze),x.value=null}function me(fe){y.value[fe]=null}$e(()=>(U(-1).length<g.value,""));const T=$e(()=>r.currentSelection&&r.currentSelection.length>0),w=$e(()=>{var rt;if(!T.value)return!1;const fe=r.currentSelection.some(dt=>!Xe(dt)),oe=((rt=r.event)==null?void 0:rt.playerCount)||6,ze=r.availableCount<oe;return fe||ze});$e(()=>{var ze;if(!w.value)return"";const fe=r.currentSelection.filter(rt=>!Xe(rt)),oe=((ze=r.event)==null?void 0:ze.playerCount)||6;return fe.length>0?fe.length===1?`${fe[0]} n'est plus disponible. Veuillez relancer la sélection.`:`${fe.length} joueurs ne sont plus disponibles. Veuillez relancer la sélection.`:r.availableCount<oe?`Seulement ${r.availableCount} joueurs disponibles pour ${oe} requis. Veuillez attendre plus de disponibilités ou ajuster le nombre de joueurs à sélectionner.`:"Sélection incomplète"}),$e(()=>{if(!r.event||!T.value)return"";const fe=I(r.event.date),oe=r.currentSelection.join(", ");return`Sélection pour ${r.event.title} du ${fe} : ${oe}`}),Nt(()=>r.show,fe=>{if(fe){i.value=!1,o.value="Copier le message",l.value=!1,c.value="",d.value=!1,a.value=!1;const oe=Array.isArray(r.currentSelection)?[...r.currentSelection]:[],ze=g.value;y.value=Array.from({length:ze},(rt,dt)=>oe[dt]||null),x.value=null}}),Nt([g,()=>r.currentSelection,()=>{var fe;return(fe=r.event)==null?void 0:fe.id}],()=>{if(!r.show)return;const fe=Array.isArray(r.currentSelection)?[...r.currentSelection]:[],oe=g.value,ze=Array.from({length:oe},(rt,dt)=>fe[dt]||y.value[dt]||null);y.value=ze.slice(0,oe)});function I(fe){var ze;return fe?(typeof fe=="string"?new Date(fe):((ze=fe.toDate)==null?void 0:ze.call(fe))||fe).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function C(){s("selection")}function N(){s("perfect")}function B(){var oe;if(!((oe=r.event)!=null&&oe.id))return;const fe=y.value.filter(Boolean);s("update-selection",{eventId:r.event.id,players:fe})}function R(){s("close")}function Pt(){a.value=!0}function Et(){f.value=!0}function Xe(fe){return r.playerAvailability[fe]===!0}function Le(fe){return r.playerAvailability[fe]===!1}function Ue(fe){return r.currentSelection.includes(fe)&&Xe(fe)}function hn(fe=!1,oe=!1){if(d.value=fe,fe){const ze=I(r.event.date),rt=r.currentSelection.join(", ");oe?c.value=`Sélection mise à jour pour ${r.event.title} du ${ze} : ${rt}`:c.value=`Nouvelle sélection pour ${r.event.title} du ${ze} : ${rt}`}else c.value="Sélection effectuée avec succès !";l.value=!0,setTimeout(()=>{l.value=!1},8e3)}function rn(){l.value=!1}e({showSuccess:hn});function Rt(fe){s("send-email-notifications",fe),a.value=!1}return(fe,oe)=>{var ze,rt,dt;return F(),$(vt,null,[n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:R},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:oe[1]||(oe[1]=Vt(()=>{},["stop"]))},[h("div",JM,[h("button",{onClick:R,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),oe[5]||(oe[5]=h("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-3xl"},"🎭")],-1)),h("h2",YM,"Sélection pour "+ue((ze=n.event)==null?void 0:ze.title),1),h("p",XM,ue(I((rt=n.event)==null?void 0:rt.date)),1),h("div",{class:"mt-3"},[h("button",{onClick:Et,class:"inline-flex items-center gap-2 text-sm text-blue-300 hover:text-blue-200"},oe[4]||(oe[4]=[h("span",null,"❓",-1),Fn(),h("span",null,"Kezako ?",-1)]))])]),h("div",ZM,[h("div",eL,[oe[8]||(oe[8]=h("h3",{class:"text-base md:text-lg font-semibold text-white mb-2"},"Joueurs sélectionnés",-1)),h("div",tL,[(F(!0),$(vt,null,ur(y.value,(k,L)=>(F(),$("div",{key:"sel-slot-"+L,class:zt(["relative p-3 rounded-lg border text-center transition-colors",k?["bg-gradient-to-r",Le(k)?"from-yellow-500/20 to-orange-500/20 border-yellow-500/30":Xe(k)?"from-green-500/20 to-emerald-500/20 border-green-500/30":"from-red-500/20 to-red-600/20 border-red-500/30"]:"border-dashed border-white/20 hover:border-white/40 bg-white/5"])},[k?(F(),$("div",nL,[h("div",{class:"flex-1 text-white font-medium truncate",title:k},[Ue(k)?(F(),$("span",sL,"🎭")):Xe(k)?(F(),$("span",iL,"✅")):Le(k)?(F(),$("span",oL,"❌")):(F(),$("span",aL,"–")),Fn(" "+ue(k),1)],8,rL),h("button",{onClick:J=>me(L),class:"text-white/80 hover:text-white rounded-full hover:bg-white/10 px-2 py-1",title:"Retirer ce joueur"}," × ",8,lL)])):(F(),$("div",uL,[x.value===L?(F(),$("select",{key:0,class:"w-full bg-gray-800 text-white rounded-md p-2 border border-white/20 focus:outline-none",onChange:J=>Z(J,L),onBlur:oe[0]||(oe[0]=J=>G())},[oe[6]||(oe[6]=h("option",{value:""},"— Choisir —",-1)),(F(!0),$(vt,null,ur(U(L),J=>(F(),$("option",{key:J,value:J},ue(J),9,dL))),128))],40,cL)):(F(),$("button",{key:1,onClick:J=>D(L),class:"flex items-center gap-2 text-white/80 hover:text-white px-2 py-1 rounded-md hover:bg-white/10",title:"Ajouter un joueur"},oe[7]||(oe[7]=[h("span",{class:"text-lg"},"＋",-1),h("span",{class:"text-sm"},"Ajouter",-1)]),8,hL))]))],2))),128))])]),w.value?(F(),$("div",fL,oe[9]||(oe[9]=[h("div",{class:"flex items-center space-x-2 p-3 bg-yellow-500/10 rounded-lg border border-yellow-500/20"},[h("div",{class:"text-yellow-400"},"⚠️"),h("div",{class:"text-yellow-200 text-sm"},"Sélection incomplète. Vérifie ci-dessous.")],-1)]))):ce("",!0),h("div",pL,[h("div",mL,[h("div",gL,ue(((dt=n.event)==null?void 0:dt.playerCount)||6),1),oe[10]||(oe[10]=h("div",{class:"text-xs md:text-sm text-gray-400"},"À sélectionner",-1))]),h("div",vL,[h("div",yL,ue(n.availableCount),1),oe[11]||(oe[11]=h("div",{class:"text-xs md:text-sm text-gray-400"},"Disponibles",-1))]),h("div",_L,[h("div",bL,ue(n.selectedCount),1),oe[12]||(oe[12]=h("div",{class:"text-xs md:text-sm text-gray-400"},"Sélectionnés",-1))])]),l.value?(F(),$("div",wL,[h("div",IL,[oe[14]||(oe[14]=h("div",{class:"text-blue-400 text-xl"},"✨",-1)),h("div",EL,[h("p",TL,ue(c.value),1)]),h("button",{onClick:rn,class:"text-blue-400 hover:text-blue-300 transition-colors",title:"Fermer le message"},oe[13]||(oe[13]=[h("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):ce("",!0)]),h("div",xL,[h("button",{onClick:C,disabled:n.availableCount===0,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex-1 whitespace-nowrap",title:n.availableCount===0?"Aucun joueur disponible":T.value?"Relancer la sélection automatique":"Lancer la sélection automatique"},oe[15]||(oe[15]=[Fn(" ✨ "),h("span",{class:"hidden sm:inline"},"Sélection Auto",-1),h("span",{class:"sm:hidden"},"Auto",-1)]),8,AL),h("button",{onClick:B,disabled:!P.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",title:"Enregistrer cette composition manuelle"},oe[16]||(oe[16]=[Fn(" 💾 "),h("span",{class:"hidden sm:inline"},"Enregistrer",-1),h("span",{class:"sm:hidden"},"Save",-1)]),8,SL),h("button",{onClick:Pt,disabled:!T.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed"},oe[17]||(oe[17]=[Fn(" 📣 "),h("span",{class:"hidden sm:inline"},"Annoncer",-1)]),8,PL),T.value?(F(),$("button",{key:0,onClick:N,class:"h-12 px-3 md:px-4 bg-gray-700 text-white rounded-lg flex-1 whitespace-nowrap"},oe[18]||(oe[18]=[Fn(" 👍 "),h("span",{class:"hidden sm:inline"},"Fermer",-1)]))):ce("",!0)])])])):ce("",!0),ut(LE,{show:a.value,event:n.event,"season-id":n.seasonId,"season-slug":n.seasonSlug,players:n.players,mode:"selection","selected-players":n.currentSelection,onClose:oe[2]||(oe[2]=k=>a.value=!1),onSendEmailNotifications:Rt},null,8,["show","event","season-id","season-slug","players","selected-players"]),ut(QM,{show:f.value,onClose:oe[3]||(oe[3]=k=>f.value=!1)},null,8,["show"])],64)}}},CL={class:"flex items-center justify-center gap-2"},kL=["title"],DL=["title"],VL=["title"],NL=["title"],OL=["title"],b_={__name:"AvailabilityCell",props:{playerName:{type:String,required:!0},compact:{type:Boolean,default:!1},eventId:{type:String,required:!0},isAvailable:{type:Boolean,default:null},isSelected:{type:Boolean,default:!1},chancePercent:{type:Number,default:null},showSelectedChance:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(n,{emit:e}){const t=n,r=e,s=O(!1),i=$e(()=>!(t.chancePercent==null||t.isAvailable!==!0||t.isSelected&&!t.showSelectedChance)),o=$e(()=>t.disabled?"Événement archivé — désarchivez pour modifier":t.isSelected&&t.isAvailable===!0?i.value?`${t.playerName} est sélectionné pour cet événement • avait ~${t.chancePercent}% de chances`:`${t.playerName} est sélectionné pour cet événement`:t.isAvailable===!0?t.chancePercent!=null?`${t.playerName} est disponible • ~${t.chancePercent}% de chances d'être sélectionné`:`${t.playerName} est disponible`:t.isAvailable===!1?`${t.playerName} n'est pas disponible`:`Cliquer pour indiquer la disponibilité de ${t.playerName}`);function a(){t.disabled||r("toggle",t.playerName,t.eventId)}return(l,c)=>(F(),$("div",{class:zt(["flex items-center justify-center transition-all duration-200",[n.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-white/10",n.compact?"min-h-0 p-1 md:p-2":"min-h-20 p-3 md:p-5"]]),onClick:a,onMouseenter:c[0]||(c[0]=d=>s.value=!0),onMouseleave:c[1]||(c[1]=d=>s.value=!1)},[h("div",CL,[i.value&&s.value?(F(),$("span",{key:0,class:"text-[11px] md:text-xs px-2 py-0.5 rounded-full bg-emerald-500/15 border border-emerald-400/40 text-emerald-200",title:o.value},ue(n.chancePercent)+"% ",9,kL)):(F(),$(vt,{key:1},[n.isSelected&&n.isAvailable===!0?(F(),$("span",{key:0,class:zt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value}," 🎭 ",10,DL)):n.isAvailable===!0?(F(),$("span",{key:1,class:zt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value}," ✅ ",10,VL)):n.isAvailable===!1?(F(),$("span",{key:2,class:zt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value}," ❌ ",10,NL)):(F(),$("span",{key:3,class:zt(["text-gray-500 transition-colors duration-200",[n.compact?"text-base md:text-lg":"text-xl md:text-2xl",n.disabled?"":"hover:text-white"]]),title:o.value}," – ",10,OL))],64))])],34))}},ML={key:0,class:"fixed inset-0 z-[130] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4"},LL={class:"w-full max-w-xl bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl text-center"},FL={class:"text-2xl md:text-3xl font-bold text-white mb-3"},$L={class:"text-gray-300 mb-6"},UL={class:"flex flex-col items-stretch justify-center gap-3"},jL=["value"],BL={__name:"CreatorOnboardingModal",props:{seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},playersCount:{type:Number,default:0},eventsCount:{type:Number,default:0},onboardingDone:{type:Boolean,default:!1}},emits:["create-event","add-player","copy-link","dismissed"],setup(n,{emit:e}){const t=n,r=e,s=window.location.origin,i=$e(()=>`${s}/season/${t.seasonSlug}`),o=O(!1);try{t.seasonId&&(o.value=!!localStorage.getItem(`dismissCreatorOnboarding:${t.seasonId}`))}catch{}const a=$e(()=>t.onboardingDone?0:t.eventsCount===0&&t.playersCount===0?1:t.eventsCount>0&&t.playersCount===0?2:t.eventsCount>0&&t.playersCount>0&&!o.value?3:0),l=$e(()=>a.value>0),c=O(l.value);Nt(a,P=>{c.value=P>0});const d=$e(()=>{switch(a.value){case 1:return"Commençons par créer votre premier événement";case 2:return"Super ! Ajoutez votre premier joueur";case 3:return"Vous y êtes presque! Maintenant, invitez vos joueurs.";default:return""}}),f=$e(()=>{switch(a.value){case 1:return"Un titre, une date... et c’est parti.";case 2:return"Ajoutez au moins un joueur pour commencer à saisir des disponibilités.";case 3:return"Laissez vos membres s’inscrire eux-même et indiquer leurs disponibilités en leur envoyant le lien direct.";default:return""}});function g(){c.value=!1,r("create-event")}function y(){c.value=!1,r("add-player")}function x(){var P;try{(P=navigator.clipboard)==null||P.writeText(i.value)}catch{}r("copy-link")}async function S(){try{if(t.seasonId){const{db:P}=await Yt(()=>Promise.resolve().then(()=>mi),void 0),{doc:j,updateDoc:U}=await Yt(()=>import("./index.esm-957a8d5d.js"),[]);await U(j(P,"seasons",t.seasonId),{onboardingCreatorDone:!0})}else localStorage.setItem("dismissCreatorOnboarding","1")}catch{}o.value=!0,c.value=!1,r("dismissed")}return(P,j)=>l.value&&c.value?(F(),$("div",ML,[h("div",LL,[j[1]||(j[1]=h("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[h("span",{class:"text-3xl"},"🎬")],-1)),h("h2",FL,ue(d.value),1),h("p",$L,ue(f.value),1),h("div",UL,[a.value===1?(F(),$("button",{key:0,onClick:g,class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all"}," ✨ Créer un événement ")):a.value===2?(F(),$("button",{key:1,onClick:y,class:"px-5 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all"}," 👤 Ajouter un joueur ")):a.value===3?(F(),$(vt,{key:2},[h("input",{value:i.value,type:"text",readonly:"",class:"w-full px-3 py-2 bg-gray-800 border border-white/20 rounded-lg text-white text-sm select-all",onFocus:j[0]||(j[0]=U=>U.target.select())},null,40,jL),h("div",{class:"flex gap-3 justify-center"},[h("button",{onClick:x,class:"px-5 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-all"}," 🔗 Copier le lien "),h("button",{onClick:S,class:"px-5 py-3 bg-transparent text-gray-300 border border-white/20 rounded-lg hover:bg-white/10 transition-all"}," J’ai compris ")])],64)):ce("",!0)])])])):ce("",!0)}},qL={class:"flex justify-center gap-2 mb-4"},zL={class:"space-y-3"},GL={key:0},KL={key:0,class:"text-sm text-gray-400"},HL={key:1,class:"space-y-2"},WL={class:"flex items-center justify-between gap-3"},QL={class:"truncate"},JL={class:"text-white font-semibold"},YL={class:"text-gray-400 text-xs"},XL=["onClick"],ZL={key:1,class:"text-sm text-gray-300"},eF={class:"p-3 rounded-lg border border-white/10 bg-white/5 space-y-3"},tF={class:"flex items-center justify-between"},nF={class:"flex items-center gap-2"},rF={class:"flex items-center justify-between"},sF={class:"flex items-center gap-2"},iF={class:"text-right"},oF=["disabled"],aF={key:0,class:"text-xs text-red-300"},lF={key:1,class:"text-xs text-green-300"},uF={key:2,class:"flex flex-col gap-3"},cF={class:"p-3 rounded-lg border border-white/10 bg-white/5 text-sm text-gray-300"},dF={class:"flex items-center gap-2"},hF=["disabled"],fF={key:0,class:"mt-2 text-xs text-red-300"},pF={key:1,class:"mt-2 text-xs text-green-300"},mF={__name:"AccountMenu",props:{show:{type:Boolean,default:!1},seasonId:{type:String,default:null}},emits:["close","manage-player","change-password","logout-device","delete-account"],setup(n,{emit:e}){const t=n,r=e,s=O(""),i=O([]),o=O("players");function a(T){return["px-4 py-2 rounded-full text-sm transition-colors",o.value===T?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10"]}function l(T){return`${T.seasonId||"global"}__${T.playerId}`}async function c(){var T;try{s.value=((T=qt==null?void 0:qt.currentUser)==null?void 0:T.email)||""}catch{}try{const w=s.value?await pg(s.value):[],I=[];for(const C of w){let N=C.playerId;try{if(C.seasonId){const B=xe(le,"seasons",C.seasonId,"players",C.playerId),R=await En(B);R.exists()&&(N=R.data().name||N)}}catch{}I.push({...C,playerName:N})}i.value=I}catch{i.value=[]}}function d(){r("close")}Nt(()=>t.show,T=>{T&&(c(),Z())}),br(()=>{t.show&&(c(),Z())});const f=O(""),g=O(!1),y=O(""),x=O(""),S=O(!1);Nt(s,T=>{f.value=T||""}),Nt(f,T=>{S.value=!!T&&T.includes("@")&&T!==s.value});async function P(){if(S.value){g.value=!0,y.value="",x.value="";try{const T=await EE({currentEmail:s.value,newEmail:f.value.trim()});await ME({toEmail:f.value.trim(),verifyUrl:T.url,purpose:"account_email_update",displayName:"utilisateur"}),x.value=`Un email de vérification a été envoyé à ${f.value.trim()}. Cliquez sur le lien pour confirmer le changement.`}catch(T){y.value=(T==null?void 0:T.code)==="auth/requires-recent-login"?"Veuillez vous reconnecter pour modifier votre email":"Impossible de mettre à jour l'email"}finally{g.value=!1}}}const j=O({notifyAvailability:!0,notifySelection:!0}),U=O(!1),D=O(""),G=O("");async function Z(){try{if(!s.value)return;const T=xe(le,"userPreferences",s.value),w=await En(T);if(w.exists()){const I=w.data()||{};j.value.notifyAvailability=I.notifyAvailability!==!1,j.value.notifySelection=I.notifySelection!==!1}else j.value={notifyAvailability:!0,notifySelection:!0}}catch{}}async function me(){if(s.value){U.value=!0,D.value="",G.value="";try{const T=xe(le,"userPreferences",s.value);await pn(T,{...j.value},{merge:!0}),G.value="Préférences sauvegardées"}catch{D.value="Impossible de sauvegarder vos préférences"}finally{U.value=!1}}}return(T,w)=>n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[150] p-4",onClick:d},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-xl",onClick:w[9]||(w[9]=Vt(()=>{},["stop"]))},[h("button",{onClick:d,class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},"✖️"),w[15]||(w[15]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-indigo-400 to-cyan-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">👤</span></div><h2 class="text-2xl font-bold text-white mb-1">Mon compte</h2><p class="text-sm text-gray-300">Gérez votre compte et vos préférences</p></div>',1)),h("div",qL,[h("button",{onClick:w[0]||(w[0]=I=>o.value="manage"),class:zt(a("manage"))},"Gérer",2),h("button",{onClick:w[1]||(w[1]=I=>o.value="notifications"),class:zt(a("notifications"))},"Notifications",2),h("button",{onClick:w[2]||(w[2]=I=>o.value="players"),class:zt(a("players"))},"Joueurs",2)]),h("div",zL,[o.value==="players"?(F(),$("div",GL,[w[10]||(w[10]=h("h3",{class:"text-white font-semibold mb-2"},"Mes joueurs associés",-1)),i.value.length===0?(F(),$("div",KL,"Aucun joueur associé pour le moment.")):(F(),$("ul",HL,[(F(!0),$(vt,null,ur(i.value,I=>(F(),$("li",{key:l(I),class:"p-3 rounded-lg border border-white/10 bg-white/5 text-sm text-gray-300"},[h("div",WL,[h("div",QL,[h("div",JL,ue(I.seasonName||I.seasonId||"—"),1),h("div",YL,"Joueur : "+ue(I.playerName||"—"),1)]),h("button",{onClick:C=>T.$emit("manage-player",I),class:"px-3 py-2 rounded-lg bg-gray-700 text-white hover:bg-gray-600 text-xs"},"Gérer",8,XL)])]))),128))]))])):o.value==="notifications"?(F(),$("div",ZL,[h("div",eF,[h("div",tF,[h("label",nF,[Ze(h("input",{type:"checkbox","onUpdate:modelValue":w[3]||(w[3]=I=>j.value.notifyAvailability=I),class:"w-4 h-4"},null,512),[[Ta,j.value.notifyAvailability]]),w[11]||(w[11]=h("span",null,"Recevoir les demandes de disponibilités",-1))])]),h("div",rF,[h("label",sF,[Ze(h("input",{type:"checkbox","onUpdate:modelValue":w[4]||(w[4]=I=>j.value.notifySelection=I),class:"w-4 h-4"},null,512),[[Ta,j.value.notifySelection]]),w[12]||(w[12]=h("span",null,"Recevoir les emails de sélection",-1))])]),h("div",iF,[h("button",{onClick:me,disabled:U.value,class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-500 disabled:opacity-50"},ue(U.value?"⏳":"Sauvegarder"),9,oF)]),D.value?(F(),$("div",aF,ue(D.value),1)):ce("",!0),G.value?(F(),$("div",lF,ue(G.value),1)):ce("",!0)])])):(F(),$("div",uF,[h("div",cF,[w[13]||(w[13]=h("label",{class:"block text-xs text-gray-400 mb-2"},"Email",-1)),h("div",dF,[Ze(h("input",{"onUpdate:modelValue":w[5]||(w[5]=I=>f.value=I),type:"email",class:"flex-1 p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"nouvel@email.com"},null,512),[[xt,f.value]]),h("button",{onClick:P,disabled:!S.value||g.value,class:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},ue(g.value?"⏳":"Mettre à jour"),9,hF)]),y.value?(F(),$("div",fF,ue(y.value),1)):ce("",!0),x.value?(F(),$("div",pF,ue(x.value),1)):ce("",!0)]),w[14]||(w[14]=h("div",{class:"text-sm text-gray-400"},"Vous pouvez changer votre mot de passe pour sécuriser vos opérations sensibles.",-1)),h("button",{onClick:w[6]||(w[6]=I=>T.$emit("change-password")),class:"w-full px-4 py-3 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500"},"Changer de mot de passe"),h("button",{onClick:w[7]||(w[7]=I=>T.$emit("logout-device")),class:"w-full px-4 py-3 rounded-lg bg-gray-700 text-white hover:bg-gray-600"},"Déconnexion de cet appareil"),h("button",{onClick:w[8]||(w[8]=I=>T.$emit("delete-account")),class:"w-full px-4 py-3 rounded-lg bg-red-600 text-white hover:bg-red-500"},"Supprimer mon compte")]))]),h("div",{class:"mt-6 text-center"},[h("button",{onClick:d,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800"},"Fermer")])])])):ce("",!0)}},gF={class:"space-y-4"},vF={class:"flex items-center justify-between"},yF={class:"flex items-center gap-2 text-gray-300 text-sm"},_F={key:0,class:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm"},bF={key:1,class:"p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm"},wF={class:"flex justify-center gap-3 mt-2"},IF=["disabled"],EF={key:0,class:"animate-spin"},TF={key:1},xF={__name:"AccountLoginModal",props:{show:{type:Boolean,default:!1}},emits:["close","success"],setup(n,{emit:e}){const t=e,r=O(""),s=O(""),i=O(!1),o=O(""),a=O(""),l=O(!0),c=$e(()=>!!r.value&&r.value.includes("@")&&!!s.value);async function d(){if(c.value){i.value=!0,o.value="",a.value="";try{if(await fE(r.value.trim(),s.value),l.value)try{Pi.saveSession(r.value.trim())}catch{}t("success")}catch{o.value="Email ou mot de passe incorrect"}finally{i.value=!1}}}async function f(){if(!r.value||!r.value.includes("@")){o.value="Saisissez votre email pour recevoir un lien de réinitialisation",setTimeout(()=>{o.value=""},2500);return}i.value=!0,o.value="",a.value="";try{await pE(r.value.trim()),a.value="Email de réinitialisation envoyé"}catch{o.value="Impossible d'envoyer l'email de réinitialisation"}finally{i.value=!1}}return(g,y)=>n.show?(F(),$("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[170] p-4",onClick:y[6]||(y[6]=x=>g.$emit("close"))},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-md",onClick:y[5]||(y[5]=Vt(()=>{},["stop"]))},[h("button",{onClick:y[0]||(y[0]=x=>g.$emit("close")),class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},"✖️"),y[10]||(y[10]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">👤</span></div><h2 class="text-2xl font-bold text-white mb-1">Mon compte</h2><p class="text-sm text-gray-300">Connectez-vous pour gérer votre compte et vos préférences</p></div>',1)),h("div",gF,[ut($E),h("div",null,[y[7]||(y[7]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Email",-1)),Ze(h("input",{"onUpdate:modelValue":y[1]||(y[1]=x=>r.value=x),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[xt,r.value]])]),h("div",null,[y[8]||(y[8]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),Ze(h("input",{"onUpdate:modelValue":y[2]||(y[2]=x=>s.value=x),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe"},null,512),[[xt,s.value]])]),h("div",vF,[h("label",yF,[Ze(h("input",{type:"checkbox","onUpdate:modelValue":y[3]||(y[3]=x=>l.value=x),class:"w-4 h-4"},null,512),[[Ta,l.value]]),y[9]||(y[9]=h("span",null,"Rester connecté sur cet appareil",-1))]),h("button",{onClick:f,class:"text-sm text-blue-400 hover:text-blue-300 underline"},"Mot de passe oublié ?")]),o.value?(F(),$("div",_F,ue(o.value),1)):ce("",!0),a.value?(F(),$("div",bF,ue(a.value),1)):ce("",!0),h("div",wF,[h("button",{onClick:y[4]||(y[4]=x=>g.$emit("close")),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer"),h("button",{onClick:d,disabled:!c.value||i.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},[i.value?(F(),$("span",EF,"⏳")):(F(),$("span",TF,"Se connecter"))],8,IF)])])])])):ce("",!0)}};const AF={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},SF={ref:"pageHeaderRef",class:"sticky top-0 z-[60] text-center py-4 md:py-6 px-4 relative bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900/95 backdrop-blur-sm border-b border-white/10"},PF={class:"text-4xl font-bold text-white mb-0 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},RF={class:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2"},CF={class:"hidden md:flex items-center gap-2"},kF={class:"w-full px-0 md:px-0 pb-0 pt-[72px] md:pt-[80px] -mt-[72px] md:-mt-[80px] bg-gray-900"},DF={class:"flex items-stretch relative"},VF={key:0,class:"col-left flex-shrink-0 p-3 md:p-4 sticky left-0 z-[81] bg-gray-900 h-full"},NF={class:"flex-1 overflow-hidden"},OF=["data-event-id","onClick"],MF=["title"],LF=["title"],FF={key:0,class:"mt-1 text-xs text-gray-400"},$F=["title","onClick"],UF=["title","onClick"],jF=["title","aria-label"],BF={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},qF={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3l18 18"},zF={key:0,class:"pointer-events-none"},GF={class:"flex items-center justify-between"},KF={key:1,class:"pointer-events-none"},HF={id:"coachmark-avail",class:"coachmark pointer-events-auto max-w-sm bg-gray-900 border border-pink-500/40 rounded-xl shadow-2xl p-3 text-white relative"},WF={class:"flex items-center justify-between"},QF={key:2,class:"pointer-events-none"},JF={id:"coachmark-name",class:"coachmark pointer-events-auto max-w-sm bg-gray-900 border border-yellow-500/40 rounded-xl shadow-2xl p-3 text-white relative"},YF={class:"flex items-center justify-between"},XF={class:"table-auto border-separate border-spacing-0 table-fixed w-auto min-w-max"},ZF=["data-player-id"],e4={class:"px-0 py-4 md:py-5 font-medium text-white relative group text-xl md:text-2xl sticky left-0 z-40 bg-gray-900 left-col-td"},t4={class:"px-4 md:px-5 font-bold text-xl md:text-2xl flex items-center w-full min-w-0"},n4={key:0,class:"text-yellow-400 mr-1 text-sm",title:"Joueur protégé par mot de passe"},r4=["onClick","title"],s4=["data-event-id"],i4={class:"border-t border-white/10"},o4={class:"px-0 py-4 md:py-5 sticky left-0 z-40 bg-gray-900 left-col-td"},a4={class:"px-4 md:px-5 flex items-center"},l4=["data-event-id"],u4={key:0,class:"fixed inset-0 z-[120] flex items-center justify-center bg-gray-950/80 backdrop-blur-sm"},c4={class:"text-center"},d4={class:"text-white text-lg"},h4={class:"mt-3 w-64 h-2 bg-white/10 rounded-full overflow-hidden"},f4={class:"text-white/60 text-xs mt-2"},p4={key:3,class:"fixed bottom-4 left-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-2xl border border-green-400/30 backdrop-blur-sm z-[200]"},m4={class:"flex items-center space-x-2"},g4={key:4,class:"fixed bottom-4 left-4 bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-xl shadow-2xl border border-red-400/30 backdrop-blur-sm z-[200]"},v4={class:"flex items-center space-x-2"},y4={key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},_4={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},b4={class:"mb-6"},w4={class:"mb-6"},I4={class:"mb-6"},E4={class:"mb-6 flex items-center gap-3"},T4={class:"mb-6"},x4={key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},A4={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},S4={class:"mb-6"},P4={class:"flex justify-end space-x-3"},R4={key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},C4={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},k4={class:"flex justify-end space-x-3"},D4={key:8,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},V4={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},N4={class:"flex justify-end space-x-3"},O4={key:9,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[95] p-4"},M4={class:"relative text-center p-6 pb-4 border-b border-white/10"},L4={class:"text-2xl md:text-3xl font-bold text-white mb-1"},F4={class:"text-sm md:text-base text-purple-300"},$4={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},U4={key:0,class:"mb-4 md:mb-6"},j4={class:"text-gray-300 bg-gray-800/50 p-4 rounded-lg border border-gray-600/50"},B4={class:"grid grid-cols-3 gap-3 md:gap-4 mb-2 md:mb-4"},q4={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},z4={class:"text-xl md:text-2xl font-bold text-white"},G4={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},K4={class:"text-xl md:text-2xl font-bold text-white"},H4={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 md:p-4 rounded-lg border border-green-500/30"},W4={class:"text-xl md:text-2xl font-bold text-white"},Q4={key:1,class:"mb-4 md:mb-6"},J4={class:"mb-3 flex items-center"},Y4=["title"],X4={class:"truncate"},Z4={class:"space-y-0.5"},e3={class:"flex items-center min-w-0 gap-1.5"},t3={key:0,class:"text-yellow-400 mr-1 text-xs",title:"Joueur protégé par mot de passe"},n3=["title"],r3={class:"flex-0 p-0"},s3={class:"hidden md:flex justify-center flex-wrap gap-3 mt-4"},i3=["disabled","title"],o3=["title"],a3={key:2,class:"md:hidden mt-3 space-y-2"},l3=["disabled","title"],u3={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},c3={key:11,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},d3={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},h3={class:"mb-6"},f3={class:"mb-6"},p3={class:"mb-6"},m3={class:"mb-6 flex items-center gap-3"},g3={class:"mb-6"},v3={key:12,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},y3={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},_3={class:"mb-6"},b3={class:"space-y-4"},w3=["disabled"],I3={key:0,class:"animate-spin"},E3={key:1},T3={class:"mb-6 text-center"},x3={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},A3={class:"text-red-300 text-sm"},S3={key:13,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[110] p-0 md:p-4"},P3={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 shadow-2xl w-full max-w-md rounded-t-2xl md:rounded-2xl flex flex-col max-h-[90vh]"},R3={class:"px-4 pt-3 pb-16 md:px-6 md:pt-4 md:pb-20 overflow-y-auto"},C3={class:"space-y-4"},k3={class:"mt-2 text-center"},D3={key:0,class:"mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},V3={class:"text-red-300 text-sm"},N3={class:"sticky bottom-0 w-full p-3 md:p-4 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2 pb-[env(safe-area-inset-bottom)]"},O3=["disabled"],M3={key:0,class:"animate-spin"},L3={key:1},F3={class:"mb-6"},$3=["disabled"],U3={key:0,class:"animate-spin"},j3={key:1},B3={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},q3={class:"text-red-300 text-sm"},z3={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},G3={class:"text-green-300 text-sm"},K3={class:"flex justify-center"},H3={class:"mb-6"},W3=["disabled"],Q3={key:0,class:"animate-spin"},J3={key:1},Y3={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},X3={class:"text-red-300 text-sm"},Z3={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},e$={class:"text-green-300 text-sm"},t$={class:"flex justify-center"},n$={key:16,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},r$={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl max-w-md"},s$={class:"flex gap-3"},w_={__name:"GridBoard",props:{slug:{type:String,required:!0},eventId:{type:String,required:!1}},setup(n){const e=n,t=Fu(),r=Ka(),s=e.slug,i=O(""),o=O(""),a=O({}),l=O(!1),c=O(null),d=O(null),f=O(""),g=O(""),y=O(6),x=O(!1),S=O(""),P=O(null),j=O(null),U=O(null),D=O({position:null,side:null}),G=O({position:null}),Z=O({position:null}),me=O(!1),T=O(null),w=O(!1),I=O(null),C=O(null),N=O(!1),B=O(null),R=O(""),Pt=O(!1),Et=O(null),Xe=O(""),Le=O(""),Ue=O(!1),hn=O(null),rn=O(!1),Rt=O(null),fe=O(""),oe=O(""),ze=O(!1),rt=O(null),dt=O(!1),k=O(!1),L=O(""),J=O(""),X=O(!1),Pe=O(!1),Oe=O(""),E=O(""),A=O(!1),M=O(null),ee=O(""),Y=O(!1),te=O(!1),ve=O(!1),de=O(null),he=O(null),ae=O(null),Ee=O(0);function we(){var _;try{if(!o.value||!a.value||a.value.onboardingCreatorDone!==!0||qe.value.length===0)return;const m=localStorage.getItem(`playerTourCompleted:${o.value}`);try{const Q=((_=qt==null?void 0:qt.currentUser)==null?void 0:_.email)||"";Q&&pg(Q).then(async ne=>{const re=ne.filter(pe=>pe.seasonId===o.value);if(re.length>0){const pe=`seasonPreferredPlayer:${o.value}`,Ve=localStorage.getItem(pe);let Fe=[];if(Ve)if(Ve.startsWith("["))try{Fe=JSON.parse(Ve)||[]}catch{}else Fe=[Ve];const We=new Set(Fe);re.forEach(Dt=>We.add(Dt.playerId));const ct=Array.from(We);localStorage.setItem(pe,JSON.stringify(ct))}}).catch(()=>{})}catch{}const V=localStorage.getItem(`startPlayerTour:${o.value}`);!m&&V&&(Ee.value=1,localStorage.removeItem(`startPlayerTour:${o.value}`),cn(()=>{const Q=document.querySelector('button[data-onboarding="add-player"]');if(Q){Q.scrollIntoView({behavior:"smooth",block:"end"});const ne=Q.getBoundingClientRect(),re=document.getElementById("coachmark-add"),pe=280,Ve=100,Fe=(re==null?void 0:re.offsetWidth)||pe,We=(re==null?void 0:re.offsetHeight)||Ve,ct=Math.round(ne.right+12);if(ct+Fe<=window.innerWidth-12){const Jt=ne.top+ne.height/2-We/2,ot=-14,Dn=12,lr=window.innerHeight-We-12,Dr=Math.max(Dn,Math.min(Math.round(Jt+ot),lr));D.value={position:{x:ct,y:Dr},side:"right"}}else{const Jt=Math.round(ne.left+ne.width/2-Fe/2),ot=Math.round(ne.top-We-8),Dn=8,lr=window.innerWidth-Fe-8;D.value={position:{x:Math.max(Dn,Math.min(Jt,lr)),y:ot},side:null}}}}))}catch{}}const Te=O(!1),Re=O(null),Ne=O(null),Be=O(!1),Je=O(null),Ht=O(!1),Ft=O(null),vn=O(!1),Ct=O(!1),fr=O(!1),Lr=O(!1),sn=O(null);function Rn(){Ct.value=!1}function Oi(){try{const _=qt==null?void 0:qt.currentUser;if(!_||_.isAnonymous){let m=null;if(Go.value&&Go.value.size>0){const V=Go.value.values().next().value;m=Qe.value.find(Q=>Q.id===V)||null}m||(m=Qe.value[0]||null),Lr.value=!0,m&&(sn.value=m);return}}catch{}Ct.value=!0}async function dl(){var _;try{const m=(_=qt==null?void 0:qt.currentUser)==null?void 0:_.email;if(!m)return;const{resetPlayerPassword:V}=await Yt(()=>Promise.resolve().then(()=>mi),void 0);await V(m),Ce.value=!0,at.value="Email de réinitialisation envoyé.",setTimeout(()=>{Ce.value=!1},3e3)}catch{gr.value=!0,ji.value="Impossible d'envoyer l'email de réinitialisation.",setTimeout(()=>{gr.value=!1},3e3)}}async function uc(){try{await i2(qt),Rn(),Ce.value=!0,at.value="Déconnecté de cet appareil.",setTimeout(()=>{Ce.value=!1},2500)}catch{gr.value=!0,ji.value="Déconnexion impossible.",setTimeout(()=>{gr.value=!1},3e3)}}async function cc(){alert("Suppression de compte: contactez l'organisateur pour dissocier vos joueurs. Fonction complète à venir.")}async function Mi(_){var m;Rn();try{if(_.seasonId&&_.seasonId!==o.value){const V=xe(le,"seasons",_.seasonId),ne=(await mt(He(le,"seasons"))).docs.find(pe=>pe.id===_.seasonId),re=(m=ne==null?void 0:ne.data())==null?void 0:m.slug;if(re){t.push(`/season/${re}?player=${encodeURIComponent(_.playerId)}&open=protection`);return}}else{const V=Qe.value.find(Q=>Q.id===_.playerId);if(V){ln(V);return}t.push(`?player=${encodeURIComponent(_.playerId)}&open=protection`)}}catch{}}br(()=>{try{o.value&&localStorage.getItem(`dismissCreatorOnboarding:${o.value}`)&&(onboardingDismissedShare.value=!0)}catch{}});function hl(){cn(()=>{pl()})}const xr=O(new Set),Xn=O(!0),Ar=O(0),Sr=O("Préparation de la grille"),Pr=O(e.eventId||null),Ls=O(!1),Li=O(null);Nt(()=>e.eventId,_=>{if(_)if(Pr.value=_,qe.value.length>0)bg(_);else{const m=Nt(qe,V=>{V.length>0&&(bg(_),m())},{immediate:!0})}});const on=$e(()=>Qe.value.map(_=>({..._,isProtected:xr.value.has(_.id),email:null}))),dc=$e(()=>Pr.value?kn.value.findIndex(_=>_.id===Pr.value):-1);$e(()=>{if(!Pr.value||dc.value===-1)return!1;if(window.innerWidth<=768){const _=document.querySelector(`[data-event-id="${Pr.value}"]`);if(_){const m=_.getBoundingClientRect();return m.left>=0&&m.right<=window.innerWidth}}return!0});const Cn=O(null),Fs=O(!1),hc=O(!1),fl=O(0),$s=O(null),zn=O(null),No=O(null);function Gn(){const _=Cn.value;if(!_)return;const{scrollLeft:m,scrollWidth:V,clientWidth:Q}=_;Fs.value=m>2,hc.value=m<V-Q-2}function pl(){var _;try{Gn(),fl.value=((_=Cn.value)==null?void 0:_.scrollLeft)||0}catch{}}function Oo(_){const m=Cn.value;if(!m)return;let V=0;const Q=m.querySelector("tbody tr td[data-event-id]");if(Q)V=Q.getBoundingClientRect().width;else if(zn!=null&&zn.value){const re=zn.value.querySelector(".col-event");re&&(V=re.getBoundingClientRect().width)}(!V||!isFinite(V))&&(V=m.clientWidth*.6);const ne=m.scrollLeft+_*V;m.scrollTo({left:ne,behavior:"smooth"})}const Fr=O(null);O(0);const Zn=O(!1),Fi=O(!1),ts=O(0);function Mo(_,m){m&&typeof m.preventDefault=="function"&&m.preventDefault(),pr(),Oo(_)}function Us(_,m){if(m&&typeof m.preventDefault=="function"&&m.preventDefault(),Zn.value)return;Zn.value=!0,ts.value=_,Fi.value=!1;const V=Cn.value;if(!V)return;let Q=0;const ne=V.querySelector("tbody tr td[data-event-id]");if(ne)Q=ne.getBoundingClientRect().width;else if(zn!=null&&zn.value){const Fe=zn.value.querySelector(".col-event");Fe&&(Q=Fe.getBoundingClientRect().width)}(!Q||!isFinite(Q))&&(Q=V.clientWidth*.6);const re=Q/6,pe=120,Ve=()=>{if(!Zn.value||ts.value===0)return;Fi.value||(Fi.value=!0);const Fe=V.scrollLeft+ts.value*re;V.scrollTo({left:Fe,behavior:"auto"}),Fr.value=window.setTimeout(Ve,pe)};Fr.value=window.setTimeout(Ve,250)}function pr(_){_&&typeof _.preventDefault=="function"&&_.preventDefault();const m=Zn.value,V=Fi.value;if(Zn.value=!1,Fr.value&&(clearTimeout(Fr.value),Fr.value=null),_&&typeof _.type=="string"&&_.type.startsWith("touch")&&!V){const Q=ts.value||0;Q!==0&&Oo(Q),ts.value=0;return}ts.value=0,m&&V&&fc()}function fc(){const _=Cn.value;if(!_)return;let m=0;const V=_.querySelector("tbody tr td[data-event-id]");if(V)m=V.getBoundingClientRect().width;else if(zn!=null&&zn.value){const pe=zn.value.querySelector(".col-event");pe&&(m=pe.getBoundingClientRect().width)}if(!m||!isFinite(m)||m<=0)return;const Q=_.scrollLeft,re=Math.round(Q/m)*m;_.scrollTo({left:re,behavior:"smooth"})}function $h(_){P.value=_;const m=document.querySelector(`[data-player-id="${_}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"center"}),Ce.value=!0,at.value="Nouveau joueur ajouté !",setTimeout(()=>{Ce.value=!1},3e3)}function Lo(){if(Ee.value!==1)return;const _=document.querySelector('button[data-onboarding="add-player"]');if(!_)return;const m=_.getBoundingClientRect(),V=document.getElementById("coachmark-add"),Q=280,ne=100,re=V!=null&&V.offsetWidth&&V.offsetWidth>0?V.offsetWidth:Q,pe=V!=null&&V.offsetHeight&&V.offsetHeight>0?V.offsetHeight:ne,Ve=Math.round(m.right+12);if(Ve+re<=window.innerWidth-12){const We=m.top+m.height/2-pe/2,Dt=ml(We+-14,pe);D.value={position:{x:Ve,y:Dt},side:"right"}}else{const We=Math.round(m.left+m.width/2-re/2),ct=ml(m.top-pe-8,pe),Dt=8,Jt=window.innerWidth-re-8;D.value={position:{x:Math.max(Dt,Math.min(We,Jt)),y:ct},side:null}}}function ml(_,m){const V=pageHeaderRef==null?void 0:pageHeaderRef.value,Q=V?Math.max(0,Math.round(V.getBoundingClientRect().height||0)):0,ne=Math.max(12,Q+8),re=window.innerHeight-m-12;return Math.max(ne,Math.min(Math.round(_),re))}const mr=O(!1),ns=O(null),$r=O(null),Fo=O({position:"fixed",top:"0px",right:"0px"});function gl(){try{const _=ns.value;if(!_)return;const m=_.getBoundingClientRect(),V=8,Q=Math.max(V,Math.round(m.bottom+V)),ne=Math.max(V,Math.round(window.innerWidth-m.right));Fo.value={position:"fixed",top:`${Q}px`,right:`${ne}px`,zIndex:400}}catch{}}function pc(){mr.value=!mr.value,mr.value&&cn(()=>gl())}function $o(){mr.value=!1}function vl(_){if(!mr.value)return;const m=ns.value,V=$r.value,Q=m&&m.contains(_.target),ne=V&&V.contains(_.target);!Q&&!ne&&(mr.value=!1)}function Uo(_){_.key==="Escape"&&$o()}function js(){mr.value&&gl()}br(()=>{document.addEventListener("click",vl),document.addEventListener("keydown",Uo),window.addEventListener("scroll",js,{passive:!0}),window.addEventListener("resize",js)}),ca(()=>{document.removeEventListener("click",vl),document.removeEventListener("keydown",Uo),window.removeEventListener("scroll",js),window.removeEventListener("resize",js)});function $i(){var _;Ee.value===1&&((_=D.value)!=null&&_.position)&&Lo()}br(()=>{window.addEventListener("scroll",$i,{passive:!0}),window.addEventListener("resize",$i)}),ca(()=>{window.removeEventListener("scroll",$i),window.removeEventListener("resize",$i)});function Ui(_){return xr.value.has(_)}async function yl(){if(o.value)try{const _=await wp(o.value),m=new Set;_.forEach(V=>{V.isProtected&&m.add(V.playerId||V.id)}),xr.value=m}catch{const m=new Set;for(const V of Qe.value)await vi(V.id,o.value)&&m.add(V.id);xr.value=m}}const Ce=O(!1),at=O(""),gr=O(!1),ji=O("");function rs(){try{const _=`${window.location.origin}/season/${s}`;navigator.clipboard.writeText(_),Ce.value=!0,at.value="Lien copié dans le presse-papiers",setTimeout(()=>{Ce.value=!1},2500)}catch{gr.value=!0,ji.value="Impossible de copier le lien",setTimeout(()=>{gr.value=!1},2500)}}async function vr(_){await Gs({type:"deleteEvent",data:{eventId:_}})}async function jo(_=null){const m=_||c.value;if(console.debug("deleteEventConfirmed"),!m){console.error("Aucun événement à supprimer");return}try{await hN(m,o.value),qe.value=qe.value.filter(V=>V.id!==m),await Promise.all([vp(o.value),ro(Qe.value,qe.value,o.value),so(o.value)]).then(([V,Q,ne])=>{qe.value=V,Bt.value=Q,st.value=ne}),l.value=!1,c.value=null,Ce.value=!0,at.value="Événement supprimé avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors de la suppression de l'événement"),alert("Erreur lors de la suppression de l'événement. Veuillez réessayer.")}}function Bo(){l.value=!1,c.value=null}async function qo(){if(!d.value||!f.value.trim()||!g.value)return;const _=parseInt(y.value);if(isNaN(_)||_<1||_>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}try{const m={title:f.value.trim(),date:g.value,description:ee.value.trim()||"",playerCount:_,archived:!!Y.value};await g_(d.value,m,o.value),!m.archived&&Qe.value.length>0&&xr.value.size>0&&(Ft.value={id:d.value,...m},Ht.value=!0),await Promise.all([vp(o.value),ro(Qe.value,qe.value,o.value),so(o.value)]).then(([V,Q,ne])=>{qe.value=V,Bt.value=Q,st.value=ne}),d.value=null,f.value="",g.value="",ee.value="",y.value=6,Y.value=!1,Ce.value=!0,at.value="Événement mis à jour avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors de l'édition de l'événement"),alert("Erreur lors de l'édition de l'événement. Veuillez réessayer.")}}async function bt(){if(S.value.trim())try{const _=S.value.trim(),m=await bE(_,o.value);await Promise.all([dd(o.value),ro(Qe.value,qe.value,o.value),so(o.value)]).then(([V,Q,ne])=>{Qe.value=V,Bt.value=Q,st.value=ne,yl();const re=Qe.value.find(Ve=>Ve.id===m);$h(m),j.value=m,U.value=kn.value&&kn.value[0]&&kn.value[0].id?kn.value[0].id:null;try{o.value&&localStorage.setItem(`lastAddedPlayerId:${o.value}`,m)}catch{}try{typeof Ee<"u"&&(Ee.value=2)}catch{}const pe=document.querySelector(`[data-player-id="${m}"]`);pe&&pe.scrollIntoView({behavior:"smooth",block:"center"}),cn(()=>{const Ve=`[data-player-id="${j.value}"] td[data-event-id="${U.value}"]`,Fe=document.querySelector(Ve);if(Fe){const We=Fe.getBoundingClientRect();G.value.position={x:Math.round(We.left),y:Math.round(We.top+window.scrollY-48)}}}),Ce.value=!0,at.value="Joueur ajouté avec succès ! Vous pouvez maintenant indiquer sa disponibilité.",setTimeout(()=>{Ce.value=!1},3e3),setTimeout(()=>{Ce.value=!1,at.value=""},5e3)}),x.value=!1,S.value=""}catch{console.error("Erreur lors de l'ajout du joueur"),alert("Erreur lors de l'ajout du joueur. Veuillez réessayer.")}}function Ur(){d.value=null,f.value="",g.value="",ee.value="",y.value=6}O(null);const jr=O(!1),yr=O(""),Bs=O(""),qs=O(""),Bi=O(6),zo=O(!1);async function Uh(){if(!yr.value.trim()||!Bs.value){alert("Veuillez remplir le titre et la date de l'événement");return}const _=parseInt(Bi.value);if(isNaN(_)||_<1||_>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}const m={title:yr.value.trim(),date:Bs.value,description:qs.value.trim()||"",playerCount:_,archived:!!zo.value};await jh(m)}async function jh(_){try{const m=await fN(_,o.value);qe.value=[...qe.value,{id:m,..._}];const V={};for(const Q of Qe.value)V[Q.name]=Bt.value[Q.name]||{},V[Q.name][m]=null,await p_(Q.name,V[Q.name],o.value);yr.value="",Bs.value="",qs.value="",Bi.value=6,zo.value=!1,jr.value=!1,await Promise.resolve(),Ce.value=!0,at.value="Événement créé avec succès !",!_.archived&&Qe.value.length>0&&xr.value.size>0&&(Ft.value={id:m,..._},Ht.value=!0),setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors de la création de l'événement"),alert("Erreur lors de la création de l'événement. Veuillez réessayer.")}}function qi(){yr.value="",Bs.value="",qs.value="",Bi.value=6,jr.value=!1}async function Rr(){await Gs({type:"addEvent",data:{}})}const qe=O([]),Qe=O([]),Bt=O({}),st=O({}),Bh=O({}),_l=O({});Nt([()=>qe.value.length,()=>Qe.value.length,Xn],()=>{Xn.value||cn(()=>{pl()})}),Nt([()=>Qe.value.length,()=>qe.value.length,o],()=>{we()}),br(async()=>{_E("firebase"),await lN();const _=Su(He(le,"seasons"),Ld("slug","==",e.slug)),m=await mt(_);if(m.empty){t.push("/");return}else{const re=m.docs[0];o.value=re.id;const pe=re.data();i.value=pe.name,a.value=pe,document.title=`Saison : ${i.value}`}if(o.value){Sr.value="Chargement des événements de la saison",Ar.value=20;const re=await mt(He(le,"seasons",o.value,"events"));qe.value=re.docs.map(ot=>({id:ot.id,...ot.data(),playerCount:ot.data().playerCount||6})),Sr.value="Chargement des joueurs",Ar.value=45;const pe=await mt(He(le,"seasons",o.value,"players"));Qe.value=pe.docs.map(ot=>({id:ot.id,...ot.data()})),Sr.value="Chargement des disponibilités",Ar.value=70;const Ve=await mt(He(le,"seasons",o.value,"availability")),Fe={};Ve.docs.forEach(ot=>{const Dn=ot.data(),lr={};Object.keys(Dn).forEach(Dr=>{const Ws=Dn[Dr];lr[Dr]=Ws==="oui"?!0:Ws==="non"?!1:Ws}),Fe[ot.id]=lr}),Bt.value=Fe,Sr.value="Chargement des sélections",Ar.value=85;const We=await mt(He(le,"seasons",o.value,"selections")),ct={};We.docs.forEach(ot=>{ct[ot.id]=ot.data().players||[]}),st.value=ct;const Dt=await wp(o.value),Jt=new Set;Array.isArray(Dt)&&Dt.forEach(ot=>{ot.isProtected&&Jt.add(ot.playerId||ot.id)}),xr.value=Jt}const V=re=>{typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>re()):setTimeout(re,0)};Sr.value="Préparation de l'interface",Ar.value=95,V(()=>{wc(),Jo()}),console.debug("players (deduplicated)"),console.debug("availability loaded"),await cn(),Ar.value=100,Xn.value=!1,cn(()=>{Gn(),requestAnimationFrame(()=>Gn()),setTimeout(()=>Gn(),250);const re=Cn.value;re&&(re.addEventListener("scroll",pe=>{Gn(),fl.value=re.scrollLeft||0},{passive:!0}),window.addEventListener("resize",Gn),typeof ResizeObserver<"u"&&(No.value=new ResizeObserver(()=>{Gn()}),No.value.observe(re)))});const Q=r.query.event;if(Q&&qe.value.length>0){const re=qe.value.find(pe=>pe.id===Q);re?(console.debug("Événement trouvé depuis l'URL"),await Hh(Q,re)):(console.warn("Événement non trouvé avec l'ID"),gr.value=!0,ji.value="Événement non trouvé",setTimeout(()=>{gr.value=!1},3e3))}const ne=r.query.player;if(ne&&Qe.value.length>0){const re=Qe.value.find(pe=>pe.id===ne);re&&(ln(re),await cn(),r.query.verified==="1"&&(Ce.value=!0,at.value="Joueur associé à votre compte.",setTimeout(()=>{Ce.value=!1},2500)))}}),Nt(()=>r.params.eventId,_=>{if(_){const m=()=>{const V=qe.value.find(Q=>Q.id===_);return V?(v(V),!0):!1};if(qe.value.length>0)m();else{const V=Nt(qe,Q=>{Q.length>0&&m()&&V()},{immediate:!0})}}},{immediate:!0});function mc(_){if(!_)return null;if(_ instanceof Date)return _;if(typeof(_==null?void 0:_.toDate)=="function")return _.toDate();if(typeof _=="string"||typeof _=="number"){const m=new Date(_);return isNaN(m.getTime())?null:m}return null}const Kn=$e(()=>{let _=null;try{o.value&&(_=localStorage.getItem(`seasonPreferredPlayer:${o.value}`))}catch{}const m=[...Qe.value].sort((pe,Ve)=>(pe.name||"").localeCompare(Ve.name||"","fr",{sensitivity:"base"}));if(!_)return m;let V=[];try{_.startsWith("[")?V=JSON.parse(_):_&&(V=[_])}catch{V=[]}const Q=new Set(V);if(Q.size===0)return m;const ne=m.filter(pe=>Q.has(pe.id)),re=m.filter(pe=>!Q.has(pe.id));return[...ne,...re]}),Go=$e(()=>{try{if(o.value){const _=localStorage.getItem(`seasonPreferredPlayer:${o.value}`);if(!_)return new Set;if(_.startsWith("[")){const m=JSON.parse(_);return new Set(Array.isArray(m)?m:[])}return new Set([_])}}catch{}return new Set}),qh=$e(()=>[...qe.value].sort((_,m)=>{const V=mc(_.date),Q=mc(m.date),ne=V?V.getTime():Number.POSITIVE_INFINITY,re=Q?Q.getTime():Number.POSITIVE_INFINITY;return ne!==re?ne-re:(_.title||"").localeCompare(m.title||"","fr",{sensitivity:"base"})})),Cr=O(!1),kn=$e(()=>{const _=qh.value;return Cr.value?_:_.filter(m=>!m.archived)});function gc(){Cr.value=!Cr.value}const ss=O("selected"),zi=$e(()=>{var V;if(!M.value)return Kn.value;const _=M.value.id,m=new Set(((V=st.value)==null?void 0:V[_])||[]);return Kn.value.filter(Q=>{var Ve;const ne=Q.name,re=(Ve=Bt.value[ne])==null?void 0:Ve[_],pe=m.has(ne);switch(ss.value){case"selected":return pe;case"available":return re===!0&&!pe;case"unavailable":return re===!1;case"unknown":return re!==!0&&re!==!1;case"all":default:return!0}})}),vc=$e(()=>M.value?as(M.value.id):null),bl=$e(()=>{if(!M.value)return!1;const _=as(M.value.id);return _.type==="incomplete"||_.type==="insufficient"}),kt=$e(()=>M.value?zh(M.value.id):"");async function Ko(_,m){const V=Qe.value.find(re=>re.name===_);if(!V){console.error("Joueur non trouvé");return}const Q=qe.value.find(re=>re.id===m);if(!Q){console.error("Événement non trouvé");return}if(Q.archived){Ce.value=!0,at.value="Événement archivé — désarchivez pour modifier",setTimeout(()=>{Ce.value=!1},3e3);return}if(Ui(V.id)){const re=go(V.id),pe=ae.value===V.id;console.debug("Joueur protégé:",{playerId:V.id,hasCachedPassword:re,wasRecentlyVerified:pe,recentlyVerifiedPlayer:ae.value}),re||pe?(console.debug("Session active ou joueur récemment vérifié, procéder au toggle"),pe&&(console.debug("Nettoyage du flag recentlyVerifiedPlayer"),ae.value=null),wl(V,m)):(console.debug("Pas de session, affichage de la modal de vérification"),he.value={playerName:_,eventId:m},de.value=V,ve.value=!0);return}wl(V,m)}function wl(_,m){var ne,re,pe;const V=(ne=Bt.value[_.name])==null?void 0:ne[m];console.debug("toggleAvailability");let Q;V===!0?Q=!1:V===!1?Q=void 0:Q=!0,Q===void 0?Bt.value[_.name]&&delete Bt.value[_.name][m]:(Bt.value[_.name]||(Bt.value[_.name]={}),Bt.value[_.name][m]=Q);try{typeof Ee<"u"&&Ee.value===1&&_.id===(j.value||((re=Kn.value[0])==null?void 0:re.id))&&m===(U.value||((pe=kn.value[0])==null?void 0:pe.id))&&(Ee.value=3,cn(()=>{const Fe=document.querySelector(`[data-player-id="${_.id}"]`);if(Fe){const We=Fe.querySelector(".player-name");if(We){const ct=We.getBoundingClientRect();Z.value.position={x:Math.round(ct.right+8),y:Math.round(ct.top+window.scrollY-4)}}}}),ca(()=>{try{window.removeEventListener("resize",Gn)}catch{}try{No.value&&No.value.disconnect()}catch{}}))}catch{}p_(_.name,Bt.value[_.name],o.value).then(async()=>{await cn(),Jo(),Ce.value=!0,at.value="Disponibilité mise à jour avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}).catch(Ve=>{console.error("Erreur lors de la mise à jour de la disponibilité"),alert("Erreur lors de la mise à jour de la disponibilité. Veuillez réessayer.")})}function _r(_,m){var V;return(V=Bt.value[_])==null?void 0:V[m]}function yc(_,m){var ne;const V=st.value[m]||[],Q=(ne=Bt.value[_])==null?void 0:ne[m];return V.includes(_)&&Q===!0}async function _c(_,m=6){const V=qe.value.find(pe=>pe.id===_),Q=(V==null?void 0:V.playerCount)||6,ne=st.value[_]||[];if(ne.length>0&&ne.every(pe=>_r(pe,_))){console.debug("Tous les joueurs sélectionnés sont disponibles, nouveau tirage complet");const Ve=Qe.value.filter(ct=>_r(ct.name,_)).map(ct=>{const Dt=zs(ct.name);return{name:ct.name,weight:1/(1+Dt)}}),Fe=[],We=[...Ve];for(;Fe.length<Q&&We.length>0;){const ct=We.reduce((ot,Dn)=>ot+Dn.weight,0);let Dt=Math.random()*ct;const Jt=We.findIndex(ot=>(Dt-=ot.weight,Dt<=0));Jt>=0&&(Fe.push(We[Jt].name),We.splice(Jt,1))}st.value[_]=Fe}else{const pe=ne.filter(Fe=>_r(Fe,_)),Ve=Q-pe.length;if(Ve<=0)st.value[_]=pe;else{const Fe=new Set(pe),ct=Qe.value.filter(ot=>_r(ot.name,_)&&!Fe.has(ot.name)).map(ot=>{const Dn=zs(ot.name);return{name:ot.name,weight:1/(1+Dn)}}),Dt=[],Jt=[...ct];for(;Dt.length<Ve&&Jt.length>0;){const ot=Jt.reduce((Dr,Ws)=>Dr+Ws.weight,0);let Dn=Math.random()*ot;const lr=Jt.findIndex(Dr=>(Dn-=Dr.weight,Dn<=0));lr>=0&&(Dt.push(Jt[lr].name),Jt.splice(lr,1))}st.value[_]=[...pe,...Dt]}}await m_(_,st.value[_],o.value),wc(),Jo()}async function Gi(_,m=6){var pe,Ve;console.debug("tirerProtected appelé"),console.debug("etat modal selection avant");const V=Te.value,Q=(pe=Re.value)==null?void 0:pe.id,ne=st.value[_]&&st.value[_].length>0,re=ne?[...st.value[_]]:[];if(await _c(_,m),console.debug("etat modal selection apres"),V&&!Te.value&&(console.debug("Restauration de la popin de sélection..."),Te.value=!0,Re.value=qe.value.find(Fe=>Fe.id===Q)),Te.value&&((Ve=Re.value)==null?void 0:Ve.id)===_)if(console.debug("Popin de sélection ouverte, mise à jour..."),await cn(),Ne.value&&Ne.value.showSuccess){console.debug("Appel de showSuccess sur la popin de sélection");const Fe=st.value[_]||[],We=re.filter(Dt=>Fe.includes(Dt)),ct=We.length>0&&We.length<re.length;Ne.value.showSuccess(ne,ct)}else console.debug("showSuccess indisponible");else console.debug("Popin de sélection fermée, affichage message global"),Ce.value=!0,qe.value.find(Fe=>Fe.id===_),st.value[_],ne?at.value="Sélection mise à jour avec succès !":at.value="Sélection effectuée avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}function Ho(_){_===0?D.value.position=null:_===1?G.value.position=null:_===2&&(Z.value.position=null)}function kr(_){var V;return _?(typeof _=="string"?new Date(_):((V=_.toDate)==null?void 0:V.call(_))||_).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):""}function Wo(_){var V;return _?(typeof _=="string"?new Date(_):((V=_.toDate)==null?void 0:V.call(_))||_).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function zs(_){return Object.values(st.value).filter(m=>m.includes(_)).length}function is(_){const m=Bt.value[_]||{};return Object.values(m).filter(V=>V===!0).length}function Ki(_){return _?Object.values(Bt.value).filter(m=>m[_]===!0).length:0}function Hi(_){return _?(st.value[_]||[]).length:0}function Wi(_){const m=qe.value.find(Q=>Q.id===_),V=(m==null?void 0:m.playerCount)||6;return Hi(_)>=V}function bc(_){const m=is(_),V=zs(_);return m===0?0:V/m}function Qo(_){Bh.value[_]={availability:is(_),selection:zs(_),ratio:bc(_)}}function wc(){Qe.value.forEach(_=>Qo(_.name))}function Jo(){const _={};qe.value.forEach(m=>{const V=m.playerCount||6,ne=Qe.value.filter(pe=>_r(pe.name,m.id)===!0).map(pe=>{const Ve=zs(pe.name);return{name:pe.name,weight:1/(1+Ve)}}),re=ne.reduce((pe,Ve)=>pe+Ve.weight,0);ne.forEach(pe=>{const Ve=Math.min(1,pe.weight/re*V);_[pe.name]||(_[pe.name]={}),_[pe.name][m.id]=Math.round(Ve*100)})}),_l.value=_}const Br=O(null),Qi=O(!1);async function Ic(_=null){const m=_||Br.value;if(!m){console.error("Aucun joueur à supprimer");return}try{await uN(m,o.value),Qe.value=Qe.value.filter(V=>V.id!==m),Qi.value=!1,Br.value=null,Ce.value=!0,at.value="Joueur supprimé avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors de la suppression du joueur"),alert("Erreur lors de la suppression du joueur. Veuillez réessayer.")}}function Il(){Qi.value=!1,Br.value=null}async function El(_){fn(),await vi(_,o.value)?await os({type:"deletePlayer",data:{playerId:_}}):await Gs({type:"deletePlayer",data:{playerId:_}})}async function Ec(){if(T.value){const _=qe.value.find(V=>V.id===T.value),m=(_==null?void 0:_.playerCount)||6;await Gi(T.value,m),me.value=!1,T.value=null}}function Yo(){me.value=!1,T.value=null}function Tc(){return B.value?{deleteEvent:"Suppression d'événement - Code PIN requis",addEvent:"Ajout d'événement - Code PIN requis",deletePlayer:"Suppression de joueur - Code PIN requis",launchSelection:"Lancement de sélection - Code PIN requis",toggleArchive:"Archivage d'événement - Code PIN requis",updateSelection:"Mise à jour de sélection - Code PIN requis"}[B.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function Gs(_){if(Tn.isPinCached(o.value)){const m=Tn.getCachedPin(o.value);if(console.debug("PIN en cache trouvé, utilisation automatique"),await Bd(o.value,m)){await u(_);return}else Tn.clearSession()}B.value=_,N.value=!0}async function os(_){const m=_.data.playerId;try{if(Tn.isPinCached(o.value)){console.debug("PIN de saison en cache — saut de la demande de mot de passe joueur"),await u(_);return}}catch{}if(go(m)){console.debug("Mot de passe du joueur en cache trouvé, utilisation automatique"),await u(_);return}Et.value=_,Pt.value=!0}async function xc(_){try{if(await Bd(o.value,_)){Tn.saveSession(o.value,_),N.value=!1;const V=B.value;B.value=null,await u(V)}else R.value="Code PIN incorrect",setTimeout(()=>{R.value=""},3e3)}catch{console.error("Erreur lors de la vérification du PIN"),R.value="Erreur lors de la vérification du code PIN"}}function Ac(){N.value=!1,B.value=null,R.value=""}async function Tl(_){if(_){Ue.value=!0,Xe.value="";try{const m=Et.value.data.playerId,V=await mp(o.value);if(_===V){try{Tn.saveSession(o.value,_)}catch{}try{Pi.saveSession(Et.value.data.playerId)}catch{}Pt.value=!1;const ne=Et.value;Et.value=null,Le.value="",await u(ne);return}if(await verifyPlayerPassword(m,_,o.value)){Pt.value=!1;const ne=Et.value;Et.value=null,Le.value="",await u(ne)}else Xe.value="Mot de passe incorrect",setTimeout(()=>{Xe.value=""},3e3)}catch{console.error("Erreur lors de la vérification du mot de passe"),Xe.value="Erreur lors de la vérification du mot de passe"}finally{Ue.value=!1}}}function Sc(){Pt.value=!1,Et.value=null,Xe.value="",Le.value="",Ue.value=!1}async function Ji(_){if(_){ze.value=!0,fe.value="";try{const m=Rt.value.data.player,V=await mp(o.value);if(_===V){try{Tn.saveSession(o.value,_)}catch{}try{Pi.saveSession(Rt.value.data.player.id)}catch{}rn.value=!1;const ne=Rt.value;Rt.value=null,oe.value="",await u(ne);return}if(await verifyPlayerPassword(m.id,_,o.value)){rn.value=!1;const ne=Rt.value;Rt.value=null,oe.value="",await u(ne)}else fe.value="Mot de passe incorrect",setTimeout(()=>{fe.value=""},3e3)}catch{console.error("Erreur lors de la vérification du mot de passe"),fe.value="Erreur lors de la vérification du mot de passe"}finally{ze.value=!1}}}function Hn(){rn.value=!1,Rt.value=null,fe.value="",oe.value="",ze.value=!1}async function Pc(){k.value=!0,L.value="",J.value="";try{const _=Rt.value.data.player,m=await sendPasswordResetEmail(_.id,o.value);J.value=m.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch{console.error("Erreur lors de l'envoi de l'email"),L.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{k.value=!1}}async function Rc(){Pe.value=!0,Oe.value="",E.value="";try{const _=Et.value.data.playerId,m=await sendPasswordResetEmail(_,o.value);E.value=m.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch{console.error("Erreur lors de l'envoi de l'email"),Oe.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{Pe.value=!1}}function Ks(){return Tn.isPinCached(o.value)?{timeRemaining:Tn.getTimeRemaining(),isExpiringSoon:Tn.isExpiringSoon()}:null}async function u(_){var Q;if(!_)return;const{type:m,data:V}=_;try{switch(m){case"deleteEvent":console.debug("executePendingOperation - data.eventId reçu"),c.value=V.eventId,l.value=!0;break;case"addEvent":jr.value=!0;break;case"deletePlayer":Br.value=V.playerId,Qi.value=!0;break;case"launchSelection":st.value[V.eventId]&&st.value[V.eventId].length>0?(T.value=V.eventId,me.value=!0,A.value=!1):(await Gi(V.eventId,V.count),A.value=!1);break;case"toggleAvailability":wl(V.player,V.eventId);break;case"toggleArchive":await setEventArchived(V.eventId,V.archived,o.value);{const ne=qe.value.findIndex(re=>re.id===V.eventId);ne!==-1&&(qe.value[ne]={...qe.value[ne],archived:!!V.archived}),Y.value=!!V.archived}break;case"updateSelection":{const{eventId:ne,players:re}=V,pe=[...st.value[ne]||[]],Ve=Array.isArray(re)?re:[];await m_(ne,Ve,o.value),st.value[ne]=Ve;try{const Fe=pe.filter(We=>!Ve.includes(We));if(Fe.length>0){const We=qe.value.find(ct=>ct.id===ne);await tO({eventId:ne,eventData:We,removedPlayers:Fe,newSelectedPlayers:Ve,seasonId:o.value,seasonSlug:s,players:on.value})}}catch{}try{(Q=Ne.value)==null||Q.showSuccess(!0,!0)}catch{}}break}}catch{console.error("Erreur lors de l'exécution de l'opération"),Ce.value=!0,at.value="Erreur lors de l'opération. Veuillez réessayer.",setTimeout(()=>{Ce.value=!1},3e3)}}function p(){t.push("/")}ca(()=>{const _=Cn.value;_&&_.removeEventListener("scroll",Gn),window.removeEventListener("resize",Gn)});async function v(_){M.value=_,ee.value=_.description||"",Y.value=!!_.archived;try{const[m,V]=await Promise.all([ro(Qe.value,qe.value,o.value),so(o.value)]);Bt.value=m,st.value=V}catch(m){console.warn("Impossible de rafraîchir les données avant ouverture des détails:",m)}A.value=!0}function b(){A.value=!1,M.value=null,ee.value="",te.value=!1}function q(){b(),r.params.eventId&&t.push(`/season/${e.slug}`)}async function H(_,m){console.debug("handleAvailabilityToggle appelé");const V=Qe.value.find(re=>re.name===_);if(!V){console.error("Joueur non trouvé");return}const Q=qe.value.find(re=>re.id===m);if(Q!=null&&Q.archived){Ce.value=!0,at.value="Événement archivé — désarchivez pour modifier",setTimeout(()=>{Ce.value=!1},3e3);return}console.debug("Joueur trouvé");const ne=Ui(V.id);if(console.debug("Joueur protégé"),ne){go(V.id)?(console.debug("Session active, procéder au toggle"),await Ko(_,m)):(console.debug("Demande du mot de passe pour joueur protégé"),he.value={playerName:_,eventId:m},de.value=V,ve.value=!0);return}console.debug("Joueur non protégé, procéder au toggle"),await Ko(_,m)}function _e(_,m){return(st.value[m]||[]).includes(_)}async function gt(_){if(console.debug("Mot de passe vérifié"),de.value&&(ae.value=de.value.id,console.debug("Joueur marqué comme récemment vérifié")),he.value){const{playerName:m,eventId:V}=he.value;console.debug("Exécution de l'action en attente"),await Ko(m,V),he.value=null}else console.debug("Aucune action en attente trouvée");ve.value=!1,de.value=null}function an(){d.value=M.value.id,f.value=M.value.title,g.value=M.value.date,ee.value=M.value.description||"",y.value=M.value.playerCount||6,A.value=!1}async function it(){if(M.value)try{const _=!M.value.archived,m={...M.value,archived:_};await g_(M.value.id,m,o.value),M.value.archived=_;const V=qe.value.findIndex(Q=>Q.id===M.value.id);V!==-1&&(qe.value[V].archived=_),Ce.value=!0,at.value=_?"Événement archivé avec succès !":"Événement désarchivé avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors de la modification de l'archivage"),alert("Erreur lors de la modification de l'archivage. Veuillez réessayer.")}}function ln(_){I.value=_,w.value=!0;try{typeof Ee<"u"&&Ee.value}catch{}}function fn(){w.value=!1,I.value=null}async function Hs({playerId:_,newName:m}){try{await cN(_,m,o.value),await Promise.all([dd(o.value),ro(Qe.value,qe.value,o.value),so(o.value)]).then(([V,Q,ne])=>{if(Qe.value=V,Bt.value=Q,st.value=ne,yl(),I.value&&I.value.id===_){const re=V.find(pe=>pe.id===_);re&&(I.value=re)}}),Ce.value=!0,at.value="Joueur mis à jour avec succès !",setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors de l'édition du joueur"),alert("Erreur lors de l'édition du joueur. Veuillez réessayer.")}}async function ar(){try{await Promise.all([dd(o.value),ro(Qe.value,qe.value,o.value),so(o.value)]).then(([_,m,V])=>{if(Qe.value=_,Bt.value=m,st.value=V,yl(),I.value){const Q=_.find(ne=>ne.id===I.value.id);Q&&(I.value=Q)}}),Ce.value=!0,at.value="Données mises à jour !",setTimeout(()=>{Ce.value=!1},3e3)}catch{console.error("Erreur lors du rafraîchissement")}}function Xo(_){if(!_)return{availability:0,selection:0,ratio:0};const m=is(_.name),V=zs(_.name),Q=m===0?0:Math.round(V/m*100);return{availability:m,selection:V,ratio:Q}}function as(_){const m=st.value[_]||[],V=qe.value.find(re=>re.id===_),Q=(V==null?void 0:V.playerCount)||6,ne=Ki(_);if(m.length>0){const re=m.some(Ve=>!_r(Ve,_)),pe=ne<Q;if(re||pe)return{type:"incomplete",hasUnavailablePlayers:re,hasInsufficientPlayers:pe,unavailablePlayers:m.filter(Ve=>!_r(Ve,_)),availableCount:ne,requiredCount:Q}}return ne<Q?{type:"insufficient",availableCount:ne,requiredCount:Q}:m.length===0?{type:"ready",availableCount:ne,requiredCount:Q}:{type:"complete",availableCount:ne,requiredCount:Q}}function UE(_){const m=as(_);return m.type==="incomplete"||m.type==="insufficient"}function zh(_){const m=as(_);switch(m.type){case"incomplete":return m.hasUnavailablePlayers?m.unavailablePlayers.length===1?`Sélection incomplète : ${m.unavailablePlayers[0]} n'est plus disponible`:`Sélection incomplète : ${m.unavailablePlayers.length} joueurs ne sont plus disponibles`:`Sélection incomplète : ${m.availableCount} joueurs disponibles pour ${m.requiredCount} requis`;case"insufficient":return`Pas assez de joueurs : ${m.availableCount} disponibles pour ${m.requiredCount} requis`;case"ready":return`Prêt pour la sélection : ${m.availableCount} joueurs disponibles`;case"complete":return`Sélection complète : ${m.availableCount} joueurs disponibles`;default:return""}}async function jE({eventId:_,eventData:m,reason:V}){if(!o.value)return;const Q={id:_,...m};if(Q.archived){console.debug("Événement archivé, aucune notification envoyée"),Ce.value=!0,at.value="Aucune notification envoyée : événement archivé",setTimeout(()=>{Ce.value=!1},3e3);return}const ne=[];for(const re of Qe.value){if(!await vi(re.id,o.value))continue;const Ve=await DE(re.id,o.value);if(Ve)try{const Fe=await yp({seasonId:o.value,playerId:re.id,eventId:Q.id,action:"yes"}),We=await yp({seasonId:o.value,playerId:re.id,eventId:Q.id,action:"no"}),ct=`${Fe.url}&slug=${encodeURIComponent(s)}`,Dt=`${We.url}&slug=${encodeURIComponent(s)}`;await JN({toEmail:Ve,playerName:re.name,eventTitle:Q.title,eventDate:Wo(Q.date),yesUrl:ct,noUrl:Dt,reason:V})}catch{console.error("Email non envoyé pour un joueur"),ne.push(re.id)}}Ce.value=!0,at.value=ne.length>0?`Emails envoyés (avec ${ne.length} échec(s))`:"Emails envoyés aux joueurs protégés.",setTimeout(()=>{Ce.value=!1},3e3)}function Gh(_){if(_!=null&&_.archived){Ce.value=!0,at.value="Impossible d'annoncer un événement archivé",setTimeout(()=>{Ce.value=!1},3e3);return}vg(),Je.value=_,Be.value=!0}function gg(){Be.value=!1,Je.value=null}function vg(){Ht.value=!1,Ft.value=null}async function yg({eventId:_,eventData:m,reason:V,selectedPlayers:Q}){try{V==="selection"?(await eO({eventId:_,eventData:m,selectedPlayers:Q,seasonId:o.value,seasonSlug:s,players:on.value}),Kh(),Ce.value=!0,at.value="Notifications de sélection envoyées avec succès !",setTimeout(()=>{Ce.value=!1},3e3)):(await jE({eventId:_,eventData:m,reason:V}),gg(),Ce.value=!0,at.value="Notifications envoyées avec succès !",setTimeout(()=>{Ce.value=!1},3e3))}catch{console.error("Erreur lors de l'envoi des notifications"),Ce.value=!0,at.value="Erreur lors de l'envoi des notifications",setTimeout(()=>{Ce.value=!1},3e3)}}function _g(_){if(!_)return{};const m={};return Qe.value.forEach(V=>{m[V.name]=_r(V.name,_)}),m}function Cc(_){if(_!=null&&_.archived){Ce.value=!0,at.value="Impossible d'ouvrir la sélection sur un événement archivé",setTimeout(()=>{Ce.value=!1},3e3);return}Re.value=_,Te.value=!0}function Kh(){Te.value=!1,Re.value=null}async function BE(){if(!Re.value)return;const _=Re.value.id,m=Re.value.playerCount||6;if(Ki(_)===0){Ce.value=!0,at.value="Aucun joueur disponible pour cet événement",setTimeout(()=>{Ce.value=!1},3e3);return}await Gs({type:"launchSelection",data:{eventId:_,count:m}})}function qE(){Kh(),Ce.value=!0,at.value="Sélection validée !",setTimeout(()=>{Ce.value=!1},3e3)}async function zE(_){if(!_||!_.eventId)return;const{eventId:m,players:V}=_;await Gs({type:"updateSelection",data:{eventId:m,players:V}})}async function Hh(_,m){if(!_||!m)return;wg(),Pr.value=_,Ls.value=!0,await cn();const V=document.querySelector(`[data-event-id="${_}"]`);if(!V){console.warn("Élément événement non trouvé dans le DOM");return}document.querySelectorAll(".focused-event-highlight").forEach(pe=>{pe.classList.remove("focused-event-highlight")});const Q=document.querySelectorAll(`[data-event-id="${_}"]`);Q.forEach(pe=>{pe.classList.add("focused-event-highlight")});const ne=Q[0],re=Q[Q.length-1];ne&&ne.classList.add("focused-event-column-start"),re&&re.classList.add("focused-event-column-end"),await GE(V),Ce.value=!0,at.value=`Événement ciblé : ${m.title}`,setTimeout(()=>{Ce.value=!1},4e3),Li.value=setTimeout(()=>{wg()},8e3)}function bg(_){if(!_)return;const m=qe.value.find(V=>V.id===_);if(!m){console.warn("Événement non trouvé dans la liste des événements"),setTimeout(()=>{const V=qe.value.find(Q=>Q.id===_);V?Hh(_,V):console.error("Événement toujours introuvable après retry")},500);return}Hh(_,m)}async function GE(_){if(!_)return;if(await new Promise(V=>setTimeout(V,100)),window.innerWidth<=768){const V=Cn.value;if(V){const Q=_.offsetLeft,ne=_.offsetWidth,re=V.clientWidth,pe=Q-re/2+ne/2,Ve=V.scrollWidth-re,Fe=Math.max(0,Math.min(pe,Ve));V.scrollTo({left:Fe,behavior:"smooth"}),setTimeout(()=>{const We=_.getBoundingClientRect();if(We.left<0||We.right>window.innerWidth){const ct=Q-20;V.scrollTo({left:Math.max(0,ct),behavior:"smooth"})}},500)}}else _.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});const m=Cn.value;m&&setTimeout(()=>{const V=document.querySelector(`[data-event-id="${Pr.value}"]`);if(V&&V.closest("tbody")){const Q=V.offsetLeft,ne=V.offsetWidth,re=m.clientWidth,pe=Q-re/2+ne/2,Ve=m.scrollWidth-re,Fe=Math.max(0,Math.min(pe,Ve));m.scrollTo({left:Fe,behavior:"smooth"})}},300)}function wg(){Li.value&&(clearTimeout(Li.value),Li.value=null),Pr.value=null,Ls.value=!1,document.querySelectorAll(".focused-event-highlight").forEach(_=>{_.classList.remove("focused-event-highlight")}),document.querySelectorAll(".focused-event-column-start, .focused-event-column-end").forEach(_=>{_.classList.remove("focused-event-column-start","focused-event-column-end")})}return(_,m)=>{var V,Q,ne,re,pe,Ve,Fe,We,ct,Dt,Jt,ot,Dn,lr,Dr,Ws,Ig,Eg,Tg,xg;return F(),$(vt,null,[h("div",AF,[h("div",SF,[h("button",{onClick:p,class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Retour à l'accueil"},m[70]||(m[70]=[h("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),h("h1",PF,ue(i.value?i.value:"Chargement..."),1),h("div",RF,[h("div",CF,[h("button",{onClick:Oi,class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Mon compte","aria-label":"Mon compte"},m[71]||(m[71]=[h("span",{class:"text-2xl"},"👤",-1)])),h("button",{onClick:m[0]||(m[0]=W=>vn.value=!0),class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Kezako ?","aria-label":"Kezako ?"},m[72]||(m[72]=[h("span",{class:"text-2xl"},"❓",-1)]))]),h("div",{class:"relative md:hidden",ref_key:"headerMenuRef",ref:ns},[h("button",{onClick:m[1]||(m[1]=Vt(W=>{pc(),gl()},["stop"])),class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Menu","aria-label":"Menu"},m[73]||(m[73]=[h("span",{class:"text-2xl"},"⋯",-1)]))],512),(F(),cu(FT,{to:"body"},[mr.value?(F(),$("div",{key:0,ref_key:"headerMenuDropdownRef",ref:$r,class:"w-48 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[400] overflow-hidden",style:ds(Fo.value)},[h("button",{onClick:m[2]||(m[2]=W=>{Oi(),$o()}),class:"w-full text-left px-4 py-3 text-white hover:bg-white/10 flex items-center gap-2"},m[74]||(m[74]=[h("span",null,"👤",-1),h("span",{class:"text-sm"},"Mon compte",-1)])),h("button",{onClick:m[3]||(m[3]=W=>{vn.value=!0,$o()}),class:"w-full text-left px-4 py-3 text-white hover:bg-white/10 flex items-center gap-2"},m[75]||(m[75]=[h("span",null,"❓",-1),h("span",{class:"text-sm"},"Kezako ?",-1)]))],4)):ce("",!0)]))])],512),h("div",kF,[h("div",{ref_key:"headerBarRef",ref:$s,class:"sticky top-0 z-[80] bg-gray-900 overflow-hidden"},[h("div",DF,[qe.value.length===0&&Qe.value.length===0?ce("",!0):(F(),$("div",VF,[h("div",{class:"flex items-center justify-center h-full gap-2"},[h("button",{onClick:Rr,class:"flex items-center space-x-2 px-3 py-2 md:px-4 md:py-2 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl text-sm md:text-base font-medium",title:"Ajouter un nouvel événement"},m[76]||(m[76]=[h("span",{class:"text-lg"},"➕",-1),h("span",{class:"hidden sm:inline"},"Ajouter un événement",-1),h("span",{class:"sm:hidden"},"Événement",-1)]))])])),h("div",NF,[h("div",{ref_key:"headerEventsRef",ref:zn,class:"flex relative z-[60]",style:ds({transform:`translateX(-${fl.value}px)`})},[(F(!0),$(vt,null,ur(kn.value,W=>(F(),$("div",{key:"h-"+W.id,"data-event-id":W.id,class:zt(["col-event flex-shrink-0 p-3 text-center cursor-pointer",{"archived-header":W.archived}]),onClick:Vn=>v(W)},[h("div",{class:"header-date text-[16px] md:text-base text-gray-300",title:Wo(W.date)},ue(kr(W.date)),9,MF),h("div",{class:"header-title text-[22px] md:text-2xl leading-snug text-white text-center clamp-2",title:W.title},ue(W.title||"Sans titre"),9,LF),W.archived?(F(),$("div",FF,"(Archivé)")):ce("",!0),UE(W.id)?(F(),$("div",{key:1,class:"mt-1 w-4 h-4 bg-yellow-500 rounded-full mx-auto flex items-center justify-center hover:bg-yellow-400 transition-colors duration-200",title:zh(W.id)+" - Cliquez pour ouvrir la sélection",onClick:Vt(Vn=>Cc(W),["stop"])},m[77]||(m[77]=[h("span",{class:"text-xs text-white font-bold"},"⚠️",-1)]),8,$F)):as(W.id).type==="ready"?(F(),$("div",{key:2,class:"mt-1 w-4 h-4 bg-green-500 rounded-full mx-auto flex items-center justify-center hover:bg-green-400 transition-colors duration-200",title:zh(W.id)+" - Cliquez pour ouvrir la sélection",onClick:Vt(Vn=>Cc(W),["stop"])},m[78]||(m[78]=[h("span",{class:"text-xs text-white font-bold"},"🎲",-1)]),8,UF)):ce("",!0)],10,OF))),128))],4)]),m[81]||(m[81]=h("div",{class:"col-right flex-shrink-0 p-3 sticky right-0 z-[81] bg-gray-900 h-full"},null,-1)),h("button",{onClick:gc,class:"absolute right-2 top-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[86] backdrop-blur-sm",title:Cr.value?"Masquer les événements archivés":"Afficher les événements archivés","aria-label":Cr.value?"Masquer les événements archivés":"Afficher les événements archivés"},[(F(),$("svg",BF,[m[79]||(m[79]=h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.25 12c1.5-4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z"},null,-1)),m[80]||(m[80]=h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)),Cr.value?ce("",!0):(F(),$("path",qF))]))],8,jF),Ze(h("button",{onClick:m[4]||(m[4]=Vt(W=>Mo(-1,W),["prevent"])),onMousedown:m[5]||(m[5]=Vt(W=>Us(-1,W),["prevent"])),onMouseup:m[6]||(m[6]=W=>pr(W)),onMouseleave:m[7]||(m[7]=W=>pr(W)),onTouchstart:m[8]||(m[8]=Vt(W=>Us(-1,W),["prevent"])),onTouchend:m[9]||(m[9]=W=>pr(W)),onTouchcancel:m[10]||(m[10]=W=>pr(W)),class:"absolute left-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"Événements précédents — cliquez pour défiler"}," ‹ ",544),[[nf,Fs.value]]),Ze(h("button",{onClick:m[11]||(m[11]=Vt(W=>Mo(1,W),["prevent"])),onMousedown:m[12]||(m[12]=Vt(W=>Us(1,W),["prevent"])),onMouseup:m[13]||(m[13]=W=>pr(W)),onMouseleave:m[14]||(m[14]=W=>pr(W)),onTouchstart:m[15]||(m[15]=Vt(W=>Us(1,W),["prevent"])),onTouchend:m[16]||(m[16]=W=>pr(W)),onTouchcancel:m[17]||(m[17]=W=>pr(W)),class:"absolute right-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"Événements suivants — cliquez pour défiler"}," › ",544),[[nf,hc.value]])])],512),Ze(h("div",{ref_key:"gridboardRef",ref:Cn,class:"gridboard overflow-x-auto bg-gradient-to-br from-blue-900/50 via-purple-900/50 to-indigo-900/50"},[Ee.value===1?(F(),$("div",zF,[D.value.position?(F(),$("div",{key:0,class:"fixed z-[400]",style:ds({left:D.value.position.x+"px",top:D.value.position.y+"px"})},[h("div",{id:"coachmark-add",class:zt(["coachmark pointer-events-auto max-w-sm bg-gray-900 border border-purple-500/40 rounded-xl shadow-2xl p-3 text-white relative",{"coachmark-right":D.value.side==="right","coachmark-left":D.value.side==="left"}])},[m[83]||(m[83]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Ajoutez votre nom",-1)),m[84]||(m[84]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},'Cliquez sur "Ajouter un joueur" pour vous inscrire',-1)),h("div",GF,[m[82]||(m[82]=h("span",{class:"text-purple-300 text-base md:text-sm"},"Étape 1/4",-1)),h("button",{onClick:m[18]||(m[18]=W=>Ho(0)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant >")])],2)],4)):ce("",!0)])):ce("",!0),Ee.value===2&&j.value&&U.value?(F(),$("div",KF,[G.value.position?(F(),$("div",{key:0,class:"fixed z-[400]",style:ds({position:"absolute",left:G.value.position.x+"px",top:G.value.position.y+"px"})},[h("div",HF,[m[86]||(m[86]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Indiquez vos disponibilités",-1)),m[87]||(m[87]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},"Cliquez cette case pour alterner Oui / Non / Vide",-1)),h("div",WF,[m[85]||(m[85]=h("span",{class:"text-pink-300 text-base md:text-sm"},"Étape 2/4",-1)),h("button",{onClick:m[19]||(m[19]=W=>Ho(1)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant")])])],4)):ce("",!0)])):ce("",!0),Ee.value===3&&j.value?(F(),$("div",QF,[Z.value.position?(F(),$("div",{key:0,class:"fixed z-[400]",style:ds({position:"absolute",left:Z.value.position.x+"px",top:Z.value.position.y+"px"})},[h("div",JF,[m[89]||(m[89]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Ouvrez votre fiche",-1)),m[90]||(m[90]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},"Cliquez sur votre nom pour voir les détails et la protection",-1)),h("div",YF,[m[88]||(m[88]=h("span",{class:"text-yellow-300 text-base md:text-sm"},"Étape 3/4",-1)),h("button",{onClick:m[20]||(m[20]=W=>Ho(2)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant")])])],4)):ce("",!0)])):ce("",!0),h("table",XF,[h("colgroup",null,[m[91]||(m[91]=h("col",{class:"col-left"},null,-1)),(F(!0),$(vt,null,ur(kn.value,(W,Vn)=>(F(),$("col",{key:"c"+Vn,class:"col-event"}))),128)),m[92]||(m[92]=h("col",{class:"col-right"},null,-1))]),m[96]||(m[96]=h("thead",{class:"hidden"},null,-1)),h("tbody",null,[(F(!0),$(vt,null,ur(Kn.value,W=>{var Vn;return F(),$("tr",{key:W.id,class:zt(["border-b border-white/10 hover:bg-white/5 transition-all duration-200",{"highlighted-player":W.id===P.value,"preferred-player":Go.value.has(W.id)}]),"data-player-id":W.id},[h("td",e4,[h("div",t4,[Ui(W.id)?(F(),$("span",n4," 🔒 ")):ce("",!0),h("span",{onClick:er=>ln(W),class:zt(["player-name hover:border-b-2 hover:border-dashed hover:border-purple-400 cursor-pointer transition-colors duration-200 text-[22px] md:text-2xl leading-tight block truncate max-w-full flex-1 min-w-0",{"inline-block rounded px-1 ring-2 ring-yellow-400 animate-pulse":Ee.value===3&&W.id===(j.value||((Vn=Kn.value[0])==null?void 0:Vn.id))}]),title:"Cliquez pour voir les détails : "+W.name},ue(W.name),11,r4)])]),(F(!0),$(vt,null,ur(kn.value,er=>{var Ag,Sg,Pg;return F(),$("td",{key:er.id,"data-event-id":er.id,class:zt(["p-0",er.archived?"archived-col":"",{"relative ring-2 ring-pink-400 rounded-md animate-pulse":Ee.value===2&&W.id===(j.value||((Ag=Kn.value[0])==null?void 0:Ag.id))&&er.id===(U.value||((Sg=kn.value[0])==null?void 0:Sg.id))}])},[ut(b_,{"player-name":W.name,"event-id":er.id,"is-available":_r(W.name,er.id),"is-selected":yc(W.name,er.id),"chance-percent":((Pg=_l.value[W.name])==null?void 0:Pg[er.id])??null,"show-selected-chance":Wi(er.id),disabled:er.archived===!0,onToggle:Ko},null,8,["player-name","event-id","is-available","is-selected","chance-percent","show-selected-chance","disabled"])],10,s4)}),128)),m[93]||(m[93]=h("td",{class:"p-3 md:p-4"},null,-1))],10,ZF)}),128)),h("tr",i4,[h("td",o4,[h("div",a4,[h("button",{onClick:m[21]||(m[21]=W=>x.value=!0),class:"w-full md:w-auto flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 text-sm md:text-base font-medium",title:"Ajouter un nouveau joueur","data-onboarding":"add-player"},m[94]||(m[94]=[h("span",{class:"text-lg"},"➕",-1),h("span",{class:"hidden sm:inline"},"Ajouter un joueur",-1),h("span",{class:"sm:hidden"},"Joueur",-1)]))])]),(F(!0),$(vt,null,ur(kn.value,W=>(F(),$("td",{key:"add-row-"+W.id,"data-event-id":W.id,class:zt(["p-3 md:p-5",W.archived?"archived-col":""])},null,10,l4))),128)),m[95]||(m[95]=h("td",{class:"p-3 md:p-4"},null,-1))])])])],512),[[nf,!Xn.value]])])]),Xn.value?(F(),$("div",u4,[h("div",c4,[m[97]||(m[97]=h("div",{class:"w-20 h-20 rounded-full bg-gradient-to-br from-pink-500 to-purple-600 animate-pulse mx-auto mb-6 flex items-center justify-center shadow-2xl"},[h("span",{class:"text-3xl"},"🎭")],-1)),h("p",d4,ue(Sr.value)+"…",1),h("div",h4,[h("div",{class:"h-full bg-gradient-to-r from-pink-500 to-purple-600 transition-all duration-300",style:ds({width:Ar.value+"%"})},null,4)]),h("p",f4,ue(Ar.value)+"%",1)])])):ce("",!0),Xn.value?ce("",!0):(F(),cu(BL,{key:1,"season-id":o.value,"season-slug":ys(s),"players-count":Qe.value.length,"events-count":qe.value.length,"onboarding-done":((V=a.value)==null?void 0:V.onboardingCreatorDone)===!0,onCreateEvent:Rr,onAddPlayer:m[22]||(m[22]=()=>{x.value=!0}),onCopyLink:rs,onDismissed:hl},null,8,["season-id","season-slug","players-count","events-count","onboarding-done"])),ce("",!0),Ce.value?(F(),$("div",p4,[h("div",m4,[m[98]||(m[98]=h("span",{class:"text-xl"},"✨",-1)),h("span",null,ue(at.value),1)])])):ce("",!0),gr.value?(F(),$("div",g4,[h("div",v4,[m[99]||(m[99]=h("span",{class:"text-xl"},"⚠️",-1)),h("span",null,ue(ji.value),1)])])):ce("",!0),jr.value?(F(),$("div",y4,[h("div",_4,[m[105]||(m[105]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvel événement",-1)),h("div",b4,[m[100]||(m[100]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),Ze(h("input",{"onUpdate:modelValue":m[23]||(m[23]=W=>yr.value=W),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Titre de l'événement"},null,512),[[xt,yr.value]])]),h("div",w4,[m[101]||(m[101]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),Ze(h("input",{"onUpdate:modelValue":m[24]||(m[24]=W=>Bs.value=W),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white"},null,512),[[xt,Bs.value]])]),h("div",I4,[m[102]||(m[102]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),Ze(h("textarea",{"onUpdate:modelValue":m[25]||(m[25]=W=>qs.value=W),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)"},null,512),[[xt,qs.value]])]),h("div",E4,[Ze(h("input",{id:"new-archived",type:"checkbox","onUpdate:modelValue":m[26]||(m[26]=W=>zo.value=W),class:"w-4 h-4"},null,512),[[Ta,zo.value]]),m[103]||(m[103]=h("label",{for:"new-archived",class:"text-sm font-medium text-gray-300"},"Créer comme archivé",-1))]),h("div",T4,[m[104]||(m[104]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),Ze(h("input",{"onUpdate:modelValue":m[27]||(m[27]=W=>Bi.value=W),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",placeholder:"6"},null,512),[[xt,Bi.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:qi,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Uh,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Créer ")])])])):ce("",!0),x.value?(F(),$("div",x4,[h("div",A4,[m[107]||(m[107]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouveau joueur",-1)),h("div",S4,[m[106]||(m[106]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),Ze(h("input",{"onUpdate:modelValue":m[28]||(m[28]=W=>S.value=W),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nom du joueur"},null,512),[[xt,S.value]])]),h("div",P4,[h("button",{onClick:m[29]||(m[29]=W=>x.value=!1),class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:bt,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ajouter ")])])])):ce("",!0),l.value?(F(),$("div",R4,[h("div",C4,[m[108]||(m[108]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer cet événement ?</p></div>',1)),h("div",k4,[h("button",{onClick:Bo,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:m[30]||(m[30]=()=>jo()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):ce("",!0),Qi.value?(F(),$("div",D4,[h("div",V4,[m[109]||(m[109]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer ce joueur ?</p></div>',1)),h("div",N4,[h("button",{onClick:Il,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{onClick:m[31]||(m[31]=()=>Ic()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"Supprimer")])])])):ce("",!0),me.value?(F(),$("div",O4,[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},[m[110]||(m[110]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🎭</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Attention, toute la sélection sera refaite en fonction des disponibilités actuelles.</p></div><p class="mb-6 text-sm text-yellow-400 bg-yellow-900/20 p-3 rounded-lg border border-yellow-500/20"> ⚠️ Pensez à prévenir les gens du changement ! </p>',2)),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:Yo,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{onClick:Ec,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"},"Confirmer")])])])):ce("",!0),A.value?(F(),$("div",{key:10,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:b},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:m[42]||(m[42]=Vt(()=>{},["stop"]))},[h("div",M4,[h("button",{onClick:b,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},"✖️"),m[111]||(m[111]=h("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[h("span",{class:"text-2xl md:text-3xl"},"🎭")],-1)),h("h2",L4,ue((Q=M.value)==null?void 0:Q.title),1),h("p",F4,ue(Wo((ne=M.value)==null?void 0:ne.date)),1)]),h("div",$4,[(re=M.value)!=null&&re.description?(F(),$("div",U4,[h("p",j4,ue(M.value.description),1)])):ce("",!0),h("div",B4,[h("div",q4,[h("div",z4,ue(Ki((pe=M.value)==null?void 0:pe.id)),1),m[112]||(m[112]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibles",-1))]),h("div",G4,[h("div",K4,ue(Hi((Ve=M.value)==null?void 0:Ve.id)),1),m[113]||(m[113]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Sélectionnés",-1))]),h("div",H4,[h("div",W4,ue(((Fe=M.value)==null?void 0:Fe.playerCount)||6),1),m[114]||(m[114]=h("div",{class:"text-xs md:text-sm text-gray-300"},"À sélectionner",-1))])]),M.value?(F(),$("div",Q4,[h("div",J4,[bl.value?(F(),$("div",{key:0,class:zt(["flex items-center gap-2 px-2 py-1 rounded-md border text-[11px] md:text-xs max-w-[70%] truncate",((We=vc.value)==null?void 0:We.type)==="incomplete"?"bg-yellow-500/10 border-yellow-500/30 text-yellow-200":"bg-orange-500/10 border-orange-500/30 text-orange-200"]),title:kt.value},[m[115]||(m[115]=h("span",null,"⚠️",-1)),h("span",X4,ue(kt.value),1)],10,Y4)):ce("",!0),Ze(h("select",{"onUpdate:modelValue":m[32]||(m[32]=W=>ss.value=W),class:"ml-auto bg-gray-800 text-white rounded-md px-3 py-2 border border-white/10 focus:outline-none text-sm",title:"Filtrer les joueurs par statut"},m[116]||(m[116]=[nr('<option value="selected">Sélectionnés</option><option value="available">Disponibles</option><option value="unavailable">Non Disponibles</option><option value="unknown">Pas de réponse</option><option value="all">Tous</option>',5)]),512),[[oA,ss.value]])]),h("div",Z4,[(F(!0),$(vt,null,ur(zi.value,W=>{var Vn,er;return F(),$("div",{key:W.id,class:"flex items-center justify-between px-2 py-1.5 rounded-md hover:bg-gray-800/40 transition-colors"},[h("div",e3,[Ui(W.id)?(F(),$("span",t3," 🔒 ")):ce("",!0),h("span",{class:"text-white text-sm md:text-base block truncate max-w-full flex-1 min-w-0",title:W.name},ue(W.name),9,n3)]),h("div",r3,[ut(b_,{"player-name":W.name,"event-id":M.value.id,"is-available":_g(M.value.id)[W.name],"is-selected":_e(W.name,M.value.id),"chance-percent":((Vn=_l.value[W.name])==null?void 0:Vn[M.value.id])??null,"show-selected-chance":Wi(M.value.id),disabled:((er=M.value)==null?void 0:er.archived)===!0,compact:!0,onToggle:H},null,8,["player-name","event-id","is-available","is-selected","chance-percent","show-selected-chance","disabled"])])])}),128))])])):ce("",!0),h("div",s3,[h("button",{onClick:an,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},m[117]||(m[117]=[h("span",null,"✏️",-1),h("span",null,"Modifier",-1)])),h("button",{onClick:m[33]||(m[33]=W=>Gh(M.value)),disabled:(ct=M.value)==null?void 0:ct.archived,class:"px-5 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-lg hover:from-amber-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600",title:(Dt=M.value)!=null&&Dt.archived?"Impossible d'annoncer un événement archivé":"Annoncer l'événement aux joueurs (email, copie, WhatsApp)"},m[118]||(m[118]=[h("span",null,"📢",-1),h("span",null,"Annoncer",-1)]),8,i3),h("button",{onClick:it,class:"px-5 py-3 bg-gradient-to-r from-indigo-500 to-blue-600 text-white rounded-lg hover:from-indigo-600 hover:to-blue-700 transition-all duration-300 flex items-center gap-2",title:(Jt=M.value)!=null&&Jt.archived?"Désarchiver cet événement":"Archiver cet événement"},[h("span",null,ue((ot=M.value)!=null&&ot.archived?"📂":"📁"),1),h("span",null,ue((Dn=M.value)!=null&&Dn.archived?"Désarchiver":"Archiver"),1)],8,o3),h("button",{onClick:m[34]||(m[34]=W=>Cc(M.value)),class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center gap-2",title:"Gérer la sélection"},m[119]||(m[119]=[h("span",null,"🎭",-1),h("span",null,"Sélectionner",-1)])),h("button",{onClick:m[35]||(m[35]=W=>{var Vn;return vr((Vn=M.value)==null?void 0:Vn.id)}),class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},m[120]||(m[120]=[h("span",null,"🗑️",-1),h("span",null,"Supprimer",-1)])),h("button",{onClick:q,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer")]),te.value?(F(),$("div",a3,[h("button",{onClick:m[36]||(m[36]=W=>{an(),te.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"},"✏️ Modifier"),h("button",{onClick:m[37]||(m[37]=W=>{Gh(M.value),te.value=!1}),disabled:(lr=M.value)==null?void 0:lr.archived,class:"w-full px-4 py-3 rounded-lg bg-amber-600/20 text-amber-200 border border-amber-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600",title:(Dr=M.value)!=null&&Dr.archived?"Impossible d'annoncer un événement archivé":"Annoncer l'événement aux joueurs (email, copie, WhatsApp)"},m[121]||(m[121]=[h("span",null,"📢",-1),h("span",null,"Annoncer",-1)]),8,l3),h("button",{onClick:m[38]||(m[38]=W=>{it(),te.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-indigo-600/20 text-indigo-200 border border-indigo-500/30"},ue((Ws=M.value)!=null&&Ws.archived?"📂 Désarchiver":"📁 Archiver"),1),h("button",{onClick:m[39]||(m[39]=W=>{var Vn;vr((Vn=M.value)==null?void 0:Vn.id),te.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"},"🗑️ Supprimer")])):ce("",!0)]),h("div",u3,[h("button",{onClick:m[40]||(m[40]=W=>Cc(M.value)),class:"h-12 px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex-[1.4]"},"🎭 Sélectionner"),h("button",{onClick:q,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"},"Fermer"),h("button",{onClick:m[41]||(m[41]=W=>te.value=!te.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"},"⋯")])])])):ce("",!0),ut(mg,{show:ve.value,player:de.value,seasonId:o.value,onClose:m[43]||(m[43]=W=>ve.value=!1),onVerified:gt},null,8,["show","player","seasonId"]),d.value?(F(),$("div",c3,[h("div",d3,[m[127]||(m[127]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Modifier l'événement",-1)),h("div",h3,[m[122]||(m[122]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),Ze(h("input",{"onUpdate:modelValue":m[44]||(m[44]=W=>f.value=W),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[On(Ur,["esc"]),On(qo,["enter"])],ref:"editTitleInput"},null,544),[[xt,f.value]])]),h("div",f3,[m[123]||(m[123]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),Ze(h("input",{"onUpdate:modelValue":m[45]||(m[45]=W=>g.value=W),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:[On(Ur,["esc"]),On(qo,["enter"])]},null,544),[[xt,g.value]])]),h("div",p3,[m[124]||(m[124]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),Ze(h("textarea",{"onUpdate:modelValue":m[46]||(m[46]=W=>ee.value=W),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)",onKeydown:On(Ur,["esc"])},null,544),[[xt,ee.value]])]),h("div",m3,[Ze(h("input",{id:"edit-archived",type:"checkbox","onUpdate:modelValue":m[47]||(m[47]=W=>Y.value=W),class:"w-4 h-4"},null,512),[[Ta,Y.value]]),m[125]||(m[125]=h("label",{for:"edit-archived",class:"text-sm font-medium text-gray-300"},"Archiver cet événement",-1))]),h("div",g3,[m[126]||(m[126]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),Ze(h("input",{"onUpdate:modelValue":m[48]||(m[48]=W=>y.value=W),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:On(Ur,["esc"])},null,544),[[xt,y.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:Ur,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:qo,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):ce("",!0),ut(mE,{show:N.value,message:Tc(),error:R.value,"session-info":Ks(),onSubmit:xc,onCancel:Ac},null,8,["show","message","error","session-info"]),Pt.value?(F(),$("div",v3,[h("div",y3,[m[129]||(m[129]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-2">Vérification requise</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protégé par mot de passe</p></div>',1)),h("div",_3,[h("div",b3,[h("div",null,[m[128]||(m[128]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),Ze(h("input",{"onUpdate:modelValue":m[49]||(m[49]=W=>Le.value=W),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:m[50]||(m[50]=On(W=>Tl(Le.value),["enter"])),ref_key:"playerPasswordInputRef",ref:hn},null,544),[[xt,Le.value]])])]),h("button",{onClick:m[51]||(m[51]=W=>Tl(Le.value)),disabled:!Le.value||Ue.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Ue.value?(F(),$("span",I3,"⏳")):(F(),$("span",E3,"🔓")),h("span",null,ue(Ue.value?"Vérification...":"Vérifier et supprimer"),1)],8,w3)]),h("div",T3,[h("button",{onClick:m[52]||(m[52]=W=>X.value=!0),class:"text-sm text-red-400 hover:text-red-300 transition-colors underline"}," Mot de passe oublié ? ")]),Xe.value?(F(),$("div",x3,[h("div",A3,ue(Xe.value),1)])):ce("",!0),h("div",{class:"flex justify-center"},[h("button",{onClick:Sc,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):ce("",!0),rn.value?(F(),$("div",S3,[h("div",P3,[m[132]||(m[132]=nr('<div class="text-center p-6 pb-4 border-b border-white/10"><div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-1">Vérification requise</h2><p class="text-base text-gray-300">Modification de disponibilité</p><p class="text-sm text-gray-400 mt-1">Ce joueur est protégé par mot de passe</p></div>',1)),h("div",R3,[h("div",C3,[h("div",null,[m[130]||(m[130]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),Ze(h("input",{"onUpdate:modelValue":m[53]||(m[53]=W=>oe.value=W),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:m[54]||(m[54]=On(W=>Ji(oe.value),["enter"])),ref_key:"availabilityPasswordInputRef",ref:rt},null,544),[[xt,oe.value]])])]),h("div",k3,[h("button",{onClick:m[55]||(m[55]=W=>dt.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),fe.value?(F(),$("div",D3,[h("div",V3,ue(fe.value),1)])):ce("",!0)]),h("div",N3,[h("button",{onClick:Hn,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300 flex-1 text-sm md:text-base whitespace-nowrap"}," Annuler "),h("button",{onClick:m[56]||(m[56]=W=>Ji(oe.value)),disabled:!oe.value||ze.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 flex-1 text-sm md:text-base whitespace-nowrap"},[ze.value?(F(),$("span",M3,"⏳")):(F(),$("span",L3,"🔓")),h("span",null,[Fn(ue(ze.value?"Vérification...":"Vérifier"),1),m[131]||(m[131]=h("span",{class:"hidden sm:inline"}," et modifier",-1))])],8,O3)])])])):ce("",!0),dt.value?(F(),$("div",{key:14,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:m[59]||(m[59]=W=>dt.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:m[58]||(m[58]=Vt(()=>{},["stop"]))},[m[134]||(m[134]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Modification de disponibilité</p></div>',1)),h("div",F3,[m[133]||(m[133]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),h("button",{onClick:Pc,disabled:k.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[k.value?(F(),$("span",U3,"⏳")):(F(),$("span",j3,"📧")),h("span",null,ue(k.value?"Envoi...":"Envoyer l'email"),1)],8,$3)]),L.value?(F(),$("div",B3,[h("div",q3,ue(L.value),1)])):ce("",!0),J.value?(F(),$("div",z3,[h("div",G3,ue(J.value),1)])):ce("",!0),h("div",K3,[h("button",{onClick:m[57]||(m[57]=W=>dt.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ce("",!0),X.value?(F(),$("div",{key:15,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:m[62]||(m[62]=W=>X.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:m[61]||(m[61]=Vt(()=>{},["stop"]))},[m[136]||(m[136]=nr('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p></div>',1)),h("div",H3,[m[135]||(m[135]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),h("button",{onClick:Rc,disabled:Pe.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Pe.value?(F(),$("span",Q3,"⏳")):(F(),$("span",J3,"📧")),h("span",null,ue(Pe.value?"Envoi...":"Envoyer l'email"),1)],8,W3)]),Oe.value?(F(),$("div",Y3,[h("div",X3,ue(Oe.value),1)])):ce("",!0),E.value?(F(),$("div",Z3,[h("div",e$,ue(E.value),1)])):ce("",!0),h("div",t$,[h("button",{onClick:m[60]||(m[60]=W=>X.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ce("",!0),ut(KM,{ref_key:"playerModalRef",ref:C,show:w.value,player:I.value,stats:Xo(I.value),seasonId:o.value,"onboarding-step":Ee.value,"onboarding-player-id":j.value,onClose:fn,onUpdate:Hs,onDelete:El,onRefresh:ar,onAdvanceOnboarding:m[63]||(m[63]=W=>{try{typeof Ee.value<"u"&&(Ee.value.value=W)}catch{}})},null,8,["show","player","stats","seasonId","onboarding-step","onboarding-player-id"]),ut(RL,{ref_key:"selectionModalRef",ref:Ne,show:Te.value,event:Re.value,"current-selection":st.value[(Ig=Re.value)==null?void 0:Ig.id]||[],"available-count":Ki((Eg=Re.value)==null?void 0:Eg.id),"selected-count":Hi((Tg=Re.value)==null?void 0:Tg.id),"player-availability":_g((xg=Re.value)==null?void 0:xg.id),"season-id":o.value,"season-slug":ys(s),players:on.value,onClose:Kh,onSelection:BE,onPerfect:qE,onSendEmailNotifications:yg,onUpdateSelection:zE},null,8,["show","event","current-selection","available-count","selected-count","player-availability","season-id","season-slug","players"]),ut(LE,{show:Be.value,event:Je.value,"season-id":o.value,"season-slug":ys(s),players:on.value,onClose:gg,onSendEmailNotifications:yg},null,8,["show","event","season-id","season-slug","players"]),ut(gE,{show:vn.value,onClose:m[64]||(m[64]=W=>vn.value=!1)},null,8,["show"]),ut(mF,{show:Ct.value,"season-id":o.value,onClose:Rn,onManagePlayer:Mi,onChangePassword:dl,onLogoutDevice:uc,onDeleteAccount:cc},null,8,["show","season-id"]),ut(FE,{show:fr.value,player:sn.value,"season-id":o.value,onClose:m[65]||(m[65]=W=>fr.value=!1),onSuccess:m[66]||(m[66]=()=>{fr.value=!1,Ct.value=!0})},null,8,["show","player","season-id"]),ut(xF,{show:Lr.value,onClose:m[67]||(m[67]=W=>Lr.value=!1),onSuccess:m[68]||(m[68]=()=>{Lr.value=!1,Ct.value=!0})},null,8,["show"]),Ht.value?(F(),$("div",n$,[h("div",r$,[m[137]||(m[137]=h("h3",{class:"text-xl font-bold text-white mb-4 text-center"},"Voulez-vous annoncer cet événement ?",-1)),m[138]||(m[138]=h("p",{class:"text-gray-300 text-center mb-6"},"Envoyer des notifications aux joueurs pour qu'ils indiquent leur disponibilité",-1)),h("div",s$,[h("button",{onClick:m[69]||(m[69]=W=>Gh(Ft.value)),class:"flex-1 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300"}," 📢 Oui "),h("button",{onClick:vg,class:"flex-1 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all duration-300"}," Plus tard ")])])])):ce("",!0)],64)}}},i$={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},o$={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},a$={key:0,class:"text-center py-8"},l$={key:1,class:"text-center py-8"},u$={class:"text-gray-300 mb-6"},c$={key:2,class:"space-y-6"},d$={class:"text-center"},h$={class:"text-gray-300"},f$={class:"font-semibold text-white"},p$={class:"space-y-4"},m$=["disabled"],g$={key:0,class:"animate-spin"},v$={key:1},y$={key:0,class:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},_$={class:"text-red-300 text-sm"},b$={key:1,class:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},w$={class:"text-green-300 text-sm"},I$={__name:"PasswordReset",setup(n){const e=Ka(),t=Fu(),r=O(!0),s=O(""),i=O(""),o=O(""),a=O(""),l=O(""),c=O(!1),d=O(""),f=O(""),g=$e(()=>a.value&&l.value&&a.value===l.value&&a.value.length>=6);br(async()=>{try{const{oobCode:S}=e.query;if(ge.debug("Token reçu (masqué)"),!S){s.value="Lien de réinitialisation incomplet",r.value=!1;return}o.value=S,i.value="patrice.lamarque+ron@gmail.com",r.value=!1}catch(S){ge.error("Erreur lors de la vérification du lien",S),s.value="Erreur lors de la vérification du lien",r.value=!1}});async function y(){if(g.value){c.value=!0,d.value="",f.value="";try{ge.debug("Début réinitialisation avec token (masqué)"),await BD(qt,o.value,a.value),ge.info("Mot de passe Firebase Auth mis à jour"),ge.info("Réinitialisation terminée avec Firebase Auth"),f.value="Mot de passe réinitialisé avec succès ! Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.",setTimeout(()=>{x()},3e3)}catch(S){ge.error("Erreur lors de la réinitialisation",S),S.code==="auth/weak-password"?d.value="Le mot de passe doit contenir au moins 6 caractères":S.code==="auth/invalid-action-code"?d.value="Lien de réinitialisation invalide ou expiré":d.value="Erreur lors de la réinitialisation. Veuillez réessayer."}finally{c.value=!1}}}function x(){t.push("/")}return(S,P)=>(F(),$("div",i$,[h("div",o$,[P[8]||(P[8]=nr('<div class="text-center mb-6"><div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-3xl">🔑</span></div><h1 class="text-3xl font-bold text-white mb-2">Réinitialisation</h1><p class="text-lg text-gray-300">Nouveau mot de passe</p></div>',1)),r.value?(F(),$("div",a$,P[2]||(P[2]=[h("div",{class:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),h("p",{class:"text-gray-300"},"Vérification du lien...",-1)]))):s.value?(F(),$("div",l$,[P[3]||(P[3]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"❌")],-1)),P[4]||(P[4]=h("h2",{class:"text-xl font-bold text-white mb-2"},"Lien invalide",-1)),h("p",u$,ue(s.value),1),h("button",{onClick:x,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300"}," Retour à l'accueil ")])):i.value?(F(),$("div",c$,[h("div",d$,[h("p",h$,[P[5]||(P[5]=Fn("Email : ")),h("span",f$,ue(i.value),1)])]),h("div",p$,[h("div",null,[P[6]||(P[6]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nouveau mot de passe",-1)),Ze(h("input",{"onUpdate:modelValue":P[0]||(P[0]=j=>a.value=j),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nouveau mot de passe",onKeydown:On(y,["enter"])},null,544),[[xt,a.value]])]),h("div",null,[P[7]||(P[7]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),Ze(h("input",{"onUpdate:modelValue":P[1]||(P[1]=j=>l.value=j),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe",onKeydown:On(y,["enter"])},null,544),[[xt,l.value]])])]),h("button",{onClick:y,disabled:!g.value||c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(F(),$("span",g$,"⏳")):(F(),$("span",v$,"🔑")),h("span",null,ue(c.value?"Réinitialisation...":"Réinitialiser le mot de passe"),1)],8,m$),d.value?(F(),$("div",y$,[h("div",_$,ue(d.value),1)])):ce("",!0),f.value?(F(),$("div",b$,[h("div",w$,ue(f.value),1)])):ce("",!0)])):ce("",!0)])]))}},E$={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},T$={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center"},x$={class:"text-3xl"},A$={class:"text-2xl font-bold text-white mb-2"},S$={class:"text-gray-300 mb-6"},P$={__name:"MagicLink",setup(n){const e=Ka(),t=Fu(),r=O("loading"),s=O("Traitement en cours..."),i=O("Merci de patienter pendant la validation du lien."),o=$e(()=>r.value==="loading"?"⏳":r.value==="ok"?"✅":"❌");function a(){const l=e.query.slug;l?t.push(`/season/${l}`):t.push("/")}return br(async()=>{try{_E("firebase");const l=String(e.query.sid||""),c=String(e.query.pid||"");let d=String(e.query.eid||"");const f=String(e.query.t||""),g=String(e.query.a||""),y=String(e.query.slug||"");if(!f||!g){r.value="error",s.value="Lien invalide",i.value="Paramètres manquants.";return}if(g==="account_email_update"){const D=await TE({token:f});if(!D.valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expiré.";return}try{await WD(qt.currentUser,D.data.newEmail),await xE({token:f}),r.value="ok",s.value="Email mis à jour",i.value="Votre adresse email a été mise à jour avec succès."}catch{r.value="error",s.value="Action impossible",i.value="Veuillez vous reconnecter puis réessayer."}return}if(g==="verify_email"&&(d="protection"),!(await IE({seasonId:l,playerId:c,eventId:d,token:f,action:g})).valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expiré.";return}if(g==="verify_email"){await RE({playerId:c,seasonId:l});try{await NE({playerId:c,seasonId:l})}catch{}await _p({seasonId:l,playerId:c,eventId:"protection",action:g}),r.value="ok",s.value="Email vérifié",i.value="Merci ! Vous pouvez maintenant définir votre mot de passe.",setTimeout(y?()=>t.push(`/season/${y}?player=${encodeURIComponent(c)}&verified=1`):()=>t.push("/"),800);return}const S=xe(le,"seasons",l,"players",c),P=await En(S),j=P.exists()&&P.data().name||"";if(!j){r.value="error",s.value="Lien invalide",i.value="Joueur introuvable.";return}await dN({seasonId:l,playerName:j,eventId:d,value:g==="yes"}),await _p({seasonId:l,playerId:c,eventId:d,action:g}),r.value="ok",s.value="Merci !",i.value=g==="yes"?"Votre disponibilité a été enregistrée: Disponible.":"Votre disponibilité a été enregistrée: Non disponible.",setTimeout(y?()=>t.push(`/season/${y}/event/${d}`):()=>t.push("/"),1200)}catch(l){ge.error("Magic link error",l),r.value="error",s.value="Erreur",i.value="Impossible de traiter votre lien."}}),(l,c)=>(F(),$("div",E$,[h("div",T$,[h("div",{class:zt(["w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center",r.value==="ok"?"bg-green-500":r.value==="loading"?"bg-blue-500":"bg-red-500"])},[h("span",x$,ue(o.value),1)],2),h("h1",A$,ue(s.value),1),h("p",S$,ue(i.value),1),h("button",{onClick:a,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ouvrir la saison ")])]))}},R$={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},C$={class:"text-center py-12 px-4"},k$={class:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},D$={class:"container mx-auto px-4 pb-16"},V$={class:"max-w-xl mx-auto bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl"},N$={class:"space-y-5"},O$=["onKeydown"],M$={class:"flex items-center justify-end gap-3 pt-2"},L$=["disabled"],F$={key:0,class:"mt-6 text-sm text-gray-200"},$$={__name:"JoinSeason",setup(n){const e=Ka(),t=Fu(),r=e.params.slug,s=O(""),i=O(""),o=O(""),a=O(!1),l=O("");br(async()=>{const f=Su(He(le,"seasons"),Ld("slug","==",r)),g=await mt(f);if(g.empty)l.value="Saison introuvable";else{const y=g.docs[0];s.value=y.id,i.value=y.data().name,document.title=`Rejoindre : ${i.value}`}});function c(){t.push(`/season/${r}`)}async function d(){if(!(!o.value.trim()||!s.value)){a.value=!0,l.value="";try{await bE(o.value.trim(),s.value),l.value="Inscription réussie. Vous pouvez maintenant indiquer vos disponibilités.";try{localStorage.setItem(`startPlayerTour:${s.value}`,"1"),localStorage.setItem(`dismissCreatorOnboarding:${s.value}`,"1")}catch{}setTimeout(()=>{c()},600)}catch(f){ge.error("Erreur inscription",f),l.value=`Erreur lors de l'inscription: ${(f==null?void 0:f.message)||"Veuillez réessayer"}`}finally{a.value=!1}}}return(f,g)=>(F(),$("div",R$,[h("div",C$,[h("h1",k$,ue(i.value||"Rejoindre la saison"),1),g[1]||(g[1]=h("p",{class:"text-gray-300"},"Inscrivez-vous pour indiquer vos disponibilités aux événements",-1))]),h("div",D$,[h("div",V$,[g[3]||(g[3]=h("h2",{class:"text-2xl font-bold text-white mb-6 text-center"},"Je rejoins la saison",-1)),h("div",N$,[h("div",null,[g[2]||(g[2]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Votre nom",-1)),Ze(h("input",{"onUpdate:modelValue":g[0]||(g[0]=y=>o.value=y),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: Marie Dupont",onKeydown:On(Vt(d,["prevent"]),["enter"])},null,40,O$),[[xt,o.value]])]),h("div",M$,[h("button",{onClick:c,class:"px-5 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{disabled:!o.value.trim()||a.value,onClick:d,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Rejoindre ",8,L$)])]),l.value?(F(),$("div",F$,ue(l.value),1)):ce("",!0)])])]))}};{const n=()=>{};console.debug=n,console.log=n,console.info=n}const U$=[{path:"/",component:jN},{path:"/season/:slug",component:w_,props:!0},{path:"/season/:slug/event/:eventId",component:w_,props:!0},{path:"/season/:slug/join",component:$$,props:!0},{path:"/reset-password",component:I$},{path:"/magic",component:P$}],j$=vS({history:KA("/"),routes:U$});hA(mA).use(j$).mount("#app");export{He as $,yI as A,Ao as B,Yr as C,tn as D,KU as E,Po as F,Dm as G,GU as H,K$ as I,Er as J,ok as K,lk as L,ec as M,yU as N,_U as O,Dk as P,Pn as Q,uU as R,Y$ as S,Gt as T,LU as U,_h as V,Ck as W,MU as X,vU as Y,eU as Z,lb as _,Tu as a,ic as a$,Q$ as a0,ak as a1,_k as a2,zU as a3,za as a4,OU as a5,rU as a6,qU as a7,xe as a8,aU as a9,oU as aA,xU as aB,AU as aC,lU as aD,vk as aE,kU as aF,DU as aG,Pk as aH,Su as aI,sI as aJ,J$ as aK,NU as aL,ol as aM,pn as aN,UU as aO,B$ as aP,bU as aQ,fU as aR,hU as aS,gU as aT,sU as aU,il as aV,$U as aW,tU as aX,Ld as aY,qm as aZ,XU as a_,ck as aa,Z$ as ab,nU as ac,BU as ad,mU as ae,pU as af,Kt as ag,tc as ah,wk as ai,SU as aj,En as ak,wU as al,IU as am,mt as an,EU as ao,TU as ap,uk as aq,jU as ar,FU as as,X$ as at,cU as au,dU as av,iU as aw,PU as ax,CU as ay,RU as az,dk as b,LD as b$,sc as b0,e6 as b1,ku as b2,Do as b3,oi as b4,WU as b5,li as b6,ai as b7,Ps as b8,ld as b9,Gk as bA,w6 as bB,N6 as bC,Zy as bD,T2 as bE,hD as bF,m6 as bG,l6 as bH,FD as bI,x6 as bJ,C6 as bK,V6 as bL,I6 as bM,s2 as bN,n2 as bO,n6 as bP,Nk as bQ,$D as bR,A6 as bS,R6 as bT,D6 as bU,Wk as bV,_6 as bW,d6 as bX,jD as bY,a6 as bZ,t2 as b_,YU as ba,mo as bb,wa as bc,SV as bd,QU as be,E6 as bf,fp as bg,JU as bh,PV as bi,cg as bj,ui as bk,i6 as bl,r2 as bm,XI as bn,AV as bo,eE as bp,qD as bq,BD as br,pD as bs,zD as bt,ZU as bu,b6 as bv,c6 as bw,p6 as bx,OV as by,t6 as bz,Ba as c,Zm as c0,s6 as c1,GD as c2,u6 as c3,T6 as c4,P6 as c5,k6 as c6,i2 as c7,r6 as c8,y6 as c9,WD as ca,QD as cb,S6 as cc,f6 as cd,v6 as ce,g6 as cf,h6 as cg,o6 as ch,Ro as d,It as e,ie as f,sl as g,Xu as h,id as i,Ah as j,Zu as k,Th as l,jm as m,qa as n,xh as o,uo as p,kk as q,Wt as r,yo as s,Ie as t,z$ as u,ZP as v,Ut as w,HU as x,Ye as y,q$ as z};
