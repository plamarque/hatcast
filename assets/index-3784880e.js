(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Uh(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const dt={},Wi=[],Qn=()=>{},Lb=()=>!1,uu=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Bh=n=>n.startsWith("onUpdate:"),tn=Object.assign,jh=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},Fb=Object.prototype.hasOwnProperty,rt=(n,e)=>Fb.call(n,e),xe=Array.isArray,Qi=n=>du(n)==="[object Map]",N_=n=>du(n)==="[object Set]",De=n=>typeof n=="function",$t=n=>typeof n=="string",Cs=n=>typeof n=="symbol",Et=n=>n!==null&&typeof n=="object",O_=n=>(Et(n)||De(n))&&De(n.then)&&De(n.catch),M_=Object.prototype.toString,du=n=>M_.call(n),Ub=n=>du(n).slice(8,-1),L_=n=>du(n)==="[object Object]",$h=n=>$t(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Ta=Uh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hu=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},Bb=/-(\w)/g,qn=hu(n=>n.replace(Bb,(e,t)=>t?t.toUpperCase():"")),jb=/\B([A-Z])/g,ks=hu(n=>n.replace(jb,"-$1").toLowerCase()),fu=hu(n=>n.charAt(0).toUpperCase()+n.slice(1)),md=hu(n=>n?`on${fu(n)}`:""),gs=(n,e)=>!Object.is(n,e),mc=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Wd=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Qd=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let Jp;const pu=()=>Jp||(Jp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ba(n){if(xe(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=$t(r)?Gb(r):Ba(r);if(s)for(const i in s)e[i]=s[i]}return e}else if($t(n)||Et(n))return n}const $b=/;(?![^(]*\))/g,qb=/:([^]+)/,zb=/\/\*[^]*?\*\//g;function Gb(n){const e={};return n.replace(zb,"").split($b).forEach(t=>{if(t){const r=t.split(qb);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function cr(n){let e="";if($t(n))e=n;else if(xe(n))for(let t=0;t<n.length;t++){const r=cr(n[t]);r&&(e+=r+" ")}else if(Et(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const Kb="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Hb=Uh(Kb);function F_(n){return!!n||n===""}const U_=n=>!!(n&&n.__v_isRef===!0),_e=n=>$t(n)?n:n==null?"":xe(n)||Et(n)&&(n.toString===M_||!De(n.toString))?U_(n)?_e(n.value):JSON.stringify(n,B_,2):String(n),B_=(n,e)=>U_(e)?B_(n,e.value):Qi(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[gd(r,i)+" =>"]=s,t),{})}:N_(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>gd(t))}:Cs(e)?gd(e):Et(e)&&!xe(e)&&!L_(e)?String(e):e,gd=(n,e="")=>{var t;return Cs(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Cn;class Wb{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Cn,!e&&Cn&&(this.index=(Cn.scopes||(Cn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Cn;try{return Cn=this,e()}finally{Cn=t}}}on(){++this._on===1&&(this.prevScope=Cn,Cn=this)}off(){this._on>0&&--this._on===0&&(Cn=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Qb(){return Cn}let ft;const _d=new WeakSet;class j_{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Cn&&Cn.active&&Cn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,_d.has(this)&&(_d.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||q_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Yp(this),z_(this);const e=ft,t=Jn;ft=this,Jn=!0;try{return this.fn()}finally{G_(this),ft=e,Jn=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Gh(e);this.deps=this.depsTail=void 0,Yp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?_d.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Jd(this)&&this.run()}get dirty(){return Jd(this)}}let $_=0,Aa,Pa;function q_(n,e=!1){if(n.flags|=8,e){n.next=Pa,Pa=n;return}n.next=Aa,Aa=n}function qh(){$_++}function zh(){if(--$_>0)return;if(Pa){let e=Pa;for(Pa=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Aa;){let e=Aa;for(Aa=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function z_(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function G_(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),Gh(r),Jb(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function Jd(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(K_(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function K_(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ja)||(n.globalVersion=ja,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Jd(n))))return;n.flags|=2;const e=n.dep,t=ft,r=Jn;ft=n,Jn=!0;try{z_(n);const s=n.fn(n._value);(e.version===0||gs(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{ft=t,Jn=r,G_(n),n.flags&=-3}}function Gh(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Gh(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Jb(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let Jn=!0;const H_=[];function Vr(){H_.push(Jn),Jn=!1}function Nr(){const n=H_.pop();Jn=n===void 0?!0:n}function Yp(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=ft;ft=void 0;try{e()}finally{ft=t}}}let ja=0;class Yb{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Kh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ft||!Jn||ft===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==ft)t=this.activeLink=new Yb(ft,this),ft.deps?(t.prevDep=ft.depsTail,ft.depsTail.nextDep=t,ft.depsTail=t):ft.deps=ft.depsTail=t,W_(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=ft.depsTail,t.nextDep=void 0,ft.depsTail.nextDep=t,ft.depsTail=t,ft.deps===t&&(ft.deps=r)}return t}trigger(e){this.version++,ja++,this.notify(e)}notify(e){qh();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{zh()}}}function W_(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)W_(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Yd=new WeakMap,Zs=Symbol(""),Xd=Symbol(""),$a=Symbol("");function gn(n,e,t){if(Jn&&ft){let r=Yd.get(n);r||Yd.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new Kh),s.map=r,s.key=t),s.track()}}function Ar(n,e,t,r,s,i){const o=Yd.get(n);if(!o){ja++;return}const a=c=>{c&&c.trigger()};if(qh(),e==="clear")o.forEach(a);else{const c=xe(n),u=c&&$h(t);if(c&&t==="length"){const d=Number(r);o.forEach((f,g)=>{(g==="length"||g===$a||!Cs(g)&&g>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get($a)),e){case"add":c?u&&a(o.get("length")):(a(o.get(Zs)),Qi(n)&&a(o.get(Xd)));break;case"delete":c||(a(o.get(Zs)),Qi(n)&&a(o.get(Xd)));break;case"set":Qi(n)&&a(o.get(Zs));break}}zh()}function Mi(n){const e=nt(n);return e===n?e:(gn(e,"iterate",$a),$n(n)?e:e.map(ln))}function mu(n){return gn(n=nt(n),"iterate",$a),n}const Xb={__proto__:null,[Symbol.iterator](){return yd(this,Symbol.iterator,ln)},concat(...n){return Mi(this).concat(...n.map(e=>xe(e)?Mi(e):e))},entries(){return yd(this,"entries",n=>(n[1]=ln(n[1]),n))},every(n,e){return br(this,"every",n,e,void 0,arguments)},filter(n,e){return br(this,"filter",n,e,t=>t.map(ln),arguments)},find(n,e){return br(this,"find",n,e,ln,arguments)},findIndex(n,e){return br(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return br(this,"findLast",n,e,ln,arguments)},findLastIndex(n,e){return br(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return br(this,"forEach",n,e,void 0,arguments)},includes(...n){return vd(this,"includes",n)},indexOf(...n){return vd(this,"indexOf",n)},join(n){return Mi(this).join(n)},lastIndexOf(...n){return vd(this,"lastIndexOf",n)},map(n,e){return br(this,"map",n,e,void 0,arguments)},pop(){return oa(this,"pop")},push(...n){return oa(this,"push",n)},reduce(n,...e){return Xp(this,"reduce",n,e)},reduceRight(n,...e){return Xp(this,"reduceRight",n,e)},shift(){return oa(this,"shift")},some(n,e){return br(this,"some",n,e,void 0,arguments)},splice(...n){return oa(this,"splice",n)},toReversed(){return Mi(this).toReversed()},toSorted(n){return Mi(this).toSorted(n)},toSpliced(...n){return Mi(this).toSpliced(...n)},unshift(...n){return oa(this,"unshift",n)},values(){return yd(this,"values",ln)}};function yd(n,e,t){const r=mu(n),s=r[e]();return r!==n&&!$n(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const Zb=Array.prototype;function br(n,e,t,r,s,i){const o=mu(n),a=o!==n&&!$n(n),c=o[e];if(c!==Zb[e]){const f=c.apply(n,i);return a?ln(f):f}let u=t;o!==n&&(a?u=function(f,g){return t.call(this,ln(f),g,n)}:t.length>2&&(u=function(f,g){return t.call(this,f,g,n)}));const d=c.call(o,u,r);return a&&s?s(d):d}function Xp(n,e,t,r){const s=mu(n);let i=t;return s!==n&&($n(n)?t.length>3&&(i=function(o,a,c){return t.call(this,o,a,c,n)}):i=function(o,a,c){return t.call(this,o,ln(a),c,n)}),s[e](i,...r)}function vd(n,e,t){const r=nt(n);gn(r,"iterate",$a);const s=r[e](...t);return(s===-1||s===!1)&&Qh(t[0])?(t[0]=nt(t[0]),r[e](...t)):s}function oa(n,e,t=[]){Vr(),qh();const r=nt(n)[e].apply(n,t);return zh(),Nr(),r}const eI=Uh("__proto__,__v_isRef,__isVue"),Q_=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Cs));function tI(n){Cs(n)||(n=String(n));const e=nt(this);return gn(e,"has",n),e.hasOwnProperty(n)}class J_{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?dI:ey:i?Z_:X_).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=xe(e);if(!s){let c;if(o&&(c=Xb[t]))return c;if(t==="hasOwnProperty")return tI}const a=Reflect.get(e,t,yn(e)?e:r);return(Cs(t)?Q_.has(t):eI(t))||(s||gn(e,"get",t),i)?a:yn(a)?o&&$h(t)?a:a.value:Et(a)?s?ny(a):gu(a):a}}class Y_ extends J_{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const c=ws(i);if(!$n(r)&&!ws(r)&&(i=nt(i),r=nt(r)),!xe(e)&&yn(i)&&!yn(r))return c?!1:(i.value=r,!0)}const o=xe(e)&&$h(t)?Number(t)<e.length:rt(e,t),a=Reflect.set(e,t,r,yn(e)?e:s);return e===nt(s)&&(o?gs(r,i)&&Ar(e,"set",t,r):Ar(e,"add",t,r)),a}deleteProperty(e,t){const r=rt(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&Ar(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!Cs(t)||!Q_.has(t))&&gn(e,"has",t),r}ownKeys(e){return gn(e,"iterate",xe(e)?"length":Zs),Reflect.ownKeys(e)}}class nI extends J_{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const rI=new Y_,sI=new nI,iI=new Y_(!0);const Zd=n=>n,rc=n=>Reflect.getPrototypeOf(n);function oI(n,e,t){return function(...r){const s=this.__v_raw,i=nt(s),o=Qi(i),a=n==="entries"||n===Symbol.iterator&&o,c=n==="keys"&&o,u=s[n](...r),d=t?Zd:e?Nc:ln;return!e&&gn(i,"iterate",c?Xd:Zs),{next(){const{value:f,done:g}=u.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function sc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function aI(n,e){const t={get(s){const i=this.__v_raw,o=nt(i),a=nt(s);n||(gs(s,a)&&gn(o,"get",s),gn(o,"get",a));const{has:c}=rc(o),u=e?Zd:n?Nc:ln;if(c.call(o,s))return u(i.get(s));if(c.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&gn(nt(s),"iterate",Zs),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=nt(i),a=nt(s);return n||(gs(s,a)&&gn(o,"has",s),gn(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,c=nt(a),u=e?Zd:n?Nc:ln;return!n&&gn(c,"iterate",Zs),a.forEach((d,f)=>s.call(i,u(d),u(f),o))}};return tn(t,n?{add:sc("add"),set:sc("set"),delete:sc("delete"),clear:sc("clear")}:{add(s){!e&&!$n(s)&&!ws(s)&&(s=nt(s));const i=nt(this);return rc(i).has.call(i,s)||(i.add(s),Ar(i,"add",s,s)),this},set(s,i){!e&&!$n(i)&&!ws(i)&&(i=nt(i));const o=nt(this),{has:a,get:c}=rc(o);let u=a.call(o,s);u||(s=nt(s),u=a.call(o,s));const d=c.call(o,s);return o.set(s,i),u?gs(i,d)&&Ar(o,"set",s,i):Ar(o,"add",s,i),this},delete(s){const i=nt(this),{has:o,get:a}=rc(i);let c=o.call(i,s);c||(s=nt(s),c=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return c&&Ar(i,"delete",s,void 0),u},clear(){const s=nt(this),i=s.size!==0,o=s.clear();return i&&Ar(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=oI(s,n,e)}),t}function Hh(n,e){const t=aI(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(rt(t,s)&&s in r?t:r,s,i)}const lI={get:Hh(!1,!1)},cI={get:Hh(!1,!0)},uI={get:Hh(!0,!1)};const X_=new WeakMap,Z_=new WeakMap,ey=new WeakMap,dI=new WeakMap;function hI(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fI(n){return n.__v_skip||!Object.isExtensible(n)?0:hI(Ub(n))}function gu(n){return ws(n)?n:Wh(n,!1,rI,lI,X_)}function ty(n){return Wh(n,!1,iI,cI,Z_)}function ny(n){return Wh(n,!0,sI,uI,ey)}function Wh(n,e,t,r,s){if(!Et(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=fI(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function Ji(n){return ws(n)?Ji(n.__v_raw):!!(n&&n.__v_isReactive)}function ws(n){return!!(n&&n.__v_isReadonly)}function $n(n){return!!(n&&n.__v_isShallow)}function Qh(n){return n?!!n.__v_raw:!1}function nt(n){const e=n&&n.__v_raw;return e?nt(e):n}function pI(n){return!rt(n,"__v_skip")&&Object.isExtensible(n)&&Wd(n,"__v_skip",!0),n}const ln=n=>Et(n)?gu(n):n,Nc=n=>Et(n)?ny(n):n;function yn(n){return n?n.__v_isRef===!0:!1}function K(n){return ry(n,!1)}function mI(n){return ry(n,!0)}function ry(n,e){return yn(n)?n:new gI(n,e)}class gI{constructor(e,t){this.dep=new Kh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:nt(e),this._value=t?e:ln(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||$n(e)||ws(e);e=r?e:nt(e),gs(e,t)&&(this._rawValue=e,this._value=r?e:ln(e),this.dep.trigger())}}function Yi(n){return yn(n)?n.value:n}const _I={get:(n,e,t)=>e==="__v_raw"?n:Yi(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return yn(s)&&!yn(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function sy(n){return Ji(n)?n:new Proxy(n,_I)}class yI{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Kh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ja-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&ft!==this)return q_(this,!0),!0}get value(){const e=this.dep.track();return K_(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function vI(n,e,t=!1){let r,s;return De(n)?r=n:(r=n.get,s=n.set),new yI(r,s,t)}const ic={},Oc=new WeakMap;let zs;function wI(n,e=!1,t=zs){if(t){let r=Oc.get(t);r||Oc.set(t,r=[]),r.push(n)}}function bI(n,e,t=dt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:c}=t,u=L=>s?L:$n(L)||s===!1||s===0?Pr(L,1):Pr(L);let d,f,g,_,C=!1,x=!1;if(yn(n)?(f=()=>n.value,C=$n(n)):Ji(n)?(f=()=>u(n),C=!0):xe(n)?(x=!0,C=n.some(L=>Ji(L)||$n(L)),f=()=>n.map(L=>{if(yn(L))return L.value;if(Ji(L))return u(L);if(De(L))return c?c(L,2):L()})):De(n)?e?f=c?()=>c(n,2):n:f=()=>{if(g){Vr();try{g()}finally{Nr()}}const L=zs;zs=d;try{return c?c(n,3,[_]):n(_)}finally{zs=L}}:f=Qn,e&&s){const L=f,$=s===!0?1/0:s;f=()=>Pr(L(),$)}const k=Qb(),N=()=>{d.stop(),k&&k.active&&jh(k.effects,d)};if(i&&e){const L=e;e=(...$)=>{L(...$),N()}}let B=x?new Array(n.length).fill(ic):ic;const F=L=>{if(!(!(d.flags&1)||!d.dirty&&!L))if(e){const $=d.run();if(s||C||(x?$.some((ee,S)=>gs(ee,B[S])):gs($,B))){g&&g();const ee=zs;zs=d;try{const S=[$,B===ic?void 0:x&&B[0]===ic?[]:B,_];B=$,c?c(e,3,S):e(...S)}finally{zs=ee}}}else d.run()};return a&&a(F),d=new j_(f),d.scheduler=o?()=>o(F,!1):F,_=L=>wI(L,!1,d),g=d.onStop=()=>{const L=Oc.get(d);if(L){if(c)c(L,4);else for(const $ of L)$();Oc.delete(d)}},e?r?F(!0):B=d.run():o?o(F.bind(null,!0),!0):d.run(),N.pause=d.pause.bind(d),N.resume=d.resume.bind(d),N.stop=N,N}function Pr(n,e=1/0,t){if(e<=0||!Et(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,yn(n))Pr(n.value,e,t);else if(xe(n))for(let r=0;r<n.length;r++)Pr(n[r],e,t);else if(N_(n)||Qi(n))n.forEach(r=>{Pr(r,e,t)});else if(L_(n)){for(const r in n)Pr(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&Pr(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function hl(n,e,t,r){try{return r?n(...r):n()}catch(s){_u(s,e,t)}}function fr(n,e,t,r){if(De(n)){const s=hl(n,e,t,r);return s&&O_(s)&&s.catch(i=>{_u(i,e,t)}),s}if(xe(n)){const s=[];for(let i=0;i<n.length;i++)s.push(fr(n[i],e,t,r));return s}}function _u(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||dt;if(e){let a=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,c,u)===!1)return}a=a.parent}if(i){Vr(),hl(i,null,10,[n,c,u]),Nr();return}}II(n,t,s,r,o)}function II(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const An=[];let rr=-1;const Xi=[];let is=null,ji=0;const iy=Promise.resolve();let Mc=null;function ri(n){const e=Mc||iy;return n?e.then(this?n.bind(this):n):e}function EI(n){let e=rr+1,t=An.length;for(;e<t;){const r=e+t>>>1,s=An[r],i=qa(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function Jh(n){if(!(n.flags&1)){const e=qa(n),t=An[An.length-1];!t||!(n.flags&2)&&e>=qa(t)?An.push(n):An.splice(EI(e),0,n),n.flags|=1,oy()}}function oy(){Mc||(Mc=iy.then(ly))}function TI(n){xe(n)?Xi.push(...n):is&&n.id===-1?is.splice(ji+1,0,n):n.flags&1||(Xi.push(n),n.flags|=1),oy()}function Zp(n,e,t=rr+1){for(;t<An.length;t++){const r=An[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;An.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function ay(n){if(Xi.length){const e=[...new Set(Xi)].sort((t,r)=>qa(t)-qa(r));if(Xi.length=0,is){is.push(...e);return}for(is=e,ji=0;ji<is.length;ji++){const t=is[ji];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}is=null,ji=0}}const qa=n=>n.id==null?n.flags&2?-1:1/0:n.id;function ly(n){const e=Qn;try{for(rr=0;rr<An.length;rr++){const t=An[rr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),hl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;rr<An.length;rr++){const t=An[rr];t&&(t.flags&=-2)}rr=-1,An.length=0,ay(),Mc=null,(An.length||Xi.length)&&ly()}}let Un=null,cy=null;function Lc(n){const e=Un;return Un=n,cy=n&&n.type.__scopeId||null,e}function AI(n,e=Un,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&lm(-1);const i=Lc(e);let o;try{o=n(...s)}finally{Lc(i),r._d&&lm(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Tt(n,e){if(Un===null)return n;const t=Iu(Un),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,c=dt]=e[s];i&&(De(i)&&(i={mounted:i,updated:i}),i.deep&&Pr(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:c}))}return n}function js(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Vr(),fr(c,t,8,[n.el,a,n,e]),Nr())}}const PI=Symbol("_vte"),SI=n=>n.__isTeleport;function Yh(n,e){n.shapeFlag&6&&n.component?(n.transition=e,Yh(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function uy(n,e){return De(n)?(()=>tn({name:n.name},e,{setup:n}))():n}function dy(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Sa(n,e,t,r,s=!1){if(xe(n)){n.forEach((C,x)=>Sa(C,e&&(xe(e)?e[x]:e),t,r,s));return}if(xa(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Sa(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?Iu(r.component):r.el,o=s?null:i,{i:a,r:c}=n,u=e&&e.r,d=a.refs===dt?a.refs={}:a.refs,f=a.setupState,g=nt(f),_=f===dt?()=>!1:C=>rt(g,C);if(u!=null&&u!==c&&($t(u)?(d[u]=null,_(u)&&(f[u]=null)):yn(u)&&(u.value=null)),De(c))hl(c,a,12,[o,d]);else{const C=$t(c),x=yn(c);if(C||x){const k=()=>{if(n.f){const N=C?_(c)?f[c]:d[c]:c.value;s?xe(N)&&jh(N,i):xe(N)?N.includes(i)||N.push(i):C?(d[c]=[i],_(c)&&(f[c]=d[c])):(c.value=[i],n.k&&(d[n.k]=c.value))}else C?(d[c]=o,_(c)&&(f[c]=o)):x&&(c.value=o,n.k&&(d[n.k]=o))};o?(k.id=-1,Ln(k,t)):k()}}}pu().requestIdleCallback;pu().cancelIdleCallback;const xa=n=>!!n.type.__asyncLoader,hy=n=>n.type.__isKeepAlive;function xI(n,e){fy(n,"a",e)}function RI(n,e){fy(n,"da",e)}function fy(n,e,t=_n){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(yu(e,r,t),t){let s=t.parent;for(;s&&s.parent;)hy(s.parent.vnode)&&CI(r,e,t,s),s=s.parent}}function CI(n,e,t,r){const s=yu(e,n,r,!0);py(()=>{jh(r[e],s)},t)}function yu(n,e,t=_n,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Vr();const a=fl(t),c=fr(e,t,n,o);return a(),Nr(),c});return r?s.unshift(i):s.push(i),i}}const jr=n=>(e,t=_n)=>{(!Ga||n==="sp")&&yu(n,(...r)=>e(...r),t)},kI=jr("bm"),vu=jr("m"),DI=jr("bu"),VI=jr("u"),NI=jr("bum"),py=jr("um"),OI=jr("sp"),MI=jr("rtg"),LI=jr("rtc");function FI(n,e=_n){yu("ec",n,e)}const my="components";function UI(n,e){return jI(my,n,!0,e)||n}const BI=Symbol.for("v-ndc");function jI(n,e,t=!0,r=!1){const s=Un||_n;if(s){const i=s.type;if(n===my){const a=SE(i,!1);if(a&&(a===e||a===qn(e)||a===fu(qn(e))))return i}const o=em(s[n]||i[n],e)||em(s.appContext[n],e);return!o&&r?i:o}}function em(n,e){return n&&(n[e]||n[qn(e)]||n[fu(qn(e))])}function sr(n,e,t,r){let s;const i=t&&t[r],o=xe(n);if(o||$t(n)){const a=o&&Ji(n);let c=!1,u=!1;a&&(c=!$n(n),u=ws(n),n=mu(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(c?u?Nc(ln(n[d])):ln(n[d]):n[d],d,void 0,i&&i[d])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(Et(n))if(n[Symbol.iterator])s=Array.from(n,(a,c)=>e(a,c,void 0,i&&i[c]));else{const a=Object.keys(n);s=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const d=a[c];s[c]=e(n[d],d,c,i&&i[c])}}else s=[];return t&&(t[r]=s),s}const eh=n=>n?Oy(n)?Iu(n):eh(n.parent):null,Ra=tn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>eh(n.parent),$root:n=>eh(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>Xh(n),$forceUpdate:n=>n.f||(n.f=()=>{Jh(n.update)}),$nextTick:n=>n.n||(n.n=ri.bind(n.proxy)),$watch:n=>lE.bind(n)}),wd=(n,e)=>n!==dt&&!n.__isScriptSetup&&rt(n,e),$I={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=n;let u;if(e[0]!=="$"){const _=o[e];if(_!==void 0)switch(_){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(wd(r,e))return o[e]=1,r[e];if(s!==dt&&rt(s,e))return o[e]=2,s[e];if((u=n.propsOptions[0])&&rt(u,e))return o[e]=3,i[e];if(t!==dt&&rt(t,e))return o[e]=4,t[e];th&&(o[e]=0)}}const d=Ra[e];let f,g;if(d)return e==="$attrs"&&gn(n.attrs,"get",""),d(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==dt&&rt(t,e))return o[e]=4,t[e];if(g=c.config.globalProperties,rt(g,e))return g[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return wd(s,e)?(s[e]=t,!0):r!==dt&&rt(r,e)?(r[e]=t,!0):rt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==dt&&rt(n,o)||wd(e,o)||(a=i[0])&&rt(a,o)||rt(r,o)||rt(Ra,o)||rt(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:rt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function tm(n){return xe(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let th=!0;function qI(n){const e=Xh(n),t=n.proxy,r=n.ctx;th=!1,e.beforeCreate&&nm(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:u,created:d,beforeMount:f,mounted:g,beforeUpdate:_,updated:C,activated:x,deactivated:k,beforeDestroy:N,beforeUnmount:B,destroyed:F,unmounted:L,render:$,renderTracked:ee,renderTriggered:S,errorCaptured:I,serverPrefetch:P,expose:R,inheritAttrs:w,components:T,directives:E,filters:Re}=e;if(u&&zI(u,r,null),o)for(const Oe in o){const Ce=o[Oe];De(Ce)&&(r[Oe]=Ce.bind(t))}if(s){const Oe=s.call(t,t);Et(Oe)&&(n.data=gu(Oe))}if(th=!0,i)for(const Oe in i){const Ce=i[Oe],qt=De(Ce)?Ce.bind(t,t):De(Ce.get)?Ce.get.bind(t,t):Qn,nn=!De(Ce)&&De(Ce.set)?Ce.set.bind(t):Qn,zt=cn({get:qt,set:nn});Object.defineProperty(r,Oe,{enumerable:!0,configurable:!0,get:()=>zt.value,set:Qe=>zt.value=Qe})}if(a)for(const Oe in a)gy(a[Oe],r,t,Oe);if(c){const Oe=De(c)?c.call(t):c;Reflect.ownKeys(Oe).forEach(Ce=>{gc(Ce,Oe[Ce])})}d&&nm(d,n,"c");function je(Oe,Ce){xe(Ce)?Ce.forEach(qt=>Oe(qt.bind(t))):Ce&&Oe(Ce.bind(t))}if(je(kI,f),je(vu,g),je(DI,_),je(VI,C),je(xI,x),je(RI,k),je(FI,I),je(LI,ee),je(MI,S),je(NI,B),je(py,L),je(OI,P),xe(R))if(R.length){const Oe=n.exposed||(n.exposed={});R.forEach(Ce=>{Object.defineProperty(Oe,Ce,{get:()=>t[Ce],set:qt=>t[Ce]=qt})})}else n.exposed||(n.exposed={});$&&n.render===Qn&&(n.render=$),w!=null&&(n.inheritAttrs=w),T&&(n.components=T),E&&(n.directives=E),P&&dy(n)}function zI(n,e,t=Qn){xe(n)&&(n=nh(n));for(const r in n){const s=n[r];let i;Et(s)?"default"in s?i=Yn(s.from||r,s.default,!0):i=Yn(s.from||r):i=Yn(s),yn(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function nm(n,e,t){fr(xe(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function gy(n,e,t,r){let s=r.includes(".")?Ry(t,r):()=>t[r];if($t(n)){const i=e[n];De(i)&&Xn(s,i)}else if(De(n))Xn(s,n.bind(t));else if(Et(n))if(xe(n))n.forEach(i=>gy(i,e,t,r));else{const i=De(n.handler)?n.handler.bind(t):e[n.handler];De(i)&&Xn(s,i,n)}}function Xh(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!t&&!r?c=e:(c={},s.length&&s.forEach(u=>Fc(c,u,o,!0)),Fc(c,e,o)),Et(e)&&i.set(e,c),c}function Fc(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Fc(n,i,t,!0),s&&s.forEach(o=>Fc(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=GI[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const GI={data:rm,props:sm,emits:sm,methods:ga,computed:ga,beforeCreate:En,created:En,beforeMount:En,mounted:En,beforeUpdate:En,updated:En,beforeDestroy:En,beforeUnmount:En,destroyed:En,unmounted:En,activated:En,deactivated:En,errorCaptured:En,serverPrefetch:En,components:ga,directives:ga,watch:HI,provide:rm,inject:KI};function rm(n,e){return e?n?function(){return tn(De(n)?n.call(this,this):n,De(e)?e.call(this,this):e)}:e:n}function KI(n,e){return ga(nh(n),nh(e))}function nh(n){if(xe(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function En(n,e){return n?[...new Set([].concat(n,e))]:e}function ga(n,e){return n?tn(Object.create(null),n,e):e}function sm(n,e){return n?xe(n)&&xe(e)?[...new Set([...n,...e])]:tn(Object.create(null),tm(n),tm(e??{})):e}function HI(n,e){if(!n)return e;if(!e)return n;const t=tn(Object.create(null),n);for(const r in e)t[r]=En(n[r],e[r]);return t}function _y(){return{app:null,config:{isNativeTag:Lb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let WI=0;function QI(n,e){return function(r,s=null){De(r)||(r=tn({},r)),s!=null&&!Et(s)&&(s=null);const i=_y(),o=new WeakSet,a=[];let c=!1;const u=i.app={_uid:WI++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:RE,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&De(d.install)?(o.add(d),d.install(u,...f)):De(d)&&(o.add(d),d(u,...f))),u},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),u},component(d,f){return f?(i.components[d]=f,u):i.components[d]},directive(d,f){return f?(i.directives[d]=f,u):i.directives[d]},mount(d,f,g){if(!c){const _=u._ceVNode||jt(r,s);return _.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),f&&e?e(_,d):n(_,d,g),c=!0,u._container=d,d.__vue_app__=u,Iu(_.component)}},onUnmount(d){a.push(d)},unmount(){c&&(fr(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(d,f){return i.provides[d]=f,u},runWithContext(d){const f=Zi;Zi=u;try{return d()}finally{Zi=f}}};return u}}let Zi=null;function gc(n,e){if(_n){let t=_n.provides;const r=_n.parent&&_n.parent.provides;r===t&&(t=_n.provides=Object.create(r)),t[n]=e}}function Yn(n,e,t=!1){const r=_n||Un;if(r||Zi){let s=Zi?Zi._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&De(e)?e.call(r&&r.proxy):e}}const yy={},vy=()=>Object.create(yy),wy=n=>Object.getPrototypeOf(n)===yy;function JI(n,e,t,r=!1){const s={},i=vy();n.propsDefaults=Object.create(null),by(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:ty(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function YI(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=nt(s),[c]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(wu(n.emitsOptions,g))continue;const _=e[g];if(c)if(rt(i,g))_!==i[g]&&(i[g]=_,u=!0);else{const C=qn(g);s[C]=rh(c,a,C,_,n,!1)}else _!==i[g]&&(i[g]=_,u=!0)}}}else{by(n,e,s,i)&&(u=!0);let d;for(const f in a)(!e||!rt(e,f)&&((d=ks(f))===f||!rt(e,d)))&&(c?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=rh(c,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!rt(e,f))&&(delete i[f],u=!0)}u&&Ar(n.attrs,"set","")}function by(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let c in e){if(Ta(c))continue;const u=e[c];let d;s&&rt(s,d=qn(c))?!i||!i.includes(d)?t[d]=u:(a||(a={}))[d]=u:wu(n.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,o=!0)}if(i){const c=nt(t),u=a||dt;for(let d=0;d<i.length;d++){const f=i[d];t[f]=rh(s,c,f,u[f],n,!rt(u,f))}}return o}function rh(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=rt(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&De(c)){const{propsDefaults:u}=s;if(t in u)r=u[t];else{const d=fl(s);r=u[t]=c.call(null,e),d()}}else r=c;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===ks(t))&&(r=!0))}return r}const XI=new WeakMap;function Iy(n,e,t=!1){const r=t?XI:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let c=!1;if(!De(n)){const d=f=>{c=!0;const[g,_]=Iy(f,e,!0);tn(o,g),_&&a.push(..._)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!c)return Et(n)&&r.set(n,Wi),Wi;if(xe(i))for(let d=0;d<i.length;d++){const f=qn(i[d]);im(f)&&(o[f]=dt)}else if(i)for(const d in i){const f=qn(d);if(im(f)){const g=i[d],_=o[f]=xe(g)||De(g)?{type:g}:tn({},g),C=_.type;let x=!1,k=!0;if(xe(C))for(let N=0;N<C.length;++N){const B=C[N],F=De(B)&&B.name;if(F==="Boolean"){x=!0;break}else F==="String"&&(k=!1)}else x=De(C)&&C.name==="Boolean";_[0]=x,_[1]=k,(x||rt(_,"default"))&&a.push(f)}}const u=[o,a];return Et(n)&&r.set(n,u),u}function im(n){return n[0]!=="$"&&!Ta(n)}const Zh=n=>n[0]==="_"||n==="$stable",ef=n=>xe(n)?n.map(ir):[ir(n)],ZI=(n,e,t)=>{if(e._n)return e;const r=AI((...s)=>ef(e(...s)),t);return r._c=!1,r},Ey=(n,e,t)=>{const r=n._ctx;for(const s in n){if(Zh(s))continue;const i=n[s];if(De(i))e[s]=ZI(s,i,r);else if(i!=null){const o=ef(i);e[s]=()=>o}}},Ty=(n,e)=>{const t=ef(e);n.slots.default=()=>t},Ay=(n,e,t)=>{for(const r in e)(t||!Zh(r))&&(n[r]=e[r])},eE=(n,e,t)=>{const r=n.slots=vy();if(n.vnode.shapeFlag&32){const s=e.__;s&&Wd(r,"__",s,!0);const i=e._;i?(Ay(r,e,t),t&&Wd(r,"_",i,!0)):Ey(e,r)}else e&&Ty(n,e)},tE=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=dt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:Ay(s,e,t):(i=!e.$stable,Ey(e,s)),o=e}else e&&(Ty(n,e),o={default:1});if(i)for(const a in s)!Zh(a)&&o[a]==null&&delete s[a]},Ln=mE;function nE(n){return rE(n)}function rE(n,e){const t=pu();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:d,parentNode:f,nextSibling:g,setScopeId:_=Qn,insertStaticContent:C}=n,x=(b,A,V,G=null,z=null,Z=null,ue=void 0,se=null,ne=!!A.dynamicChildren)=>{if(b===A)return;b&&!aa(b,A)&&(G=q(b),Qe(b,z,Z,!0),b=null),A.patchFlag===-2&&(ne=!1,A.dynamicChildren=null);const{type:X,ref:ye,shapeFlag:oe}=A;switch(X){case bu:k(b,A,V,G);break;case bs:N(b,A,V,G);break;case _c:b==null&&B(A,V,G,ue);break;case Rt:T(b,A,V,G,z,Z,ue,se,ne);break;default:oe&1?$(b,A,V,G,z,Z,ue,se,ne):oe&6?E(b,A,V,G,z,Z,ue,se,ne):(oe&64||oe&128)&&X.process(b,A,V,G,z,Z,ue,se,ne,fe)}ye!=null&&z?Sa(ye,b&&b.ref,Z,A||b,!A):ye==null&&b&&b.ref!=null&&Sa(b.ref,null,Z,b,!0)},k=(b,A,V,G)=>{if(b==null)r(A.el=a(A.children),V,G);else{const z=A.el=b.el;A.children!==b.children&&u(z,A.children)}},N=(b,A,V,G)=>{b==null?r(A.el=c(A.children||""),V,G):A.el=b.el},B=(b,A,V,G)=>{[b.el,b.anchor]=C(b.children,A,V,G,b.el,b.anchor)},F=({el:b,anchor:A},V,G)=>{let z;for(;b&&b!==A;)z=g(b),r(b,V,G),b=z;r(A,V,G)},L=({el:b,anchor:A})=>{let V;for(;b&&b!==A;)V=g(b),s(b),b=V;s(A)},$=(b,A,V,G,z,Z,ue,se,ne)=>{A.type==="svg"?ue="svg":A.type==="math"&&(ue="mathml"),b==null?ee(A,V,G,z,Z,ue,se,ne):P(b,A,z,Z,ue,se,ne)},ee=(b,A,V,G,z,Z,ue,se)=>{let ne,X;const{props:ye,shapeFlag:oe,transition:me,dirs:Ee}=b;if(ne=b.el=o(b.type,Z,ye&&ye.is,ye),oe&8?d(ne,b.children):oe&16&&I(b.children,ne,null,G,z,bd(b,Z),ue,se),Ee&&js(b,null,G,"created"),S(ne,b,b.scopeId,ue,G),ye){for(const ke in ye)ke!=="value"&&!Ta(ke)&&i(ne,ke,null,ye[ke],Z,G);"value"in ye&&i(ne,"value",null,ye.value,Z),(X=ye.onVnodeBeforeMount)&&nr(X,G,b)}Ee&&js(b,null,G,"beforeMount");const Ie=sE(z,me);Ie&&me.beforeEnter(ne),r(ne,A,V),((X=ye&&ye.onVnodeMounted)||Ie||Ee)&&Ln(()=>{X&&nr(X,G,b),Ie&&me.enter(ne),Ee&&js(b,null,G,"mounted")},z)},S=(b,A,V,G,z)=>{if(V&&_(b,V),G)for(let Z=0;Z<G.length;Z++)_(b,G[Z]);if(z){let Z=z.subTree;if(A===Z||ky(Z.type)&&(Z.ssContent===A||Z.ssFallback===A)){const ue=z.vnode;S(b,ue,ue.scopeId,ue.slotScopeIds,z.parent)}}},I=(b,A,V,G,z,Z,ue,se,ne=0)=>{for(let X=ne;X<b.length;X++){const ye=b[X]=se?os(b[X]):ir(b[X]);x(null,ye,A,V,G,z,Z,ue,se)}},P=(b,A,V,G,z,Z,ue)=>{const se=A.el=b.el;let{patchFlag:ne,dynamicChildren:X,dirs:ye}=A;ne|=b.patchFlag&16;const oe=b.props||dt,me=A.props||dt;let Ee;if(V&&$s(V,!1),(Ee=me.onVnodeBeforeUpdate)&&nr(Ee,V,A,b),ye&&js(A,b,V,"beforeUpdate"),V&&$s(V,!0),(oe.innerHTML&&me.innerHTML==null||oe.textContent&&me.textContent==null)&&d(se,""),X?R(b.dynamicChildren,X,se,V,G,bd(A,z),Z):ue||Ce(b,A,se,null,V,G,bd(A,z),Z,!1),ne>0){if(ne&16)w(se,oe,me,V,z);else if(ne&2&&oe.class!==me.class&&i(se,"class",null,me.class,z),ne&4&&i(se,"style",oe.style,me.style,z),ne&8){const Ie=A.dynamicProps;for(let ke=0;ke<Ie.length;ke++){const $e=Ie[ke],Gt=oe[$e],Dt=me[$e];(Dt!==Gt||$e==="value")&&i(se,$e,Gt,Dt,z,V)}}ne&1&&b.children!==A.children&&d(se,A.children)}else!ue&&X==null&&w(se,oe,me,V,z);((Ee=me.onVnodeUpdated)||ye)&&Ln(()=>{Ee&&nr(Ee,V,A,b),ye&&js(A,b,V,"updated")},G)},R=(b,A,V,G,z,Z,ue)=>{for(let se=0;se<A.length;se++){const ne=b[se],X=A[se],ye=ne.el&&(ne.type===Rt||!aa(ne,X)||ne.shapeFlag&198)?f(ne.el):V;x(ne,X,ye,null,G,z,Z,ue,!0)}},w=(b,A,V,G,z)=>{if(A!==V){if(A!==dt)for(const Z in A)!Ta(Z)&&!(Z in V)&&i(b,Z,A[Z],null,z,G);for(const Z in V){if(Ta(Z))continue;const ue=V[Z],se=A[Z];ue!==se&&Z!=="value"&&i(b,Z,se,ue,z,G)}"value"in V&&i(b,"value",A.value,V.value,z)}},T=(b,A,V,G,z,Z,ue,se,ne)=>{const X=A.el=b?b.el:a(""),ye=A.anchor=b?b.anchor:a("");let{patchFlag:oe,dynamicChildren:me,slotScopeIds:Ee}=A;Ee&&(se=se?se.concat(Ee):Ee),b==null?(r(X,V,G),r(ye,V,G),I(A.children||[],V,ye,z,Z,ue,se,ne)):oe>0&&oe&64&&me&&b.dynamicChildren?(R(b.dynamicChildren,me,V,z,Z,ue,se),(A.key!=null||z&&A===z.subTree)&&Py(b,A,!0)):Ce(b,A,V,ye,z,Z,ue,se,ne)},E=(b,A,V,G,z,Z,ue,se,ne)=>{A.slotScopeIds=se,b==null?A.shapeFlag&512?z.ctx.activate(A,V,G,ue,ne):Re(A,V,G,z,Z,ue,ne):Ye(b,A,ne)},Re=(b,A,V,G,z,Z,ue)=>{const se=b.component=IE(b,G,z);if(hy(b)&&(se.ctx.renderer=fe),EE(se,!1,ue),se.asyncDep){if(z&&z.registerDep(se,je,ue),!b.el){const ne=se.subTree=jt(bs);N(null,ne,A,V)}}else je(se,b,A,V,z,Z,ue)},Ye=(b,A,V)=>{const G=A.component=b.component;if(fE(b,A,V))if(G.asyncDep&&!G.asyncResolved){Oe(G,A,V);return}else G.next=A,G.update();else A.el=b.el,G.vnode=A},je=(b,A,V,G,z,Z,ue)=>{const se=()=>{if(b.isMounted){let{next:oe,bu:me,u:Ee,parent:Ie,vnode:ke}=b;{const Ve=Sy(b);if(Ve){oe&&(oe.el=ke.el,Oe(b,oe,ue)),Ve.asyncDep.then(()=>{b.isUnmounted||se()});return}}let $e=oe,Gt;$s(b,!1),oe?(oe.el=ke.el,Oe(b,oe,ue)):oe=ke,me&&mc(me),(Gt=oe.props&&oe.props.onVnodeBeforeUpdate)&&nr(Gt,Ie,oe,ke),$s(b,!0);const Dt=Id(b),Me=b.subTree;b.subTree=Dt,x(Me,Dt,f(Me.el),q(Me),b,z,Z),oe.el=Dt.el,$e===null&&pE(b,Dt.el),Ee&&Ln(Ee,z),(Gt=oe.props&&oe.props.onVnodeUpdated)&&Ln(()=>nr(Gt,Ie,oe,ke),z)}else{let oe;const{el:me,props:Ee}=A,{bm:Ie,m:ke,parent:$e,root:Gt,type:Dt}=b,Me=xa(A);if($s(b,!1),Ie&&mc(Ie),!Me&&(oe=Ee&&Ee.onVnodeBeforeMount)&&nr(oe,$e,A),$s(b,!0),me&&Ze){const Ve=()=>{b.subTree=Id(b),Ze(me,b.subTree,b,z,null)};Me&&Dt.__asyncHydrate?Dt.__asyncHydrate(me,b,Ve):Ve()}else{Gt.ce&&Gt.ce._def.shadowRoot!==!1&&Gt.ce._injectChildStyle(Dt);const Ve=b.subTree=Id(b);x(null,Ve,V,G,b,z,Z),A.el=Ve.el}if(ke&&Ln(ke,z),!Me&&(oe=Ee&&Ee.onVnodeMounted)){const Ve=A;Ln(()=>nr(oe,$e,Ve),z)}(A.shapeFlag&256||$e&&xa($e.vnode)&&$e.vnode.shapeFlag&256)&&b.a&&Ln(b.a,z),b.isMounted=!0,A=V=G=null}};b.scope.on();const ne=b.effect=new j_(se);b.scope.off();const X=b.update=ne.run.bind(ne),ye=b.job=ne.runIfDirty.bind(ne);ye.i=b,ye.id=b.uid,ne.scheduler=()=>Jh(ye),$s(b,!0),X()},Oe=(b,A,V)=>{A.component=b;const G=b.vnode.props;b.vnode=A,b.next=null,YI(b,A.props,G,V),tE(b,A.children,V),Vr(),Zp(b),Nr()},Ce=(b,A,V,G,z,Z,ue,se,ne=!1)=>{const X=b&&b.children,ye=b?b.shapeFlag:0,oe=A.children,{patchFlag:me,shapeFlag:Ee}=A;if(me>0){if(me&128){nn(X,oe,V,G,z,Z,ue,se,ne);return}else if(me&256){qt(X,oe,V,G,z,Z,ue,se,ne);return}}Ee&8?(ye&16&&Je(X,z,Z),oe!==X&&d(V,oe)):ye&16?Ee&16?nn(X,oe,V,G,z,Z,ue,se,ne):Je(X,z,Z,!0):(ye&8&&d(V,""),Ee&16&&I(oe,V,G,z,Z,ue,se,ne))},qt=(b,A,V,G,z,Z,ue,se,ne)=>{b=b||Wi,A=A||Wi;const X=b.length,ye=A.length,oe=Math.min(X,ye);let me;for(me=0;me<oe;me++){const Ee=A[me]=ne?os(A[me]):ir(A[me]);x(b[me],Ee,V,null,z,Z,ue,se,ne)}X>ye?Je(b,z,Z,!0,!1,oe):I(A,V,G,z,Z,ue,se,ne,oe)},nn=(b,A,V,G,z,Z,ue,se,ne)=>{let X=0;const ye=A.length;let oe=b.length-1,me=ye-1;for(;X<=oe&&X<=me;){const Ee=b[X],Ie=A[X]=ne?os(A[X]):ir(A[X]);if(aa(Ee,Ie))x(Ee,Ie,V,null,z,Z,ue,se,ne);else break;X++}for(;X<=oe&&X<=me;){const Ee=b[oe],Ie=A[me]=ne?os(A[me]):ir(A[me]);if(aa(Ee,Ie))x(Ee,Ie,V,null,z,Z,ue,se,ne);else break;oe--,me--}if(X>oe){if(X<=me){const Ee=me+1,Ie=Ee<ye?A[Ee].el:G;for(;X<=me;)x(null,A[X]=ne?os(A[X]):ir(A[X]),V,Ie,z,Z,ue,se,ne),X++}}else if(X>me)for(;X<=oe;)Qe(b[X],z,Z,!0),X++;else{const Ee=X,Ie=X,ke=new Map;for(X=Ie;X<=me;X++){const Kt=A[X]=ne?os(A[X]):ir(A[X]);Kt.key!=null&&ke.set(Kt.key,X)}let $e,Gt=0;const Dt=me-Ie+1;let Me=!1,Ve=0;const lt=new Array(Dt);for(X=0;X<Dt;X++)lt[X]=0;for(X=Ee;X<=oe;X++){const Kt=b[X];if(Gt>=Dt){Qe(Kt,z,Z,!0);continue}let In;if(Kt.key!=null)In=ke.get(Kt.key);else for($e=Ie;$e<=me;$e++)if(lt[$e-Ie]===0&&aa(Kt,A[$e])){In=$e;break}In===void 0?Qe(Kt,z,Z,!0):(lt[In-Ie]=X+1,In>=Ve?Ve=In:Me=!0,x(Kt,A[In],V,null,z,Z,ue,se,ne),Gt++)}const it=Me?iE(lt):Wi;for($e=it.length-1,X=Dt-1;X>=0;X--){const Kt=Ie+X,In=A[Kt],Ii=Kt+1<ye?A[Kt+1].el:G;lt[X]===0?x(null,In,V,Ii,z,Z,ue,se,ne):Me&&($e<0||X!==it[$e]?zt(In,V,Ii,2):$e--)}}},zt=(b,A,V,G,z=null)=>{const{el:Z,type:ue,transition:se,children:ne,shapeFlag:X}=b;if(X&6){zt(b.component.subTree,A,V,G);return}if(X&128){b.suspense.move(A,V,G);return}if(X&64){ue.move(b,A,V,fe);return}if(ue===Rt){r(Z,A,V);for(let oe=0;oe<ne.length;oe++)zt(ne[oe],A,V,G);r(b.anchor,A,V);return}if(ue===_c){F(b,A,V);return}if(G!==2&&X&1&&se)if(G===0)se.beforeEnter(Z),r(Z,A,V),Ln(()=>se.enter(Z),z);else{const{leave:oe,delayLeave:me,afterLeave:Ee}=se,Ie=()=>{b.ctx.isUnmounted?s(Z):r(Z,A,V)},ke=()=>{oe(Z,()=>{Ie(),Ee&&Ee()})};me?me(Z,Ie,ke):ke()}else r(Z,A,V)},Qe=(b,A,V,G=!1,z=!1)=>{const{type:Z,props:ue,ref:se,children:ne,dynamicChildren:X,shapeFlag:ye,patchFlag:oe,dirs:me,cacheIndex:Ee}=b;if(oe===-2&&(z=!1),se!=null&&(Vr(),Sa(se,null,V,b,!0),Nr()),Ee!=null&&(A.renderCache[Ee]=void 0),ye&256){A.ctx.deactivate(b);return}const Ie=ye&1&&me,ke=!xa(b);let $e;if(ke&&($e=ue&&ue.onVnodeBeforeUnmount)&&nr($e,A,b),ye&6)Ft(b.component,V,G);else{if(ye&128){b.suspense.unmount(V,G);return}Ie&&js(b,null,A,"beforeUnmount"),ye&64?b.type.remove(b,A,V,fe,G):X&&!X.hasOnce&&(Z!==Rt||oe>0&&oe&64)?Je(X,A,V,!1,!0):(Z===Rt&&oe&384||!z&&ye&16)&&Je(ne,A,V),G&&Xe(b)}(ke&&($e=ue&&ue.onVnodeUnmounted)||Ie)&&Ln(()=>{$e&&nr($e,A,b),Ie&&js(b,null,A,"unmounted")},V)},Xe=b=>{const{type:A,el:V,anchor:G,transition:z}=b;if(A===Rt){bn(V,G);return}if(A===_c){L(b);return}const Z=()=>{s(V),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(b.shapeFlag&1&&z&&!z.persisted){const{leave:ue,delayLeave:se}=z,ne=()=>ue(V,Z);se?se(b.el,Z,ne):ne()}else Z()},bn=(b,A)=>{let V;for(;b!==A;)V=g(b),s(b),b=V;s(A)},Ft=(b,A,V)=>{const{bum:G,scope:z,job:Z,subTree:ue,um:se,m:ne,a:X,parent:ye,slots:{__:oe}}=b;om(ne),om(X),G&&mc(G),ye&&xe(oe)&&oe.forEach(me=>{ye.renderCache[me]=void 0}),z.stop(),Z&&(Z.flags|=8,Qe(ue,b,A,V)),se&&Ln(se,A),Ln(()=>{b.isUnmounted=!0},A),A&&A.pendingBranch&&!A.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===A.pendingId&&(A.deps--,A.deps===0&&A.resolve())},Je=(b,A,V,G=!1,z=!1,Z=0)=>{for(let ue=Z;ue<b.length;ue++)Qe(b[ue],A,V,G,z)},q=b=>{if(b.shapeFlag&6)return q(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const A=g(b.anchor||b.el),V=A&&A[PI];return V?g(V):A};let ce=!1;const te=(b,A,V)=>{b==null?A._vnode&&Qe(A._vnode,null,null,!0):x(A._vnode||null,b,A,null,null,null,V),A._vnode=b,ce||(ce=!0,Zp(),ay(),ce=!1)},fe={p:x,um:Qe,m:zt,r:Xe,mt:Re,mc:I,pc:Ce,pbc:R,n:q,o:n};let Ue,Ze;return e&&([Ue,Ze]=e(fe)),{render:te,hydrate:Ue,createApp:QI(te,Ue)}}function bd({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function $s({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function sE(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function Py(n,e,t=!1){const r=n.children,s=e.children;if(xe(r)&&xe(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=os(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&Py(o,a)),a.type===bu&&(a.el=o.el),a.type===bs&&!a.el&&(a.el=o.el)}}function iE(n){const e=n.slice(),t=[0];let r,s,i,o,a;const c=n.length;for(r=0;r<c;r++){const u=n[r];if(u!==0){if(s=t[t.length-1],n[s]<u){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<u?i=a+1:o=a;u<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function Sy(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Sy(e)}function om(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const oE=Symbol.for("v-scx"),aE=()=>Yn(oE);function Xn(n,e,t){return xy(n,e,t)}function xy(n,e,t=dt){const{immediate:r,deep:s,flush:i,once:o}=t,a=tn({},t),c=e&&r||!e&&i!=="post";let u;if(Ga){if(i==="sync"){const _=aE();u=_.__watcherHandles||(_.__watcherHandles=[])}else if(!c){const _=()=>{};return _.stop=Qn,_.resume=Qn,_.pause=Qn,_}}const d=_n;a.call=(_,C,x)=>fr(_,d,C,x);let f=!1;i==="post"?a.scheduler=_=>{Ln(_,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(_,C)=>{C?_():Jh(_)}),a.augmentJob=_=>{e&&(_.flags|=4),f&&(_.flags|=2,d&&(_.id=d.uid,_.i=d))};const g=bI(n,e,a);return Ga&&(u?u.push(g):c&&g()),g}function lE(n,e,t){const r=this.proxy,s=$t(n)?n.includes(".")?Ry(r,n):()=>r[n]:n.bind(r,r);let i;De(e)?i=e:(i=e.handler,t=e);const o=fl(this),a=xy(s,i.bind(r),t);return o(),a}function Ry(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const cE=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${qn(e)}Modifiers`]||n[`${ks(e)}Modifiers`];function uE(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||dt;let s=t;const i=e.startsWith("update:"),o=i&&cE(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>$t(d)?d.trim():d)),o.number&&(s=t.map(Qd)));let a,c=r[a=md(e)]||r[a=md(qn(e))];!c&&i&&(c=r[a=md(ks(e))]),c&&fr(c,n,6,s);const u=r[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,fr(u,n,6,s)}}function Cy(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!De(n)){const c=u=>{const d=Cy(u,e,!0);d&&(a=!0,tn(o,d))};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}return!i&&!a?(Et(n)&&r.set(n,null),null):(xe(i)?i.forEach(c=>o[c]=null):tn(o,i),Et(n)&&r.set(n,o),o)}function wu(n,e){return!n||!uu(e)?!1:(e=e.slice(2).replace(/Once$/,""),rt(n,e[0].toLowerCase()+e.slice(1))||rt(n,ks(e))||rt(n,e))}function Id(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:c,render:u,renderCache:d,props:f,data:g,setupState:_,ctx:C,inheritAttrs:x}=n,k=Lc(n);let N,B;try{if(t.shapeFlag&4){const L=s||r,$=L;N=ir(u.call($,L,d,f,_,g,C)),B=a}else{const L=e;N=ir(L.length>1?L(f,{attrs:a,slots:o,emit:c}):L(f,null)),B=e.props?a:dE(a)}}catch(L){Ca.length=0,_u(L,n,1),N=jt(bs)}let F=N;if(B&&x!==!1){const L=Object.keys(B),{shapeFlag:$}=F;L.length&&$&7&&(i&&L.some(Bh)&&(B=hE(B,i)),F=ao(F,B,!1,!0))}return t.dirs&&(F=ao(F,null,!1,!0),F.dirs=F.dirs?F.dirs.concat(t.dirs):t.dirs),t.transition&&Yh(F,t.transition),N=F,Lc(k),N}const dE=n=>{let e;for(const t in n)(t==="class"||t==="style"||uu(t))&&((e||(e={}))[t]=n[t]);return e},hE=(n,e)=>{const t={};for(const r in n)(!Bh(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function fE(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&c>=0){if(c&1024)return!0;if(c&16)return r?am(r,o,u):!!o;if(c&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(o[g]!==r[g]&&!wu(u,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?am(r,o,u):!0:!!o;return!1}function am(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!wu(t,i))return!0}return!1}function pE({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const ky=n=>n.__isSuspense;function mE(n,e){e&&e.pendingBranch?xe(n)?e.effects.push(...n):e.effects.push(n):TI(n)}const Rt=Symbol.for("v-fgt"),bu=Symbol.for("v-txt"),bs=Symbol.for("v-cmt"),_c=Symbol.for("v-stc"),Ca=[];let Bn=null;function W(n=!1){Ca.push(Bn=n?null:[])}function gE(){Ca.pop(),Bn=Ca[Ca.length-1]||null}let za=1;function lm(n,e=!1){za+=n,n<0&&Bn&&e&&(Bn.hasOnce=!0)}function Dy(n){return n.dynamicChildren=za>0?Bn||Wi:null,gE(),za>0&&Bn&&Bn.push(n),n}function Q(n,e,t,r,s,i){return Dy(m(n,e,t,r,s,i,!0))}function Vy(n,e,t,r,s){return Dy(jt(n,e,t,r,s,!0))}function Uc(n){return n?n.__v_isVNode===!0:!1}function aa(n,e){return n.type===e.type&&n.key===e.key}const Ny=({key:n})=>n??null,yc=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?$t(n)||yn(n)||De(n)?{i:Un,r:n,k:e,f:!!t}:n:null);function m(n,e=null,t=null,r=0,s=null,i=n===Rt?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&Ny(e),ref:e&&yc(e),scopeId:cy,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Un};return a?(tf(c,t),i&128&&n.normalize(c)):t&&(c.shapeFlag|=$t(t)?8:16),za>0&&!o&&Bn&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&Bn.push(c),c}const jt=_E;function _E(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===BI)&&(n=bs),Uc(n)){const a=ao(n,e,!0);return t&&tf(a,t),za>0&&!i&&Bn&&(a.shapeFlag&6?Bn[Bn.indexOf(n)]=a:Bn.push(a)),a.patchFlag=-2,a}if(xE(n)&&(n=n.__vccOpts),e){e=yE(e);let{class:a,style:c}=e;a&&!$t(a)&&(e.class=cr(a)),Et(c)&&(Qh(c)&&!xe(c)&&(c=tn({},c)),e.style=Ba(c))}const o=$t(n)?1:ky(n)?128:SI(n)?64:Et(n)?4:De(n)?2:0;return m(n,e,t,r,s,o,i,!0)}function yE(n){return n?Qh(n)||wy(n)?tn({},n):n:null}function ao(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:c}=n,u=e?vE(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&Ny(u),ref:e&&e.ref?t&&i?xe(i)?i.concat(yc(e)):[i,yc(e)]:yc(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Rt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:c,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&ao(n.ssContent),ssFallback:n.ssFallback&&ao(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return c&&r&&Yh(d,c.clone(d)),d}function Tr(n=" ",e=0){return jt(bu,null,n,e)}function ss(n,e){const t=jt(_c,null,n);return t.staticCount=e,t}function Ae(n="",e=!1){return e?(W(),Vy(bs,null,n)):jt(bs,null,n)}function ir(n){return n==null||typeof n=="boolean"?jt(bs):xe(n)?jt(Rt,null,n.slice()):Uc(n)?os(n):jt(bu,null,String(n))}function os(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:ao(n)}function tf(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(xe(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),tf(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!wy(e)?e._ctx=Un:s===3&&Un&&(Un.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else De(e)?(e={default:e,_ctx:Un},t=32):(e=String(e),r&64?(t=16,e=[Tr(e)]):t=8);n.children=e,n.shapeFlag|=t}function vE(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=cr([e.class,r.class]));else if(s==="style")e.style=Ba([e.style,r.style]);else if(uu(s)){const i=e[s],o=r[s];o&&i!==o&&!(xe(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function nr(n,e,t,r=null){fr(n,e,7,[t,r])}const wE=_y();let bE=0;function IE(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||wE,i={uid:bE++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Wb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Iy(r,s),emitsOptions:Cy(r,s),emit:null,emitted:null,propsDefaults:dt,inheritAttrs:r.inheritAttrs,ctx:dt,data:dt,props:dt,attrs:dt,slots:dt,refs:dt,setupState:dt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=uE.bind(null,i),n.ce&&n.ce(i),i}let _n=null,Bc,sh;{const n=pu(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Bc=e("__VUE_INSTANCE_SETTERS__",t=>_n=t),sh=e("__VUE_SSR_SETTERS__",t=>Ga=t)}const fl=n=>{const e=_n;return Bc(n),n.scope.on(),()=>{n.scope.off(),Bc(e)}},cm=()=>{_n&&_n.scope.off(),Bc(null)};function Oy(n){return n.vnode.shapeFlag&4}let Ga=!1;function EE(n,e=!1,t=!1){e&&sh(e);const{props:r,children:s}=n.vnode,i=Oy(n);JI(n,r,i,e),eE(n,s,t||e);const o=i?TE(n,e):void 0;return e&&sh(!1),o}function TE(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,$I);const{setup:r}=t;if(r){Vr();const s=n.setupContext=r.length>1?PE(n):null,i=fl(n),o=hl(r,n,0,[n.props,s]),a=O_(o);if(Nr(),i(),(a||n.sp)&&!xa(n)&&dy(n),a){if(o.then(cm,cm),e)return o.then(c=>{um(n,c,e)}).catch(c=>{_u(c,n,0)});n.asyncDep=o}else um(n,o,e)}else My(n,e)}function um(n,e,t){De(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Et(e)&&(n.setupState=sy(e)),My(n,t)}let dm;function My(n,e,t){const r=n.type;if(!n.render){if(!e&&dm&&!r.render){const s=r.template||Xh(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:c}=r,u=tn(tn({isCustomElement:i,delimiters:a},o),c);r.render=dm(s,u)}}n.render=r.render||Qn}{const s=fl(n);Vr();try{qI(n)}finally{Nr(),s()}}}const AE={get(n,e){return gn(n,"get",""),n[e]}};function PE(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,AE),slots:n.slots,emit:n.emit,expose:e}}function Iu(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(sy(pI(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Ra)return Ra[t](n)},has(e,t){return t in e||t in Ra}})):n.proxy}function SE(n,e=!0){return De(n)?n.displayName||n.name:n.name||e&&n.__name}function xE(n){return De(n)&&"__vccOpts"in n}const cn=(n,e)=>vI(n,e,Ga);function Ly(n,e,t){const r=arguments.length;return r===2?Et(e)&&!xe(e)?Uc(e)?jt(n,null,[e]):jt(n,e):jt(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Uc(t)&&(t=[t]),jt(n,e,t))}const RE="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ih;const hm=typeof window<"u"&&window.trustedTypes;if(hm)try{ih=hm.createPolicy("vue",{createHTML:n=>n})}catch{}const Fy=ih?n=>ih.createHTML(n):n=>n,CE="http://www.w3.org/2000/svg",kE="http://www.w3.org/1998/Math/MathML",Er=typeof document<"u"?document:null,fm=Er&&Er.createElement("template"),DE={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?Er.createElementNS(CE,n):e==="mathml"?Er.createElementNS(kE,n):t?Er.createElement(n,{is:t}):Er.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>Er.createTextNode(n),createComment:n=>Er.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Er.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{fm.innerHTML=Fy(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=fm.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},VE=Symbol("_vtc");function NE(n,e,t){const r=n[VE];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const pm=Symbol("_vod"),OE=Symbol("_vsh"),ME=Symbol(""),LE=/(^|;)\s*display\s*:/;function FE(n,e,t){const r=n.style,s=$t(t);let i=!1;if(t&&!s){if(e)if($t(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&vc(r,a,"")}else for(const o in e)t[o]==null&&vc(r,o,"");for(const o in t)o==="display"&&(i=!0),vc(r,o,t[o])}else if(s){if(e!==t){const o=r[ME];o&&(t+=";"+o),r.cssText=t,i=LE.test(t)}}else e&&n.removeAttribute("style");pm in n&&(n[pm]=i?r.display:"",n[OE]&&(r.display="none"))}const mm=/\s*!important$/;function vc(n,e,t){if(xe(t))t.forEach(r=>vc(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=UE(n,e);mm.test(t)?n.setProperty(ks(r),t.replace(mm,""),"important"):n[r]=t}}const gm=["Webkit","Moz","ms"],Ed={};function UE(n,e){const t=Ed[e];if(t)return t;let r=qn(e);if(r!=="filter"&&r in n)return Ed[e]=r;r=fu(r);for(let s=0;s<gm.length;s++){const i=gm[s]+r;if(i in n)return Ed[e]=i}return e}const _m="http://www.w3.org/1999/xlink";function ym(n,e,t,r,s,i=Hb(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(_m,e.slice(6,e.length)):n.setAttributeNS(_m,e,t):t==null||i&&!F_(t)?n.removeAttribute(e):n.setAttribute(e,i?"":Cs(t)?String(t):t)}function vm(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?Fy(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,c=t==null?n.type==="checkbox"?"on":"":String(t);(a!==c||!("_value"in n))&&(n.value=c),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=F_(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function $i(n,e,t,r){n.addEventListener(e,t,r)}function BE(n,e,t,r){n.removeEventListener(e,t,r)}const wm=Symbol("_vei");function jE(n,e,t,r,s=null){const i=n[wm]||(n[wm]={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=$E(e);if(r){const u=i[e]=GE(r,s);$i(n,a,u,c)}else o&&(BE(n,a,o,c),i[e]=void 0)}}const bm=/(?:Once|Passive|Capture)$/;function $E(n){let e;if(bm.test(n)){e={};let r;for(;r=n.match(bm);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ks(n.slice(2)),e]}let Td=0;const qE=Promise.resolve(),zE=()=>Td||(qE.then(()=>Td=0),Td=Date.now());function GE(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;fr(KE(r,t.value),e,5,[r])};return t.value=n,t.attached=zE(),t}function KE(n,e){if(xe(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Im=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,HE=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?NE(n,r,o):e==="style"?FE(n,t,r):uu(e)?Bh(e)||jE(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):WE(n,e,r,o))?(vm(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ym(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!$t(r))?vm(n,qn(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),ym(n,e,r,o))};function WE(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Im(e)&&De(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Im(e)&&$t(t)?!1:e in n}const Em=n=>{const e=n.props["onUpdate:modelValue"]||!1;return xe(e)?t=>mc(e,t):e};function QE(n){n.target.composing=!0}function Tm(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ad=Symbol("_assign"),At={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[Ad]=Em(s);const i=r||s.props&&s.props.type==="number";$i(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=Qd(a)),n[Ad](a)}),t&&$i(n,"change",()=>{n.value=n.value.trim()}),e||($i(n,"compositionstart",QE),$i(n,"compositionend",Tm),$i(n,"change",Tm))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[Ad]=Em(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?Qd(n.value):n.value,c=e??"";a!==c&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===c)||(n.value=c))}},JE=["ctrl","shift","alt","meta"],YE={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>JE.some(t=>n[`${t}Key`]&&!e.includes(t))},Wn=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=YE[e[o]];if(a&&a(s,e))return}return n(s,...i)})},XE={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Tn=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=ks(s.key);if(e.some(o=>o===i||XE[o]===i))return n(s)})},ZE=tn({patchProp:HE},DE);let Am;function eT(){return Am||(Am=nE(ZE))}const tT=(...n)=>{const e=eT().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=rT(r);if(!s)return;const i=e._component;!De(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,nT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function nT(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function rT(n){return $t(n)?document.querySelector(n):n}const sT={__name:"App",setup(n){return(e,t)=>{const r=UI("router-view");return W(),Vy(r)}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const qi=typeof document<"u";function Uy(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function iT(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&Uy(n.default)}const tt=Object.assign;function Pd(n,e){const t={};for(const r in e){const s=e[r];t[r]=Zn(s)?s.map(n):n(s)}return t}const ka=()=>{},Zn=Array.isArray,By=/#/g,oT=/&/g,aT=/\//g,lT=/=/g,cT=/\?/g,jy=/\+/g,uT=/%5B/g,dT=/%5D/g,$y=/%5E/g,hT=/%60/g,qy=/%7B/g,fT=/%7C/g,zy=/%7D/g,pT=/%20/g;function nf(n){return encodeURI(""+n).replace(fT,"|").replace(uT,"[").replace(dT,"]")}function mT(n){return nf(n).replace(qy,"{").replace(zy,"}").replace($y,"^")}function oh(n){return nf(n).replace(jy,"%2B").replace(pT,"+").replace(By,"%23").replace(oT,"%26").replace(hT,"`").replace(qy,"{").replace(zy,"}").replace($y,"^")}function gT(n){return oh(n).replace(lT,"%3D")}function _T(n){return nf(n).replace(By,"%23").replace(cT,"%3F")}function yT(n){return n==null?"":_T(n).replace(aT,"%2F")}function Ka(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const vT=/\/$/,wT=n=>n.replace(vT,"");function Sd(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(r=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=TT(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Ka(o)}}function bT(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Pm(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function IT(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&lo(e.matched[r],t.matched[s])&&Gy(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function lo(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function Gy(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!ET(n[t],e[t]))return!1;return!0}function ET(n,e){return Zn(n)?Sm(n,e):Zn(e)?Sm(e,n):n===e}function Sm(n,e){return Zn(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function TT(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const es={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ha;(function(n){n.pop="pop",n.push="push"})(Ha||(Ha={}));var Da;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Da||(Da={}));function AT(n){if(!n)if(qi){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),wT(n)}const PT=/^[^#]+#/;function ST(n,e){return n.replace(PT,"#")+e}function xT(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Eu=()=>({left:window.scrollX,top:window.scrollY});function RT(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=xT(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function xm(n,e){return(history.state?history.state.position-e:-1)+n}const ah=new Map;function CT(n,e){ah.set(n,e)}function kT(n){const e=ah.get(n);return ah.delete(n),e}let DT=()=>location.protocol+"//"+location.host;function Ky(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,c=s.slice(a);return c[0]!=="/"&&(c="/"+c),Pm(c,"")}return Pm(t,n)+r+s}function VT(n,e,t,r){let s=[],i=[],o=null;const a=({state:g})=>{const _=Ky(n,location),C=t.value,x=e.value;let k=0;if(g){if(t.value=_,e.value=g,o&&o===C){o=null;return}k=x?g.position-x.position:0}else r(_);s.forEach(N=>{N(t.value,C,{delta:k,type:Ha.pop,direction:k?k>0?Da.forward:Da.back:Da.unknown})})};function c(){o=t.value}function u(g){s.push(g);const _=()=>{const C=s.indexOf(g);C>-1&&s.splice(C,1)};return i.push(_),_}function d(){const{history:g}=window;g.state&&g.replaceState(tt({},g.state,{scroll:Eu()}),"")}function f(){for(const g of i)g();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:c,listen:u,destroy:f}}function Rm(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?Eu():null}}function NT(n){const{history:e,location:t}=window,r={value:Ky(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,d){const f=n.indexOf("#"),g=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+c:DT()+n+c;try{e[d?"replaceState":"pushState"](u,"",g),s.value=u}catch(_){console.error(_),t[d?"replace":"assign"](g)}}function o(c,u){const d=tt({},e.state,Rm(s.value.back,c,s.value.forward,!0),u,{position:s.value.position});i(c,d,!0),r.value=c}function a(c,u){const d=tt({},s.value,e.state,{forward:c,scroll:Eu()});i(d.current,d,!0);const f=tt({},Rm(r.value,c,null),{position:d.position+1},u);i(c,f,!1),r.value=c}return{location:r,state:s,push:a,replace:o}}function OT(n){n=AT(n);const e=NT(n),t=VT(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=tt({location:"",base:n,go:r,createHref:ST.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function MT(n){return typeof n=="string"||n&&typeof n=="object"}function Hy(n){return typeof n=="string"||typeof n=="symbol"}const Wy=Symbol("");var Cm;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Cm||(Cm={}));function co(n,e){return tt(new Error,{type:n,[Wy]:!0},e)}function Ir(n,e){return n instanceof Error&&Wy in n&&(e==null||!!(n.type&e))}const km="[^/]+?",LT={sensitive:!1,strict:!1,start:!0,end:!0},FT=/[.+*?^${}()[\]/\\]/g;function UT(n,e){const t=tt({},LT,e),r=[];let s=t.start?"^":"";const i=[];for(const u of n){const d=u.length?[]:[90];t.strict&&!u.length&&(s+="/");for(let f=0;f<u.length;f++){const g=u[f];let _=40+(t.sensitive?.25:0);if(g.type===0)f||(s+="/"),s+=g.value.replace(FT,"\\$&"),_+=40;else if(g.type===1){const{value:C,repeatable:x,optional:k,regexp:N}=g;i.push({name:C,repeatable:x,optional:k});const B=N||km;if(B!==km){_+=10;try{new RegExp(`(${B})`)}catch(L){throw new Error(`Invalid custom RegExp for param "${C}" (${B}): `+L.message)}}let F=x?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;f||(F=k&&u.length<2?`(?:/${F})`:"/"+F),k&&(F+="?"),s+=F,_+=20,k&&(_+=-8),x&&(_+=-20),B===".*"&&(_+=-50)}d.push(_)}r.push(d)}if(t.strict&&t.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(u){const d=u.match(o),f={};if(!d)return null;for(let g=1;g<d.length;g++){const _=d[g]||"",C=i[g-1];f[C.name]=_&&C.repeatable?_.split("/"):_}return f}function c(u){let d="",f=!1;for(const g of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const _ of g)if(_.type===0)d+=_.value;else if(_.type===1){const{value:C,repeatable:x,optional:k}=_,N=C in u?u[C]:"";if(Zn(N)&&!x)throw new Error(`Provided param "${C}" is an array but it is not repeatable (* or + modifiers)`);const B=Zn(N)?N.join("/"):N;if(!B)if(k)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${C}"`);d+=B}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:c}}function BT(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Qy(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=BT(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(Dm(r))return 1;if(Dm(s))return-1}return s.length-r.length}function Dm(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const jT={type:0,value:""},$T=/[a-zA-Z0-9_]/;function qT(n){if(!n)return[[]];if(n==="/")return[[jT]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(_){throw new Error(`ERR (${t})/"${u}": ${_}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,c,u="",d="";function f(){u&&(t===0?i.push({type:0,value:u}):t===1||t===2||t===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:d,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function g(){u+=c}for(;a<n.length;){if(c=n[a++],c==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:c==="/"?(u&&f(),o()):c===":"?(f(),t=1):g();break;case 4:g(),t=r;break;case 1:c==="("?t=2:$T.test(c)?g():(f(),t=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+c:t=3:d+=c;break;case 3:f(),t=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),s}function zT(n,e,t){const r=UT(qT(n.path),t),s=tt(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function GT(n,e){const t=[],r=new Map;e=Mm({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,g,_){const C=!_,x=Nm(f);x.aliasOf=_&&_.record;const k=Mm(e,f),N=[x];if("alias"in f){const L=typeof f.alias=="string"?[f.alias]:f.alias;for(const $ of L)N.push(Nm(tt({},x,{components:_?_.record.components:x.components,path:$,aliasOf:_?_.record:x})))}let B,F;for(const L of N){const{path:$}=L;if(g&&$[0]!=="/"){const ee=g.record.path,S=ee[ee.length-1]==="/"?"":"/";L.path=g.record.path+($&&S+$)}if(B=zT(L,g,k),_?_.alias.push(B):(F=F||B,F!==B&&F.alias.push(B),C&&f.name&&!Om(B)&&o(f.name)),Jy(B)&&c(B),x.children){const ee=x.children;for(let S=0;S<ee.length;S++)i(ee[S],B,_&&_.children[S])}_=_||B}return F?()=>{o(F)}:ka}function o(f){if(Hy(f)){const g=r.get(f);g&&(r.delete(f),t.splice(t.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=t.indexOf(f);g>-1&&(t.splice(g,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function c(f){const g=WT(f,t);t.splice(g,0,f),f.record.name&&!Om(f)&&r.set(f.record.name,f)}function u(f,g){let _,C={},x,k;if("name"in f&&f.name){if(_=r.get(f.name),!_)throw co(1,{location:f});k=_.record.name,C=tt(Vm(g.params,_.keys.filter(F=>!F.optional).concat(_.parent?_.parent.keys.filter(F=>F.optional):[]).map(F=>F.name)),f.params&&Vm(f.params,_.keys.map(F=>F.name))),x=_.stringify(C)}else if(f.path!=null)x=f.path,_=t.find(F=>F.re.test(x)),_&&(C=_.parse(x),k=_.record.name);else{if(_=g.name?r.get(g.name):t.find(F=>F.re.test(g.path)),!_)throw co(1,{location:f,currentLocation:g});k=_.record.name,C=tt({},g.params,f.params),x=_.stringify(C)}const N=[];let B=_;for(;B;)N.unshift(B.record),B=B.parent;return{name:k,path:x,params:C,matched:N,meta:HT(N)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function Vm(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function Nm(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:KT(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function KT(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function Om(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function HT(n){return n.reduce((e,t)=>tt(e,t.meta),{})}function Mm(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function WT(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;Qy(n,e[i])<0?r=i:t=i+1}const s=QT(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function QT(n){let e=n;for(;e=e.parent;)if(Jy(e)&&Qy(n,e)===0)return e}function Jy({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function JT(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(jy," "),o=i.indexOf("="),a=Ka(o<0?i:i.slice(0,o)),c=o<0?null:Ka(i.slice(o+1));if(a in e){let u=e[a];Zn(u)||(u=e[a]=[u]),u.push(c)}else e[a]=c}return e}function Lm(n){let e="";for(let t in n){const r=n[t];if(t=gT(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Zn(r)?r.map(i=>i&&oh(i)):[r&&oh(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function YT(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Zn(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const XT=Symbol(""),Fm=Symbol(""),Tu=Symbol(""),rf=Symbol(""),lh=Symbol("");function la(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function as(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,c)=>{const u=g=>{g===!1?c(co(4,{from:t,to:e})):g instanceof Error?c(g):MT(g)?c(co(2,{from:e,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),a())},d=i(()=>n.call(r&&r.instances[s],e,t,u));let f=Promise.resolve(d);n.length<3&&(f=f.then(u)),f.catch(g=>c(g))})}function xd(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let c=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(Uy(c)){const d=(c.__vccOpts||c)[e];d&&i.push(as(d,t,r,o,a,s))}else{let u=c();i.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=iT(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const _=(f.__vccOpts||f)[e];return _&&as(_,t,r,o,a,s)()}))}}return i}function Um(n){const e=Yn(Tu),t=Yn(rf),r=cn(()=>{const c=Yi(n.to);return e.resolve(c)}),s=cn(()=>{const{matched:c}=r.value,{length:u}=c,d=c[u-1],f=t.matched;if(!d||!f.length)return-1;const g=f.findIndex(lo.bind(null,d));if(g>-1)return g;const _=Bm(c[u-2]);return u>1&&Bm(d)===_&&f[f.length-1].path!==_?f.findIndex(lo.bind(null,c[u-2])):g}),i=cn(()=>s.value>-1&&rA(t.params,r.value.params)),o=cn(()=>s.value>-1&&s.value===t.matched.length-1&&Gy(t.params,r.value.params));function a(c={}){if(nA(c)){const u=e[Yi(n.replace)?"replace":"push"](Yi(n.to)).catch(ka);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:cn(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function ZT(n){return n.length===1?n[0]:n}const eA=uy({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Um,setup(n,{slots:e}){const t=gu(Um(n)),{options:r}=Yn(Tu),s=cn(()=>({[jm(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[jm(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&ZT(e.default(t));return n.custom?i:Ly("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),tA=eA;function nA(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function rA(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Zn(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Bm(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const jm=(n,e,t)=>n??e??t,sA=uy({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Yn(lh),s=cn(()=>n.route||r.value),i=Yn(Fm,0),o=cn(()=>{let u=Yi(i);const{matched:d}=s.value;let f;for(;(f=d[u])&&!f.components;)u++;return u}),a=cn(()=>s.value.matched[o.value]);gc(Fm,cn(()=>o.value+1)),gc(XT,a),gc(lh,s);const c=K();return Xn(()=>[c.value,a.value,n.name],([u,d,f],[g,_,C])=>{d&&(d.instances[f]=u,_&&_!==d&&u&&u===g&&(d.leaveGuards.size||(d.leaveGuards=_.leaveGuards),d.updateGuards.size||(d.updateGuards=_.updateGuards))),u&&d&&(!_||!lo(d,_)||!g)&&(d.enterCallbacks[f]||[]).forEach(x=>x(u))},{flush:"post"}),()=>{const u=s.value,d=n.name,f=a.value,g=f&&f.components[d];if(!g)return $m(t.default,{Component:g,route:u});const _=f.props[d],C=_?_===!0?u.params:typeof _=="function"?_(u):_:null,k=Ly(g,tt({},C,e,{onVnodeUnmounted:N=>{N.component.isUnmounted&&(f.instances[d]=null)},ref:c}));return $m(t.default,{Component:k,route:u})||k}}});function $m(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const iA=sA;function oA(n){const e=GT(n.routes,n),t=n.parseQuery||JT,r=n.stringifyQuery||Lm,s=n.history,i=la(),o=la(),a=la(),c=mI(es);let u=es;qi&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Pd.bind(null,q=>""+q),f=Pd.bind(null,yT),g=Pd.bind(null,Ka);function _(q,ce){let te,fe;return Hy(q)?(te=e.getRecordMatcher(q),fe=ce):fe=q,e.addRoute(fe,te)}function C(q){const ce=e.getRecordMatcher(q);ce&&e.removeRoute(ce)}function x(){return e.getRoutes().map(q=>q.record)}function k(q){return!!e.getRecordMatcher(q)}function N(q,ce){if(ce=tt({},ce||c.value),typeof q=="string"){const A=Sd(t,q,ce.path),V=e.resolve({path:A.path},ce),G=s.createHref(A.fullPath);return tt(A,V,{params:g(V.params),hash:Ka(A.hash),redirectedFrom:void 0,href:G})}let te;if(q.path!=null)te=tt({},q,{path:Sd(t,q.path,ce.path).path});else{const A=tt({},q.params);for(const V in A)A[V]==null&&delete A[V];te=tt({},q,{params:f(A)}),ce.params=f(ce.params)}const fe=e.resolve(te,ce),Ue=q.hash||"";fe.params=d(g(fe.params));const Ze=bT(r,tt({},q,{hash:mT(Ue),path:fe.path})),b=s.createHref(Ze);return tt({fullPath:Ze,hash:Ue,query:r===Lm?YT(q.query):q.query||{}},fe,{redirectedFrom:void 0,href:b})}function B(q){return typeof q=="string"?Sd(t,q,c.value.path):tt({},q)}function F(q,ce){if(u!==q)return co(8,{from:ce,to:q})}function L(q){return S(q)}function $(q){return L(tt(B(q),{replace:!0}))}function ee(q){const ce=q.matched[q.matched.length-1];if(ce&&ce.redirect){const{redirect:te}=ce;let fe=typeof te=="function"?te(q):te;return typeof fe=="string"&&(fe=fe.includes("?")||fe.includes("#")?fe=B(fe):{path:fe},fe.params={}),tt({query:q.query,hash:q.hash,params:fe.path!=null?{}:q.params},fe)}}function S(q,ce){const te=u=N(q),fe=c.value,Ue=q.state,Ze=q.force,b=q.replace===!0,A=ee(te);if(A)return S(tt(B(A),{state:typeof A=="object"?tt({},Ue,A.state):Ue,force:Ze,replace:b}),ce||te);const V=te;V.redirectedFrom=ce;let G;return!Ze&&IT(r,fe,te)&&(G=co(16,{to:V,from:fe}),zt(fe,fe,!0,!1)),(G?Promise.resolve(G):R(V,fe)).catch(z=>Ir(z)?Ir(z,2)?z:nn(z):Ce(z,V,fe)).then(z=>{if(z){if(Ir(z,2))return S(tt({replace:b},B(z.to),{state:typeof z.to=="object"?tt({},Ue,z.to.state):Ue,force:Ze}),ce||V)}else z=T(V,fe,!0,b,Ue);return w(V,fe,z),z})}function I(q,ce){const te=F(q,ce);return te?Promise.reject(te):Promise.resolve()}function P(q){const ce=bn.values().next().value;return ce&&typeof ce.runWithContext=="function"?ce.runWithContext(q):q()}function R(q,ce){let te;const[fe,Ue,Ze]=aA(q,ce);te=xd(fe.reverse(),"beforeRouteLeave",q,ce);for(const A of fe)A.leaveGuards.forEach(V=>{te.push(as(V,q,ce))});const b=I.bind(null,q,ce);return te.push(b),Je(te).then(()=>{te=[];for(const A of i.list())te.push(as(A,q,ce));return te.push(b),Je(te)}).then(()=>{te=xd(Ue,"beforeRouteUpdate",q,ce);for(const A of Ue)A.updateGuards.forEach(V=>{te.push(as(V,q,ce))});return te.push(b),Je(te)}).then(()=>{te=[];for(const A of Ze)if(A.beforeEnter)if(Zn(A.beforeEnter))for(const V of A.beforeEnter)te.push(as(V,q,ce));else te.push(as(A.beforeEnter,q,ce));return te.push(b),Je(te)}).then(()=>(q.matched.forEach(A=>A.enterCallbacks={}),te=xd(Ze,"beforeRouteEnter",q,ce,P),te.push(b),Je(te))).then(()=>{te=[];for(const A of o.list())te.push(as(A,q,ce));return te.push(b),Je(te)}).catch(A=>Ir(A,8)?A:Promise.reject(A))}function w(q,ce,te){a.list().forEach(fe=>P(()=>fe(q,ce,te)))}function T(q,ce,te,fe,Ue){const Ze=F(q,ce);if(Ze)return Ze;const b=ce===es,A=qi?history.state:{};te&&(fe||b?s.replace(q.fullPath,tt({scroll:b&&A&&A.scroll},Ue)):s.push(q.fullPath,Ue)),c.value=q,zt(q,ce,te,b),nn()}let E;function Re(){E||(E=s.listen((q,ce,te)=>{if(!Ft.listening)return;const fe=N(q),Ue=ee(fe);if(Ue){S(tt(Ue,{replace:!0,force:!0}),fe).catch(ka);return}u=fe;const Ze=c.value;qi&&CT(xm(Ze.fullPath,te.delta),Eu()),R(fe,Ze).catch(b=>Ir(b,12)?b:Ir(b,2)?(S(tt(B(b.to),{force:!0}),fe).then(A=>{Ir(A,20)&&!te.delta&&te.type===Ha.pop&&s.go(-1,!1)}).catch(ka),Promise.reject()):(te.delta&&s.go(-te.delta,!1),Ce(b,fe,Ze))).then(b=>{b=b||T(fe,Ze,!1),b&&(te.delta&&!Ir(b,8)?s.go(-te.delta,!1):te.type===Ha.pop&&Ir(b,20)&&s.go(-1,!1)),w(fe,Ze,b)}).catch(ka)}))}let Ye=la(),je=la(),Oe;function Ce(q,ce,te){nn(q);const fe=je.list();return fe.length?fe.forEach(Ue=>Ue(q,ce,te)):console.error(q),Promise.reject(q)}function qt(){return Oe&&c.value!==es?Promise.resolve():new Promise((q,ce)=>{Ye.add([q,ce])})}function nn(q){return Oe||(Oe=!q,Re(),Ye.list().forEach(([ce,te])=>q?te(q):ce()),Ye.reset()),q}function zt(q,ce,te,fe){const{scrollBehavior:Ue}=n;if(!qi||!Ue)return Promise.resolve();const Ze=!te&&kT(xm(q.fullPath,0))||(fe||!te)&&history.state&&history.state.scroll||null;return ri().then(()=>Ue(q,ce,Ze)).then(b=>b&&RT(b)).catch(b=>Ce(b,q,ce))}const Qe=q=>s.go(q);let Xe;const bn=new Set,Ft={currentRoute:c,listening:!0,addRoute:_,removeRoute:C,clearRoutes:e.clearRoutes,hasRoute:k,getRoutes:x,resolve:N,options:n,push:L,replace:$,go:Qe,back:()=>Qe(-1),forward:()=>Qe(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:je.add,isReady:qt,install(q){const ce=this;q.component("RouterLink",tA),q.component("RouterView",iA),q.config.globalProperties.$router=ce,Object.defineProperty(q.config.globalProperties,"$route",{enumerable:!0,get:()=>Yi(c)}),qi&&!Xe&&c.value===es&&(Xe=!0,L(s.location).catch(Ue=>{}));const te={};for(const Ue in es)Object.defineProperty(te,Ue,{get:()=>c.value[Ue],enumerable:!0});q.provide(Tu,ce),q.provide(rf,ty(te)),q.provide(lh,c);const fe=q.unmount;bn.add(q),q.unmount=function(){bn.delete(q),bn.size<1&&(u=es,E&&E(),E=null,c.value=es,Xe=!1,Oe=!1),fe()}}};function Je(q){return q.reduce((ce,te)=>ce.then(()=>P(te)),Promise.resolve())}return Ft}function aA(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(u=>lo(u,a))?r.push(a):t.push(a));const c=n.matched[o];c&&(e.matched.find(u=>lo(u,c))||s.push(c))}return[t,r,s]}function sf(){return Yn(Tu)}function lA(n){return Yn(rf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},cA=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Xy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,c=s+2<n.length,u=c?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let g=(a&15)<<2|u>>6,_=u&63;c||(_=64,o||(g=64)),r.push(t[d],t[f],t[g],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Yy(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||u==null||f==null)throw new uA;const g=i<<2|a>>4;if(r.push(g),u!==64){const _=a<<4&240|u>>2;if(r.push(_),f!==64){const C=u<<6&192|f;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class uA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dA=function(n){const e=Yy(n);return Xy.encodeByteArray(e,!0)},jc=function(n){return dA(n).replace(/\./g,"")},Zy=function(n){try{return Xy.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=()=>hA().__FIREBASE_DEFAULTS__,pA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Zy(n[1]);return e&&JSON.parse(e)},Au=()=>{try{return fA()||pA()||mA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ev=n=>{var e,t;return(t=(e=Au())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},gA=n=>{const e=ev(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},tv=()=>{var n;return(n=Au())===null||n===void 0?void 0:n.config},nv=n=>{var e;return(e=Au())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[jc(JSON.stringify(t)),jc(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function wA(){var n;const e=(n=Au())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function EA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function TA(){const n=Ht();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function rv(){return!wA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sv(){try{return typeof indexedDB=="object"}catch{return!1}}function AA(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA="FirebaseError";class $r extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=PA,Object.setPrototypeOf(this,$r.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pl.prototype.create)}}class pl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?SA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new $r(s,a,r)}}function SA(n,e){return n.replace(xA,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const xA=/\{\$([^}]+)}/g;function RA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Is(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(qm(i)&&qm(o)){if(!Is(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function qm(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _a(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ya(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function CA(n,e){const t=new kA(n,e);return t.subscribe.bind(t)}class kA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");DA(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Rd),s.error===void 0&&(s.error=Rd),s.complete===void 0&&(s.complete=Rd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n){return n&&n._delegate?n._delegate:n}class si{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new _A;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OA(e))try{this.getOrInitializeService({instanceIdentifier:Gs})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Gs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gs){return this.instances.has(e)}getOptions(e=Gs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:NA(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gs){return this.component?this.component.multipleInstances?e:Gs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NA(n){return n===Gs?void 0:n}function OA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ze||(ze={}));const LA={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},FA=ze.INFO,UA={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},BA=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=UA[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class of{constructor(e){this.name=e,this._logLevel=FA,this._logHandler=BA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const jA=(n,e)=>e.some(t=>n instanceof t);let zm,Gm;function $A(){return zm||(zm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qA(){return Gm||(Gm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iv=new WeakMap,ch=new WeakMap,ov=new WeakMap,Cd=new WeakMap,af=new WeakMap;function zA(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(_s(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&iv.set(t,n)}).catch(()=>{}),af.set(e,n),e}function GA(n){if(ch.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});ch.set(n,e)}let uh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ch.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ov.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _s(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KA(n){uh=n(uh)}function HA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(kd(this),e,...t);return ov.set(r,e.sort?e.sort():[e]),_s(r)}:qA().includes(n)?function(...e){return n.apply(kd(this),e),_s(iv.get(this))}:function(...e){return _s(n.apply(kd(this),e))}}function WA(n){return typeof n=="function"?HA(n):(n instanceof IDBTransaction&&GA(n),jA(n,$A())?new Proxy(n,uh):n)}function _s(n){if(n instanceof IDBRequest)return zA(n);if(Cd.has(n))return Cd.get(n);const e=WA(n);return e!==n&&(Cd.set(n,e),af.set(e,n)),e}const kd=n=>af.get(n);function QA(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=_s(o);return r&&o.addEventListener("upgradeneeded",c=>{r(_s(o.result),c.oldVersion,c.newVersion,_s(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const JA=["get","getKey","getAll","getAllKeys","count"],YA=["put","add","delete","clear"],Dd=new Map;function Km(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Dd.get(e))return Dd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=YA.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||JA.includes(t)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),s&&c.done]))[0]};return Dd.set(e,i),i}KA(n=>({...n,get:(e,t,r)=>Km(e,t)||n.get(e,t,r),has:(e,t)=>!!Km(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZA(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ZA(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dh="@firebase/app",Hm="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new of("@firebase/app"),eP="@firebase/app-compat",tP="@firebase/analytics-compat",nP="@firebase/analytics",rP="@firebase/app-check-compat",sP="@firebase/app-check",iP="@firebase/auth",oP="@firebase/auth-compat",aP="@firebase/database",lP="@firebase/data-connect",cP="@firebase/database-compat",uP="@firebase/functions",dP="@firebase/functions-compat",hP="@firebase/installations",fP="@firebase/installations-compat",pP="@firebase/messaging",mP="@firebase/messaging-compat",gP="@firebase/performance",_P="@firebase/performance-compat",yP="@firebase/remote-config",vP="@firebase/remote-config-compat",wP="@firebase/storage",bP="@firebase/storage-compat",IP="@firebase/firestore",EP="@firebase/vertexai-preview",TP="@firebase/firestore-compat",AP="firebase",PP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c="[DEFAULT]",SP={[dh]:"fire-core",[eP]:"fire-core-compat",[nP]:"fire-analytics",[tP]:"fire-analytics-compat",[sP]:"fire-app-check",[rP]:"fire-app-check-compat",[iP]:"fire-auth",[oP]:"fire-auth-compat",[aP]:"fire-rtdb",[lP]:"fire-data-connect",[cP]:"fire-rtdb-compat",[uP]:"fire-fn",[dP]:"fire-fn-compat",[hP]:"fire-iid",[fP]:"fire-iid-compat",[pP]:"fire-fcm",[mP]:"fire-fcm-compat",[gP]:"fire-perf",[_P]:"fire-perf-compat",[yP]:"fire-rc",[vP]:"fire-rc-compat",[wP]:"fire-gcs",[bP]:"fire-gcs-compat",[IP]:"fire-fst",[TP]:"fire-fst-compat",[EP]:"fire-vertex","fire-js":"fire-js",[AP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc=new Map,xP=new Map,hh=new Map;function Wm(n,e){try{n.container.addComponent(e)}catch(t){Or.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function uo(n){const e=n.name;if(hh.has(e))return Or.debug(`There were multiple attempts to register component ${e}.`),!1;hh.set(e,n);for(const t of qc.values())Wm(t,n);for(const t of xP.values())Wm(t,n);return!0}function ml(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function RP(n,e,t=$c){ml(n,e).clearInstance(t)}function Ot(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ys=new pl("app","Firebase",CP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new si("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ys.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=PP;function av(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:$c,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw ys.create("bad-app-name",{appName:String(s)});if(t||(t=tv()),!t)throw ys.create("no-options");const i=qc.get(s);if(i){if(Is(t,i.options)&&Is(r,i.config))return i;throw ys.create("duplicate-app",{appName:s})}const o=new MA(s);for(const c of hh.values())o.addComponent(c);const a=new kP(t,r,o);return qc.set(s,a),a}function lv(n=$c){const e=qc.get(n);if(!e&&n===$c&&tv())return av();if(!e)throw ys.create("no-app",{appName:n});return e}function vs(n,e,t){var r;let s=(r=SP[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Or.warn(a.join(" "));return}uo(new si(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP="firebase-heartbeat-database",VP=1,Wa="firebase-heartbeat-store";let Vd=null;function cv(){return Vd||(Vd=QA(DP,VP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Wa)}catch(t){console.warn(t)}}}}).catch(n=>{throw ys.create("idb-open",{originalErrorMessage:n.message})})),Vd}async function NP(n){try{const t=(await cv()).transaction(Wa),r=await t.objectStore(Wa).get(uv(n));return await t.done,r}catch(e){if(e instanceof $r)Or.warn(e.message);else{const t=ys.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Or.warn(t.message)}}}async function Qm(n,e){try{const r=(await cv()).transaction(Wa,"readwrite");await r.objectStore(Wa).put(e,uv(n)),await r.done}catch(t){if(t instanceof $r)Or.warn(t.message);else{const r=ys.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Or.warn(r.message)}}}function uv(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP=1024,MP=30*24*60*60*1e3;class LP{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new UP(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Jm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=MP}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Jm(),{heartbeatsToSend:r,unsentEntries:s}=FP(this._heartbeatsCache.heartbeats),i=jc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Or.warn(t),""}}}function Jm(){return new Date().toISOString().substring(0,10)}function FP(n,e=OP){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ym(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Ym(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class UP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sv()?AA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await NP(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Qm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Qm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ym(n){return jc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BP(n){uo(new si("platform-logger",e=>new XA(e),"PRIVATE")),uo(new si("heartbeat",e=>new LP(e),"PRIVATE")),vs(dh,Hm,n),vs(dh,Hm,"esm2017"),vs("fire-js","")}BP("");var jP="firebase",$P="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vs(jP,$P,"app");var Xm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ei,dv;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,I){function P(){}P.prototype=I.prototype,S.D=I.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(R,w,T){for(var E=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)E[Re-2]=arguments[Re];return I.prototype[w].apply(R,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,I,P){P||(P=0);var R=Array(16);if(typeof I=="string")for(var w=0;16>w;++w)R[w]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(w=0;16>w;++w)R[w]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=S.g[0],P=S.g[1],w=S.g[2];var T=S.g[3],E=I+(T^P&(w^T))+R[0]+3614090360&4294967295;I=P+(E<<7&4294967295|E>>>25),E=T+(w^I&(P^w))+R[1]+3905402710&4294967295,T=I+(E<<12&4294967295|E>>>20),E=w+(P^T&(I^P))+R[2]+606105819&4294967295,w=T+(E<<17&4294967295|E>>>15),E=P+(I^w&(T^I))+R[3]+3250441966&4294967295,P=w+(E<<22&4294967295|E>>>10),E=I+(T^P&(w^T))+R[4]+4118548399&4294967295,I=P+(E<<7&4294967295|E>>>25),E=T+(w^I&(P^w))+R[5]+1200080426&4294967295,T=I+(E<<12&4294967295|E>>>20),E=w+(P^T&(I^P))+R[6]+2821735955&4294967295,w=T+(E<<17&4294967295|E>>>15),E=P+(I^w&(T^I))+R[7]+4249261313&4294967295,P=w+(E<<22&4294967295|E>>>10),E=I+(T^P&(w^T))+R[8]+1770035416&4294967295,I=P+(E<<7&4294967295|E>>>25),E=T+(w^I&(P^w))+R[9]+2336552879&4294967295,T=I+(E<<12&4294967295|E>>>20),E=w+(P^T&(I^P))+R[10]+4294925233&4294967295,w=T+(E<<17&4294967295|E>>>15),E=P+(I^w&(T^I))+R[11]+2304563134&4294967295,P=w+(E<<22&4294967295|E>>>10),E=I+(T^P&(w^T))+R[12]+1804603682&4294967295,I=P+(E<<7&4294967295|E>>>25),E=T+(w^I&(P^w))+R[13]+4254626195&4294967295,T=I+(E<<12&4294967295|E>>>20),E=w+(P^T&(I^P))+R[14]+2792965006&4294967295,w=T+(E<<17&4294967295|E>>>15),E=P+(I^w&(T^I))+R[15]+1236535329&4294967295,P=w+(E<<22&4294967295|E>>>10),E=I+(w^T&(P^w))+R[1]+4129170786&4294967295,I=P+(E<<5&4294967295|E>>>27),E=T+(P^w&(I^P))+R[6]+3225465664&4294967295,T=I+(E<<9&4294967295|E>>>23),E=w+(I^P&(T^I))+R[11]+643717713&4294967295,w=T+(E<<14&4294967295|E>>>18),E=P+(T^I&(w^T))+R[0]+3921069994&4294967295,P=w+(E<<20&4294967295|E>>>12),E=I+(w^T&(P^w))+R[5]+3593408605&4294967295,I=P+(E<<5&4294967295|E>>>27),E=T+(P^w&(I^P))+R[10]+38016083&4294967295,T=I+(E<<9&4294967295|E>>>23),E=w+(I^P&(T^I))+R[15]+3634488961&4294967295,w=T+(E<<14&4294967295|E>>>18),E=P+(T^I&(w^T))+R[4]+3889429448&4294967295,P=w+(E<<20&4294967295|E>>>12),E=I+(w^T&(P^w))+R[9]+568446438&4294967295,I=P+(E<<5&4294967295|E>>>27),E=T+(P^w&(I^P))+R[14]+3275163606&4294967295,T=I+(E<<9&4294967295|E>>>23),E=w+(I^P&(T^I))+R[3]+4107603335&4294967295,w=T+(E<<14&4294967295|E>>>18),E=P+(T^I&(w^T))+R[8]+1163531501&4294967295,P=w+(E<<20&4294967295|E>>>12),E=I+(w^T&(P^w))+R[13]+2850285829&4294967295,I=P+(E<<5&4294967295|E>>>27),E=T+(P^w&(I^P))+R[2]+4243563512&4294967295,T=I+(E<<9&4294967295|E>>>23),E=w+(I^P&(T^I))+R[7]+1735328473&4294967295,w=T+(E<<14&4294967295|E>>>18),E=P+(T^I&(w^T))+R[12]+2368359562&4294967295,P=w+(E<<20&4294967295|E>>>12),E=I+(P^w^T)+R[5]+4294588738&4294967295,I=P+(E<<4&4294967295|E>>>28),E=T+(I^P^w)+R[8]+2272392833&4294967295,T=I+(E<<11&4294967295|E>>>21),E=w+(T^I^P)+R[11]+1839030562&4294967295,w=T+(E<<16&4294967295|E>>>16),E=P+(w^T^I)+R[14]+4259657740&4294967295,P=w+(E<<23&4294967295|E>>>9),E=I+(P^w^T)+R[1]+2763975236&4294967295,I=P+(E<<4&4294967295|E>>>28),E=T+(I^P^w)+R[4]+1272893353&4294967295,T=I+(E<<11&4294967295|E>>>21),E=w+(T^I^P)+R[7]+4139469664&4294967295,w=T+(E<<16&4294967295|E>>>16),E=P+(w^T^I)+R[10]+3200236656&4294967295,P=w+(E<<23&4294967295|E>>>9),E=I+(P^w^T)+R[13]+681279174&4294967295,I=P+(E<<4&4294967295|E>>>28),E=T+(I^P^w)+R[0]+3936430074&4294967295,T=I+(E<<11&4294967295|E>>>21),E=w+(T^I^P)+R[3]+3572445317&4294967295,w=T+(E<<16&4294967295|E>>>16),E=P+(w^T^I)+R[6]+76029189&4294967295,P=w+(E<<23&4294967295|E>>>9),E=I+(P^w^T)+R[9]+3654602809&4294967295,I=P+(E<<4&4294967295|E>>>28),E=T+(I^P^w)+R[12]+3873151461&4294967295,T=I+(E<<11&4294967295|E>>>21),E=w+(T^I^P)+R[15]+530742520&4294967295,w=T+(E<<16&4294967295|E>>>16),E=P+(w^T^I)+R[2]+3299628645&4294967295,P=w+(E<<23&4294967295|E>>>9),E=I+(w^(P|~T))+R[0]+4096336452&4294967295,I=P+(E<<6&4294967295|E>>>26),E=T+(P^(I|~w))+R[7]+1126891415&4294967295,T=I+(E<<10&4294967295|E>>>22),E=w+(I^(T|~P))+R[14]+2878612391&4294967295,w=T+(E<<15&4294967295|E>>>17),E=P+(T^(w|~I))+R[5]+4237533241&4294967295,P=w+(E<<21&4294967295|E>>>11),E=I+(w^(P|~T))+R[12]+1700485571&4294967295,I=P+(E<<6&4294967295|E>>>26),E=T+(P^(I|~w))+R[3]+2399980690&4294967295,T=I+(E<<10&4294967295|E>>>22),E=w+(I^(T|~P))+R[10]+4293915773&4294967295,w=T+(E<<15&4294967295|E>>>17),E=P+(T^(w|~I))+R[1]+2240044497&4294967295,P=w+(E<<21&4294967295|E>>>11),E=I+(w^(P|~T))+R[8]+1873313359&4294967295,I=P+(E<<6&4294967295|E>>>26),E=T+(P^(I|~w))+R[15]+4264355552&4294967295,T=I+(E<<10&4294967295|E>>>22),E=w+(I^(T|~P))+R[6]+2734768916&4294967295,w=T+(E<<15&4294967295|E>>>17),E=P+(T^(w|~I))+R[13]+1309151649&4294967295,P=w+(E<<21&4294967295|E>>>11),E=I+(w^(P|~T))+R[4]+4149444226&4294967295,I=P+(E<<6&4294967295|E>>>26),E=T+(P^(I|~w))+R[11]+3174756917&4294967295,T=I+(E<<10&4294967295|E>>>22),E=w+(I^(T|~P))+R[2]+718787259&4294967295,w=T+(E<<15&4294967295|E>>>17),E=P+(T^(w|~I))+R[9]+3951481745&4294967295,S.g[0]=S.g[0]+I&4294967295,S.g[1]=S.g[1]+(w+(E<<21&4294967295|E>>>11))&4294967295,S.g[2]=S.g[2]+w&4294967295,S.g[3]=S.g[3]+T&4294967295}r.prototype.u=function(S,I){I===void 0&&(I=S.length);for(var P=I-this.blockSize,R=this.B,w=this.h,T=0;T<I;){if(w==0)for(;T<=P;)s(this,S,T),T+=this.blockSize;if(typeof S=="string"){for(;T<I;)if(R[w++]=S.charCodeAt(T++),w==this.blockSize){s(this,R),w=0;break}}else for(;T<I;)if(R[w++]=S[T++],w==this.blockSize){s(this,R),w=0;break}}this.h=w,this.o+=I},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var I=1;I<S.length-8;++I)S[I]=0;var P=8*this.o;for(I=S.length-8;I<S.length;++I)S[I]=P&255,P/=256;for(this.u(S),S=Array(16),I=P=0;4>I;++I)for(var R=0;32>R;R+=8)S[P++]=this.g[I]>>>R&255;return S};function i(S,I){var P=a;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=I(S)}function o(S,I){this.h=I;for(var P=[],R=!0,w=S.length-1;0<=w;w--){var T=S[w]|0;R&&T==I||(P[w]=T,R=!1)}this.g=P}var a={};function c(S){return-128<=S&&128>S?i(S,function(I){return new o([I|0],0>I?-1:0)}):new o([S|0],0>S?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return f;if(0>S)return k(u(-S));for(var I=[],P=1,R=0;S>=P;R++)I[R]=S/P|0,P*=4294967296;return new o(I,0)}function d(S,I){if(S.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S.charAt(0)=="-")return k(d(S.substring(1),I));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(I,8)),R=f,w=0;w<S.length;w+=8){var T=Math.min(8,S.length-w),E=parseInt(S.substring(w,w+T),I);8>T?(T=u(Math.pow(I,T)),R=R.j(T).add(u(E))):(R=R.j(P),R=R.add(u(E)))}return R}var f=c(0),g=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(x(this))return-k(this).m();for(var S=0,I=1,P=0;P<this.g.length;P++){var R=this.i(P);S+=(0<=R?R:4294967296+R)*I,I*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(C(this))return"0";if(x(this))return"-"+k(this).toString(S);for(var I=u(Math.pow(S,6)),P=this,R="";;){var w=L(P,I).g;P=N(P,w.j(I));var T=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=w,C(P))return T+R;for(;6>T.length;)T="0"+T;R=T+R}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function C(S){if(S.h!=0)return!1;for(var I=0;I<S.g.length;I++)if(S.g[I]!=0)return!1;return!0}function x(S){return S.h==-1}n.l=function(S){return S=N(this,S),x(S)?-1:C(S)?0:1};function k(S){for(var I=S.g.length,P=[],R=0;R<I;R++)P[R]=~S.g[R];return new o(P,~S.h).add(g)}n.abs=function(){return x(this)?k(this):this},n.add=function(S){for(var I=Math.max(this.g.length,S.g.length),P=[],R=0,w=0;w<=I;w++){var T=R+(this.i(w)&65535)+(S.i(w)&65535),E=(T>>>16)+(this.i(w)>>>16)+(S.i(w)>>>16);R=E>>>16,T&=65535,E&=65535,P[w]=E<<16|T}return new o(P,P[P.length-1]&-2147483648?-1:0)};function N(S,I){return S.add(k(I))}n.j=function(S){if(C(this)||C(S))return f;if(x(this))return x(S)?k(this).j(k(S)):k(k(this).j(S));if(x(S))return k(this.j(k(S)));if(0>this.l(_)&&0>S.l(_))return u(this.m()*S.m());for(var I=this.g.length+S.g.length,P=[],R=0;R<2*I;R++)P[R]=0;for(R=0;R<this.g.length;R++)for(var w=0;w<S.g.length;w++){var T=this.i(R)>>>16,E=this.i(R)&65535,Re=S.i(w)>>>16,Ye=S.i(w)&65535;P[2*R+2*w]+=E*Ye,B(P,2*R+2*w),P[2*R+2*w+1]+=T*Ye,B(P,2*R+2*w+1),P[2*R+2*w+1]+=E*Re,B(P,2*R+2*w+1),P[2*R+2*w+2]+=T*Re,B(P,2*R+2*w+2)}for(R=0;R<I;R++)P[R]=P[2*R+1]<<16|P[2*R];for(R=I;R<2*I;R++)P[R]=0;return new o(P,0)};function B(S,I){for(;(S[I]&65535)!=S[I];)S[I+1]+=S[I]>>>16,S[I]&=65535,I++}function F(S,I){this.g=S,this.h=I}function L(S,I){if(C(I))throw Error("division by zero");if(C(S))return new F(f,f);if(x(S))return I=L(k(S),I),new F(k(I.g),k(I.h));if(x(I))return I=L(S,k(I)),new F(k(I.g),I.h);if(30<S.g.length){if(x(S)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var P=g,R=I;0>=R.l(S);)P=$(P),R=$(R);var w=ee(P,1),T=ee(R,1);for(R=ee(R,2),P=ee(P,2);!C(R);){var E=T.add(R);0>=E.l(S)&&(w=w.add(P),T=E),R=ee(R,1),P=ee(P,1)}return I=N(S,w.j(I)),new F(w,I)}for(w=f;0<=S.l(I);){for(P=Math.max(1,Math.floor(S.m()/I.m())),R=Math.ceil(Math.log(P)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),T=u(P),E=T.j(I);x(E)||0<E.l(S);)P-=R,T=u(P),E=T.j(I);C(T)&&(T=g),w=w.add(T),S=N(S,E)}return new F(w,S)}n.A=function(S){return L(this,S).h},n.and=function(S){for(var I=Math.max(this.g.length,S.g.length),P=[],R=0;R<I;R++)P[R]=this.i(R)&S.i(R);return new o(P,this.h&S.h)},n.or=function(S){for(var I=Math.max(this.g.length,S.g.length),P=[],R=0;R<I;R++)P[R]=this.i(R)|S.i(R);return new o(P,this.h|S.h)},n.xor=function(S){for(var I=Math.max(this.g.length,S.g.length),P=[],R=0;R<I;R++)P[R]=this.i(R)^S.i(R);return new o(P,this.h^S.h)};function $(S){for(var I=S.g.length+1,P=[],R=0;R<I;R++)P[R]=S.i(R)<<1|S.i(R-1)>>>31;return new o(P,S.h)}function ee(S,I){var P=I>>5;I%=32;for(var R=S.g.length-P,w=[],T=0;T<R;T++)w[T]=0<I?S.i(T+P)>>>I|S.i(T+P+1)<<32-I:S.i(T+P);return new o(w,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,dv=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,ei=o}).apply(typeof Xm<"u"?Xm:typeof self<"u"?self:typeof window<"u"?window:{});var oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hv,va,fv,wc,fh,pv,mv,gv;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof oc=="object"&&oc];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var O=l[y];if(!(O in p))break e;p=p[O]}l=l[l.length-1],y=p[l],h=h(y),h!=y&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,y=!1,O={next:function(){if(!y&&p<l.length){var j=p++;return{value:h(j,l[j]),done:!1}}return y=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,y),l.apply(h,O)}}return function(){return l.apply(h,arguments)}}function g(l,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function _(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function C(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(y,O,j){for(var le=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)le[ut-2]=arguments[ut];return h.prototype[O].apply(y,le)}}function x(l){const h=l.length;if(0<h){const p=Array(h);for(let y=0;y<h;y++)p[y]=l[y];return p}return[]}function k(l,h){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(c(y)){const O=l.length||0,j=y.length||0;l.length=O+j;for(let le=0;le<j;le++)l[O+le]=y[le]}else l.push(y)}}class N{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function B(l){return/^[\s\xa0]*$/.test(l)}function F(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function L(l){return L[" "](l),l}L[" "]=function(){};var $=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function ee(l,h,p){for(const y in l)h.call(p,l[y],y,l)}function S(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function I(l){const h={};for(const p in l)h[p]=l[p];return h}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(l,h){let p,y;for(let O=1;O<arguments.length;O++){y=arguments[O];for(p in y)l[p]=y[p];for(let j=0;j<P.length;j++)p=P[j],Object.prototype.hasOwnProperty.call(y,p)&&(l[p]=y[p])}}function w(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function T(l){a.setTimeout(()=>{throw l},0)}function E(){var l=qt;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class Re{constructor(){this.h=this.g=null}add(h,p){const y=Ye.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Ye=new N(()=>new je,l=>l.reset());class je{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Oe,Ce=!1,qt=new Re,nn=()=>{const l=a.Promise.resolve(void 0);Oe=()=>{l.then(zt)}};var zt=()=>{for(var l;l=E();){try{l.h.call(l.g)}catch(p){T(p)}var h=Ye;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}Ce=!1};function Qe(){this.s=this.s,this.C=this.C}Qe.prototype.s=!1,Qe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Qe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Xe(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Xe.prototype.h=function(){this.defaultPrevented=!0};var bn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function Ft(l,h){if(Xe.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if($){e:{try{L(h.nodeName);var O=!0;break e}catch{}O=!1}O||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Je[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Ft.aa.h.call(this)}}C(Ft,Xe);var Je={2:"touch",3:"pen",4:"mouse"};Ft.prototype.h=function(){Ft.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var q="closure_listenable_"+(1e6*Math.random()|0),ce=0;function te(l,h,p,y,O){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=O,this.key=++ce,this.da=this.fa=!1}function fe(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ue(l){this.src=l,this.g={},this.h=0}Ue.prototype.add=function(l,h,p,y,O){var j=l.toString();l=this.g[j],l||(l=this.g[j]=[],this.h++);var le=b(l,h,y,O);return-1<le?(h=l[le],p||(h.fa=!1)):(h=new te(h,this.src,j,!!y,O),h.fa=p,l.push(h)),h};function Ze(l,h){var p=h.type;if(p in l.g){var y=l.g[p],O=Array.prototype.indexOf.call(y,h,void 0),j;(j=0<=O)&&Array.prototype.splice.call(y,O,1),j&&(fe(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function b(l,h,p,y){for(var O=0;O<l.length;++O){var j=l[O];if(!j.da&&j.listener==h&&j.capture==!!p&&j.ha==y)return O}return-1}var A="closure_lm_"+(1e6*Math.random()|0),V={};function G(l,h,p,y,O){if(y&&y.once)return ue(l,h,p,y,O);if(Array.isArray(h)){for(var j=0;j<h.length;j++)G(l,h[j],p,y,O);return null}return p=Ee(p),l&&l[q]?l.K(h,p,u(y)?!!y.capture:!!y,O):z(l,h,p,!1,y,O)}function z(l,h,p,y,O,j){if(!h)throw Error("Invalid event type");var le=u(O)?!!O.capture:!!O,ut=oe(l);if(ut||(l[A]=ut=new Ue(l)),p=ut.add(h,p,y,le,j),p.proxy)return p;if(y=Z(),p.proxy=y,y.src=l,y.listener=p,l.addEventListener)bn||(O=le),O===void 0&&(O=!1),l.addEventListener(h.toString(),y,O);else if(l.attachEvent)l.attachEvent(X(h.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Z(){function l(p){return h.call(l.src,l.listener,p)}const h=ye;return l}function ue(l,h,p,y,O){if(Array.isArray(h)){for(var j=0;j<h.length;j++)ue(l,h[j],p,y,O);return null}return p=Ee(p),l&&l[q]?l.L(h,p,u(y)?!!y.capture:!!y,O):z(l,h,p,!0,y,O)}function se(l,h,p,y,O){if(Array.isArray(h))for(var j=0;j<h.length;j++)se(l,h[j],p,y,O);else y=u(y)?!!y.capture:!!y,p=Ee(p),l&&l[q]?(l=l.i,h=String(h).toString(),h in l.g&&(j=l.g[h],p=b(j,p,y,O),-1<p&&(fe(j[p]),Array.prototype.splice.call(j,p,1),j.length==0&&(delete l.g[h],l.h--)))):l&&(l=oe(l))&&(h=l.g[h.toString()],l=-1,h&&(l=b(h,p,y,O)),(p=-1<l?h[l]:null)&&ne(p))}function ne(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[q])Ze(h.i,l);else{var p=l.type,y=l.proxy;h.removeEventListener?h.removeEventListener(p,y,l.capture):h.detachEvent?h.detachEvent(X(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=oe(h))?(Ze(p,l),p.h==0&&(p.src=null,h[A]=null)):fe(l)}}}function X(l){return l in V?V[l]:V[l]="on"+l}function ye(l,h){if(l.da)l=!0;else{h=new Ft(h,this);var p=l.listener,y=l.ha||l.src;l.fa&&ne(l),l=p.call(y,h)}return l}function oe(l){return l=l[A],l instanceof Ue?l:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ee(l){return typeof l=="function"?l:(l[me]||(l[me]=function(h){return l.handleEvent(h)}),l[me])}function Ie(){Qe.call(this),this.i=new Ue(this),this.M=this,this.F=null}C(Ie,Qe),Ie.prototype[q]=!0,Ie.prototype.removeEventListener=function(l,h,p,y){se(this,l,h,p,y)};function ke(l,h){var p,y=l.F;if(y)for(p=[];y;y=y.F)p.push(y);if(l=l.M,y=h.type||h,typeof h=="string")h=new Xe(h,l);else if(h instanceof Xe)h.target=h.target||l;else{var O=h;h=new Xe(y,l),R(h,O)}if(O=!0,p)for(var j=p.length-1;0<=j;j--){var le=h.g=p[j];O=$e(le,y,!0,h)&&O}if(le=h.g=l,O=$e(le,y,!0,h)&&O,O=$e(le,y,!1,h)&&O,p)for(j=0;j<p.length;j++)le=h.g=p[j],O=$e(le,y,!1,h)&&O}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],y=0;y<p.length;y++)fe(p[y]);delete l.g[h],l.h--}}this.F=null},Ie.prototype.K=function(l,h,p,y){return this.i.add(String(l),h,!1,p,y)},Ie.prototype.L=function(l,h,p,y){return this.i.add(String(l),h,!0,p,y)};function $e(l,h,p,y){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var O=!0,j=0;j<h.length;++j){var le=h[j];if(le&&!le.da&&le.capture==p){var ut=le.listener,on=le.ha||le.src;le.fa&&Ze(l.i,le),O=ut.call(on,y)!==!1&&O}}return O&&!y.defaultPrevented}function Gt(l,h,p){if(typeof l=="function")p&&(l=g(l,p));else if(l&&typeof l.handleEvent=="function")l=g(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Dt(l){l.g=Gt(()=>{l.g=null,l.i&&(l.i=!1,Dt(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Me extends Qe{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Dt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ve(l){Qe.call(this),this.h=l,this.g={}}C(Ve,Qe);var lt=[];function it(l){ee(l.g,function(h,p){this.g.hasOwnProperty(p)&&ne(h)},l),l.g={}}Ve.prototype.N=function(){Ve.aa.N.call(this),it(this)},Ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=a.JSON.stringify,In=a.JSON.parse,Ii=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Ls(){}Ls.prototype.h=null;function xn(l){return l.h||(l.h=l.i())}function Go(){}var Fs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ei(){Xe.call(this,"d")}C(Ei,Xe);function Ko(){Xe.call(this,"c")}C(Ko,Xe);var mr={},gr=null;function Qr(){return gr=gr||new Ie}mr.La="serverreachability";function Us(l){Xe.call(this,mr.La,l)}C(Us,Xe);function Jr(l){const h=Qr();ke(h,new Us(h))}mr.STAT_EVENT="statevent";function Ml(l,h){Xe.call(this,mr.STAT_EVENT,l),this.stat=h}C(Ml,Xe);function rn(l){const h=Qr();ke(h,new Ml(h,l))}mr.Ma="timingevent";function Ho(l,h){Xe.call(this,mr.Ma,l),this.size=h}C(Ho,Xe);function Yr(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function er(){this.g=!0}er.prototype.xa=function(){this.g=!1};function Ti(l,h,p,y,O,j){l.info(function(){if(l.g)if(j)for(var le="",ut=j.split("&"),on=0;on<ut.length;on++){var We=ut[on].split("=");if(1<We.length){var hn=We[0];We=We[1];var fn=hn.split("_");le=2<=fn.length&&fn[1]=="type"?le+(hn+"="+We+"&"):le+(hn+"=redacted&")}}else le=null;else le=j;return"XMLHTTP REQ ("+y+") [attempt "+O+"]: "+h+`
`+p+`
`+le})}function Ai(l,h,p,y,O,j,le){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+O+"]: "+h+`
`+p+`
`+j+" "+le})}function Xr(l,h,p,y){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+od(l,p)+(y?" "+y:"")})}function id(l,h){l.info(function(){return"TIMEOUT: "+h})}er.prototype.info=function(){};function od(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var y=p[l];if(!(2>y.length)){var O=y[1];if(Array.isArray(O)&&!(1>O.length)){var j=O[0];if(j!="noop"&&j!="stop"&&j!="close")for(var le=1;le<O.length;le++)O[le]=""}}}}return Kt(p)}catch{return h}}var Pi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ll={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wo;function _r(){}C(_r,Ls),_r.prototype.g=function(){return new XMLHttpRequest},_r.prototype.i=function(){return{}},Wo=new _r;function tr(l,h,p,y){this.j=l,this.i=h,this.l=p,this.R=y||1,this.U=new Ve(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fl}function Fl(){this.i=null,this.g="",this.h=!1}var Ul={},Qo={};function Si(l,h,p){l.L=1,l.v=Te(Kn(h)),l.m=p,l.P=!0,Bl(l,null)}function Bl(l,h){l.F=Date.now(),xi(l),l.A=Kn(l.v);var p=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),Wl(p.i,"t",y),l.C=0,p=l.j.J,l.h=new Fl,l.g=Kp(l.j,p?h:null,!l.m),0<l.O&&(l.M=new Me(g(l.Y,l,l.g),l.O)),h=l.U,p=l.g,y=l.ca;var O="readystatechange";Array.isArray(O)||(O&&(lt[0]=O.toString()),O=lt);for(var j=0;j<O.length;j++){var le=G(p,O[j],y||h.handleEvent,!1,h.h||h);if(!le)break;h.g[le.key]=le}h=l.H?I(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Jr(),Ti(l.i,l.u,l.A,l.l,l.R,l.m)}tr.prototype.ca=function(l){l=l.target;const h=this.M;h&&wr(l)==3?h.j():this.Y(l)},tr.prototype.Y=function(l){try{if(l==this.g)e:{const fn=wr(this.g);var h=this.g.Ba();const Oi=this.g.Z();if(!(3>fn)&&(fn!=3||this.g&&(this.h.h||this.g.oa()||Op(this.g)))){this.J||fn!=4||h==7||(h==8||0>=Oi?Jr(3):Jr(2)),Yo(this);var p=this.g.Z();this.X=p;t:if(Jo(this)){var y=Op(this.g);l="";var O=y.length,j=wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yr(this),Rn(this);var le="";break t}this.h.i=new a.TextDecoder}for(h=0;h<O;h++)this.h.h=!0,l+=this.h.i.decode(y[h],{stream:!(j&&h==O-1)});y.length=0,this.h.g+=l,this.C=0,le=this.h.g}else le=this.g.oa();if(this.o=p==200,Ai(this.i,this.u,this.A,this.l,this.R,fn,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ut,on=this.g;if((ut=on.g?on.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(ut)){var We=ut;break t}}We=null}if(p=We)Xr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xo(this,p);else{this.o=!1,this.s=3,rn(12),yr(this),Rn(this);break e}}if(this.P){p=!0;let Hn;for(;!this.J&&this.C<le.length;)if(Hn=ad(this,le),Hn==Qo){fn==4&&(this.s=4,rn(14),p=!1),Xr(this.i,this.l,null,"[Incomplete Response]");break}else if(Hn==Ul){this.s=4,rn(15),Xr(this.i,this.l,le,"[Invalid Chunk]"),p=!1;break}else Xr(this.i,this.l,Hn,null),Xo(this,Hn);if(Jo(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fn!=4||le.length!=0||this.h.h||(this.s=1,rn(16),p=!1),this.o=this.o&&p,!p)Xr(this.i,this.l,le,"[Invalid Chunked Response]"),yr(this),Rn(this);else if(0<le.length&&!this.W){this.W=!0;var hn=this.j;hn.g==this&&hn.ba&&!hn.M&&(hn.j.info("Great, no buffering proxy detected. Bytes received: "+le.length),fd(hn),hn.M=!0,rn(11))}}else Xr(this.i,this.l,le,null),Xo(this,le);fn==4&&yr(this),this.o&&!this.J&&(fn==4?$p(this.j,this):(this.o=!1,xi(this)))}else Ob(this.g),p==400&&0<le.indexOf("Unknown SID")?(this.s=3,rn(12)):(this.s=0,rn(13)),yr(this),Rn(this)}}}catch{}finally{}};function Jo(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function ad(l,h){var p=l.C,y=h.indexOf(`
`,p);return y==-1?Qo:(p=Number(h.substring(p,y)),isNaN(p)?Ul:(y+=1,y+p>h.length?Qo:(h=h.slice(y,y+p),l.C=y+p,h)))}tr.prototype.cancel=function(){this.J=!0,yr(this)};function xi(l){l.S=Date.now()+l.I,jl(l,l.I)}function jl(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Yr(g(l.ba,l),h)}function Yo(l){l.B&&(a.clearTimeout(l.B),l.B=null)}tr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(id(this.i,this.A),this.L!=2&&(Jr(),rn(17)),yr(this),this.s=2,Rn(this)):jl(this,this.S-l)};function Rn(l){l.j.G==0||l.J||$p(l.j,l)}function yr(l){Yo(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,it(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Xo(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||ea(p.h,l))){if(!l.K&&ea(p.h,l)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var O=y;if(O[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)ec(p),Xl(p);else break e;hd(p),rn(18)}}else p.za=O[1],0<p.za-p.T&&37500>O[2]&&p.F&&p.v==0&&!p.C&&(p.C=Yr(g(p.Za,p),6e3));if(1>=Zo(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Bs(p,11)}else if((l.K||p.g==l)&&ec(p),!B(h))for(O=p.Da.g.parse(h),h=0;h<O.length;h++){let We=O[h];if(p.T=We[0],We=We[1],p.G==2)if(We[0]=="c"){p.K=We[1],p.ia=We[2];const hn=We[3];hn!=null&&(p.la=hn,p.j.info("VER="+p.la));const fn=We[4];fn!=null&&(p.Aa=fn,p.j.info("SVER="+p.Aa));const Oi=We[5];Oi!=null&&typeof Oi=="number"&&0<Oi&&(y=1.5*Oi,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const Hn=l.g;if(Hn){const nc=Hn.g?Hn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nc){var j=y.h;j.g||nc.indexOf("spdy")==-1&&nc.indexOf("quic")==-1&&nc.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(ta(j,j.h),j.h=null))}if(y.D){const pd=Hn.g?Hn.g.getResponseHeader("X-HTTP-Session-Id"):null;pd&&(y.ya=pd,de(y.I,y.D,pd))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var le=l;if(y.qa=Gp(y,y.J?y.ia:null,y.W),le.K){zl(y.h,le);var ut=le,on=y.L;on&&(ut.I=on),ut.B&&(Yo(ut),xi(ut)),y.g=le}else Bp(y);0<p.i.length&&Zl(p)}else We[0]!="stop"&&We[0]!="close"||Bs(p,7);else p.G==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?Bs(p,7):dd(p):We[0]!="noop"&&p.l&&p.l.ta(We),p.v=0)}}Jr(4)}catch{}}var ld=class{constructor(l,h){this.g=l,this.map=h}};function $l(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ql(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Zo(l){return l.h?1:l.g?l.g.size:0}function ea(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function ta(l,h){l.g?l.g.add(h):l.h=h}function zl(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}$l.prototype.cancel=function(){if(this.i=Ri(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ri(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return x(l.i)}function cd(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,y=0;y<p;y++)h.push(l[y]);return h}h=[],p=0;for(y in l)h[p++]=l[y];return h}function Gl(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const y in l)h[p++]=y;return h}}}function Kl(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=Gl(l),y=cd(l),O=y.length,j=0;j<O;j++)h.call(void 0,y[j],p&&p[j],l)}var Ci=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hl(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var y=l[p].indexOf("="),O=null;if(0<=y){var j=l[p].substring(0,y);O=l[p].substring(y+1)}else j=l[p];h(j,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function vr(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof vr){this.h=l.h,D(this,l.j),this.o=l.o,this.g=l.g,v(this,l.s),this.l=l.l;var h=l.i,p=new Le;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),H(this,p),this.m=l.m}else l&&(h=String(l).match(Ci))?(this.h=!1,D(this,h[1]||"",!0),this.o=qe(h[2]||""),this.g=qe(h[3]||"",!0),v(this,h[4]),this.l=qe(h[5]||"",!0),H(this,h[6]||"",!0),this.m=qe(h[7]||"")):(this.h=!1,this.i=new Le(null,this.h))}vr.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Se(h,ot,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Se(h,ot,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(Se(p,p.charAt(0)=="/"?Vt:sn,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",Se(p,ie)),l.join("")};function Kn(l){return new vr(l)}function D(l,h,p){l.j=p?qe(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function v(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function H(l,h,p){h instanceof Le?(l.i=h,xb(l.i,l.h)):(p||(h=Se(h,yt)),l.i=new Le(h,l.h))}function de(l,h,p){l.i.set(h,p)}function Te(l){return de(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function qe(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Se(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,et),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function et(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ot=/[#\/\?@]/g,sn=/[#\?:]/g,Vt=/[#\?]/g,yt=/[#\?@]/g,ie=/#/g;function Le(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Qt(l){l.g||(l.g=new Map,l.h=0,l.i&&Hl(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Le.prototype,n.add=function(l,h){Qt(this),this.i=null,l=Vi(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function ki(l,h){Qt(l),h=Vi(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Di(l,h){return Qt(l),h=Vi(l,h),l.g.has(h)}n.forEach=function(l,h){Qt(this),this.g.forEach(function(p,y){p.forEach(function(O){l.call(h,O,y,this)},this)},this)},n.na=function(){Qt(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){const O=l[y];for(let j=0;j<O.length;j++)p.push(h[y])}return p},n.V=function(l){Qt(this);let h=[];if(typeof l=="string")Di(this,l)&&(h=h.concat(this.g.get(Vi(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Qt(this),this.i=null,l=Vi(this,l),Di(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Wl(l,h,p){ki(l,h),0<p.length&&(l.i=null,l.g.set(Vi(l,h),x(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];const j=encodeURIComponent(String(y)),le=this.V(y);for(y=0;y<le.length;y++){var O=j;le[y]!==""&&(O+="="+encodeURIComponent(String(le[y]))),l.push(O)}}return this.i=l.join("&")};function Vi(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function xb(l,h){h&&!l.j&&(Qt(l),l.i=null,l.g.forEach(function(p,y){var O=y.toLowerCase();y!=O&&(ki(this,y),Wl(this,O,p))},l)),l.j=h}function Rb(l,h){const p=new er;if(a.Image){const y=new Image;y.onload=_(Zr,p,"TestLoadImage: loaded",!0,h,y),y.onerror=_(Zr,p,"TestLoadImage: error",!1,h,y),y.onabort=_(Zr,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=_(Zr,p,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else h(!1)}function Cb(l,h){const p=new er,y=new AbortController,O=setTimeout(()=>{y.abort(),Zr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:y.signal}).then(j=>{clearTimeout(O),j.ok?Zr(p,"TestPingServer: ok",!0,h):Zr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(O),Zr(p,"TestPingServer: error",!1,h)})}function Zr(l,h,p,y,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),y(p)}catch{}}function kb(){this.g=new Ii}function Db(l,h,p){const y=p||"";try{Kl(l,function(O,j){let le=O;u(O)&&(le=Kt(O)),h.push(y+j+"="+encodeURIComponent(le))})}catch(O){throw h.push(y+"type="+encodeURIComponent("_badmap")),O}}function Ql(l){this.l=l.Ub||null,this.j=l.eb||!1}C(Ql,Ls),Ql.prototype.g=function(){return new Jl(this.l,this.j)},Ql.prototype.i=function(l){return function(){return l}}({});function Jl(l,h){Ie.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Jl,Ie),n=Jl.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ra(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,na(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ra(this)),this.g&&(this.readyState=3,ra(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rp(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Rp(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?na(this):ra(this),this.readyState==3&&Rp(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,na(this))},n.Qa=function(l){this.g&&(this.response=l,na(this))},n.ga=function(){this.g&&na(this)};function na(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ra(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function ra(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Jl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Cp(l){let h="";return ee(l,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function ud(l,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Cp(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):de(l,h,p))}function xt(l){Ie.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(xt,Ie);var Vb=/^https?$/i,Nb=["POST","PUT"];n=xt.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wo.g(),this.v=this.o?xn(this.o):xn(Wo),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(j){kp(this,j);return}if(l=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var O in y)p.set(O,y[O]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const j of y.keys())p.set(j,y.get(j));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(j=>j.toLowerCase()=="content-type"),O=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Nb,h,void 0))||y||O||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,le]of p)this.g.setRequestHeader(j,le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Np(this),this.u=!0,this.g.send(l),this.u=!1}catch(j){kp(this,j)}};function kp(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Dp(l),Yl(l)}function Dp(l){l.A||(l.A=!0,ke(l,"complete"),ke(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ke(this,"complete"),ke(this,"abort"),Yl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yl(this,!0)),xt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Vp(this):this.bb())},n.bb=function(){Vp(this)};function Vp(l){if(l.h&&typeof o<"u"&&(!l.v[1]||wr(l)!=4||l.Z()!=2)){if(l.u&&wr(l)==4)Gt(l.Ea,0,l);else if(ke(l,"readystatechange"),wr(l)==4){l.h=!1;try{const le=l.Z();e:switch(le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=le===0){var O=String(l.D).match(Ci)[1]||null;!O&&a.self&&a.self.location&&(O=a.self.location.protocol.slice(0,-1)),y=!Vb.test(O?O.toLowerCase():"")}p=y}if(p)ke(l,"complete"),ke(l,"success");else{l.m=6;try{var j=2<wr(l)?l.g.statusText:""}catch{j=""}l.l=j+" ["+l.Z()+"]",Dp(l)}}finally{Yl(l)}}}}function Yl(l,h){if(l.g){Np(l);const p=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||ke(l,"ready");try{p.onreadystatechange=y}catch{}}}function Np(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function wr(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<wr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),In(h)}};function Op(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Ob(l){const h={};l=(l.g&&2<=wr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(B(l[y]))continue;var p=w(l[y]);const O=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const j=h[O]||[];h[O]=j,j.push(p)}S(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function sa(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Mp(l){this.Aa=0,this.i=[],this.j=new er,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=sa("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=sa("baseRetryDelayMs",5e3,l),this.cb=sa("retryDelaySeedMs",1e4,l),this.Wa=sa("forwardChannelMaxRetries",2,l),this.wa=sa("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new $l(l&&l.concurrentRequestLimit),this.Da=new kb,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Mp.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,y){rn(0),this.W=l,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=Gp(this,null,this.W),Zl(this)};function dd(l){if(Lp(l),l.G==3){var h=l.U++,p=Kn(l.I);if(de(p,"SID",l.K),de(p,"RID",h),de(p,"TYPE","terminate"),ia(l,p),h=new tr(l,l.j,h),h.L=2,h.v=Te(Kn(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Kp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),xi(h)}zp(l)}function Xl(l){l.g&&(fd(l),l.g.cancel(),l.g=null)}function Lp(l){Xl(l),l.u&&(a.clearTimeout(l.u),l.u=null),ec(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Zl(l){if(!ql(l.h)&&!l.s){l.s=!0;var h=l.Ga;Oe||nn(),Ce||(Oe(),Ce=!0),qt.add(h,l),l.B=0}}function Mb(l,h){return Zo(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Yr(g(l.Ga,l,h),qp(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const O=new tr(this,this.j,l);let j=this.o;if(this.S&&(j?(j=I(j),R(j,this.S)):j=this.S),this.m!==null||this.O||(O.H=j,j=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Up(this,O,h),p=Kn(this.I),de(p,"RID",l),de(p,"CVER",22),this.D&&de(p,"X-HTTP-Session-Id",this.D),ia(this,p),j&&(this.O?h="headers="+encodeURIComponent(String(Cp(j)))+"&"+h:this.m&&ud(p,this.m,j)),ta(this.h,O),this.Ua&&de(p,"TYPE","init"),this.P?(de(p,"$req",h),de(p,"SID","null"),O.T=!0,Si(O,p,null)):Si(O,p,h),this.G=2}}else this.G==3&&(l?Fp(this,l):this.i.length==0||ql(this.h)||Fp(this))};function Fp(l,h){var p;h?p=h.l:p=l.U++;const y=Kn(l.I);de(y,"SID",l.K),de(y,"RID",p),de(y,"AID",l.T),ia(l,y),l.m&&l.o&&ud(y,l.m,l.o),p=new tr(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Up(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),ta(l.h,p),Si(p,y,h)}function ia(l,h){l.H&&ee(l.H,function(p,y){de(h,y,p)}),l.l&&Kl({},function(p,y){de(h,y,p)})}function Up(l,h,p){p=Math.min(l.i.length,p);var y=l.l?g(l.l.Na,l.l,l):null;e:{var O=l.i;let j=-1;for(;;){const le=["count="+p];j==-1?0<p?(j=O[0].g,le.push("ofs="+j)):j=0:le.push("ofs="+j);let ut=!0;for(let on=0;on<p;on++){let We=O[on].g;const hn=O[on].map;if(We-=j,0>We)j=Math.max(0,O[on].g-100),ut=!1;else try{Db(hn,le,"req"+We+"_")}catch{y&&y(hn)}}if(ut){y=le.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,y}function Bp(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Oe||nn(),Ce||(Oe(),Ce=!0),qt.add(h,l),l.v=0}}function hd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Yr(g(l.Fa,l),qp(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,jp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Yr(g(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,rn(10),Xl(this),jp(this))};function fd(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function jp(l){l.g=new tr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Kn(l.qa);de(h,"RID","rpc"),de(h,"SID",l.K),de(h,"AID",l.T),de(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&de(h,"TO",l.ja),de(h,"TYPE","xmlhttp"),ia(l,h),l.m&&l.o&&ud(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=Te(Kn(h)),p.m=null,p.P=!0,Bl(p,l)}n.Za=function(){this.C!=null&&(this.C=null,Xl(this),hd(this),rn(19))};function ec(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function $p(l,h){var p=null;if(l.g==h){ec(l),fd(l),l.g=null;var y=2}else if(ea(l.h,h))p=h.D,zl(l.h,h),y=1;else return;if(l.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var O=l.B;y=Qr(),ke(y,new Ho(y,p)),Zl(l)}else Bp(l);else if(O=h.s,O==3||O==0&&0<h.X||!(y==1&&Mb(l,h)||y==2&&hd(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),O){case 1:Bs(l,5);break;case 4:Bs(l,10);break;case 3:Bs(l,6);break;default:Bs(l,2)}}}function qp(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Bs(l,h){if(l.j.info("Error code "+h),h==2){var p=g(l.fb,l),y=l.Xa;const O=!y;y=new vr(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||D(y,"https"),Te(y),O?Rb(y.toString(),p):Cb(y.toString(),p)}else rn(2);l.G=0,l.l&&l.l.sa(h),zp(l),Lp(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),rn(2)):(this.j.info("Failed to ping google.com"),rn(1))};function zp(l){if(l.G=0,l.ka=[],l.l){const h=Ri(l.h);(h.length!=0||l.i.length!=0)&&(k(l.ka,h),k(l.ka,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.ra()}}function Gp(l,h,p){var y=p instanceof vr?Kn(p):new vr(p);if(y.g!="")h&&(y.g=h+"."+y.g),v(y,y.s);else{var O=a.location;y=O.protocol,h=h?h+"."+O.hostname:O.hostname,O=+O.port;var j=new vr(null);y&&D(j,y),h&&(j.g=h),O&&v(j,O),p&&(j.l=p),y=j}return p=l.D,h=l.ya,p&&h&&de(y,p,h),de(y,"VER",l.la),ia(l,y),y}function Kp(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new xt(new Ql({eb:p})):new xt(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hp(){}n=Hp.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function tc(){}tc.prototype.g=function(l,h){return new Mn(l,h)};function Mn(l,h){Ie.call(this),this.g=new Mp(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!B(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!B(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ni(this)}C(Mn,Ie),Mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mn.prototype.close=function(){dd(this.g)},Mn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Kt(l),l=p);h.i.push(new ld(h.Ya++,l)),h.G==3&&Zl(h)},Mn.prototype.N=function(){this.g.l=null,delete this.j,dd(this.g),delete this.g,Mn.aa.N.call(this)};function Wp(l){Ei.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}C(Wp,Ei);function Qp(){Ko.call(this),this.status=1}C(Qp,Ko);function Ni(l){this.g=l}C(Ni,Hp),Ni.prototype.ua=function(){ke(this.g,"a")},Ni.prototype.ta=function(l){ke(this.g,new Wp(l))},Ni.prototype.sa=function(l){ke(this.g,new Qp)},Ni.prototype.ra=function(){ke(this.g,"b")},tc.prototype.createWebChannel=tc.prototype.g,Mn.prototype.send=Mn.prototype.o,Mn.prototype.open=Mn.prototype.m,Mn.prototype.close=Mn.prototype.close,gv=function(){return new tc},mv=function(){return Qr()},pv=mr,fh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pi.NO_ERROR=0,Pi.TIMEOUT=8,Pi.HTTP_ERROR=6,wc=Pi,Ll.COMPLETE="complete",fv=Ll,Go.EventType=Fs,Fs.OPEN="a",Fs.CLOSE="b",Fs.ERROR="c",Fs.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,va=Go,xt.prototype.listenOnce=xt.prototype.L,xt.prototype.getLastError=xt.prototype.Ka,xt.prototype.getLastErrorCode=xt.prototype.Ba,xt.prototype.getStatus=xt.prototype.Z,xt.prototype.getResponseJson=xt.prototype.Oa,xt.prototype.getResponseText=xt.prototype.oa,xt.prototype.send=xt.prototype.ea,xt.prototype.setWithCredentials=xt.prototype.Ha,hv=xt}).apply(typeof oc<"u"?oc:typeof self<"u"?self:typeof window<"u"?window:{});const Zm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Co="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es=new of("@firebase/firestore");function zi(){return Es.logLevel}function HM(n){Es.setLogLevel(n)}function J(n,...e){if(Es.logLevel<=ze.DEBUG){const t=e.map(lf);Es.debug(`Firestore (${Co}): ${n}`,...t)}}function Nt(n,...e){if(Es.logLevel<=ze.ERROR){const t=e.map(lf);Es.error(`Firestore (${Co}): ${n}`,...t)}}function zn(n,...e){if(Es.logLevel<=ze.WARN){const t=e.map(lf);Es.warn(`Firestore (${Co}): ${n}`,...t)}}function lf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(n="Unexpected state"){const e=`FIRESTORE (${Co}) INTERNAL ASSERTION FAILED: `+n;throw Nt(e),new Error(e)}function ge(n,e){n||pe()}function WM(n,e){n||pe()}function ae(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends $r{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class qP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yt.UNAUTHENTICATED))}shutdown(){}}class zP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class GP{constructor(e){this.t=e,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ge(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let i=new Zt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zt,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zt)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string"),new _v(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string"),new Yt(e)}}class KP{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class HP{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new KP(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class WP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ge(this.o===void 0);const r=i=>{i.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ge(typeof t.token=="string"),this.R=t.token,new yv(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class QM{getToken(){return Promise.resolve(new yv(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=QP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function Pe(n,e){return n<e?-1:n>e?1:0}function ho(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function wv(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Y(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Y(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Y(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Pt.fromMillis(Date.now())}static fromDate(e){return Pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Pt(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pe(this.nanoseconds,e.nanoseconds):Pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new Pt(0,0))}static max(){return new ve(new Pt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,t,r){t===void 0?t=0:t>e.length&&pe(),r===void 0?r=e.length-t:r>e.length-t&&pe(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Qa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qa?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ge extends Qa{construct(e,t,r){return new Ge(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Ge(t)}static emptyPath(){return new Ge([])}}const JP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends Qa{construct(e,t,r){return new wt(e,t,r)}static isValidIdentifier(e){return JP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new wt(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Y(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Y(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Y(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Y(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(t)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(Ge.fromString(e))}static fromName(e){return new he(Ge.fromString(e).popFirst(5))}static empty(){return new he(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new Ge(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function ph(n){return n.fields.find(e=>e.kind===2)}function Ks(n){return n.fields.filter(e=>e.kind!==2)}function YP(n,e){let t=Pe(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=XP(n.fields[r],e.fields[r]),t!==0)return t;return Pe(n.fields.length,e.fields.length)}fo.UNKNOWN_ID=-1;class ti{constructor(e,t){this.fieldPath=e,this.kind=t}}function XP(n,e){const t=wt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:Pe(n.kind,e.kind)}class po{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new po(0,jn.min())}}function bv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new Pt(t+1,0):new Pt(t,r));return new jn(s,he.empty(),e)}function Iv(n){return new jn(n.readTime,n.key,-1)}class jn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new jn(ve.min(),he.empty(),-1)}static max(){return new jn(ve.max(),he.empty(),-1)}}function cf(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=he.comparator(n.documentKey,e.documentKey),t!==0?t:Pe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ds(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==Ev)throw n;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new M((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof M?t:M.resolve(t)}catch(t){return M.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):M.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):M.reject(t)}static resolve(e){return new M((t,r)=>{t(e)})}static reject(e){return new M((t,r)=>{r(e)})}static waitFor(e){return new M((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},c=>r(c))}),o=!0,i===s&&t()})}static or(e){let t=M.resolve(!1);for(const r of e)t=t.next(s=>s?M.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new M((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;t(e[u]).next(d=>{o[u]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new M((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Zt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Va(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=uf(r.target.error);this.V.reject(new Va(e,s))}}static open(e,t,r,s){try{return new Pu(t,e.transaction(s,r))}catch(i){throw new Va(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(J("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new eS(t)}}class ur{constructor(e,t,r){this.name=e,this.version=t,this.p=r,ur.S(Ht())===12.2&&Nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return J("SimpleDb","Removing database:",e),Hs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!sv())return!1;if(ur.v())return!0;const e=Ht(),t=ur.S(e),r=0<t&&t<10,s=Av(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(J("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Va(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Y(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Y(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Va(e,o))},s.onupgradeneeded=i=>{J("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{J("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Pu.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),M.reject(u))).toPromise();return c.catch(()=>{}),await a.m,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(J("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Av(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class ZP{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Hs(this.B.delete())}}class Va extends Y{constructor(e,t){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Vs(n){return n.name==="IndexedDbTransactionError"}class eS{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(J("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(J("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hs(r)}add(e){return J("SimpleDb","ADD",this.store.name,e,e),Hs(this.store.add(e))}get(e){return Hs(this.store.get(e)).next(t=>(t===void 0&&(t=null),J("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return J("SimpleDb","DELETE",this.store.name,e),Hs(this.store.delete(e))}count(){return J("SimpleDb","COUNT",this.store.name),Hs(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new M((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new M((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){J("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new M((r,s)=>{t.onerror=i=>{const o=uf(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new M((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new ZP(a),u=t(a.primaryKey,a.value,c);if(u instanceof M){const d=u.catch(f=>(c.done(),M.reject(f)));r.push(d)}c.isDone?s():c.K===null?a.continue():a.continue(c.K)}}).next(()=>M.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Hs(n){return new M((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=uf(r.target.error);t(s)}})}let eg=!1;function uf(n){const e=ur.S(Ht());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Y("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eg||(eg=!0,setTimeout(()=>{throw r},0)),r}}return n}class tS{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){J("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{J("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Vs(t)?J("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ds(t)}await this.X(6e4)})}}class nS{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return M.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return J("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(J("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=Iv(i);cf(o,r)>0&&(r=o)}),new jn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Dn.oe=-1;function gl(n){return n==null}function Ja(n){return n===0&&1/n==-1/0}function Pv(n){return typeof n=="number"&&Number.isInteger(n)&&!Ja(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=tg(e)),e=rS(n.get(t),e);return tg(e)}function rS(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function tg(n){return n+""}function or(n){const e=n.length;if(ge(e>=2),e===2)return ge(n.charAt(0)===""&&n.charAt(1)===""),Ge.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&pe(),n.charAt(o+1)){case"":const a=n.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:pe()}i=o+2}return new Ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(n,e){return[n,vn(e)]}function Sv(n,e,t){return[n,vn(e),t]}const sS={},iS=["prefixPath","collectionGroup","readTime","documentId"],oS=["prefixPath","collectionGroup","documentId"],aS=["collectionGroup","readTime","prefixPath","documentId"],lS=["canonicalId","targetId"],cS=["targetId","path"],uS=["path","targetId"],dS=["collectionId","parent"],hS=["indexId","uid"],fS=["uid","sequenceNumber"],pS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],mS=["indexId","uid","orderedDocumentKey"],gS=["userId","collectionPath","documentId"],_S=["userId","collectionPath","largestBatchId"],yS=["userId","collectionGroup","largestBatchId"],xv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vS=[...xv,"documentOverlays"],Rv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Cv=Rv,df=[...Cv,"indexConfiguration","indexState","indexEntries"],wS=df,bS=[...df,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends Tv{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Wt(n,e){const t=ae(n);return ur.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rg(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ns(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function kv(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function Dv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,t){this.comparator=e,this.root=t||an.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,an.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,an.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ac(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ac(this.root,e,this.comparator,!1)}getReverseIterator(){return new ac(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ac(this.root,e,this.comparator,!0)}}class ac{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class an{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??an.RED,this.left=s??an.EMPTY,this.right=i??an.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new an(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return an.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return an.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,an.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,an.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw pe();const e=this.left.check();if(e!==this.right.check())throw pe();return e+(this.isRed()?0:1)}}an.EMPTY=null,an.RED=!0,an.BLACK=!1;an.EMPTY=new class{constructor(){this.size=0}get key(){throw pe()}get value(){throw pe()}get color(){throw pe()}get left(){throw pe()}get right(){throw pe()}copy(e,t,r,s,i){return this}insert(e,t,r){return new an(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new sg(this.data.getIterator())}getIteratorFrom(e){return new sg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof ct)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ct(this.comparator);return t.data=e,t}}class sg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Li(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new Vn([])}unionWith(e){let t=new ct(wt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ho(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Vv("Invalid base64 string: "+i):i}}(e);return new Ct(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ct(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ct.EMPTY_BYTE_STRING=new Ct("");const IS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mr(n){if(ge(!!n),typeof n=="string"){let e=0;const t=IS.exec(n);if(ge(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Lr(n){return typeof n=="string"?Ct.fromBase64String(n):Ct.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function xu(n){const e=n.mapValue.fields.__previous_value__;return Su(e)?xu(e):e}function Ya(n){const e=Mr(n.mapValue.fields.__local_write_time__.timestampValue);return new Pt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t,r,s,i,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}}class ii{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ii("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ii&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ic={nullValue:"NULL_VALUE"};function Ts(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Su(n)?4:Nv(n)?9007199254740991:Ru(n)?10:11:pe()}function pr(n,e){if(n===e)return!0;const t=Ts(n);if(t!==Ts(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ya(n).isEqual(Ya(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Mr(s.timestampValue),a=Mr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Lr(s.bytesValue).isEqual(Lr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return vt(s.geoPointValue.latitude)===vt(i.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return vt(s.integerValue)===vt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=vt(s.doubleValue),a=vt(i.doubleValue);return o===a?Ja(o)===Ja(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ho(n.arrayValue.values||[],e.arrayValue.values||[],pr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(rg(o)!==rg(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!pr(o[c],a[c])))return!1;return!0}(n,e);default:return pe()}}function Xa(n,e){return(n.values||[]).find(t=>pr(t,e))!==void 0}function As(n,e){if(n===e)return 0;const t=Ts(n),r=Ts(e);if(t!==r)return Pe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Pe(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=vt(i.integerValue||i.doubleValue),c=vt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return ig(n.timestampValue,e.timestampValue);case 4:return ig(Ya(n),Ya(e));case 5:return Pe(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Lr(i),c=Lr(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const d=Pe(a[u],c[u]);if(d!==0)return d}return Pe(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Pe(vt(i.latitude),vt(o.latitude));return a!==0?a:Pe(vt(i.longitude),vt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return og(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,c,u,d;const f=i.fields||{},g=o.fields||{},_=(a=f.value)===null||a===void 0?void 0:a.arrayValue,C=(c=g.value)===null||c===void 0?void 0:c.arrayValue,x=Pe(((u=_==null?void 0:_.values)===null||u===void 0?void 0:u.length)||0,((d=C==null?void 0:C.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:og(_,C)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===ms.mapValue&&o===ms.mapValue)return 0;if(i===ms.mapValue)return 1;if(o===ms.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const g=Pe(c[f],d[f]);if(g!==0)return g;const _=As(a[c[f]],u[d[f]]);if(_!==0)return _}return Pe(c.length,d.length)}(n.mapValue,e.mapValue);default:throw pe()}}function ig(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Pe(n,e);const t=Mr(n),r=Mr(e),s=Pe(t.seconds,r.seconds);return s!==0?s:Pe(t.nanos,r.nanos)}function og(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=As(t[s],r[s]);if(i)return i}return Pe(t.length,r.length)}function mo(n){return gh(n)}function gh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Mr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Lr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return he.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=gh(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${gh(t.fields[o])}`;return s+"}"}(n.mapValue):pe()}function Ec(n){switch(Ts(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=xu(n);return e?16+Ec(e):16;case 5:return 2*n.stringValue.length;case 6:return Lr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Ec(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ns(r.fields,(i,o)=>{s+=i.length+Ec(o)}),s}(n.mapValue);default:throw pe()}}function oi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function _h(n){return!!n&&"integerValue"in n}function Za(n){return!!n&&"arrayValue"in n}function ag(n){return!!n&&"nullValue"in n}function lg(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Tc(n){return!!n&&"mapValue"in n}function Ru(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Na(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ns(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Na(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Na(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Nv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const Ov={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function TS(n){return"nullValue"in n?Ic:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?oi(ii.empty(),he.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ru(n)?Ov:{mapValue:{}}:pe()}function AS(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?oi(ii.empty(),he.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Ov:"mapValue"in n?Ru(n)?{mapValue:{}}:ms:pe()}function cg(n,e){const t=As(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function ug(n,e){const t=As(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Tc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Na(t)}setAll(e){let t=wt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Na(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Tc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return pr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Tc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ns(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new un(Na(this.value))}}function Mv(n){const e=[];return Ns(n.fields,(t,r)=>{const s=new wt([t]);if(Tc(r)){const i=Mv(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Vn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new mt(e,0,ve.min(),ve.min(),ve.min(),un.empty(),0)}static newFoundDocument(e,t,r,s){return new mt(e,1,t,ve.min(),r,s,0)}static newNoDocument(e,t){return new mt(e,2,t,ve.min(),ve.min(),un.empty(),0)}static newUnknownDocument(e,t){return new mt(e,3,t,ve.min(),ve.min(),un.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,t){this.position=e,this.inclusive=t}}function dg(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=he.comparator(he.fromName(o.referenceValue),t.key):r=As(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function hg(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!pr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,t="asc"){this.field=e,this.dir=t}}function PS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{}class Ke extends Lv{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new SS(e,t,r):t==="array-contains"?new CS(e,r):t==="in"?new qv(e,r):t==="not-in"?new kS(e,r):t==="array-contains-any"?new DS(e,r):new Ke(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new xS(e,r):new RS(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(As(t,this.value)):t!==null&&Ts(this.value)===Ts(t)&&this.matchesComparison(As(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class at extends Lv{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new at(e,t)}matches(e){return go(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function go(n){return n.op==="and"}function yh(n){return n.op==="or"}function hf(n){return Fv(n)&&go(n)}function Fv(n){for(const e of n.filters)if(e instanceof at)return!1;return!0}function vh(n){if(n instanceof Ke)return n.field.canonicalString()+n.op.toString()+mo(n.value);if(hf(n))return n.filters.map(e=>vh(e)).join(",");{const e=n.filters.map(t=>vh(t)).join(",");return`${n.op}(${e})`}}function Uv(n,e){return n instanceof Ke?function(r,s){return s instanceof Ke&&r.op===s.op&&r.field.isEqual(s.field)&&pr(r.value,s.value)}(n,e):n instanceof at?function(r,s){return s instanceof at&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Uv(o,s.filters[a]),!0):!1}(n,e):void pe()}function Bv(n,e){const t=n.filters.concat(e);return at.create(t,n.op)}function jv(n){return n instanceof Ke?function(t){return`${t.field.canonicalString()} ${t.op} ${mo(t.value)}`}(n):n instanceof at?function(t){return t.op.toString()+" {"+t.getFilters().map(jv).join(" ,")+"}"}(n):"Filter"}class SS extends Ke{constructor(e,t,r){super(e,t,r),this.key=he.fromName(r.referenceValue)}matches(e){const t=he.comparator(e.key,this.key);return this.matchesComparison(t)}}class xS extends Ke{constructor(e,t){super(e,"in",t),this.keys=$v("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class RS extends Ke{constructor(e,t){super(e,"not-in",t),this.keys=$v("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function $v(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>he.fromName(r.referenceValue))}class CS extends Ke{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Za(t)&&Xa(t.arrayValue,this.value)}}class qv extends Ke{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xa(this.value.arrayValue,t)}}class kS extends Ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Xa(this.value.arrayValue,t)}}class DS extends Ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Za(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Xa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function wh(n,e=null,t=[],r=[],s=null,i=null,o=null){return new VS(n,e,t,r,s,i,o)}function ai(n){const e=ae(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>vh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),gl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>mo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>mo(r)).join(",")),e.ue=t}return e.ue}function _l(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!PS(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Uv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!hg(n.startAt,e.startAt)&&hg(n.endAt,e.endAt)}function zc(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Gc(n,e){return n.filters.filter(t=>t instanceof Ke&&t.field.isEqual(e))}function fg(n,e,t){let r=Ic,s=!0;for(const i of Gc(n,e)){let o=Ic,a=!0;switch(i.op){case"<":case"<=":o=TS(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Ic}cg({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];cg({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function pg(n,e,t){let r=ms,s=!0;for(const i of Gc(n,e)){let o=ms,a=!0;switch(i.op){case">=":case">":o=AS(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=ms}ug({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];ug({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function zv(n,e,t,r,s,i,o,a){return new qr(n,e,t,r,s,i,o,a)}function ko(n){return new qr(n)}function mg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ff(n){return n.collectionGroup!==null}function eo(n){const e=ae(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ct(wt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new el(i,r))}),t.has(wt.keyField().canonicalString())||e.ce.push(new el(wt.keyField(),r))}return e.ce}function wn(n){const e=ae(n);return e.le||(e.le=Kv(e,eo(n))),e.le}function Gv(n){const e=ae(n);return e.he||(e.he=Kv(e,n.explicitOrderBy)),e.he}function Kv(n,e){if(n.limitType==="F")return wh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new el(s.field,i)});const t=n.endAt?new Ps(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ps(n.startAt.position,n.startAt.inclusive):null;return wh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function bh(n,e){const t=n.filters.concat([e]);return new qr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Kc(n,e,t){return new qr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yl(n,e){return _l(wn(n),wn(e))&&n.limitType===e.limitType}function Hv(n){return`${ai(wn(n))}|lt:${n.limitType}`}function Gi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>jv(s)).join(", ")}]`),gl(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>mo(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>mo(s)).join(",")),`Target(${r})`}(wn(n))}; limitType=${n.limitType})`}function vl(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):he.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of eo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const u=dg(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,eo(r),s)||r.endAt&&!function(o,a,c){const u=dg(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,eo(r),s))}(n,e)}function Wv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Qv(n){return(e,t)=>{let r=!1;for(const s of eo(n)){const i=NS(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function NS(n,e,t){const r=n.field.isKeyField()?he.comparator(e.key,t.key):function(i,o,a){const c=o.data.field(i),u=a.data.field(i);return c!==null&&u!==null?As(c,u):pe()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return pe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ns(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Dv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new pt(he.comparator);function Nn(){return OS}const Jv=new pt(he.comparator);function wa(...n){let e=Jv;for(const t of n)e=e.insert(t.key,t);return e}function Yv(n){let e=Jv;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ar(){return Oa()}function Xv(){return Oa()}function Oa(){return new zr(n=>n.toString(),(n,e)=>n.isEqual(e))}const MS=new pt(he.comparator),LS=new ct(he.comparator);function Ne(...n){let e=LS;for(const t of n)e=e.add(t);return e}const FS=new ct(Pe);function pf(){return FS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ja(e)?"-0":e}}function Zv(n){return{integerValue:""+n}}function e0(n,e){return Pv(e)?Zv(e):mf(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(){this._=void 0}}function US(n,e,t){return n instanceof _o?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Su(i)&&(i=xu(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof li?n0(n,e):n instanceof ci?r0(n,e):function(s,i){const o=t0(s,i),a=gg(o)+gg(s.Pe);return _h(o)&&_h(s.Pe)?Zv(a):mf(s.serializer,a)}(n,e)}function BS(n,e,t){return n instanceof li?n0(n,e):n instanceof ci?r0(n,e):t}function t0(n,e){return n instanceof yo?function(r){return _h(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class _o extends Cu{}class li extends Cu{constructor(e){super(),this.elements=e}}function n0(n,e){const t=s0(e);for(const r of n.elements)t.some(s=>pr(s,r))||t.push(r);return{arrayValue:{values:t}}}class ci extends Cu{constructor(e){super(),this.elements=e}}function r0(n,e){let t=s0(e);for(const r of n.elements)t=t.filter(s=>!pr(s,r));return{arrayValue:{values:t}}}class yo extends Cu{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function gg(n){return vt(n.integerValue||n.doubleValue)}function s0(n){return Za(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,t){this.field=e,this.transform=t}}function jS(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof li&&s instanceof li||r instanceof ci&&s instanceof ci?ho(r.elements,s.elements,pr):r instanceof yo&&s instanceof yo?pr(r.Pe,s.Pe):r instanceof _o&&s instanceof _o}(n.transform,e.transform)}class $S{constructor(e,t){this.version=e,this.transformResults=t}}class bt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new bt}static exists(e){return new bt(void 0,e)}static updateTime(e){return new bt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ac(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ku{}function i0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Vo(n.key,bt.none()):new Do(n.key,n.data,bt.none());{const t=n.data,r=un.empty();let s=new ct(wt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Gr(n.key,r,new Vn(s.toArray()),bt.none())}}function qS(n,e,t){n instanceof Do?function(s,i,o){const a=s.value.clone(),c=yg(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Gr?function(s,i,o){if(!Ac(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=yg(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(o0(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ma(n,e,t,r){return n instanceof Do?function(i,o,a,c){if(!Ac(i.precondition,o))return a;const u=i.value.clone(),d=vg(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Gr?function(i,o,a,c){if(!Ac(i.precondition,o))return a;const u=vg(i.fieldTransforms,c,o),d=o.data;return d.setAll(o0(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return Ac(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function zS(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=t0(r.transform,s||null);i!=null&&(t===null&&(t=un.empty()),t.set(r.field,i))}return t||null}function _g(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ho(r,s,(i,o)=>jS(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Do extends ku{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Gr extends ku{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function o0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function yg(n,e,t){const r=new Map;ge(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,BS(o,a,t[s]))}return r}function vg(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,US(i,o,e))}return r}class Vo extends ku{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gf extends ku{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&qS(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ma(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ma(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Xv();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const c=i0(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ne())}isEqual(e){return this.batchId===e.batchId&&ho(this.mutations,e.mutations,(t,r)=>_g(t,r))&&ho(this.baseMutations,e.baseMutations,(t,r)=>_g(t,r))}}class yf{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ge(e.mutations.length===r.length);let s=function(){return MS}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new yf(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut,He;function l0(n){switch(n){default:return pe();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function c0(n){if(n===void 0)return Nt("GRPC error has no .code"),U.UNKNOWN;switch(n){case Ut.OK:return U.OK;case Ut.CANCELLED:return U.CANCELLED;case Ut.UNKNOWN:return U.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return U.INTERNAL;case Ut.UNAVAILABLE:return U.UNAVAILABLE;case Ut.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Ut.NOT_FOUND:return U.NOT_FOUND;case Ut.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Ut.ABORTED:return U.ABORTED;case Ut.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Ut.DATA_LOSS:return U.DATA_LOSS;default:return pe()}}(He=Ut||(Ut={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hc=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS=new ei([4294967295,4294967295],0);function wg(n){const e=u0().encode(n),t=new dv;return t.update(e),new Uint8Array(t.digest())}function bg(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ei([t,r],0),new ei([s,i],0)]}class wf{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ba(`Invalid padding: ${t}`);if(r<0)throw new ba(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ba(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ba(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ei.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(ei.fromNumber(r)));return s.compare(KS)===1&&(s=new ei([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=wg(e),[r,s]=bg(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new wf(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=wg(e),[r,s]=bg(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ba extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Il.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new bl(ve.min(),s,new pt(Pe),Nn(),Ne())}}class Il{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Il(r,t,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class d0{constructor(e,t){this.targetId=e,this.me=t}}class h0{constructor(e,t,r=Ct.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Ig{constructor(){this.fe=0,this.ge=Tg(),this.pe=Ct.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ne(),t=Ne(),r=Ne();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:pe()}}),new Il(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Tg()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class HS{constructor(e){this.Le=e,this.Be=new Map,this.ke=Nn(),this.qe=Eg(),this.Qe=new pt(Pe)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:pe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(zc(i))if(r===0){const o=new he(i.path);this.Ue(t,o,mt.newNoDocument(o,ve.min()))}else ge(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}Hc==null||Hc.et(function(d,f,g,_,C){var x,k,N,B,F,L;const $={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},ee=f.unchangedNames;return ee&&($.bloomFilter={applied:C===0,hashCount:(x=ee==null?void 0:ee.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(B=(N=(k=ee==null?void 0:ee.bits)===null||k===void 0?void 0:k.bitmap)===null||N===void 0?void 0:N.length)!==null&&B!==void 0?B:0,padding:(L=(F=ee==null?void 0:ee.bits)===null||F===void 0?void 0:F.padding)!==null&&L!==void 0?L:0,mightContain:S=>{var I;return(I=_==null?void 0:_.mightContain(S))!==null&&I!==void 0&&I}}),$}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Lr(r).toUint8Array()}catch(c){if(c instanceof Vv)return zn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new wf(o,s,i)}catch(c){return zn(c instanceof ba?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&zc(a.target)){const c=new he(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,mt.newNoDocument(c,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=Ne();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new bl(e,t,this.Qe,this.ke,r);return this.ke=Nn(),this.qe=Eg(),this.Qe=new pt(Pe),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ig,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ct(Pe),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||J("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ig),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Eg(){return new pt(he.comparator)}function Tg(){return new pt(he.comparator)}const WS=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),QS=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),JS=(()=>({and:"AND",or:"OR"}))();class YS{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ih(n,e){return n.useProto3Json||gl(e)?e:{value:e}}function vo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function f0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function XS(n,e){return vo(n,e.toTimestamp())}function Mt(n){return ge(!!n),ve.fromTimestamp(function(t){const r=Mr(t);return new Pt(r.seconds,r.nanos)}(n))}function bf(n,e){return Eh(n,e).canonicalString()}function Eh(n,e){const t=function(s){return new Ge(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function p0(n){const e=Ge.fromString(n);return ge(T0(e)),e}function tl(n,e){return bf(n.databaseId,e.path)}function dr(n,e){const t=p0(e);if(t.get(1)!==n.databaseId.projectId)throw new Y(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Y(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new he(_0(t))}function m0(n,e){return bf(n.databaseId,e)}function g0(n){const e=p0(n);return e.length===4?Ge.emptyPath():_0(e)}function Th(n){return new Ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _0(n){return ge(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Ag(n,e,t){return{name:tl(n,e),fields:t.value.mapValue.fields}}function y0(n,e,t){const r=dr(n,e.name),s=Mt(e.updateTime),i=e.createTime?Mt(e.createTime):ve.min(),o=new un({mapValue:{fields:e.fields}}),a=mt.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function ZS(n,e){return"found"in e?function(r,s){ge(!!s.found),s.found.name,s.found.updateTime;const i=dr(r,s.found.name),o=Mt(s.found.updateTime),a=s.found.createTime?Mt(s.found.createTime):ve.min(),c=new un({mapValue:{fields:s.found.fields}});return mt.newFoundDocument(i,o,a,c)}(n,e):"missing"in e?function(r,s){ge(!!s.missing),ge(!!s.readTime);const i=dr(r,s.missing),o=Mt(s.readTime);return mt.newNoDocument(i,o)}(n,e):pe()}function ex(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:pe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(ge(d===void 0||typeof d=="string"),Ct.fromBase64String(d||"")):(ge(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ct.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?U.UNKNOWN:c0(u.code);return new Y(d,u.message||"")}(o);t=new h0(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=dr(n,r.document.name),i=Mt(r.document.updateTime),o=r.document.createTime?Mt(r.document.createTime):ve.min(),a=new un({mapValue:{fields:r.document.fields}}),c=mt.newFoundDocument(s,i,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Pc(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=dr(n,r.document),i=r.readTime?Mt(r.readTime):ve.min(),o=mt.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Pc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=dr(n,r.document),i=r.removedTargetIds||[];t=new Pc([],i,s,null)}else{if(!("filter"in e))return pe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new GS(s,i),a=r.targetId;t=new d0(a,o)}}return t}function nl(n,e){let t;if(e instanceof Do)t={update:Ag(n,e.key,e.value)};else if(e instanceof Vo)t={delete:tl(n,e.key)};else if(e instanceof Gr)t={update:Ag(n,e.key,e.data),updateMask:ox(e.fieldMask)};else{if(!(e instanceof gf))return pe();t={verify:tl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof _o)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof li)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ci)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof yo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw pe()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:XS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:pe()}(n,e.precondition)),t}function Ah(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?bt.updateTime(Mt(i.updateTime)):i.exists!==void 0?bt.exists(i.exists):bt.none()}(e.currentDocument):bt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)ge(a.setToServerValue==="REQUEST_TIME"),c=new _o;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];c=new li(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];c=new ci(d)}else"increment"in a?c=new yo(o,a.increment):pe();const u=wt.fromServerFormat(a.fieldPath);return new wl(u,c)}(n,s)):[];if(e.update){e.update.name;const s=dr(n,e.update.name),i=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new Vn(u.map(d=>wt.fromServerFormat(d)))}(e.updateMask);return new Gr(s,i,o,t,r)}return new Do(s,i,t,r)}if(e.delete){const s=dr(n,e.delete);return new Vo(s,t)}if(e.verify){const s=dr(n,e.verify);return new gf(s,t)}return pe()}function tx(n,e){return n&&n.length>0?(ge(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Mt(s.updateTime):Mt(i);return o.isEqual(ve.min())&&(o=Mt(i)),new $S(o,s.transformResults||[])}(t,e))):[]}function v0(n,e){return{documents:[m0(n,e.path)]}}function Du(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=m0(n,s);const i=function(u){if(u.length!==0)return E0(at.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:ls(g.field),direction:rx(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ih(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:s}}function w0(n,e,t,r){const{_t:s,parent:i}=Du(n,e),o={},a=[];let c=0;return t.forEach(u=>{const d=r?u.alias:"aggregate_"+c++;o[d]=u.alias,u.aggregateType==="count"?a.push({alias:d,count:{}}):u.aggregateType==="avg"?a.push({alias:d,avg:{field:ls(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:d,sum:{field:ls(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function b0(n){let e=g0(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ge(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const g=I0(f);return g instanceof at&&hf(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(C){return new el(Ki(C.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,gl(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(f){const g=!!f.before,_=f.values||[];return new Ps(_,g)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const g=!f.before,_=f.values||[];return new Ps(_,g)}(t.endAt)),zv(e,s,o,i,a,"F",c,u)}function nx(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function I0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ki(t.unaryFilter.field);return Ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ki(t.unaryFilter.field);return Ke.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ki(t.unaryFilter.field);return Ke.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ki(t.unaryFilter.field);return Ke.create(o,"!=",{nullValue:"NULL_VALUE"});default:return pe()}}(n):n.fieldFilter!==void 0?function(t){return Ke.create(Ki(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return pe()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return at.create(t.compositeFilter.filters.map(r=>I0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return pe()}}(t.compositeFilter.op))}(n):pe()}function rx(n){return WS[n]}function sx(n){return QS[n]}function ix(n){return JS[n]}function ls(n){return{fieldPath:n.canonicalString()}}function Ki(n){return wt.fromServerFormat(n.fieldPath)}function E0(n){return n instanceof Ke?function(t){if(t.op==="=="){if(lg(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NAN"}};if(ag(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(lg(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NOT_NAN"}};if(ag(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ls(t.field),op:sx(t.op),value:t.value}}}(n):n instanceof at?function(t){const r=t.getFilters().map(s=>E0(s));return r.length===1?r[0]:{compositeFilter:{op:ix(t.op),filters:r}}}(n):pe()}function ox(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function T0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,t,r,s,i=ve.min(),o=ve.min(),a=Ct.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.ct=e}}function ax(n,e){let t;if(e.document)t=y0(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=he.fromSegments(e.noDocument.path),s=di(e.noDocument.readTime);t=mt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return pe();{const r=he.fromSegments(e.unknownDocument.path),s=di(e.unknownDocument.version);t=mt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Pt(s[0],s[1]);return ve.fromTimestamp(i)}(e.readTime)),t}function Pg(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Wc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:tl(i,o.key),fields:o.data.value.mapValue.fields,updateTime:vo(i,o.version.toTimestamp()),createTime:vo(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ui(e.version)};else{if(!e.isUnknownDocument())return pe();r.unknownDocument={path:t.path.toArray(),version:ui(e.version)}}return r}function Wc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ui(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function di(n){const e=new Pt(n.seconds,n.nanoseconds);return ve.fromTimestamp(e)}function Ws(n,e){const t=(e.baseMutations||[]).map(i=>Ah(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Ah(n.ct,i)),s=Pt.fromMillis(e.localWriteTimeMs);return new _f(e.batchId,s,t,r)}function Ia(n){const e=di(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?di(n.lastLimboFreeSnapshotVersion):ve.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return ge(i.documents.length===1),wn(ko(g0(i.documents[0])))}(n.query):function(i){return wn(b0(i))}(n.query),new Sr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ct.fromBase64String(n.resumeToken))}function P0(n,e){const t=ui(e.snapshotVersion),r=ui(e.lastLimboFreeSnapshotVersion);let s;s=zc(e.target)?v0(n.ct,e.target):Du(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ai(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function If(n){const e=b0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Kc(e,e.limit,"L"):e}function Nd(n,e){return new vf(e.largestBatchId,Ah(n.ct,e.overlayMutation))}function Sg(n,e){const t=e.path.lastSegment();return[n,vn(e.path.popLast()),t]}function xg(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ui(r.readTime),documentKey:vn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{getBundleMetadata(e,t){return Rg(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:di(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return Rg(e).put(function(s){return{bundleId:s.id,createTime:ui(Mt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return Cg(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:If(i.bundledQuery),readTime:di(i.readTime)}}(r)})}saveNamedQuery(e,t){return Cg(e).put(function(s){return{name:s.name,readTime:ui(Mt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function Rg(n){return Wt(n,"bundles")}function Cg(n){return Wt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Vu(e,r)}getOverlay(e,t){return ca(e).get(Sg(this.userId,t)).next(r=>r?Nd(this.serializer,r):null)}getOverlays(e,t){const r=ar();return M.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new vf(t,o);s.push(this.ht(e,a))}),M.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(vn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(ca(e).j("collectionPathOverlayIndex",a))}),M.waitFor(i)}getOverlaysForCollection(e,t,r){const s=ar(),i=vn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ca(e).U("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const u=Nd(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=ar();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ca(e).J({index:"collectionGroupOverlayIndex",range:a},(c,u,d)=>{const f=Nd(this.serializer,u);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return ca(e).put(function(s,i,o){const[a,c,u]=Sg(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:nl(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function ca(n){return Wt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{Pt(e){return Wt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Ct.fromUint8Array(r):Ct.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(vt(e.integerValue));else if("doubleValue"in e){const r=vt(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ja(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Mr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Lr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Nv(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Ru(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):pe()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(vt(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),he.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Qs.vt=new Qs;function ux(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function kg(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=ux(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class dx{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=kg(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=kg(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class hx{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class fx{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ua{constructor(){this.jt=new dx,this.Ht=new hx(this.jt),this.Jt=new fx(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Js(this.indexId,this.documentKey,this.arrayValue,r)}}function ts(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Dg(n.arrayValue,e.arrayValue),t!==0?t:(t=Dg(n.directionalValue,e.directionalValue),t!==0?t:he.comparator(n.documentKey,e.documentKey)))}function Dg(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e){this.Xt=new ct((t,r)=>wt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ge(e.collectionGroup===this.collectionId),this.nn)return!1;const t=ph(e);if(t!==void 0&&!this.sn(t))return!1;const r=Ks(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new ct(wt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ti(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ti(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ti(r.field,r.dir==="asc"?0:1)));return new fo(fo.UNKNOWN_ID,this.collectionId,t,po.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(n){var e,t;if(ge(n instanceof Ke||n instanceof at),n instanceof Ke){if(n instanceof qv){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>Ke.create(n.field,"==",i)))||[];return at.create(s,"or")}return n}const r=n.filters.map(s=>S0(s));return at.create(r,n.op)}function px(n){if(n.getFilters().length===0)return[];const e=xh(S0(n));return ge(x0(e)),Ph(e)||Sh(e)?[e]:e.getFilters()}function Ph(n){return n instanceof Ke}function Sh(n){return n instanceof at&&hf(n)}function x0(n){return Ph(n)||Sh(n)||function(t){if(t instanceof at&&yh(t)){for(const r of t.getFilters())if(!Ph(r)&&!Sh(r))return!1;return!0}return!1}(n)}function xh(n){if(ge(n instanceof Ke||n instanceof at),n instanceof Ke)return n;if(n.filters.length===1)return xh(n.filters[0]);const e=n.filters.map(r=>xh(r));let t=at.create(e,n.op);return t=Qc(t),x0(t)?t:(ge(t instanceof at),ge(go(t)),ge(t.filters.length>1),t.filters.reduce((r,s)=>Ef(r,s)))}function Ef(n,e){let t;return ge(n instanceof Ke||n instanceof at),ge(e instanceof Ke||e instanceof at),t=n instanceof Ke?e instanceof Ke?function(s,i){return at.create([s,i],"and")}(n,e):Ng(n,e):e instanceof Ke?Ng(e,n):function(s,i){if(ge(s.filters.length>0&&i.filters.length>0),go(s)&&go(i))return Bv(s,i.getFilters());const o=yh(s)?s:i,a=yh(s)?i:s,c=o.filters.map(u=>Ef(u,a));return at.create(c,"or")}(n,e),Qc(t)}function Ng(n,e){if(go(e))return Bv(e,n.getFilters());{const t=e.filters.map(r=>Ef(n,r));return at.create(t,"or")}}function Qc(n){if(ge(n instanceof Ke||n instanceof at),n instanceof Ke)return n;const e=n.getFilters();if(e.length===1)return Qc(e[0]);if(Fv(n))return n;const t=e.map(s=>Qc(s)),r=[];return t.forEach(s=>{s instanceof Ke?r.push(s):s instanceof at&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:at.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(){this.un=new Tf}addToCollectionParentIndex(e,t){return this.un.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(jn.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(jn.min())}updateCollectionGroup(e,t,r){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}}class Tf{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new ct(Ge.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ct(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=new Uint8Array(0);class gx{constructor(e,t){this.databaseId=t,this.cn=new Tf,this.ln=new zr(r=>ai(r),(r,s)=>_l(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:vn(s)};return Og(e).put(i)}return M.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[wv(t),""],!1,!0);return Og(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(or(o.parent))}return r})}addFieldIndex(e,t){const r=da(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Ui(e);return i.next(a=>{o.put(xg(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=da(e),s=Ui(e),i=Fi(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=da(e),r=Fi(e),s=Ui(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return M.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Vg(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=Fi(e);let s=!0;const i=new Map;return M.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ne();const a=[];return M.forEach(i,(c,u)=>{J("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(L=>`${L.fieldPath}:${L.kind}`).join(",")}`}(c)} to execute ${ai(t)}`);const d=function(F,L){const $=ph(L);if($===void 0)return null;for(const ee of Gc(F,$.fieldPath))switch(ee.op){case"array-contains-any":return ee.value.arrayValue.values||[];case"array-contains":return[ee.value]}return null}(u,c),f=function(F,L){const $=new Map;for(const ee of Ks(L))for(const S of Gc(F,ee.fieldPath))switch(S.op){case"==":case"in":$.set(ee.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return $.set(ee.fieldPath.canonicalString(),S.value),Array.from($.values())}return null}(u,c),g=function(F,L){const $=[];let ee=!0;for(const S of Ks(L)){const I=S.kind===0?fg(F,S.fieldPath,F.startAt):pg(F,S.fieldPath,F.startAt);$.push(I.value),ee&&(ee=I.inclusive)}return new Ps($,ee)}(u,c),_=function(F,L){const $=[];let ee=!0;for(const S of Ks(L)){const I=S.kind===0?pg(F,S.fieldPath,F.endAt):fg(F,S.fieldPath,F.endAt);$.push(I.value),ee&&(ee=I.inclusive)}return new Ps($,ee)}(u,c),C=this.In(c,u,g),x=this.In(c,u,_),k=this.Tn(c,u,f),N=this.En(c.indexId,d,C,g.inclusive,x,_.inclusive,k);return M.forEach(N,B=>r.G(B,t.limit).next(F=>{F.forEach(L=>{const $=he.fromSegments(L.documentKey);o.has($)||(o=o.add($),a.push($))})}))}).next(()=>a)}return M.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=px(at.create(e.filters,"and")).map(r=>wh(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const c=(t!=null?t.length:1)*Math.max(r.length,i.length),u=c/(t!=null?t.length:1),d=[];for(let f=0;f<c;++f){const g=t?this.dn(t[f/u]):lc,_=this.An(e,g,r[f%u],s),C=this.Rn(e,g,i[f%u],o),x=a.map(k=>this.An(e,g,k,!0));d.push(...this.createRange(_,C,x))}return d}An(e,t,r,s){const i=new Js(e,he.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new Js(e,he.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new Vg(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return M.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new ct(wt.comparator),d=!1;for(const f of c.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:u=u.add(g.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new ua;for(const s of Ks(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);Qs.vt.It(i,o)}return r.zt()}dn(e){const t=new ua;return Qs.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new ua;return Qs.vt.It(oi(this.databaseId,t),r.Yt(function(i){const o=Ks(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new ua);let i=0;for(const o of Ks(e)){const a=r[i++];for(const c of s)if(this.fn(t,o.fieldPath)&&Za(a))s=this.gn(s,o,a);else{const u=c.Yt(o.kind);Qs.vt.It(a,u)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new ua;c.seed(a.zt()),Qs.vt.It(o,c.Yt(t.kind)),i.push(c)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof Ke&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=da(e),s=Ui(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return M.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(d,f){const g=f?new po(f.sequenceNumber,new jn(di(f.readTime),new he(or(f.documentKey)),f.largestBatchId)):po.empty(),_=d.fields.map(([C,x])=>new ti(wt.fromServerFormat(C),x));return new fo(d.indexId,d.collectionGroup,_,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Pe(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=da(e),i=Ui(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>M.forEach(a,c=>i.put(xg(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return M.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?M.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),M.forEach(a,c=>this.wn(e,s,c).next(u=>{const d=this.Sn(i,c);return u.isEqual(d)?M.resolve():this.bn(e,i,c,u,d)}))))})}Dn(e,t,r,s){return Fi(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return Fi(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=Fi(e);let i=new ct(ts);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new Js(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new ct(ts);const s=this.Vn(t,e);if(s==null)return r;const i=ph(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Za(o))for(const a of o.arrayValue.values||[])r=r.add(new Js(t.indexId,e.key,this.dn(a),s))}else r=r.add(new Js(t.indexId,e.key,lc,s));return r}bn(e,t,r,s,i){J("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(c,u,d,f,g){const _=c.getIterator(),C=u.getIterator();let x=Li(_),k=Li(C);for(;x||k;){let N=!1,B=!1;if(x&&k){const F=d(x,k);F<0?B=!0:F>0&&(N=!0)}else x!=null?B=!0:N=!0;N?(f(k),k=Li(C)):B?(g(x),x=Li(_)):(x=Li(_),k=Li(C))}}(s,i,ts,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),M.waitFor(o)}yn(e){let t=1;return Ui(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ts(o,a)).filter((o,a,c)=>!a||ts(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ts(o,e),c=ts(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,lc,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,lc,[]];i.push(IDBKeyRange.bound(a,c))}return i}Cn(e,t){return ts(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Mg)}getMinOffset(e,t){return M.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||pe())).next(Mg)}}function Og(n){return Wt(n,"collectionParents")}function Fi(n){return Wt(n,"indexEntries")}function da(n){return Wt(n,"indexConfiguration")}function Ui(n){return Wt(n,"indexState")}function Mg(n){ge(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;cf(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new jn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class mn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new mn(e,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=r.J({range:o},(d,f,g)=>(a++,g.delete()));i.push(c.next(()=>{ge(a===1)}));const u=[];for(const d of t.mutations){const f=Sv(e,d.key.path,t.batchId);i.push(s.delete(f)),u.push(d.key)}return M.waitFor(i).next(()=>u)}function Jc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw pe();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn.DEFAULT_COLLECTION_PERCENTILE=10,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mn.DEFAULT=new mn(41943040,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mn.DISABLED=new mn(-1,0,0);class Nu{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){ge(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Nu(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ns(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=Hi(e),o=ns(e);return o.add({}).next(a=>{ge(typeof a=="number");const c=new _f(a,t,r,s),u=function(_,C,x){const k=x.baseMutations.map(B=>nl(_.ct,B)),N=x.mutations.map(B=>nl(_.ct,B));return{userId:C,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:k,mutations:N}}(this.serializer,this.userId,c),d=[];let f=new ct((g,_)=>Pe(g.canonicalString(),_.canonicalString()));for(const g of s){const _=Sv(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(u)),d.push(i.put(_,sS))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),M.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return ns(e).get(t).next(r=>r?(ge(r.userId===this.userId),Ws(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?M.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ns(e).J({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(ge(a.batchId>=r),i=Ws(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ns(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ns(e).U("userMutationsIndex",t).next(r=>r.map(s=>Ws(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=bc(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return Hi(e).J({range:s},(o,a,c)=>{const[u,d,f]=o,g=or(d);if(u===this.userId&&t.path.isEqual(g))return ns(e).get(f).next(_=>{if(!_)throw pe();ge(_.userId===this.userId),i.push(Ws(this.serializer,_))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ct(Pe);const s=[];return t.forEach(i=>{const o=bc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Hi(e).J({range:a},(u,d,f)=>{const[g,_,C]=u,x=or(_);g===this.userId&&i.path.isEqual(x)?r=r.add(C):f.done()});s.push(c)}),M.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=bc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new ct(Pe);return Hi(e).J({range:o},(c,u,d)=>{const[f,g,_]=c,C=or(g);f===this.userId&&r.isPrefixOf(C)?C.length===s&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(ns(e).get(i).next(o=>{if(o===null)throw pe();ge(o.userId===this.userId),r.push(Ws(this.serializer,o))}))}),M.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return R0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),M.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return M.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Hi(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=or(i[1]);s.push(c)}else a.done()}).next(()=>{ge(s.length===0)})})}containsKey(e,t){return C0(e,this.userId,t)}Nn(e){return k0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function C0(n,e,t){const r=bc(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Hi(n).J({range:i,H:!0},(a,c,u)=>{const[d,f,g]=a;d===e&&f===s&&(o=!0),u.done()}).next(()=>o)}function ns(n){return Wt(n,"mutations")}function Hi(n){return Wt(n,"documentMutations")}function k0(n){return Wt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new hi(0)}static kn(){return new hi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new hi(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ve.fromTimestamp(new Pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Bi(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(ge(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Bi(e).J((o,a)=>{const c=Ia(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>M.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Bi(e).J((r,s)=>{const i=Ia(s);t(i)})}qn(e){return Fg(e).get("targetGlobalKey").next(t=>(ge(t!==null),t))}Qn(e,t){return Fg(e).put("targetGlobalKey",t)}Kn(e,t){return Bi(e).put(P0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ai(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Bi(e).J({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const u=Ia(a);_l(t,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=cs(e);return t.forEach(o=>{const a=vn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),M.waitFor(s)}removeMatchingKeys(e,t,r){const s=cs(e);return M.forEach(t,i=>{const o=vn(i.path);return M.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=cs(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=cs(e);let i=Ne();return s.J({range:r,H:!0},(o,a,c)=>{const u=or(o[1]),d=new he(u);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=vn(t.path),s=IDBKeyRange.bound([r],[wv(r)],!1,!0);let i=0;return cs(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ot(e,t){return Bi(e).get(t).next(r=>r?Ia(r):null)}}function Bi(n){return Wt(n,"targets")}function Fg(n){return Wt(n,"targetGlobal")}function cs(n){return Wt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug([n,e],[t,r]){const s=Pe(n,t);return s===0?Pe(e,r):s}class yx{constructor(e){this.Un=e,this.buffer=new ct(Ug),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Ug(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class D0{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){J("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vs(t)?J("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ds(t)}await this.Hn(3e5)})}}class vx{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return M.resolve(Dn.oe);const r=new yx(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(Lg)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lg):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),zi()<=ze.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function V0(n,e){return new vx(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e,t){this.db=e,this.garbageCollector=V0(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return cc(e,r)}removeReference(e,t,r){return cc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return cc(e,t)}nr(e,t){return function(s,i){let o=!1;return k0(s).Y(a=>C0(s,a,i).next(c=>(c&&(o=!0),M.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const c=this.nr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ve.min()),cs(e).delete(function(f){return[0,vn(f.path)]}(o))))});s.push(c)}}).next(()=>M.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return cc(e,t)}tr(e,t){const r=cs(e);let s,i=Dn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(i!==Dn.oe&&t(new he(or(s)),i),i=u,s=c):i=Dn.oe}).next(()=>{i!==Dn.oe&&t(new he(or(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function cc(n,e){return cs(n).put(function(r,s){return{targetId:0,path:vn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(){this.changes=new zr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?M.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return qs(e).put(r)}removeEntry(e,t,r){return qs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Wc(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=mt.newInvalidDocument(t);return qs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ha(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:mt.newInvalidDocument(t)};return qs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ha(t))},(s,i)=>{r={document:this.ir(t,i),size:Jc(i)}}).next(()=>r)}getEntries(e,t){let r=Nn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=Nn(),s=new pt(he.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Jc(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return M.resolve();let s=new ct($g);t.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(ha(s.first()),ha(s.last())),o=s.getIterator();let a=o.getNext();return qs(e).J({index:"documentKeyIndex",range:i},(c,u,d)=>{const f=he.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&$g(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(ha(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Wc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qs(e).U(IDBKeyRange.bound(a,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Nn();for(const f of u){const g=this.ir(he.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(vl(t,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=Nn();const o=jg(t,r),a=jg(t,jn.max());return qs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{const f=this.ir(he.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new Ix(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Bg(e).get("remoteDocumentGlobalKey").next(t=>(ge(!!t),t))}rr(e,t){return Bg(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=ax(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ve.min())))return r}return mt.newInvalidDocument(e)}}function O0(n){return new bx(n)}class Ix extends N0{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new zr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new ct((i,o)=>Pe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=Pg(this.cr.serializer,o);s=s.add(i.path.popLast());const u=Jc(c);r+=u-a.size,t.push(this.cr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=Pg(this.cr.serializer,o.convertToNoDocument(ve.min()));t.push(this.cr.addEntry(e,i,c))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),M.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Bg(n){return Wt(n,"remoteDocumentGlobal")}function qs(n){return Wt(n,"remoteDocumentsV14")}function ha(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function jg(n,e){const t=e.documentKey.path.toArray();return[n,Wc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function $g(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=Pe(t[i],r[i]),s)return s;return s=Pe(t.length,r.length),s||(s=Pe(t[t.length-2],r[r.length-2]),s||Pe(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Ma(r.mutation,s,Vn.empty(),Pt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ne()){const s=ar();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=wa();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=ar();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ne()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Nn();const o=Oa(),a=function(){return Oa()}();return t.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Gr)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Ma(d.mutation,u,d.mutation.getFieldMask(),Pt.now())):o.set(u.key,Vn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new Ex(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Oa();let s=new pt((o,a)=>o-a),i=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=t.get(c);if(u===null)return;let d=r.get(c)||Vn.empty();d=a.applyToLocalView(u,d),r.set(c,d);const f=(s.get(a.batchId)||Ne()).add(c);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,d=c.value,f=Xv();d.forEach(g=>{if(!i.has(g)){const _=i0(t.get(g),r.get(g));_!==null&&f.set(g,_),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return he.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ff(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):M.resolve(ar());let a=-1,c=i;return o.next(u=>M.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?M.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ne())).next(d=>({batchId:a,changes:Yv(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new he(t)).next(r=>{let s=wa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=wa();return this.indexManager.getCollectionParents(e,i).next(a=>M.forEach(a,c=>{const u=function(f,g){return new qr(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,mt.newInvalidDocument(d)))});let a=wa();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Ma(d.mutation,u,Vn.empty(),Pt.now()),vl(t,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return M.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Mt(s.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:If(s.bundledQuery),readTime:Mt(s.readTime)}}(t)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(){this.overlays=new pt(he.comparator),this.Ir=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ar();return M.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),M.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),M.resolve()}getOverlaysForCollection(e,t,r){const s=ar(),i=t.length+1,o=new he(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return M.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new pt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=ar(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=ar(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=s)););return M.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new vf(t,r));let i=this.Ir.get(t);i===void 0&&(i=Ne(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(){this.sessionToken=Ct.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(){this.Tr=new ct(Jt.Er),this.dr=new ct(Jt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new Jt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Jt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new he(new Ge([])),r=new Jt(t,e),s=new Jt(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new he(new Ge([])),r=new Jt(t,e),s=new Jt(t,e+1);let i=Ne();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Jt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Jt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return he.comparator(e.key,t.key)||Pe(e.wr,t.wr)}static Ar(e,t){return Pe(e.wr,t.wr)||he.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new ct(Jt.Er)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new _f(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new Jt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,t){return M.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Jt(t,0),s=new Jt(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ct(Pe);return t.forEach(s=>{const i=new Jt(s,0),o=new Jt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),M.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;he.isDocumentKey(i)||(i=i.child(""));const o=new Jt(new he(i),0);let a=new ct(Pe);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(c.wr)),!0)},o),M.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ge(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return M.forEach(t.mutations,s=>{const i=new Jt(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new Jt(t,0),s=this.br.firstAfterOrEqual(r);return M.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e){this.Mr=e,this.docs=function(){return new pt(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return M.resolve(r?r.document.mutableCopy():mt.newInvalidDocument(t))}getEntries(e,t){let r=Nn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():mt.newInvalidDocument(s))}),M.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Nn();const o=t.path,a=new he(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||cf(Iv(d),r)<=0||(s.has(d.key)||vl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,t,r,s){pe()}Or(e,t){return M.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Rx(this)}getSize(e){return M.resolve(this.size)}}class Rx extends N0{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),M.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e){this.persistence=e,this.Nr=new zr(t=>ai(t),_l),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Af,this.targetCount=0,this.kr=hi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),M.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new hi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.Kn(t),M.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return M.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),M.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),M.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return M.resolve(r)}containsKey(e,t){return M.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Dn(0),this.Kr=!1,this.Kr=!0,this.$r=new Px,this.referenceDelegate=e(this),this.Ur=new Cx(this),this.indexManager=new mx,this.remoteDocumentCache=function(s){return new xx(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new A0(t),this.Gr=new Tx(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ax,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Sx(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){J("MemoryPersistence","Starting transaction:",e);const s=new kx(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return M.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class kx extends Tv{constructor(e){super(),this.currentSequenceNumber=e}}class Ou{constructor(e){this.persistence=e,this.Jr=new Af,this.Yr=null}static Zr(e){return new Ou(e)}get Xr(){if(this.Yr)return this.Yr;throw pe()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),M.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),M.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.Xr,r=>{const s=he.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,ve.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return M.or([()=>M.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Yc{constructor(e,t){this.persistence=e,this.ti=new zr(r=>vn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=V0(this,t)}static Zr(e,t){return new Yc(e,t)}zr(){}jr(e){return M.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return M.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?M.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,ve.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),M.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),M.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ec(e.data.value)),t}nr(e,t,r){return M.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ti.get(t);return M.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e){this.serializer=e}O(e,t,r,s){const i=new Pu("createOrUpgrade",t);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ng,{unique:!0}),c.createObjectStore("documentMutations")}(e),qg(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=M.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),qg(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ve.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ng,{unique:!0});const f=u.store("mutations"),g=d.map(_=>f.put(_));return M.waitFor(g)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:gS});u.createIndex("collectionPathOverlayIndex",_S,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",yS,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:iS});u.createIndex("documentKeyIndex",oS),u.createIndex("collectionGroupIndex",aS)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:hS}).createIndex("sequenceNumberIndex",fS,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:pS}).createIndex("documentKeyIndex",mS,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Jc(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>M.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>M.forEach(a,c=>{ge(c.userId===i.userId);const u=Ws(this.serializer,c);return R0(e,i.userId,u).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const c=new Ge(o),u=function(f){return[0,vn(f)]}(c);i.push(t.get(u).next(d=>d?M.resolve():(f=>t.put({targetId:0,path:vn(f),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>M.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:dS});const r=t.store("collectionParents"),s=new Tf,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:vn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new Ge(o);return i(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],u)=>{const d=or(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Ia(s),o=P0(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),c=function(f){return f.document?new he(Ge.fromString(f.document.name).popFirst(5)):f.noDocument?he.fromSegments(f.noDocument.path):f.unknownDocument?he.fromSegments(f.unknownDocument.path):pe()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>M.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=O0(this.serializer),i=new Pf(Ou.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:Ne();Ws(this.serializer,c).keys().forEach(f=>d=d.add(f)),a.set(c.userId,d)}),M.forEach(a,(c,u)=>{const d=new Yt(u),f=Vu.lt(this.serializer,d),g=i.getIndexManager(d),_=Nu.lt(d,this.serializer,g,i.referenceDelegate);return new M0(s,_,f,g).recalculateAndSaveOverlaysForDocumentKeys(new mh(t,Dn.oe),c).next()})})}}function qg(n){n.createObjectStore("targetDocuments",{keyPath:cS}).createIndex("documentTargetsIndex",uS,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",lS,{unique:!0}),n.createObjectStore("targetGlobal")}const Od="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Sf{constructor(e,t,r,s,i,o,a,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!Sf.D())throw new Y(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wx(this,s),this.Ai=t+"main",this.serializer=new A0(c),this.Ri=new ur(this.Ai,this.hi,new Dx(this.serializer)),this.$r=new cx,this.Ur=new _x(this.referenceDelegate,this.serializer),this.remoteDocumentCache=O0(this.serializer),this.Gr=new lx,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Nt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Y(U.FAILED_PRECONDITION,Od);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Dn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>uc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Vs(e))return J("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return J("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return fa(e).get("owner").next(t=>M.resolve(this.vi(t)))}Ci(e){return uc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Wt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return M.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?M.resolve(!0):fa(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new Y(U.FAILED_PRECONDITION,Od);return!1}}return!(!this.networkEnabled||!this.inForeground)||uc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&J("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new mh(e,Dn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>uc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Nu.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new gx(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Vu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){J("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(c){return c===17?bS:c===16?wS:c===15?df:c===14?Cv:c===13?Rv:c===12?vS:c===11?xv:void pe()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new mh(a,this.Qr?this.Qr.next():Dn.oe),t==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Y(U.FAILED_PRECONDITION,Ev);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return fa(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Y(U.FAILED_PRECONDITION,Od)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fa(e).put("owner",t)}static D(){return ur.D()}bi(e){const t=fa(e);return t.get("owner").next(r=>this.vi(r)?(J("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):M.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Nt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;rv()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return J("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Nt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Nt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fa(n){return Wt(n,"owner")}function uc(n){return Wt(n,"clientMetadata")}function xf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Ne(),s=Ne();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Rf(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return rv()?8:Av(Ht())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Vx;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(zi()<=ze.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Gi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),M.resolve()):(zi()<=ze.DEBUG&&J("QueryEngine","Query:",Gi(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(zi()<=ze.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Gi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wn(t))):M.resolve())}Yi(e,t){if(mg(t))return M.resolve(null);let r=wn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Kc(t,null,"F"),r=wn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ne(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(t,a);return this.ns(t,u,o,c.readTime)?this.Yi(e,Kc(t,null,"F")):this.rs(e,u,t,c)}))})))}Zi(e,t,r,s){return mg(t)||s.isEqual(ve.min())?M.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?M.resolve(null):(zi()<=ze.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Gi(t)),this.rs(e,o,t,bv(s,-1)).next(a=>a))})}ts(e,t){let r=new ct(Qv(e));return t.forEach((s,i)=>{vl(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return zi()<=ze.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Gi(t)),this.Ji.getDocumentsMatchingQuery(e,t,jn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new pt(Pe),this._s=new zr(i=>ai(i),_l),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new M0(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function F0(n,e,t,r){return new Nx(n,e,t,r)}async function U0(n,e){const t=ae(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=Ne();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){a.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function Ox(n,e){const t=ae(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){const f=u.batch,g=f.keys();let _=M.resolve();return g.forEach(C=>{_=_.next(()=>d.getEntry(c,C)).next(x=>{const k=u.docVersions.get(C);ge(k!==null),x.version.compareTo(k)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=Ne();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function B0(n){const e=ae(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Mx(n,e){const t=ae(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let _=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Ct.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(f,_),function(x,k,N){return x.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(g,_,d)&&a.push(t.Ur.updateTargetData(i,_))});let c=Nn(),u=Ne();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(j0(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ve.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return M.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(t.os=s,i))}function j0(n,e,t){let r=Ne(),s=Ne();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Nn();return t.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ve.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):J("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function Lx(n,e){const t=ae(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wo(n,e){const t=ae(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,M.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new Sr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function bo(n,e,t){const r=ae(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Vs(o))throw o;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Xc(n,e,t){const r=ae(n);let s=ve.min(),i=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=ae(c),g=f._s.get(d);return g!==void 0?M.resolve(f.os.get(g)):f.Ur.getTargetData(u,d)}(r,o,wn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:ve.min(),t?i:Ne())).next(a=>(z0(r,Wv(e),a),{documents:a,Ts:i})))}function $0(n,e){const t=ae(n),r=ae(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function q0(n,e){const t=ae(n),r=t.us.get(e)||ve.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,bv(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(z0(t,e,s),s))}function z0(n,e,t){let r=n.us.get(e)||ve.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function Fx(n,e,t,r){const s=ae(n);let i=Ne(),o=Nn();for(const u of t){const d=e.Es(u.metadata.name);u.document&&(i=i.add(d));const f=e.ds(u);f.setReadTime(e.As(u.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),c=await wo(s,function(d){return wn(ko(Ge.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>j0(u,a,o).next(d=>(a.apply(u),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.Ur.addMatchingKeys(u,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))}async function Ux(n,e,t=Ne()){const r=await wo(n,wn(If(e.bundledQuery))),s=ae(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Mt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(Ct.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function zg(n,e){return`firestore_clients_${n}_${e}`}function Gg(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Md(n,e){return`firestore_targets_${n}_${e}`}class Zc{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new Y(s.error.code,s.error.message))),o?new Zc(e,t,s.state,i):(Nt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class La{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new Y(r.error.code,r.error.message))),i?new La(e,r.state,s):(Nt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class eu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=pf();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=Pv(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new eu(e,i):(Nt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Cf{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Cf(t.clientId,t.onlineState):(Nt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Rh{constructor(){this.activeTargetIds=pf()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ld{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new pt(Pe),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=zg(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Rh),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(zg(this.persistenceKey,r));if(s){const i=eu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Md(this.persistenceKey,e));if(s){const i=La.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Md(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return J("SharedClientState","READ",e,t),t}setItem(e,t){J("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){J("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(J("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=Dn.oe;if(i!=null)try{const a=JSON.parse(i);ge(typeof a=="number"),o=a}catch(a){Nt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Dn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new Zc(this.currentUser,e,t,r),i=Gg(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=Gg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=Md(this.persistenceKey,e),i=new La(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return eu.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Zc.Rs(new Yt(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return La.Rs(s,t)}Ls(e){return Cf.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);J("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=pf();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class G0{constructor(){this.so=new Rh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Rh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dc=null;function Fd(){return dc===null?dc=function(){return 268435456+Math.round(2147483648*Math.random())}():dc++,"0x"+dc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class qx extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Fd(),c=this.xo(t,r.toUriEncodedString());J("RestConnection",`Sending RPC '${t}' ${a}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(t,c,u,s).then(d=>(J("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw zn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Co}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=jx[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Fd();return new Promise((o,a)=>{const c=new hv;c.setWithCredentials(!0),c.listenOnce(fv.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case wc.NO_ERROR:const d=c.getResponseJson();J(pn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case wc.TIMEOUT:J(pn,`RPC '${e}' ${i} timed out`),a(new Y(U.DEADLINE_EXCEEDED,"Request time out"));break;case wc.HTTP_ERROR:const f=c.getStatus();if(J(pn,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const C=function(k){const N=k.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(N)>=0?N:U.UNKNOWN}(_.status);a(new Y(C,_.message))}else a(new Y(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Y(U.UNAVAILABLE,"Connection failed."));break;default:pe()}}finally{J(pn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);J(pn,`RPC '${e}' ${i} sending request:`,s),c.send(t,"POST",u,r,15)})}Bo(e,t,r){const s=Fd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=gv(),a=mv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const d=i.join("");J(pn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const f=o.createWebChannel(d,c);let g=!1,_=!1;const C=new $x({Io:k=>{_?J(pn,`Not sending because RPC '${e}' stream ${s} is closed:`,k):(g||(J(pn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),J(pn,`RPC '${e}' stream ${s} sending:`,k),f.send(k))},To:()=>f.close()}),x=(k,N,B)=>{k.listen(N,F=>{try{B(F)}catch(L){setTimeout(()=>{throw L},0)}})};return x(f,va.EventType.OPEN,()=>{_||(J(pn,`RPC '${e}' stream ${s} transport opened.`),C.yo())}),x(f,va.EventType.CLOSE,()=>{_||(_=!0,J(pn,`RPC '${e}' stream ${s} transport closed`),C.So())}),x(f,va.EventType.ERROR,k=>{_||(_=!0,zn(pn,`RPC '${e}' stream ${s} transport errored:`,k),C.So(new Y(U.UNAVAILABLE,"The operation could not be completed")))}),x(f,va.EventType.MESSAGE,k=>{var N;if(!_){const B=k.data[0];ge(!!B);const F=B,L=F.error||((N=F[0])===null||N===void 0?void 0:N.error);if(L){J(pn,`RPC '${e}' stream ${s} received error:`,L);const $=L.status;let ee=function(P){const R=Ut[P];if(R!==void 0)return c0(R)}($),S=L.message;ee===void 0&&(ee=U.INTERNAL,S="Unknown error status: "+$+" with message "+L.message),_=!0,C.So(new Y(ee,S)),f.close()}else J(pn,`RPC '${e}' stream ${s} received:`,B),C.bo(B)}}),x(a,pv.STAT_EVENT,k=>{k.stat===fh.PROXY?J(pn,`RPC '${e}' stream ${s} detected buffering proxy`):k.stat===fh.NOPROXY&&J(pn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(){return typeof window<"u"?window:null}function Sc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(n){return new YS(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&J("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,t,r,s,i,o,a,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new kf(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new Y(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zx extends H0{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=ex(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Mt(o.readTime):ve.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Th(this.serializer),t.addTarget=function(i,o){let a;const c=o.target;if(a=zc(c)?{documents:v0(i,c)}:{query:Du(i,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=f0(i,o.resumeToken);const u=Ih(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=vo(i,o.snapshotVersion.toTimestamp());const u=Ih(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=nx(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Th(this.serializer),t.removeTarget=e,this.a_(t)}}class Gx extends H0{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ge(!!e.streamToken),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=tx(e.writeResults,e.commitTime),r=Mt(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Th(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>nl(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Y(U.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Eh(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y(U.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Eh(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Y(U.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Hx{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Nt(t),this.D_=!1):J("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Os(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=ae(c);u.L_.add(4),await No(u),u.q_.set("Unknown"),u.L_.delete(4),await Tl(u)}(this))})}),this.q_=new Hx(r,s)}}async function Tl(n){if(Os(n))for(const e of n.B_)await e(!0)}async function No(n){for(const e of n.B_)await e(!1)}function Mu(n,e){const t=ae(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Nf(t)?Vf(t):Mo(t).r_()&&Df(t,e))}function Io(n,e){const t=ae(n),r=Mo(t);t.N_.delete(e),r.r_()&&W0(t,e),t.N_.size===0&&(r.r_()?r.o_():Os(t)&&t.q_.set("Unknown"))}function Df(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Mo(n).A_(e)}function W0(n,e){n.Q_.xe(e),Mo(n).R_(e)}function Vf(n){n.Q_=new HS({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Mo(n).start(),n.q_.v_()}function Nf(n){return Os(n)&&!Mo(n).n_()&&n.N_.size>0}function Os(n){return ae(n).L_.size===0}function Q0(n){n.Q_=void 0}async function Qx(n){n.q_.set("Online")}async function Jx(n){n.N_.forEach((e,t)=>{Df(n,e)})}async function Yx(n,e){Q0(n),Nf(n)?(n.q_.M_(e),Vf(n)):n.q_.set("Unknown")}async function Xx(n,e,t){if(n.q_.set("Online"),e instanceof h0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await tu(n,r)}else if(e instanceof Pc?n.Q_.Ke(e):e instanceof d0?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ve.min()))try{const r=await B0(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(Ct.EMPTY_BYTE_STRING,d.snapshotVersion)),W0(i,c);const f=new Sr(d.target,c,u,d.sequenceNumber);Df(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await tu(n,r)}}async function tu(n,e,t){if(!Vs(e))throw e;n.L_.add(1),await No(n),n.q_.set("Offline"),t||(t=()=>B0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Tl(n)})}function J0(n,e){return e().catch(t=>tu(n,t,e))}async function Oo(n){const e=ae(n),t=Ss(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Zx(e);)try{const s=await Lx(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,eR(e,s)}catch(s){await tu(e,s)}Y0(e)&&X0(e)}function Zx(n){return Os(n)&&n.O_.length<10}function eR(n,e){n.O_.push(e);const t=Ss(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Y0(n){return Os(n)&&!Ss(n).n_()&&n.O_.length>0}function X0(n){Ss(n).start()}async function tR(n){Ss(n).p_()}async function nR(n){const e=Ss(n);for(const t of n.O_)e.m_(t.mutations)}async function rR(n,e,t){const r=n.O_.shift(),s=yf.from(r,e,t);await J0(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Oo(n)}async function sR(n,e){e&&Ss(n).V_&&await async function(r,s){if(function(o){return l0(o)&&o!==U.ABORTED}(s.code)){const i=r.O_.shift();Ss(r).s_(),await J0(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Oo(r)}}(n,e),Y0(n)&&X0(n)}async function Hg(n,e){const t=ae(n);t.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=Os(t);t.L_.add(3),await No(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Tl(t)}async function Ch(n,e){const t=ae(n);e?(t.L_.delete(2),await Tl(t)):e||(t.L_.add(2),await No(t),t.q_.set("Unknown"))}function Mo(n){return n.K_||(n.K_=function(t,r,s){const i=ae(t);return i.w_(),new zx(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:Qx.bind(null,n),Ro:Jx.bind(null,n),mo:Yx.bind(null,n),d_:Xx.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Nf(n)?Vf(n):n.q_.set("Unknown")):(await n.K_.stop(),Q0(n))})),n.K_}function Ss(n){return n.U_||(n.U_=function(t,r,s){const i=ae(t);return i.w_(),new Gx(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:tR.bind(null,n),mo:sR.bind(null,n),f_:nR.bind(null,n),g_:rR.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Oo(n)):(await n.U_.stop(),n.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Zt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Of(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lo(n,e){if(Nt("AsyncQueue",`${e}: ${n}`),Vs(n))return new Y(U.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this.comparator=e?(t,r)=>e(t,r)||he.comparator(t.key,r.key):(t,r)=>he.comparator(t.key,r.key),this.keyedMap=wa(),this.sortedSet=new pt(this.comparator)}static emptySet(e){return new to(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof to)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new to;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(){this.W_=new pt(he.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):pe():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Eo{constructor(e,t,r,s,i,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Eo(e,t,to.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class oR{constructor(){this.queries=Qg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=ae(t),i=s.queries;s.queries=Qg(),i.forEach((o,a)=>{for(const c of a.j_)c.onError(r)})})(this,new Y(U.ABORTED,"Firestore shutting down"))}}function Qg(){return new zr(n=>Hv(n),yl)}async function Mf(n,e){const t=ae(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new iR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=Lo(o,`Initialization of query '${Gi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&Ff(t)}async function Lf(n,e){const t=ae(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function aR(n,e){const t=ae(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&Ff(t)}function lR(n,e,t){const r=ae(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function Ff(n){n.Y_.forEach(e=>{e.next()})}var kh,Jg;(Jg=kh||(kh={})).ea="default",Jg.Cache="cache";class Uf{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Eo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==kh.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e){this.serializer=e}Es(e){return dr(this.serializer,e)}ds(e){return e.metadata.exists?y0(this.serializer,e.document,!1):mt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Mt(e)}}class uR{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Z0(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=Ge.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new Yg(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||Ne()).add(i);t.set(o,a)}}return t}async complete(){const e=await Fx(this.localStore,new Yg(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await Ux(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function Z0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e){this.key=e}}class tw{constructor(e){this.key=e}}class nw{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ne(),this.mutatedKeys=Ne(),this.Aa=Qv(e),this.Ra=new to(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new Wg,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),_=vl(this.query,f)?f:null,C=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let k=!1;g&&_?g.data.isEqual(_.data)?C!==x&&(r.track({type:3,doc:_}),k=!0):this.ga(g,_)||(r.track({type:2,doc:_}),k=!0,(c&&this.Aa(_,c)>0||u&&this.Aa(_,u)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),k=!0):g&&!_&&(r.track({type:1,doc:g}),k=!0,(c||u)&&(a=!0)),k&&(_?(o=o.add(_),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(_,C){const x=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe()}};return x(_)-x(C)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Eo(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Wg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new tw(r))}),this.da.forEach(r=>{e.has(r)||t.push(new ew(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ne();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Eo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class dR{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class hR{constructor(e){this.key=e,this.va=!1}}class fR{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new zr(a=>Hv(a),yl),this.Ma=new Map,this.xa=new Set,this.Oa=new pt(he.comparator),this.Na=new Map,this.La=new Af,this.Ba={},this.ka=new Map,this.qa=hi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function pR(n,e,t=!0){const r=Lu(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await rw(r,e,t,!0),s}async function mR(n,e){const t=Lu(n);await rw(t,e,!0,!1)}async function rw(n,e,t,r){const s=await wo(n.localStore,wn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Bf(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Mu(n.remoteStore,s),a}async function Bf(n,e,t,r,s){n.Ka=(f,g,_)=>async function(x,k,N,B){let F=k.view.ma(N);F.ns&&(F=await Xc(x.localStore,k.query,!1).then(({documents:S})=>k.view.ma(S,F)));const L=B&&B.targetChanges.get(k.targetId),$=B&&B.targetMismatches.get(k.targetId)!=null,ee=k.view.applyChanges(F,x.isPrimaryClient,L,$);return Dh(x,k.targetId,ee.wa),ee.snapshot}(n,f,g,_);const i=await Xc(n.localStore,e,!0),o=new nw(e,i.Ts),a=o.ma(i.documents),c=Il.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,c);Dh(n,t,u.wa);const d=new dR(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function gR(n,e,t){const r=ae(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!yl(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await bo(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Io(r.remoteStore,s.targetId),To(r,s.targetId)}).catch(Ds)):(To(r,s.targetId),await bo(r.localStore,s.targetId,!0))}async function _R(n,e){const t=ae(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Io(t.remoteStore,r.targetId))}async function yR(n,e,t){const r=zf(n);try{const s=await function(o,a){const c=ae(o),u=Pt.now(),d=a.reduce((_,C)=>_.add(C.key),Ne());let f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let C=Nn(),x=Ne();return c.cs.getEntries(_,d).next(k=>{C=k,C.forEach((N,B)=>{B.isValidDocument()||(x=x.add(N))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,C)).next(k=>{f=k;const N=[];for(const B of a){const F=zS(B,f.get(B.key).overlayedDocument);F!=null&&N.push(new Gr(B.key,F,Mv(F.value.mapValue),bt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,N,a)}).next(k=>{g=k;const N=k.applyToLocalDocumentSet(f,x);return c.documentOverlayCache.saveOverlays(_,k.batchId,N)})}).then(()=>({batchId:g.batchId,changes:Yv(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new pt(Pe)),u=u.insert(a,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,t),await Kr(r,s.changes),await Oo(r.remoteStore)}catch(s){const i=Lo(s,"Failed to persist write");t.reject(i)}}async function sw(n,e){const t=ae(n);try{const r=await Mx(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(ge(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ge(o.va):s.removedDocuments.size>0&&(ge(o.va),o.va=!1))}),await Kr(t,r,e)}catch(r){await Ds(r)}}function Xg(n,e,t){const r=ae(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=ae(o);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(a)&&(u=!0)}),u&&Ff(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function vR(n,e,t){const r=ae(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new pt(he.comparator);o=o.insert(i,mt.newNoDocument(i,ve.min()));const a=Ne().add(i),c=new bl(ve.min(),new Map,new pt(Pe),o,a);await sw(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),qf(r)}else await bo(r.localStore,e,!1).then(()=>To(r,e,t)).catch(Ds)}async function wR(n,e){const t=ae(n),r=e.batch.batchId;try{const s=await Ox(t.localStore,e);$f(t,r,null),jf(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Kr(t,s)}catch(s){await Ds(s)}}async function bR(n,e,t){const r=ae(n);try{const s=await function(o,a){const c=ae(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(ge(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);$f(r,e,t),jf(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Kr(r,s)}catch(s){await Ds(s)}}async function IR(n,e){const t=ae(n);Os(t.remoteStore)||J("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=ae(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=Lo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function jf(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function $f(n,e,t){const r=ae(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function To(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||iw(n,r)})}function iw(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Io(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),qf(n))}function Dh(n,e,t){for(const r of t)r instanceof ew?(n.La.addReference(r.key,e),ER(n,r)):r instanceof tw?(J("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||iw(n,r.key)):pe()}function ER(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(J("SyncEngine","New document in limbo: "+t),n.xa.add(r),qf(n))}function qf(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new he(Ge.fromString(e)),r=n.qa.next();n.Na.set(r,new hR(t)),n.Oa=n.Oa.insert(t,r),Mu(n.remoteStore,new Sr(wn(ko(t.path)),r,"TargetPurposeLimboResolution",Dn.oe))}}async function Kr(n,e,t){const r=ae(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=Rf.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=ae(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>M.forEach(u,g=>M.forEach(g.$i,_=>d.persistence.referenceDelegate.addReference(f,g.targetId,_)).next(()=>M.forEach(g.Ui,_=>d.persistence.referenceDelegate.removeReference(f,g.targetId,_)))))}catch(f){if(!Vs(f))throw f;J("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const _=d.os.get(g),C=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(C);d.os=d.os.insert(g,x)}}}(r.localStore,i))}async function TR(n,e){const t=ae(n);if(!t.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await U0(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(c=>{c.reject(new Y(U.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Kr(t,r.hs)}}function AR(n,e){const t=ae(n),r=t.Na.get(e);if(r&&r.va)return Ne().add(r.key);{let s=Ne();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function PR(n,e){const t=ae(n),r=await Xc(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&Dh(t,e.targetId,s.wa),s}async function SR(n,e){const t=ae(n);return q0(t.localStore,e).then(r=>Kr(t,r))}async function xR(n,e,t,r){const s=ae(n),i=await function(a,c){const u=ae(a),d=ae(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,c).next(g=>g?u.localDocuments.getDocuments(f,g):M.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await Oo(s.remoteStore):t==="acknowledged"||t==="rejected"?($f(s,e,r||null),jf(s,e),function(a,c){ae(ae(a).mutationQueue).On(c)}(s.localStore,e)):pe(),await Kr(s,i)):J("SyncEngine","Cannot apply mutation batch with id: "+e)}async function RR(n,e){const t=ae(n);if(Lu(t),zf(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await Zg(t,r.toArray());t.Qa=!0,await Ch(t.remoteStore,!0);for(const i of s)Mu(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(To(t,o),bo(t.localStore,o,!0))),Io(t.remoteStore,o)}),await s,await Zg(t,r),function(o){const a=ae(o);a.Na.forEach((c,u)=>{Io(a.remoteStore,u)}),a.La.pr(),a.Na=new Map,a.Oa=new pt(he.comparator)}(t),t.Qa=!1,await Ch(t.remoteStore,!1)}}async function Zg(n,e,t){const r=ae(n),s=[],i=[];for(const o of e){let a;const c=r.Ma.get(o);if(c&&c.length!==0){a=await wo(r.localStore,wn(c[0]));for(const u of c){const d=r.Fa.get(u),f=await PR(r,d);f.snapshot&&i.push(f.snapshot)}}else{const u=await $0(r.localStore,o);a=await wo(r.localStore,u),await Bf(r,ow(u),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function ow(n){return zv(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function CR(n){return function(t){return ae(ae(t).persistence).Qi()}(ae(n).localStore)}async function kR(n,e,t,r){const s=ae(n);if(s.Qa)return void J("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await q0(s.localStore,Wv(i[0])),a=bl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ct.EMPTY_BYTE_STRING);await Kr(s,o,a);break}case"rejected":await bo(s.localStore,e,!0),To(s,e,r);break;default:pe()}}async function DR(n,e,t){const r=Lu(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){J("SyncEngine","Adding an already active target "+s);continue}const i=await $0(r.localStore,s),o=await wo(r.localStore,i);await Bf(r,ow(i),o.targetId,!1,o.resumeToken),Mu(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await bo(r.localStore,s,!1).then(()=>{Io(r.remoteStore,s),To(r,s)}).catch(Ds)}}function Lu(n){const e=ae(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=sw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vR.bind(null,e),e.Ca.d_=aR.bind(null,e.eventManager),e.Ca.$a=lR.bind(null,e.eventManager),e}function zf(n){const e=ae(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bR.bind(null,e),e}function VR(n,e,t){const r=ae(n);(async function(i,o,a){try{const c=await o.getMetadata();if(await function(_,C){const x=ae(_),k=Mt(C.createTime);return x.persistence.runTransaction("hasNewerBundle","readonly",N=>x.Gr.getBundleMetadata(N,C.id)).then(N=>!!N&&N.createTime.compareTo(k)>=0)}(i.localStore,c))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Z0(c));const u=new uR(c,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await u.la(d);g&&a._updateProgress(g),d=await o.Ua()}const f=await u.complete();return await Kr(i,f.Ia,void 0),await function(_,C){const x=ae(_);return x.persistence.runTransaction("Save bundle","readwrite",k=>x.Gr.saveBundleMetadata(k,C))}(i.localStore,c),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(c){return zn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class xs{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=El(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return F0(this.persistence,new L0,e.initialUser,this.serializer)}Ga(e){return new Pf(Ou.Zr,this.serializer)}Wa(e){return new G0}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xs.provider={build:()=>new xs};class NR extends xs{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){ge(this.persistence.referenceDelegate instanceof Yc);const r=this.persistence.referenceDelegate.garbageCollector;return new D0(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?mn.withCacheSize(this.cacheSizeBytes):mn.DEFAULT;return new Pf(r=>Yc.Zr(r,t),this.serializer)}}class Gf extends xs{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await zf(this.Ja.syncEngine),await Oo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return F0(this.persistence,new L0,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new D0(r,e.asyncQueue,t)}Ha(e,t){const r=new nS(t,this.persistence);return new tS(e.asyncQueue,r)}Ga(e){const t=xf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?mn.withCacheSize(this.cacheSizeBytes):mn.DEFAULT;return new Sf(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,K0(),Sc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new G0}}class aw extends Gf{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Ld&&(this.sharedClientState.syncEngine={no:xR.bind(null,t),ro:kR.bind(null,t),io:DR.bind(null,t),Qi:CR.bind(null,t),eo:SR.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await RR(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=K0();if(!Ld.D(t))throw new Y(U.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=xf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ld(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Rs{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Xg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=TR.bind(null,this.syncEngine),await Ch(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new oR}()}createDatastore(e){const t=El(e.databaseInfo.databaseId),r=function(i){return new qx(i)}(e.databaseInfo);return function(i,o,a,c){return new Kx(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new Wx(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Xg(this.syncEngine,t,0),function(){return Kg.D()?new Kg:new Bx}())}createSyncEngine(e,t){return function(s,i,o,a,c,u,d){const f=new fR(s,i,o,a,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=ae(s);J("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await No(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Rs.provider={build:()=>new Rs};function e_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Nt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Zt,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new cR(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Y(U.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=ae(s),a={documents:i.map(f=>tl(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Ge.emptyPath(),a,i.length),u=new Map;c.forEach(f=>{const g=ZS(o.serializer,f);u.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=u.get(f.toString());ge(!!g),d.push(g)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Vo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=he.fromPath(r);this.mutations.push(new gf(s,this.precondition(s)))}),await async function(r,s){const i=ae(r),o={writes:s.map(a=>nl(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,Ge.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw pe();t=ve.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Y(U.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ve.min())?bt.exists(!1):bt.updateTime(t):bt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ve.min()))throw new Y(U.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bt.updateTime(t)}return bt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new kf(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new MR(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!gl(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!l0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Yt.UNAUTHENTICATED,this.clientId=vv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{J("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Lo(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ud(n,e){n.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await U0(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function t_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Kf(n);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Hg(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Hg(e.remoteStore,s)),n._onlineComponents=e}async function Kf(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ud(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;zn("Error using user provided cache. Falling back to memory cache: "+t),await Ud(n,new xs)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await Ud(n,new xs);return n._offlineComponents}async function Uu(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await t_(n,n._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await t_(n,new Rs))),n._onlineComponents}function lw(n){return Kf(n).then(e=>e.persistence)}function Fo(n){return Kf(n).then(e=>e.localStore)}function cw(n){return Uu(n).then(e=>e.remoteStore)}function Hf(n){return Uu(n).then(e=>e.syncEngine)}function uw(n){return Uu(n).then(e=>e.datastore)}async function Ao(n){const e=await Uu(n),t=e.eventManager;return t.onListen=pR.bind(null,e.syncEngine),t.onUnlisten=gR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_R.bind(null,e.syncEngine),t}function UR(n){return n.asyncQueue.enqueue(async()=>{const e=await lw(n),t=await cw(n);return e.setNetworkEnabled(!0),function(s){const i=ae(s);return i.L_.delete(0),Tl(i)}(t)})}function BR(n){return n.asyncQueue.enqueue(async()=>{const e=await lw(n),t=await cw(n);return e.setNetworkEnabled(!1),async function(s){const i=ae(s);i.L_.add(0),await No(i),i.q_.set("Offline")}(t)})}function jR(n,e){const t=new Zt;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(u,d){const f=ae(u);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new Y(U.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=Lo(a,`Failed to get document '${i} from cache`);o.reject(c)}}(await Fo(n),e,t)),t.promise}function dw(n,e,t={}){const r=new Zt;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const d=new Fu({next:g=>{d.Za(),o.enqueueAndForget(()=>Lf(i,f));const _=g.docs.has(a);!_&&g.fromCache?u.reject(new Y(U.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&c&&c.source==="server"?u.reject(new Y(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Uf(ko(a.path),d,{includeMetadataChanges:!0,_a:!0});return Mf(i,f)}(await Ao(n),n.asyncQueue,e,t,r)),r.promise}function $R(n,e){const t=new Zt;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await Xc(s,i,!0),c=new nw(i,a.Ts),u=c.ma(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){const c=Lo(a,`Failed to execute query '${i} against cache`);o.reject(c)}}(await Fo(n),e,t)),t.promise}function hw(n,e,t={}){const r=new Zt;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const d=new Fu({next:g=>{d.Za(),o.enqueueAndForget(()=>Lf(i,f)),g.fromCache&&c.source==="server"?u.reject(new Y(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Uf(a,d,{includeMetadataChanges:!0,_a:!0});return Mf(i,f)}(await Ao(n),n.asyncQueue,e,t,r)),r.promise}function qR(n,e,t){const r=new Zt;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await uw(n);r.resolve(async function(o,a,c){var u;const d=ae(o),{request:f,ut:g,parent:_}=w0(d.serializer,Gv(a),c);d.connection.Fo||delete f.parent;const C=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,_,f,1)).filter(k=>!!k.result);ge(C.length===1);const x=(u=C[0].result)===null||u===void 0?void 0:u.aggregateFields;return Object.keys(x).reduce((k,N)=>(k[g[N]]=x[N],k),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function zR(n,e){const t=new Fu(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){ae(s).Y_.add(i),i.next()}(await Ao(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){ae(s).Y_.delete(i)}(await Ao(n),t))}}function GR(n,e,t,r){const s=function(o,a){let c;return c=typeof o=="string"?u0().encode(o):o,function(d,f){return new OR(d,f)}(function(d,f){if(d instanceof Uint8Array)return e_(d,f);if(d instanceof ArrayBuffer)return e_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,El(e));n.asyncQueue.enqueueAndForget(async()=>{VR(await Hf(n),s,r)})}function KR(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=ae(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await Fo(n),e))}function HR(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=ae(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",c=>o.getFieldIndexes(c).next(u=>function(f,g,_,C,x){f=[...f],g=[...g],f.sort(_),g.sort(_);const k=f.length,N=g.length;let B=0,F=0;for(;B<N&&F<k;){const L=_(f[F],g[B]);L<0?x(f[F++]):L>0?C(g[B++]):(B++,F++)}for(;B<N;)C(g[B++]);for(;F<k;)x(f[F++])}(u,s,YP,d=>{a.push(o.addFieldIndex(c,d))},d=>{a.push(o.deleteFieldIndex(c,d))})).next(()=>M.waitFor(a)))}(await Fo(n),e))}function WR(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){ae(r).ss.zi=s}(await Fo(n),e))}function QR(n){return n.asyncQueue.enqueue(async()=>function(t){const r=ae(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await Fo(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(n,e,t){if(!t)throw new Y(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JR(n,e,t,r){if(e===!0&&r===!0)throw new Y(U.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function r_(n){if(!he.isDocumentKey(n))throw new Y(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function s_(n){if(he.isDocumentKey(n))throw new Y(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Bu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":pe()}function Be(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Y(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bu(n);throw new Y(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function pw(n,e){if(e<=0)throw new Y(U.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Y(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Al{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new qP;switch(r.type){case"firstParty":return new HP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=n_.get(t);r&&(J("ComponentProvider","Removing Datastore"),n_.delete(t),r.terminate())}(this),Promise.resolve()}}function YR(n,e,t,r={}){var s;const i=(n=Be(n,Al))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&zn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Yt.MOCK_USER;else{a=yA(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Y(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Yt(u)}n._authCredentials=new zP(new _v(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dn(this.firestore,e,this._query)}}class Lt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lt(this.firestore,e,this._key)}}class hr extends dn{constructor(e,t,r){super(e,t,ko(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new he(e))}withConverter(e){return new hr(this.firestore,e,this._path)}}function st(n,e,...t){if(n=we(n),Wf("collection","path",e),n instanceof Al){const r=Ge.fromString(e,...t);return s_(r),new hr(n,null,r)}{if(!(n instanceof Lt||n instanceof hr))throw new Y(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ge.fromString(e,...t));return s_(r),new hr(n.firestore,null,r)}}function eL(n,e){if(n=Be(n,Al),Wf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Y(U.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dn(n,null,function(r){return new qr(Ge.emptyPath(),r)}(e))}function Fe(n,e,...t){if(n=we(n),arguments.length===1&&(e=vv.newId()),Wf("doc","path",e),n instanceof Al){const r=Ge.fromString(e,...t);return r_(r),new Lt(n,null,new he(r))}{if(!(n instanceof Lt||n instanceof hr))throw new Y(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ge.fromString(e,...t));return r_(r),new Lt(n.firestore,n instanceof hr?n.converter:null,new he(r))}}function tL(n,e){return n=we(n),e=we(e),(n instanceof Lt||n instanceof hr)&&(e instanceof Lt||e instanceof hr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function mw(n,e){return n=we(n),e=we(e),n instanceof dn&&e instanceof dn&&n.firestore===e.firestore&&yl(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new kf(this,"async_queue_retry"),this.Vu=()=>{const r=Sc();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Sc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Sc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Zt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Vs(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Nt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=Of.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&pe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Vh(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class XR{constructor(){this._progressObserver={},this._taskCompletionResolver=new Zt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nL=-1;class ht extends Al{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new o_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new o_(e),this._firestoreClient=void 0,await e}}}function rL(n,e,t){t||(t="(default)");const r=ml(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(Is(i,e))return s;throw new Y(U.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Y(U.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function ZR(n,e){const t=typeof n=="object"?n:lv(),r=typeof n=="string"?n:e||"(default)",s=ml(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=gA("firestore");i&&YR(s,...i)}return s}function St(n){if(n._terminated)throw new Y(U.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||gw(n),n._firestoreClient}function gw(n){var e,t,r;const s=n._freezeSettings(),i=function(a,c,u,d){return new ES(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,fw(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new FR(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(n._componentsProvider))}function sL(n,e){zn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return _w(n,Rs.provider,{build:r=>new Gf(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function iL(n){zn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();_w(n,Rs.provider,{build:t=>new aw(t,e.cacheSizeBytes)})}function _w(n,e,t){if((n=Be(n,ht))._firestoreClient||n._terminated)throw new Y(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Y(U.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},gw(n)}function oL(n){if(n._initialized&&!n._terminated)throw new Y(U.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Zt;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!ur.D())return Promise.resolve();const s=r+"main";await ur.delete(s)}(xf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function aL(n){return function(t){const r=new Zt;return t.asyncQueue.enqueueAndForget(async()=>IR(await Hf(t),r)),r.promise}(St(n=Be(n,ht)))}function lL(n){return UR(St(n=Be(n,ht)))}function cL(n){return BR(St(n=Be(n,ht)))}function uL(n){return RP(n.app,"firestore",n._databaseId.database),n._delete()}function dL(n,e){const t=St(n=Be(n,ht)),r=new XR;return GR(t,n._databaseId,e,r),r}function hL(n,e){return KR(St(n=Be(n,ht)),e).then(t=>t?new dn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class eC{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fi(Ct.fromBase64String(e))}catch(t){throw new Y(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new fi(Ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Y(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function fL(){return new gi("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Y(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Y(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pe(this._lat,e._lat)||Pe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=/^__.*__$/;class nC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Do(e,this.data,t,this.fieldTransforms)}}class yw{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe()}}class $u{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new $u(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return nu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(vw(this.Cu)&&tC.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class rC{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||El(e)}Qu(e,t,r,s=!1){return new $u({Cu:e,methodName:t,qu:r,path:wt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yi(n){const e=n._freezeSettings(),t=El(n._databaseId);return new rC(n._databaseId,!!e.ignoreUndefinedProperties,t)}function qu(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);np("Data must be an object, but it was:",o,r);const a=Iw(r,o);let c,u;if(i.merge)c=new Vn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=sl(e,f,t);if(!o.contains(g))throw new Y(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Tw(d,g)||d.push(g)}c=new Vn(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new nC(new un(a),c,u)}class Pl extends _i{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pl}}function ww(n,e,t){return new $u({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Jf extends _i{_toFieldTransform(e){return new wl(e.path,new _o)}isEqual(e){return e instanceof Jf}}class Yf extends _i{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=ww(this,e,!0),r=this.Ku.map(i=>vi(i,t)),s=new li(r);return new wl(e.path,s)}isEqual(e){return e instanceof Yf&&Is(this.Ku,e.Ku)}}class Xf extends _i{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=ww(this,e,!0),r=this.Ku.map(i=>vi(i,t)),s=new ci(r);return new wl(e.path,s)}isEqual(e){return e instanceof Xf&&Is(this.Ku,e.Ku)}}class Zf extends _i{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new yo(e.serializer,e0(e.serializer,this.$u));return new wl(e.path,t)}isEqual(e){return e instanceof Zf&&this.$u===e.$u}}function ep(n,e,t,r){const s=n.Qu(1,e,t);np("Data must be an object, but it was:",s,r);const i=[],o=un.empty();Ns(r,(c,u)=>{const d=zu(e,c,t);u=we(u);const f=s.Nu(d);if(u instanceof Pl)i.push(d);else{const g=vi(u,f);g!=null&&(i.push(d),o.set(d,g))}});const a=new Vn(i);return new yw(o,a,s.fieldTransforms)}function tp(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[sl(e,r,t)],c=[s];if(i.length%2!=0)throw new Y(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(sl(e,i[g])),c.push(i[g+1]);const u=[],d=un.empty();for(let g=a.length-1;g>=0;--g)if(!Tw(u,a[g])){const _=a[g];let C=c[g];C=we(C);const x=o.Nu(_);if(C instanceof Pl)u.push(_);else{const k=vi(C,x);k!=null&&(u.push(_),d.set(_,k))}}const f=new Vn(u);return new yw(d,f,o.fieldTransforms)}function bw(n,e,t,r=!1){return vi(t,n.Qu(r?4:3,e))}function vi(n,e){if(Ew(n=we(n)))return np("Unsupported field value:",e,n),Iw(n,e);if(n instanceof _i)return function(r,s){if(!vw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=vi(a,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return e0(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Pt.fromDate(r);return{timestampValue:vo(s.serializer,i)}}if(r instanceof Pt){const i=new Pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vo(s.serializer,i)}}if(r instanceof Qf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof fi)return{bytesValue:f0(s.serializer,r._byteString)};if(r instanceof Lt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ju)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return mf(a.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Bu(r)}`)}(n,e)}function Iw(n,e){const t={};return Dv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ns(n,(r,s)=>{const i=vi(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function Ew(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pt||n instanceof Qf||n instanceof fi||n instanceof Lt||n instanceof _i||n instanceof ju)}function np(n,e,t){if(!Ew(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Bu(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function sl(n,e,t){if((e=we(e))instanceof gi)return e._internalPath;if(typeof e=="string")return zu(n,e);throw nu("Field path arguments must be of type string or ",n,!1,void 0,t)}const sC=new RegExp("[~\\*/\\[\\]]");function zu(n,e,t){if(e.search(sC)>=0)throw nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gi(...e.split("."))._internalPath}catch{throw nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function nu(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Y(U.INVALID_ARGUMENT,a+n+c)}function Tw(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Gu("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class iC extends il{data(){return super.data()}}function Gu(n,e){return typeof e=="string"?zu(n,e):e instanceof gi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Y(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rp{}class Sl extends rp{}function sp(n,e,...t){let r=[];e instanceof rp&&r.push(e),r=r.concat(t),function(i){const o=i.filter(c=>c instanceof Uo).length,a=i.filter(c=>c instanceof xl).length;if(o>1||o>0&&a>0)throw new Y(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class xl extends Sl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new xl(e,t,r)}_apply(e){const t=this._parse(e);return xw(e._query,t),new dn(e.firestore,e.converter,bh(e._query,t))}_parse(e){const t=yi(e.firestore);return function(i,o,a,c,u,d,f){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Y(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){l_(f,d);const _=[];for(const C of f)_.push(a_(c,i,C));g={arrayValue:{values:_}}}else g=a_(c,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||l_(f,d),g=bw(a,o,f,d==="in"||d==="not-in");return Ke.create(u,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Pw(n,e,t){const r=e,s=Gu("where",n);return xl._create(s,r,t)}class Uo extends rp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Uo(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:at.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)xw(o,c),o=bh(o,c)}(e._query,t),new dn(e.firestore,e.converter,bh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function pL(...n){return n.forEach(e=>Rw("or",e)),Uo._create("or",n)}function mL(...n){return n.forEach(e=>Rw("and",e)),Uo._create("and",n)}class ip extends Sl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ip(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new Y(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Y(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new el(i,o)}(e._query,this._field,this._direction);return new dn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new qr(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function oC(n,e="asc"){const t=e,r=Gu("orderBy",n);return ip._create(r,t)}class Ku extends Sl{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Ku(e,t,r)}_apply(e){return new dn(e.firestore,e.converter,Kc(e._query,this._limit,this._limitType))}}function gL(n){return pw("limit",n),Ku._create("limit",n,"F")}function _L(n){return pw("limitToLast",n),Ku._create("limitToLast",n,"L")}class Hu extends Sl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Hu(e,t,r)}_apply(e){const t=Sw(e,this.type,this._docOrFields,this._inclusive);return new dn(e.firestore,e.converter,function(s,i){return new qr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function yL(...n){return Hu._create("startAt",n,!0)}function vL(...n){return Hu._create("startAfter",n,!1)}class Wu extends Sl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Wu(e,t,r)}_apply(e){const t=Sw(e,this.type,this._docOrFields,this._inclusive);return new dn(e.firestore,e.converter,function(s,i){return new qr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function wL(...n){return Wu._create("endBefore",n,!1)}function bL(...n){return Wu._create("endAt",n,!0)}function Sw(n,e,t,r){if(t[0]=we(t[0]),t[0]instanceof il)return function(i,o,a,c,u){if(!c)throw new Y(U.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of eo(i))if(f.field.isKeyField())d.push(oi(o,c.key));else{const g=c.data.field(f.field);if(Su(g))throw new Y(U.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const _=f.field.canonicalString();throw new Y(U.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(g)}return new Ps(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=yi(n.firestore);return function(o,a,c,u,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new Y(U.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let C=0;C<d.length;C++){const x=d[C];if(g[C].field.isKeyField()){if(typeof x!="string")throw new Y(U.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof x}`);if(!ff(o)&&x.indexOf("/")!==-1)throw new Y(U.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${x}' contains a slash.`);const k=o.path.child(Ge.fromString(x));if(!he.isDocumentKey(k))throw new Y(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);const N=new he(k);_.push(oi(a,N))}else{const k=bw(c,u,x);_.push(k)}}return new Ps(_,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function a_(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new Y(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ff(e)&&t.indexOf("/")!==-1)throw new Y(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ge.fromString(t));if(!he.isDocumentKey(r))throw new Y(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return oi(n,new he(r))}if(t instanceof Lt)return oi(n,t._key);throw new Y(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bu(t)}.`)}function l_(n,e){if(!Array.isArray(n)||n.length===0)throw new Y(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function xw(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Y(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Rw(n,e){if(!(e instanceof xl||e instanceof Uo))throw new Y(U.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Cw{convertValue(e,t="none"){switch(Ts(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw pe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ns(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>vt(o.doubleValue));return new ju(i)}convertGeoPoint(e){return new Qf(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=xu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ya(e));default:return null}}convertTimestamp(e){const t=Mr(e);return new Pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ge.fromString(e);ge(T0(r));const s=new ii(r.get(1),r.get(3)),i=new he(r.popFirst(5));return s.isEqual(t)||Nt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class aC extends Cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new fi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(n){return new rl("sum",sl("sum",n))}function EL(n){return new rl("avg",sl("average",n))}function lC(){return new rl("count")}function TL(n,e){var t,r;return n instanceof rl&&e instanceof rl&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function AL(n,e){return mw(n.query,e.query)&&Is(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Po extends il{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Gu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class xc extends Po{data(e={}){return super.data(e)}}class So{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Ys(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new xc(this._firestore,this._userDataWriter,r.key,r,new Ys(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Y(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new xc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ys(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new xc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ys(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:cC(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function cC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe()}}function PL(n,e){return n instanceof Po&&e instanceof Po?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof So&&e instanceof So&&n._firestore===e._firestore&&mw(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(n){n=Be(n,Lt);const e=Be(n.firestore,ht);return dw(St(e),n._key).then(t=>op(e,n,t))}class Ms extends Cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new fi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,t)}}function SL(n){n=Be(n,Lt);const e=Be(n.firestore,ht),t=St(e),r=new Ms(e);return jR(t,n._key).then(s=>new Po(e,r,n._key,s,new Ys(s!==null&&s.hasLocalMutations,!0),n.converter))}function xL(n){n=Be(n,Lt);const e=Be(n.firestore,ht);return dw(St(e),n._key,{source:"server"}).then(t=>op(e,n,t))}function It(n){n=Be(n,dn);const e=Be(n.firestore,ht),t=St(e),r=new Ms(e);return Aw(n._query),hw(t,n._query).then(s=>new So(e,r,n,s))}function RL(n){n=Be(n,dn);const e=Be(n.firestore,ht),t=St(e),r=new Ms(e);return $R(t,n._query).then(s=>new So(e,r,n,s))}function CL(n){n=Be(n,dn);const e=Be(n.firestore,ht),t=St(e),r=new Ms(e);return hw(t,n._query,{source:"server"}).then(s=>new So(e,r,n,s))}function Fn(n,e,t){n=Be(n,Lt);const r=Be(n.firestore,ht),s=Qu(n.converter,e,t);return Rl(r,[qu(yi(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,bt.none())])}function uC(n,e,t,...r){n=Be(n,Lt);const s=Be(n.firestore,ht),i=yi(s);let o;return o=typeof(e=we(e))=="string"||e instanceof gi?tp(i,"updateDoc",n._key,e,t,r):ep(i,"updateDoc",n._key,e),Rl(s,[o.toMutation(n._key,bt.exists(!0))])}function ru(n){return Rl(Be(n.firestore,ht),[new Vo(n._key,bt.none())])}function dC(n,e){const t=Be(n.firestore,ht),r=Fe(n),s=Qu(n.converter,e);return Rl(t,[qu(yi(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,bt.exists(!1))]).then(()=>r)}function kL(n,...e){var t,r,s;n=we(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Vh(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Vh(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let c,u,d;if(n instanceof Lt)u=Be(n.firestore,ht),d=ko(n._key.path),c={next:f=>{e[o]&&e[o](op(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Be(n,dn);u=Be(f.firestore,ht),d=f._query;const g=new Ms(u);c={next:_=>{e[o]&&e[o](new So(u,g,f,_))},error:e[o+1],complete:e[o+2]},Aw(n._query)}return function(g,_,C,x){const k=new Fu(x),N=new Uf(_,k,C);return g.asyncQueue.enqueueAndForget(async()=>Mf(await Ao(g),N)),()=>{k.Za(),g.asyncQueue.enqueueAndForget(async()=>Lf(await Ao(g),N))}}(St(u),d,a,c)}function DL(n,e){return zR(St(n=Be(n,ht)),Vh(e)?e:{next:e})}function Rl(n,e){return function(r,s){const i=new Zt;return r.asyncQueue.enqueueAndForget(async()=>yR(await Hf(r),s,i)),i.promise}(St(n),e)}function op(n,e,t){const r=t.docs.get(e._key),s=new Ms(n);return new Po(n,s,e._key,r,new Ys(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(n){return hC(n,{count:lC()})}function hC(n,e){const t=Be(n.firestore,ht),r=St(t),s=kv(e,(i,o)=>new a0(o,i.aggregateType,i._internalFieldPath));return qR(r,n._query,s).then(i=>function(a,c,u){const d=new Ms(a);return new eC(c,d,u)}(t,n,i))}class fC{constructor(e){this.kind="memory",this._onlineComponentProvider=Rs.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=xs.provider}toJSON(){return{kind:this.kind}}}class pC{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=vC(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class mC{constructor(){this.kind="memoryEager",this._offlineComponentProvider=xs.provider}toJSON(){return{kind:this.kind}}}class gC{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new NR(e)}}toJSON(){return{kind:this.kind}}}function NL(){return new mC}function OL(n){return new gC(n==null?void 0:n.cacheSizeBytes)}function ML(n){return new fC(n)}function LL(n){return new pC(n)}class _C{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Rs.provider,this._offlineComponentProvider={build:t=>new Gf(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class yC{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Rs.provider,this._offlineComponentProvider={build:t=>new aw(t,e==null?void 0:e.cacheSizeBytes)}}}function vC(n){return new _C(n==null?void 0:n.forceOwnership)}function FL(){return new yC}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=yi(e)}set(e,t,r){this._verifyNotCommitted();const s=us(e,this._firestore),i=Qu(s.converter,t,r),o=qu(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,bt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=us(e,this._firestore);let o;return o=typeof(t=we(t))=="string"||t instanceof gi?tp(this._dataReader,"WriteBatch.update",i._key,t,r,s):ep(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,bt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=us(e,this._firestore);return this._mutations=this._mutations.concat(new Vo(t._key,bt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Y(U.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function us(n,e){if((n=we(n)).firestore!==e)throw new Y(U.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=yi(t)}get(t){const r=us(t,this._firestore),s=new aC(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return pe();const o=i[0];if(o.isFoundDocument())return new il(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new il(this._firestore,s,r._key,null,r.converter);throw pe()})}set(t,r,s){const i=us(t,this._firestore),o=Qu(i.converter,r,s),a=qu(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=us(t,this._firestore);let a;return a=typeof(r=we(r))=="string"||r instanceof gi?tp(this._dataReader,"Transaction.update",o._key,r,s,i):ep(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=us(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=us(e,this._firestore),r=new Ms(this._firestore);return super.get(e).then(s=>new Po(this._firestore,r,t._key,s._document,new Ys(!1,!1),t.converter))}}function BL(n,e,t){n=Be(n,ht);const r=Object.assign(Object.assign({},wC),t);return function(i){if(i.maxAttempts<1)throw new Y(U.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const c=new Zt;return i.asyncQueue.enqueueAndForget(async()=>{const u=await uw(i);new LR(i.asyncQueue,u,a,o,c).au()}),c.promise}(St(n),s=>e(new IC(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(){return new Pl("deleteField")}function kw(){return new Jf("serverTimestamp")}function $L(...n){return new Yf("arrayUnion",n)}function qL(...n){return new Xf("arrayRemove",n)}function zL(n){return new Zf("increment",n)}function GL(n){return new ju(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(n){return St(n=Be(n,ht)),new bC(n,e=>Rl(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(n,e){const t=St(n=Be(n,ht));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return zn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(u){try{return JSON.parse(u)}catch(d){throw new Y(U.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const c of o.indexes){const u=c_(c,"collectionGroup"),d=[];if(Array.isArray(c.fields))for(const f of c.fields){const g=zu("setIndexConfiguration",c_(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new ti(g,2)):f.order==="ASCENDING"?d.push(new ti(g,0)):f.order==="DESCENDING"&&d.push(new ti(g,1))}a.push(new fo(fo.UNKNOWN_ID,u,d,po.empty()))}return a}(e);return HR(t,r)}function c_(n,e){if(typeof n[e]!="string")throw new Y(U.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function HL(n){var e;n=Be(n,ht);const t=u_.get(n);if(t)return t;if(((e=St(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new EC(n);return u_.set(n,r),r}function WL(n){Vw(n,!0)}function QL(n){Vw(n,!1)}function JL(n){QR(St(n._firestore)).then(e=>J("deleting all persistent cache indexes succeeded")).catch(e=>zn("deleting all persistent cache indexes failed",e))}function Vw(n,e){WR(St(n._firestore),e).then(t=>J(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>zn(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const u_=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(n){var e;const t=(e=St(Be(n.firestore,ht))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Du(t,wn(n._query))._t}function XL(n,e){var t;const r=kv(e,(i,o)=>new a0(o,i.aggregateType,i._internalFieldPath)),s=(t=St(Be(n.firestore,ht))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:w0(s,Gv(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return ap.instance.onExistenceFilterMismatch(e)}}class ap{constructor(){this.Uu=new Map}static get instance(){return hc||(hc=new ap,function(t){if(Hc)throw new Error("a TestingHooksSpi instance is already set");Hc=t}(hc)),hc}et(e){this.Uu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let hc=null;(function(e,t=!0){(function(s){Co=s})(Ro),uo(new si("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new ht(new GP(r.getProvider("auth-internal")),new WP(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Y(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ii(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),vs(Zm,"4.7.3",e),vs(Zm,"4.7.3","esm2017")})();function lp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF={PHONE:"phone",TOTP:"totp"},tF={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},nF={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},rF={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},sF={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function Nw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const iF=TC,AC=Nw,Ow=new pl("auth","Firebase",Nw()),oF={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=new of("@firebase/auth");function PC(n,...e){su.logLevel<=ze.WARN&&su.warn(`Auth (${Ro}): ${n}`,...e)}function Rc(n,...e){su.logLevel<=ze.ERROR&&su.error(`Auth (${Ro}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(n,...e){throw up(n,...e)}function Pn(n,...e){return up(n,...e)}function cp(n,e,t){const r=Object.assign(Object.assign({},AC()),{[e]:t});return new pl("auth","Firebase",r).create(e,{appName:n.name})}function en(n){return cp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Bo(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&On(n,"argument-error"),cp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function up(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Ow.create(n,...e)}function re(n,e,...t){if(!n)throw up(e,...t)}function lr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Rc(e),new Error(e)}function Fr(n,e){n||lr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function dp(){return d_()==="http:"||d_()==="https:"}function d_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dp()||IA()||"connection"in navigator)?navigator.onLine:!0}function xC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fr(t>e,"Short delay should be less than long delay!"),this.isMobile=vA()||EA()}get(){return SC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(n,e){Fr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=new Cl(3e4,6e4);function gt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function _t(n,e,t,r,s={}){return Lw(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=xo(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:c},i);return bA()||(u.referrerPolicy="no-referrer"),Mw.fetch()(Fw(n,n.config.apiHost,t,a),u)})}async function Lw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},RC),e);try{const s=new DC(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ea(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ea(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ea(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ea(n,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw cp(n,d,u);On(n,d)}}catch(s){if(s instanceof $r)throw s;On(n,"network-request-failed",{message:String(s)})}}async function Hr(n,e,t,r,s={}){const i=await _t(n,e,t,r,s);return"mfaPendingCredential"in i&&On(n,"multi-factor-auth-required",{_serverResponse:i}),i}function Fw(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?hp(n.config,s):`${n.config.apiScheme}://${s}`}function kC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class DC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Pn(this.auth,"network-request-failed")),CC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ea(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Pn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(n){return n!==void 0&&n.getResponse!==void 0}function f_(n){return n!==void 0&&n.enterprise!==void 0}class Uw{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VC(n){return(await _t(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Bw(n,e){return _t(n,"GET","/v2/recaptchaConfig",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NC(n,e){return _t(n,"POST","/v1/accounts:delete",e)}async function OC(n,e){return _t(n,"POST","/v1/accounts:update",e)}async function jw(n,e){return _t(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(n,e=!1){return we(n).getIdToken(e)}async function MC(n,e=!1){const t=we(n),r=await t.getIdToken(e),s=Yu(r);re(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Fa(Bd(s.auth_time)),issuedAtTime:Fa(Bd(s.iat)),expirationTime:Fa(Bd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Bd(n){return Number(n)*1e3}function Yu(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Rc("JWT malformed, contained fewer than 3 sections"),null;try{const s=Zy(t);return s?JSON.parse(s):(Rc("Failed to decode base64 JWT payload"),null)}catch(s){return Rc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function p_(n){const e=Yu(n);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ur(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof $r&&LC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function LC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fa(this.lastLoginAt),this.creationTime=Fa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function al(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Ur(n,jw(t,{idToken:r}));re(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?$w(i.providerUserInfo):[],a=BC(n.providerData,o),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Nh(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function UC(n){const e=we(n);await al(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function BC(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function $w(n){return n.map(e=>{var{providerId:t}=e,r=lp(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jC(n,e){const t=await Lw(n,{},async()=>{const r=xo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Fw(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Mw.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function $C(n,e){return _t(n,"POST","/v2/accounts:revokeToken",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):p_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){re(e.length!==0,"internal-error");const t=p_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await jC(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new no;return r&&(re(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(re(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(re(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new no,this.toJSON())}_performRefresh(){return lr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(n,e){re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=lp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new FC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ur(this,this.stsTokenManager.getToken(this.auth,e));return re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return MC(this,e)}reload(){return UC(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await al(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ot(this.auth.app))return Promise.reject(en(this.auth));const e=await this.getIdToken();return await Ur(this,NC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,c,u,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(s=t.email)!==null&&s!==void 0?s:void 0,_=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,C=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(a=t.tenantId)!==null&&a!==void 0?a:void 0,k=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,N=(u=t.createdAt)!==null&&u!==void 0?u:void 0,B=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:F,emailVerified:L,isAnonymous:$,providerData:ee,stsTokenManager:S}=t;re(F&&S,e,"internal-error");const I=no.fromJSON(this.name,S);re(typeof F=="string",e,"internal-error"),rs(f,e.name),rs(g,e.name),re(typeof L=="boolean",e,"internal-error"),re(typeof $=="boolean",e,"internal-error"),rs(_,e.name),rs(C,e.name),rs(x,e.name),rs(k,e.name),rs(N,e.name),rs(B,e.name);const P=new xr({uid:F,auth:e,email:g,emailVerified:L,displayName:f,isAnonymous:$,photoURL:C,phoneNumber:_,tenantId:x,stsTokenManager:I,createdAt:N,lastLoginAt:B});return ee&&Array.isArray(ee)&&(P.providerData=ee.map(R=>Object.assign({},R))),k&&(P._redirectEventId=k),P}static async _fromIdTokenResponse(e,t,r=!1){const s=new no;s.updateFromServerResponse(t);const i=new xr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await al(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];re(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?$w(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new no;a.updateFromIdToken(r);const c=new xr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Nh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=new Map;function Rr(n){Fr(n instanceof Function,"Expected a class definition");let e=m_.get(n);return e?(Fr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,m_.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}qw.type="NONE";const g_=qw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(n,e,t){return`firebase:${n}:${e}:${t}`}class ro{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Cc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Cc("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?xr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ro(Rr(g_),e,r);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Rr(g_);const o=Cc(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){const f=xr._fromJSON(e,d);u!==i&&(a=f),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ro(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new ro(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Qw(e))return"Blackberry";if(Jw(e))return"Webos";if(Gw(e))return"Safari";if((e.includes("chrome/")||Kw(e))&&!e.includes("edge/"))return"Chrome";if(Ww(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function zw(n=Ht()){return/firefox\//i.test(n)}function Gw(n=Ht()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Kw(n=Ht()){return/crios\//i.test(n)}function Hw(n=Ht()){return/iemobile/i.test(n)}function Ww(n=Ht()){return/android/i.test(n)}function Qw(n=Ht()){return/blackberry/i.test(n)}function Jw(n=Ht()){return/webos/i.test(n)}function fp(n=Ht()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function qC(n=Ht()){var e;return fp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function zC(){return TA()&&document.documentMode===10}function Yw(n=Ht()){return fp(n)||Ww(n)||Jw(n)||Qw(n)||/windows phone/i.test(n)||Hw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(n,e=[]){let t;switch(n){case"Browser":t=__(Ht());break;case"Worker":t=`${__(Ht())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ro}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KC(n,e={}){return _t(n,"GET","/v2/passwordPolicy",gt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=6;class WC{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:HC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new y_(this),this.idTokenSubscription=new y_(this),this.beforeStateQueue=new GC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ow,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Rr(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ro.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await jw(this,{idToken:e}),r=await xr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ot(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await al(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ot(this.app))return Promise.reject(en(this));const t=e?we(e):null;return t&&re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ot(this.app)?Promise.reject(en(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ot(this.app)?Promise.reject(en(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KC(this),t=new WC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await $C(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Rr(e)||this._popupRedirectResolver;re(t,this,"argument-error"),this.redirectPersistenceManager=await ro.create(this,[Rr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Xw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&PC(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function kt(n){return we(n)}class y_{constructor(e){this.auth=e,this.observer=null,this.addObserver=CA(t=>this.observer=t)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JC(n){kl=n}function pp(n){return kl.loadJS(n)}function YC(){return kl.recaptchaV2Script}function XC(){return kl.recaptchaEnterpriseScript}function ZC(){return kl.gapiScript}function Zw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const e1="recaptcha-enterprise",t1="NO_RECAPTCHA";class eb{constructor(e){this.type=e1,this.auth=kt(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Bw(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new Uw(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;f_(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(t1)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&f_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=XC();c.length!==0&&(c+=a),pp(c).then(()=>{s(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function v_(n,e,t,r=!1){const s=new eb(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ll(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await v_(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await v_(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}async function n1(n){const e=kt(n),t=await Bw(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Uw(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new eb(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(n,e){const t=ml(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Is(i,e??{}))return s;On(s,"already-initialized")}return t.initialize({options:e})}function s1(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Rr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function i1(n,e,t){const r=kt(n);re(r._canInitEmulator,r,"emulator-config-failed"),re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=tb(e),{host:o,port:a}=o1(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||a1()}function tb(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function o1(n){const e=tb(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:w_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:w_(o)}}}function w_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function a1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return lr("not implemented")}_getIdTokenResponse(e){return lr("not implemented")}_linkToIdToken(e,t){return lr("not implemented")}_getReauthenticationResolver(e){return lr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nb(n,e){return _t(n,"POST","/v1/accounts:resetPassword",gt(n,e))}async function l1(n,e){return _t(n,"POST","/v1/accounts:update",e)}async function c1(n,e){return _t(n,"POST","/v1/accounts:signUp",e)}async function u1(n,e){return _t(n,"POST","/v1/accounts:update",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d1(n,e){return Hr(n,"POST","/v1/accounts:signInWithPassword",gt(n,e))}async function Xu(n,e){return _t(n,"POST","/v1/accounts:sendOobCode",gt(n,e))}async function h1(n,e){return Xu(n,e)}async function f1(n,e){return Xu(n,e)}async function p1(n,e){return Xu(n,e)}async function m1(n,e){return Xu(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g1(n,e){return Hr(n,"POST","/v1/accounts:signInWithEmailLink",gt(n,e))}async function _1(n,e){return Hr(n,"POST","/v1/accounts:signInWithEmailLink",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl extends Dl{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new cl(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new cl(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ll(e,t,"signInWithPassword",d1);case"emailLink":return g1(e,{email:this._email,oobCode:this._password});default:On(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ll(e,r,"signUpPassword",c1);case"emailLink":return _1(e,{idToken:t,email:this._email,oobCode:this._password});default:On(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dr(n,e){return Hr(n,"POST","/v1/accounts:signInWithIdp",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="http://localhost";class Br extends Dl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Br(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):On("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=lp(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Br(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Dr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Dr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Dr(e,t)}buildRequest(){const e={requestUri:y1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=xo(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v1(n,e){return _t(n,"POST","/v1/accounts:sendVerificationCode",gt(n,e))}async function w1(n,e){return Hr(n,"POST","/v1/accounts:signInWithPhoneNumber",gt(n,e))}async function b1(n,e){const t=await Hr(n,"POST","/v1/accounts:signInWithPhoneNumber",gt(n,e));if(t.temporaryProof)throw Ea(n,"account-exists-with-different-credential",t);return t}const I1={USER_NOT_FOUND:"user-not-found"};async function E1(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Hr(n,"POST","/v1/accounts:signInWithPhoneNumber",gt(n,t),I1)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends Dl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ni({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ni({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return w1(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return b1(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return E1(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new ni({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function A1(n){const e=_a(ya(n)).link,t=e?_a(ya(e)).deep_link_id:null,r=_a(ya(n)).deep_link_id;return(r?_a(ya(r)).link:null)||r||t||e||n}class Vl{constructor(e){var t,r,s,i,o,a;const c=_a(ya(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,f=T1((s=c.mode)!==null&&s!==void 0?s:null);re(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=A1(e);try{return new Vl(t)}catch{return null}}}function lF(n){return Vl.parseLink(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){this.providerId=wi.PROVIDER_ID}static credential(e,t){return cl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Vl.parseLink(t);return re(r,"argument-error"),cl._fromEmailAndCode(e,r.code,r.tenantId)}}wi.PROVIDER_ID="password";wi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";wi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo extends Wr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class kc extends jo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return re("providerId"in t&&"signInMethod"in t,"argument-error"),Br._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return re(e.idToken||e.accessToken,"argument-error"),Br._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return kc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return kc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new kc(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends jo{constructor(){super("facebook.com")}static credential(e){return Br._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ds.credential(e.oauthAccessToken)}catch{return null}}}ds.FACEBOOK_SIGN_IN_METHOD="facebook.com";ds.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends jo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Br._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return hs.credential(t,r)}catch{return null}}}hs.GOOGLE_SIGN_IN_METHOD="google.com";hs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends jo{constructor(){super("github.com")}static credential(e){return Br._fromParams({providerId:fs.PROVIDER_ID,signInMethod:fs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fs.credentialFromTaggedObject(e)}static credentialFromError(e){return fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fs.credential(e.oauthAccessToken)}catch{return null}}}fs.GITHUB_SIGN_IN_METHOD="github.com";fs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1="http://localhost";class ul extends Dl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Dr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Dr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Dr(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new ul(r,i)}static _create(e,t){return new ul(e,t)}buildRequest(){return{requestUri:P1,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="saml.";class Oh extends Wr{constructor(e){re(e.startsWith(S1),"argument-error"),super(e)}static credentialFromResult(e){return Oh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Oh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=ul.fromJSON(e);return re(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return ul._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps extends jo{constructor(){super("twitter.com")}static credential(e,t){return Br._fromParams({providerId:ps.PROVIDER_ID,signInMethod:ps.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ps.credentialFromTaggedObject(e)}static credentialFromError(e){return ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ps.credential(t,r)}catch{return null}}}ps.TWITTER_SIGN_IN_METHOD="twitter.com";ps.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rb(n,e){return Hr(n,"POST","/v1/accounts:signUp",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await xr._fromIdTokenResponse(e,r,s),o=b_(r);return new Gn({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=b_(r);return new Gn({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function b_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x1(n){var e;if(Ot(n.app))return Promise.reject(en(n));const t=kt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Gn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await rb(t,{returnSecureToken:!0}),s=await Gn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu extends $r{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,iu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new iu(e,t,r,s)}}function sb(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?iu._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cF(n,e){const t=we(n);await Zu(!0,t,e);const{providerUserInfo:r}=await OC(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=ib(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function mp(n,e,t=!1){const r=await Ur(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Gn._forOperation(n,"link",r)}async function Zu(n,e,t){await al(e);const r=ib(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";re(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ob(n,e,t=!1){const{auth:r}=n;if(Ot(r.app))return Promise.reject(en(r));const s="reauthenticate";try{const i=await Ur(n,sb(r,s,e,n),t);re(i.idToken,r,"internal-error");const o=Yu(i.idToken);re(o,r,"internal-error");const{sub:a}=o;return re(n.uid===a,r,"user-mismatch"),Gn._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&On(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ab(n,e,t=!1){if(Ot(n.app))return Promise.reject(en(n));const r="signIn",s=await sb(n,r,e),i=await Gn._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function gp(n,e){return ab(kt(n),e)}async function R1(n,e){const t=we(n);return await Zu(!1,t,e.providerId),mp(t,e)}async function C1(n,e){return ob(we(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){return Hr(n,"POST","/v1/accounts:signInWithCustomToken",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uF(n,e){if(Ot(n.app))return Promise.reject(en(n));const t=kt(n),r=await k1(t,{token:e,returnSecureToken:!0}),s=await Gn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?_p._fromServerResponse(e,t):"totpInfo"in t?yp._fromServerResponse(e,t):On(e,"internal-error")}}class _p extends Nl{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new _p(t)}}class yp extends Nl{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new yp(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ed(n,e,t){var r;re(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),re(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(re(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(re(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vp(n){const e=kt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function D1(n,e,t){const r=kt(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&ed(r,s,t),await ll(r,s,"getOobCode",f1)}async function dF(n,e,t){await nb(we(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&vp(n),r})}async function hF(n,e){await u1(we(n),{oobCode:e})}async function V1(n,e){const t=we(n),r=await nb(t,{oobCode:e}),s=r.requestType;switch(re(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":re(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":re(r.mfaInfo,t,"internal-error");default:re(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=Nl._fromServerResponse(kt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function fF(n,e){const{data:t}=await V1(we(n),e);return t.email}async function N1(n,e,t){if(Ot(n.app))return Promise.reject(en(n));const r=kt(n),o=await ll(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rb).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&vp(n),c}),a=await Gn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function O1(n,e,t){return Ot(n.app)?Promise.reject(en(n)):gp(we(n),wi.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&vp(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pF(n,e,t){const r=kt(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){re(a.handleCodeInApp,r,"argument-error"),a&&ed(r,o,a)}i(s,t),await ll(r,s,"getOobCode",p1)}function mF(n,e){const t=Vl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function gF(n,e,t){if(Ot(n.app))return Promise.reject(en(n));const r=we(n),s=wi.credentialWithLink(e,t||ol());return re(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),gp(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(n,e){return _t(n,"POST","/v1/accounts:createAuthUri",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _F(n,e){const t=dp()?ol():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await M1(we(n),r);return s||[]}async function yF(n,e){const t=we(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&ed(t.auth,s,e);const{email:i}=await h1(t.auth,s);i!==n.email&&await n.reload()}async function vF(n,e,t){const r=we(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&ed(r.auth,i,t);const{email:o}=await m1(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L1(n,e){return _t(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wF(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=we(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Ur(r,L1(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function bF(n,e){const t=we(n);return Ot(t.auth.app)?Promise.reject(en(t.auth)):lb(t,e,null)}function F1(n,e){return lb(we(n),null,e)}async function lb(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await Ur(n,l1(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(n){var e,t;if(!n)return null;const{providerId:r}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=Yu(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new so(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new B1(i,s);case"github.com":return new j1(i,s);case"google.com":return new $1(i,s);case"twitter.com":return new q1(i,s,n.screenName||null);case"custom":case"anonymous":return new so(i,null);default:return new so(i,r,s)}}class so{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class cb extends so{constructor(e,t,r,s){super(e,t,r),this.username=s}}class B1 extends so{constructor(e,t){super(e,"facebook.com",t)}}class j1 extends cb{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class $1 extends so{constructor(e,t){super(e,"google.com",t)}}class q1 extends cb{constructor(e,t,r){super(e,"twitter.com",t,r)}}function IF(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:U1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF(n,e){return we(n).setPersistence(e)}function TF(n){return n1(n)}async function AF(n,e){return kt(n).validatePassword(e)}function z1(n,e,t,r){return we(n).onIdTokenChanged(e,t,r)}function G1(n,e,t){return we(n).beforeAuthStateChanged(e,t)}function PF(n,e,t,r){return we(n).onAuthStateChanged(e,t,r)}function SF(n){we(n).useDeviceLanguage()}function xF(n,e){return we(n).updateCurrentUser(e)}function RF(n){return we(n).signOut()}function CF(n,e){return kt(n).revokeAccessToken(e)}async function kF(n){return we(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Xs("enroll",e,t)}static _fromMfaPendingCredential(e){return new Xs("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Xs._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Xs._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=kt(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>Nl._fromServerResponse(r,a));re(s.mfaPendingCredential,r,"internal-error");const o=Xs._fromMfaPendingCredential(s.mfaPendingCredential);return new wp(o,i,async a=>{const c=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const u=Object.assign(Object.assign({},s),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":const d=await Gn._fromIdTokenResponse(r,t.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return re(t.user,r,"internal-error"),Gn._forOperation(t.user,t.operationType,u);default:On(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function DF(n,e){var t;const r=we(n),s=e;return re(e.customData.operationType,r,"argument-error"),re((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),wp._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n,e){return _t(n,"POST","/v2/accounts/mfaEnrollment:start",gt(n,e))}function H1(n,e){return _t(n,"POST","/v2/accounts/mfaEnrollment:finalize",gt(n,e))}function W1(n,e){return _t(n,"POST","/v2/accounts/mfaEnrollment:start",gt(n,e))}function Q1(n,e){return _t(n,"POST","/v2/accounts/mfaEnrollment:finalize",gt(n,e))}function J1(n,e){return _t(n,"POST","/v2/accounts/mfaEnrollment:withdraw",gt(n,e))}class bp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Nl._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new bp(e)}async getSession(){return Xs._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await Ur(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Ur(this.user,J1(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const jd=new WeakMap;function VF(n){const e=we(n);return jd.has(e)||jd.set(e,bp._fromUser(e)),jd.get(e)}const ou="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ou,"1"),this.storage.removeItem(ou),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1=1e3,X1=10;class db extends ub{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Yw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);zC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,X1):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Y1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}db.type="LOCAL";const Z1=db;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb extends ub{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hb.type="SESSION";const fb=hb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new td(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(t.origin,i)),c=await ek(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const u=nd("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(){return window}function nk(n){Bt().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(){return typeof Bt().WorkerGlobalScope<"u"&&typeof Bt().importScripts=="function"}async function rk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sk(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function ik(){return Ip()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="firebaseLocalStorageDb",ok=1,au="firebaseLocalStorage",mb="fbase_key";class Ol{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rd(n,e){return n.transaction([au],e?"readwrite":"readonly").objectStore(au)}function ak(){const n=indexedDB.deleteDatabase(pb);return new Ol(n).toPromise()}function Mh(){const n=indexedDB.open(pb,ok);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(au,{keyPath:mb})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(au)?e(r):(r.close(),await ak(),e(await Mh()))})})}async function I_(n,e,t){const r=rd(n,!0).put({[mb]:e,value:t});return new Ol(r).toPromise()}async function lk(n,e){const t=rd(n,!1).get(e),r=await new Ol(t).toPromise();return r===void 0?null:r.value}function E_(n,e){const t=rd(n,!0).delete(e);return new Ol(t).toPromise()}const ck=800,uk=3;class gb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mh(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>uk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ip()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=td._getInstance(ik()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await rk(),!this.activeServiceWorker)return;this.sender=new tk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mh();return await I_(e,ou,"1"),await E_(e,ou),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>I_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>lk(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>E_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=rd(s,!1).getAll();return new Ol(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ck)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gb.type="LOCAL";const dk=gb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(n,e){return _t(n,"POST","/v2/accounts/mfaSignIn:start",gt(n,e))}function fk(n,e){return _t(n,"POST","/v2/accounts/mfaSignIn:finalize",gt(n,e))}function pk(n,e){return _t(n,"POST","/v2/accounts/mfaSignIn:finalize",gt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=500,gk=6e4,fc=1e12;class _k{constructor(e){this.auth=e,this.counter=fc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new yk(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||fc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||fc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||fc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class yk{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;re(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=vk(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},gk)},mk))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function vk(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d=Zw("rcb"),wk=new Cl(3e4,6e4);class bk{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Bt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return re(Ik(t),e,"argument-error"),this.shouldResolveImmediately(t)&&h_(Bt().grecaptcha)?Promise.resolve(Bt().grecaptcha):new Promise((r,s)=>{const i=Bt().setTimeout(()=>{s(Pn(e,"network-request-failed"))},wk.get());Bt()[$d]=()=>{Bt().clearTimeout(i),delete Bt()[$d];const a=Bt().grecaptcha;if(!a||!h_(a)){s(Pn(e,"internal-error"));return}const c=a.render;a.render=(u,d)=>{const f=c(u,d);return this.counter++,f},this.hostLanguage=t,r(a)};const o=`${YC()}?${xo({onload:$d,render:"explicit",hl:t})}`;pp(o).catch(()=>{clearTimeout(i),s(Pn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Bt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Ik(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class Ek{async load(e){return new _k(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b="recaptcha",Tk={theme:"light",type:"image"};class NF{constructor(e,t,r=Object.assign({},Tk)){this.parameters=r,this.type=_b,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=kt(e),this.isInvisible=this.parameters.size==="invisible",re(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;re(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ek:new bk,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){re(!this.parameters.sitekey,this.auth,"argument-error"),re(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),re(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Bt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){re(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){re(dp()&&!Ip(),this.auth,"internal-error"),await Ak(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await VC(this.auth);re(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return re(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Ak(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ni._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function OF(n,e,t){if(Ot(n.app))return Promise.reject(en(n));const r=kt(n),s=await sd(r,e,we(t));return new Ep(s,i=>gp(r,i))}async function MF(n,e,t){const r=we(n);await Zu(!1,r,"phone");const s=await sd(r.auth,e,we(t));return new Ep(s,i=>R1(r,i))}async function LF(n,e,t){const r=we(n);if(Ot(r.auth.app))return Promise.reject(en(r.auth));const s=await sd(r.auth,e,we(t));return new Ep(s,i=>C1(r,i))}async function sd(n,e,t){var r;const s=await t.verify();try{re(typeof s=="string",n,"argument-error"),re(t.type===_b,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return re(o.type==="enroll",n,"internal-error"),(await K1(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{re(o.type==="signin",n,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return re(a,n,"missing-multi-factor-info"),(await hk(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await v1(n,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{t._reset()}}async function FF(n,e){const t=we(n);if(Ot(t.auth.app))return Promise.reject(en(t.auth));await mp(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.providerId=io.PROVIDER_ID,this.auth=kt(e)}verifyPhoneNumber(e,t){return sd(this.auth,e,we(t))}static credential(e,t){return ni._fromVerification(e,t)}static credentialFromResult(e){const t=e;return io.credentialFromTaggedObject(t)}static credentialFromError(e){return io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?ni._fromTokenResponse(t,r):null}}io.PROVIDER_ID="phone";io.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(n,e){return e?Rr(e):(re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp extends Dl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Dr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Dr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Dr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Pk(n){return ab(n.auth,new Tp(n),n.bypassAuthState)}function Sk(n){const{auth:e,user:t}=n;return re(t,e,"internal-error"),ob(t,new Tp(n),n.bypassAuthState)}async function xk(n){const{auth:e,user:t}=n;return re(t,e,"internal-error"),mp(t,new Tp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Pk;case"linkViaPopup":case"linkViaRedirect":return xk;case"reauthViaPopup":case"reauthViaRedirect":return Sk;default:On(this.auth,"internal-error")}}resolve(e){Fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=new Cl(2e3,1e4);async function UF(n,e,t){if(Ot(n.app))return Promise.reject(Pn(n,"operation-not-supported-in-this-environment"));const r=kt(n);Bo(n,e,Wr);const s=bi(r,t);return new Cr(r,"signInViaPopup",e,s).executeNotNull()}async function BF(n,e,t){const r=we(n);if(Ot(r.auth.app))return Promise.reject(Pn(r.auth,"operation-not-supported-in-this-environment"));Bo(r.auth,e,Wr);const s=bi(r.auth,t);return new Cr(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function jF(n,e,t){const r=we(n);Bo(r.auth,e,Wr);const s=bi(r.auth,t);return new Cr(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Cr extends yb{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Cr.currentPopupAction&&Cr.currentPopupAction.cancel(),Cr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){Fr(this.filter.length===1,"Popup operations only handle one event");const e=nd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Pn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Pn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Cr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Rk.get())};e()}}Cr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="pendingRedirect",Dc=new Map;class kk extends yb{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Dc.get(this.auth._key());if(!e){try{const r=await Dk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Dc.set(this.auth._key(),e)}return this.bypassAuthState||Dc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Dk(n,e){const t=wb(e),r=vb(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function Ap(n,e){return vb(n)._set(wb(e),"true")}function Vk(n,e){Dc.set(n._key(),e)}function vb(n){return Rr(n._redirectPersistence)}function wb(n){return Cc(Ck,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F(n,e,t){return Nk(n,e,t)}async function Nk(n,e,t){if(Ot(n.app))return Promise.reject(en(n));const r=kt(n);Bo(n,e,Wr),await r._initializationPromise;const s=bi(r,t);return await Ap(s,r),s._openRedirect(r,e,"signInViaRedirect")}function qF(n,e,t){return Ok(n,e,t)}async function Ok(n,e,t){const r=we(n);if(Bo(r.auth,e,Wr),Ot(r.auth.app))return Promise.reject(en(r.auth));await r.auth._initializationPromise;const s=bi(r.auth,t);await Ap(s,r.auth);const i=await Ib(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function zF(n,e,t){return Mk(n,e,t)}async function Mk(n,e,t){const r=we(n);Bo(r.auth,e,Wr),await r.auth._initializationPromise;const s=bi(r.auth,t);await Zu(!1,r,e.providerId),await Ap(s,r.auth);const i=await Ib(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function GF(n,e){return await kt(n)._initializationPromise,bb(n,e,!1)}async function bb(n,e,t=!1){if(Ot(n.app))return Promise.reject(en(n));const r=kt(n),s=bi(r,e),o=await new kk(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function Ib(n){const e=nd(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk=10*60*1e3;class Fk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Uk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Eb(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Pn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Lk&&this.cachedEventUids.clear(),this.cachedEventUids.has(T_(e))}saveEventToCache(e){this.cachedEventUids.add(T_(e)),this.lastProcessedEventTime=Date.now()}}function T_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Eb({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Uk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Eb(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bk(n,e={}){return _t(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$k=/^https?/;async function qk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Bk(n);for(const t of e)try{if(zk(t))return}catch{}On(n,"unauthorized-domain")}function zk(n){const e=ol(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!$k.test(t))return!1;if(jk.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk=new Cl(3e4,6e4);function A_(){const n=Bt().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Kk(n){return new Promise((e,t)=>{var r,s,i;function o(){A_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{A_(),t(Pn(n,"network-request-failed"))},timeout:Gk.get()})}if(!((s=(r=Bt().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Bt().gapi)===null||i===void 0)&&i.load)o();else{const a=Zw("iframefcb");return Bt()[a]=()=>{gapi.load?o():t(Pn(n,"network-request-failed"))},pp(`${ZC()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Vc=null,e})}let Vc=null;function Hk(n){return Vc=Vc||Kk(n),Vc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk=new Cl(5e3,15e3),Qk="__/auth/iframe",Jk="emulator/auth/iframe",Yk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Zk(n){const e=n.config;re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hp(e,Jk):`https://${n.config.authDomain}/${Qk}`,r={apiKey:e.apiKey,appName:n.name,v:Ro},s=Xk.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${xo(r).slice(1)}`}async function eD(n){const e=await Hk(n),t=Bt().gapi;return re(t,n,"internal-error"),e.open({where:document.body,url:Zk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Yk,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Pn(n,"network-request-failed"),a=Bt().setTimeout(()=>{i(o)},Wk.get());function c(){Bt().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nD=500,rD=600,sD="_blank",iD="http://localhost";class P_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oD(n,e,t,r=nD,s=rD){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},tD),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Ht().toLowerCase();t&&(a=Kw(u)?sD:t),zw(u)&&(e=e||iD,c.scrollbars="yes");const d=Object.entries(c).reduce((g,[_,C])=>`${g}${_}=${C},`,"");if(qC(u)&&a!=="_self")return aD(e||"",a),new P_(null);const f=window.open(e||"",a,d);re(f,n,"popup-blocked");try{f.focus()}catch{}return new P_(f)}function aD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lD="__/auth/handler",cD="emulator/auth/handler",uD=encodeURIComponent("fac");async function S_(n,e,t,r,s,i){re(n.config.authDomain,n,"auth-domain-config-required"),re(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ro,eventId:s};if(e instanceof Wr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",RA(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof jo){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await n._getAppCheckToken(),u=c?`#${uD}=${encodeURIComponent(c)}`:"";return`${dD(n)}?${xo(a).slice(1)}${u}`}function dD({config:n}){return n.emulator?hp(n,cD):`https://${n.authDomain}/${lD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="webStorageSupport";class hD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fb,this._completeRedirectFn=bb,this._overrideRedirectResult=Vk}async _openPopup(e,t,r,s){var i;Fr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await S_(e,t,r,ol(),s);return oD(e,o,nd())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await S_(e,t,r,ol(),s);return nk(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Fr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await eD(e),r=new Fk(e);return t.register("authEvent",s=>(re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(qd,{type:qd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[qd];o!==void 0&&t(!!o),On(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Yw()||Gw()||fp()}}const fD=hD;class Tb{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return lr("unexpected MultiFactorSessionType")}}}class Pp extends Tb{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Pp(e)}_finalizeEnroll(e,t,r){return H1(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return fk(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class pD{constructor(){}static assertion(e){return Pp._fromCredential(e)}}pD.FACTOR_ID="phone";class mD{static assertionForEnrollment(e,t){return dl._fromSecret(e,t)}static assertionForSignIn(e,t){return dl._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const r=e;re(typeof((t=r.user)===null||t===void 0?void 0:t.auth)<"u","internal-error");const s=await W1(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return Sp._fromStartTotpMfaEnrollmentResponse(s,r.user.auth)}}mD.FACTOR_ID="totp";class dl extends Tb{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new dl(t,void 0,e)}static _fromEnrollmentId(e,t){return new dl(t,e)}async _finalizeEnroll(e,t,r){return re(typeof this.secret<"u",e,"argument-error"),Q1(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){re(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return pk(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class Sp{constructor(e,t,r,s,i,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new Sp(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let s=!1;return(pc(e)||pc(t))&&(s=!0),s&&(pc(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),pc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function pc(n){return typeof n>"u"||(n==null?void 0:n.length)===0}var x_="@firebase/auth",R_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yD(n){uo(new si("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;re(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xw(n)},u=new QC(r,s,i,c);return s1(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),uo(new si("auth-internal",e=>{const t=kt(e.getProvider("auth").getImmediate());return(r=>new gD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vs(x_,R_,_D(n)),vs(x_,R_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=5*60,wD=nv("authIdTokenMaxAge")||vD;let C_=null;const bD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>wD)return;const s=t==null?void 0:t.token;C_!==s&&(C_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ID(n=lv()){const e=ml(n,"auth");if(e.isInitialized())return e.getImmediate();const t=r1(n,{popupRedirectResolver:fD,persistence:[dk,Z1,fb]}),r=nv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=bD(i.toString());G1(t,o,()=>o(t.currentUser)),z1(t,a=>o(a))}}const s=ev("auth");return s&&i1(t,`http://${s}`),t}function ED(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}JC({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Pn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",ED().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yD("Browser");const TD={apiKey:"AIzaSyDCqJRmxKiIzuAhgXsmXICCx_O65aujNa0",authDomain:"impro-selector.firebaseapp.com",projectId:"impro-selector",storageBucket:"impro-selector.appspot.com",messagingSenderId:"730278491306",appId:"1:730278491306:web:c966af1179221e91118cd3",measurementId:"G-3NB062D088"},Ab=av(TD),be=ZR(Ab),$o=ID(Ab);x1($o);async function AD(n,e){try{return(await N1($o,n,e)).user}catch(t){throw t}}async function PD(n,e){try{return(await O1($o,n,e)).user}catch(t){throw t}}async function SD(n){try{await D1($o,n)}catch(e){throw e}}async function xD(n){try{const e=$o.currentUser;if(e)await F1(e,n);else throw new Error("Aucun utilisateur connecté")}catch(e){throw e}}const kr=Object.freeze(Object.defineProperty({__proto__:null,auth:$o,createPlayerAccount:AD,db:be,resetPlayerPassword:SD,signInPlayer:PD,updatePlayerPassword:xD},Symbol.toStringTag,{value:"Module"})),qo="seasons";async function RD(n,e,t){return await dC(st(be,qo),{name:n,slug:e,pinCode:t,createdAt:kw()})}async function CD(n){return await ru(Fe(be,qo,n))}async function zd(){const n=sp(st(be,qo),oC("createdAt","desc"));return(await It(n)).docs.map(t=>({id:t.id,...t.data()}))}async function kD(n){const e=sp(st(be,qo),Pw("slug","==",n)),t=await It(e);if(!t.empty){const r=t.docs[0];return{id:r.id,...r.data()}}return null}async function lu(n,e){const t=await Ju(Fe(be,qo,n));return t.exists()?t.data().pinCode===e:!1}async function Lh(n){const e=await Ju(Fe(be,qo,n));return e.exists()?e.data().pinCode:null}const Gd=10*60*1e3,Kd="impro_selector_pin_session";class DD{constructor(){this.sessionData=this.loadSession()}loadSession(){try{const e=localStorage.getItem(Kd);if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<Gd)return t;this.clearSession()}}catch(e){console.error("Erreur lors du chargement de la session PIN:",e)}return null}saveSession(e,t){try{const r={seasonId:e,pinCode:t,timestamp:Date.now()};localStorage.setItem(Kd,JSON.stringify(r)),this.sessionData=r}catch(r){console.error("Erreur lors de la sauvegarde de la session PIN:",r)}}isPinCached(e){return this.sessionData?this.sessionData.seasonId===e&&this.sessionData.timestamp&&Date.now()-this.sessionData.timestamp<Gd:!1}getCachedPin(e){return this.isPinCached(e)?this.sessionData.pinCode:null}clearSession(){try{localStorage.removeItem(Kd),this.sessionData=null}catch(e){console.error("Erreur lors de la suppression de la session PIN:",e)}}getTimeRemaining(){if(!this.sessionData||!this.sessionData.timestamp)return 0;const e=Date.now()-this.sessionData.timestamp,t=Gd-e;return Math.max(0,Math.ceil(t/(60*1e3)))}isExpiringSoon(){return this.getTimeRemaining()<=2}}const kn=new DD,VD={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},ND={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},OD={class:"text-center mb-6"},MD={class:"text-gray-300"},LD={key:0,class:"mt-2 p-2 bg-green-900/20 border border-green-500/30 rounded-lg"},FD={class:"text-sm text-green-400"},UD={class:"mb-4 flex justify-center"},BD={class:"flex bg-gray-800 rounded-lg p-1"},jD={key:0,class:"mb-6"},$D={class:"mb-4"},qD={key:1,class:"mb-6"},zD={class:"flex justify-center space-x-3 mb-4"},GD={class:"grid grid-cols-3 gap-3 mb-4"},KD=["onClick"],HD={key:2,class:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-center"},WD={class:"flex justify-end space-x-3"},QD=["disabled"],Pb={__name:"PinModal",props:{show:{type:Boolean,default:!1},message:{type:String,default:"Veuillez saisir le code PIN à 4 chiffres"},error:{type:String,default:""},sessionInfo:{type:Object,default:null}},emits:["submit","cancel"],setup(n,{emit:e}){const t=n,r=e,s=K(""),i=K(""),o=K("direct"),a=K(null);Xn(()=>t.show,x=>{x&&(s.value="",i.value="",o.value==="direct"&&ri(()=>{var k;(k=a.value)==null||k.focus()}))}),Xn(o,x=>{x==="direct"&&t.show&&ri(()=>{var k;(k=a.value)==null||k.focus()})});function c(){s.value=s.value.replace(/[^0-9]/g,""),s.value.length>4&&(s.value=s.value.slice(0,4))}function u(x){s.value.length<4&&(s.value+=x.toString())}function d(){s.value=s.value.slice(0,-1)}function f(){s.value="",i.value=""}function g(){s.value.length===4&&r("submit",s.value)}function _(){r("cancel")}const C=x=>{t.show&&(x.key>="0"&&x.key<="9"?o.value==="keypad"&&u(parseInt(x.key)):x.key==="Backspace"?o.value==="keypad"&&d():x.key==="Enter"?g():x.key==="Escape"&&_())};return typeof window<"u"&&window.addEventListener("keydown",C),(x,k)=>n.show?(W(),Q("div",VD,[m("div",ND,[m("div",OD,[k[4]||(k[4]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"🔒")],-1)),k[5]||(k[5]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Code d'accès requis",-1)),m("p",MD,_e(n.message),1),n.sessionInfo?(W(),Q("div",LD,[m("p",FD," Session active : "+_e(n.sessionInfo.timeRemaining)+" min restantes ",1)])):Ae("",!0)]),m("div",UD,[m("div",BD,[m("button",{onClick:k[0]||(k[0]=N=>o.value="direct"),class:cr(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",o.value==="direct"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"])}," Saisie directe ",2),m("button",{onClick:k[1]||(k[1]=N=>o.value="keypad"),class:cr(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200",o.value==="keypad"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"])}," Pavé numérique ",2)])]),o.value==="direct"?(W(),Q("div",jD,[m("div",$D,[k[6]||(k[6]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN",-1)),Tt(m("input",{"onUpdate:modelValue":k[2]||(k[2]=N=>s.value=N),type:"password",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-center text-2xl font-mono tracking-widest",placeholder:"••••",onInput:c,onKeydown:[Tn(g,["enter"]),Tn(_,["escape"])],ref_key:"pinInput",ref:a},null,544),[[At,s.value]])]),k[7]||(k[7]=m("p",{class:"text-xs text-gray-400 text-center"},"Tapez directement votre code PIN à 4 chiffres",-1))])):(W(),Q("div",qD,[m("div",zD,[(W(),Q(Rt,null,sr(4,(N,B)=>m("div",{key:B,class:cr(["w-12 h-12 border-2 border-gray-600 rounded-lg flex items-center justify-center text-2xl font-bold text-white bg-gray-800",{"border-purple-500 bg-purple-900/20":s.value.length>B}])},_e(s.value[B]||"•"),3)),64))]),m("div",GD,[(W(),Q(Rt,null,sr([1,2,3,4,5,6,7,8,9],N=>m("button",{key:N,onClick:B=>u(N),class:"w-12 h-12 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold text-xl transition-all duration-200 hover:scale-105"},_e(N),9,KD)),64)),m("button",{onClick:f,class:"w-12 h-12 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold text-lg transition-all duration-200 hover:scale-105"}," C "),m("button",{onClick:k[3]||(k[3]=N=>u(0)),class:"w-12 h-12 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold text-xl transition-all duration-200 hover:scale-105"}," 0 "),m("button",{onClick:d,class:"w-12 h-12 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-bold text-lg transition-all duration-200 hover:scale-105"}," ← ")])])),i.value||t.error?(W(),Q("div",HD,_e(i.value||t.error),1)):Ae("",!0),m("div",WD,[m("button",{onClick:_,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:g,disabled:s.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Valider ",8,QD)])])])):Ae("",!0)}},JD={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},YD={class:"container mx-auto px-4 pb-16"},XD={class:"flex justify-center mb-12"},ZD={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto"},eV=["onClick"],tV={class:"text-2xl font-bold text-white mb-4 group-hover:text-purple-300 transition-colors"},nV=["onClick"],rV={key:0,class:"text-center py-16"},sV={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},iV={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},oV={class:"mb-6"},aV={class:"mb-6"},lV={class:"mb-6"},cV={class:"flex justify-end space-x-3"},uV=["disabled"],dV={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},hV={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},fV={class:"text-center mb-6"},pV={class:"text-gray-300"},mV={__name:"Home",setup(n){const e=K([]),t=sf(),r=K(!1),s=K(!1),i=K(""),o=K(""),a=K(""),c=K(null),u=K(!1),d=K(null),f=K("");vu(async()=>{e.value=await zd(),console.log("Saisons chargées:",e.value)});function g(R){t.push(`/season/${R}`)}function _(){i.value&&(o.value=i.value.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}function C(){a.value=a.value.replace(/[^0-9]/g,""),a.value.length>4&&(a.value=a.value.slice(0,4))}async function x(){if(!i.value.trim()||!o.value.trim()||!a.value.trim()){alert("Veuillez remplir tous les champs, y compris le code PIN à 4 chiffres");return}if(a.value.length!==4){alert("Le code PIN doit contenir exactement 4 chiffres");return}try{await RD(i.value.trim(),o.value.trim(),a.value.trim()),e.value=await zd(),k()}catch(R){console.error("Erreur lors de la création de la saison:",R),alert("Erreur lors de la création de la saison. Veuillez réessayer.")}}function k(){r.value=!1,i.value="",o.value="",a.value=""}function N(R){c.value=R,s.value=!0}async function B(){s.value=!1,await $({type:"deleteSeason",data:{seasonId:c.value.id,seasonName:c.value.name}})}function F(){s.value=!1,c.value=null}function L(){return d.value?{deleteSeason:"Suppression de saison - Code PIN requis"}[d.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function $(R){if(kn.isPinCached(c.value.id)){const w=kn.getCachedPin(c.value.id);if(console.log("PIN en cache trouvé, utilisation automatique"),await lu(c.value.id,w)){await P(R);return}else kn.clearSession()}d.value=R,u.value=!0}async function ee(R){var w,T,E;console.log("PIN soumis:",R,"pour l'opération:",d.value);try{const Re=((T=(w=d.value)==null?void 0:w.data)==null?void 0:T.seasonId)||((E=c.value)==null?void 0:E.id),Ye=await lu(Re,R);if(console.log("PIN valide:",Ye),Ye){kn.saveSession(Re,R),console.log("PIN correct, fermeture de la modal et exécution de l'opération"),u.value=!1;const je=d.value;d.value=null,console.log("Appel de executePendingOperation avec:",je),await P(je)}else f.value="Code PIN incorrect",setTimeout(()=>{f.value=""},3e3)}catch(Re){console.error("Erreur lors de la vérification du PIN:",Re),f.value="Erreur lors de la vérification du code PIN"}}function S(){u.value=!1,d.value=null,f.value=""}function I(){return c.value&&kn.isPinCached(c.value.id)?{timeRemaining:kn.getTimeRemaining(),isExpiringSoon:kn.isExpiringSoon()}:null}async function P(R){if(console.log("executePendingOperation appelé avec:",R),!R){console.log("Aucune opération à exécuter");return}const{type:w,data:T}=R;console.log("Exécution de l'opération:",w,"avec données:",T);try{switch(w){case"deleteSeason":console.log("Suppression de la saison ID:",T.seasonId),await CD(T.seasonId),console.log("Saison supprimée, rechargement de la liste..."),e.value=await zd(),console.log("Nouvelle liste des saisons:",e.value);break;default:console.log("Type d'opération non reconnu:",w)}}catch(E){console.error("Erreur lors de l'exécution de l'opération:",E),alert("Erreur lors de l'opération. Veuillez réessayer.")}}return(R,w)=>{var T;return W(),Q("div",JD,[w[20]||(w[20]=m("div",{class:"text-center py-16 px-4"},[m("h1",{class:"text-6xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent animate-pulse"}," Sélections Spectacle "),m("p",{class:"text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed"}," Gérez facilement les sélections pour vos spectacles. ")],-1)),m("div",YD,[m("div",XD,[m("button",{onClick:w[0]||(w[0]=E=>r.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-2xl hover:shadow-pink-500/25 transition-all duration-300 transform hover:scale-105"}," ✨ Nouvelle saison ")]),m("div",ZD,[(W(!0),Q(Rt,null,sr(e.value,E=>(W(),Q("div",{key:E.id,class:"group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm border border-white/20 rounded-2xl p-8 cursor-pointer hover:scale-105 transition-all duration-300 hover:shadow-2xl hover:shadow-purple-500/20"},[m("div",{onClick:Re=>g(E.slug),class:"text-center"},[w[5]||(w[5]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg"},[m("span",{class:"text-2xl"},"🎭")],-1)),m("h2",tV,_e(E.name),1),w[6]||(w[6]=m("div",{class:"w-full bg-gradient-to-r from-transparent via-white/20 to-transparent h-px mb-4"},null,-1)),w[7]||(w[7]=m("p",{class:"text-gray-300 text-sm"}," Cliquez pour accéder ",-1))],8,eV),m("button",{onClick:Wn(Re=>N(E),["stop"]),class:"absolute top-4 right-4 text-red-400 hover:text-red-300 hover:scale-110 transition-all duration-200 opacity-0 group-hover:opacity-100",title:"Supprimer cette saison"},w[8]||(w[8]=[m("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,nV)]))),128))]),e.value.length===0?(W(),Q("div",rV,[w[9]||(w[9]=m("div",{class:"w-24 h-24 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[m("span",{class:"text-4xl"},"🎪")],-1)),w[10]||(w[10]=m("h3",{class:"text-2xl font-bold text-white mb-4"},"Aucune saison créée",-1)),w[11]||(w[11]=m("p",{class:"text-gray-300 mb-8"},"Commencez par créer votre première saison de spectacles !",-1)),m("button",{onClick:w[1]||(w[1]=E=>r.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-xl hover:shadow-pink-500/25 transition-all duration-300"}," Créer ma première saison ")])):Ae("",!0)]),r.value?(W(),Q("div",sV,[m("div",iV,[w[16]||(w[16]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvelle saison",-1)),m("div",oV,[w[12]||(w[12]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom de la saison",-1)),Tt(m("input",{"onUpdate:modelValue":w[2]||(w[2]=E=>i.value=E),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: La Malice 2025-2026",onInput:_},null,544),[[At,i.value]])]),m("div",aV,[w[13]||(w[13]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Slug (URL)",-1)),Tt(m("input",{"onUpdate:modelValue":w[3]||(w[3]=E=>o.value=E),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: malice-2025-2026"},null,512),[[At,o.value]])]),m("div",lV,[w[14]||(w[14]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN (4 chiffres)",-1)),Tt(m("input",{"onUpdate:modelValue":w[4]||(w[4]=E=>a.value=E),type:"text",inputmode:"numeric",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"1234",onInput:C},null,544),[[At,a.value]]),w[15]||(w[15]=m("p",{class:"text-xs text-gray-400 mt-1"},"Ce code protégera les opérations sensibles (suppressions, sélections)",-1))]),m("div",cV,[m("button",{onClick:k,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:x,disabled:!i.value.trim()||!o.value.trim()||!a.value.trim()||a.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Créer ",8,uV)])])])):Ae("",!0),s.value?(W(),Q("div",dV,[m("div",hV,[m("div",fV,[w[17]||(w[17]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"⚠️")],-1)),w[18]||(w[18]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Confirmation",-1)),m("p",pV,'Êtes-vous sûr de vouloir supprimer la saison "'+_e((T=c.value)==null?void 0:T.name)+'" ?',1)]),w[19]||(w[19]=m("p",{class:"mb-6 text-sm text-red-400 bg-red-900/20 p-3 rounded-lg border border-red-500/20"}," ⚠️ Cette action est irréversible et supprimera toutes les données de cette saison. ",-1)),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:F,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:B,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):Ae("",!0),jt(Pb,{show:u.value,message:L(),error:f.value,"session-info":I(),onSubmit:ee,onCancel:S},null,8,["show","message","error","session-info"])])}}};let Sn="mock";const pi=[{id:"p1",name:"Alice"},{id:"p2",name:"Bob"},{id:"p3",name:"Charlie"},{id:"p4",name:"David"},{id:"p5",name:"Eva"},{id:"p6",name:"Fanny"},{id:"p7",name:"Georges"},{id:"p8",name:"Hélène"},{id:"p9",name:"Ismaël"},{id:"p10",name:"Jade"},{id:"p11",name:"Karim"},{id:"p12",name:"Léa"},{id:"p13",name:"Marc"},{id:"p14",name:"Nina"},{id:"p15",name:"Oscar"}],mi=[{id:"event1",title:"Apérock Septembre",date:"2025-09-08",description:"Soirée apéro-rock avec ambiance festive"},{id:"event2",title:"Match à Cambo",date:"2025-11-25",description:"Match d'improvisation compétitif à Cambo-les-Bains"},{id:"event3",title:"Impro des Familles",date:"2025-12-02",description:"Spectacle d'improvisation pour toute la famille"},{id:"event4",title:"Cabaret Surprise",date:"2026-01-20",description:"Cabaret avec des surprises et des performances uniques"},{id:"event5",title:"Impro Plage",date:"2026-03-10",description:"Improvisation en plein air avec vue sur la plage"}];function gV(n){Sn=n}async function _V(){if(Sn!=="firebase"||!(await It(st(be,"seasons"))).empty)return;const e=Fe(st(be,"seasons"));await Fn(e,{name:"Malice 2025-2026",slug:"malice-2025-2026",createdAt:kw()});const t=await It(st(be,"players"));for(const o of t.docs)await Fn(Fe(e,"players",o.id),o.data());const r=await It(st(be,"events"));for(const o of r.docs)await Fn(Fe(e,"events",o.id),o.data());const s=await It(st(be,"availability"));for(const o of s.docs)await Fn(Fe(e,"availability",o.id),o.data());const i=await It(st(be,"selections"));for(const o of i.docs)await Fn(Fe(e,"selections",o.id),o.data())}async function yV(){Sn==="firebase"&&await _V()}async function k_(n=null){return(Sn==="firebase"?n?(await It(st(be,"seasons",n,"events"))).docs.map(t=>({id:t.id,...t.data()})):(await It(st(be,"events"))).docs.map(t=>({id:t.id,...t.data()})):mi).sort((t,r)=>{const s=new Date(t.date),i=new Date(r.date);return s<i?-1:s>i?1:t.title.localeCompare(r.title)})}async function Hd(n=null){return(Sn==="firebase"?n?(await It(st(be,"seasons",n,"players"))).docs.map(t=>({id:t.id,...t.data()})):(await It(st(be,"players"))).docs.map(t=>({id:t.id,...t.data()})):pi).sort((t,r)=>t.order<r.order?-1:t.order>r.order?1:t.name.localeCompare(r.name))}async function vV(n,e=null){if(Sn==="firebase"){const t=Fe(e?st(be,"seasons",e,"players"):st(be,"players"));return await Fn(t,{name:n}),t.id}else{const t=`p${pi.length+1}`;return pi.push({id:t,name:n}),t}}async function wV(n,e=null){if(Sn==="firebase"){const t=e?Fe(be,"seasons",e,"players",n):Fe(be,"players",n);await ru(t);const r=e?await It(st(be,"seasons",e,"availability")):await It(st(be,"availability")),s=Dw(be);r.forEach(i=>{const o=i.data();if(o[n]!==void 0){const a={...o};delete a[n],s.update(i.ref,a)}}),await s.commit()}else pi=pi.filter(t=>t.id!==n)}async function bV(n,e,t=null){if(Sn==="firebase"){const r=t?Fe(be,"seasons",t,"players",n):Fe(be,"players",n);await Fn(r,{name:e})}else{const r=pi.findIndex(s=>s.id===n);r!==-1&&(pi[r]=e)}}async function pa(n,e,t=null){if(Sn==="firebase"){const r=t?await It(st(be,"seasons",t,"availability")):await It(st(be,"availability")),s={};return r.forEach(i=>{s[i.id]=i.data()}),s}else{const r={};return n.forEach(s=>{r[s.name]={},e.forEach(i=>{r[s.name][i.id]=void 0})}),e.forEach(s=>{const i=[...n].sort(()=>.5-Math.random());i.slice(0,4).forEach(o=>{r[o.name][s.id]=!0}),i.slice(4).forEach(o=>{const a=Math.random();r[o.name][s.id]=a<.4?!0:a<.8?!1:void 0})}),r}}async function ma(n=null){if(Sn==="firebase"){const e=n?await It(st(be,"seasons",n,"selections")):await It(st(be,"selections")),t={};return e.forEach(r=>{t[r.id]=r.data().players||[]}),t}else return{}}async function D_(n,e,t=null){if(Sn==="firebase"){const r=t?Fe(be,"seasons",t,"availability",n):Fe(be,"availability",n);await Fn(r,e)}}async function IV(n,e,t=null){if(Sn==="firebase"){const r=t?Fe(be,"seasons",t,"selections",n):Fe(be,"selections",n);await Fn(r,{players:e})}}async function EV(n,e=null){if(console.log("Suppression de l'événement:",n),Sn==="firebase")try{console.log("Suppression de l'événement dans Firestore");const t=e?Fe(be,"seasons",e,"events",n):Fe(be,"events",n);await ru(t),console.log("Suppression de la sélection associée");const r=e?Fe(be,"seasons",e,"selections",n):Fe(be,"selections",n);await ru(r),console.log("Suppression des disponibilités");const s=e?await It(st(be,"seasons",e,"availability")):await It(st(be,"availability")),i=Dw(be);s.forEach(o=>{const a=o.data();if(a[n]!==void 0){console.log("Mise à jour de la disponibilité pour:",o.id);const c={...a};delete c[n],i.update(o.ref,c)}}),await i.commit(),console.log("Opérations de suppression terminées avec succès")}catch(t){throw console.error("Erreur lors de la suppression:",t),t}else mi=mi.filter(t=>t.id!==n)}async function TV(n,e=null){if(Sn==="firebase"){const t=Fe(e?st(be,"seasons",e,"events"):st(be,"events"));return await Fn(t,n),t.id}else{const t=`event${mi.length+1}`;return mi.push({id:t,...n}),t}}async function AV(n,e,t=null){if(Sn==="firebase"){const r=t?Fe(be,"seasons",t,"events",n):Fe(be,"events",n);await Fn(r,e)}else{const r=mi.findIndex(s=>s.id===n);r!==-1&&(mi[r]={id:n,...e})}}const PV="modulepreload",SV=function(n){return"/impro-selector/"+n},V_={},Xt=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=SV(i),i in V_)return;V_[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":PV,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};class xV{constructor(){this.sessions=new Map,this.sessionDuration=10*60*1e3}isPasswordCached(e){const t=this.sessions.get(e);return t?Date.now()-t.timestamp>this.sessionDuration?(this.sessions.delete(e),!1):!0:!1}getCachedPassword(e){const t=this.sessions.get(e);return t?Date.now()-t.timestamp>this.sessionDuration?(this.sessions.delete(e),null):t.password:null}saveSession(e,t){this.sessions.set(e,{password:t,timestamp:Date.now()})}clearSession(e){this.sessions.delete(e)}clearExpiredSessions(){const e=Date.now();for(const[t,r]of this.sessions.entries())e-r.timestamp>this.sessionDuration&&this.sessions.delete(t)}clearAllSessions(){this.sessions.clear()}}const Sb=new xV;function xp(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return e.toString()}async function RV(n,e,t,r=null){try{console.log("🔍 [DEBUG] Début protectPlayer:",{playerId:n,email:e,seasonId:r});const s=await zo(n,r);if(s&&s.isProtected)throw new Error("Ce joueur est déjà protégé");const{collection:i,query:o,where:a,getDocs:c}=await Xt(()=>import("./index.esm-f9faeef0.js"),[]),{db:u}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),d=r?i(u,"seasons",r,"playerProtection"):i(u,"playerProtection"),f=o(d,a("email","==",e)),g=await c(f);if(!g.empty&&g.docs.find(F=>F.id!==n))throw new Error("Cette adresse email est déjà utilisée par un autre joueur");console.log("🔍 [DEBUG] Création du compte Firebase Auth...");const{createUserWithEmailAndPassword:_}=await Xt(()=>import("./index.esm-a4603d05.js"),[]),{auth:C}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),x=await _(C,e,t);console.log("🔍 [DEBUG] Compte Firebase Auth créé:",x.user.uid);const k=xp(t),N=r?Fe(u,"seasons",r,"playerProtection",n):Fe(u,"playerProtection",n);return await Fn(N,{playerId:n,email:e,passwordHash:k,firebaseUid:x.user.uid,isProtected:!0,createdAt:new Date}),console.log("🔍 [DEBUG] Protection sauvegardée dans Firestore"),{success:!0}}catch(s){throw console.error("❌ [ERROR] Erreur lors de la protection du joueur:",s),s}}async function CV(n,e=null){try{const t=e?Fe(be,"seasons",e,"playerProtection",n):Fe(be,"playerProtection",n),r=await zo(n,e),s=(r==null?void 0:r.email)||"";return await Fn(t,{playerId:n,email:s,isProtected:!1,updatedAt:new Date}),{success:!0,email:s}}catch(t){throw console.error("Erreur lors de la suppression de la protection:",t),t}}async function oo(n,e=null){try{const t=e?Fe(be,"seasons",e,"playerProtection",n):Fe(be,"playerProtection",n),r=await Ju(t);return r.exists()?r.data().isProtected===!0:!1}catch(t){return console.error("Erreur lors de la vérification de protection:",t),!1}}async function zo(n,e=null){try{const t=e?Fe(be,"seasons",e,"playerProtection",n):Fe(be,"playerProtection",n),r=await Ju(t);return r.exists()?r.data():null}catch(t){return console.error("Erreur lors de la récupération des données de protection:",t),null}}async function kV(n,e=null){try{const t=await zo(n,e);return(t==null?void 0:t.email)||""}catch(t){return console.error("Erreur lors de la récupération de l'email:",t),""}}async function cu(n,e,t=null){try{const r=await zo(n,t);if(!r||!r.isProtected)return!1;const s=xp(e),i=r.passwordHash===s;return i&&Sb.saveSession(n,e),i}catch(r){return console.error("Erreur lors de la vérification du mot de passe:",r),!1}}function Ua(n){return Sb.isPasswordCached(n)}async function Fh(n,e=null){try{console.log("🔍 [DEBUG] Début sendPasswordResetEmail:",{playerId:n,seasonId:e});const t=await zo(n,e);if(console.log("🔍 [DEBUG] Protection data:",t),!t||!t.isProtected)throw new Error("Joueur non protégé");if(console.log("🔍 [DEBUG] Email à utiliser:",t.email),t.firebaseUid){console.log("🔍 [DEBUG] Utilisation du compte Firebase Auth existant");const{sendPasswordResetEmail:r}=await Xt(()=>import("./index.esm-a4603d05.js"),[]),{auth:s}=await Xt(()=>Promise.resolve().then(()=>kr),void 0);console.log("🔍 [DEBUG] Tentative d'envoi d'email à:",t.email),await r(s,t.email),console.log("🔍 [DEBUG] Email envoyé avec succès via Firebase Auth!"),console.log("🔍 [DEBUG] Vérifiez votre boîte mail:",t.email)}else{console.log("🔍 [DEBUG] Pas de compte Firebase Auth, création temporaire...");const{createUserWithEmailAndPassword:r,sendPasswordResetEmail:s}=await Xt(()=>import("./index.esm-a4603d05.js"),[]),{auth:i}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),o=Math.random().toString(36).slice(-8)+"A1!";try{const a=await r(i,t.email,o);console.log("🔍 [DEBUG] Compte temporaire créé:",a.user.uid),await s(i,t.email),console.log("🔍 [DEBUG] Email envoyé avec succès!");const{updateDoc:c}=await Xt(()=>import("./index.esm-f9faeef0.js"),[]),{db:u}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),d=e?Fe(u,"seasons",e,"playerProtection",n):Fe(u,"playerProtection",n);await c(d,{firebaseUid:a.user.uid})}catch(a){if(a.code==="auth/email-already-in-use")console.log("🔍 [DEBUG] Email déjà utilisé, tentative d'envoi direct..."),await s(i,t.email),console.log("🔍 [DEBUG] Email envoyé avec succès!");else throw a}}return{success:!0,message:"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}}catch(t){throw console.error("❌ [ERROR] Erreur lors de l'envoi de l'email de réinitialisation:",t),console.error("❌ [ERROR] Code d'erreur:",t.code),console.error("❌ [ERROR] Message d'erreur:",t.message),t.code==="auth/user-not-found"?new Error("Aucun compte trouvé avec cette adresse email"):t.code==="auth/too-many-requests"?new Error("Trop de tentatives. Veuillez réessayer plus tard"):t.code==="auth/invalid-email"?new Error("Adresse email invalide"):new Error(`Erreur lors de l'envoi de l'email: ${t.message}`)}}async function DV(n,e,t=null){try{const r=xp(e),s=t?Fe(be,"seasons",t,"playerProtection",n):Fe(be,"playerProtection",n);return await uC(s,{passwordHash:r,updatedAt:new Date}),{success:!0}}catch(r){throw console.error("Erreur lors de la mise à jour du mot de passe:",r),r}}const VV={class:"text-center mb-6"},NV={class:"text-lg text-gray-300"},OV={class:"mb-6"},MV={class:"flex items-center space-x-3"},LV={class:"text-2xl"},FV={class:"font-semibold text-white"},UV={class:"text-sm text-gray-300"},BV={class:"mb-6"},jV={key:0,class:"mt-2 p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg text-sm text-gray-300 space-y-1"},$V={key:0,class:"mb-6"},qV={class:"space-y-4"},zV=["disabled"],GV={key:0,class:"animate-spin"},KV={key:1},HV={key:1,class:"mb-6"},WV={key:0,class:"space-y-4 mb-4"},QV=["disabled"],JV={key:0,class:"animate-spin"},YV={key:1},XV=["disabled"],ZV={key:2,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},eN={class:"text-red-300 text-sm"},tN={key:3,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},nN={class:"text-green-300 text-sm"},rN={__name:"PlayerProtectionModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","update"],setup(n,{emit:e}){const t=n,r=e,s=K(!1),i=K(""),o=K(""),a=K(""),c=K(!1),u=K(""),d=K(""),f=K(!1),g=K(!1),_=K(""),C=cn(()=>i.value&&o.value&&a.value&&o.value===a.value&&o.value.length>=6&&i.value.includes("@"));async function x(){var L;if((L=t.player)!=null&&L.id&&(s.value=await oo(t.player.id,t.seasonId),!s.value)){const $=await kV(t.player.id,t.seasonId);$&&(i.value=$)}}async function k(){if(C.value){c.value=!0,u.value="",d.value="";try{await RV(t.player.id,i.value,o.value,t.seasonId),d.value="Protection activée avec succès !",s.value=!0,i.value="",o.value="",a.value="",r("update")}catch(L){console.error("Erreur lors de l'activation de la protection:",L),L.message&&L.message.includes("email")?u.value="Cette adresse email est déjà utilisée par un autre joueur.":u.value="Erreur lors de l'activation de la protection. Veuillez réessayer."}finally{c.value=!1}}}function N(){g.value=!0,_.value="",u.value=""}async function B(){if(_.value){c.value=!0,u.value="",d.value="";try{if(!await cu(t.player.id,_.value,t.seasonId)){u.value="Mot de passe incorrect. Veuillez réessayer.";return}const $=await CV(t.player.id,t.seasonId);d.value="Protection désactivée avec succès !",s.value=!1,g.value=!1,_.value="",$.email&&(i.value=$.email),r("update")}catch(L){console.error("Erreur lors de la désactivation de la protection:",L),u.value="Erreur lors de la désactivation de la protection. Veuillez réessayer."}finally{c.value=!1}}}function F(){r("close")}return Xn(()=>t.player,()=>{t.show&&t.player&&x()},{immediate:!0}),Xn(()=>t.show,L=>{L&&t.player&&(o.value="",a.value="",u.value="",d.value="",f.value=!1,g.value=!1,_.value="",x())}),(L,$)=>{var ee;return n.show?(W(),Q("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4",onClick:F},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:$[6]||($[6]=Wn(()=>{},["stop"]))},[m("div",VV,[$[7]||($[7]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"🔒")],-1)),$[8]||($[8]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Protection du joueur",-1)),m("p",NV,_e((ee=n.player)==null?void 0:ee.name),1)]),m("div",OV,[m("div",{class:cr(["flex items-center justify-between p-4 rounded-lg",s.value?"bg-green-500/20 border border-green-500/30":"bg-gray-500/20 border border-gray-500/30"])},[m("div",MV,[m("span",LV,_e(s.value?"🔒":"🔓"),1),m("div",null,[m("div",FV,_e(s.value?"Protégé":"Non protégé"),1),m("div",UV,_e(s.value?"Modifications sécurisées":"Modifications libres"),1)])])],2)]),m("div",BV,[m("button",{onClick:$[0]||($[0]=S=>f.value=!f.value),class:"w-full p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-all duration-200 flex items-center justify-between"},[$[9]||($[9]=m("h3",{class:"text-sm font-semibold text-blue-300"},"💡 Pourquoi protéger son joueur ?",-1)),m("span",{class:cr(["text-blue-300 transition-transform duration-200",{"rotate-180":f.value}])},"▼",2)]),f.value?(W(),Q("div",jV,$[10]||($[10]=[m("div",null,[Tr("• "),m("span",{class:"text-blue-300"},"Protection des disponibilités :"),Tr(" Seul vous pouvez modifier vos disponibilités")],-1),m("div",null,[Tr("• "),m("span",{class:"text-blue-300"},"Protection du nom :"),Tr(" Seul vous pouvez changer votre nom de joueur")],-1),m("div",null,[Tr("• "),m("span",{class:"text-blue-300"},"Email requis :"),Tr(" Permet de réinitialiser le mot de passe en cas d'oubli")],-1)]))):Ae("",!0)]),s.value?Ae("",!0):(W(),Q("div",$V,[$[14]||($[14]=m("h3",{class:"text-lg font-semibold text-white mb-4"},"🔐 Activer la protection",-1)),m("div",qV,[m("div",null,[$[11]||($[11]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Adresse email",-1)),Tt(m("input",{"onUpdate:modelValue":$[1]||($[1]=S=>i.value=S),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[At,i.value]])]),m("div",null,[$[12]||($[12]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),Tt(m("input",{"onUpdate:modelValue":$[2]||($[2]=S=>o.value=S),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe sécurisé"},null,512),[[At,o.value]])]),m("div",null,[$[13]||($[13]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),Tt(m("input",{"onUpdate:modelValue":$[3]||($[3]=S=>a.value=S),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe"},null,512),[[At,a.value]])])]),m("button",{onClick:k,disabled:!C.value||c.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(W(),Q("span",GV,"⏳")):(W(),Q("span",KV,"🔒")),m("span",null,_e(c.value?"Activation...":"Activer la protection"),1)],8,zV)])),s.value?(W(),Q("div",HV,[$[17]||($[17]=m("h3",{class:"text-lg font-semibold text-white mb-4"},"🔓 Désactiver la protection",-1)),$[18]||($[18]=m("p",{class:"text-sm text-gray-300 mb-4"}," Attention : désactiver la protection supprimera définitivement le mot de passe et l'email associés. ",-1)),g.value?(W(),Q("div",WV,[m("div",null,[$[15]||($[15]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe de confirmation",-1)),Tt(m("input",{"onUpdate:modelValue":$[4]||($[4]=S=>_.value=S),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe pour confirmer"},null,512),[[At,_.value]])]),m("button",{onClick:B,disabled:!_.value||c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(W(),Q("span",JV,"⏳")):(W(),Q("span",YV,"🔓")),m("span",null,_e(c.value?"Désactivation...":"Confirmer la désactivation"),1)],8,QV),m("button",{onClick:$[5]||($[5]=S=>g.value=!1),class:"w-full px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])):Ae("",!0),g.value?Ae("",!0):(W(),Q("button",{key:1,onClick:N,disabled:c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},$[16]||($[16]=[m("span",null,"🔓",-1),m("span",null,"Désactiver la protection",-1)]),8,XV))])):Ae("",!0),u.value?(W(),Q("div",ZV,[m("div",eN,_e(u.value),1)])):Ae("",!0),d.value?(W(),Q("div",tN,[m("div",nN,_e(d.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:F,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0)}}},sN={class:"text-center mb-6"},iN={class:"text-lg text-gray-300"},oN={class:"mb-6"},aN={class:"space-y-4"},lN=["disabled"],cN={key:0,class:"animate-spin"},uN={key:1},dN={class:"mb-6 text-center"},hN={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},fN={class:"text-red-300 text-sm"},pN={class:"text-center mb-6"},mN={class:"text-lg text-gray-300"},gN={class:"mb-6"},_N=["disabled"],yN={key:0,class:"animate-spin"},vN={key:1},wN={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},bN={class:"text-red-300 text-sm"},IN={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},EN={class:"text-green-300 text-sm"},TN={class:"flex justify-center"},AN={__name:"PasswordVerificationModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","verified"],setup(n,{emit:e}){const t=n,r=e,s=K(""),i=K(!1),o=K(""),a=K(!1),c=K(""),u=K(""),d=K(null);async function f(){if(s.value){i.value=!0,o.value="";try{const C=await Lh(t.seasonId);if(s.value===C){r("verified",{type:"season_pin"}),_();return}await cu(t.player.id,s.value,t.seasonId)?(r("verified",{type:"player_password"}),_()):o.value="Mot de passe incorrect. Veuillez réessayer."}catch(C){console.error("Erreur lors de la vérification:",C),o.value="Erreur lors de la vérification. Veuillez réessayer."}finally{i.value=!1}}}async function g(){i.value=!0,c.value="",u.value="";try{const C=await Fh(t.player.id,t.seasonId);u.value=C.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(C){console.error("Erreur lors de l'envoi de l'email:",C),c.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{i.value=!1}}function _(){r("close"),s.value="",o.value="",a.value=!1,c.value="",u.value=""}return Xn(()=>t.show,C=>{C&&ri(()=>{d.value&&d.value.focus()})}),(C,x)=>{var k,N;return W(),Q(Rt,null,[n.show?(W(),Q("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4",onClick:_},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:x[2]||(x[2]=Wn(()=>{},["stop"]))},[m("div",sN,[x[6]||(x[6]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"🔐")],-1)),x[7]||(x[7]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Vérification requise",-1)),m("p",iN,_e((k=n.player)==null?void 0:k.name),1),x[8]||(x[8]=m("p",{class:"text-sm text-gray-400 mt-2"},"Ce joueur est protégé par mot de passe",-1))]),m("div",oN,[m("div",aN,[m("div",null,[x[9]||(x[9]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),Tt(m("input",{"onUpdate:modelValue":x[0]||(x[0]=B=>s.value=B),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:Tn(f,["enter"]),ref_key:"passwordInput",ref:d},null,544),[[At,s.value]])])]),m("button",{onClick:f,disabled:!s.value||i.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(W(),Q("span",cN,"⏳")):(W(),Q("span",uN,"🔓")),m("span",null,_e(i.value?"Vérification...":"Vérifier"),1)],8,lN)]),m("div",dN,[m("button",{onClick:x[1]||(x[1]=B=>a.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),o.value?(W(),Q("div",hN,[m("div",fN,_e(o.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:_,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):Ae("",!0),a.value?(W(),Q("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:x[5]||(x[5]=B=>a.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:x[4]||(x[4]=Wn(()=>{},["stop"]))},[m("div",pN,[x[10]||(x[10]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"📧")],-1)),x[11]||(x[11]=m("h2",{class:"text-2xl font-bold text-white mb-2"},"Mot de passe oublié",-1)),m("p",mN,_e((N=n.player)==null?void 0:N.name),1)]),m("div",gN,[x[12]||(x[12]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),m("button",{onClick:g,disabled:i.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(W(),Q("span",yN,"⏳")):(W(),Q("span",vN,"📧")),m("span",null,_e(i.value?"Envoi...":"Envoyer l'email"),1)],8,_N)]),c.value?(W(),Q("div",wN,[m("div",bN,_e(c.value),1)])):Ae("",!0),u.value?(W(),Q("div",IN,[m("div",EN,_e(u.value),1)])):Ae("",!0),m("div",TN,[m("button",{onClick:x[3]||(x[3]=B=>a.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0)],64)}}},PN={class:"text-center mb-6"},SN={class:"text-3xl font-bold text-white mb-2"},xN={class:"mb-8"},RN={class:"grid grid-cols-2 gap-4"},CN={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-500/30"},kN={class:"text-2xl font-bold text-white"},DN={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-4 rounded-lg border border-cyan-500/30"},VN={class:"text-2xl font-bold text-white"},NN={class:"mt-4 bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-500/30"},ON={class:"text-xl font-bold text-white"},MN={class:"flex justify-center space-x-3"},LN={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},FN={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},UN={class:"mb-6"},BN={__name:"PlayerModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},stats:{type:Object,default:()=>({availability:0,selection:0,ratio:0})},seasonId:{type:String,default:null}},emits:["close","update","delete","refresh"],setup(n,{emit:e}){const t=n,r=e,s=K(!1),i=K(""),o=K(null),a=K(!1),c=K(!1),u=K(null);function d(){r("close")}function f(){var F;i.value=((F=t.player)==null?void 0:F.name)||"",s.value=!0,ri(()=>{o.value&&o.value.focus()})}function g(){s.value=!1,i.value=""}async function _(){var L,$;if(!i.value.trim())return;if(await oo((L=t.player)==null?void 0:L.id,t.seasonId)){Ua(($=t.player)==null?void 0:$.id)?C():(u.value="update",c.value=!0);return}C()}function C(){var F;r("update",{playerId:(F=t.player)==null?void 0:F.id,newName:i.value.trim()}),s.value=!1,i.value=""}async function x(){var L,$;if(await oo((L=t.player)==null?void 0:L.id,t.seasonId)){Ua(($=t.player)==null?void 0:$.id)?k():(u.value="delete",c.value=!0);return}k()}function k(){var F;r("delete",(F=t.player)==null?void 0:F.id)}function N(){r("refresh")}function B(F){u.value==="update"?C():u.value==="delete"&&k(),u.value=null}return Xn(()=>t.show,F=>{F||(s.value=!1,i.value="",u.value=null)}),(F,L)=>{var $;return W(),Q(Rt,null,[n.show?(W(),Q("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[80] p-4",onClick:d},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-2xl",onClick:L[1]||(L[1]=Wn(()=>{},["stop"]))},[m("div",PN,[L[5]||(L[5]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"👤")],-1)),m("h2",SN,_e(($=n.player)==null?void 0:$.name),1),L[6]||(L[6]=m("p",{class:"text-xl text-purple-300"},"Détails du joueur",-1))]),m("div",xN,[L[10]||(L[10]=m("h3",{class:"text-lg font-semibold text-white mb-4"},"📊 Statistiques",-1)),m("div",RN,[m("div",CN,[m("div",kN,_e(t.stats.availability),1),L[7]||(L[7]=m("div",{class:"text-sm text-gray-300"},"Disponibilités",-1))]),m("div",DN,[m("div",VN,_e(t.stats.selection),1),L[8]||(L[8]=m("div",{class:"text-sm text-gray-300"},"Sélections",-1))])]),m("div",NN,[m("div",ON,_e(t.stats.ratio)+"%",1),L[9]||(L[9]=m("div",{class:"text-sm text-gray-300"},"Taux de sélection",-1))])]),m("div",MN,[m("button",{onClick:f,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center space-x-2"},L[11]||(L[11]=[m("span",null,"✏️",-1),m("span",null,"Modifier",-1)])),m("button",{onClick:L[0]||(L[0]=ee=>a.value=!0),class:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex items-center space-x-2"},L[12]||(L[12]=[m("span",null,"🔒",-1),m("span",null,"Protection",-1)])),m("button",{onClick:x,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center space-x-2"},L[13]||(L[13]=[m("span",null,"🗑️",-1),m("span",null,"Supprimer",-1)])),m("button",{onClick:d,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0),s.value?(W(),Q("div",LN,[m("div",FN,[L[15]||(L[15]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Modifier le joueur",-1)),m("div",UN,[L[14]||(L[14]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),Tt(m("input",{"onUpdate:modelValue":L[2]||(L[2]=ee=>i.value=ee),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Tn(g,["esc"]),Tn(_,["enter"])],ref_key:"editNameInput",ref:o},null,544),[[At,i.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:g,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:_,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):Ae("",!0),jt(rN,{show:a.value,player:n.player,seasonId:n.seasonId,onClose:L[3]||(L[3]=ee=>a.value=!1),onUpdate:N},null,8,["show","player","seasonId"]),jt(AN,{show:c.value,player:n.player,seasonId:n.seasonId,onClose:L[4]||(L[4]=ee=>c.value=!1),onVerified:B},null,8,["show","player","seasonId"])],64)}}},jN={class:"text-center mb-6"},$N={class:"text-3xl font-bold text-white mb-2"},qN={class:"text-xl text-purple-300"},zN={class:"mb-6"},GN={class:"grid grid-cols-3 gap-4"},KN={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-500/30"},HN={class:"text-2xl font-bold text-white"},WN={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-500/30"},QN={class:"text-2xl font-bold text-white"},JN={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-4 rounded-lg border border-cyan-500/30"},YN={class:"text-2xl font-bold text-white"},XN={key:0,class:"mb-6"},ZN={class:"flex items-center space-x-3 p-3 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20"},eO={class:"flex-1"},tO={class:"text-blue-300 text-sm font-medium"},nO={key:1,class:"mb-6"},rO={class:"flex items-center space-x-3 p-4 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 rounded-lg border border-yellow-500/20"},sO={class:"flex-1"},iO={class:"text-yellow-200 text-sm"},oO={key:2,class:"mb-6"},aO={class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4"},lO={class:"text-white font-medium"},cO={key:0,class:"text-purple-400 mr-2"},uO={key:1,class:"text-green-400 mr-2"},dO={key:2,class:"text-red-400 mr-2"},hO={key:3,class:"text-gray-400 mr-2"},fO={class:"mb-4"},pO={class:"relative"},mO=["value"],gO=["title"],_O={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},yO={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vO={key:3,class:"mb-6"},wO={class:"text-center p-6 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/20"},bO={class:"text-4xl mb-4"},IO={class:"text-xl font-semibold text-white mb-2"},EO={class:"text-gray-300"},TO={class:"flex justify-center space-x-3"},AO=["disabled","title"],PO={__name:"SelectionModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},currentSelection:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},selectedCount:{type:Number,default:0},playerAvailability:{type:Object,default:()=>({})}},emits:["close","selection","perfect"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=K(!1),o=K("Copier le message"),a=K(!1),c=K(""),u=K(!1),d=cn(()=>r.currentSelection&&r.currentSelection.length>0),f=cn(()=>{var Re;if(!d.value)return!1;const w=r.currentSelection.some(Ye=>!F(Ye)),T=((Re=r.event)==null?void 0:Re.playerCount)||6,E=r.availableCount<T;return w||E}),g=cn(()=>{var E;if(!f.value)return"";const w=r.currentSelection.filter(Re=>!F(Re)),T=((E=r.event)==null?void 0:E.playerCount)||6;return w.length>0?w.length===1?`${w[0]} n'est plus disponible. Veuillez relancer la sélection.`:`${w.length} joueurs ne sont plus disponibles. Veuillez relancer la sélection.`:r.availableCount<T?`Seulement ${r.availableCount} joueurs disponibles pour ${T} requis. Veuillez attendre plus de disponibilités ou ajuster le nombre de joueurs à sélectionner.`:"Sélection incomplète"}),_=cn(()=>{if(!r.event||!d.value)return"";const w=C(r.event.date),T=r.currentSelection.join(", ");return`Sélection pour ${r.event.title} du ${w} : ${T}`});Xn(()=>r.show,w=>{w&&(i.value=!1,o.value="Copier le message",a.value=!1,c.value="",u.value=!1)});function C(w){var E;return w?(typeof w=="string"?new Date(w):((E=w.toDate)==null?void 0:E.call(w))||w).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function x(){const w=_.value;navigator.clipboard.writeText(w).then(()=>{i.value=!0,o.value="Copié !",setTimeout(()=>{i.value=!1,o.value="Copier le message"},2e3)}).catch(T=>{console.error("Erreur lors de la copie du texte:",T),alert("Impossible de copier le message.")})}function k(){s("selection")}function N(){s("perfect")}function B(){s("close")}function F(w){return r.playerAvailability[w]===!0}function L(w){return r.playerAvailability[w]===!1}function $(w){return r.currentSelection.includes(w)&&F(w)}function ee(){var T;const w=((T=r.event)==null?void 0:T.playerCount)||6;return r.availableCount===0||r.availableCount<w?"⚠️":"🎲"}function S(){var T;const w=((T=r.event)==null?void 0:T.playerCount)||6;return r.availableCount===0?"Aucun joueur disponible":r.availableCount<w?"Pas assez de joueurs disponibles":"Aucune sélection effectuée"}function I(){var T;const w=((T=r.event)==null?void 0:T.playerCount)||6;return r.availableCount===0?"Aucun joueur n'est disponible pour cet événement. Veuillez d'abord indiquer les disponibilités.":r.availableCount<w?`Seulement ${r.availableCount} joueurs disponibles pour ${w} requis. Veuillez attendre plus de disponibilités ou ajuster le nombre de joueurs à sélectionner.`:'Cliquez sur "Sélection Auto" pour lancer le tirage automatique des joueurs'}function P(w=!1,T=!1){if(u.value=w,w){const E=C(r.event.date),Re=r.currentSelection.join(", ");T?c.value=`Sélection mise à jour pour ${r.event.title} du ${E} : ${Re}`:c.value=`Nouvelle sélection pour ${r.event.title} du ${E} : ${Re}`}else c.value="Sélection effectuée avec succès !";a.value=!0,setTimeout(()=>{a.value=!1},8e3)}function R(){a.value=!1}return e({showSuccess:P}),(w,T)=>{var E,Re,Ye;return n.show?(W(),Q("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[80] p-4",onClick:B},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-2xl",onClick:T[0]||(T[0]=Wn(()=>{},["stop"]))},[m("div",jN,[T[1]||(T[1]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"🎭")],-1)),m("h2",$N,"Sélection pour "+_e((E=n.event)==null?void 0:E.title),1),m("p",qN,_e(C((Re=n.event)==null?void 0:Re.date)),1)]),m("div",zN,[m("div",GN,[m("div",KN,[m("div",HN,_e(((Ye=n.event)==null?void 0:Ye.playerCount)||6),1),T[2]||(T[2]=m("div",{class:"text-sm text-gray-300"},"À sélectionner",-1))]),m("div",WN,[m("div",QN,_e(n.availableCount),1),T[3]||(T[3]=m("div",{class:"text-sm text-gray-300"},"Disponibles",-1))]),m("div",JN,[m("div",YN,_e(n.selectedCount),1),T[4]||(T[4]=m("div",{class:"text-sm text-gray-300"},"Sélectionnés",-1))])])]),a.value?(W(),Q("div",XN,[m("div",ZN,[T[6]||(T[6]=m("div",{class:"text-blue-400 text-xl"},"✨",-1)),m("div",eO,[m("p",tO,_e(c.value),1)]),m("button",{onClick:R,class:"text-blue-400 hover:text-blue-300 transition-colors",title:"Fermer le message"},T[5]||(T[5]=[m("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):Ae("",!0),f.value?(W(),Q("div",nO,[m("div",rO,[T[8]||(T[8]=m("div",{class:"text-yellow-400 text-xl"},"⚠️",-1)),m("div",sO,[T[7]||(T[7]=m("h3",{class:"text-yellow-300 text-sm font-semibold mb-1"},"Sélection incomplète",-1)),m("p",iO,_e(g.value),1)])])])):Ae("",!0),d.value?(W(),Q("div",oO,[T[12]||(T[12]=m("h3",{class:"text-lg font-semibold text-white mb-3"},"Joueurs sélectionnés :",-1)),m("div",aO,[(W(!0),Q(Rt,null,sr(n.currentSelection,je=>(W(),Q("div",{key:je,class:cr(["bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 rounded-lg border border-green-500/30 text-center",{"from-red-500/20 to-red-600/20 border-red-500/30":!F(je),"from-yellow-500/20 to-orange-500/20 border-yellow-500/30":L(je)}])},[m("span",lO,[$(je)?(W(),Q("span",cO,"🎭")):F(je)?(W(),Q("span",uO,"✅")):L(je)?(W(),Q("span",dO,"❌")):(W(),Q("span",hO,"–")),Tr(" "+_e(je),1)])],2))),128))]),m("div",fO,[T[11]||(T[11]=m("h4",{class:"text-md font-semibold text-white mb-2"},"Message à envoyer :",-1)),m("div",pO,[m("textarea",{value:_.value,class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400 resize-none",rows:"3",readonly:""},null,8,mO),m("button",{onClick:x,class:"absolute top-2 right-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg p-2 hover:from-purple-600 hover:to-pink-700 transition-all duration-300",title:o.value},[i.value?(W(),Q("svg",yO,T[10]||(T[10]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(W(),Q("svg",_O,T[9]||(T[9]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])))],8,gO)])])])):(W(),Q("div",vO,[m("div",wO,[m("div",bO,_e(ee()),1),m("h3",IO,_e(S()),1),m("p",EO,_e(I()),1)])])),m("div",TO,[m("button",{onClick:k,disabled:n.availableCount===0,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",title:n.availableCount===0?"Aucun joueur disponible":d.value?"Relancer la sélection automatique":"Lancer la sélection automatique"},T[13]||(T[13]=[m("span",null,"✨",-1),m("span",null,"Sélection Auto",-1)]),8,AO),d.value?(W(),Q("button",{key:0,onClick:N,class:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex items-center space-x-2"},T[14]||(T[14]=[m("span",null,"👍",-1),m("span",null,"Parfait",-1)]))):Ae("",!0)])])])):Ae("",!0)}}};const SO={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},xO={class:"text-center py-8 px-4 relative"},RO={class:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},CO={class:"container mx-auto px-4 pb-16"},kO={class:"sticky top-0 z-50 backdrop-blur-sm bg-black/20 border border-white/20 rounded-t-2xl overflow-hidden"},DO={class:"border-collapse w-full table-fixed"},VO={class:"text-white"},NO={class:"p-4 text-left"},OO={class:"flex flex-col items-center space-y-2"},MO=["onClick"],LO={class:"flex flex-col gap-3"},FO={class:"flex flex-col items-center space-y-2"},UO={class:"font-bold text-lg text-center whitespace-pre-wrap relative group cursor-pointer"},BO=["title"],jO=["title","onClick"],$O=["title","onClick"],qO={class:"bg-black/10"},zO={class:"overflow-x-auto overflow-y-auto max-h-[calc(100vh-200px)] bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-sm border border-white/20 rounded-b-2xl"},GO={class:"table-auto border-collapse w-full table-fixed"},KO=["data-player-id"],HO={class:"p-4 font-medium text-white w-[100px] relative group text-lg"},WO={class:"font-bold text-lg whitespace-pre-wrap flex items-center"},QO={key:0,class:"text-yellow-400 mr-1 text-sm",title:"Joueur protégé par mot de passe"},JO=["onClick","title"],YO=["onClick"],XO={class:"flex items-center justify-center"},ZO=["title"],e2=["title"],t2=["title"],n2=["title"],r2={key:0,class:"fixed bottom-4 left-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-2xl border border-green-400/30 backdrop-blur-sm z-50"},s2={class:"flex items-center space-x-2"},i2={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},o2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},a2={class:"mb-6"},l2={class:"mb-6"},c2={class:"mb-6"},u2={class:"mb-6"},d2={key:2,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},h2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},f2={class:"mb-6"},p2={class:"flex justify-end space-x-3"},m2={key:3,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},g2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},_2={class:"flex justify-end space-x-3"},y2={key:4,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},v2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},w2={class:"flex justify-end space-x-3"},b2={key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[95] p-4"},I2={class:"text-center mb-6"},E2={class:"text-3xl font-bold text-white mb-2"},T2={class:"text-xl text-purple-300"},A2={key:0,class:"mb-6"},P2={class:"text-gray-300 bg-gray-800/50 p-4 rounded-lg border border-gray-600/50"},S2={class:"mb-6"},x2={class:"grid grid-cols-3 gap-4"},R2={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-500/30"},C2={class:"text-2xl font-bold text-white"},k2={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-4 rounded-lg border border-cyan-500/30"},D2={class:"text-2xl font-bold text-white"},V2={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-500/30"},N2={class:"text-2xl font-bold text-white"},O2={class:"flex justify-center space-x-3"},M2={key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},L2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},F2={class:"mb-6"},U2={class:"mb-6"},B2={class:"mb-6"},j2={class:"mb-6"},$2={key:8,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},q2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},z2={class:"mb-6"},G2={class:"space-y-4"},K2=["disabled"],H2={key:0,class:"animate-spin"},W2={key:1},Q2={class:"mb-6 text-center"},J2={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},Y2={class:"text-red-300 text-sm"},X2={key:9,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},Z2={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},eM={class:"mb-6"},tM={class:"space-y-4"},nM=["disabled"],rM={key:0,class:"animate-spin"},sM={key:1},iM={class:"mb-6 text-center"},oM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},aM={class:"text-red-300 text-sm"},lM={class:"mb-6"},cM=["disabled"],uM={key:0,class:"animate-spin"},dM={key:1},hM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},fM={class:"text-red-300 text-sm"},pM={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},mM={class:"text-green-300 text-sm"},gM={class:"flex justify-center"},_M={class:"mb-6"},yM=["disabled"],vM={key:0,class:"animate-spin"},wM={key:1},bM={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},IM={class:"text-red-300 text-sm"},EM={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},TM={class:"text-green-300 text-sm"},AM={class:"flex justify-center"},PM={__name:"GridBoard",props:{slug:{type:String,required:!0}},setup(n){const e=n,t=sf();e.slug;const r=K(""),s=K(""),i=K(!1),o=K(null),a=K(null),c=K(""),u=K(""),d=K(6),f=K(!1),g=K(""),_=K(null),C=K(!1),x=K(null),k=K(!1),N=K(null),B=K(!1),F=K(null),L=K(""),$=K(!1),ee=K(null),S=K(""),I=K(""),P=K(!1),R=K(null),w=K(!1),T=K(null),E=K(""),Re=K(""),Ye=K(!1),je=K(null),Oe=K(!1),Ce=K(!1),qt=K(""),nn=K(""),zt=K(!1),Qe=K(!1),Xe=K(""),bn=K(""),Ft=K(!1),Je=K(null),q=K(""),ce=K(!1),te=K(null),fe=K(null),Ue=K(new Set);function Ze(D){_.value=D;const v=document.querySelector(`[data-player-id="${D}"]`);v&&v.scrollIntoView({behavior:"smooth",block:"center"}),V.value=!0,G.value="Nouveau joueur ajouté !",setTimeout(()=>{V.value=!1},3e3)}function b(D){return Ue.value.has(D)}async function A(){if(!s.value)return;const D=new Set;for(const v of Ve.value)await oo(v.id,s.value)&&D.add(v.id);Ue.value=D}const V=K(!1),G=K("");async function z(D){await _r({type:"deleteEvent",data:{eventId:D}})}async function Z(D=null){const v=D||o.value;if(console.log("deleteEventConfirmed - eventId param:",D),console.log("deleteEventConfirmed - eventToDelete.value:",o.value),console.log("deleteEventConfirmed - eventIdToDelete:",v),console.log("deleteEventConfirmed - type de eventIdToDelete:",typeof v),!v){console.error("Aucun événement à supprimer");return}try{await EV(v,s.value),Me.value=Me.value.filter(H=>H.id!==v),await Promise.all([k_(s.value),pa(Ve.value,Me.value,s.value),ma(s.value)]).then(([H,de,Te])=>{Me.value=H,lt.value=de,it.value=Te}),i.value=!1,o.value=null,V.value=!0,G.value="Événement supprimé avec succès !",setTimeout(()=>{V.value=!1},3e3)}catch(H){console.error("Erreur lors de la suppression de l'événement:",H),alert("Erreur lors de la suppression de l'événement. Veuillez réessayer.")}}function ue(){i.value=!1,o.value=null}async function se(){if(!a.value||!c.value.trim()||!u.value)return;const D=parseInt(d.value);if(isNaN(D)||D<1||D>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}try{const v={title:c.value.trim(),date:u.value,description:q.value.trim()||"",playerCount:D};await AV(a.value,v,s.value),await Promise.all([k_(s.value),pa(Ve.value,Me.value,s.value),ma(s.value)]).then(([H,de,Te])=>{Me.value=H,lt.value=de,it.value=Te}),a.value=null,c.value="",u.value="",q.value="",d.value=6,V.value=!0,G.value="Événement mis à jour avec succès !",setTimeout(()=>{V.value=!1},3e3)}catch(v){console.error("Erreur lors de l'édition de l'événement:",v),alert("Erreur lors de l'édition de l'événement. Veuillez réessayer.")}}async function ne(){if(g.value.trim())try{const D=g.value.trim(),v=await vV(D,s.value);await Promise.all([Hd(s.value),pa(Ve.value,Me.value,s.value),ma(s.value)]).then(([H,de,Te])=>{Ve.value=H,lt.value=de,it.value=Te,A();const qe=Ve.value.find(et=>et.id===v);Ze(v);const Se=document.querySelector(`[data-player-id="${v}"]`);Se&&Se.scrollIntoView({behavior:"smooth",block:"center"}),V.value=!0,G.value="Joueur ajouté avec succès ! Vous pouvez maintenant indiquer sa disponibilité.",setTimeout(()=>{V.value=!1},3e3),setTimeout(()=>{V.value=!1,G.value=""},5e3)}),f.value=!1,g.value=""}catch(D){console.error("Erreur lors de l'ajout du joueur:",D),alert("Erreur lors de l'ajout du joueur. Veuillez réessayer.")}}function X(){a.value=null,c.value="",u.value="",q.value="",d.value=6}K(null);const ye=K(!1),oe=K(""),me=K(""),Ee=K(""),Ie=K(6);async function ke(){if(!oe.value.trim()||!me.value){alert("Veuillez remplir le titre et la date de l'événement");return}const D=parseInt(Ie.value);if(isNaN(D)||D<1||D>20){alert("Le nombre de joueurs doit être un nombre entier entre 1 et 20");return}const v={title:oe.value.trim(),date:me.value,description:Ee.value.trim()||"",playerCount:D};await $e(v)}async function $e(D){try{const v=await TV(D,s.value);Me.value=[...Me.value,{id:v,...D}];const H={};for(const de of Ve.value)H[de.name]=lt.value[de.name]||{},H[de.name][v]=null,await D_(de.name,H[de.name],s.value);oe.value="",me.value="",Ee.value="",Ie.value=6,ye.value=!1,await Promise.resolve(),V.value=!0,G.value="Événement créé avec succès !",setTimeout(()=>{V.value=!1},3e3)}catch(v){console.error("Erreur lors de la création de l'événement:",v),alert("Erreur lors de la création de l'événement. Veuillez réessayer.")}}function Gt(){oe.value="",me.value="",Ee.value="",Ie.value=6,ye.value=!1}async function Dt(){await _r({type:"addEvent",data:{}})}const Me=K([]),Ve=K([]),lt=K({}),it=K({}),Kt=K({}),In=K({});vu(async()=>{gV("firebase"),await yV();const D=sp(st(be,"seasons"),Pw("slug","==",e.slug)),v=await It(D);if(!v.empty){const H=v.docs[0];s.value=H.id,r.value=H.data().name,document.title=`Saison : ${r.value}`}if(s.value){const H=await It(st(be,"seasons",s.value,"players"));Ve.value=H.docs.map(ot=>({id:ot.id,...ot.data()})),await A();const de=await It(st(be,"seasons",s.value,"events"));Me.value=de.docs.map(ot=>({id:ot.id,...ot.data(),playerCount:ot.data().playerCount||6}));const Te=await It(st(be,"seasons",s.value,"availability")),qe={};Te.docs.forEach(ot=>{const sn=ot.data(),Vt={};Object.keys(sn).forEach(yt=>{const ie=sn[yt];ie==="oui"?Vt[yt]=!0:ie==="non"?Vt[yt]=!1:Vt[yt]=ie}),qe[ot.id]=Vt}),lt.value=qe;const Se=await It(st(be,"seasons",s.value,"selections")),et={};Se.docs.forEach(ot=>{et[ot.id]=ot.data().players||[]}),it.value=et}Ho(),Yr(),console.log("players (deduplicated):",Ve.value.map(H=>({id:H.id,name:H.name}))),console.log("availability loaded:",lt.value)});async function Ii(D,v){const H=Ve.value.find(qe=>qe.name===D);if(!H){console.error("Joueur non trouvé:",D);return}if(!Me.value.find(qe=>qe.id===v)){console.error("Événement non trouvé:",v);return}if(await oo(H.id,s.value)){Ua(H.id)?Ls(H,v):await Fl({type:"toggleAvailability",data:{player:H,eventId:v}});return}Ls(H,v)}function Ls(D,v){var Te;const H=(Te=lt.value[D.name])==null?void 0:Te[v];console.log(`toggleAvailability - ${D.name} pour ${v}:`,H);let de;H===!0?de=!1:H===!1?de=void 0:de=!0,de===void 0?lt.value[D.name]&&delete lt.value[D.name][v]:(lt.value[D.name]||(lt.value[D.name]={}),lt.value[D.name][v]=de),D_(D.name,lt.value[D.name],s.value).then(()=>{V.value=!0,G.value="Disponibilité mise à jour avec succès !",setTimeout(()=>{V.value=!1},3e3)}).catch(qe=>{console.error("Erreur lors de la mise à jour de la disponibilité:",qe),alert("Erreur lors de la mise à jour de la disponibilité. Veuillez réessayer.")})}function xn(D,v){var H;return(H=lt.value[D])==null?void 0:H[v]}function Go(D,v){var Te;const H=it.value[v]||[],de=(Te=lt.value[D])==null?void 0:Te[v];return H.includes(D)&&de===!0}async function Fs(D,v=6){const H=Me.value.find(Se=>Se.id===D),de=(H==null?void 0:H.playerCount)||6,Te=it.value[D]||[];if(Te.length>0&&Te.every(Se=>xn(Se,D))){console.log("Tous les joueurs sélectionnés sont disponibles, nouveau tirage complet");const et=Ve.value.filter(Vt=>xn(Vt.name,D)).map(Vt=>{const yt=gr(Vt.name);return{name:Vt.name,weight:1/(1+yt)}}),ot=[],sn=[...et];for(;ot.length<de&&sn.length>0;){const Vt=sn.reduce((Le,Qt)=>Le+Qt.weight,0);let yt=Math.random()*Vt;const ie=sn.findIndex(Le=>(yt-=Le.weight,yt<=0));ie>=0&&(ot.push(sn[ie].name),sn.splice(ie,1))}it.value[D]=ot}else{const Se=Te.filter(ot=>xn(ot,D)),et=de-Se.length;if(et<=0)it.value[D]=Se;else{const ot=new Set(Se),Vt=Ve.value.filter(Le=>xn(Le.name,D)&&!ot.has(Le.name)).map(Le=>{const Qt=gr(Le.name);return{name:Le.name,weight:1/(1+Qt)}}),yt=[],ie=[...Vt];for(;yt.length<et&&ie.length>0;){const Le=ie.reduce((Di,Wl)=>Di+Wl.weight,0);let Qt=Math.random()*Le;const ki=ie.findIndex(Di=>(Qt-=Di.weight,Qt<=0));ki>=0&&(yt.push(ie[ki].name),ie.splice(ki,1))}it.value[D]=[...Se,...yt]}}await IV(D,it.value[D],s.value),Ho(),Yr()}async function Ei(D,v=6){var Se,et,ot,sn,Vt;console.log("tirerProtected appelé avec eventId:",D),console.log("showSelectionModal.value AVANT:",ce.value),console.log("selectionModalEvent.value?.id AVANT:",(Se=te.value)==null?void 0:Se.id);const H=ce.value,de=(et=te.value)==null?void 0:et.id,Te=it.value[D]&&it.value[D].length>0,qe=Te?[...it.value[D]]:[];if(await Fs(D,v),console.log("showSelectionModal.value APRÈS tirage:",ce.value),console.log("selectionModalEvent.value?.id APRÈS tirage:",(ot=te.value)==null?void 0:ot.id),H&&!ce.value&&(console.log("Restauration de la popin de sélection..."),ce.value=!0,te.value=Me.value.find(yt=>yt.id===de)),ce.value&&((sn=te.value)==null?void 0:sn.id)===D)if(console.log("Popin de sélection ouverte, mise à jour..."),await ri(),fe.value&&fe.value.showSuccess){console.log("Appel de showSuccess sur la popin de sélection");const yt=it.value[D]||[],ie=qe.filter(Qt=>yt.includes(Qt)),Le=ie.length>0&&ie.length<qe.length;fe.value.showSuccess(Te,Le)}else console.log("selectionModalRef.value:",fe.value),console.log("showSuccess disponible:",(Vt=fe.value)==null?void 0:Vt.showSuccess);else console.log("Popin de sélection fermée, affichage message global"),V.value=!0,Me.value.find(yt=>yt.id===D),it.value[D],Te?G.value="Sélection mise à jour avec succès !":G.value="Sélection effectuée avec succès !",setTimeout(()=>{V.value=!1},3e3)}function Ko(D){var H;return D?(typeof D=="string"?new Date(D):((H=D.toDate)==null?void 0:H.call(D))||D).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):""}function mr(D){var H;return D?(typeof D=="string"?new Date(D):((H=D.toDate)==null?void 0:H.call(D))||D).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function gr(D){return Object.values(it.value).filter(v=>v.includes(D)).length}function Qr(D){const v=lt.value[D]||{};return Object.values(v).filter(H=>H===!0).length}function Us(D){return D?Object.values(lt.value).filter(v=>v[D]===!0).length:0}function Jr(D){return D?(it.value[D]||[]).length:0}function Ml(D){const v=Qr(D),H=gr(D);return v===0?0:H/v}function rn(D){Kt.value[D]={availability:Qr(D),selection:gr(D),ratio:Ml(D)}}function Ho(){Ve.value.forEach(D=>rn(D.name))}function Yr(){const D={};Me.value.forEach(v=>{const H=v.playerCount||6,Te=Ve.value.filter(Se=>xn(Se.name,v.id)===!0).map(Se=>{const et=gr(Se.name);return{name:Se.name,weight:1/(1+et)}}),qe=Te.reduce((Se,et)=>Se+et.weight,0);Te.forEach(Se=>{const et=Math.min(1,Se.weight/qe*H);D[Se.name]||(D[Se.name]={}),D[Se.name][v.id]=Math.round(et*100)})}),In.value=D}function er(D,v){var Se,et;const H=D.name,de=xn(H,v),Te=Go(H,v),qe=((et=(Se=In.value)==null?void 0:Se[H])==null?void 0:et[v])??0;return de===!1?"Non disponible – cliquez pour changer":Te?`Sélectionné · Chance estimée : ${qe}%`:de===!0?`Disponible · Chance estimée : ${qe}%`:"Cliquez pour indiquer votre disponibilité"}const Ti=K(null),Ai=K(!1);async function Xr(D=null){const v=D||Ti.value;if(!v){console.error("Aucun joueur à supprimer");return}try{await wV(v,s.value),Ve.value=Ve.value.filter(H=>H.id!==v),Ai.value=!1,Ti.value=null,V.value=!0,G.value="Joueur supprimé avec succès !",setTimeout(()=>{V.value=!1},3e3)}catch(H){console.error("Erreur lors de la suppression du joueur :",H),alert("Erreur lors de la suppression du joueur. Veuillez réessayer.")}}function id(){Ai.value=!1,Ti.value=null}async function od(D){Zo(),await oo(D,s.value)?await tr({type:"deletePlayer",data:{playerId:D}}):await _r({type:"deletePlayer",data:{playerId:D}})}async function Pi(){if(x.value){const D=Me.value.find(H=>H.id===x.value),v=(D==null?void 0:D.playerCount)||6;await Ei(x.value,v),C.value=!1,x.value=null}}function Ll(){C.value=!1,x.value=null}function Wo(){return F.value?{deleteEvent:"Suppression d'événement - Code PIN requis",addEvent:"Ajout d'événement - Code PIN requis",deletePlayer:"Suppression de joueur - Code PIN requis",launchSelection:"Lancement de sélection - Code PIN requis"}[F.value.type]||"Code PIN requis":"Veuillez saisir le code PIN à 4 chiffres"}async function _r(D){if(kn.isPinCached(s.value)){const v=kn.getCachedPin(s.value);if(console.log("PIN en cache trouvé, utilisation automatique"),await lu(s.value,v)){await Rn(D);return}else kn.clearSession()}F.value=D,B.value=!0}async function tr(D){const v=D.data.playerId;if(Ua(v)){console.log("Mot de passe du joueur en cache trouvé, utilisation automatique"),await Rn(D);return}ee.value=D,$.value=!0}async function Fl(D){const v=D.data.player.id;if(Ua(v)){console.log("Mot de passe du joueur en cache trouvé, utilisation automatique"),await Rn(D);return}T.value=D,w.value=!0}async function Ul(D){try{if(await lu(s.value,D)){kn.saveSession(s.value,D),B.value=!1;const H=F.value;F.value=null,await Rn(H)}else L.value="Code PIN incorrect",setTimeout(()=>{L.value=""},3e3)}catch(v){console.error("Erreur lors de la vérification du PIN:",v),L.value="Erreur lors de la vérification du code PIN"}}function Qo(){B.value=!1,F.value=null,L.value=""}async function Si(D){if(D){P.value=!0,S.value="";try{const v=ee.value.data.playerId,H=await Lh(s.value);if(D===H){$.value=!1;const Te=ee.value;ee.value=null,I.value="",await Rn(Te);return}if(await cu(v,D,s.value)){$.value=!1;const Te=ee.value;ee.value=null,I.value="",await Rn(Te)}else S.value="Mot de passe incorrect",setTimeout(()=>{S.value=""},3e3)}catch(v){console.error("Erreur lors de la vérification du mot de passe:",v),S.value="Erreur lors de la vérification du mot de passe"}finally{P.value=!1}}}function Bl(){$.value=!1,ee.value=null,S.value="",I.value="",P.value=!1}async function Jo(D){if(D){Ye.value=!0,E.value="";try{const v=T.value.data.player,H=await Lh(s.value);if(D===H){w.value=!1;const Te=T.value;T.value=null,Re.value="",await Rn(Te);return}if(await cu(v.id,D,s.value)){w.value=!1;const Te=T.value;T.value=null,Re.value="",await Rn(Te)}else E.value="Mot de passe incorrect",setTimeout(()=>{E.value=""},3e3)}catch(v){console.error("Erreur lors de la vérification du mot de passe:",v),E.value="Erreur lors de la vérification du mot de passe"}finally{Ye.value=!1}}}function ad(){w.value=!1,T.value=null,E.value="",Re.value="",Ye.value=!1}async function xi(){Ce.value=!0,qt.value="",nn.value="";try{const D=T.value.data.player,v=await Fh(D.id,s.value);nn.value=v.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(D){console.error("Erreur lors de l'envoi de l'email:",D),qt.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{Ce.value=!1}}async function jl(){Qe.value=!0,Xe.value="",bn.value="";try{const D=ee.value.data.playerId,v=await Fh(D,s.value);bn.value=v.message||"Email de réinitialisation envoyé ! Vérifiez votre boîte de réception."}catch(D){console.error("Erreur lors de l'envoi de l'email:",D),Xe.value="Erreur lors de l'envoi de l'email. Veuillez réessayer."}finally{Qe.value=!1}}function Yo(){return kn.isPinCached(s.value)?{timeRemaining:kn.getTimeRemaining(),isExpiringSoon:kn.isExpiringSoon()}:null}async function Rn(D){if(!D)return;const{type:v,data:H}=D;try{switch(v){case"deleteEvent":console.log("executePendingOperation - data.eventId:",H.eventId),console.log("executePendingOperation - type de data.eventId:",typeof H.eventId),o.value=H.eventId,i.value=!0;break;case"addEvent":ye.value=!0;break;case"deletePlayer":Ti.value=H.playerId,Ai.value=!0;break;case"launchSelection":it.value[H.eventId]&&it.value[H.eventId].length>0?(x.value=H.eventId,C.value=!0,Ft.value=!1):(await Ei(H.eventId,H.count),Ft.value=!1);break;case"toggleAvailability":Ls(H.player,H.eventId);break}}catch(de){console.error("Erreur lors de l'exécution de l'opération:",de),V.value=!0,G.value="Erreur lors de l'opération. Veuillez réessayer.",setTimeout(()=>{V.value=!1},3e3)}}function yr(){t.push("/")}function Xo(D){Je.value=D,q.value=D.description||"",Ft.value=!0}function ld(){Ft.value=!1,Je.value=null,q.value=""}function $l(){a.value=Je.value.id,c.value=Je.value.title,u.value=Je.value.date,q.value=Je.value.description||"",d.value=Je.value.playerCount||6,Ft.value=!1}function ql(D){N.value=D,k.value=!0}function Zo(){k.value=!1,N.value=null}async function ea({playerId:D,newName:v}){try{await bV(D,v,s.value),await Promise.all([Hd(s.value),pa(Ve.value,Me.value,s.value),ma(s.value)]).then(([H,de,Te])=>{if(Ve.value=H,lt.value=de,it.value=Te,A(),N.value&&N.value.id===D){const qe=H.find(Se=>Se.id===D);qe&&(N.value=qe)}}),V.value=!0,G.value="Joueur mis à jour avec succès !",setTimeout(()=>{V.value=!1},3e3)}catch(H){console.error("Erreur lors de l'édition du joueur:",H),alert("Erreur lors de l'édition du joueur. Veuillez réessayer.")}}async function ta(){try{await Promise.all([Hd(s.value),pa(Ve.value,Me.value,s.value),ma(s.value)]).then(([D,v,H])=>{if(Ve.value=D,lt.value=v,it.value=H,A(),N.value){const de=D.find(Te=>Te.id===N.value.id);de&&(N.value=de)}}),V.value=!0,G.value="Données mises à jour !",setTimeout(()=>{V.value=!1},3e3)}catch(D){console.error("Erreur lors du rafraîchissement:",D)}}function zl(D){if(!D)return{availability:0,selection:0,ratio:0};const v=Qr(D.name),H=gr(D.name),de=v===0?0:Math.round(H/v*100);return{availability:v,selection:H,ratio:de}}function Ri(D){const v=it.value[D]||[],H=Me.value.find(qe=>qe.id===D),de=(H==null?void 0:H.playerCount)||6,Te=Us(D);if(v.length>0){const qe=v.some(et=>!xn(et,D)),Se=Te<de;if(qe||Se)return{type:"incomplete",hasUnavailablePlayers:qe,hasInsufficientPlayers:Se,unavailablePlayers:v.filter(et=>!xn(et,D)),availableCount:Te,requiredCount:de}}return Te<de?{type:"insufficient",availableCount:Te,requiredCount:de}:v.length===0?{type:"ready",availableCount:Te,requiredCount:de}:{type:"complete",availableCount:Te,requiredCount:de}}function cd(D){const v=Ri(D);return v.type==="incomplete"||v.type==="insufficient"}function Gl(D){const v=Ri(D);switch(v.type){case"incomplete":return v.hasUnavailablePlayers?v.unavailablePlayers.length===1?`Sélection incomplète : ${v.unavailablePlayers[0]} n'est plus disponible`:`Sélection incomplète : ${v.unavailablePlayers.length} joueurs ne sont plus disponibles`:`Sélection incomplète : ${v.availableCount} joueurs disponibles pour ${v.requiredCount} requis`;case"insufficient":return`Pas assez de joueurs : ${v.availableCount} disponibles pour ${v.requiredCount} requis`;case"ready":return`Prêt pour la sélection : ${v.availableCount} joueurs disponibles`;case"complete":return`Sélection complète : ${v.availableCount} joueurs disponibles`;default:return""}}function Kl(D){if(!D)return{};const v={};return Ve.value.forEach(H=>{v[H.name]=xn(H.name,D)}),v}function Ci(D){te.value=D,ce.value=!0}function Hl(){ce.value=!1,te.value=null}async function vr(){if(!te.value)return;const D=te.value.id,v=te.value.playerCount||6;if(Us(D)===0){V.value=!0,G.value="Aucun joueur disponible pour cet événement",setTimeout(()=>{V.value=!1},3e3);return}await _r({type:"launchSelection",data:{eventId:D,count:v}})}function Kn(){Hl(),V.value=!0,G.value="Sélection validée !",setTimeout(()=>{V.value=!1},3e3)}return(D,v)=>{var H,de,Te,qe,Se,et,ot,sn,Vt,yt;return W(),Q(Rt,null,[m("div",SO,[m("div",xO,[m("button",{onClick:yr,class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Retour à l'accueil"},v[30]||(v[30]=[m("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),m("h1",RO,_e(r.value?r.value:"Chargement..."),1),v[31]||(v[31]=m("p",{class:"text-gray-300"},"Gestion des sélections et disponibilités",-1))]),m("div",CO,[m("div",kO,[m("table",DO,[m("colgroup",null,[v[32]||(v[32]=m("col",{style:{width:"15%"}},null,-1)),(W(!0),Q(Rt,null,sr(Me.value,(ie,Le)=>(W(),Q("col",{key:Le,style:Ba("width: calc(80% / "+Me.value.length+");")},null,4))),128)),v[33]||(v[33]=m("col",{style:{width:"5%"}},null,-1))]),m("thead",null,[m("tr",VO,[m("th",NO,[m("div",OO,[v[35]||(v[35]=m("span",{class:"font-bold text-lg relative group"},[m("span",{class:"border-b-2 border-dashed border-purple-400"}," Joueurs ")],-1)),m("button",{onClick:v[0]||(v[0]=ie=>f.value=!0),class:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 cursor-pointer text-sm font-medium",title:"Ajouter un nouveau joueur"},v[34]||(v[34]=[m("span",{class:"text-lg"},"➕",-1),m("span",null,"S'ajouter",-1)]))])]),(W(!0),Q(Rt,null,sr(Me.value,ie=>(W(),Q("th",{key:ie.id,class:"p-4 text-center",onClick:Le=>Xo(ie)},[m("div",LO,[m("div",FO,[m("div",UO,[m("span",{class:"hover:border-b-2 hover:border-dashed hover:border-purple-400 transition-colors duration-200 text-white",title:"Cliquez pour voir les détails : "+ie.title},_e(Ko(ie.date)),9,BO)]),cd(ie.id)?(W(),Q("div",{key:0,class:"w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center cursor-pointer hover:bg-yellow-400 transition-colors duration-200",title:Gl(ie.id)+" - Cliquez pour ouvrir la sélection",onClick:Wn(Le=>Ci(ie),["stop"])},v[36]||(v[36]=[m("span",{class:"text-xs text-white font-bold"},"⚠️",-1)]),8,jO)):Ri(ie.id).type==="ready"?(W(),Q("div",{key:1,class:"w-4 h-4 bg-green-500 rounded-full flex items-center justify-center cursor-pointer hover:bg-green-400 transition-colors duration-200",title:Gl(ie.id)+" - Cliquez pour ouvrir la sélection",onClick:Wn(Le=>Ci(ie),["stop"])},v[37]||(v[37]=[m("span",{class:"text-xs text-white font-bold"},"🎲",-1)]),8,$O)):Ae("",!0)])])],8,MO))),128)),m("th",{class:"p-4 text-center"},[m("button",{onClick:Dt,class:"text-2xl text-purple-400 hover:text-pink-400 hover:scale-110 transition-all duration-200",title:"Ajouter un nouvel événement"}," ✨ ")])]),m("tr",qO,[v[38]||(v[38]=m("th",{class:"p-4 text-left w-[100px]"},null,-1)),(W(!0),Q(Rt,null,sr(Me.value,ie=>(W(),Q("th",{key:ie.id,class:"p-4 text-center w-40"}))),128)),v[39]||(v[39]=m("th",{class:"p-4"},null,-1))])])])]),m("div",zO,[m("table",GO,[m("colgroup",null,[v[40]||(v[40]=m("col",{style:{width:"15%"}},null,-1)),(W(!0),Q(Rt,null,sr(Me.value,(ie,Le)=>(W(),Q("col",{key:Le,style:Ba("width: calc(80% / "+Me.value.length+");")},null,4))),128)),v[41]||(v[41]=m("col",{style:{width:"5%"}},null,-1))]),m("tbody",null,[(W(!0),Q(Rt,null,sr(Ve.value,ie=>(W(),Q("tr",{key:ie.id,class:cr(["border-b border-white/10 hover:bg-white/5 transition-all duration-200",{"highlighted-player":ie.id===_.value}]),"data-player-id":ie.id},[m("td",HO,[m("div",WO,[b(ie.id)?(W(),Q("span",QO," 🔒 ")):Ae("",!0),m("span",{onClick:Le=>ql(ie),class:"hover:border-b-2 hover:border-dashed hover:border-purple-400 cursor-pointer transition-colors duration-200",title:"Cliquez pour voir les détails : "+ie.name},_e(ie.name),9,JO)])]),(W(!0),Q(Rt,null,sr(Me.value,Le=>(W(),Q("td",{key:Le.id,class:"p-4 text-center cursor-pointer hover:bg-white/10 transition-all duration-200",onClick:Qt=>Ii(ie.name,Le.id)},[m("div",XO,[Go(ie.name,Le.id)?(W(),Q("span",{key:0,class:"text-2xl hover:scale-110 transition-transform duration-200",title:er(ie,Le.id)}," 🎭 ",8,ZO)):xn(ie.name,Le.id)?(W(),Q("span",{key:1,class:"text-2xl hover:scale-110 transition-transform duration-200",title:er(ie,Le.id)}," ✅ ",8,e2)):xn(ie.name,Le.id)===!1?(W(),Q("span",{key:2,class:"text-2xl hover:scale-110 transition-transform duration-200",title:er(ie,Le.id)}," ❌ ",8,t2)):(W(),Q("span",{key:3,class:"text-gray-500 hover:text-white transition-colors duration-200",title:er(ie,Le.id)}," – ",8,n2))])],8,YO))),128)),v[42]||(v[42]=m("td",{class:"p-4"},null,-1))],10,KO))),128))])])])])]),V.value?(W(),Q("div",r2,[m("div",s2,[v[43]||(v[43]=m("span",{class:"text-xl"},"✨",-1)),m("span",null,_e(G.value),1)])])):Ae("",!0),ye.value?(W(),Q("div",i2,[m("div",o2,[v[48]||(v[48]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouvel événement",-1)),m("div",a2,[v[44]||(v[44]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),Tt(m("input",{"onUpdate:modelValue":v[1]||(v[1]=ie=>oe.value=ie),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Titre de l'événement"},null,512),[[At,oe.value]])]),m("div",l2,[v[45]||(v[45]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),Tt(m("input",{"onUpdate:modelValue":v[2]||(v[2]=ie=>me.value=ie),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white"},null,512),[[At,me.value]])]),m("div",c2,[v[46]||(v[46]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),Tt(m("textarea",{"onUpdate:modelValue":v[3]||(v[3]=ie=>Ee.value=ie),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)"},null,512),[[At,Ee.value]])]),m("div",u2,[v[47]||(v[47]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),Tt(m("input",{"onUpdate:modelValue":v[4]||(v[4]=ie=>Ie.value=ie),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",placeholder:"6"},null,512),[[At,Ie.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Gt,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:ke,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Créer ")])])])):Ae("",!0),f.value?(W(),Q("div",d2,[m("div",h2,[v[50]||(v[50]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✨ Nouveau joueur",-1)),m("div",f2,[v[49]||(v[49]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),Tt(m("input",{"onUpdate:modelValue":v[5]||(v[5]=ie=>g.value=ie),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nom du joueur"},null,512),[[At,g.value]])]),m("div",p2,[m("button",{onClick:v[6]||(v[6]=ie=>f.value=!1),class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:ne,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ajouter ")])])])):Ae("",!0),i.value?(W(),Q("div",m2,[m("div",g2,[v[51]||(v[51]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer cet événement ?</p></div>',1)),m("div",_2,[m("button",{onClick:ue,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:v[7]||(v[7]=()=>Z()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):Ae("",!0),Ai.value?(W(),Q("div",y2,[m("div",v2,[v[52]||(v[52]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">⚠️</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Êtes-vous sûr de vouloir supprimer ce joueur ?</p></div>',1)),m("div",w2,[m("button",{onClick:id,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),m("button",{onClick:v[8]||(v[8]=()=>Xr()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"Supprimer")])])])):Ae("",!0),C.value?(W(),Q("div",b2,[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},[v[53]||(v[53]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🎭</span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Attention, toute la sélection sera refaite en fonction des disponibilités actuelles.</p></div><p class="mb-6 text-sm text-yellow-400 bg-yellow-900/20 p-3 rounded-lg border border-yellow-500/20"> ⚠️ Pensez à prévenir les gens du changement ! </p>',2)),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:Ll,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),m("button",{onClick:Pi,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"},"Confirmer")])])])):Ae("",!0),Ft.value?(W(),Q("div",{key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[80] p-4",onClick:ld},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-2xl",onClick:v[11]||(v[11]=Wn(()=>{},["stop"]))},[m("div",I2,[v[54]||(v[54]=m("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-3xl"},"🎭")],-1)),m("h2",E2,_e((H=Je.value)==null?void 0:H.title),1),m("p",T2,_e(mr((de=Je.value)==null?void 0:de.date)),1)]),(Te=Je.value)!=null&&Te.description?(W(),Q("div",A2,[v[55]||(v[55]=m("h3",{class:"text-lg font-semibold text-white mb-3"},"Description",-1)),m("p",P2,_e(Je.value.description),1)])):Ae("",!0),m("div",S2,[v[59]||(v[59]=m("h3",{class:"text-lg font-semibold text-white mb-3"},"Statistiques",-1)),m("div",x2,[m("div",R2,[m("div",C2,_e(Us((qe=Je.value)==null?void 0:qe.id)),1),v[56]||(v[56]=m("div",{class:"text-sm text-gray-300"},"Disponibles",-1))]),m("div",k2,[m("div",D2,_e(Jr((Se=Je.value)==null?void 0:Se.id)),1),v[57]||(v[57]=m("div",{class:"text-sm text-gray-300"},"Sélectionnés",-1))]),m("div",V2,[m("div",N2,_e(((et=Je.value)==null?void 0:et.playerCount)||6),1),v[58]||(v[58]=m("div",{class:"text-sm text-gray-300"},"À sélectionner",-1))])])]),m("div",O2,[m("button",{onClick:$l,class:"px-4 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center space-x-2"},v[60]||(v[60]=[m("span",null,"✏️",-1),m("span",null,"Modifier",-1)])),m("button",{onClick:v[9]||(v[9]=ie=>Ci(Je.value)),class:"px-4 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center space-x-2",title:"Gérer la sélection"},v[61]||(v[61]=[m("span",null,"🎭",-1),m("span",null,"Sélection",-1)])),m("button",{onClick:v[10]||(v[10]=ie=>{var Le;return z((Le=Je.value)==null?void 0:Le.id)}),class:"px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center space-x-2"},v[62]||(v[62]=[m("span",null,"🗑️",-1),m("span",null,"Supprimer",-1)]))])])])):Ae("",!0),a.value?(W(),Q("div",M2,[m("div",L2,[v[67]||(v[67]=m("h2",{class:"text-2xl font-bold mb-6 text-white text-center"},"✏️ Modifier l'événement",-1)),m("div",F2,[v[63]||(v[63]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),Tt(m("input",{"onUpdate:modelValue":v[12]||(v[12]=ie=>c.value=ie),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Tn(X,["esc"]),Tn(se,["enter"])],ref:"editTitleInput"},null,544),[[At,c.value]])]),m("div",U2,[v[64]||(v[64]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),Tt(m("input",{"onUpdate:modelValue":v[13]||(v[13]=ie=>u.value=ie),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:[Tn(X,["esc"]),Tn(se,["enter"])]},null,544),[[At,u.value]])]),m("div",B2,[v[65]||(v[65]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),Tt(m("textarea",{"onUpdate:modelValue":v[14]||(v[14]=ie=>q.value=ie),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'événement (optionnel)",onKeydown:Tn(X,["esc"])},null,544),[[At,q.value]])]),m("div",j2,[v[66]||(v[66]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs à sélectionner",-1)),Tt(m("input",{"onUpdate:modelValue":v[15]||(v[15]=ie=>d.value=ie),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:Tn(X,["esc"])},null,544),[[At,d.value]])]),m("div",{class:"flex justify-end space-x-3"},[m("button",{onClick:X,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),m("button",{onClick:se,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):Ae("",!0),jt(Pb,{show:B.value,message:Wo(),error:L.value,"session-info":Yo(),onSubmit:Ul,onCancel:Qo},null,8,["show","message","error","session-info"]),$.value?(W(),Q("div",$2,[m("div",q2,[v[69]||(v[69]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-2">Vérification requise</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protégé par mot de passe</p></div>',1)),m("div",z2,[m("div",G2,[m("div",null,[v[68]||(v[68]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),Tt(m("input",{"onUpdate:modelValue":v[16]||(v[16]=ie=>I.value=ie),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:v[17]||(v[17]=Tn(ie=>Si(I.value),["enter"])),ref_key:"playerPasswordInputRef",ref:R},null,544),[[At,I.value]])])]),m("button",{onClick:v[18]||(v[18]=ie=>Si(I.value)),disabled:!I.value||P.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[P.value?(W(),Q("span",H2,"⏳")):(W(),Q("span",W2,"🔓")),m("span",null,_e(P.value?"Vérification...":"Vérifier et supprimer"),1)],8,K2)]),m("div",Q2,[m("button",{onClick:v[19]||(v[19]=ie=>zt.value=!0),class:"text-sm text-red-400 hover:text-red-300 transition-colors underline"}," Mot de passe oublié ? ")]),S.value?(W(),Q("div",J2,[m("div",Y2,_e(S.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:Bl,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):Ae("",!0),w.value?(W(),Q("div",X2,[m("div",Z2,[v[71]||(v[71]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">🔐</span></div><h2 class="text-2xl font-bold text-white mb-2">Vérification requise</h2><p class="text-lg text-gray-300">Modification de disponibilité</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protégé par mot de passe</p></div>',1)),m("div",eM,[m("div",tM,[m("div",null,[v[70]||(v[70]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),Tt(m("input",{"onUpdate:modelValue":v[20]||(v[20]=ie=>Re.value=ie),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:v[21]||(v[21]=Tn(ie=>Jo(Re.value),["enter"])),ref_key:"availabilityPasswordInputRef",ref:je},null,544),[[At,Re.value]])])]),m("button",{onClick:v[22]||(v[22]=ie=>Jo(Re.value)),disabled:!Re.value||Ye.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Ye.value?(W(),Q("span",rM,"⏳")):(W(),Q("span",sM,"🔓")),m("span",null,_e(Ye.value?"Vérification...":"Vérifier et modifier"),1)],8,nM)]),m("div",iM,[m("button",{onClick:v[23]||(v[23]=ie=>Oe.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oublié ? ")]),E.value?(W(),Q("div",oM,[m("div",aM,_e(E.value),1)])):Ae("",!0),m("div",{class:"flex justify-center"},[m("button",{onClick:ad,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):Ae("",!0),Oe.value?(W(),Q("div",{key:10,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:v[26]||(v[26]=ie=>Oe.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:v[25]||(v[25]=Wn(()=>{},["stop"]))},[v[73]||(v[73]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Modification de disponibilité</p></div>',1)),m("div",lM,[v[72]||(v[72]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),m("button",{onClick:xi,disabled:Ce.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Ce.value?(W(),Q("span",uM,"⏳")):(W(),Q("span",dM,"📧")),m("span",null,_e(Ce.value?"Envoi...":"Envoyer l'email"),1)],8,cM)]),qt.value?(W(),Q("div",hM,[m("div",fM,_e(qt.value),1)])):Ae("",!0),nn.value?(W(),Q("div",pM,[m("div",mM,_e(nn.value),1)])):Ae("",!0),m("div",gM,[m("button",{onClick:v[24]||(v[24]=ie=>Oe.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0),zt.value?(W(),Q("div",{key:11,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:v[29]||(v[29]=ie=>zt.value=!1)},[m("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:v[28]||(v[28]=Wn(()=>{},["stop"]))},[v[75]||(v[75]=ss('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl">📧</span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oublié</h2><p class="text-lg text-gray-300">Suppression de joueur protégé</p></div>',1)),m("div",_M,[v[74]||(v[74]=m("p",{class:"text-sm text-gray-300 mb-4"}," Un email de réinitialisation sera envoyé à l'adresse associée à ce joueur. ",-1)),m("button",{onClick:jl,disabled:Qe.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Qe.value?(W(),Q("span",vM,"⏳")):(W(),Q("span",wM,"📧")),m("span",null,_e(Qe.value?"Envoi...":"Envoyer l'email"),1)],8,yM)]),Xe.value?(W(),Q("div",bM,[m("div",IM,_e(Xe.value),1)])):Ae("",!0),bn.value?(W(),Q("div",EM,[m("div",TM,_e(bn.value),1)])):Ae("",!0),m("div",AM,[m("button",{onClick:v[27]||(v[27]=ie=>zt.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):Ae("",!0),jt(BN,{show:k.value,player:N.value,stats:zl(N.value),seasonId:s.value,onClose:Zo,onUpdate:ea,onDelete:od,onRefresh:ta},null,8,["show","player","stats","seasonId"]),jt(PO,{ref_key:"selectionModalRef",ref:fe,show:ce.value,event:te.value,"current-selection":it.value[(ot=te.value)==null?void 0:ot.id]||[],"available-count":Us((sn=te.value)==null?void 0:sn.id),"selected-count":Jr((Vt=te.value)==null?void 0:Vt.id),"player-availability":Kl((yt=te.value)==null?void 0:yt.id),onClose:Hl,onSelection:vr,onPerfect:Kn},null,8,["show","event","current-selection","available-count","selected-count","player-availability"])],64)}}},SM={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},xM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},RM={key:0,class:"text-center py-8"},CM={key:1,class:"text-center py-8"},kM={class:"text-gray-300 mb-6"},DM={key:2,class:"space-y-6"},VM={class:"text-center"},NM={class:"text-gray-300"},OM={class:"font-semibold text-white"},MM={class:"space-y-4"},LM=["disabled"],FM={key:0,class:"animate-spin"},UM={key:1},BM={key:0,class:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},jM={class:"text-red-300 text-sm"},$M={key:1,class:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},qM={class:"text-green-300 text-sm"},zM={__name:"PasswordReset",setup(n){const e=lA(),t=sf(),r=K(!0),s=K(""),i=K(null),o=K(null),a=K(null),c=K(""),u=K(""),d=K(!1),f=K(""),g=K(""),_=cn(()=>c.value&&u.value&&c.value===u.value&&c.value.length>=6);vu(async()=>{try{const{player:k,season:N,token:B,mode:F,oobCode:L}=e.query;if(console.log("🔍 [DEBUG] Paramètres reçus:",{player:k,season:N,token:B,mode:F,oobCode:L}),L&&!k&&!N){console.log("🔍 [DEBUG] Token Firebase détecté:",L),a.value=L;try{const{confirmPasswordReset:T}=await Xt(()=>import("./index.esm-a4603d05.js"),[]),{auth:E}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),{collection:Re,getDocs:Ye}=await Xt(()=>import("./index.esm-f9faeef0.js"),[]),{db:je}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),Oe=Re(je,"seasons"),Ce=await Ye(Oe);let qt=null,nn=null;for(const zt of Ce.docs){const Qe=Re(je,"seasons",zt.id,"playerProtection"),Xe=await Ye(Qe);for(const bn of Xe.docs){const Ft=bn.data();Ft.firebaseUid&&console.log("🔍 [DEBUG] Vérification protection:",Ft)}}s.value="Token Firebase reçu. Veuillez utiliser le lien direct avec player et season.",r.value=!1;return}catch(T){console.error("❌ [ERROR] Erreur Firebase:",T),s.value="Token de réinitialisation invalide ou expiré",r.value=!1;return}}if(!k||!N||!B){s.value="Lien de réinitialisation incomplet",r.value=!1;return}const $=await kD(N);if(!$){s.value="Saison non trouvée",r.value=!1;return}o.value=$.id;const ee=await zo(k,o.value);if(!ee||!ee.isProtected){s.value="Joueur non trouvé ou non protégé",r.value=!1;return}const{doc:S,getDoc:I}=await Xt(()=>import("./index.esm-f9faeef0.js"),[]),{db:P}=await Xt(()=>Promise.resolve().then(()=>kr),void 0),R=S(P,"seasons",o.value,"players",k),w=await I(R);if(!w.exists()){s.value="Joueur non trouvé",r.value=!1;return}i.value={id:k,name:w.data().name,email:ee.email}}catch(k){console.error("Erreur lors de la vérification du lien:",k),s.value="Erreur lors de la vérification du lien"}finally{r.value=!1}});async function C(){if(_.value){d.value=!0,f.value="",g.value="";try{if(a.value){const{confirmPasswordReset:k}=await Xt(()=>import("./index.esm-a4603d05.js"),[]),{auth:N}=await Xt(()=>Promise.resolve().then(()=>kr),void 0);await k(N,a.value,c.value),g.value="Mot de passe réinitialisé avec succès !"}else await DV(i.value.id,c.value,o.value),g.value="Mot de passe réinitialisé avec succès ! Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.";setTimeout(()=>{x()},3e3)}catch(k){console.error("Erreur lors de la réinitialisation:",k),f.value="Erreur lors de la réinitialisation. Veuillez réessayer."}finally{d.value=!1}}}function x(){t.push("/")}return(k,N)=>(W(),Q("div",SM,[m("div",xM,[N[8]||(N[8]=ss('<div class="text-center mb-6"><div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-3xl">🔑</span></div><h1 class="text-3xl font-bold text-white mb-2">Réinitialisation</h1><p class="text-lg text-gray-300">Nouveau mot de passe</p></div>',1)),r.value?(W(),Q("div",RM,N[2]||(N[2]=[m("div",{class:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),m("p",{class:"text-gray-300"},"Vérification du lien...",-1)]))):s.value?(W(),Q("div",CM,[N[3]||(N[3]=m("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[m("span",{class:"text-2xl"},"❌")],-1)),N[4]||(N[4]=m("h2",{class:"text-xl font-bold text-white mb-2"},"Lien invalide",-1)),m("p",kM,_e(s.value),1),m("button",{onClick:x,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300"}," Retour à l'accueil ")])):i.value?(W(),Q("div",DM,[m("div",VM,[m("p",NM,[N[5]||(N[5]=Tr("Joueur : ")),m("span",OM,_e(i.value.name),1)])]),m("div",MM,[m("div",null,[N[6]||(N[6]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nouveau mot de passe",-1)),Tt(m("input",{"onUpdate:modelValue":N[0]||(N[0]=B=>c.value=B),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nouveau mot de passe",onKeydown:Tn(C,["enter"])},null,544),[[At,c.value]])]),m("div",null,[N[7]||(N[7]=m("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),Tt(m("input",{"onUpdate:modelValue":N[1]||(N[1]=B=>u.value=B),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe",onKeydown:Tn(C,["enter"])},null,544),[[At,u.value]])])]),m("button",{onClick:C,disabled:!_.value||d.value,class:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[d.value?(W(),Q("span",FM,"⏳")):(W(),Q("span",UM,"🔑")),m("span",null,_e(d.value?"Réinitialisation...":"Réinitialiser le mot de passe"),1)],8,LM),f.value?(W(),Q("div",BM,[m("div",jM,_e(f.value),1)])):Ae("",!0),g.value?(W(),Q("div",$M,[m("div",qM,_e(g.value),1)])):Ae("",!0)])):Ae("",!0)])]))}},GM=[{path:"/",component:mV},{path:"/season/:slug",component:PM,props:!0},{path:"/reset-password",component:zM}],KM=oA({history:OT("/impro-selector/"),routes:GM});tT(sT).use(KM).mount("#app");export{lF as $,sF as A,IF as B,ID as C,aF as D,cl as E,ds as F,fs as G,MC as H,DF as I,GF as J,g_ as K,dk as L,r1 as M,TF as N,Br as O,ni as P,mF as Q,NF as R,Oh as S,mD as T,R1 as U,MF as V,jF as W,zF as X,VF as Y,PF as Z,z1 as _,Vl as a,he as a$,AC as a0,C1 as a1,LF as a2,BF as a3,qF as a4,UC as a5,CF as a6,yF as a7,D1 as a8,pF as a9,Lt as aA,Po as aB,gi as aC,_i as aD,ht as aE,Y as aF,Qf as aG,XR as aH,EC as aI,dn as aJ,Uo as aK,Sl as aL,xc as aM,Wu as aN,xl as aO,Ku as aP,ip as aQ,So as aR,Hu as aS,Ys as aT,Pt as aU,IC as aV,ju as aW,bC as aX,vv as aY,Ct as aZ,ii as a_,EF as aa,x1 as ab,gp as ac,uF as ad,O1 as ae,gF as af,OF as ag,UF as ah,$F as ai,RF as aj,cF as ak,xF as al,bF as am,F1 as an,FF as ao,wF as ap,SF as aq,AF as ar,vF as as,fF as at,Cw as au,rl as av,eC as aw,fi as ax,nL as ay,hr as az,Dl as b,vC as b$,QM as b0,qP as b1,wt as b2,ZL as b3,Be as b4,WM as b5,XL as b6,YL as b7,YM as b8,zn as b9,St as bA,Rl as bB,hC as bC,VL as bD,Ju as bE,SL as bF,xL as bG,It as bH,RL as bI,CL as bJ,ZR as bK,HL as bL,zL as bM,rL as bN,gL as bO,_L as bP,dL as bQ,NL as bR,ML as bS,OL as bT,hL as bU,kL as bV,DL as bW,pL as bX,oC as bY,LL as bZ,FL as b_,JR as ba,dC as bb,TL as bc,AL as bd,mL as be,qL as bf,$L as bg,EL as bh,oL as bi,st as bj,eL as bk,YR as bl,lC as bm,JL as bn,ru as bo,jL as bp,cL as bq,QL as br,Fe as bs,fL as bt,sL as bu,iL as bv,lL as bw,WL as bx,bL as by,wL as bz,oF as c,sp as c0,mw as c1,tL as c2,BL as c3,kw as c4,Fn as c5,KL as c6,HM as c7,PL as c8,vL as c9,yL as ca,IL as cb,uL as cc,uC as cd,GL as ce,aL as cf,Pw as cg,Dw as ch,wi as d,eF as e,hs as f,kc as g,rF as h,io as i,pD as j,tF as k,nF as l,Sp as m,ps as n,hF as o,G1 as p,Z1 as q,fD as r,fb as s,V1 as t,dF as u,i1 as v,N1 as w,iF as x,kF as y,_F as z};
