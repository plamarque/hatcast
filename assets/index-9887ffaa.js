(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function qp(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Rt={},ba=[],Or=()=>{},ux=()=>!1,th=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),zp=n=>n.startsWith("onUpdate:"),Tn=Object.assign,Kp=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},cx=Object.prototype.hasOwnProperty,bt=(n,e)=>cx.call(n,e),Ue=Array.isArray,wa=n=>Ku(n)==="[object Map]",Xa=n=>Ku(n)==="[object Set]",av=n=>Ku(n)==="[object Date]",Qe=n=>typeof n=="function",un=n=>typeof n=="string",ns=n=>typeof n=="symbol",Vt=n=>n!==null&&typeof n=="object",d0=n=>(Vt(n)||Qe(n))&&Qe(n.then)&&Qe(n.catch),h0=Object.prototype.toString,Ku=n=>h0.call(n),dx=n=>Ku(n).slice(8,-1),f0=n=>Ku(n)==="[object Object]",Gp=n=>un(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,eu=qp(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),nh=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},hx=/-(\w)/g,Tr=nh(n=>n.replace(hx,(e,t)=>t?t.toUpperCase():"")),fx=/\B([A-Z])/g,Mi=nh(n=>n.replace(fx,"-$1").toLowerCase()),rh=nh(n=>n.charAt(0).toUpperCase()+n.slice(1)),cf=nh(n=>n?`on${rh(n)}`:""),bi=(n,e)=>!Object.is(n,e),Zc=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Gf=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},wd=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let lv;const sh=()=>lv||(lv=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ys(n){if(Ue(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=un(r)?vx(r):ys(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(un(n)||Vt(n))return n}const px=/;(?![^(]*\))/g,mx=/:([^]+)/,gx=/\/\*[^]*?\*\//g;function vx(n){const e={};return n.replace(gx,"").split(px).forEach(t=>{if(t){const r=t.split(mx);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function xt(n){let e="";if(un(n))e=n;else if(Ue(n))for(let t=0;t<n.length;t++){const r=xt(n[t]);r&&(e+=r+" ")}else if(Vt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const yx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",_x=qp(yx);function p0(n){return!!n||n===""}function bx(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=Gu(n[r],e[r]);return t}function Gu(n,e){if(n===e)return!0;let t=av(n),r=av(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=ns(n),r=ns(e),t||r)return n===e;if(t=Ue(n),r=Ue(e),t||r)return t&&r?bx(n,e):!1;if(t=Vt(n),r=Vt(e),t||r){if(!t||!r)return!1;const s=Object.keys(n).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Gu(n[o],e[o]))return!1}}return String(n)===String(e)}function Hp(n,e){return n.findIndex(t=>Gu(t,e))}const m0=n=>!!(n&&n.__v_isRef===!0),ce=n=>un(n)?n:n==null?"":Ue(n)||Vt(n)&&(n.toString===h0||!Qe(n.toString))?m0(n)?ce(n.value):JSON.stringify(n,g0,2):String(n),g0=(n,e)=>m0(e)?g0(n,e.value):wa(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[df(r,i)+" =>"]=s,t),{})}:Xa(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>df(t))}:ns(e)?df(e):Vt(e)&&!Ue(e)&&!f0(e)?String(e):e,df=(n,e="")=>{var t;return ns(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ir;class wx{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ir,!e&&ir&&(this.index=(ir.scopes||(ir.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=ir;try{return ir=this,e()}finally{ir=t}}}on(){++this._on===1&&(this.prevScope=ir,ir=this)}off(){this._on>0&&--this._on===0&&(ir=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Ix(){return ir}let kt;const hf=new WeakSet;class v0{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ir&&ir.active&&ir.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,hf.has(this)&&(hf.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||_0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,uv(this),b0(this);const e=kt,t=Mr;kt=this,Mr=!0;try{return this.fn()}finally{w0(this),kt=e,Mr=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Jp(e);this.deps=this.depsTail=void 0,uv(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?hf.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Hf(this)&&this.run()}get dirty(){return Hf(this)}}let y0=0,tu,nu;function _0(n,e=!1){if(n.flags|=8,e){n.next=nu,nu=n;return}n.next=tu,tu=n}function Wp(){y0++}function Qp(){if(--y0>0)return;if(nu){let e=nu;for(nu=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;tu;){let e=tu;for(tu=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function b0(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function w0(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),Jp(r),Ex(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function Hf(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(I0(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function I0(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===gu)||(n.globalVersion=gu,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Hf(n))))return;n.flags|=2;const e=n.dep,t=kt,r=Mr;kt=n,Mr=!0;try{b0(n);const s=n.fn(n._value);(e.version===0||bi(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{kt=t,Mr=r,w0(n),n.flags&=-3}}function Jp(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Jp(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Ex(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let Mr=!0;const E0=[];function Ps(){E0.push(Mr),Mr=!1}function Rs(){const n=E0.pop();Mr=n===void 0?!0:n}function uv(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=kt;kt=void 0;try{e()}finally{kt=t}}}let gu=0;class Tx{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Yp{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!kt||!Mr||kt===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==kt)t=this.activeLink=new Tx(kt,this),kt.deps?(t.prevDep=kt.depsTail,kt.depsTail.nextDep=t,kt.depsTail=t):kt.deps=kt.depsTail=t,T0(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=kt.depsTail,t.nextDep=void 0,kt.depsTail.nextDep=t,kt.depsTail=t,kt.deps===t&&(kt.deps=r)}return t}trigger(e){this.version++,gu++,this.notify(e)}notify(e){Wp();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Qp()}}}function T0(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)T0(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Wf=new WeakMap,wo=Symbol(""),Qf=Symbol(""),vu=Symbol("");function Fn(n,e,t){if(Mr&&kt){let r=Wf.get(n);r||Wf.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new Yp),s.map=r,s.key=t),s.track()}}function _s(n,e,t,r,s,i){const o=Wf.get(n);if(!o){gu++;return}const a=l=>{l&&l.trigger()};if(Wp(),e==="clear")o.forEach(a);else{const l=Ue(n),c=l&&Gp(t);if(l&&t==="length"){const d=Number(r);o.forEach((f,g)=>{(g==="length"||g===vu||!ns(g)&&g>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(vu)),e){case"add":l?c&&a(o.get("length")):(a(o.get(wo)),wa(n)&&a(o.get(Qf)));break;case"delete":l||(a(o.get(wo)),wa(n)&&a(o.get(Qf)));break;case"set":wa(n)&&a(o.get(wo));break}}Qp()}function la(n){const e=_t(n);return e===n?e:(Fn(e,"iterate",vu),Ir(n)?e:e.map(Sn))}function ih(n){return Fn(n=_t(n),"iterate",vu),n}const xx={__proto__:null,[Symbol.iterator](){return ff(this,Symbol.iterator,Sn)},concat(...n){return la(this).concat(...n.map(e=>Ue(e)?la(e):e))},entries(){return ff(this,"entries",n=>(n[1]=Sn(n[1]),n))},every(n,e){return ps(this,"every",n,e,void 0,arguments)},filter(n,e){return ps(this,"filter",n,e,t=>t.map(Sn),arguments)},find(n,e){return ps(this,"find",n,e,Sn,arguments)},findIndex(n,e){return ps(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return ps(this,"findLast",n,e,Sn,arguments)},findLastIndex(n,e){return ps(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return ps(this,"forEach",n,e,void 0,arguments)},includes(...n){return pf(this,"includes",n)},indexOf(...n){return pf(this,"indexOf",n)},join(n){return la(this).join(n)},lastIndexOf(...n){return pf(this,"lastIndexOf",n)},map(n,e){return ps(this,"map",n,e,void 0,arguments)},pop(){return Ol(this,"pop")},push(...n){return Ol(this,"push",n)},reduce(n,...e){return cv(this,"reduce",n,e)},reduceRight(n,...e){return cv(this,"reduceRight",n,e)},shift(){return Ol(this,"shift")},some(n,e){return ps(this,"some",n,e,void 0,arguments)},splice(...n){return Ol(this,"splice",n)},toReversed(){return la(this).toReversed()},toSorted(n){return la(this).toSorted(n)},toSpliced(...n){return la(this).toSpliced(...n)},unshift(...n){return Ol(this,"unshift",n)},values(){return ff(this,"values",Sn)}};function ff(n,e,t){const r=ih(n),s=r[e]();return r!==n&&!Ir(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const Ax=Array.prototype;function ps(n,e,t,r,s,i){const o=ih(n),a=o!==n&&!Ir(n),l=o[e];if(l!==Ax[e]){const f=l.apply(n,i);return a?Sn(f):f}let c=t;o!==n&&(a?c=function(f,g){return t.call(this,Sn(f),g,n)}:t.length>2&&(c=function(f,g){return t.call(this,f,g,n)}));const d=l.call(o,c,r);return a&&s?s(d):d}function cv(n,e,t,r){const s=ih(n);let i=t;return s!==n&&(Ir(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,Sn(a),l,n)}),s[e](i,...r)}function pf(n,e,t){const r=_t(n);Fn(r,"iterate",vu);const s=r[e](...t);return(s===-1||s===!1)&&em(t[0])?(t[0]=_t(t[0]),r[e](...t)):s}function Ol(n,e,t=[]){Ps(),Wp();const r=_t(n)[e].apply(n,t);return Qp(),Rs(),r}const Sx=qp("__proto__,__v_isRef,__isVue"),x0=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(ns));function Px(n){ns(n)||(n=String(n));const e=_t(this);return Fn(e,"has",n),e.hasOwnProperty(n)}class A0{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?Fx:C0:i?R0:P0).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Ue(e);if(!s){let l;if(o&&(l=xx[t]))return l;if(t==="hasOwnProperty")return Px}const a=Reflect.get(e,t,Un(e)?e:r);return(ns(t)?x0.has(t):Sx(t))||(s||Fn(e,"get",t),i)?a:Un(a)?o&&Gp(t)?a:a.value:Vt(a)?s?D0(a):oh(a):a}}class S0 extends A0{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=xi(i);if(!Ir(r)&&!xi(r)&&(i=_t(i),r=_t(r)),!Ue(e)&&Un(i)&&!Un(r))return l?!1:(i.value=r,!0)}const o=Ue(e)&&Gp(t)?Number(t)<e.length:bt(e,t),a=Reflect.set(e,t,r,Un(e)?e:s);return e===_t(s)&&(o?bi(r,i)&&_s(e,"set",t,r):_s(e,"add",t,r)),a}deleteProperty(e,t){const r=bt(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&_s(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!ns(t)||!x0.has(t))&&Fn(e,"has",t),r}ownKeys(e){return Fn(e,"iterate",Ue(e)?"length":wo),Reflect.ownKeys(e)}}class Rx extends A0{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Cx=new S0,kx=new Rx,Dx=new S0(!0);const Jf=n=>n,$c=n=>Reflect.getPrototypeOf(n);function Nx(n,e,t){return function(...r){const s=this.__v_raw,i=_t(s),o=wa(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),d=t?Jf:e?Id:Sn;return!e&&Fn(i,"iterate",l?Qf:wo),{next(){const{value:f,done:g}=c.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function Uc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function Vx(n,e){const t={get(s){const i=this.__v_raw,o=_t(i),a=_t(s);n||(bi(s,a)&&Fn(o,"get",s),Fn(o,"get",a));const{has:l}=$c(o),c=e?Jf:n?Id:Sn;if(l.call(o,s))return c(i.get(s));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&Fn(_t(s),"iterate",wo),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=_t(i),a=_t(s);return n||(bi(s,a)&&Fn(o,"has",s),Fn(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=_t(a),c=e?Jf:n?Id:Sn;return!n&&Fn(l,"iterate",wo),a.forEach((d,f)=>s.call(i,c(d),c(f),o))}};return Tn(t,n?{add:Uc("add"),set:Uc("set"),delete:Uc("delete"),clear:Uc("clear")}:{add(s){!e&&!Ir(s)&&!xi(s)&&(s=_t(s));const i=_t(this);return $c(i).has.call(i,s)||(i.add(s),_s(i,"add",s,s)),this},set(s,i){!e&&!Ir(i)&&!xi(i)&&(i=_t(i));const o=_t(this),{has:a,get:l}=$c(o);let c=a.call(o,s);c||(s=_t(s),c=a.call(o,s));const d=l.call(o,s);return o.set(s,i),c?bi(i,d)&&_s(o,"set",s,i):_s(o,"add",s,i),this},delete(s){const i=_t(this),{has:o,get:a}=$c(i);let l=o.call(i,s);l||(s=_t(s),l=o.call(i,s)),a&&a.call(i,s);const c=i.delete(s);return l&&_s(i,"delete",s,void 0),c},clear(){const s=_t(this),i=s.size!==0,o=s.clear();return i&&_s(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Nx(s,n,e)}),t}function Xp(n,e){const t=Vx(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(bt(t,s)&&s in r?t:r,s,i)}const Ox={get:Xp(!1,!1)},Mx={get:Xp(!1,!0)},Lx={get:Xp(!0,!1)};const P0=new WeakMap,R0=new WeakMap,C0=new WeakMap,Fx=new WeakMap;function $x(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ux(n){return n.__v_skip||!Object.isExtensible(n)?0:$x(dx(n))}function oh(n){return xi(n)?n:Zp(n,!1,Cx,Ox,P0)}function k0(n){return Zp(n,!1,Dx,Mx,R0)}function D0(n){return Zp(n,!0,kx,Lx,C0)}function Zp(n,e,t,r,s){if(!Vt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=Ux(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function Ia(n){return xi(n)?Ia(n.__v_raw):!!(n&&n.__v_isReactive)}function xi(n){return!!(n&&n.__v_isReadonly)}function Ir(n){return!!(n&&n.__v_isShallow)}function em(n){return n?!!n.__v_raw:!1}function _t(n){const e=n&&n.__v_raw;return e?_t(e):n}function jx(n){return!bt(n,"__v_skip")&&Object.isExtensible(n)&&Gf(n,"__v_skip",!0),n}const Sn=n=>Vt(n)?oh(n):n,Id=n=>Vt(n)?D0(n):n;function Un(n){return n?n.__v_isRef===!0:!1}function k(n){return N0(n,!1)}function Bx(n){return N0(n,!0)}function N0(n,e){return Un(n)?n:new qx(n,e)}class qx{constructor(e,t){this.dep=new Yp,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:_t(e),this._value=t?e:Sn(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Ir(e)||xi(e);e=r?e:_t(e),bi(e,t)&&(this._rawValue=e,this._value=r?e:Sn(e),this.dep.trigger())}}function Xr(n){return Un(n)?n.value:n}const zx={get:(n,e,t)=>e==="__v_raw"?n:Xr(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return Un(s)&&!Un(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function V0(n){return Ia(n)?n:new Proxy(n,zx)}class Kx{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Yp(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=gu-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&kt!==this)return _0(this,!0),!0}get value(){const e=this.dep.track();return I0(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Gx(n,e,t=!1){let r,s;return Qe(n)?r=n:(r=n.get,s=n.set),new Kx(r,s,t)}const jc={},Ed=new WeakMap;let lo;function Hx(n,e=!1,t=lo){if(t){let r=Ed.get(t);r||Ed.set(t,r=[]),r.push(n)}}function Wx(n,e,t=Rt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,c=z=>s?z:Ir(z)||s===!1||s===0?bs(z,1):bs(z);let d,f,g,y,T=!1,A=!1;if(Un(n)?(f=()=>n.value,T=Ir(n)):Ia(n)?(f=()=>c(n),T=!0):Ue(n)?(A=!0,T=n.some(z=>Ia(z)||Ir(z)),f=()=>n.map(z=>{if(Un(z))return z.value;if(Ia(z))return c(z);if(Qe(z))return l?l(z,2):z()})):Qe(n)?e?f=l?()=>l(n,2):n:f=()=>{if(g){Ps();try{g()}finally{Rs()}}const z=lo;lo=d;try{return l?l(n,3,[y]):n(y)}finally{lo=z}}:f=Or,e&&s){const z=f,fe=s===!0?1/0:s;f=()=>bs(z(),fe)}const P=Ix(),U=()=>{d.stop(),P&&P.active&&Kp(P.effects,d)};if(i&&e){const z=e;e=(...fe)=>{z(...fe),U()}}let q=A?new Array(n.length).fill(jc):jc;const M=z=>{if(!(!(d.flags&1)||!d.dirty&&!z))if(e){const fe=d.run();if(s||T||(A?fe.some((me,x)=>bi(me,q[x])):bi(fe,q))){g&&g();const me=lo;lo=d;try{const x=[fe,q===jc?void 0:A&&q[0]===jc?[]:q,y];q=fe,l?l(e,3,x):e(...x)}finally{lo=me}}}else d.run()};return a&&a(M),d=new v0(f),d.scheduler=o?()=>o(M,!1):M,y=z=>Hx(z,!1,d),g=d.onStop=()=>{const z=Ed.get(d);if(z){if(l)l(z,4);else for(const fe of z)fe();Ed.delete(d)}},e?r?M(!0):q=d.run():o?o(M.bind(null,!0),!0):d.run(),U.pause=d.pause.bind(d),U.resume=d.resume.bind(d),U.stop=U,U}function bs(n,e=1/0,t){if(e<=0||!Vt(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Un(n))bs(n.value,e,t);else if(Ue(n))for(let r=0;r<n.length;r++)bs(n[r],e,t);else if(Xa(n)||wa(n))n.forEach(r=>{bs(r,e,t)});else if(f0(n)){for(const r in n)bs(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&bs(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Hu(n,e,t,r){try{return r?n(...r):n()}catch(s){ah(s,e,t)}}function rs(n,e,t,r){if(Qe(n)){const s=Hu(n,e,t,r);return s&&d0(s)&&s.catch(i=>{ah(i,e,t)}),s}if(Ue(n)){const s=[];for(let i=0;i<n.length;i++)s.push(rs(n[i],e,t,r));return s}}function ah(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Rt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,l,c)===!1)return}a=a.parent}if(i){Ps(),Hu(i,null,10,[n,l,c]),Rs();return}}Qx(n,t,s,r,o)}function Qx(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Yn=[];let Hr=-1;const Ea=[];let ai=null,fa=0;const O0=Promise.resolve();let Td=null;function pn(n){const e=Td||O0;return n?e.then(this?n.bind(this):n):e}function Jx(n){let e=Hr+1,t=Yn.length;for(;e<t;){const r=e+t>>>1,s=Yn[r],i=yu(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function tm(n){if(!(n.flags&1)){const e=yu(n),t=Yn[Yn.length-1];!t||!(n.flags&2)&&e>=yu(t)?Yn.push(n):Yn.splice(Jx(e),0,n),n.flags|=1,M0()}}function M0(){Td||(Td=O0.then(F0))}function Yx(n){Ue(n)?Ea.push(...n):ai&&n.id===-1?ai.splice(fa+1,0,n):n.flags&1||(Ea.push(n),n.flags|=1),M0()}function dv(n,e,t=Hr+1){for(;t<Yn.length;t++){const r=Yn[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Yn.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function L0(n){if(Ea.length){const e=[...new Set(Ea)].sort((t,r)=>yu(t)-yu(r));if(Ea.length=0,ai){ai.push(...e);return}for(ai=e,fa=0;fa<ai.length;fa++){const t=ai[fa];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}ai=null,fa=0}}const yu=n=>n.id==null?n.flags&2?-1:1/0:n.id;function F0(n){const e=Or;try{for(Hr=0;Hr<Yn.length;Hr++){const t=Yn[Hr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Hu(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Hr<Yn.length;Hr++){const t=Yn[Hr];t&&(t.flags&=-2)}Hr=-1,Yn.length=0,L0(),Td=null,(Yn.length||Ea.length)&&F0()}}let hr=null,$0=null;function xd(n){const e=hr;return hr=n,$0=n&&n.type.__scopeId||null,e}function Xx(n,e=hr,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&Ev(-1);const i=xd(e);let o;try{o=n(...s)}finally{xd(i),r._d&&Ev(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function nt(n,e){if(hr===null)return n;const t=dh(hr),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Rt]=e[s];i&&(Qe(i)&&(i={mounted:i,updated:i}),i.deep&&bs(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function io(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(Ps(),rs(l,t,8,[n.el,a,n,e]),Rs())}}const U0=Symbol("_vte"),Zx=n=>n.__isTeleport,ru=n=>n&&(n.disabled||n.disabled===""),hv=n=>n&&(n.defer||n.defer===""),fv=n=>typeof SVGElement<"u"&&n instanceof SVGElement,pv=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,Yf=(n,e)=>{const t=n&&n.to;return un(t)?e?e(t):null:t},j0={name:"Teleport",__isTeleport:!0,process(n,e,t,r,s,i,o,a,l,c){const{mc:d,pc:f,pbc:g,o:{insert:y,querySelector:T,createText:A,createComment:P}}=c,U=ru(e.props);let{shapeFlag:q,children:M,dynamicChildren:z}=e;if(n==null){const fe=e.el=A(""),me=e.anchor=A("");y(fe,t,r),y(me,t,r);const x=(w,C)=>{q&16&&(s&&s.isCE&&(s.ce._teleportTarget=w),d(M,w,C,s,i,o,a,l))},I=()=>{const w=e.target=Yf(e.props,T),C=B0(w,e,A,y);w&&(o!=="svg"&&fv(w)?o="svg":o!=="mathml"&&pv(w)&&(o="mathml"),U||(x(w,C),ed(e,!1)))};U&&(x(t,me),ed(e,!0)),hv(e.props)?(e.el.__isMounted=!1,Qn(()=>{I(),delete e.el.__isMounted},i)):I()}else{if(hv(e.props)&&n.el.__isMounted===!1){Qn(()=>{j0.process(n,e,t,r,s,i,o,a,l,c)},i);return}e.el=n.el,e.targetStart=n.targetStart;const fe=e.anchor=n.anchor,me=e.target=n.target,x=e.targetAnchor=n.targetAnchor,I=ru(n.props),w=I?t:me,C=I?fe:x;if(o==="svg"||fv(me)?o="svg":(o==="mathml"||pv(me))&&(o="mathml"),z?(g(n.dynamicChildren,z,w,s,i,o,a),om(n,e,!0)):l||f(n,e,w,C,s,i,o,a,!1),U)I?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Bc(e,t,fe,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const V=e.target=Yf(e.props,T);V&&Bc(e,V,null,c,0)}else I&&Bc(e,me,x,c,1);ed(e,U)}},remove(n,e,t,{um:r,o:{remove:s}},i){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:d,target:f,props:g}=n;if(f&&(s(c),s(d)),i&&s(l),o&16){const y=i||!ru(g);for(let T=0;T<a.length;T++){const A=a[T];r(A,e,t,y,!!A.dynamicChildren)}}},move:Bc,hydrate:eA};function Bc(n,e,t,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:d}=n,f=i===2;if(f&&r(o,e,t),(!f||ru(d))&&l&16)for(let g=0;g<c.length;g++)s(c[g],e,t,2);f&&r(a,e,t)}function eA(n,e,t,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:d}},f){const g=e.target=Yf(e.props,l);if(g){const y=ru(e.props),T=g._lpa||g.firstChild;if(e.shapeFlag&16)if(y)e.anchor=f(o(n),e,a(n),t,r,s,i),e.targetStart=T,e.targetAnchor=T&&o(T);else{e.anchor=o(n);let A=T;for(;A;){if(A&&A.nodeType===8){if(A.data==="teleport start anchor")e.targetStart=A;else if(A.data==="teleport anchor"){e.targetAnchor=A,g._lpa=e.targetAnchor&&o(e.targetAnchor);break}}A=o(A)}e.targetAnchor||B0(g,e,d,c),f(T&&o(T),e,g,t,r,s,i)}ed(e,y)}return e.anchor&&o(e.anchor)}const tA=j0;function ed(n,e){const t=n.ctx;if(t&&t.ut){let r,s;for(e?(r=n.el,s=n.anchor):(r=n.targetStart,s=n.targetAnchor);r&&r!==s;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function B0(n,e,t,r){const s=e.targetStart=t(""),i=e.targetAnchor=t("");return s[U0]=i,n&&(r(s,n),r(i,n)),i}function nm(n,e){n.shapeFlag&6&&n.component?(n.transition=e,nm(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function q0(n,e){return Qe(n)?(()=>Tn({name:n.name},e,{setup:n}))():n}function z0(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function su(n,e,t,r,s=!1){if(Ue(n)){n.forEach((T,A)=>su(T,e&&(Ue(e)?e[A]:e),t,r,s));return}if(iu(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&su(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?dh(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,d=a.refs===Rt?a.refs={}:a.refs,f=a.setupState,g=_t(f),y=f===Rt?()=>!1:T=>bt(g,T);if(c!=null&&c!==l&&(un(c)?(d[c]=null,y(c)&&(f[c]=null)):Un(c)&&(c.value=null)),Qe(l))Hu(l,a,12,[o,d]);else{const T=un(l),A=Un(l);if(T||A){const P=()=>{if(n.f){const U=T?y(l)?f[l]:d[l]:l.value;s?Ue(U)&&Kp(U,i):Ue(U)?U.includes(i)||U.push(i):T?(d[l]=[i],y(l)&&(f[l]=d[l])):(l.value=[i],n.k&&(d[n.k]=l.value))}else T?(d[l]=o,y(l)&&(f[l]=o)):A&&(l.value=o,n.k&&(d[n.k]=o))};o?(P.id=-1,Qn(P,t)):P()}}}sh().requestIdleCallback;sh().cancelIdleCallback;const iu=n=>!!n.type.__asyncLoader,K0=n=>n.type.__isKeepAlive;function nA(n,e){G0(n,"a",e)}function rA(n,e){G0(n,"da",e)}function G0(n,e,t=$n){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(lh(e,r,t),t){let s=t.parent;for(;s&&s.parent;)K0(s.parent.vnode)&&sA(r,e,t,s),s=s.parent}}function sA(n,e,t,r){const s=lh(e,n,r,!0);_a(()=>{Kp(r[e],s)},t)}function lh(n,e,t=$n,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Ps();const a=Wu(t),l=rs(e,t,n,o);return a(),Rs(),l});return r?s.unshift(i):s.push(i),i}}const Ms=n=>(e,t=$n)=>{(!bu||n==="sp")&&lh(n,(...r)=>e(...r),t)},iA=Ms("bm"),Xn=Ms("m"),oA=Ms("bu"),aA=Ms("u"),H0=Ms("bum"),_a=Ms("um"),lA=Ms("sp"),uA=Ms("rtg"),cA=Ms("rtc");function dA(n,e=$n){lh("ec",n,e)}const W0="components";function hA(n,e){return pA(W0,n,!0,e)||n}const fA=Symbol.for("v-ndc");function pA(n,e,t=!0,r=!1){const s=hr||$n;if(s){const i=s.type;if(n===W0){const a=eS(i,!1);if(a&&(a===e||a===Tr(e)||a===rh(Tr(e))))return i}const o=mv(s[n]||i[n],e)||mv(s.appContext[n],e);return!o&&r?i:o}}function mv(n,e){return n&&(n[e]||n[Tr(e)]||n[rh(Tr(e))])}function wr(n,e,t,r){let s;const i=t&&t[r],o=Ue(n);if(o||un(n)){const a=o&&Ia(n);let l=!1,c=!1;a&&(l=!Ir(n),c=xi(n),n=ih(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(l?c?Id(Sn(n[d])):Sn(n[d]):n[d],d,void 0,i&&i[d])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(Vt(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i&&i[l]));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const d=a[l];s[l]=e(n[d],d,l,i&&i[l])}}else s=[];return t&&(t[r]=s),s}const Xf=n=>n?hb(n)?dh(n):Xf(n.parent):null,ou=Tn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Xf(n.parent),$root:n=>Xf(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>rm(n),$forceUpdate:n=>n.f||(n.f=()=>{tm(n.update)}),$nextTick:n=>n.n||(n.n=pn.bind(n.proxy)),$watch:n=>OA.bind(n)}),mf=(n,e)=>n!==Rt&&!n.__isScriptSetup&&bt(n,e),mA={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(mf(r,e))return o[e]=1,r[e];if(s!==Rt&&bt(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&bt(c,e))return o[e]=3,i[e];if(t!==Rt&&bt(t,e))return o[e]=4,t[e];Zf&&(o[e]=0)}}const d=ou[e];let f,g;if(d)return e==="$attrs"&&Fn(n.attrs,"get",""),d(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==Rt&&bt(t,e))return o[e]=4,t[e];if(g=l.config.globalProperties,bt(g,e))return g[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return mf(s,e)?(s[e]=t,!0):r!==Rt&&bt(r,e)?(r[e]=t,!0):bt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==Rt&&bt(n,o)||mf(e,o)||(a=i[0])&&bt(a,o)||bt(r,o)||bt(ou,o)||bt(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:bt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function gv(n){return Ue(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Zf=!0;function gA(n){const e=rm(n),t=n.proxy,r=n.ctx;Zf=!1,e.beforeCreate&&vv(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:f,mounted:g,beforeUpdate:y,updated:T,activated:A,deactivated:P,beforeDestroy:U,beforeUnmount:q,destroyed:M,unmounted:z,render:fe,renderTracked:me,renderTriggered:x,errorCaptured:I,serverPrefetch:w,expose:C,inheritAttrs:V,components:B,directives:R,filters:It}=e;if(c&&vA(c,r,null),o)for(const j in o){const ne=o[j];Qe(ne)&&(r[j]=ne.bind(t))}if(s){const j=s.call(t,t);Vt(j)&&(n.data=oh(j))}if(Zf=!0,i)for(const j in i){const ne=i[j],Ke=Qe(ne)?ne.bind(t,t):Qe(ne.get)?ne.get.bind(t,t):Or,Be=!Qe(ne)&&Qe(ne.set)?ne.set.bind(t):Or,Ge=Oe({get:Ke,set:Be});Object.defineProperty(r,j,{enumerable:!0,configurable:!0,get:()=>Ge.value,set:re=>Ge.value=re})}if(a)for(const j in a)Q0(a[j],r,t,j);if(l){const j=Qe(l)?l.call(t):l;Reflect.ownKeys(j).forEach(ne=>{td(ne,j[ne])})}d&&vv(d,n,"c");function Y(j,ne){Ue(ne)?ne.forEach(Ke=>j(Ke.bind(t))):ne&&j(ne.bind(t))}if(Y(iA,f),Y(Xn,g),Y(oA,y),Y(aA,T),Y(nA,A),Y(rA,P),Y(dA,I),Y(cA,me),Y(uA,x),Y(H0,q),Y(_a,z),Y(lA,w),Ue(C))if(C.length){const j=n.exposed||(n.exposed={});C.forEach(ne=>{Object.defineProperty(j,ne,{get:()=>t[ne],set:Ke=>t[ne]=Ke})})}else n.exposed||(n.exposed={});fe&&n.render===Or&&(n.render=fe),V!=null&&(n.inheritAttrs=V),B&&(n.components=B),R&&(n.directives=R),w&&z0(n)}function vA(n,e,t=Or){Ue(n)&&(n=ep(n));for(const r in n){const s=n[r];let i;Vt(s)?"default"in s?i=Lr(s.from||r,s.default,!0):i=Lr(s.from||r):i=Lr(s),Un(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function vv(n,e,t){rs(Ue(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function Q0(n,e,t,r){let s=r.includes(".")?ab(t,r):()=>t[r];if(un(n)){const i=e[n];Qe(i)&&At(s,i)}else if(Qe(n))At(s,n.bind(t));else if(Vt(n))if(Ue(n))n.forEach(i=>Q0(i,e,t,r));else{const i=Qe(n.handler)?n.handler.bind(t):e[n.handler];Qe(i)&&At(s,i,n)}}function rm(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>Ad(l,c,o,!0)),Ad(l,e,o)),Vt(e)&&i.set(e,l),l}function Ad(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Ad(n,i,t,!0),s&&s.forEach(o=>Ad(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=yA[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const yA={data:yv,props:_v,emits:_v,methods:Gl,computed:Gl,beforeCreate:Wn,created:Wn,beforeMount:Wn,mounted:Wn,beforeUpdate:Wn,updated:Wn,beforeDestroy:Wn,beforeUnmount:Wn,destroyed:Wn,unmounted:Wn,activated:Wn,deactivated:Wn,errorCaptured:Wn,serverPrefetch:Wn,components:Gl,directives:Gl,watch:bA,provide:yv,inject:_A};function yv(n,e){return e?n?function(){return Tn(Qe(n)?n.call(this,this):n,Qe(e)?e.call(this,this):e)}:e:n}function _A(n,e){return Gl(ep(n),ep(e))}function ep(n){if(Ue(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Wn(n,e){return n?[...new Set([].concat(n,e))]:e}function Gl(n,e){return n?Tn(Object.create(null),n,e):e}function _v(n,e){return n?Ue(n)&&Ue(e)?[...new Set([...n,...e])]:Tn(Object.create(null),gv(n),gv(e??{})):e}function bA(n,e){if(!n)return e;if(!e)return n;const t=Tn(Object.create(null),n);for(const r in e)t[r]=Wn(n[r],e[r]);return t}function J0(){return{app:null,config:{isNativeTag:ux,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wA=0;function IA(n,e){return function(r,s=null){Qe(r)||(r=Tn({},r)),s!=null&&!Vt(s)&&(s=null);const i=J0(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:wA++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:nS,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&Qe(d.install)?(o.add(d),d.install(c,...f)):Qe(d)&&(o.add(d),d(c,...f))),c},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),c},component(d,f){return f?(i.components[d]=f,c):i.components[d]},directive(d,f){return f?(i.directives[d]=f,c):i.directives[d]},mount(d,f,g){if(!l){const y=c._ceVNode||ct(r,s);return y.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),f&&e?e(y,d):n(y,d,g),l=!0,c._container=d,d.__vue_app__=c,dh(y.component)}},onUnmount(d){a.push(d)},unmount(){l&&(rs(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(d,f){return i.provides[d]=f,c},runWithContext(d){const f=Ta;Ta=c;try{return d()}finally{Ta=f}}};return c}}let Ta=null;function td(n,e){if($n){let t=$n.provides;const r=$n.parent&&$n.parent.provides;r===t&&(t=$n.provides=Object.create(r)),t[n]=e}}function Lr(n,e,t=!1){const r=$n||hr;if(r||Ta){let s=Ta?Ta._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&Qe(e)?e.call(r&&r.proxy):e}}const Y0={},X0=()=>Object.create(Y0),Z0=n=>Object.getPrototypeOf(n)===Y0;function EA(n,e,t,r=!1){const s={},i=X0();n.propsDefaults=Object.create(null),eb(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:k0(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function TA(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=_t(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(uh(n.emitsOptions,g))continue;const y=e[g];if(l)if(bt(i,g))y!==i[g]&&(i[g]=y,c=!0);else{const T=Tr(g);s[T]=tp(l,a,T,y,n,!1)}else y!==i[g]&&(i[g]=y,c=!0)}}}else{eb(n,e,s,i)&&(c=!0);let d;for(const f in a)(!e||!bt(e,f)&&((d=Mi(f))===f||!bt(e,d)))&&(l?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=tp(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!bt(e,f))&&(delete i[f],c=!0)}c&&_s(n.attrs,"set","")}function eb(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(eu(l))continue;const c=e[l];let d;s&&bt(s,d=Tr(l))?!i||!i.includes(d)?t[d]=c:(a||(a={}))[d]=c:uh(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=_t(t),c=a||Rt;for(let d=0;d<i.length;d++){const f=i[d];t[f]=tp(s,l,f,c[f],n,!bt(c,f))}}return o}function tp(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=bt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Qe(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const d=Wu(s);r=c[t]=l.call(null,e),d()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Mi(t))&&(r=!0))}return r}const xA=new WeakMap;function tb(n,e,t=!1){const r=t?xA:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!Qe(n)){const d=f=>{l=!0;const[g,y]=tb(f,e,!0);Tn(o,g),y&&a.push(...y)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!l)return Vt(n)&&r.set(n,ba),ba;if(Ue(i))for(let d=0;d<i.length;d++){const f=Tr(i[d]);bv(f)&&(o[f]=Rt)}else if(i)for(const d in i){const f=Tr(d);if(bv(f)){const g=i[d],y=o[f]=Ue(g)||Qe(g)?{type:g}:Tn({},g),T=y.type;let A=!1,P=!0;if(Ue(T))for(let U=0;U<T.length;++U){const q=T[U],M=Qe(q)&&q.name;if(M==="Boolean"){A=!0;break}else M==="String"&&(P=!1)}else A=Qe(T)&&T.name==="Boolean";y[0]=A,y[1]=P,(A||bt(y,"default"))&&a.push(f)}}const c=[o,a];return Vt(n)&&r.set(n,c),c}function bv(n){return n[0]!=="$"&&!eu(n)}const sm=n=>n[0]==="_"||n==="$stable",im=n=>Ue(n)?n.map(Wr):[Wr(n)],AA=(n,e,t)=>{if(e._n)return e;const r=Xx((...s)=>im(e(...s)),t);return r._c=!1,r},nb=(n,e,t)=>{const r=n._ctx;for(const s in n){if(sm(s))continue;const i=n[s];if(Qe(i))e[s]=AA(s,i,r);else if(i!=null){const o=im(i);e[s]=()=>o}}},rb=(n,e)=>{const t=im(e);n.slots.default=()=>t},sb=(n,e,t)=>{for(const r in e)(t||!sm(r))&&(n[r]=e[r])},SA=(n,e,t)=>{const r=n.slots=X0();if(n.vnode.shapeFlag&32){const s=e.__;s&&Gf(r,"__",s,!0);const i=e._;i?(sb(r,e,t),t&&Gf(r,"_",i,!0)):nb(e,r)}else e&&rb(n,e)},PA=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=Rt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:sb(s,e,t):(i=!e.$stable,nb(e,s)),o=e}else e&&(rb(n,e),o={default:1});if(i)for(const a in s)!sm(a)&&o[a]==null&&delete s[a]},Qn=BA;function RA(n){return CA(n)}function CA(n,e){const t=sh();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:f,nextSibling:g,setScopeId:y=Or,insertStaticContent:T}=n,A=(E,S,O,oe=null,Z=null,ue=null,be=void 0,ye=null,_e=!!S.dynamicChildren)=>{if(E===S)return;E&&!Ml(E,S)&&(oe=D(E),re(E,Z,ue,!0),E=null),S.patchFlag===-2&&(_e=!1,S.dynamicChildren=null);const{type:pe,ref:Se,shapeFlag:Te}=S;switch(pe){case ch:P(E,S,O,oe);break;case Ai:U(E,S,O,oe);break;case nd:E==null&&q(S,O,oe,be);break;case dt:B(E,S,O,oe,Z,ue,be,ye,_e);break;default:Te&1?fe(E,S,O,oe,Z,ue,be,ye,_e):Te&6?R(E,S,O,oe,Z,ue,be,ye,_e):(Te&64||Te&128)&&pe.process(E,S,O,oe,Z,ue,be,ye,_e,se)}Se!=null&&Z?su(Se,E&&E.ref,ue,S||E,!S):Se==null&&E&&E.ref!=null&&su(E.ref,null,ue,E,!0)},P=(E,S,O,oe)=>{if(E==null)r(S.el=a(S.children),O,oe);else{const Z=S.el=E.el;S.children!==E.children&&c(Z,S.children)}},U=(E,S,O,oe)=>{E==null?r(S.el=l(S.children||""),O,oe):S.el=E.el},q=(E,S,O,oe)=>{[E.el,E.anchor]=T(E.children,S,O,oe,E.el,E.anchor)},M=({el:E,anchor:S},O,oe)=>{let Z;for(;E&&E!==S;)Z=g(E),r(E,O,oe),E=Z;r(S,O,oe)},z=({el:E,anchor:S})=>{let O;for(;E&&E!==S;)O=g(E),s(E),E=O;s(S)},fe=(E,S,O,oe,Z,ue,be,ye,_e)=>{S.type==="svg"?be="svg":S.type==="math"&&(be="mathml"),E==null?me(S,O,oe,Z,ue,be,ye,_e):w(E,S,Z,ue,be,ye,_e)},me=(E,S,O,oe,Z,ue,be,ye)=>{let _e,pe;const{props:Se,shapeFlag:Te,transition:Pe,dirs:De}=E;if(_e=E.el=o(E.type,ue,Se&&Se.is,Se),Te&8?d(_e,E.children):Te&16&&I(E.children,_e,null,oe,Z,gf(E,ue),be,ye),De&&io(E,null,oe,"created"),x(_e,E,E.scopeId,be,oe),Se){for(const He in Se)He!=="value"&&!eu(He)&&i(_e,He,null,Se[He],ue,oe);"value"in Se&&i(_e,"value",null,Se.value,ue),(pe=Se.onVnodeBeforeMount)&&Gr(pe,oe,E)}De&&io(E,null,oe,"beforeMount");const Le=kA(Z,Pe);Le&&Pe.beforeEnter(_e),r(_e,S,O),((pe=Se&&Se.onVnodeMounted)||Le||De)&&Qn(()=>{pe&&Gr(pe,oe,E),Le&&Pe.enter(_e),De&&io(E,null,oe,"mounted")},Z)},x=(E,S,O,oe,Z)=>{if(O&&y(E,O),oe)for(let ue=0;ue<oe.length;ue++)y(E,oe[ue]);if(Z){let ue=Z.subTree;if(S===ue||ub(ue.type)&&(ue.ssContent===S||ue.ssFallback===S)){const be=Z.vnode;x(E,be,be.scopeId,be.slotScopeIds,Z.parent)}}},I=(E,S,O,oe,Z,ue,be,ye,_e=0)=>{for(let pe=_e;pe<E.length;pe++){const Se=E[pe]=ye?li(E[pe]):Wr(E[pe]);A(null,Se,S,O,oe,Z,ue,be,ye)}},w=(E,S,O,oe,Z,ue,be)=>{const ye=S.el=E.el;let{patchFlag:_e,dynamicChildren:pe,dirs:Se}=S;_e|=E.patchFlag&16;const Te=E.props||Rt,Pe=S.props||Rt;let De;if(O&&oo(O,!1),(De=Pe.onVnodeBeforeUpdate)&&Gr(De,O,S,E),Se&&io(S,E,O,"beforeUpdate"),O&&oo(O,!0),(Te.innerHTML&&Pe.innerHTML==null||Te.textContent&&Pe.textContent==null)&&d(ye,""),pe?C(E.dynamicChildren,pe,ye,O,oe,gf(S,Z),ue):be||ne(E,S,ye,null,O,oe,gf(S,Z),ue,!1),_e>0){if(_e&16)V(ye,Te,Pe,O,Z);else if(_e&2&&Te.class!==Pe.class&&i(ye,"class",null,Pe.class,Z),_e&4&&i(ye,"style",Te.style,Pe.style,Z),_e&8){const Le=S.dynamicProps;for(let He=0;He<Le.length;He++){const Ze=Le[He],Yt=Te[Ze],Bt=Pe[Ze];(Bt!==Yt||Ze==="value")&&i(ye,Ze,Yt,Bt,Z,O)}}_e&1&&E.children!==S.children&&d(ye,S.children)}else!be&&pe==null&&V(ye,Te,Pe,O,Z);((De=Pe.onVnodeUpdated)||Se)&&Qn(()=>{De&&Gr(De,O,S,E),Se&&io(S,E,O,"updated")},oe)},C=(E,S,O,oe,Z,ue,be)=>{for(let ye=0;ye<S.length;ye++){const _e=E[ye],pe=S[ye],Se=_e.el&&(_e.type===dt||!Ml(_e,pe)||_e.shapeFlag&198)?f(_e.el):O;A(_e,pe,Se,null,oe,Z,ue,be,!0)}},V=(E,S,O,oe,Z)=>{if(S!==O){if(S!==Rt)for(const ue in S)!eu(ue)&&!(ue in O)&&i(E,ue,S[ue],null,Z,oe);for(const ue in O){if(eu(ue))continue;const be=O[ue],ye=S[ue];be!==ye&&ue!=="value"&&i(E,ue,ye,be,Z,oe)}"value"in O&&i(E,"value",S.value,O.value,Z)}},B=(E,S,O,oe,Z,ue,be,ye,_e)=>{const pe=S.el=E?E.el:a(""),Se=S.anchor=E?E.anchor:a("");let{patchFlag:Te,dynamicChildren:Pe,slotScopeIds:De}=S;De&&(ye=ye?ye.concat(De):De),E==null?(r(pe,O,oe),r(Se,O,oe),I(S.children||[],O,Se,Z,ue,be,ye,_e)):Te>0&&Te&64&&Pe&&E.dynamicChildren?(C(E.dynamicChildren,Pe,O,Z,ue,be,ye),(S.key!=null||Z&&S===Z.subTree)&&om(E,S,!0)):ne(E,S,O,Se,Z,ue,be,ye,_e)},R=(E,S,O,oe,Z,ue,be,ye,_e)=>{S.slotScopeIds=ye,E==null?S.shapeFlag&512?Z.ctx.activate(S,O,oe,be,_e):It(S,O,oe,Z,ue,be,_e):vt(E,S,_e)},It=(E,S,O,oe,Z,ue,be)=>{const ye=E.component=QA(E,oe,Z);if(K0(E)&&(ye.ctx.renderer=se),JA(ye,!1,be),ye.asyncDep){if(Z&&Z.registerDep(ye,Y,be),!E.el){const _e=ye.subTree=ct(Ai);U(null,_e,S,O)}}else Y(ye,E,S,O,Z,ue,be)},vt=(E,S,O)=>{const oe=S.component=E.component;if(UA(E,S,O))if(oe.asyncDep&&!oe.asyncResolved){j(oe,S,O);return}else oe.next=S,oe.update();else S.el=E.el,oe.vnode=S},Y=(E,S,O,oe,Z,ue,be)=>{const ye=()=>{if(E.isMounted){let{next:Te,bu:Pe,u:De,parent:Le,vnode:He}=E;{const Mt=ib(E);if(Mt){Te&&(Te.el=He.el,j(E,Te,be)),Mt.asyncDep.then(()=>{E.isUnmounted||ye()});return}}let Ze=Te,Yt;oo(E,!1),Te?(Te.el=He.el,j(E,Te,be)):Te=He,Pe&&Zc(Pe),(Yt=Te.props&&Te.props.onVnodeBeforeUpdate)&&Gr(Yt,Le,Te,He),oo(E,!0);const Bt=vf(E),_n=E.subTree;E.subTree=Bt,A(_n,Bt,f(_n.el),D(_n),E,Z,ue),Te.el=Bt.el,Ze===null&&jA(E,Bt.el),De&&Qn(De,Z),(Yt=Te.props&&Te.props.onVnodeUpdated)&&Qn(()=>Gr(Yt,Le,Te,He),Z)}else{let Te;const{el:Pe,props:De}=S,{bm:Le,m:He,parent:Ze,root:Yt,type:Bt}=E,_n=iu(S);if(oo(E,!1),Le&&Zc(Le),!_n&&(Te=De&&De.onVnodeBeforeMount)&&Gr(Te,Ze,S),oo(E,!0),Pe&&$e){const Mt=()=>{E.subTree=vf(E),$e(Pe,E.subTree,E,Z,null)};_n&&Bt.__asyncHydrate?Bt.__asyncHydrate(Pe,E,Mt):Mt()}else{Yt.ce&&Yt.ce._def.shadowRoot!==!1&&Yt.ce._injectChildStyle(Bt);const Mt=E.subTree=vf(E);A(null,Mt,O,oe,E,Z,ue),S.el=Mt.el}if(He&&Qn(He,Z),!_n&&(Te=De&&De.onVnodeMounted)){const Mt=S;Qn(()=>Gr(Te,Ze,Mt),Z)}(S.shapeFlag&256||Ze&&iu(Ze.vnode)&&Ze.vnode.shapeFlag&256)&&E.a&&Qn(E.a,Z),E.isMounted=!0,S=O=oe=null}};E.scope.on();const _e=E.effect=new v0(ye);E.scope.off();const pe=E.update=_e.run.bind(_e),Se=E.job=_e.runIfDirty.bind(_e);Se.i=E,Se.id=E.uid,_e.scheduler=()=>tm(Se),oo(E,!0),pe()},j=(E,S,O)=>{S.component=E;const oe=E.vnode.props;E.vnode=S,E.next=null,TA(E,S.props,oe,O),PA(E,S.children,O),Ps(),dv(E),Rs()},ne=(E,S,O,oe,Z,ue,be,ye,_e=!1)=>{const pe=E&&E.children,Se=E?E.shapeFlag:0,Te=S.children,{patchFlag:Pe,shapeFlag:De}=S;if(Pe>0){if(Pe&128){Be(pe,Te,O,oe,Z,ue,be,ye,_e);return}else if(Pe&256){Ke(pe,Te,O,oe,Z,ue,be,ye,_e);return}}De&8?(Se&16&&ht(pe,Z,ue),Te!==pe&&d(O,Te)):Se&16?De&16?Be(pe,Te,O,oe,Z,ue,be,ye,_e):ht(pe,Z,ue,!0):(Se&8&&d(O,""),De&16&&I(Te,O,oe,Z,ue,be,ye,_e))},Ke=(E,S,O,oe,Z,ue,be,ye,_e)=>{E=E||ba,S=S||ba;const pe=E.length,Se=S.length,Te=Math.min(pe,Se);let Pe;for(Pe=0;Pe<Te;Pe++){const De=S[Pe]=_e?li(S[Pe]):Wr(S[Pe]);A(E[Pe],De,O,null,Z,ue,be,ye,_e)}pe>Se?ht(E,Z,ue,!0,!1,Te):I(S,O,oe,Z,ue,be,ye,_e,Te)},Be=(E,S,O,oe,Z,ue,be,ye,_e)=>{let pe=0;const Se=S.length;let Te=E.length-1,Pe=Se-1;for(;pe<=Te&&pe<=Pe;){const De=E[pe],Le=S[pe]=_e?li(S[pe]):Wr(S[pe]);if(Ml(De,Le))A(De,Le,O,null,Z,ue,be,ye,_e);else break;pe++}for(;pe<=Te&&pe<=Pe;){const De=E[Te],Le=S[Pe]=_e?li(S[Pe]):Wr(S[Pe]);if(Ml(De,Le))A(De,Le,O,null,Z,ue,be,ye,_e);else break;Te--,Pe--}if(pe>Te){if(pe<=Pe){const De=Pe+1,Le=De<Se?S[De].el:oe;for(;pe<=Pe;)A(null,S[pe]=_e?li(S[pe]):Wr(S[pe]),O,Le,Z,ue,be,ye,_e),pe++}}else if(pe>Pe)for(;pe<=Te;)re(E[pe],Z,ue,!0),pe++;else{const De=pe,Le=pe,He=new Map;for(pe=Le;pe<=Pe;pe++){const cn=S[pe]=_e?li(S[pe]):Wr(S[pe]);cn.key!=null&&He.set(cn.key,pe)}let Ze,Yt=0;const Bt=Pe-Le+1;let _n=!1,Mt=0;const mr=new Array(Bt);for(pe=0;pe<Bt;pe++)mr[pe]=0;for(pe=De;pe<=Te;pe++){const cn=E[pe];if(Yt>=Bt){re(cn,Z,ue,!0);continue}let Cn;if(cn.key!=null)Cn=He.get(cn.key);else for(Ze=Le;Ze<=Pe;Ze++)if(mr[Ze-Le]===0&&Ml(cn,S[Ze])){Cn=Ze;break}Cn===void 0?re(cn,Z,ue,!0):(mr[Cn-Le]=pe+1,Cn>=Mt?Mt=Cn:_n=!0,A(cn,S[Cn],O,null,Z,ue,be,ye,_e),Yt++)}const Ur=_n?DA(mr):ba;for(Ze=Ur.length-1,pe=Bt-1;pe>=0;pe--){const cn=Le+pe,Cn=S[cn],zi=cn+1<Se?S[cn+1].el:oe;mr[pe]===0?A(null,Cn,O,zi,Z,ue,be,ye,_e):_n&&(Ze<0||pe!==Ur[Ze]?Ge(Cn,O,zi,2):Ze--)}}},Ge=(E,S,O,oe,Z=null)=>{const{el:ue,type:be,transition:ye,children:_e,shapeFlag:pe}=E;if(pe&6){Ge(E.component.subTree,S,O,oe);return}if(pe&128){E.suspense.move(S,O,oe);return}if(pe&64){be.move(E,S,O,se);return}if(be===dt){r(ue,S,O);for(let Te=0;Te<_e.length;Te++)Ge(_e[Te],S,O,oe);r(E.anchor,S,O);return}if(be===nd){M(E,S,O);return}if(oe!==2&&pe&1&&ye)if(oe===0)ye.beforeEnter(ue),r(ue,S,O),Qn(()=>ye.enter(ue),Z);else{const{leave:Te,delayLeave:Pe,afterLeave:De}=ye,Le=()=>{E.ctx.isUnmounted?s(ue):r(ue,S,O)},He=()=>{Te(ue,()=>{Le(),De&&De()})};Pe?Pe(ue,Le,He):He()}else r(ue,S,O)},re=(E,S,O,oe=!1,Z=!1)=>{const{type:ue,props:be,ref:ye,children:_e,dynamicChildren:pe,shapeFlag:Se,patchFlag:Te,dirs:Pe,cacheIndex:De}=E;if(Te===-2&&(Z=!1),ye!=null&&(Ps(),su(ye,null,O,E,!0),Rs()),De!=null&&(S.renderCache[De]=void 0),Se&256){S.ctx.deactivate(E);return}const Le=Se&1&&Pe,He=!iu(E);let Ze;if(He&&(Ze=be&&be.onVnodeBeforeUnmount)&&Gr(Ze,S,E),Se&6)Xe(E.component,O,oe);else{if(Se&128){E.suspense.unmount(O,oe);return}Le&&io(E,null,S,"beforeUnmount"),Se&64?E.type.remove(E,S,O,se,oe):pe&&!pe.hasOnce&&(ue!==dt||Te>0&&Te&64)?ht(pe,S,O,!1,!0):(ue===dt&&Te&384||!Z&&Se&16)&&ht(_e,S,O),oe&&ee(E)}(He&&(Ze=be&&be.onVnodeUnmounted)||Le)&&Qn(()=>{Ze&&Gr(Ze,S,E),Le&&io(E,null,S,"unmounted")},O)},ee=E=>{const{type:S,el:O,anchor:oe,transition:Z}=E;if(S===dt){je(O,oe);return}if(S===nd){z(E);return}const ue=()=>{s(O),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(E.shapeFlag&1&&Z&&!Z.persisted){const{leave:be,delayLeave:ye}=Z,_e=()=>be(O,ue);ye?ye(E.el,ue,_e):_e()}else ue()},je=(E,S)=>{let O;for(;E!==S;)O=g(E),s(E),E=O;s(S)},Xe=(E,S,O)=>{const{bum:oe,scope:Z,job:ue,subTree:be,um:ye,m:_e,a:pe,parent:Se,slots:{__:Te}}=E;wv(_e),wv(pe),oe&&Zc(oe),Se&&Ue(Te)&&Te.forEach(Pe=>{Se.renderCache[Pe]=void 0}),Z.stop(),ue&&(ue.flags|=8,re(be,E,S,O)),ye&&Qn(ye,S),Qn(()=>{E.isUnmounted=!0},S),S&&S.pendingBranch&&!S.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===S.pendingId&&(S.deps--,S.deps===0&&S.resolve())},ht=(E,S,O,oe=!1,Z=!1,ue=0)=>{for(let be=ue;be<E.length;be++)re(E[be],S,O,oe,Z)},D=E=>{if(E.shapeFlag&6)return D(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const S=g(E.anchor||E.el),O=S&&S[U0];return O?g(O):S};let $=!1;const X=(E,S,O)=>{E==null?S._vnode&&re(S._vnode,null,null,!0):A(S._vnode||null,E,S,null,null,null,O),S._vnode=E,$||($=!0,dv(),L0(),$=!1)},se={p:A,um:re,m:Ge,r:ee,mt:It,mc:I,pc:ne,pbc:C,n:D,o:n};let ke,$e;return e&&([ke,$e]=e(se)),{render:X,hydrate:ke,createApp:IA(X,ke)}}function gf({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function oo({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function kA(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function om(n,e,t=!1){const r=n.children,s=e.children;if(Ue(r)&&Ue(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=li(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&om(o,a)),a.type===ch&&(a.el=o.el),a.type===Ai&&!a.el&&(a.el=o.el)}}function DA(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function ib(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:ib(e)}function wv(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const NA=Symbol.for("v-scx"),VA=()=>Lr(NA);function At(n,e,t){return ob(n,e,t)}function ob(n,e,t=Rt){const{immediate:r,deep:s,flush:i,once:o}=t,a=Tn({},t),l=e&&r||!e&&i!=="post";let c;if(bu){if(i==="sync"){const y=VA();c=y.__watcherHandles||(y.__watcherHandles=[])}else if(!l){const y=()=>{};return y.stop=Or,y.resume=Or,y.pause=Or,y}}const d=$n;a.call=(y,T,A)=>rs(y,d,T,A);let f=!1;i==="post"?a.scheduler=y=>{Qn(y,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(y,T)=>{T?y():tm(y)}),a.augmentJob=y=>{e&&(y.flags|=4),f&&(y.flags|=2,d&&(y.id=d.uid,y.i=d))};const g=Wx(n,e,a);return bu&&(c?c.push(g):l&&g()),g}function OA(n,e,t){const r=this.proxy,s=un(n)?n.includes(".")?ab(r,n):()=>r[n]:n.bind(r,r);let i;Qe(e)?i=e:(i=e.handler,t=e);const o=Wu(this),a=ob(s,i.bind(r),t);return o(),a}function ab(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const MA=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${Tr(e)}Modifiers`]||n[`${Mi(e)}Modifiers`];function LA(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Rt;let s=t;const i=e.startsWith("update:"),o=i&&MA(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>un(d)?d.trim():d)),o.number&&(s=t.map(wd)));let a,l=r[a=cf(e)]||r[a=cf(Tr(e))];!l&&i&&(l=r[a=cf(Mi(e))]),l&&rs(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,rs(c,n,6,s)}}function lb(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!Qe(n)){const l=c=>{const d=lb(c,e,!0);d&&(a=!0,Tn(o,d))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(Vt(n)&&r.set(n,null),null):(Ue(i)?i.forEach(l=>o[l]=null):Tn(o,i),Vt(n)&&r.set(n,o),o)}function uh(n,e){return!n||!th(e)?!1:(e=e.slice(2).replace(/Once$/,""),bt(n,e[0].toLowerCase()+e.slice(1))||bt(n,Mi(e))||bt(n,e))}function vf(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:d,props:f,data:g,setupState:y,ctx:T,inheritAttrs:A}=n,P=xd(n);let U,q;try{if(t.shapeFlag&4){const z=s||r,fe=z;U=Wr(c.call(fe,z,d,f,y,g,T)),q=a}else{const z=e;U=Wr(z.length>1?z(f,{attrs:a,slots:o,emit:l}):z(f,null)),q=e.props?a:FA(a)}}catch(z){au.length=0,ah(z,n,1),U=ct(Ai)}let M=U;if(q&&A!==!1){const z=Object.keys(q),{shapeFlag:fe}=M;z.length&&fe&7&&(i&&z.some(zp)&&(q=$A(q,i)),M=ka(M,q,!1,!0))}return t.dirs&&(M=ka(M,null,!1,!0),M.dirs=M.dirs?M.dirs.concat(t.dirs):t.dirs),t.transition&&nm(M,t.transition),U=M,xd(P),U}const FA=n=>{let e;for(const t in n)(t==="class"||t==="style"||th(t))&&((e||(e={}))[t]=n[t]);return e},$A=(n,e)=>{const t={};for(const r in n)(!zp(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function UA(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?Iv(r,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(o[g]!==r[g]&&!uh(c,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Iv(r,o,c):!0:!!o;return!1}function Iv(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!uh(t,i))return!0}return!1}function jA({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const ub=n=>n.__isSuspense;function BA(n,e){e&&e.pendingBranch?Ue(n)?e.effects.push(...n):e.effects.push(n):Yx(n)}const dt=Symbol.for("v-fgt"),ch=Symbol.for("v-txt"),Ai=Symbol.for("v-cmt"),nd=Symbol.for("v-stc"),au=[];let fr=null;function L(n=!1){au.push(fr=n?null:[])}function qA(){au.pop(),fr=au[au.length-1]||null}let _u=1;function Ev(n,e=!1){_u+=n,n<0&&fr&&e&&(fr.hasOnce=!0)}function cb(n){return n.dynamicChildren=_u>0?fr||ba:null,qA(),_u>0&&fr&&fr.push(n),n}function F(n,e,t,r,s,i){return cb(h(n,e,t,r,s,i,!0))}function Sd(n,e,t,r,s){return cb(ct(n,e,t,r,s,!0))}function Pd(n){return n?n.__v_isVNode===!0:!1}function Ml(n,e){return n.type===e.type&&n.key===e.key}const db=({key:n})=>n??null,rd=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?un(n)||Un(n)||Qe(n)?{i:hr,r:n,k:e,f:!!t}:n:null);function h(n,e=null,t=null,r=0,s=null,i=n===dt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&db(e),ref:e&&rd(e),scopeId:$0,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:hr};return a?(am(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=un(t)?8:16),_u>0&&!o&&fr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&fr.push(l),l}const ct=zA;function zA(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===fA)&&(n=Ai),Pd(n)){const a=ka(n,e,!0);return t&&am(a,t),_u>0&&!i&&fr&&(a.shapeFlag&6?fr[fr.indexOf(n)]=a:fr.push(a)),a.patchFlag=-2,a}if(tS(n)&&(n=n.__vccOpts),e){e=KA(e);let{class:a,style:l}=e;a&&!un(a)&&(e.class=xt(a)),Vt(l)&&(em(l)&&!Ue(l)&&(l=Tn({},l)),e.style=ys(l))}const o=un(n)?1:ub(n)?128:Zx(n)?64:Vt(n)?4:Qe(n)?2:0;return h(n,e,t,r,s,o,i,!0)}function KA(n){return n?em(n)||Z0(n)?Tn({},n):n:null}function ka(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?GA(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&db(c),ref:e&&e.ref?t&&i?Ue(i)?i.concat(rd(e)):[i,rd(e)]:rd(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==dt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&ka(n.ssContent),ssFallback:n.ssFallback&&ka(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&nm(d,l.clone(d)),d}function Nt(n=" ",e=0){return ct(ch,null,n,e)}function Jn(n,e){const t=ct(nd,null,n);return t.staticCount=e,t}function ve(n="",e=!1){return e?(L(),Sd(Ai,null,n)):ct(Ai,null,n)}function Wr(n){return n==null||typeof n=="boolean"?ct(Ai):Ue(n)?ct(dt,null,n.slice()):Pd(n)?li(n):ct(ch,null,String(n))}function li(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:ka(n)}function am(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Ue(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),am(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Z0(e)?e._ctx=hr:s===3&&hr&&(hr.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Qe(e)?(e={default:e,_ctx:hr},t=32):(e=String(e),r&64?(t=16,e=[Nt(e)]):t=8);n.children=e,n.shapeFlag|=t}function GA(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=xt([e.class,r.class]));else if(s==="style")e.style=ys([e.style,r.style]);else if(th(s)){const i=e[s],o=r[s];o&&i!==o&&!(Ue(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Gr(n,e,t,r=null){rs(n,e,7,[t,r])}const HA=J0();let WA=0;function QA(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||HA,i={uid:WA++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new wx(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:tb(r,s),emitsOptions:lb(r,s),emit:null,emitted:null,propsDefaults:Rt,inheritAttrs:r.inheritAttrs,ctx:Rt,data:Rt,props:Rt,attrs:Rt,slots:Rt,refs:Rt,setupState:Rt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=LA.bind(null,i),n.ce&&n.ce(i),i}let $n=null,Rd,np;{const n=sh(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Rd=e("__VUE_INSTANCE_SETTERS__",t=>$n=t),np=e("__VUE_SSR_SETTERS__",t=>bu=t)}const Wu=n=>{const e=$n;return Rd(n),n.scope.on(),()=>{n.scope.off(),Rd(e)}},Tv=()=>{$n&&$n.scope.off(),Rd(null)};function hb(n){return n.vnode.shapeFlag&4}let bu=!1;function JA(n,e=!1,t=!1){e&&np(e);const{props:r,children:s}=n.vnode,i=hb(n);EA(n,r,i,e),SA(n,s,t||e);const o=i?YA(n,e):void 0;return e&&np(!1),o}function YA(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,mA);const{setup:r}=t;if(r){Ps();const s=n.setupContext=r.length>1?ZA(n):null,i=Wu(n),o=Hu(r,n,0,[n.props,s]),a=d0(o);if(Rs(),i(),(a||n.sp)&&!iu(n)&&z0(n),a){if(o.then(Tv,Tv),e)return o.then(l=>{xv(n,l,e)}).catch(l=>{ah(l,n,0)});n.asyncDep=o}else xv(n,o,e)}else fb(n,e)}function xv(n,e,t){Qe(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Vt(e)&&(n.setupState=V0(e)),fb(n,t)}let Av;function fb(n,e,t){const r=n.type;if(!n.render){if(!e&&Av&&!r.render){const s=r.template||rm(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=Tn(Tn({isCustomElement:i,delimiters:a},o),l);r.render=Av(s,c)}}n.render=r.render||Or}{const s=Wu(n);Ps();try{gA(n)}finally{Rs(),s()}}}const XA={get(n,e){return Fn(n,"get",""),n[e]}};function ZA(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,XA),slots:n.slots,emit:n.emit,expose:e}}function dh(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(V0(jx(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in ou)return ou[t](n)},has(e,t){return t in e||t in ou}})):n.proxy}function eS(n,e=!0){return Qe(n)?n.displayName||n.name:n.name||e&&n.__name}function tS(n){return Qe(n)&&"__vccOpts"in n}const Oe=(n,e)=>Gx(n,e,bu);function pb(n,e,t){const r=arguments.length;return r===2?Vt(e)&&!Ue(e)?Pd(e)?ct(n,null,[e]):ct(n,e):ct(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Pd(t)&&(t=[t]),ct(n,e,t))}const nS="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rp;const Sv=typeof window<"u"&&window.trustedTypes;if(Sv)try{rp=Sv.createPolicy("vue",{createHTML:n=>n})}catch{}const mb=rp?n=>rp.createHTML(n):n=>n,rS="http://www.w3.org/2000/svg",sS="http://www.w3.org/1998/Math/MathML",gs=typeof document<"u"?document:null,Pv=gs&&gs.createElement("template"),iS={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?gs.createElementNS(rS,n):e==="mathml"?gs.createElementNS(sS,n):t?gs.createElement(n,{is:t}):gs.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>gs.createTextNode(n),createComment:n=>gs.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>gs.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Pv.innerHTML=mb(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Pv.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},oS=Symbol("_vtc");function aS(n,e,t){const r=n[oS];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Cd=Symbol("_vod"),gb=Symbol("_vsh"),yf={beforeMount(n,{value:e},{transition:t}){n[Cd]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Ll(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),Ll(n,!0),r.enter(n)):r.leave(n,()=>{Ll(n,!1)}):Ll(n,e))},beforeUnmount(n,{value:e}){Ll(n,e)}};function Ll(n,e){n.style.display=e?n[Cd]:"none",n[gb]=!e}const lS=Symbol(""),uS=/(^|;)\s*display\s*:/;function cS(n,e,t){const r=n.style,s=un(t);let i=!1;if(t&&!s){if(e)if(un(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&sd(r,a,"")}else for(const o in e)t[o]==null&&sd(r,o,"");for(const o in t)o==="display"&&(i=!0),sd(r,o,t[o])}else if(s){if(e!==t){const o=r[lS];o&&(t+=";"+o),r.cssText=t,i=uS.test(t)}}else e&&n.removeAttribute("style");Cd in n&&(n[Cd]=i?r.display:"",n[gb]&&(r.display="none"))}const Rv=/\s*!important$/;function sd(n,e,t){if(Ue(t))t.forEach(r=>sd(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=dS(n,e);Rv.test(t)?n.setProperty(Mi(r),t.replace(Rv,""),"important"):n[r]=t}}const Cv=["Webkit","Moz","ms"],_f={};function dS(n,e){const t=_f[e];if(t)return t;let r=Tr(e);if(r!=="filter"&&r in n)return _f[e]=r;r=rh(r);for(let s=0;s<Cv.length;s++){const i=Cv[s]+r;if(i in n)return _f[e]=i}return e}const kv="http://www.w3.org/1999/xlink";function Dv(n,e,t,r,s,i=_x(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(kv,e.slice(6,e.length)):n.setAttributeNS(kv,e,t):t==null||i&&!p0(t)?n.removeAttribute(e):n.setAttribute(e,i?"":ns(t)?String(t):t)}function Nv(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?mb(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=p0(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function ci(n,e,t,r){n.addEventListener(e,t,r)}function hS(n,e,t,r){n.removeEventListener(e,t,r)}const Vv=Symbol("_vei");function fS(n,e,t,r,s=null){const i=n[Vv]||(n[Vv]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=pS(e);if(r){const c=i[e]=vS(r,s);ci(n,a,c,l)}else o&&(hS(n,a,o,l),i[e]=void 0)}}const Ov=/(?:Once|Passive|Capture)$/;function pS(n){let e;if(Ov.test(n)){e={};let r;for(;r=n.match(Ov);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Mi(n.slice(2)),e]}let bf=0;const mS=Promise.resolve(),gS=()=>bf||(mS.then(()=>bf=0),bf=Date.now());function vS(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;rs(yS(r,t.value),e,5,[r])};return t.value=n,t.attached=gS(),t}function yS(n,e){if(Ue(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Mv=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,_S=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?aS(n,r,o):e==="style"?cS(n,t,r):th(e)?zp(e)||fS(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):bS(n,e,r,o))?(Nv(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Dv(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!un(r))?Nv(n,Tr(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Dv(n,e,r,o))};function bS(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Mv(e)&&Qe(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Mv(e)&&un(t)?!1:e in n}const Da=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Ue(e)?t=>Zc(e,t):e};function wS(n){n.target.composing=!0}function Lv(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const xs=Symbol("_assign"),Dt={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[xs]=Da(s);const i=r||s.props&&s.props.type==="number";ci(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=wd(a)),n[xs](a)}),t&&ci(n,"change",()=>{n.value=n.value.trim()}),e||(ci(n,"compositionstart",wS),ci(n,"compositionend",Lv),ci(n,"change",Lv))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[xs]=Da(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?wd(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},yi={deep:!0,created(n,e,t){n[xs]=Da(t),ci(n,"change",()=>{const r=n._modelValue,s=wu(n),i=n.checked,o=n[xs];if(Ue(r)){const a=Hp(r,s),l=a!==-1;if(i&&!l)o(r.concat(s));else if(!i&&l){const c=[...r];c.splice(a,1),o(c)}}else if(Xa(r)){const a=new Set(r);i?a.add(s):a.delete(s),o(a)}else o(vb(n,i))})},mounted:Fv,beforeUpdate(n,e,t){n[xs]=Da(t),Fv(n,e,t)}};function Fv(n,{value:e,oldValue:t},r){n._modelValue=e;let s;if(Ue(e))s=Hp(e,r.props.value)>-1;else if(Xa(e))s=e.has(r.props.value);else{if(e===t)return;s=Gu(e,vb(n,!0))}n.checked!==s&&(n.checked=s)}const IS={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const s=Xa(e);ci(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?wd(wu(o)):wu(o));n[xs](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,pn(()=>{n._assigning=!1})}),n[xs]=Da(r)},mounted(n,{value:e}){$v(n,e)},beforeUpdate(n,e,t){n[xs]=Da(t)},updated(n,{value:e}){n._assigning||$v(n,e)}};function $v(n,e){const t=n.multiple,r=Ue(e);if(!(t&&!r&&!Xa(e))){for(let s=0,i=n.options.length;s<i;s++){const o=n.options[s],a=wu(o);if(t)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=Hp(e,a)>-1}else o.selected=e.has(a);else if(Gu(wu(o),e)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function wu(n){return"_value"in n?n._value:n.value}function vb(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const ES=["ctrl","shift","alt","meta"],TS={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>ES.some(t=>n[`${t}Key`]&&!e.includes(t))},Ft=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=TS[e[o]];if(a&&a(s,e))return}return n(s,...i)})},xS={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Mn=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Mi(s.key);if(e.some(o=>o===i||xS[o]===i))return n(s)})},AS=Tn({patchProp:_S},iS);let Uv;function SS(){return Uv||(Uv=RA(AS))}const PS=(...n)=>{const e=SS().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=CS(r);if(!s)return;const i=e._component;!Qe(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,RS(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function RS(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function CS(n){return un(n)?document.querySelector(n):n}const kS={__name:"App",setup(n){const e=k(null),t=k(!1);function r(o){o.preventDefault(),e.value=o,t.value=!0}async function s(){e.value&&(e.value.prompt(),await e.value.userChoice,t.value=!1,e.value=null)}function i(){t.value=!1,e.value=null}return Xn(()=>{window.addEventListener("beforeinstallprompt",r),window.addEventListener("appinstalled",i)}),H0(()=>{window.removeEventListener("beforeinstallprompt",r),window.removeEventListener("appinstalled",i)}),(o,a)=>{const l=hA("router-view");return L(),F(dt,null,[ct(l),t.value?(L(),F("button",{key:0,class:"fixed bottom-4 right-4 z-50 rounded-full bg-sky-600 text-white px-4 py-2 shadow-lg hover:bg-sky-700 active:bg-sky-800",onClick:s}," Installer lapp ")):ve("",!0)],64)}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const pa=typeof document<"u";function yb(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function DS(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&yb(n.default)}const yt=Object.assign;function wf(n,e){const t={};for(const r in e){const s=e[r];t[r]=Fr(s)?s.map(n):n(s)}return t}const lu=()=>{},Fr=Array.isArray,_b=/#/g,NS=/&/g,VS=/\//g,OS=/=/g,MS=/\?/g,bb=/\+/g,LS=/%5B/g,FS=/%5D/g,wb=/%5E/g,$S=/%60/g,Ib=/%7B/g,US=/%7C/g,Eb=/%7D/g,jS=/%20/g;function lm(n){return encodeURI(""+n).replace(US,"|").replace(LS,"[").replace(FS,"]")}function BS(n){return lm(n).replace(Ib,"{").replace(Eb,"}").replace(wb,"^")}function sp(n){return lm(n).replace(bb,"%2B").replace(jS,"+").replace(_b,"%23").replace(NS,"%26").replace($S,"`").replace(Ib,"{").replace(Eb,"}").replace(wb,"^")}function qS(n){return sp(n).replace(OS,"%3D")}function zS(n){return lm(n).replace(_b,"%23").replace(MS,"%3F")}function KS(n){return n==null?"":zS(n).replace(VS,"%2F")}function Iu(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const GS=/\/$/,HS=n=>n.replace(GS,"");function If(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=YS(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Iu(o)}}function WS(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function jv(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function QS(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&Na(e.matched[r],t.matched[s])&&Tb(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Na(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function Tb(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!JS(n[t],e[t]))return!1;return!0}function JS(n,e){return Fr(n)?Bv(n,e):Fr(e)?Bv(e,n):n===e}function Bv(n,e){return Fr(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function YS(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const ri={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Eu;(function(n){n.pop="pop",n.push="push"})(Eu||(Eu={}));var uu;(function(n){n.back="back",n.forward="forward",n.unknown=""})(uu||(uu={}));function XS(n){if(!n)if(pa){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),HS(n)}const ZS=/^[^#]+#/;function e1(n,e){return n.replace(ZS,"#")+e}function t1(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const hh=()=>({left:window.scrollX,top:window.scrollY});function n1(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=t1(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function qv(n,e){return(history.state?history.state.position-e:-1)+n}const ip=new Map;function r1(n,e){ip.set(n,e)}function s1(n){const e=ip.get(n);return ip.delete(n),e}let i1=()=>location.protocol+"//"+location.host;function xb(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),jv(l,"")}return jv(t,n)+r+s}function o1(n,e,t,r){let s=[],i=[],o=null;const a=({state:g})=>{const y=xb(n,location),T=t.value,A=e.value;let P=0;if(g){if(t.value=y,e.value=g,o&&o===T){o=null;return}P=A?g.position-A.position:0}else r(y);s.forEach(U=>{U(t.value,T,{delta:P,type:Eu.pop,direction:P?P>0?uu.forward:uu.back:uu.unknown})})};function l(){o=t.value}function c(g){s.push(g);const y=()=>{const T=s.indexOf(g);T>-1&&s.splice(T,1)};return i.push(y),y}function d(){const{history:g}=window;g.state&&g.replaceState(yt({},g.state,{scroll:hh()}),"")}function f(){for(const g of i)g();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function zv(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?hh():null}}function a1(n){const{history:e,location:t}=window,r={value:xb(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,d){const f=n.indexOf("#"),g=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:i1()+n+l;try{e[d?"replaceState":"pushState"](c,"",g),s.value=c}catch(y){console.error(y),t[d?"replace":"assign"](g)}}function o(l,c){const d=yt({},e.state,zv(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,d,!0),r.value=l}function a(l,c){const d=yt({},s.value,e.state,{forward:l,scroll:hh()});i(d.current,d,!0);const f=yt({},zv(r.value,l,null),{position:d.position+1},c);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function l1(n){n=XS(n);const e=a1(n),t=o1(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=yt({location:"",base:n,go:r,createHref:e1.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function u1(n){return typeof n=="string"||n&&typeof n=="object"}function Ab(n){return typeof n=="string"||typeof n=="symbol"}const Sb=Symbol("");var Kv;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Kv||(Kv={}));function Va(n,e){return yt(new Error,{type:n,[Sb]:!0},e)}function ms(n,e){return n instanceof Error&&Sb in n&&(e==null||!!(n.type&e))}const Gv="[^/]+?",c1={sensitive:!1,strict:!1,start:!0,end:!0},d1=/[.+*?^${}()[\]/\\]/g;function h1(n,e){const t=yt({},c1,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const d=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const g=c[f];let y=40+(t.sensitive?.25:0);if(g.type===0)f||(s+="/"),s+=g.value.replace(d1,"\\$&"),y+=40;else if(g.type===1){const{value:T,repeatable:A,optional:P,regexp:U}=g;i.push({name:T,repeatable:A,optional:P});const q=U||Gv;if(q!==Gv){y+=10;try{new RegExp(`(${q})`)}catch(z){throw new Error(`Invalid custom RegExp for param "${T}" (${q}): `+z.message)}}let M=A?`((?:${q})(?:/(?:${q}))*)`:`(${q})`;f||(M=P&&c.length<2?`(?:/${M})`:"/"+M),P&&(M+="?"),s+=M,y+=20,P&&(y+=-8),A&&(y+=-20),q===".*"&&(y+=-50)}d.push(y)}r.push(d)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const d=c.match(o),f={};if(!d)return null;for(let g=1;g<d.length;g++){const y=d[g]||"",T=i[g-1];f[T.name]=y&&T.repeatable?y.split("/"):y}return f}function l(c){let d="",f=!1;for(const g of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const y of g)if(y.type===0)d+=y.value;else if(y.type===1){const{value:T,repeatable:A,optional:P}=y,U=T in c?c[T]:"";if(Fr(U)&&!A)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const q=Fr(U)?U.join("/"):U;if(!q)if(P)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${T}"`);d+=q}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function f1(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Pb(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=f1(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(Hv(r))return 1;if(Hv(s))return-1}return s.length-r.length}function Hv(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const p1={type:0,value:""},m1=/[a-zA-Z0-9_]/;function g1(n){if(!n)return[[]];if(n==="/")return[[p1]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(y){throw new Error(`ERR (${t})/"${c}": ${y}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",d="";function f(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function g(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&f(),o()):l===":"?(f(),t=1):g();break;case 4:g(),t=r;break;case 1:l==="("?t=2:m1.test(l)?g():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:t=3:d+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),s}function v1(n,e,t){const r=h1(g1(n.path),t),s=yt(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function y1(n,e){const t=[],r=new Map;e=Yv({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,g,y){const T=!y,A=Qv(f);A.aliasOf=y&&y.record;const P=Yv(e,f),U=[A];if("alias"in f){const z=typeof f.alias=="string"?[f.alias]:f.alias;for(const fe of z)U.push(Qv(yt({},A,{components:y?y.record.components:A.components,path:fe,aliasOf:y?y.record:A})))}let q,M;for(const z of U){const{path:fe}=z;if(g&&fe[0]!=="/"){const me=g.record.path,x=me[me.length-1]==="/"?"":"/";z.path=g.record.path+(fe&&x+fe)}if(q=v1(z,g,P),y?y.alias.push(q):(M=M||q,M!==q&&M.alias.push(q),T&&f.name&&!Jv(q)&&o(f.name)),Rb(q)&&l(q),A.children){const me=A.children;for(let x=0;x<me.length;x++)i(me[x],q,y&&y.children[x])}y=y||q}return M?()=>{o(M)}:lu}function o(f){if(Ab(f)){const g=r.get(f);g&&(r.delete(f),t.splice(t.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=t.indexOf(f);g>-1&&(t.splice(g,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const g=w1(f,t);t.splice(g,0,f),f.record.name&&!Jv(f)&&r.set(f.record.name,f)}function c(f,g){let y,T={},A,P;if("name"in f&&f.name){if(y=r.get(f.name),!y)throw Va(1,{location:f});P=y.record.name,T=yt(Wv(g.params,y.keys.filter(M=>!M.optional).concat(y.parent?y.parent.keys.filter(M=>M.optional):[]).map(M=>M.name)),f.params&&Wv(f.params,y.keys.map(M=>M.name))),A=y.stringify(T)}else if(f.path!=null)A=f.path,y=t.find(M=>M.re.test(A)),y&&(T=y.parse(A),P=y.record.name);else{if(y=g.name?r.get(g.name):t.find(M=>M.re.test(g.path)),!y)throw Va(1,{location:f,currentLocation:g});P=y.record.name,T=yt({},g.params,f.params),A=y.stringify(T)}const U=[];let q=y;for(;q;)U.unshift(q.record),q=q.parent;return{name:P,path:A,params:T,matched:U,meta:b1(U)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function Wv(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function Qv(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:_1(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function _1(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function Jv(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function b1(n){return n.reduce((e,t)=>yt(e,t.meta),{})}function Yv(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function w1(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;Pb(n,e[i])<0?r=i:t=i+1}const s=I1(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function I1(n){let e=n;for(;e=e.parent;)if(Rb(e)&&Pb(n,e)===0)return e}function Rb({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function E1(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(bb," "),o=i.indexOf("="),a=Iu(o<0?i:i.slice(0,o)),l=o<0?null:Iu(i.slice(o+1));if(a in e){let c=e[a];Fr(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function Xv(n){let e="";for(let t in n){const r=n[t];if(t=qS(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Fr(r)?r.map(i=>i&&sp(i)):[r&&sp(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function T1(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Fr(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const x1=Symbol(""),Zv=Symbol(""),fh=Symbol(""),um=Symbol(""),op=Symbol("");function Fl(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ui(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=g=>{g===!1?l(Va(4,{from:t,to:e})):g instanceof Error?l(g):u1(g)?l(Va(2,{from:e,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),a())},d=i(()=>n.call(r&&r.instances[s],e,t,c));let f=Promise.resolve(d);n.length<3&&(f=f.then(c)),f.catch(g=>l(g))})}function Ef(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(yb(l)){const d=(l.__vccOpts||l)[e];d&&i.push(ui(d,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=DS(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const y=(f.__vccOpts||f)[e];return y&&ui(y,t,r,o,a,s)()}))}}return i}function ey(n){const e=Lr(fh),t=Lr(um),r=Oe(()=>{const l=Xr(n.to);return e.resolve(l)}),s=Oe(()=>{const{matched:l}=r.value,{length:c}=l,d=l[c-1],f=t.matched;if(!d||!f.length)return-1;const g=f.findIndex(Na.bind(null,d));if(g>-1)return g;const y=ty(l[c-2]);return c>1&&ty(d)===y&&f[f.length-1].path!==y?f.findIndex(Na.bind(null,l[c-2])):g}),i=Oe(()=>s.value>-1&&C1(t.params,r.value.params)),o=Oe(()=>s.value>-1&&s.value===t.matched.length-1&&Tb(t.params,r.value.params));function a(l={}){if(R1(l)){const c=e[Xr(n.replace)?"replace":"push"](Xr(n.to)).catch(lu);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:Oe(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function A1(n){return n.length===1?n[0]:n}const S1=q0({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:ey,setup(n,{slots:e}){const t=oh(ey(n)),{options:r}=Lr(fh),s=Oe(()=>({[ny(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[ny(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&A1(e.default(t));return n.custom?i:pb("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),P1=S1;function R1(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function C1(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Fr(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function ty(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const ny=(n,e,t)=>n??e??t,k1=q0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Lr(op),s=Oe(()=>n.route||r.value),i=Lr(Zv,0),o=Oe(()=>{let c=Xr(i);const{matched:d}=s.value;let f;for(;(f=d[c])&&!f.components;)c++;return c}),a=Oe(()=>s.value.matched[o.value]);td(Zv,Oe(()=>o.value+1)),td(x1,a),td(op,s);const l=k();return At(()=>[l.value,a.value,n.name],([c,d,f],[g,y,T])=>{d&&(d.instances[f]=c,y&&y!==d&&c&&c===g&&(d.leaveGuards.size||(d.leaveGuards=y.leaveGuards),d.updateGuards.size||(d.updateGuards=y.updateGuards))),c&&d&&(!y||!Na(d,y)||!g)&&(d.enterCallbacks[f]||[]).forEach(A=>A(c))},{flush:"post"}),()=>{const c=s.value,d=n.name,f=a.value,g=f&&f.components[d];if(!g)return ry(t.default,{Component:g,route:c});const y=f.props[d],T=y?y===!0?c.params:typeof y=="function"?y(c):y:null,P=pb(g,yt({},T,e,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(f.instances[d]=null)},ref:l}));return ry(t.default,{Component:P,route:c})||P}}});function ry(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const D1=k1;function N1(n){const e=y1(n.routes,n),t=n.parseQuery||E1,r=n.stringifyQuery||Xv,s=n.history,i=Fl(),o=Fl(),a=Fl(),l=Bx(ri);let c=ri;pa&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=wf.bind(null,D=>""+D),f=wf.bind(null,KS),g=wf.bind(null,Iu);function y(D,$){let X,se;return Ab(D)?(X=e.getRecordMatcher(D),se=$):se=D,e.addRoute(se,X)}function T(D){const $=e.getRecordMatcher(D);$&&e.removeRoute($)}function A(){return e.getRoutes().map(D=>D.record)}function P(D){return!!e.getRecordMatcher(D)}function U(D,$){if($=yt({},$||l.value),typeof D=="string"){const S=If(t,D,$.path),O=e.resolve({path:S.path},$),oe=s.createHref(S.fullPath);return yt(S,O,{params:g(O.params),hash:Iu(S.hash),redirectedFrom:void 0,href:oe})}let X;if(D.path!=null)X=yt({},D,{path:If(t,D.path,$.path).path});else{const S=yt({},D.params);for(const O in S)S[O]==null&&delete S[O];X=yt({},D,{params:f(S)}),$.params=f($.params)}const se=e.resolve(X,$),ke=D.hash||"";se.params=d(g(se.params));const $e=WS(r,yt({},D,{hash:BS(ke),path:se.path})),E=s.createHref($e);return yt({fullPath:$e,hash:ke,query:r===Xv?T1(D.query):D.query||{}},se,{redirectedFrom:void 0,href:E})}function q(D){return typeof D=="string"?If(t,D,l.value.path):yt({},D)}function M(D,$){if(c!==D)return Va(8,{from:$,to:D})}function z(D){return x(D)}function fe(D){return z(yt(q(D),{replace:!0}))}function me(D){const $=D.matched[D.matched.length-1];if($&&$.redirect){const{redirect:X}=$;let se=typeof X=="function"?X(D):X;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=q(se):{path:se},se.params={}),yt({query:D.query,hash:D.hash,params:se.path!=null?{}:D.params},se)}}function x(D,$){const X=c=U(D),se=l.value,ke=D.state,$e=D.force,E=D.replace===!0,S=me(X);if(S)return x(yt(q(S),{state:typeof S=="object"?yt({},ke,S.state):ke,force:$e,replace:E}),$||X);const O=X;O.redirectedFrom=$;let oe;return!$e&&QS(r,se,X)&&(oe=Va(16,{to:O,from:se}),Ge(se,se,!0,!1)),(oe?Promise.resolve(oe):C(O,se)).catch(Z=>ms(Z)?ms(Z,2)?Z:Be(Z):ne(Z,O,se)).then(Z=>{if(Z){if(ms(Z,2))return x(yt({replace:E},q(Z.to),{state:typeof Z.to=="object"?yt({},ke,Z.to.state):ke,force:$e}),$||O)}else Z=B(O,se,!0,E,ke);return V(O,se,Z),Z})}function I(D,$){const X=M(D,$);return X?Promise.reject(X):Promise.resolve()}function w(D){const $=je.values().next().value;return $&&typeof $.runWithContext=="function"?$.runWithContext(D):D()}function C(D,$){let X;const[se,ke,$e]=V1(D,$);X=Ef(se.reverse(),"beforeRouteLeave",D,$);for(const S of se)S.leaveGuards.forEach(O=>{X.push(ui(O,D,$))});const E=I.bind(null,D,$);return X.push(E),ht(X).then(()=>{X=[];for(const S of i.list())X.push(ui(S,D,$));return X.push(E),ht(X)}).then(()=>{X=Ef(ke,"beforeRouteUpdate",D,$);for(const S of ke)S.updateGuards.forEach(O=>{X.push(ui(O,D,$))});return X.push(E),ht(X)}).then(()=>{X=[];for(const S of $e)if(S.beforeEnter)if(Fr(S.beforeEnter))for(const O of S.beforeEnter)X.push(ui(O,D,$));else X.push(ui(S.beforeEnter,D,$));return X.push(E),ht(X)}).then(()=>(D.matched.forEach(S=>S.enterCallbacks={}),X=Ef($e,"beforeRouteEnter",D,$,w),X.push(E),ht(X))).then(()=>{X=[];for(const S of o.list())X.push(ui(S,D,$));return X.push(E),ht(X)}).catch(S=>ms(S,8)?S:Promise.reject(S))}function V(D,$,X){a.list().forEach(se=>w(()=>se(D,$,X)))}function B(D,$,X,se,ke){const $e=M(D,$);if($e)return $e;const E=$===ri,S=pa?history.state:{};X&&(se||E?s.replace(D.fullPath,yt({scroll:E&&S&&S.scroll},ke)):s.push(D.fullPath,ke)),l.value=D,Ge(D,$,X,E),Be()}let R;function It(){R||(R=s.listen((D,$,X)=>{if(!Xe.listening)return;const se=U(D),ke=me(se);if(ke){x(yt(ke,{replace:!0,force:!0}),se).catch(lu);return}c=se;const $e=l.value;pa&&r1(qv($e.fullPath,X.delta),hh()),C(se,$e).catch(E=>ms(E,12)?E:ms(E,2)?(x(yt(q(E.to),{force:!0}),se).then(S=>{ms(S,20)&&!X.delta&&X.type===Eu.pop&&s.go(-1,!1)}).catch(lu),Promise.reject()):(X.delta&&s.go(-X.delta,!1),ne(E,se,$e))).then(E=>{E=E||B(se,$e,!1),E&&(X.delta&&!ms(E,8)?s.go(-X.delta,!1):X.type===Eu.pop&&ms(E,20)&&s.go(-1,!1)),V(se,$e,E)}).catch(lu)}))}let vt=Fl(),Y=Fl(),j;function ne(D,$,X){Be(D);const se=Y.list();return se.length?se.forEach(ke=>ke(D,$,X)):console.error(D),Promise.reject(D)}function Ke(){return j&&l.value!==ri?Promise.resolve():new Promise((D,$)=>{vt.add([D,$])})}function Be(D){return j||(j=!D,It(),vt.list().forEach(([$,X])=>D?X(D):$()),vt.reset()),D}function Ge(D,$,X,se){const{scrollBehavior:ke}=n;if(!pa||!ke)return Promise.resolve();const $e=!X&&s1(qv(D.fullPath,0))||(se||!X)&&history.state&&history.state.scroll||null;return pn().then(()=>ke(D,$,$e)).then(E=>E&&n1(E)).catch(E=>ne(E,D,$))}const re=D=>s.go(D);let ee;const je=new Set,Xe={currentRoute:l,listening:!0,addRoute:y,removeRoute:T,clearRoutes:e.clearRoutes,hasRoute:P,getRoutes:A,resolve:U,options:n,push:z,replace:fe,go:re,back:()=>re(-1),forward:()=>re(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Y.add,isReady:Ke,install(D){const $=this;D.component("RouterLink",P1),D.component("RouterView",D1),D.config.globalProperties.$router=$,Object.defineProperty(D.config.globalProperties,"$route",{enumerable:!0,get:()=>Xr(l)}),pa&&!ee&&l.value===ri&&(ee=!0,z(s.location).catch(ke=>{}));const X={};for(const ke in ri)Object.defineProperty(X,ke,{get:()=>l.value[ke],enumerable:!0});D.provide(fh,$),D.provide(um,k0(X)),D.provide(op,l);const se=D.unmount;je.add(D),D.unmount=function(){je.delete(D),je.size<1&&(c=ri,R&&R(),R=null,l.value=ri,ee=!1,j=!1),se()}}};function ht(D){return D.reduce(($,X)=>$.then(()=>w(X)),Promise.resolve())}return Xe}function V1(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>Na(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>Na(c,l))||s.push(l))}return[t,r,s]}function Za(){return Lr(fh)}function el(n){return Lr(um)}const O1="modulepreload",M1=function(n){return"/"+n},sy={},Xt=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=M1(i),i in sy)return;sy[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":O1,o||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),o)return new Promise((d,f)=>{c.addEventListener("load",d),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function L1(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=n;let a,l;const c=async(f=!0)=>{await l};async function d(){if("serviceWorker"in navigator){const{Workbox:f}=await Xt(()=>import("./workbox-window.prod.es5-5ffdab76.js"),[]);a=new f("/service-worker.js",{scope:"/",type:"classic"}),a.addEventListener("activated",g=>{(g.isUpdate||g.isExternal)&&window.location.reload()}),a.addEventListener("installed",g=>{g.isUpdate||r==null||r()}),a.register({immediate:e}).then(g=>{i?i("/service-worker.js",g):s==null||s(g)}).catch(g=>{o==null||o(g)})}}return l=d(),c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},F1=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},kb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let g=(a&15)<<2|c>>6,y=c&63;l||(y=64,o||(g=64)),r.push(t[d],t[f],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Cb(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):F1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new $1;const g=i<<2|a>>4;if(r.push(g),c!==64){const y=a<<4&240|c>>2;if(r.push(y),f!==64){const T=c<<6&192|f;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const U1=function(n){const e=Cb(n);return kb.encodeByteArray(e,!0)},kd=function(n){return U1(n).replace(/\./g,"")},Db=function(n){try{return kb.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=()=>j1().__FIREBASE_DEFAULTS__,q1=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},z1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Db(n[1]);return e&&JSON.parse(e)},ph=()=>{try{return B1()||q1()||z1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Nb=n=>{var e,t;return(t=(e=ph())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},K1=n=>{const e=Nb(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Vb=()=>{var n;return(n=ph())===null||n===void 0?void 0:n.config},Ob=n=>{var e;return(e=ph())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[kd(JSON.stringify(t)),kd(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function W1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vn())}function Q1(){var n;const e=(n=ph())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function J1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Y1(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function X1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Z1(){const n=vn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Mb(){return!Q1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cm(){try{return typeof indexedDB=="object"}catch{return!1}}function Lb(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}function eP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP="FirebaseError";class os extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=tP,Object.setPrototypeOf(this,os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fo.prototype.create)}}class Fo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?nP(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new os(s,a,r)}}function nP(n,e){return n.replace(rP,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const rP=/\{\$([^}]+)}/g;function sP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Si(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(iy(i)&&iy(o)){if(!Si(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function iy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Hl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Wl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function iP(n,e){const t=new oP(n,e);return t.subscribe.bind(t)}class oP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");aP(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Tf),s.error===void 0&&(s.error=Tf),s.complete===void 0&&(s.complete=Tf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aP(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Tf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(n){return n&&n._delegate?n._delegate:n}class $r{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new G1;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cP(e))try{this.getOrInitializeService({instanceIdentifier:uo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=uo){return this.instances.has(e)}getOptions(e=uo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:uP(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=uo){return this.component?this.component.multipleInstances?e:uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uP(n){return n===uo?void 0:n}function cP(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(st||(st={}));const hP={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},fP=st.INFO,pP={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},mP=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=pP[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dm{constructor(e){this.name=e,this._logLevel=fP,this._logHandler=mP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in st))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...e),this._logHandler(this,st.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...e),this._logHandler(this,st.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,st.INFO,...e),this._logHandler(this,st.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,st.WARN,...e),this._logHandler(this,st.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...e),this._logHandler(this,st.ERROR,...e)}}const gP=(n,e)=>e.some(t=>n instanceof t);let oy,ay;function vP(){return oy||(oy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yP(){return ay||(ay=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fb=new WeakMap,ap=new WeakMap,$b=new WeakMap,xf=new WeakMap,hm=new WeakMap;function _P(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(As(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Fb.set(t,n)}).catch(()=>{}),hm.set(e,n),e}function bP(n){if(ap.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});ap.set(n,e)}let lp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ap.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$b.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return As(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wP(n){lp=n(lp)}function IP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Af(this),e,...t);return $b.set(r,e.sort?e.sort():[e]),As(r)}:yP().includes(n)?function(...e){return n.apply(Af(this),e),As(Fb.get(this))}:function(...e){return As(n.apply(Af(this),e))}}function EP(n){return typeof n=="function"?IP(n):(n instanceof IDBTransaction&&bP(n),gP(n,vP())?new Proxy(n,lp):n)}function As(n){if(n instanceof IDBRequest)return _P(n);if(xf.has(n))return xf.get(n);const e=EP(n);return e!==n&&(xf.set(n,e),hm.set(e,n)),e}const Af=n=>hm.get(n);function mh(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=As(o);return r&&o.addEventListener("upgradeneeded",l=>{r(As(o.result),l.oldVersion,l.newVersion,As(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function Sf(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),As(t).then(()=>{})}const TP=["get","getKey","getAll","getAllKeys","count"],xP=["put","add","delete","clear"],Pf=new Map;function ly(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Pf.get(e))return Pf.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=xP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||TP.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Pf.set(e,i),i}wP(n=>({...n,get:(e,t,r)=>ly(e,t)||n.get(e,t,r),has:(e,t)=>!!ly(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(SP(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function SP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const up="@firebase/app",uy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new dm("@firebase/app"),PP="@firebase/app-compat",RP="@firebase/analytics-compat",CP="@firebase/analytics",kP="@firebase/app-check-compat",DP="@firebase/app-check",NP="@firebase/auth",VP="@firebase/auth-compat",OP="@firebase/database",MP="@firebase/data-connect",LP="@firebase/database-compat",FP="@firebase/functions",$P="@firebase/functions-compat",UP="@firebase/installations",jP="@firebase/installations-compat",BP="@firebase/messaging",qP="@firebase/messaging-compat",zP="@firebase/performance",KP="@firebase/performance-compat",GP="@firebase/remote-config",HP="@firebase/remote-config-compat",WP="@firebase/storage",QP="@firebase/storage-compat",JP="@firebase/firestore",YP="@firebase/vertexai-preview",XP="@firebase/firestore-compat",ZP="firebase",eR="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd="[DEFAULT]",tR={[up]:"fire-core",[PP]:"fire-core-compat",[CP]:"fire-analytics",[RP]:"fire-analytics-compat",[DP]:"fire-app-check",[kP]:"fire-app-check-compat",[NP]:"fire-auth",[VP]:"fire-auth-compat",[OP]:"fire-rtdb",[MP]:"fire-data-connect",[LP]:"fire-rtdb-compat",[FP]:"fire-fn",[$P]:"fire-fn-compat",[UP]:"fire-iid",[jP]:"fire-iid-compat",[BP]:"fire-fcm",[qP]:"fire-fcm-compat",[zP]:"fire-perf",[KP]:"fire-perf-compat",[GP]:"fire-rc",[HP]:"fire-rc-compat",[WP]:"fire-gcs",[QP]:"fire-gcs-compat",[JP]:"fire-fst",[XP]:"fire-fst-compat",[YP]:"fire-vertex","fire-js":"fire-js",[ZP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd=new Map,nR=new Map,cp=new Map;function cy(n,e){try{n.container.addComponent(e)}catch(t){Cs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ss(n){const e=n.name;if(cp.has(e))return Cs.debug(`There were multiple attempts to register component ${e}.`),!1;cp.set(e,n);for(const t of Nd.values())cy(t,n);for(const t of nR.values())cy(t,n);return!0}function Li(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function rR(n,e,t=Dd){Li(n,e).clearInstance(t)}function on(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wi=new Fo("app","Firebase",sR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=eR;function Ub(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Dd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw wi.create("bad-app-name",{appName:String(s)});if(t||(t=Vb()),!t)throw wi.create("no-options");const i=Nd.get(s);if(i){if(Si(t,i.options)&&Si(r,i.config))return i;throw wi.create("duplicate-app",{appName:s})}const o=new dP(s);for(const l of cp.values())o.addComponent(l);const a=new iR(t,r,o);return Nd.set(s,a),a}function fm(n=Dd){const e=Nd.get(n);if(!e&&n===Dd&&Vb())return Ub();if(!e)throw wi.create("no-app",{appName:n});return e}function Er(n,e,t){var r;let s=(r=tR[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cs.warn(a.join(" "));return}ss(new $r(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR="firebase-heartbeat-database",aR=1,Tu="firebase-heartbeat-store";let Rf=null;function jb(){return Rf||(Rf=mh(oR,aR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Tu)}catch(t){console.warn(t)}}}}).catch(n=>{throw wi.create("idb-open",{originalErrorMessage:n.message})})),Rf}async function lR(n){try{const t=(await jb()).transaction(Tu),r=await t.objectStore(Tu).get(Bb(n));return await t.done,r}catch(e){if(e instanceof os)Cs.warn(e.message);else{const t=wi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cs.warn(t.message)}}}async function dy(n,e){try{const r=(await jb()).transaction(Tu,"readwrite");await r.objectStore(Tu).put(e,Bb(n)),await r.done}catch(t){if(t instanceof os)Cs.warn(t.message);else{const r=wi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Cs.warn(r.message)}}}function Bb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR=1024,cR=30*24*60*60*1e3;class dR{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fR(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=hy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=cR}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Cs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=hy(),{heartbeatsToSend:r,unsentEntries:s}=hR(this._heartbeatsCache.heartbeats),i=kd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Cs.warn(t),""}}}function hy(){return new Date().toISOString().substring(0,10)}function hR(n,e=uR){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),fy(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),fy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class fR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cm()?Lb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await lR(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return dy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return dy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function fy(n){return kd(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(n){ss(new $r("platform-logger",e=>new AP(e),"PRIVATE")),ss(new $r("heartbeat",e=>new dR(e),"PRIVATE")),Er(up,uy,n),Er(up,uy,"esm2017"),Er("fire-js","")}pR("");var mR="firebase",gR="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er(mR,gR,"app");var py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Io,qb;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,I){function w(){}w.prototype=I.prototype,x.D=I.prototype,x.prototype=new w,x.prototype.constructor=x,x.C=function(C,V,B){for(var R=Array(arguments.length-2),It=2;It<arguments.length;It++)R[It-2]=arguments[It];return I.prototype[V].apply(C,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,I,w){w||(w=0);var C=Array(16);if(typeof I=="string")for(var V=0;16>V;++V)C[V]=I.charCodeAt(w++)|I.charCodeAt(w++)<<8|I.charCodeAt(w++)<<16|I.charCodeAt(w++)<<24;else for(V=0;16>V;++V)C[V]=I[w++]|I[w++]<<8|I[w++]<<16|I[w++]<<24;I=x.g[0],w=x.g[1],V=x.g[2];var B=x.g[3],R=I+(B^w&(V^B))+C[0]+3614090360&4294967295;I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[1]+3905402710&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[2]+606105819&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[3]+3250441966&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(B^w&(V^B))+C[4]+4118548399&4294967295,I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[5]+1200080426&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[6]+2821735955&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[7]+4249261313&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(B^w&(V^B))+C[8]+1770035416&4294967295,I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[9]+2336552879&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[10]+4294925233&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[11]+2304563134&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(B^w&(V^B))+C[12]+1804603682&4294967295,I=w+(R<<7&4294967295|R>>>25),R=B+(V^I&(w^V))+C[13]+4254626195&4294967295,B=I+(R<<12&4294967295|R>>>20),R=V+(w^B&(I^w))+C[14]+2792965006&4294967295,V=B+(R<<17&4294967295|R>>>15),R=w+(I^V&(B^I))+C[15]+1236535329&4294967295,w=V+(R<<22&4294967295|R>>>10),R=I+(V^B&(w^V))+C[1]+4129170786&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[6]+3225465664&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[11]+643717713&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[0]+3921069994&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(V^B&(w^V))+C[5]+3593408605&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[10]+38016083&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[15]+3634488961&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[4]+3889429448&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(V^B&(w^V))+C[9]+568446438&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[14]+3275163606&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[3]+4107603335&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[8]+1163531501&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(V^B&(w^V))+C[13]+2850285829&4294967295,I=w+(R<<5&4294967295|R>>>27),R=B+(w^V&(I^w))+C[2]+4243563512&4294967295,B=I+(R<<9&4294967295|R>>>23),R=V+(I^w&(B^I))+C[7]+1735328473&4294967295,V=B+(R<<14&4294967295|R>>>18),R=w+(B^I&(V^B))+C[12]+2368359562&4294967295,w=V+(R<<20&4294967295|R>>>12),R=I+(w^V^B)+C[5]+4294588738&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[8]+2272392833&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[11]+1839030562&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[14]+4259657740&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(w^V^B)+C[1]+2763975236&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[4]+1272893353&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[7]+4139469664&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[10]+3200236656&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(w^V^B)+C[13]+681279174&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[0]+3936430074&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[3]+3572445317&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[6]+76029189&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(w^V^B)+C[9]+3654602809&4294967295,I=w+(R<<4&4294967295|R>>>28),R=B+(I^w^V)+C[12]+3873151461&4294967295,B=I+(R<<11&4294967295|R>>>21),R=V+(B^I^w)+C[15]+530742520&4294967295,V=B+(R<<16&4294967295|R>>>16),R=w+(V^B^I)+C[2]+3299628645&4294967295,w=V+(R<<23&4294967295|R>>>9),R=I+(V^(w|~B))+C[0]+4096336452&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[7]+1126891415&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[14]+2878612391&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[5]+4237533241&4294967295,w=V+(R<<21&4294967295|R>>>11),R=I+(V^(w|~B))+C[12]+1700485571&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[3]+2399980690&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[10]+4293915773&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[1]+2240044497&4294967295,w=V+(R<<21&4294967295|R>>>11),R=I+(V^(w|~B))+C[8]+1873313359&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[15]+4264355552&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[6]+2734768916&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[13]+1309151649&4294967295,w=V+(R<<21&4294967295|R>>>11),R=I+(V^(w|~B))+C[4]+4149444226&4294967295,I=w+(R<<6&4294967295|R>>>26),R=B+(w^(I|~V))+C[11]+3174756917&4294967295,B=I+(R<<10&4294967295|R>>>22),R=V+(I^(B|~w))+C[2]+718787259&4294967295,V=B+(R<<15&4294967295|R>>>17),R=w+(B^(V|~I))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+I&4294967295,x.g[1]=x.g[1]+(V+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+V&4294967295,x.g[3]=x.g[3]+B&4294967295}r.prototype.u=function(x,I){I===void 0&&(I=x.length);for(var w=I-this.blockSize,C=this.B,V=this.h,B=0;B<I;){if(V==0)for(;B<=w;)s(this,x,B),B+=this.blockSize;if(typeof x=="string"){for(;B<I;)if(C[V++]=x.charCodeAt(B++),V==this.blockSize){s(this,C),V=0;break}}else for(;B<I;)if(C[V++]=x[B++],V==this.blockSize){s(this,C),V=0;break}}this.h=V,this.o+=I},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var I=1;I<x.length-8;++I)x[I]=0;var w=8*this.o;for(I=x.length-8;I<x.length;++I)x[I]=w&255,w/=256;for(this.u(x),x=Array(16),I=w=0;4>I;++I)for(var C=0;32>C;C+=8)x[w++]=this.g[I]>>>C&255;return x};function i(x,I){var w=a;return Object.prototype.hasOwnProperty.call(w,x)?w[x]:w[x]=I(x)}function o(x,I){this.h=I;for(var w=[],C=!0,V=x.length-1;0<=V;V--){var B=x[V]|0;C&&B==I||(w[V]=B,C=!1)}this.g=w}var a={};function l(x){return-128<=x&&128>x?i(x,function(I){return new o([I|0],0>I?-1:0)}):new o([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return P(c(-x));for(var I=[],w=1,C=0;x>=w;C++)I[C]=x/w|0,w*=4294967296;return new o(I,0)}function d(x,I){if(x.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(x.charAt(0)=="-")return P(d(x.substring(1),I));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(I,8)),C=f,V=0;V<x.length;V+=8){var B=Math.min(8,x.length-V),R=parseInt(x.substring(V,V+B),I);8>B?(B=c(Math.pow(I,B)),C=C.j(B).add(c(R))):(C=C.j(w),C=C.add(c(R)))}return C}var f=l(0),g=l(1),y=l(16777216);n=o.prototype,n.m=function(){if(A(this))return-P(this).m();for(var x=0,I=1,w=0;w<this.g.length;w++){var C=this.i(w);x+=(0<=C?C:4294967296+C)*I,I*=4294967296}return x},n.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(T(this))return"0";if(A(this))return"-"+P(this).toString(x);for(var I=c(Math.pow(x,6)),w=this,C="";;){var V=z(w,I).g;w=U(w,V.j(I));var B=((0<w.g.length?w.g[0]:w.h)>>>0).toString(x);if(w=V,T(w))return B+C;for(;6>B.length;)B="0"+B;C=B+C}},n.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function T(x){if(x.h!=0)return!1;for(var I=0;I<x.g.length;I++)if(x.g[I]!=0)return!1;return!0}function A(x){return x.h==-1}n.l=function(x){return x=U(this,x),A(x)?-1:T(x)?0:1};function P(x){for(var I=x.g.length,w=[],C=0;C<I;C++)w[C]=~x.g[C];return new o(w,~x.h).add(g)}n.abs=function(){return A(this)?P(this):this},n.add=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0,V=0;V<=I;V++){var B=C+(this.i(V)&65535)+(x.i(V)&65535),R=(B>>>16)+(this.i(V)>>>16)+(x.i(V)>>>16);C=R>>>16,B&=65535,R&=65535,w[V]=R<<16|B}return new o(w,w[w.length-1]&-2147483648?-1:0)};function U(x,I){return x.add(P(I))}n.j=function(x){if(T(this)||T(x))return f;if(A(this))return A(x)?P(this).j(P(x)):P(P(this).j(x));if(A(x))return P(this.j(P(x)));if(0>this.l(y)&&0>x.l(y))return c(this.m()*x.m());for(var I=this.g.length+x.g.length,w=[],C=0;C<2*I;C++)w[C]=0;for(C=0;C<this.g.length;C++)for(var V=0;V<x.g.length;V++){var B=this.i(C)>>>16,R=this.i(C)&65535,It=x.i(V)>>>16,vt=x.i(V)&65535;w[2*C+2*V]+=R*vt,q(w,2*C+2*V),w[2*C+2*V+1]+=B*vt,q(w,2*C+2*V+1),w[2*C+2*V+1]+=R*It,q(w,2*C+2*V+1),w[2*C+2*V+2]+=B*It,q(w,2*C+2*V+2)}for(C=0;C<I;C++)w[C]=w[2*C+1]<<16|w[2*C];for(C=I;C<2*I;C++)w[C]=0;return new o(w,0)};function q(x,I){for(;(x[I]&65535)!=x[I];)x[I+1]+=x[I]>>>16,x[I]&=65535,I++}function M(x,I){this.g=x,this.h=I}function z(x,I){if(T(I))throw Error("division by zero");if(T(x))return new M(f,f);if(A(x))return I=z(P(x),I),new M(P(I.g),P(I.h));if(A(I))return I=z(x,P(I)),new M(P(I.g),I.h);if(30<x.g.length){if(A(x)||A(I))throw Error("slowDivide_ only works with positive integers.");for(var w=g,C=I;0>=C.l(x);)w=fe(w),C=fe(C);var V=me(w,1),B=me(C,1);for(C=me(C,2),w=me(w,2);!T(C);){var R=B.add(C);0>=R.l(x)&&(V=V.add(w),B=R),C=me(C,1),w=me(w,1)}return I=U(x,V.j(I)),new M(V,I)}for(V=f;0<=x.l(I);){for(w=Math.max(1,Math.floor(x.m()/I.m())),C=Math.ceil(Math.log(w)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),B=c(w),R=B.j(I);A(R)||0<R.l(x);)w-=C,B=c(w),R=B.j(I);T(B)&&(B=g),V=V.add(B),x=U(x,R)}return new M(V,x)}n.A=function(x){return z(this,x).h},n.and=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0;C<I;C++)w[C]=this.i(C)&x.i(C);return new o(w,this.h&x.h)},n.or=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0;C<I;C++)w[C]=this.i(C)|x.i(C);return new o(w,this.h|x.h)},n.xor=function(x){for(var I=Math.max(this.g.length,x.g.length),w=[],C=0;C<I;C++)w[C]=this.i(C)^x.i(C);return new o(w,this.h^x.h)};function fe(x){for(var I=x.g.length+1,w=[],C=0;C<I;C++)w[C]=x.i(C)<<1|x.i(C-1)>>>31;return new o(w,x.h)}function me(x,I){var w=I>>5;I%=32;for(var C=x.g.length-w,V=[],B=0;B<C;B++)V[B]=0<I?x.i(B+w)>>>I|x.i(B+w+1)<<32-I:x.i(B+w);return new o(V,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Io=o}).apply(typeof py<"u"?py:typeof self<"u"?self:typeof window<"u"?window:{});var qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zb,Ql,Kb,id,dp,Gb,Hb,Wb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,v){return u==Array.prototype||u==Object.prototype||(u[p]=v.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof qc=="object"&&qc];for(var p=0;p<u.length;++p){var v=u[p];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=t(this);function s(u,p){if(p)e:{var v=r;u=u.split(".");for(var b=0;b<u.length-1;b++){var K=u[b];if(!(K in v))break e;v=v[K]}u=u[u.length-1],b=v[u],p=p(b),p!=b&&p!=null&&e(v,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var v=0,b=!1,K={next:function(){if(!b&&v<u.length){var W=v++;return{value:p(W,u[W]),done:!1}}return b=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function d(u,p,v){return u.call.apply(u.bind,arguments)}function f(u,p,v){if(!u)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,b),u.apply(p,K)}}return function(){return u.apply(p,arguments)}}function g(u,p,v){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function y(u,p){var v=Array.prototype.slice.call(arguments,1);return function(){var b=v.slice();return b.push.apply(b,arguments),u.apply(this,b)}}function T(u,p){function v(){}v.prototype=p.prototype,u.aa=p.prototype,u.prototype=new v,u.prototype.constructor=u,u.Qb=function(b,K,W){for(var Ie=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)Ie[Et-2]=arguments[Et];return p.prototype[K].apply(b,Ie)}}function A(u){const p=u.length;if(0<p){const v=Array(p);for(let b=0;b<p;b++)v[b]=u[b];return v}return[]}function P(u,p){for(let v=1;v<arguments.length;v++){const b=arguments[v];if(l(b)){const K=u.length||0,W=b.length||0;u.length=K+W;for(let Ie=0;Ie<W;Ie++)u[K+Ie]=b[Ie]}else u.push(b)}}class U{constructor(p,v){this.i=p,this.j=v,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function q(u){return/^[\s\xa0]*$/.test(u)}function M(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function z(u){return z[" "](u),u}z[" "]=function(){};var fe=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function me(u,p,v){for(const b in u)p.call(v,u[b],b,u)}function x(u,p){for(const v in u)p.call(void 0,u[v],v,u)}function I(u){const p={};for(const v in u)p[v]=u[v];return p}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let v,b;for(let K=1;K<arguments.length;K++){b=arguments[K];for(v in b)u[v]=b[v];for(let W=0;W<w.length;W++)v=w[W],Object.prototype.hasOwnProperty.call(b,v)&&(u[v]=b[v])}}function V(u){var p=1;u=u.split(":");const v=[];for(;0<p&&u.length;)v.push(u.shift()),p--;return u.length&&v.push(u.join(":")),v}function B(u){a.setTimeout(()=>{throw u},0)}function R(){var u=Ke;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class It{constructor(){this.h=this.g=null}add(p,v){const b=vt.get();b.set(p,v),this.h?this.h.next=b:this.g=b,this.h=b}}var vt=new U(()=>new Y,u=>u.reset());class Y{constructor(){this.next=this.g=this.h=null}set(p,v){this.h=p,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let j,ne=!1,Ke=new It,Be=()=>{const u=a.Promise.resolve(void 0);j=()=>{u.then(Ge)}};var Ge=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(v){B(v)}var p=vt;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ne=!1};function re(){this.s=this.s,this.C=this.C}re.prototype.s=!1,re.prototype.ma=function(){this.s||(this.s=!0,this.N())},re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var je=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const v=()=>{};a.addEventListener("test",v,p),a.removeEventListener("test",v,p)}catch{}return u}();function Xe(u,p){if(ee.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var v=this.type=u.type,b=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(fe){e:{try{z(p.nodeName);var K=!0;break e}catch{}K=!1}K||(p=null)}}else v=="mouseover"?p=u.fromElement:v=="mouseout"&&(p=u.toElement);this.relatedTarget=p,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ht[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Xe.aa.h.call(this)}}T(Xe,ee);var ht={2:"touch",3:"pen",4:"mouse"};Xe.prototype.h=function(){Xe.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var D="closure_listenable_"+(1e6*Math.random()|0),$=0;function X(u,p,v,b,K){this.listener=u,this.proxy=null,this.src=p,this.type=v,this.capture=!!b,this.ha=K,this.key=++$,this.da=this.fa=!1}function se(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ke(u){this.src=u,this.g={},this.h=0}ke.prototype.add=function(u,p,v,b,K){var W=u.toString();u=this.g[W],u||(u=this.g[W]=[],this.h++);var Ie=E(u,p,b,K);return-1<Ie?(p=u[Ie],v||(p.fa=!1)):(p=new X(p,this.src,W,!!b,K),p.fa=v,u.push(p)),p};function $e(u,p){var v=p.type;if(v in u.g){var b=u.g[v],K=Array.prototype.indexOf.call(b,p,void 0),W;(W=0<=K)&&Array.prototype.splice.call(b,K,1),W&&(se(p),u.g[v].length==0&&(delete u.g[v],u.h--))}}function E(u,p,v,b){for(var K=0;K<u.length;++K){var W=u[K];if(!W.da&&W.listener==p&&W.capture==!!v&&W.ha==b)return K}return-1}var S="closure_lm_"+(1e6*Math.random()|0),O={};function oe(u,p,v,b,K){if(b&&b.once)return be(u,p,v,b,K);if(Array.isArray(p)){for(var W=0;W<p.length;W++)oe(u,p[W],v,b,K);return null}return v=De(v),u&&u[D]?u.K(p,v,c(b)?!!b.capture:!!b,K):Z(u,p,v,!1,b,K)}function Z(u,p,v,b,K,W){if(!p)throw Error("Invalid event type");var Ie=c(K)?!!K.capture:!!K,Et=Te(u);if(Et||(u[S]=Et=new ke(u)),v=Et.add(p,v,b,Ie,W),v.proxy)return v;if(b=ue(),v.proxy=b,b.src=u,b.listener=v,u.addEventListener)je||(K=Ie),K===void 0&&(K=!1),u.addEventListener(p.toString(),b,K);else if(u.attachEvent)u.attachEvent(pe(p.toString()),b);else if(u.addListener&&u.removeListener)u.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return v}function ue(){function u(v){return p.call(u.src,u.listener,v)}const p=Se;return u}function be(u,p,v,b,K){if(Array.isArray(p)){for(var W=0;W<p.length;W++)be(u,p[W],v,b,K);return null}return v=De(v),u&&u[D]?u.L(p,v,c(b)?!!b.capture:!!b,K):Z(u,p,v,!0,b,K)}function ye(u,p,v,b,K){if(Array.isArray(p))for(var W=0;W<p.length;W++)ye(u,p[W],v,b,K);else b=c(b)?!!b.capture:!!b,v=De(v),u&&u[D]?(u=u.i,p=String(p).toString(),p in u.g&&(W=u.g[p],v=E(W,v,b,K),-1<v&&(se(W[v]),Array.prototype.splice.call(W,v,1),W.length==0&&(delete u.g[p],u.h--)))):u&&(u=Te(u))&&(p=u.g[p.toString()],u=-1,p&&(u=E(p,v,b,K)),(v=-1<u?p[u]:null)&&_e(v))}function _e(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[D])$e(p.i,u);else{var v=u.type,b=u.proxy;p.removeEventListener?p.removeEventListener(v,b,u.capture):p.detachEvent?p.detachEvent(pe(v),b):p.addListener&&p.removeListener&&p.removeListener(b),(v=Te(p))?($e(v,u),v.h==0&&(v.src=null,p[S]=null)):se(u)}}}function pe(u){return u in O?O[u]:O[u]="on"+u}function Se(u,p){if(u.da)u=!0;else{p=new Xe(p,this);var v=u.listener,b=u.ha||u.src;u.fa&&_e(u),u=v.call(b,p)}return u}function Te(u){return u=u[S],u instanceof ke?u:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(u){return typeof u=="function"?u:(u[Pe]||(u[Pe]=function(p){return u.handleEvent(p)}),u[Pe])}function Le(){re.call(this),this.i=new ke(this),this.M=this,this.F=null}T(Le,re),Le.prototype[D]=!0,Le.prototype.removeEventListener=function(u,p,v,b){ye(this,u,p,v,b)};function He(u,p){var v,b=u.F;if(b)for(v=[];b;b=b.F)v.push(b);if(u=u.M,b=p.type||p,typeof p=="string")p=new ee(p,u);else if(p instanceof ee)p.target=p.target||u;else{var K=p;p=new ee(b,u),C(p,K)}if(K=!0,v)for(var W=v.length-1;0<=W;W--){var Ie=p.g=v[W];K=Ze(Ie,b,!0,p)&&K}if(Ie=p.g=u,K=Ze(Ie,b,!0,p)&&K,K=Ze(Ie,b,!1,p)&&K,v)for(W=0;W<v.length;W++)Ie=p.g=v[W],K=Ze(Ie,b,!1,p)&&K}Le.prototype.N=function(){if(Le.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var v=u.g[p],b=0;b<v.length;b++)se(v[b]);delete u.g[p],u.h--}}this.F=null},Le.prototype.K=function(u,p,v,b){return this.i.add(String(u),p,!1,v,b)},Le.prototype.L=function(u,p,v,b){return this.i.add(String(u),p,!0,v,b)};function Ze(u,p,v,b){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var K=!0,W=0;W<p.length;++W){var Ie=p[W];if(Ie&&!Ie.da&&Ie.capture==v){var Et=Ie.listener,dn=Ie.ha||Ie.src;Ie.fa&&$e(u.i,Ie),K=Et.call(dn,b)!==!1&&K}}return K&&!b.defaultPrevented}function Yt(u,p,v){if(typeof u=="function")v&&(u=g(u,v));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function Bt(u){u.g=Yt(()=>{u.g=null,u.i&&(u.i=!1,Bt(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class _n extends re{constructor(p,v){super(),this.m=p,this.l=v,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Bt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(u){re.call(this),this.h=u,this.g={}}T(Mt,re);var mr=[];function Ur(u){me(u.g,function(p,v){this.g.hasOwnProperty(v)&&_e(p)},u),u.g={}}Mt.prototype.N=function(){Mt.aa.N.call(this),Ur(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cn=a.JSON.stringify,Cn=a.JSON.parse,zi=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function _l(){}_l.prototype.h=null;function vc(u){return u.h||(u.h=u.i())}function yc(){}var Ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function bl(){ee.call(this,"d")}T(bl,ee);function Sr(){ee.call(this,"c")}T(Sr,ee);var tr={},Pr=null;function Rr(){return Pr=Pr||new Le}tr.La="serverreachability";function Cr(u){ee.call(this,tr.La,u)}T(Cr,ee);function qs(u){const p=Rr();He(p,new Cr(p))}tr.STAT_EVENT="statevent";function Gi(u,p){ee.call(this,tr.STAT_EVENT,u),this.stat=p}T(Gi,ee);function nn(u){const p=Rr();He(p,new Gi(p,u))}tr.Ma="timingevent";function _c(u,p){ee.call(this,tr.Ma,u),this.size=p}T(_c,ee);function kn(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function zs(){this.g=!0}zs.prototype.xa=function(){this.g=!1};function bc(u,p,v,b,K,W){u.info(function(){if(u.g)if(W)for(var Ie="",Et=W.split("&"),dn=0;dn<Et.length;dn++){var lt=Et[dn].split("=");if(1<lt.length){var hn=lt[0];lt=lt[1];var gn=hn.split("_");Ie=2<=gn.length&&gn[1]=="type"?Ie+(hn+"="+lt+"&"):Ie+(hn+"=redacted&")}}else Ie=null;else Ie=W;return"XMLHTTP REQ ("+b+") [attempt "+K+"]: "+p+`
`+v+`
`+Ie})}function wl(u,p,v,b,K,W,Ie){u.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+K+"]: "+p+`
`+v+`
`+W+" "+Ie})}function Ks(u,p,v,b){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+Ko(u,v)+(b?" "+b:"")})}function zn(u,p){u.info(function(){return"TIMEOUT: "+p})}zs.prototype.info=function(){};function Ko(u,p){if(!u.g)return p;if(!p)return null;try{var v=JSON.parse(p);if(v){for(u=0;u<v.length;u++)if(Array.isArray(v[u])){var b=v[u];if(!(2>b.length)){var K=b[1];if(Array.isArray(K)&&!(1>K.length)){var W=K[0];if(W!="noop"&&W!="stop"&&W!="close")for(var Ie=1;Ie<K.length;Ie++)K[Ie]=""}}}}return cn(v)}catch{return p}}var Kn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Il={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Go;function jr(){}T(jr,_l),jr.prototype.g=function(){return new XMLHttpRequest},jr.prototype.i=function(){return{}},Go=new jr;function nr(u,p,v,b){this.j=u,this.i=p,this.l=v,this.R=b||1,this.U=new Mt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Hi}function Hi(){this.i=null,this.g="",this.h=!1}var as={},Ho={};function Gs(u,p,v){u.L=1,u.v=qr(_r(p)),u.m=v,u.P=!0,gr(u,null)}function gr(u,p){u.F=Date.now(),Wo(u),u.A=_r(u.v);var v=u.A,b=u.R;Array.isArray(b)||(b=[String(b)]),Ht(v.i,"t",b),u.C=0,v=u.j.J,u.h=new Hi,u.g=Nl(u.j,v?p:null,!u.m),0<u.O&&(u.M=new _n(g(u.Y,u,u.g),u.O)),p=u.U,v=u.g,b=u.ca;var K="readystatechange";Array.isArray(K)||(K&&(mr[0]=K.toString()),K=mr);for(var W=0;W<K.length;W++){var Ie=oe(v,K[W],b||p.handleEvent,!1,p.h||p);if(!Ie)break;p.g[Ie.key]=Ie}p=u.H?I(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),qs(),bc(u.i,u.u,u.A,u.l,u.R,u.m)}nr.prototype.ca=function(u){u=u.target;const p=this.M;p&&Nr(u)==3?p.j():this.Y(u)},nr.prototype.Y=function(u){try{if(u==this.g)e:{const gn=Nr(this.g);var p=this.g.Ba();const ti=this.g.Z();if(!(3>gn)&&(gn!=3||this.g&&(this.h.h||this.g.oa()||Cl(this.g)))){this.J||gn!=4||p==7||(p==8||0>=ti?qs(3):qs(2)),vr(this);var v=this.g.Z();this.X=v;t:if(wc(this)){var b=Cl(this.g);u="";var K=b.length,W=Nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Br(this),ls(this);var Ie="";break t}this.h.i=new a.TextDecoder}for(p=0;p<K;p++)this.h.h=!0,u+=this.h.i.decode(b[p],{stream:!(W&&p==K-1)});b.length=0,this.h.g+=u,this.C=0,Ie=this.h.g}else Ie=this.g.oa();if(this.o=v==200,wl(this.i,this.u,this.A,this.l,this.R,gn,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Et,dn=this.g;if((Et=dn.g?dn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Et)){var lt=Et;break t}}lt=null}if(v=lt)Ks(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qo(this,v);else{this.o=!1,this.s=3,nn(12),Br(this),ls(this);break e}}if(this.P){v=!0;let cr;for(;!this.J&&this.C<Ie.length;)if(cr=ef(this,Ie),cr==Ho){gn==4&&(this.s=4,nn(14),v=!1),Ks(this.i,this.l,null,"[Incomplete Response]");break}else if(cr==as){this.s=4,nn(15),Ks(this.i,this.l,Ie,"[Invalid Chunk]"),v=!1;break}else Ks(this.i,this.l,cr,null),Qo(this,cr);if(wc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gn!=4||Ie.length!=0||this.h.h||(this.s=1,nn(16),v=!1),this.o=this.o&&v,!v)Ks(this.i,this.l,Ie,"[Invalid Chunked Response]"),Br(this),ls(this);else if(0<Ie.length&&!this.W){this.W=!0;var hn=this.j;hn.g==this&&hn.ba&&!hn.M&&(hn.j.info("Great, no buffering proxy detected. Bytes received: "+Ie.length),Dl(hn),hn.M=!0,nn(11))}}else Ks(this.i,this.l,Ie,null),Qo(this,Ie);gn==4&&Br(this),this.o&&!this.J&&(gn==4?Dc(this.j,this):(this.o=!1,Wo(this)))}else Ys(this.g),v==400&&0<Ie.indexOf("Unknown SID")?(this.s=3,nn(12)):(this.s=0,nn(13)),Br(this),ls(this)}}}catch{}finally{}};function wc(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ef(u,p){var v=u.C,b=p.indexOf(`
`,v);return b==-1?Ho:(v=Number(p.substring(v,b)),isNaN(v)?as:(b+=1,b+v>p.length?Ho:(p=p.slice(b,b+v),u.C=b+v,p)))}nr.prototype.cancel=function(){this.J=!0,Br(this)};function Wo(u){u.S=Date.now()+u.I,El(u,u.I)}function El(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=kn(g(u.ba,u),p)}function vr(u){u.B&&(a.clearTimeout(u.B),u.B=null)}nr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(zn(this.i,this.A),this.L!=2&&(qs(),nn(17)),Br(this),this.s=2,ls(this)):El(this,this.S-u)};function ls(u){u.j.G==0||u.J||Dc(u.j,u)}function Br(u){vr(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Ur(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Qo(u,p){try{var v=u.j;if(v.G!=0&&(v.g==u||Yo(v.h,u))){if(!u.K&&Yo(v.h,u)&&v.G==3){try{var b=v.Da.g.parse(p)}catch{b=null}if(Array.isArray(b)&&b.length==3){var K=b;if(K[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<u.F)oa(v),no(v);else break e;kl(v),nn(18)}}else v.za=K[1],0<v.za-v.T&&37500>K[2]&&v.F&&v.v==0&&!v.C&&(v.C=kn(g(v.Za,v),6e3));if(1>=xl(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else hs(v,11)}else if((u.K||v.g==u)&&oa(v),!q(p))for(K=v.Da.g.parse(p),p=0;p<K.length;p++){let lt=K[p];if(v.T=lt[0],lt=lt[1],v.G==2)if(lt[0]=="c"){v.K=lt[1],v.ia=lt[2];const hn=lt[3];hn!=null&&(v.la=hn,v.j.info("VER="+v.la));const gn=lt[4];gn!=null&&(v.Aa=gn,v.j.info("SVER="+v.Aa));const ti=lt[5];ti!=null&&typeof ti=="number"&&0<ti&&(b=1.5*ti,v.L=b,v.j.info("backChannelRequestTimeoutMs_="+b)),b=v;const cr=u.g;if(cr){const aa=cr.g?cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(aa){var W=b.h;W.g||aa.indexOf("spdy")==-1&&aa.indexOf("quic")==-1&&aa.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Hs(W,W.h),W.h=null))}if(b.D){const fs=cr.g?cr.g.getResponseHeader("X-HTTP-Session-Id"):null;fs&&(b.ya=fs,Pt(b.I,b.D,fs))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-u.F,v.j.info("Handshake RTT: "+v.R+"ms")),b=v;var Ie=u;if(b.qa=Vc(b,b.J?b.ia:null,b.W),Ie.K){Wi(b.h,Ie);var Et=Ie,dn=b.L;dn&&(Et.I=dn),Et.B&&(vr(Et),Wo(Et)),b.g=Ie}else Cc(b);0<v.i.length&&sa(v)}else lt[0]!="stop"&&lt[0]!="close"||hs(v,7);else v.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?hs(v,7):Xs(v):lt[0]!="noop"&&v.l&&v.l.ta(lt),v.v=0)}}qs(4)}catch{}}var Tl=class{constructor(u,p){this.g=u,this.map=p}};function Ic(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Jo(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function xl(u){return u.h?1:u.g?u.g.size:0}function Yo(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Hs(u,p){u.g?u.g.add(p):u.h=p}function Wi(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Ic.prototype.cancel=function(){if(this.i=Qi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Qi(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const v of u.g.values())p=p.concat(v.D);return p}return A(u.i)}function Al(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],v=u.length,b=0;b<v;b++)p.push(u[b]);return p}p=[],v=0;for(b in u)p[v++]=u[b];return p}function Fe(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var v=0;v<u;v++)p.push(v);return p}p=[],v=0;for(const b in u)p[v++]=b;return p}}}function pt(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var v=Fe(u),b=Al(u),K=b.length,W=0;W<K;W++)p.call(void 0,b[W],v&&v[W],u)}var yr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ji(u,p){if(u){u=u.split("&");for(var v=0;v<u.length;v++){var b=u[v].indexOf("="),K=null;if(0<=b){var W=u[v].substring(0,b);K=u[v].substring(b+1)}else W=u[v];p(W,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function us(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof us){this.h=u.h,Xo(this,u.j),this.o=u.o,this.g=u.g,Zo(this,u.s),this.l=u.l;var p=u.i,v=new Xi;v.i=p.i,p.g&&(v.g=new Map(p.g),v.h=p.h),ea(this,v),this.m=u.m}else u&&(p=String(u).match(yr))?(this.h=!1,Xo(this,p[1]||"",!0),this.o=zr(p[2]||""),this.g=zr(p[3]||"",!0),Zo(this,p[4]),this.l=zr(p[5]||"",!0),ea(this,p[6]||"",!0),this.m=zr(p[7]||"")):(this.h=!1,this.i=new Xi(null,this.h))}us.prototype.toString=function(){var u=[],p=this.j;p&&u.push(br(p,Qs,!0),":");var v=this.g;return(v||p=="file")&&(u.push("//"),(p=this.o)&&u.push(br(p,Qs,!0),"@"),u.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&u.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&u.push("/"),u.push(br(v,v.charAt(0)=="/"?ta:Yi,!0))),(v=this.i.toString())&&u.push("?",v),(v=this.m)&&u.push("#",br(v,nf)),u.join("")};function _r(u){return new us(u)}function Xo(u,p,v){u.j=v?zr(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Zo(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function ea(u,p,v){p instanceof Xi?(u.i=p,rf(u.i,u.h)):(v||(p=br(p,tf)),u.i=new Xi(p,u.h))}function Pt(u,p,v){u.i.set(p,v)}function qr(u){return Pt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function zr(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function br(u,p,v){return typeof u=="string"?(u=encodeURI(u).replace(p,Ws),v&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Ws(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Qs=/[#\/\?@]/g,Yi=/[#\?:]/g,ta=/[#\?]/g,tf=/[#\?@]/g,nf=/#/g;function Xi(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function kr(u){u.g||(u.g=new Map,u.h=0,u.i&&Ji(u.i,function(p,v){u.add(decodeURIComponent(p.replace(/\+/g," ")),v)}))}n=Xi.prototype,n.add=function(u,p){kr(this),this.i=null,u=at(this,u);var v=this.g.get(u);return v||this.g.set(u,v=[]),v.push(p),this.h+=1,this};function qe(u,p){kr(u),p=at(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function et(u,p){return kr(u),p=at(u,p),u.g.has(p)}n.forEach=function(u,p){kr(this),this.g.forEach(function(v,b){v.forEach(function(K){u.call(p,K,b,this)},this)},this)},n.na=function(){kr(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),v=[];for(let b=0;b<p.length;b++){const K=u[b];for(let W=0;W<K.length;W++)v.push(p[b])}return v},n.V=function(u){kr(this);let p=[];if(typeof u=="string")et(this,u)&&(p=p.concat(this.g.get(at(this,u))));else{u=Array.from(this.g.values());for(let v=0;v<u.length;v++)p=p.concat(u[v])}return p},n.set=function(u,p){return kr(this),this.i=null,u=at(this,u),et(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Ht(u,p,v){qe(u,p),0<v.length&&(u.i=null,u.g.set(at(u,p),A(v)),u.h+=v.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var v=0;v<p.length;v++){var b=p[v];const W=encodeURIComponent(String(b)),Ie=this.V(b);for(b=0;b<Ie.length;b++){var K=W;Ie[b]!==""&&(K+="="+encodeURIComponent(String(Ie[b]))),u.push(K)}}return this.i=u.join("&")};function at(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function rf(u,p){p&&!u.j&&(kr(u),u.i=null,u.g.forEach(function(v,b){var K=b.toLowerCase();b!=K&&(qe(this,b),Ht(this,K,v))},u)),u.j=p}function Sl(u,p){const v=new zs;if(a.Image){const b=new Image;b.onload=y(Gn,v,"TestLoadImage: loaded",!0,p,b),b.onerror=y(Gn,v,"TestLoadImage: error",!1,p,b),b.onabort=y(Gn,v,"TestLoadImage: abort",!1,p,b),b.ontimeout=y(Gn,v,"TestLoadImage: timeout",!1,p,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=u}else p(!1)}function Ec(u,p){const v=new zs,b=new AbortController,K=setTimeout(()=>{b.abort(),Gn(v,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:b.signal}).then(W=>{clearTimeout(K),W.ok?Gn(v,"TestPingServer: ok",!0,p):Gn(v,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(K),Gn(v,"TestPingServer: error",!1,p)})}function Gn(u,p,v,b,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),b(v)}catch{}}function Js(){this.g=new zi}function sf(u,p,v){const b=v||"";try{pt(u,function(K,W){let Ie=K;c(K)&&(Ie=cn(K)),p.push(b+W+"="+encodeURIComponent(Ie))})}catch(K){throw p.push(b+"type="+encodeURIComponent("_badmap")),K}}function Dr(u){this.l=u.Ub||null,this.j=u.eb||!1}T(Dr,_l),Dr.prototype.g=function(){return new Dn(this.l,this.j)},Dr.prototype.i=function(u){return function(){return u}}({});function Dn(u,p){Le.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Dn,Le),n=Dn.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,Zi(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,cs(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Zi(this)),this.g&&(this.readyState=3,Zi(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Tc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?cs(this):Zi(this),this.readyState==3&&Tc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,cs(this))},n.Qa=function(u){this.g&&(this.response=u,cs(this))},n.ga=function(){this.g&&cs(this)};function cs(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Zi(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var v=p.next();!v.done;)v=v.value,u.push(v[0]+": "+v[1]),v=p.next();return u.join(`\r
`)};function Zi(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Dn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function xc(u){let p="";return me(u,function(v,b){p+=b,p+=":",p+=v,p+=`\r
`}),p}function Pl(u,p,v){e:{for(b in v){var b=!1;break e}b=!0}b||(v=xc(v),typeof u=="string"?v!=null&&encodeURIComponent(String(v)):Pt(u,p,v))}function Lt(u){Le.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(Lt,Le);var na=/^https?$/i,Rl=["POST","PUT"];n=Lt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,v,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Go.g(),this.v=this.o?vc(this.o):vc(Go),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(W){rr(this,W);return}if(u=v||"",v=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var K in b)v.set(K,b[K]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const W of b.keys())v.set(W,b.get(W));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(v.keys()).find(W=>W.toLowerCase()=="content-type"),K=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Rl,p,void 0))||b||K||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,Ie]of v)this.g.setRequestHeader(W,Ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ra(this),this.u=!0,this.g.send(u),this.u=!1}catch(W){rr(this,W)}};function rr(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,Ac(u),eo(u)}function Ac(u){u.A||(u.A=!0,He(u,"complete"),He(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,He(this,"complete"),He(this,"abort"),eo(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),eo(this,!0)),Lt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Sc(this):this.bb())},n.bb=function(){Sc(this)};function Sc(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Nr(u)!=4||u.Z()!=2)){if(u.u&&Nr(u)==4)Yt(u.Ea,0,u);else if(He(u,"readystatechange"),Nr(u)==4){u.h=!1;try{const Ie=u.Z();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var v;if(!(v=p)){var b;if(b=Ie===0){var K=String(u.D).match(yr)[1]||null;!K&&a.self&&a.self.location&&(K=a.self.location.protocol.slice(0,-1)),b=!na.test(K?K.toLowerCase():"")}v=b}if(v)He(u,"complete"),He(u,"success");else{u.m=6;try{var W=2<Nr(u)?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.Z()+"]",Ac(u)}}finally{eo(u)}}}}function eo(u,p){if(u.g){ra(u);const v=u.g,b=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||He(u,"ready");try{v.onreadystatechange=b}catch{}}}function ra(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Nr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Nr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Cn(p)}};function Cl(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ys(u){const p={};u=(u.g&&2<=Nr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<u.length;b++){if(q(u[b]))continue;var v=V(u[b]);const K=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const W=p[K]||[];p[K]=W,W.push(v)}x(p,function(b){return b.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ds(u,p,v){return v&&v.internalChannelParams&&v.internalChannelParams[u]||p}function to(u){this.Aa=0,this.i=[],this.j=new zs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ds("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ds("baseRetryDelayMs",5e3,u),this.cb=ds("retryDelaySeedMs",1e4,u),this.Wa=ds("forwardChannelMaxRetries",2,u),this.wa=ds("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ic(u&&u.concurrentRequestLimit),this.Da=new Js,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=to.prototype,n.la=8,n.G=1,n.connect=function(u,p,v,b){nn(0),this.W=u,this.H=p||{},v&&b!==void 0&&(this.H.OSID=v,this.H.OAID=b),this.F=this.X,this.I=Vc(this,null,this.W),sa(this)};function Xs(u){if(Pc(u),u.G==3){var p=u.U++,v=_r(u.I);if(Pt(v,"SID",u.K),Pt(v,"RID",p),Pt(v,"TYPE","terminate"),Kr(u,v),p=new nr(u,u.j,p),p.L=2,p.v=qr(_r(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!v&&a.Image&&(new Image().src=p.v,v=!0),v||(p.g=Nl(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Wo(p)}Nc(u)}function no(u){u.g&&(Dl(u),u.g.cancel(),u.g=null)}function Pc(u){no(u),u.u&&(a.clearTimeout(u.u),u.u=null),oa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function sa(u){if(!Jo(u.h)&&!u.s){u.s=!0;var p=u.Ga;j||Be(),ne||(j(),ne=!0),Ke.add(p,u),u.B=0}}function Rc(u,p){return xl(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=kn(g(u.Ga,u,p),Zs(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const K=new nr(this,this.j,u);let W=this.o;if(this.S&&(W?(W=I(W),C(W,this.S)):W=this.S),this.m!==null||this.O||(K.H=W,W=null),this.P)e:{for(var p=0,v=0;v<this.i.length;v++){t:{var b=this.i[v];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(p+=b,4096<p){p=v;break e}if(p===4096||v===this.i.length-1){p=v+1;break e}}p=1e3}else p=1e3;p=ro(this,K,p),v=_r(this.I),Pt(v,"RID",u),Pt(v,"CVER",22),this.D&&Pt(v,"X-HTTP-Session-Id",this.D),Kr(this,v),W&&(this.O?p="headers="+encodeURIComponent(String(xc(W)))+"&"+p:this.m&&Pl(v,this.m,W)),Hs(this.h,K),this.Ua&&Pt(v,"TYPE","init"),this.P?(Pt(v,"$req",p),Pt(v,"SID","null"),K.T=!0,Gs(K,v,null)):Gs(K,v,p),this.G=2}}else this.G==3&&(u?ia(this,u):this.i.length==0||Jo(this.h)||ia(this))};function ia(u,p){var v;p?v=p.l:v=u.U++;const b=_r(u.I);Pt(b,"SID",u.K),Pt(b,"RID",v),Pt(b,"AID",u.T),Kr(u,b),u.m&&u.o&&Pl(b,u.m,u.o),v=new nr(u,u.j,v,u.B+1),u.m===null&&(v.H=u.o),p&&(u.i=p.D.concat(u.i)),p=ro(u,v,1e3),v.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Hs(u.h,v),Gs(v,b,p)}function Kr(u,p){u.H&&me(u.H,function(v,b){Pt(p,b,v)}),u.l&&pt({},function(v,b){Pt(p,b,v)})}function ro(u,p,v){v=Math.min(u.i.length,v);var b=u.l?g(u.l.Na,u.l,u):null;e:{var K=u.i;let W=-1;for(;;){const Ie=["count="+v];W==-1?0<v?(W=K[0].g,Ie.push("ofs="+W)):W=0:Ie.push("ofs="+W);let Et=!0;for(let dn=0;dn<v;dn++){let lt=K[dn].g;const hn=K[dn].map;if(lt-=W,0>lt)W=Math.max(0,K[dn].g-100),Et=!1;else try{sf(hn,Ie,"req"+lt+"_")}catch{b&&b(hn)}}if(Et){b=Ie.join("&");break e}}}return u=u.i.splice(0,v),p.D=u,b}function Cc(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;j||Be(),ne||(j(),ne=!0),Ke.add(p,u),u.v=0}}function kl(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=kn(g(u.Fa,u),Zs(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,kc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=kn(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nn(10),no(this),kc(this))};function Dl(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function kc(u){u.g=new nr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=_r(u.qa);Pt(p,"RID","rpc"),Pt(p,"SID",u.K),Pt(p,"AID",u.T),Pt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&Pt(p,"TO",u.ja),Pt(p,"TYPE","xmlhttp"),Kr(u,p),u.m&&u.o&&Pl(p,u.m,u.o),u.L&&(u.g.I=u.L);var v=u.g;u=u.ia,v.L=1,v.v=qr(_r(p)),v.m=null,v.P=!0,gr(v,u)}n.Za=function(){this.C!=null&&(this.C=null,no(this),kl(this),nn(19))};function oa(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Dc(u,p){var v=null;if(u.g==p){oa(u),Dl(u),u.g=null;var b=2}else if(Yo(u.h,p))v=p.D,Wi(u.h,p),b=1;else return;if(u.G!=0){if(p.o)if(b==1){v=p.m?p.m.length:0,p=Date.now()-p.F;var K=u.B;b=Rr(),He(b,new _c(b,v)),sa(u)}else Cc(u);else if(K=p.s,K==3||K==0&&0<p.X||!(b==1&&Rc(u,p)||b==2&&kl(u)))switch(v&&0<v.length&&(p=u.h,p.i=p.i.concat(v)),K){case 1:hs(u,5);break;case 4:hs(u,10);break;case 3:hs(u,6);break;default:hs(u,2)}}}function Zs(u,p){let v=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(v*=2),v*p}function hs(u,p){if(u.j.info("Error code "+p),p==2){var v=g(u.fb,u),b=u.Xa;const K=!b;b=new us(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Xo(b,"https"),qr(b),K?Sl(b.toString(),v):Ec(b.toString(),v)}else nn(2);u.G=0,u.l&&u.l.sa(p),Nc(u),Pc(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function Nc(u){if(u.G=0,u.ka=[],u.l){const p=Qi(u.h);(p.length!=0||u.i.length!=0)&&(P(u.ka,p),P(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function Vc(u,p,v){var b=v instanceof us?_r(v):new us(v);if(b.g!="")p&&(b.g=p+"."+b.g),Zo(b,b.s);else{var K=a.location;b=K.protocol,p=p?p+"."+K.hostname:K.hostname,K=+K.port;var W=new us(null);b&&Xo(W,b),p&&(W.g=p),K&&Zo(W,K),v&&(W.l=v),b=W}return v=u.D,p=u.ya,v&&p&&Pt(b,v,p),Pt(b,"VER",u.la),Kr(u,b),b}function Nl(u,p,v){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Lt(new Dr({eb:v})):new Lt(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Oc(){}n=Oc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(u,p){return new Hn(u,p)};function Hn(u,p){Le.call(this),this.g=new to(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!q(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!q(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new ei(this)}T(Hn,Le),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){Xs(this.g)},Hn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var v={};v.__data__=u,u=v}else this.u&&(v={},v.__data__=cn(u),u=v);p.i.push(new Tl(p.Ya++,u)),p.G==3&&sa(p)},Hn.prototype.N=function(){this.g.l=null,delete this.j,Xs(this.g),delete this.g,Hn.aa.N.call(this)};function Mc(u){bl.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const v in p){u=v;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}T(Mc,bl);function Lc(){Sr.call(this),this.status=1}T(Lc,Sr);function ei(u){this.g=u}T(ei,Oc),ei.prototype.ua=function(){He(this.g,"a")},ei.prototype.ta=function(u){He(this.g,new Mc(u))},ei.prototype.sa=function(u){He(this.g,new Lc)},ei.prototype.ra=function(){He(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,Wb=function(){return new so},Hb=function(){return Rr()},Gb=tr,dp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kn.NO_ERROR=0,Kn.TIMEOUT=8,Kn.HTTP_ERROR=6,id=Kn,Il.COMPLETE="complete",Kb=Il,yc.EventType=Ki,Ki.OPEN="a",Ki.CLOSE="b",Ki.ERROR="c",Ki.MESSAGE="d",Le.prototype.listen=Le.prototype.K,Ql=yc,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,zb=Lt}).apply(typeof qc<"u"?qc:typeof self<"u"?self:typeof window<"u"?window:{});const my="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=new dm("@firebase/firestore");function ma(){return Pi.logLevel}function hj(n){Pi.setLogLevel(n)}function de(n,...e){if(Pi.logLevel<=st.DEBUG){const t=e.map(pm);Pi.debug(`Firestore (${rl}): ${n}`,...t)}}function sn(n,...e){if(Pi.logLevel<=st.ERROR){const t=e.map(pm);Pi.error(`Firestore (${rl}): ${n}`,...t)}}function xr(n,...e){if(Pi.logLevel<=st.WARN){const t=e.map(pm);Pi.warn(`Firestore (${rl}): ${n}`,...t)}}function pm(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(n="Unexpected state"){const e=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: `+n;throw sn(e),new Error(e)}function Ce(n,e){n||Re()}function fj(n,e){n||Re()}function Ee(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends os{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(wn.UNAUTHENTICATED))}shutdown(){}}class yR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class _R{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ce(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new In;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new In,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new In)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ce(typeof r.accessToken=="string"),new Qb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string"),new wn(e)}}class bR{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class wR{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new bR(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Jb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ce(this.o===void 0);const r=i=>{i.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,de("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ce(typeof t.token=="string"),this.R=t.token,new Jb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class pj{getToken(){return Promise.resolve(new Jb(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=ER(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function ze(n,e){return n<e?-1:n>e?1:0}function Oa(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Xb(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new he(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Qt.fromMillis(Date.now())}static fromDate(e){return Qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Qt(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Me(e)}static min(){return new Me(new Qt(0,0))}static max(){return new Me(new Qt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,t,r){t===void 0?t=0:t>e.length&&Re(),r===void 0?r=e.length-t:r>e.length-t&&Re(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return xu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xu?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class it extends xu{construct(e,t,r){return new it(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new he(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new it(t)}static emptyPath(){return new it([])}}const TR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends xu{construct(e,t,r){return new zt(e,t,r)}static isValidIdentifier(e){return TR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new he(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new he(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new he(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new he(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(it.fromString(e))}static fromName(e){return new Ae(it.fromString(e).popFirst(5))}static empty(){return new Ae(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return it.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new it(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function hp(n){return n.fields.find(e=>e.kind===2)}function co(n){return n.fields.filter(e=>e.kind!==2)}function xR(n,e){let t=ze(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=AR(n.fields[r],e.fields[r]),t!==0)return t;return ze(n.fields.length,e.fields.length)}Ma.UNKNOWN_ID=-1;class Eo{constructor(e,t){this.fieldPath=e,this.kind=t}}function AR(n,e){const t=zt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:ze(n.kind,e.kind)}class La{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new La(0,pr.min())}}function Zb(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Me.fromTimestamp(r===1e9?new Qt(t+1,0):new Qt(t,r));return new pr(s,Ae.empty(),e)}function ew(n){return new pr(n.readTime,n.key,-1)}class pr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new pr(Me.min(),Ae.empty(),-1)}static max(){return new pr(Me.max(),Ae.empty(),-1)}}function mm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ae.comparator(n.documentKey,e.documentKey),t!==0?t:ze(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fi(n){if(n.code!==H.FAILED_PRECONDITION||n.message!==tw)throw n;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new G((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof G?t:G.resolve(t)}catch(t){return G.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):G.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):G.reject(t)}static resolve(e){return new G((t,r)=>{t(e)})}static reject(e){return new G((t,r)=>{r(e)})}static waitFor(e){return new G((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=G.resolve(!1);for(const r of e)t=t.next(s=>s?G.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new G((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new G((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new In,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new cu(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=gm(r.target.error);this.V.reject(new cu(e,s))}}static open(e,t,r,s){try{return new gh(t,e.transaction(s,r))}catch(i){throw new cu(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(de("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new PR(t)}}class Zr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Zr.S(vn())===12.2&&sn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return de("SimpleDb","Removing database:",e),po(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!cm())return!1;if(Zr.v())return!0;const e=vn(),t=Zr.S(e),r=0<t&&t<10,s=rw(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(de("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new cu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new he(H.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new he(H.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new cu(e,o))},s.onupgradeneeded=i=>{de("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{de("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=gh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),G.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(de("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function rw(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class SR{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return po(this.B.delete())}}class cu extends he{constructor(e,t){super(H.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function $i(n){return n.name==="IndexedDbTransactionError"}class PR{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(de("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(de("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),po(r)}add(e){return de("SimpleDb","ADD",this.store.name,e,e),po(this.store.add(e))}get(e){return po(this.store.get(e)).next(t=>(t===void 0&&(t=null),de("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return de("SimpleDb","DELETE",this.store.name,e),po(this.store.delete(e))}count(){return de("SimpleDb","COUNT",this.store.name),po(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new G((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new G((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){de("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new G((r,s)=>{t.onerror=i=>{const o=gm(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new G((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new SR(a),c=t(a.primaryKey,a.value,l);if(c instanceof G){const d=c.catch(f=>(l.done(),G.reject(f)));r.push(d)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>G.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function po(n){return new G((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=gm(r.target.error);t(s)}})}let gy=!1;function gm(n){const e=Zr.S(vn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new he("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gy||(gy=!0,setTimeout(()=>{throw r},0)),r}}return n}class RR{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){de("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{de("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){$i(t)?de("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Fi(t)}await this.X(6e4)})}}class CR{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return G.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return de("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(de("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=ew(i);mm(o,r)>0&&(r=o)}),new pr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}or.oe=-1;function Qu(n){return n==null}function Au(n){return n===0&&1/n==-1/0}function sw(n){return typeof n=="number"&&Number.isInteger(n)&&!Au(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vy(e)),e=kR(n.get(t),e);return vy(e)}function kR(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function vy(n){return n+""}function Qr(n){const e=n.length;if(Ce(e>=2),e===2)return Ce(n.charAt(0)===""&&n.charAt(1)===""),it.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&Re(),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:Re()}i=o+2}return new it(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yy=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function od(n,e){return[n,jn(e)]}function iw(n,e,t){return[n,jn(e),t]}const DR={},NR=["prefixPath","collectionGroup","readTime","documentId"],VR=["prefixPath","collectionGroup","documentId"],OR=["collectionGroup","readTime","prefixPath","documentId"],MR=["canonicalId","targetId"],LR=["targetId","path"],FR=["path","targetId"],$R=["collectionId","parent"],UR=["indexId","uid"],jR=["uid","sequenceNumber"],BR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qR=["indexId","uid","orderedDocumentKey"],zR=["userId","collectionPath","documentId"],KR=["userId","collectionPath","largestBatchId"],GR=["userId","collectionGroup","largestBatchId"],ow=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],HR=[...ow,"documentOverlays"],aw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],lw=aw,vm=[...lw,"indexConfiguration","indexState","indexEntries"],WR=vm,QR=[...vm,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp extends nw{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function yn(n,e){const t=Ee(n);return Zr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ui(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function uw(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function cw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,t){this.comparator=e,this.root=t||An.EMPTY}insert(e,t){return new Ot(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,An.BLACK,null,null))}remove(e){return new Ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,An.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zc(this.root,e,this.comparator,!1)}getReverseIterator(){return new zc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zc(this.root,e,this.comparator,!0)}}class zc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class An{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??An.RED,this.left=s??An.EMPTY,this.right=i??An.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new An(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return An.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return An.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,An.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,An.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Re();const e=this.left.check();if(e!==this.right.check())throw Re();return e+(this.isRed()?0:1)}}An.EMPTY=null,An.RED=!0,An.BLACK=!1;An.EMPTY=new class{constructor(){this.size=0}get key(){throw Re()}get value(){throw Re()}get color(){throw Re()}get left(){throw Re()}get right(){throw Re()}copy(e,t,r,s,i){return this}insert(e,t,r){return new An(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.comparator=e,this.data=new Ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new by(this.data.getIterator())}getIteratorFrom(e){return new by(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof St)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new St(this.comparator);return t.data=e,t}}class by{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ua(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new ar([])}unionWith(e){let t=new St(zt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ar(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gj(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new dw("Invalid base64 string: "+i):i}}(e);return new en(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new en(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}en.EMPTY_BYTE_STRING=new en("");const JR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(n){if(Ce(!!n),typeof n=="string"){let e=0;const t=JR.exec(n);if(Ce(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qt(n.seconds),nanos:qt(n.nanos)}}function qt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ds(n){return typeof n=="string"?en.fromBase64String(n):en.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function yh(n){const e=n.mapValue.fields.__previous_value__;return vh(e)?yh(e):e}function Su(n){const e=ks(n.mapValue.fields.__local_write_time__.timestampValue);return new Qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Ao{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ao("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ao&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ad={nullValue:"NULL_VALUE"};function Ri(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?vh(n)?4:hw(n)?9007199254740991:_h(n)?10:11:Re()}function is(n,e){if(n===e)return!0;const t=Ri(n);if(t!==Ri(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Su(n).isEqual(Su(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ks(s.timestampValue),a=ks(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Ds(s.bytesValue).isEqual(Ds(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return qt(s.geoPointValue.latitude)===qt(i.geoPointValue.latitude)&&qt(s.geoPointValue.longitude)===qt(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return qt(s.integerValue)===qt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=qt(s.doubleValue),a=qt(i.doubleValue);return o===a?Au(o)===Au(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Oa(n.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(_y(o)!==_y(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!is(o[l],a[l])))return!1;return!0}(n,e);default:return Re()}}function Pu(n,e){return(n.values||[]).find(t=>is(t,e))!==void 0}function Ci(n,e){if(n===e)return 0;const t=Ri(n),r=Ri(e);if(t!==r)return ze(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=qt(i.integerValue||i.doubleValue),l=qt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return wy(n.timestampValue,e.timestampValue);case 4:return wy(Su(n),Su(e));case 5:return ze(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Ds(i),l=Ds(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=ze(a[c],l[c]);if(d!==0)return d}return ze(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ze(qt(i.latitude),qt(o.latitude));return a!==0?a:ze(qt(i.longitude),qt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Iy(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,d;const f=i.fields||{},g=o.fields||{},y=(a=f.value)===null||a===void 0?void 0:a.arrayValue,T=(l=g.value)===null||l===void 0?void 0:l.arrayValue,A=ze(((c=y==null?void 0:y.values)===null||c===void 0?void 0:c.length)||0,((d=T==null?void 0:T.values)===null||d===void 0?void 0:d.length)||0);return A!==0?A:Iy(y,T)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===_i.mapValue&&o===_i.mapValue)return 0;if(i===_i.mapValue)return 1;if(o===_i.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const g=ze(l[f],d[f]);if(g!==0)return g;const y=Ci(a[l[f]],c[d[f]]);if(y!==0)return y}return ze(l.length,d.length)}(n.mapValue,e.mapValue);default:throw Re()}}function wy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ze(n,e);const t=ks(n),r=ks(e),s=ze(t.seconds,r.seconds);return s!==0?s:ze(t.nanos,r.nanos)}function Iy(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Ci(t[s],r[s]);if(i)return i}return ze(t.length,r.length)}function Fa(n){return pp(n)}function pp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=ks(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ds(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ae.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=pp(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${pp(t.fields[o])}`;return s+"}"}(n.mapValue):Re()}function ld(n){switch(Ri(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=yh(n);return e?16+ld(e):16;case 5:return 2*n.stringValue.length;case 6:return Ds(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ld(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ui(r.fields,(i,o)=>{s+=i.length+ld(o)}),s}(n.mapValue);default:throw Re()}}function So(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function mp(n){return!!n&&"integerValue"in n}function Ru(n){return!!n&&"arrayValue"in n}function Ey(n){return!!n&&"nullValue"in n}function Ty(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ud(n){return!!n&&"mapValue"in n}function _h(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function du(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ui(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=du(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=du(n.arrayValue.values[t]);return e}return Object.assign({},n)}function hw(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const fw={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function XR(n){return"nullValue"in n?ad:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?So(Ao.empty(),Ae.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?_h(n)?fw:{mapValue:{}}:Re()}function ZR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?So(Ao.empty(),Ae.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fw:"mapValue"in n?_h(n)?{mapValue:{}}:_i:Re()}function xy(n,e){const t=Ci(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Ay(n,e){const t=Ci(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ud(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(t)}setAll(e){let t=zt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=du(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ud(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ud(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ui(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Pn(du(this.value))}}function pw(n){const e=[];return Ui(n.fields,(t,r)=>{const s=new zt([t]);if(ud(r)){const i=pw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ar(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new $t(e,0,Me.min(),Me.min(),Me.min(),Pn.empty(),0)}static newFoundDocument(e,t,r,s){return new $t(e,1,t,Me.min(),r,s,0)}static newNoDocument(e,t){return new $t(e,2,t,Me.min(),Me.min(),Pn.empty(),0)}static newUnknownDocument(e,t){return new $t(e,3,t,Me.min(),Me.min(),Pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,t){this.position=e,this.inclusive=t}}function Sy(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=Ae.comparator(Ae.fromName(o.referenceValue),t.key):r=Ci(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Py(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!is(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,t="asc"){this.field=e,this.dir=t}}function eC(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{}class ot extends mw{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new tC(e,t,r):t==="array-contains"?new sC(e,r):t==="in"?new ww(e,r):t==="not-in"?new iC(e,r):t==="array-contains-any"?new oC(e,r):new ot(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new nC(e,r):new rC(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ci(t,this.value)):t!==null&&Ri(this.value)===Ri(t)&&this.matchesComparison(Ci(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tt extends mw{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Tt(e,t)}matches(e){return $a(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function $a(n){return n.op==="and"}function gp(n){return n.op==="or"}function ym(n){return gw(n)&&$a(n)}function gw(n){for(const e of n.filters)if(e instanceof Tt)return!1;return!0}function vp(n){if(n instanceof ot)return n.field.canonicalString()+n.op.toString()+Fa(n.value);if(ym(n))return n.filters.map(e=>vp(e)).join(",");{const e=n.filters.map(t=>vp(t)).join(",");return`${n.op}(${e})`}}function vw(n,e){return n instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.field.isEqual(s.field)&&is(r.value,s.value)}(n,e):n instanceof Tt?function(r,s){return s instanceof Tt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&vw(o,s.filters[a]),!0):!1}(n,e):void Re()}function yw(n,e){const t=n.filters.concat(e);return Tt.create(t,n.op)}function _w(n){return n instanceof ot?function(t){return`${t.field.canonicalString()} ${t.op} ${Fa(t.value)}`}(n):n instanceof Tt?function(t){return t.op.toString()+" {"+t.getFilters().map(_w).join(" ,")+"}"}(n):"Filter"}class tC extends ot{constructor(e,t,r){super(e,t,r),this.key=Ae.fromName(r.referenceValue)}matches(e){const t=Ae.comparator(e.key,this.key);return this.matchesComparison(t)}}class nC extends ot{constructor(e,t){super(e,"in",t),this.keys=bw("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class rC extends ot{constructor(e,t){super(e,"not-in",t),this.keys=bw("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function bw(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Ae.fromName(r.referenceValue))}class sC extends ot{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ru(t)&&Pu(t.arrayValue,this.value)}}class ww extends ot{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Pu(this.value.arrayValue,t)}}class iC extends ot{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Pu(this.value.arrayValue,t)}}class oC extends ot{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ru(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Pu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function yp(n,e=null,t=[],r=[],s=null,i=null,o=null){return new aC(n,e,t,r,s,i,o)}function Po(n){const e=Ee(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>vp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Qu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Fa(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Fa(r)).join(",")),e.ue=t}return e.ue}function Ju(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eC(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!vw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Py(n.startAt,e.startAt)&&Py(n.endAt,e.endAt)}function Vd(n){return Ae.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Od(n,e){return n.filters.filter(t=>t instanceof ot&&t.field.isEqual(e))}function Ry(n,e,t){let r=ad,s=!0;for(const i of Od(n,e)){let o=ad,a=!0;switch(i.op){case"<":case"<=":o=XR(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=ad}xy({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];xy({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Cy(n,e,t){let r=_i,s=!0;for(const i of Od(n,e)){let o=_i,a=!0;switch(i.op){case">=":case">":o=ZR(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=_i}Ay({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Ay({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Iw(n,e,t,r,s,i,o,a){return new Ls(n,e,t,r,s,i,o,a)}function sl(n){return new Ls(n)}function ky(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _m(n){return n.collectionGroup!==null}function xa(n){const e=Ee(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new St(zt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Cu(i,r))}),t.has(zt.keyField().canonicalString())||e.ce.push(new Cu(zt.keyField(),r))}return e.ce}function Bn(n){const e=Ee(n);return e.le||(e.le=Tw(e,xa(n))),e.le}function Ew(n){const e=Ee(n);return e.he||(e.he=Tw(e,n.explicitOrderBy)),e.he}function Tw(n,e){if(n.limitType==="F")return yp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Cu(s.field,i)});const t=n.endAt?new ki(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ki(n.startAt.position,n.startAt.inclusive):null;return yp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function _p(n,e){const t=n.filters.concat([e]);return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Md(n,e,t){return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yu(n,e){return Ju(Bn(n),Bn(e))&&n.limitType===e.limitType}function xw(n){return`${Po(Bn(n))}|lt:${n.limitType}`}function ga(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>_w(s)).join(", ")}]`),Qu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Fa(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Fa(s)).join(",")),`Target(${r})`}(Bn(n))}; limitType=${n.limitType})`}function Xu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of xa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=Sy(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,xa(r),s)||r.endAt&&!function(o,a,l){const c=Sy(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,xa(r),s))}(n,e)}function Aw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Sw(n){return(e,t)=>{let r=!1;for(const s of xa(n)){const i=lC(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function lC(n,e,t){const r=n.field.isKeyField()?Ae.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ci(l,c):Re()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ui(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return cw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=new Ot(Ae.comparator);function lr(){return uC}const Pw=new Ot(Ae.comparator);function Jl(...n){let e=Pw;for(const t of n)e=e.insert(t.key,t);return e}function Rw(n){let e=Pw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Jr(){return hu()}function Cw(){return hu()}function hu(){return new Fs(n=>n.toString(),(n,e)=>n.isEqual(e))}const cC=new Ot(Ae.comparator),dC=new St(Ae.comparator);function Ye(...n){let e=dC;for(const t of n)e=e.add(t);return e}const hC=new St(ze);function bm(){return hC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wm(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function kw(n){return{integerValue:""+n}}function Dw(n,e){return sw(e)?kw(e):wm(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(){this._=void 0}}function fC(n,e,t){return n instanceof Ua?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&vh(i)&&(i=yh(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Ro?Vw(n,e):n instanceof Co?Ow(n,e):function(s,i){const o=Nw(s,i),a=Dy(o)+Dy(s.Pe);return mp(o)&&mp(s.Pe)?kw(a):wm(s.serializer,a)}(n,e)}function pC(n,e,t){return n instanceof Ro?Vw(n,e):n instanceof Co?Ow(n,e):t}function Nw(n,e){return n instanceof ja?function(r){return mp(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ua extends bh{}class Ro extends bh{constructor(e){super(),this.elements=e}}function Vw(n,e){const t=Mw(e);for(const r of n.elements)t.some(s=>is(s,r))||t.push(r);return{arrayValue:{values:t}}}class Co extends bh{constructor(e){super(),this.elements=e}}function Ow(n,e){let t=Mw(e);for(const r of n.elements)t=t.filter(s=>!is(s,r));return{arrayValue:{values:t}}}class ja extends bh{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Dy(n){return qt(n.integerValue||n.doubleValue)}function Mw(n){return Ru(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,t){this.field=e,this.transform=t}}function mC(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Ro&&s instanceof Ro||r instanceof Co&&s instanceof Co?Oa(r.elements,s.elements,is):r instanceof ja&&s instanceof ja?is(r.Pe,s.Pe):r instanceof Ua&&s instanceof Ua}(n.transform,e.transform)}class gC{constructor(e,t){this.version=e,this.transformResults=t}}class Kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kt}static exists(e){return new Kt(void 0,e)}static updateTime(e){return new Kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class wh{}function Lw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ol(n.key,Kt.none()):new il(n.key,n.data,Kt.none());{const t=n.data,r=Pn.empty();let s=new St(zt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new $s(n.key,r,new ar(s.toArray()),Kt.none())}}function vC(n,e,t){n instanceof il?function(s,i,o){const a=s.value.clone(),l=Vy(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof $s?function(s,i,o){if(!cd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Vy(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Fw(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function fu(n,e,t,r){return n instanceof il?function(i,o,a,l){if(!cd(i.precondition,o))return a;const c=i.value.clone(),d=Oy(i.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof $s?function(i,o,a,l){if(!cd(i.precondition,o))return a;const c=Oy(i.fieldTransforms,l,o),d=o.data;return d.setAll(Fw(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return cd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function yC(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Nw(r.transform,s||null);i!=null&&(t===null&&(t=Pn.empty()),t.set(r.field,i))}return t||null}function Ny(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Oa(r,s,(i,o)=>mC(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class il extends wh{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class $s extends wh{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Fw(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Vy(n,e,t){const r=new Map;Ce(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,pC(o,a,t[s]))}return r}function Oy(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,fC(i,o,e))}return r}class ol extends wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Im extends wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&vC(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=fu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=fu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Cw();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=Lw(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Me.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(t,r)=>Ny(t,r))&&Oa(this.baseMutations,e.baseMutations,(t,r)=>Ny(t,r))}}class Tm{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ce(e.mutations.length===r.length);let s=function(){return cC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Tm(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn,ft;function Uw(n){switch(n){default:return Re();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function jw(n){if(n===void 0)return sn("GRPC error has no .code"),H.UNKNOWN;switch(n){case fn.OK:return H.OK;case fn.CANCELLED:return H.CANCELLED;case fn.UNKNOWN:return H.UNKNOWN;case fn.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case fn.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case fn.INTERNAL:return H.INTERNAL;case fn.UNAVAILABLE:return H.UNAVAILABLE;case fn.UNAUTHENTICATED:return H.UNAUTHENTICATED;case fn.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case fn.NOT_FOUND:return H.NOT_FOUND;case fn.ALREADY_EXISTS:return H.ALREADY_EXISTS;case fn.PERMISSION_DENIED:return H.PERMISSION_DENIED;case fn.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case fn.ABORTED:return H.ABORTED;case fn.OUT_OF_RANGE:return H.OUT_OF_RANGE;case fn.UNIMPLEMENTED:return H.UNIMPLEMENTED;case fn.DATA_LOSS:return H.DATA_LOSS;default:return Re()}}(ft=fn||(fn={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ld=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC=new Io([4294967295,4294967295],0);function My(n){const e=Bw().encode(n),t=new qb;return t.update(e),new Uint8Array(t.digest())}function Ly(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Io([t,r],0),new Io([s,i],0)]}class Am{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Yl(`Invalid padding: ${t}`);if(r<0)throw new Yl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Yl(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Yl(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Io.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(Io.fromNumber(r)));return s.compare(bC)===1&&(s=new Io([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=My(e),[r,s]=Ly(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Am(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=My(e),[r,s]=Ly(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Yl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,tc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ec(Me.min(),s,new Ot(ze),lr(),Ye())}}class tc{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new tc(r,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class qw{constructor(e,t){this.targetId=e,this.me=t}}class zw{constructor(e,t,r=en.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Fy{constructor(){this.fe=0,this.ge=Uy(),this.pe=en.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ye(),t=Ye(),r=Ye();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Re()}}),new tc(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Uy()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ce(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class wC{constructor(e){this.Le=e,this.Be=new Map,this.ke=lr(),this.qe=$y(),this.Qe=new Ot(ze)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Re()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Vd(i))if(r===0){const o=new Ae(i.path);this.Ue(t,o,$t.newNoDocument(o,Me.min()))}else Ce(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}Ld==null||Ld.et(function(d,f,g,y,T){var A,P,U,q,M,z;const fe={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},me=f.unchangedNames;return me&&(fe.bloomFilter={applied:T===0,hashCount:(A=me==null?void 0:me.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(q=(U=(P=me==null?void 0:me.bits)===null||P===void 0?void 0:P.bitmap)===null||U===void 0?void 0:U.length)!==null&&q!==void 0?q:0,padding:(z=(M=me==null?void 0:me.bits)===null||M===void 0?void 0:M.padding)!==null&&z!==void 0?z:0,mightContain:x=>{var I;return(I=y==null?void 0:y.mightContain(x))!==null&&I!==void 0&&I}}),fe}(o,e.me,this.Le.tt(),a,l))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Ds(r).toUint8Array()}catch(l){if(l instanceof dw)return xr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Am(o,s,i)}catch(l){return xr(l instanceof Yl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Vd(a.target)){const l=new Ae(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,$t.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=Ye();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new ec(e,t,this.Qe,this.ke,r);return this.ke=lr(),this.qe=$y(),this.Qe=new Ot(ze),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Fy,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new St(ze),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||de("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Fy),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function $y(){return new Ot(Ae.comparator)}function Uy(){return new Ot(Ae.comparator)}const IC=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),EC=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),TC=(()=>({and:"AND",or:"OR"}))();class xC{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bp(n,e){return n.useProto3Json||Qu(e)?e:{value:e}}function Ba(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function AC(n,e){return Ba(n,e.toTimestamp())}function an(n){return Ce(!!n),Me.fromTimestamp(function(t){const r=ks(t);return new Qt(r.seconds,r.nanos)}(n))}function Sm(n,e){return wp(n,e).canonicalString()}function wp(n,e){const t=function(s){return new it(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Gw(n){const e=it.fromString(n);return Ce(nI(e)),e}function ku(n,e){return Sm(n.databaseId,e.path)}function es(n,e){const t=Gw(e);if(t.get(1)!==n.databaseId.projectId)throw new he(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new he(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ae(Qw(t))}function Hw(n,e){return Sm(n.databaseId,e)}function Ww(n){const e=Gw(n);return e.length===4?it.emptyPath():Qw(e)}function Ip(n){return new it(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Qw(n){return Ce(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function jy(n,e,t){return{name:ku(n,e),fields:t.value.mapValue.fields}}function Jw(n,e,t){const r=es(n,e.name),s=an(e.updateTime),i=e.createTime?an(e.createTime):Me.min(),o=new Pn({mapValue:{fields:e.fields}}),a=$t.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function SC(n,e){return"found"in e?function(r,s){Ce(!!s.found),s.found.name,s.found.updateTime;const i=es(r,s.found.name),o=an(s.found.updateTime),a=s.found.createTime?an(s.found.createTime):Me.min(),l=new Pn({mapValue:{fields:s.found.fields}});return $t.newFoundDocument(i,o,a,l)}(n,e):"missing"in e?function(r,s){Ce(!!s.missing),Ce(!!s.readTime);const i=es(r,s.missing),o=an(s.readTime);return $t.newNoDocument(i,o)}(n,e):Re()}function PC(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Re()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Ce(d===void 0||typeof d=="string"),en.fromBase64String(d||"")):(Ce(d===void 0||d instanceof Buffer||d instanceof Uint8Array),en.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?H.UNKNOWN:jw(c.code);return new he(d,c.message||"")}(o);t=new zw(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=es(n,r.document.name),i=an(r.document.updateTime),o=r.document.createTime?an(r.document.createTime):Me.min(),a=new Pn({mapValue:{fields:r.document.fields}}),l=$t.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new dd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=es(n,r.document),i=r.readTime?an(r.readTime):Me.min(),o=$t.newNoDocument(s,i),a=r.removedTargetIds||[];t=new dd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=es(n,r.document),i=r.removedTargetIds||[];t=new dd([],i,s,null)}else{if(!("filter"in e))return Re();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new _C(s,i),a=r.targetId;t=new qw(a,o)}}return t}function Du(n,e){let t;if(e instanceof il)t={update:jy(n,e.key,e.value)};else if(e instanceof ol)t={delete:ku(n,e.key)};else if(e instanceof $s)t={update:jy(n,e.key,e.data),updateMask:VC(e.fieldMask)};else{if(!(e instanceof Im))return Re();t={verify:ku(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Ua)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ro)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Co)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ja)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Re()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:AC(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Re()}(n,e.precondition)),t}function Ep(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Kt.updateTime(an(i.updateTime)):i.exists!==void 0?Kt.exists(i.exists):Kt.none()}(e.currentDocument):Kt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Ce(a.setToServerValue==="REQUEST_TIME"),l=new Ua;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new Ro(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Co(d)}else"increment"in a?l=new ja(o,a.increment):Re();const c=zt.fromServerFormat(a.fieldPath);return new Zu(c,l)}(n,s)):[];if(e.update){e.update.name;const s=es(n,e.update.name),i=new Pn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new ar(c.map(d=>zt.fromServerFormat(d)))}(e.updateMask);return new $s(s,i,o,t,r)}return new il(s,i,t,r)}if(e.delete){const s=es(n,e.delete);return new ol(s,t)}if(e.verify){const s=es(n,e.verify);return new Im(s,t)}return Re()}function RC(n,e){return n&&n.length>0?(Ce(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?an(s.updateTime):an(i);return o.isEqual(Me.min())&&(o=an(i)),new gC(o,s.transformResults||[])}(t,e))):[]}function Yw(n,e){return{documents:[Hw(n,e.path)]}}function Ih(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Hw(n,s);const i=function(c){if(c.length!==0)return tI(Tt.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:di(g.field),direction:kC(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=bp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function Xw(n,e,t,r){const{_t:s,parent:i}=Ih(n,e),o={},a=[];let l=0;return t.forEach(c=>{const d=r?c.alias:"aggregate_"+l++;o[d]=c.alias,c.aggregateType==="count"?a.push({alias:d,count:{}}):c.aggregateType==="avg"?a.push({alias:d,avg:{field:di(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:d,sum:{field:di(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function Zw(n){let e=Ww(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ce(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const g=eI(f);return g instanceof Tt&&ym(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(T){return new Cu(va(T.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,Qu(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(f){const g=!!f.before,y=f.values||[];return new ki(y,g)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const g=!f.before,y=f.values||[];return new ki(y,g)}(t.endAt)),Iw(e,s,o,i,a,"F",l,c)}function CC(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=va(t.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=va(t.unaryFilter.field);return ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=va(t.unaryFilter.field);return ot.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=va(t.unaryFilter.field);return ot.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Re()}}(n):n.fieldFilter!==void 0?function(t){return ot.create(va(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Re()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Tt.create(t.compositeFilter.filters.map(r=>eI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Re()}}(t.compositeFilter.op))}(n):Re()}function kC(n){return IC[n]}function DC(n){return EC[n]}function NC(n){return TC[n]}function di(n){return{fieldPath:n.canonicalString()}}function va(n){return zt.fromServerFormat(n.fieldPath)}function tI(n){return n instanceof ot?function(t){if(t.op==="=="){if(Ty(t.value))return{unaryFilter:{field:di(t.field),op:"IS_NAN"}};if(Ey(t.value))return{unaryFilter:{field:di(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ty(t.value))return{unaryFilter:{field:di(t.field),op:"IS_NOT_NAN"}};if(Ey(t.value))return{unaryFilter:{field:di(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:di(t.field),op:DC(t.op),value:t.value}}}(n):n instanceof Tt?function(t){const r=t.getFilters().map(s=>tI(s));return r.length===1?r[0]:{compositeFilter:{op:NC(t.op),filters:r}}}(n):Re()}function VC(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,t,r,s,i=Me.min(),o=Me.min(),a=en.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ws(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ws(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ws(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ws(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e){this.ct=e}}function OC(n,e){let t;if(e.document)t=Jw(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ae.fromSegments(e.noDocument.path),s=Do(e.noDocument.readTime);t=$t.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re();{const r=Ae.fromSegments(e.unknownDocument.path),s=Do(e.unknownDocument.version);t=$t.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Qt(s[0],s[1]);return Me.fromTimestamp(i)}(e.readTime)),t}function By(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:ku(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ba(i,o.version.toTimestamp()),createTime:Ba(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ko(e.version)};else{if(!e.isUnknownDocument())return Re();r.unknownDocument={path:t.path.toArray(),version:ko(e.version)}}return r}function Fd(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ko(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Do(n){const e=new Qt(n.seconds,n.nanoseconds);return Me.fromTimestamp(e)}function mo(n,e){const t=(e.baseMutations||[]).map(i=>Ep(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Ep(n.ct,i)),s=Qt.fromMillis(e.localWriteTimeMs);return new Em(e.batchId,s,t,r)}function Xl(n){const e=Do(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Do(n.lastLimboFreeSnapshotVersion):Me.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return Ce(i.documents.length===1),Bn(sl(Ww(i.documents[0])))}(n.query):function(i){return Bn(Zw(i))}(n.query),new ws(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,en.fromBase64String(n.resumeToken))}function sI(n,e){const t=ko(e.snapshotVersion),r=ko(e.lastLimboFreeSnapshotVersion);let s;s=Vd(e.target)?Yw(n.ct,e.target):Ih(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Po(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Pm(n){const e=Zw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Md(e,e.limit,"L"):e}function Cf(n,e){return new xm(e.largestBatchId,Ep(n.ct,e.overlayMutation))}function qy(n,e){const t=e.path.lastSegment();return[n,jn(e.path.popLast()),t]}function zy(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ko(r.readTime),documentKey:jn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{getBundleMetadata(e,t){return Ky(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Do(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return Ky(e).put(function(s){return{bundleId:s.id,createTime:ko(an(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return Gy(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:Pm(i.bundledQuery),readTime:Do(i.readTime)}}(r)})}saveNamedQuery(e,t){return Gy(e).put(function(s){return{name:s.name,readTime:ko(an(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function Ky(n){return yn(n,"bundles")}function Gy(n){return yn(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Eh(e,r)}getOverlay(e,t){return $l(e).get(qy(this.userId,t)).next(r=>r?Cf(this.serializer,r):null)}getOverlays(e,t){const r=Jr();return G.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new xm(t,o);s.push(this.ht(e,a))}),G.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(jn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push($l(e).j("collectionPathOverlayIndex",a))}),G.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Jr(),i=jn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return $l(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Cf(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Jr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return $l(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const f=Cf(this.serializer,c);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return $l(e).put(function(s,i,o){const[a,l,c]=qy(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Du(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function $l(n){return yn(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{Pt(e){return yn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?en.fromUint8Array(r):en.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(qt(e.integerValue));else if("doubleValue"in e){const r=qt(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Au(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=ks(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ds(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?hw(e)?this.dt(t,Number.MAX_SAFE_INTEGER):_h(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Re()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(qt(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),Ae.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}go.vt=new go;function FC(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Hy(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=FC(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class $C{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=Hy(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=Hy(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class UC{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class jC{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Ul{constructor(){this.jt=new $C,this.Ht=new UC(this.jt),this.Jt=new jC(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new vo(this.indexId,this.documentKey,this.arrayValue,r)}}function si(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Wy(n.arrayValue,e.arrayValue),t!==0?t:(t=Wy(n.directionalValue,e.directionalValue),t!==0?t:Ae.comparator(n.documentKey,e.documentKey)))}function Wy(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e){this.Xt=new St((t,r)=>zt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Ce(e.collectionGroup===this.collectionId),this.nn)return!1;const t=hp(e);if(t!==void 0&&!this.sn(t))return!1;const r=co(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new St(zt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Eo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Eo(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Eo(r.field,r.dir==="asc"?0:1)));return new Ma(Ma.UNKNOWN_ID,this.collectionId,t,La.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(n){var e,t;if(Ce(n instanceof ot||n instanceof Tt),n instanceof ot){if(n instanceof ww){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>ot.create(n.field,"==",i)))||[];return Tt.create(s,"or")}return n}const r=n.filters.map(s=>iI(s));return Tt.create(r,n.op)}function BC(n){if(n.getFilters().length===0)return[];const e=Ap(iI(n));return Ce(oI(e)),Tp(e)||xp(e)?[e]:e.getFilters()}function Tp(n){return n instanceof ot}function xp(n){return n instanceof Tt&&ym(n)}function oI(n){return Tp(n)||xp(n)||function(t){if(t instanceof Tt&&gp(t)){for(const r of t.getFilters())if(!Tp(r)&&!xp(r))return!1;return!0}return!1}(n)}function Ap(n){if(Ce(n instanceof ot||n instanceof Tt),n instanceof ot)return n;if(n.filters.length===1)return Ap(n.filters[0]);const e=n.filters.map(r=>Ap(r));let t=Tt.create(e,n.op);return t=$d(t),oI(t)?t:(Ce(t instanceof Tt),Ce($a(t)),Ce(t.filters.length>1),t.filters.reduce((r,s)=>Rm(r,s)))}function Rm(n,e){let t;return Ce(n instanceof ot||n instanceof Tt),Ce(e instanceof ot||e instanceof Tt),t=n instanceof ot?e instanceof ot?function(s,i){return Tt.create([s,i],"and")}(n,e):Jy(n,e):e instanceof ot?Jy(e,n):function(s,i){if(Ce(s.filters.length>0&&i.filters.length>0),$a(s)&&$a(i))return yw(s,i.getFilters());const o=gp(s)?s:i,a=gp(s)?i:s,l=o.filters.map(c=>Rm(c,a));return Tt.create(l,"or")}(n,e),$d(t)}function Jy(n,e){if($a(e))return yw(e,n.getFilters());{const t=e.filters.map(r=>Rm(n,r));return Tt.create(t,"or")}}function $d(n){if(Ce(n instanceof ot||n instanceof Tt),n instanceof ot)return n;const e=n.getFilters();if(e.length===1)return $d(e[0]);if(gw(n))return n;const t=e.map(s=>$d(s)),r=[];return t.forEach(s=>{s instanceof ot?r.push(s):s instanceof Tt&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Tt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(){this.un=new Cm}addToCollectionParentIndex(e,t){return this.un.add(t),G.resolve()}getCollectionParents(e,t){return G.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return G.resolve()}deleteFieldIndex(e,t){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,t){return G.resolve()}getDocumentsMatchingTarget(e,t){return G.resolve(null)}getIndexType(e,t){return G.resolve(0)}getFieldIndexes(e,t){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,t){return G.resolve(pr.min())}getMinOffsetFromCollectionGroup(e,t){return G.resolve(pr.min())}updateCollectionGroup(e,t,r){return G.resolve()}updateIndexEntries(e,t){return G.resolve()}}class Cm{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new St(it.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new St(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=new Uint8Array(0);class zC{constructor(e,t){this.databaseId=t,this.cn=new Cm,this.ln=new Fs(r=>Po(r),(r,s)=>Ju(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:jn(s)};return Yy(e).put(i)}return G.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Xb(t),""],!1,!0);return Yy(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Qr(o.parent))}return r})}addFieldIndex(e,t){const r=jl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=da(e);return i.next(a=>{o.put(zy(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=jl(e),s=da(e),i=ca(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=jl(e),r=ca(e),s=da(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return G.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Qy(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=ca(e);let s=!0;const i=new Map;return G.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ye();const a=[];return G.forEach(i,(l,c)=>{de("IndexedDbIndexManager",`Using index ${function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(l)} to execute ${Po(t)}`);const d=function(M,z){const fe=hp(z);if(fe===void 0)return null;for(const me of Od(M,fe.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(c,l),f=function(M,z){const fe=new Map;for(const me of co(z))for(const x of Od(M,me.fieldPath))switch(x.op){case"==":case"in":fe.set(me.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return fe.set(me.fieldPath.canonicalString(),x.value),Array.from(fe.values())}return null}(c,l),g=function(M,z){const fe=[];let me=!0;for(const x of co(z)){const I=x.kind===0?Ry(M,x.fieldPath,M.startAt):Cy(M,x.fieldPath,M.startAt);fe.push(I.value),me&&(me=I.inclusive)}return new ki(fe,me)}(c,l),y=function(M,z){const fe=[];let me=!0;for(const x of co(z)){const I=x.kind===0?Cy(M,x.fieldPath,M.endAt):Ry(M,x.fieldPath,M.endAt);fe.push(I.value),me&&(me=I.inclusive)}return new ki(fe,me)}(c,l),T=this.In(l,c,g),A=this.In(l,c,y),P=this.Tn(l,c,f),U=this.En(l.indexId,d,T,g.inclusive,A,y.inclusive,P);return G.forEach(U,q=>r.G(q,t.limit).next(M=>{M.forEach(z=>{const fe=Ae.fromSegments(z.documentKey);o.has(fe)||(o=o.add(fe),a.push(fe))})}))}).next(()=>a)}return G.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=BC(Tt.create(e.filters,"and")).map(r=>yp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),c=l/(t!=null?t.length:1),d=[];for(let f=0;f<l;++f){const g=t?this.dn(t[f/c]):Kc,y=this.An(e,g,r[f%c],s),T=this.Rn(e,g,i[f%c],o),A=a.map(P=>this.An(e,g,P,!0));d.push(...this.createRange(y,T,A))}return d}An(e,t,r,s){const i=new vo(e,Ae.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new vo(e,Ae.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new Qy(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return G.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new St(zt.comparator),d=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:c=c.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new Ul;for(const s of co(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);go.vt.It(i,o)}return r.zt()}dn(e){const t=new Ul;return go.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Ul;return go.vt.It(So(this.databaseId,t),r.Yt(function(i){const o=co(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new Ul);let i=0;for(const o of co(e)){const a=r[i++];for(const l of s)if(this.fn(t,o.fieldPath)&&Ru(a))s=this.gn(s,o,a);else{const c=l.Yt(o.kind);go.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Ul;l.seed(a.zt()),go.vt.It(o,l.Yt(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof ot&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=jl(e),s=da(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return G.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(d,f){const g=f?new La(f.sequenceNumber,new pr(Do(f.readTime),new Ae(Qr(f.documentKey)),f.largestBatchId)):La.empty(),y=d.fields.map(([T,A])=>new Eo(zt.fromServerFormat(T),A));return new Ma(d.indexId,d.collectionGroup,y,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ze(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=jl(e),i=da(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>G.forEach(a,l=>i.put(zy(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return G.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?G.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),G.forEach(a,l=>this.wn(e,s,l).next(c=>{const d=this.Sn(i,l);return c.isEqual(d)?G.resolve():this.bn(e,i,l,c,d)}))))})}Dn(e,t,r,s){return ca(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return ca(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=ca(e);let i=new St(si);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new vo(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new St(si);const s=this.Vn(t,e);if(s==null)return r;const i=hp(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Ru(o))for(const a of o.arrayValue.values||[])r=r.add(new vo(t.indexId,e.key,this.dn(a),s))}else r=r.add(new vo(t.indexId,e.key,Kc,s));return r}bn(e,t,r,s,i){de("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,c,d,f,g){const y=l.getIterator(),T=c.getIterator();let A=ua(y),P=ua(T);for(;A||P;){let U=!1,q=!1;if(A&&P){const M=d(A,P);M<0?q=!0:M>0&&(U=!0)}else A!=null?q=!0:U=!0;U?(f(P),P=ua(T)):q?(g(A),A=ua(y)):(A=ua(y),P=ua(T))}}(s,i,si,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),G.waitFor(o)}yn(e){let t=1;return da(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>si(o,a)).filter((o,a,l)=>!a||si(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=si(o,e),l=si(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Kc,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Kc,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,t){return si(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Xy)}getMinOffset(e,t){return G.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||Re())).next(Xy)}}function Yy(n){return yn(n,"collectionParents")}function ca(n){return yn(n,"indexEntries")}function jl(n){return yn(n,"indexConfiguration")}function da(n){return yn(n,"indexState")}function Xy(n){Ce(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;mm(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new pr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ln{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ln(e,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(d,f,g)=>(a++,g.delete()));i.push(l.next(()=>{Ce(a===1)}));const c=[];for(const d of t.mutations){const f=iw(e,d.key.path,t.batchId);i.push(s.delete(f)),c.push(d.key)}return G.waitFor(i).next(()=>c)}function Ud(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(41943040,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);class Th{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){Ce(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Th(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ii(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=ya(e),o=ii(e);return o.add({}).next(a=>{Ce(typeof a=="number");const l=new Em(a,t,r,s),c=function(y,T,A){const P=A.baseMutations.map(q=>Du(y.ct,q)),U=A.mutations.map(q=>Du(y.ct,q));return{userId:T,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:P,mutations:U}}(this.serializer,this.userId,l),d=[];let f=new St((g,y)=>ze(g.canonicalString(),y.canonicalString()));for(const g of s){const y=iw(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(c)),d.push(i.put(y,DR))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),G.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return ii(e).get(t).next(r=>r?(Ce(r.userId===this.userId),mo(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?G.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ii(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(Ce(a.batchId>=r),i=mo(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ii(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ii(e).U("userMutationsIndex",t).next(r=>r.map(s=>mo(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=od(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return ya(e).J({range:s},(o,a,l)=>{const[c,d,f]=o,g=Qr(d);if(c===this.userId&&t.path.isEqual(g))return ii(e).get(f).next(y=>{if(!y)throw Re();Ce(y.userId===this.userId),i.push(mo(this.serializer,y))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new St(ze);const s=[];return t.forEach(i=>{const o=od(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=ya(e).J({range:a},(c,d,f)=>{const[g,y,T]=c,A=Qr(y);g===this.userId&&i.path.isEqual(A)?r=r.add(T):f.done()});s.push(l)}),G.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=od(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new St(ze);return ya(e).J({range:o},(l,c,d)=>{const[f,g,y]=l,T=Qr(g);f===this.userId&&r.isPrefixOf(T)?T.length===s&&(a=a.add(y)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(ii(e).get(i).next(o=>{if(o===null)throw Re();Ce(o.userId===this.userId),r.push(mo(this.serializer,o))}))}),G.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return aI(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),G.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return G.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ya(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Qr(i[1]);s.push(l)}else a.done()}).next(()=>{Ce(s.length===0)})})}containsKey(e,t){return lI(e,this.userId,t)}Nn(e){return uI(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function lI(n,e,t){const r=od(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ya(n).J({range:i,H:!0},(a,l,c)=>{const[d,f,g]=a;d===e&&f===s&&(o=!0),c.done()}).next(()=>o)}function ii(n){return yn(n,"mutations")}function ya(n){return yn(n,"documentMutations")}function uI(n){return yn(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new No(0)}static kn(){return new No(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new No(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>Me.fromTimestamp(new Qt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ha(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Ce(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return ha(e).J((o,a)=>{const l=Xl(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>G.waitFor(i)).next(()=>s)}forEachTarget(e,t){return ha(e).J((r,s)=>{const i=Xl(s);t(i)})}qn(e){return e_(e).get("targetGlobalKey").next(t=>(Ce(t!==null),t))}Qn(e,t){return e_(e).put("targetGlobalKey",t)}Kn(e,t){return ha(e).put(sI(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Po(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ha(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const c=Xl(a);Ju(t,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=hi(e);return t.forEach(o=>{const a=jn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),G.waitFor(s)}removeMatchingKeys(e,t,r){const s=hi(e);return G.forEach(t,i=>{const o=jn(i.path);return G.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=hi(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=hi(e);let i=Ye();return s.J({range:r,H:!0},(o,a,l)=>{const c=Qr(o[1]),d=new Ae(c);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=jn(t.path),s=IDBKeyRange.bound([r],[Xb(r)],!1,!0);let i=0;return hi(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return ha(e).get(t).next(r=>r?Xl(r):null)}}function ha(n){return yn(n,"targets")}function e_(n){return yn(n,"targetGlobal")}function hi(n){return yn(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_([n,e],[t,r]){const s=ze(n,t);return s===0?ze(e,r):s}class GC{constructor(e){this.Un=e,this.buffer=new St(t_),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();t_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cI{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){de("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){$i(t)?de("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Fi(t)}await this.Hn(3e5)})}}class HC{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return G.resolve(or.oe);const r=new GC(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),G.resolve(Zy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Zy):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),ma()<=st.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),G.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function dI(n,e){return new HC(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,t){this.db=e,this.garbageCollector=dI(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Gc(e,r)}removeReference(e,t,r){return Gc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Gc(e,t)}nr(e,t){return function(s,i){let o=!1;return uI(s).Y(a=>lI(s,a,i).next(l=>(l&&(o=!0),G.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Me.min()),hi(e).delete(function(f){return[0,jn(f.path)]}(o))))});s.push(l)}}).next(()=>G.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Gc(e,t)}tr(e,t){const r=hi(e);let s,i=or.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==or.oe&&t(new Ae(Qr(s)),i),i=c,s=l):i=or.oe}).next(()=>{i!==or.oe&&t(new Ae(Qr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Gc(n,e){return hi(n).put(function(r,s){return{targetId:0,path:jn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(){this.changes=new Fs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$t.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?G.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ao(e).put(r)}removeEntry(e,t,r){return ao(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Fd(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=$t.newInvalidDocument(t);return ao(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Bl(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:$t.newInvalidDocument(t)};return ao(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Bl(t))},(s,i)=>{r={document:this.ir(t,i),size:Ud(i)}}).next(()=>r)}getEntries(e,t){let r=lr();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=lr(),s=new Ot(Ae.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Ud(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return G.resolve();let s=new St(s_);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Bl(s.first()),Bl(s.last())),o=s.getIterator();let a=o.getNext();return ao(e).J({index:"documentKeyIndex",range:i},(l,c,d)=>{const f=Ae.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&s_(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Bl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Fd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ao(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=lr();for(const f of c){const g=this.ir(Ae.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Xu(t,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=lr();const o=r_(t,r),a=r_(t,pr.max());return ao(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const f=this.ir(Ae.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new JC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return n_(e).get("remoteDocumentGlobalKey").next(t=>(Ce(!!t),t))}rr(e,t){return n_(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=OC(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Me.min())))return r}return $t.newInvalidDocument(e)}}function fI(n){return new QC(n)}class JC extends hI{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Fs(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new St((i,o)=>ze(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=By(this.cr.serializer,o);s=s.add(i.path.popLast());const c=Ud(l);r+=c-a.size,t.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=By(this.cr.serializer,o.convertToNoDocument(Me.min()));t.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),G.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function n_(n){return yn(n,"remoteDocumentGlobal")}function ao(n){return yn(n,"remoteDocumentsV14")}function Bl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function r_(n,e){const t=e.documentKey.path.toArray();return[n,Fd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function s_(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=ze(t[i],r[i]),s)return s;return s=ze(t.length,r.length),s||(s=ze(t[t.length-2],r[r.length-2]),s||ze(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&fu(r.mutation,s,ar.empty(),Qt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ye()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ye()){const s=Jr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Jl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Jr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ye()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=lr();const o=hu(),a=function(){return hu()}();return t.forEach((l,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof $s)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),fu(d.mutation,c,d.mutation.getFieldMask(),Qt.now())):o.set(c.key,ar.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var f;return a.set(c,new YC(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=hu();let s=new Ot((o,a)=>o-a),i=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let d=r.get(l)||ar.empty();d=a.applyToLocalView(c,d),r.set(l,d);const f=(s.get(a.batchId)||Ye()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,f=Cw();d.forEach(g=>{if(!i.has(g)){const y=Lw(t.get(g),r.get(g));y!==null&&f.set(g,y),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return G.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return Ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_m(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):G.resolve(Jr());let a=-1,l=i;return o.next(c=>G.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?G.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ye())).next(d=>({batchId:a,changes:Rw(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ae(t)).next(r=>{let s=Jl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Jl();return this.indexManager.getCollectionParents(e,i).next(a=>G.forEach(a,l=>{const c=function(f,g){return new Ls(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,$t.newInvalidDocument(d)))});let a=Jl();return o.forEach((l,c)=>{const d=i.get(l);d!==void 0&&fu(d.mutation,c,ar.empty(),Qt.now()),Xu(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return G.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:an(s.createTime)}}(t)),G.resolve()}getNamedQuery(e,t){return G.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:Pm(s.bundledQuery),readTime:an(s.readTime)}}(t)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(){this.overlays=new Ot(Ae.comparator),this.Ir=new Map}getOverlay(e,t){return G.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Jr();return G.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),G.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),G.resolve()}getOverlaysForCollection(e,t,r){const s=Jr(),i=t.length+1,o=new Ae(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return G.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Ot((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=Jr(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Jr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return G.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new xm(t,r));let i=this.Ir.get(t);i===void 0&&(i=Ye(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(){this.sessionToken=en.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(){this.Tr=new St(bn.Er),this.dr=new St(bn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new bn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new bn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Ae(new it([])),r=new bn(t,e),s=new bn(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Ae(new it([])),r=new bn(t,e),s=new bn(t,e+1);let i=Ye();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new bn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class bn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Ae.comparator(e.key,t.key)||ze(e.wr,t.wr)}static Ar(e,t){return ze(e.wr,t.wr)||Ae.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new St(bn.Er)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Em(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new bn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return G.resolve(o)}lookupMutationBatch(e,t){return G.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return G.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new bn(t,0),s=new bn(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),G.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new St(ze);return t.forEach(s=>{const i=new bn(s,0),o=new bn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),G.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Ae.isDocumentKey(i)||(i=i.child(""));const o=new bn(new Ae(i),0);let a=new St(ze);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.wr)),!0)},o),G.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ce(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return G.forEach(t.mutations,s=>{const i=new bn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new bn(t,0),s=this.br.firstAfterOrEqual(r);return G.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.Mr=e,this.docs=function(){return new Ot(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return G.resolve(r?r.document.mutableCopy():$t.newInvalidDocument(t))}getEntries(e,t){let r=lr();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():$t.newInvalidDocument(s))}),G.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=lr();const o=t.path,a=new Ae(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||mm(ew(d),r)<=0||(s.has(d.key)||Xu(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return G.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Re()}Or(e,t){return G.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new rk(this)}getSize(e){return G.resolve(this.size)}}class rk extends hI{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),G.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.persistence=e,this.Nr=new Fs(t=>Po(t),Ju),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.Lr=0,this.Br=new km,this.targetCount=0,this.kr=No.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),G.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new No(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,G.resolve()}updateTargetData(e,t){return this.Kn(t),G.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),G.waitFor(i).next(()=>s)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return G.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),G.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),G.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),G.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return G.resolve(r)}containsKey(e,t){return G.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,t){this.qr={},this.overlays={},this.Qr=new or(0),this.Kr=!1,this.Kr=!0,this.$r=new ek,this.referenceDelegate=e(this),this.Ur=new sk(this),this.indexManager=new qC,this.remoteDocumentCache=function(s){return new nk(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new rI(t),this.Gr=new XC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new tk(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){de("MemoryPersistence","Starting transaction:",e);const s=new ik(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return G.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class ik extends nw{constructor(e){super(),this.currentSequenceNumber=e}}class xh{constructor(e){this.persistence=e,this.Jr=new km,this.Yr=null}static Zr(e){return new xh(e)}get Xr(){if(this.Yr)return this.Yr;throw Re()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),G.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),G.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.Xr,r=>{const s=Ae.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,Me.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return G.or([()=>G.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class jd{constructor(e,t){this.persistence=e,this.ti=new Fs(r=>jn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=dI(this,t)}static Zr(e,t){return new jd(e,t)}zr(){}jr(e){return G.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return G.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?G.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,Me.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),G.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),G.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),G.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),G.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ld(e.data.value)),t}nr(e,t,r){return G.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ti.get(t);return G.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.serializer=e}O(e,t,r,s){const i=new gh("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",yy,{unique:!0}),l.createObjectStore("documentMutations")}(e),i_(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=G.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),i_(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Me.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",yy,{unique:!0});const f=c.store("mutations"),g=d.map(y=>f.put(y));return G.waitFor(g)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:zR});c.createIndex("collectionPathOverlayIndex",KR,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",GR,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:NR});c.createIndex("documentKeyIndex",VR),c.createIndex("collectionGroupIndex",OR)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:UR}).createIndex("sequenceNumberIndex",jR,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:BR}).createIndex("documentKeyIndex",qR,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Ud(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>G.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>G.forEach(a,l=>{Ce(l.userId===i.userId);const c=mo(this.serializer,l);return aI(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new it(o),c=function(f){return[0,jn(f)]}(l);i.push(t.get(c).next(d=>d?G.resolve():(f=>t.put({targetId:0,path:jn(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>G.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:$R});const r=t.store("collectionParents"),s=new Cm,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:jn(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new it(o);return i(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Qr(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Xl(s),o=sI(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),l=function(f){return f.document?new Ae(it.fromString(f.document.name).popFirst(5)):f.noDocument?Ae.fromSegments(f.noDocument.path):f.unknownDocument?Ae.fromSegments(f.unknownDocument.path):Re()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>G.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=fI(this.serializer),i=new Dm(xh.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:Ye();mo(this.serializer,l).keys().forEach(f=>d=d.add(f)),a.set(l.userId,d)}),G.forEach(a,(l,c)=>{const d=new wn(c),f=Eh.lt(this.serializer,d),g=i.getIndexManager(d),y=Th.lt(d,this.serializer,g,i.referenceDelegate);return new pI(s,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new fp(t,or.oe),l).next()})})}}function i_(n){n.createObjectStore("targetDocuments",{keyPath:LR}).createIndex("documentTargetsIndex",FR,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",MR,{unique:!0}),n.createObjectStore("targetGlobal")}const kf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Nm{constructor(e,t,r,s,i,o,a,l,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!Nm.D())throw new he(H.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new WC(this,s),this.Ai=t+"main",this.serializer=new rI(l),this.Ri=new Zr(this.Ai,this.hi,new ok(this.serializer)),this.$r=new LC,this.Ur=new KC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=fI(this.serializer),this.Gr=new MC,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&sn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new he(H.FAILED_PRECONDITION,kf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new or(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Hc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if($i(e))return de("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return de("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ql(e).get("owner").next(t=>G.resolve(this.vi(t)))}Ci(e){return Hc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=yn(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return G.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?G.resolve(!0):ql(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new he(H.FAILED_PRECONDITION,kf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Hc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&de("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new fp(e,or.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Hc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Th.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new zC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Eh.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){de("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===17?QR:l===16?WR:l===15?vm:l===14?lw:l===13?aw:l===12?HR:l===11?ow:void Re()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new fp(a,this.Qr?this.Qr.next():or.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw sn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new he(H.FAILED_PRECONDITION,tw);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return ql(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new he(H.FAILED_PRECONDITION,kf)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ql(e).put("owner",t)}static D(){return Zr.D()}bi(e){const t=ql(e);return t.get("owner").next(r=>this.vi(r)?(de("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):G.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(sn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;Mb()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return de("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return sn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){sn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ql(n){return yn(n,"owner")}function Hc(n){return yn(n,"clientMetadata")}function Vm(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Ye(),s=Ye();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Om(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Mb()?8:rw(vn())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ak;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(ma()<=st.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",ga(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),G.resolve()):(ma()<=st.DEBUG&&de("QueryEngine","Query:",ga(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ma()<=st.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",ga(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bn(t))):G.resolve())}Yi(e,t){if(ky(t))return G.resolve(null);let r=Bn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Md(t,null,"F"),r=Bn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ye(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,o,l.readTime)?this.Yi(e,Md(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,s){return ky(t)||s.isEqual(Me.min())?G.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?G.resolve(null):(ma()<=st.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ga(t)),this.rs(e,o,t,Zb(s,-1)).next(a=>a))})}ts(e,t){let r=new St(Sw(e));return t.forEach((s,i)=>{Xu(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return ma()<=st.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",ga(t)),this.Ji.getDocumentsMatchingQuery(e,t,pr.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Ot(ze),this._s=new Fs(i=>Po(i),Ju),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function gI(n,e,t,r){return new lk(n,e,t,r)}async function vI(n,e){const t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ye();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function uk(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const f=c.batch,g=f.keys();let y=G.resolve();return g.forEach(T=>{y=y.next(()=>d.getEntry(l,T)).next(A=>{const P=c.docVersions.get(T);Ce(P!==null),A.version.compareTo(P)<0&&(f.applyToRemoteDocument(A,c),A.isValidDocument()&&(A.setReadTime(c.commitVersion),d.addEntry(A)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ye();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function yI(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function ck(n,e){const t=Ee(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let y=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(en.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),s=s.insert(f,y),function(A,P,U){return A.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(g,y,d)&&a.push(t.Ur.updateTargetData(i,y))});let l=lr(),c=Ye();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(_I(i,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(Me.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return G.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.os=s,i))}function _I(n,e,t){let r=Ye(),s=Ye();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=lr();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):de("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function dk(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function qa(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,G.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new ws(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function za(n,e,t){const r=Ee(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!$i(o))throw o;de("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Bd(n,e,t){const r=Ee(n);let s=Me.min(),i=Ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const f=Ee(l),g=f._s.get(d);return g!==void 0?G.resolve(f.os.get(g)):f.Ur.getTargetData(c,d)}(r,o,Bn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:Me.min(),t?i:Ye())).next(a=>(II(r,Aw(e),a),{documents:a,Ts:i})))}function bI(n,e){const t=Ee(n),r=Ee(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function wI(n,e){const t=Ee(n),r=t.us.get(e)||Me.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,Zb(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(II(t,e,s),s))}function II(n,e,t){let r=n.us.get(e)||Me.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function hk(n,e,t,r){const s=Ee(n);let i=Ye(),o=lr();for(const c of t){const d=e.Es(c.metadata.name);c.document&&(i=i.add(d));const f=e.ds(c);f.setReadTime(e.As(c.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),l=await qa(s,function(d){return Bn(sl(it.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>_I(c,a,o).next(d=>(a.apply(c),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(c,l.targetId).next(()=>s.Ur.addMatchingKeys(c,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,d.Ps,d.Is)).next(()=>d.Ps)))}async function fk(n,e,t=Ye()){const r=await qa(n,Bn(Pm(e.bundledQuery))),s=Ee(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=an(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(en.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function o_(n,e){return`firestore_clients_${n}_${e}`}function a_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Df(n,e){return`firestore_targets_${n}_${e}`}class qd{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new he(s.error.code,s.error.message))),o?new qd(e,t,s.state,i):(sn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new he(r.error.code,r.error.message))),i?new pu(e,r.state,s):(sn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=bm();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=sw(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new zd(e,i):(sn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Mm{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Mm(t.clientId,t.onlineState):(sn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Sp{constructor(){this.activeTargetIds=bm()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Nf{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ot(ze),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=o_(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Sp),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(o_(this.persistenceKey,r));if(s){const i=zd.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Df(this.persistenceKey,e));if(s){const i=pu.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Df(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return de("SharedClientState","READ",e,t),t}setItem(e,t){de("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){de("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(de("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void sn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=or.oe;if(i!=null)try{const a=JSON.parse(i);Ce(typeof a=="number"),o=a}catch(a){sn("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==or.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new qd(this.currentUser,e,t,r),i=a_(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=a_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=Df(this.persistenceKey,e),i=new pu(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return zd.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return qd.Rs(new wn(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return pu.Rs(s,t)}Ls(e){return Mm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);de("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=bm();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class EI{constructor(){this.so=new Sp,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Sp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){de("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){de("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wc=null;function Vf(){return Wc===null?Wc=function(){return 268435456+Math.round(2147483648*Math.random())}():Wc++,"0x"+Wc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On="WebChannelConnection";class vk extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Vf(),l=this.xo(t,r.toUriEncodedString());de("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,l,c,s).then(d=>(de("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw xr("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=mk[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Vf();return new Promise((o,a)=>{const l=new zb;l.setWithCredentials(!0),l.listenOnce(Kb.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case id.NO_ERROR:const d=l.getResponseJson();de(On,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case id.TIMEOUT:de(On,`RPC '${e}' ${i} timed out`),a(new he(H.DEADLINE_EXCEEDED,"Request time out"));break;case id.HTTP_ERROR:const f=l.getStatus();if(de(On,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g==null?void 0:g.error;if(y&&y.status&&y.message){const T=function(P){const U=P.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(U)>=0?U:H.UNKNOWN}(y.status);a(new he(T,y.message))}else a(new he(H.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new he(H.UNAVAILABLE,"Connection failed."));break;default:Re()}}finally{de(On,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);de(On,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=Vf(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Wb(),a=Hb(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");de(On,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let g=!1,y=!1;const T=new gk({Io:P=>{y?de(On,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(de(On,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),de(On,`RPC '${e}' stream ${s} sending:`,P),f.send(P))},To:()=>f.close()}),A=(P,U,q)=>{P.listen(U,M=>{try{q(M)}catch(z){setTimeout(()=>{throw z},0)}})};return A(f,Ql.EventType.OPEN,()=>{y||(de(On,`RPC '${e}' stream ${s} transport opened.`),T.yo())}),A(f,Ql.EventType.CLOSE,()=>{y||(y=!0,de(On,`RPC '${e}' stream ${s} transport closed`),T.So())}),A(f,Ql.EventType.ERROR,P=>{y||(y=!0,xr(On,`RPC '${e}' stream ${s} transport errored:`,P),T.So(new he(H.UNAVAILABLE,"The operation could not be completed")))}),A(f,Ql.EventType.MESSAGE,P=>{var U;if(!y){const q=P.data[0];Ce(!!q);const M=q,z=M.error||((U=M[0])===null||U===void 0?void 0:U.error);if(z){de(On,`RPC '${e}' stream ${s} received error:`,z);const fe=z.status;let me=function(w){const C=fn[w];if(C!==void 0)return jw(C)}(fe),x=z.message;me===void 0&&(me=H.INTERNAL,x="Unknown error status: "+fe+" with message "+z.message),y=!0,T.So(new he(me,x)),f.close()}else de(On,`RPC '${e}' stream ${s} received:`,q),T.bo(q)}}),A(a,Gb.STAT_EVENT,P=>{P.stat===dp.PROXY?de(On,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===dp.NOPROXY&&de(On,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(){return typeof window<"u"?window:null}function hd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){return new xC(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&de("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lm(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===H.RESOURCE_EXHAUSTED?(sn(t.toString()),sn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new he(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return de("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(de("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yk extends xI{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=PC(this.serializer,e),r=function(i){if(!("targetChange"in i))return Me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Me.min():o.readTime?an(o.readTime):Me.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Ip(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Vd(l)?{documents:Yw(i,l)}:{query:Ih(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Kw(i,o.resumeToken);const c=bp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Me.min())>0){a.readTime=Ba(i,o.snapshotVersion.toTimestamp());const c=bp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=CC(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Ip(this.serializer),t.removeTarget=e,this.a_(t)}}class _k extends xI{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ce(!!e.streamToken),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ce(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=RC(e.writeResults,e.commitTime),r=an(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Ip(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Du(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new he(H.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,wp(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new he(H.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,wp(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new he(H.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class wk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(sn(t),this.D_=!1):de("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{ji(this)&&(de("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ee(l);c.L_.add(4),await al(c),c.q_.set("Unknown"),c.L_.delete(4),await rc(c)}(this))})}),this.q_=new wk(r,s)}}async function rc(n){if(ji(n))for(const e of n.B_)await e(!0)}async function al(n){for(const e of n.B_)await e(!1)}function Ah(n,e){const t=Ee(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Um(t)?$m(t):ul(t).r_()&&Fm(t,e))}function Ka(n,e){const t=Ee(n),r=ul(t);t.N_.delete(e),r.r_()&&AI(t,e),t.N_.size===0&&(r.r_()?r.o_():ji(t)&&t.q_.set("Unknown"))}function Fm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ul(n).A_(e)}function AI(n,e){n.Q_.xe(e),ul(n).R_(e)}function $m(n){n.Q_=new wC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ul(n).start(),n.q_.v_()}function Um(n){return ji(n)&&!ul(n).n_()&&n.N_.size>0}function ji(n){return Ee(n).L_.size===0}function SI(n){n.Q_=void 0}async function Ek(n){n.q_.set("Online")}async function Tk(n){n.N_.forEach((e,t)=>{Fm(n,e)})}async function xk(n,e){SI(n),Um(n)?(n.q_.M_(e),$m(n)):n.q_.set("Unknown")}async function Ak(n,e,t){if(n.q_.set("Online"),e instanceof zw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){de("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kd(n,r)}else if(e instanceof dd?n.Q_.Ke(e):e instanceof qw?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Me.min()))try{const r=await yI(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(c);d&&i.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(en.EMPTY_BYTE_STRING,d.snapshotVersion)),AI(i,l);const f=new ws(d.target,l,c,d.sequenceNumber);Fm(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){de("RemoteStore","Failed to raise snapshot:",r),await Kd(n,r)}}async function Kd(n,e,t){if(!$i(e))throw e;n.L_.add(1),await al(n),n.q_.set("Offline"),t||(t=()=>yI(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{de("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await rc(n)})}function PI(n,e){return e().catch(t=>Kd(n,t,e))}async function ll(n){const e=Ee(n),t=Di(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Sk(e);)try{const s=await dk(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,Pk(e,s)}catch(s){await Kd(e,s)}RI(e)&&CI(e)}function Sk(n){return ji(n)&&n.O_.length<10}function Pk(n,e){n.O_.push(e);const t=Di(n);t.r_()&&t.V_&&t.m_(e.mutations)}function RI(n){return ji(n)&&!Di(n).n_()&&n.O_.length>0}function CI(n){Di(n).start()}async function Rk(n){Di(n).p_()}async function Ck(n){const e=Di(n);for(const t of n.O_)e.m_(t.mutations)}async function kk(n,e,t){const r=n.O_.shift(),s=Tm.from(r,e,t);await PI(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await ll(n)}async function Dk(n,e){e&&Di(n).V_&&await async function(r,s){if(function(o){return Uw(o)&&o!==H.ABORTED}(s.code)){const i=r.O_.shift();Di(r).s_(),await PI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ll(r)}}(n,e),RI(n)&&CI(n)}async function u_(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),de("RemoteStore","RemoteStore received new credentials");const r=ji(t);t.L_.add(3),await al(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await rc(t)}async function Pp(n,e){const t=Ee(n);e?(t.L_.delete(2),await rc(t)):e||(t.L_.add(2),await al(t),t.q_.set("Unknown"))}function ul(n){return n.K_||(n.K_=function(t,r,s){const i=Ee(t);return i.w_(),new yk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:Ek.bind(null,n),Ro:Tk.bind(null,n),mo:xk.bind(null,n),d_:Ak.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Um(n)?$m(n):n.q_.set("Unknown")):(await n.K_.stop(),SI(n))})),n.K_}function Di(n){return n.U_||(n.U_=function(t,r,s){const i=Ee(t);return i.w_(),new _k(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Rk.bind(null,n),mo:Dk.bind(null,n),f_:Ck.bind(null,n),g_:kk.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await ll(n)):(await n.U_.stop(),n.O_.length>0&&(de("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new In,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new jm(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cl(n,e){if(sn("AsyncQueue",`${e}: ${n}`),$i(n))return new he(H.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ae.comparator(t.key,r.key):(t,r)=>Ae.comparator(t.key,r.key),this.keyedMap=Jl(),this.sortedSet=new Ot(this.comparator)}static emptySet(e){return new Aa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Aa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Aa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(){this.W_=new Ot(Ae.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Re():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ga{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Ga(e,t,Aa.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Vk{constructor(){this.queries=d_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=Ee(t),i=s.queries;s.queries=d_(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new he(H.ABORTED,"Firestore shutting down"))}}function d_(){return new Fs(n=>xw(n),Yu)}async function Bm(n,e){const t=Ee(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new Nk,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=cl(o,`Initialization of query '${ga(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&zm(t)}async function qm(n,e){const t=Ee(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Ok(n,e){const t=Ee(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&zm(t)}function Mk(n,e,t){const r=Ee(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function zm(n){n.Y_.forEach(e=>{e.next()})}var Rp,h_;(h_=Rp||(Rp={})).ea="default",h_.Cache="cache";class Km{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ga(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ga.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Rp.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e){this.serializer=e}Es(e){return es(this.serializer,e)}ds(e){return e.metadata.exists?Jw(this.serializer,e.document,!1):$t.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return an(e)}}class Fk{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kI(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=it.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new f_(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||Ye()).add(i);t.set(o,a)}}return t}async complete(){const e=await hk(this.localStore,new f_(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await fk(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function kI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e){this.key=e}}class NI{constructor(e){this.key=e}}class VI{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ye(),this.mutatedKeys=Ye(),this.Aa=Sw(e),this.Ra=new Aa(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new c_,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),y=Xu(this.query,f)?f:null,T=!!g&&this.mutatedKeys.has(g.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let P=!1;g&&y?g.data.isEqual(y.data)?T!==A&&(r.track({type:3,doc:y}),P=!0):this.ga(g,y)||(r.track({type:2,doc:y}),P=!0,(l&&this.Aa(y,l)>0||c&&this.Aa(y,c)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),P=!0):g&&!y&&(r.track({type:1,doc:g}),P=!0,(l||c)&&(a=!0)),P&&(y?(o=o.add(y),i=A?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(y,T){const A=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re()}};return A(y)-A(T)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new Ga(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new c_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ye(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new NI(r))}),this.da.forEach(r=>{e.has(r)||t.push(new DI(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ye();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ga.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class $k{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Uk{constructor(e){this.key=e,this.va=!1}}class jk{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Fs(a=>xw(a),Yu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ot(Ae.comparator),this.Na=new Map,this.La=new km,this.Ba={},this.ka=new Map,this.qa=No.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Bk(n,e,t=!0){const r=Sh(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await OI(r,e,t,!0),s}async function qk(n,e){const t=Sh(n);await OI(t,e,!0,!1)}async function OI(n,e,t,r){const s=await qa(n.localStore,Bn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Gm(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Ah(n.remoteStore,s),a}async function Gm(n,e,t,r,s){n.Ka=(f,g,y)=>async function(A,P,U,q){let M=P.view.ma(U);M.ns&&(M=await Bd(A.localStore,P.query,!1).then(({documents:x})=>P.view.ma(x,M)));const z=q&&q.targetChanges.get(P.targetId),fe=q&&q.targetMismatches.get(P.targetId)!=null,me=P.view.applyChanges(M,A.isPrimaryClient,z,fe);return Cp(A,P.targetId,me.wa),me.snapshot}(n,f,g,y);const i=await Bd(n.localStore,e,!0),o=new VI(e,i.Ts),a=o.ma(i.documents),l=tc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);Cp(n,t,c.wa);const d=new $k(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function zk(n,e,t){const r=Ee(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Yu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await za(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Ka(r.remoteStore,s.targetId),Ha(r,s.targetId)}).catch(Fi)):(Ha(r,s.targetId),await za(r.localStore,s.targetId,!0))}async function Kk(n,e){const t=Ee(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ka(t.remoteStore,r.targetId))}async function Gk(n,e,t){const r=Jm(n);try{const s=await function(o,a){const l=Ee(o),c=Qt.now(),d=a.reduce((y,T)=>y.add(T.key),Ye());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=lr(),A=Ye();return l.cs.getEntries(y,d).next(P=>{T=P,T.forEach((U,q)=>{q.isValidDocument()||(A=A.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,T)).next(P=>{f=P;const U=[];for(const q of a){const M=yC(q,f.get(q.key).overlayedDocument);M!=null&&U.push(new $s(q.key,M,pw(M.value.mapValue),Kt.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,U,a)}).next(P=>{g=P;const U=P.applyToLocalDocumentSet(f,A);return l.documentOverlayCache.saveOverlays(y,P.batchId,U)})}).then(()=>({batchId:g.batchId,changes:Rw(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new Ot(ze)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await Us(r,s.changes),await ll(r.remoteStore)}catch(s){const i=cl(s,"Failed to persist write");t.reject(i)}}async function MI(n,e){const t=Ee(n);try{const r=await ck(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(Ce(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ce(o.va):s.removedDocuments.size>0&&(Ce(o.va),o.va=!1))}),await Us(t,r,e)}catch(r){await Fi(r)}}function p_(n,e,t){const r=Ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let c=!1;l.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(a)&&(c=!0)}),c&&zm(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Hk(n,e,t){const r=Ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Ot(Ae.comparator);o=o.insert(i,$t.newNoDocument(i,Me.min()));const a=Ye().add(i),l=new ec(Me.min(),new Map,new Ot(ze),o,a);await MI(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Qm(r)}else await za(r.localStore,e,!1).then(()=>Ha(r,e,t)).catch(Fi)}async function Wk(n,e){const t=Ee(n),r=e.batch.batchId;try{const s=await uk(t.localStore,e);Wm(t,r,null),Hm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Us(t,s)}catch(s){await Fi(s)}}async function Qk(n,e,t){const r=Ee(n);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Ce(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);Wm(r,e,t),Hm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Us(r,s)}catch(s){await Fi(s)}}async function Jk(n,e){const t=Ee(n);ji(t.remoteStore)||de("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=Ee(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=cl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Hm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Wm(n,e,t){const r=Ee(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ha(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||LI(n,r)})}function LI(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Ka(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Qm(n))}function Cp(n,e,t){for(const r of t)r instanceof DI?(n.La.addReference(r.key,e),Yk(n,r)):r instanceof NI?(de("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||LI(n,r.key)):Re()}function Yk(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(de("SyncEngine","New document in limbo: "+t),n.xa.add(r),Qm(n))}function Qm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Ae(it.fromString(e)),r=n.qa.next();n.Na.set(r,new Uk(t)),n.Oa=n.Oa.insert(t,r),Ah(n.remoteStore,new ws(Bn(sl(t.path)),r,"TargetPurposeLimboResolution",or.oe))}}async function Us(n,e,t){const r=Ee(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=Om.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,c){const d=Ee(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>G.forEach(c,g=>G.forEach(g.$i,y=>d.persistence.referenceDelegate.addReference(f,g.targetId,y)).next(()=>G.forEach(g.Ui,y=>d.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))}catch(f){if(!$i(f))throw f;de("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const g=f.targetId;if(!f.fromCache){const y=d.os.get(g),T=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(T);d.os=d.os.insert(g,A)}}}(r.localStore,i))}async function Xk(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){de("SyncEngine","User change. New user:",e.toKey());const r=await vI(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new he(H.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Us(t,r.hs)}}function Zk(n,e){const t=Ee(n),r=t.Na.get(e);if(r&&r.va)return Ye().add(r.key);{let s=Ye();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function eD(n,e){const t=Ee(n),r=await Bd(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&Cp(t,e.targetId,s.wa),s}async function tD(n,e){const t=Ee(n);return wI(t.localStore,e).then(r=>Us(t,r))}async function nD(n,e,t,r){const s=Ee(n),i=await function(a,l){const c=Ee(a),d=Ee(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,l).next(g=>g?c.localDocuments.getDocuments(f,g):G.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await ll(s.remoteStore):t==="acknowledged"||t==="rejected"?(Wm(s,e,r||null),Hm(s,e),function(a,l){Ee(Ee(a).mutationQueue).On(l)}(s.localStore,e)):Re(),await Us(s,i)):de("SyncEngine","Cannot apply mutation batch with id: "+e)}async function rD(n,e){const t=Ee(n);if(Sh(t),Jm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await m_(t,r.toArray());t.Qa=!0,await Pp(t.remoteStore,!0);for(const i of s)Ah(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Ha(t,o),za(t.localStore,o,!0))),Ka(t.remoteStore,o)}),await s,await m_(t,r),function(o){const a=Ee(o);a.Na.forEach((l,c)=>{Ka(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new Ot(Ae.comparator)}(t),t.Qa=!1,await Pp(t.remoteStore,!1)}}async function m_(n,e,t){const r=Ee(n),s=[],i=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await qa(r.localStore,Bn(l[0]));for(const c of l){const d=r.Fa.get(c),f=await eD(r,d);f.snapshot&&i.push(f.snapshot)}}else{const c=await bI(r.localStore,o);a=await qa(r.localStore,c),await Gm(r,FI(c),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function FI(n){return Iw(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function sD(n){return function(t){return Ee(Ee(t).persistence).Qi()}(Ee(n).localStore)}async function iD(n,e,t,r){const s=Ee(n);if(s.Qa)return void de("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await wI(s.localStore,Aw(i[0])),a=ec.createSynthesizedRemoteEventForCurrentChange(e,t==="current",en.EMPTY_BYTE_STRING);await Us(s,o,a);break}case"rejected":await za(s.localStore,e,!0),Ha(s,e,r);break;default:Re()}}async function oD(n,e,t){const r=Sh(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){de("SyncEngine","Adding an already active target "+s);continue}const i=await bI(r.localStore,s),o=await qa(r.localStore,i);await Gm(r,FI(i),o.targetId,!1,o.resumeToken),Ah(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await za(r.localStore,s,!1).then(()=>{Ka(r.remoteStore,s),Ha(r,s)}).catch(Fi)}}function Sh(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=MI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Hk.bind(null,e),e.Ca.d_=Ok.bind(null,e.eventManager),e.Ca.$a=Mk.bind(null,e.eventManager),e}function Jm(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Wk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Qk.bind(null,e),e}function aD(n,e,t){const r=Ee(n);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(y,T){const A=Ee(y),P=an(T.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",U=>A.Gr.getBundleMetadata(U,T.id)).then(U=>!!U&&U.createTime.compareTo(P)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(kI(l));const c=new Fk(l,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await c.la(d);g&&a._updateProgress(g),d=await o.Ua()}const f=await c.complete();return await Us(i,f.Ia,void 0),await function(y,T){const A=Ee(y);return A.persistence.runTransaction("Save bundle","readwrite",P=>A.Gr.saveBundleMetadata(P,T))}(i.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(l){return xr("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Ni{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return gI(this.persistence,new mI,e.initialUser,this.serializer)}Ga(e){return new Dm(xh.Zr,this.serializer)}Wa(e){return new EI}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ni.provider={build:()=>new Ni};class lD extends Ni{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){Ce(this.persistence.referenceDelegate instanceof jd);const r=this.persistence.referenceDelegate.garbageCollector;return new cI(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new Dm(r=>jd.Zr(r,t),this.serializer)}}class Ym extends Ni{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Jm(this.Ja.syncEngine),await ll(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return gI(this.persistence,new mI,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new cI(r,e.asyncQueue,t)}Ha(e,t){const r=new CR(t,this.persistence);return new RR(e.asyncQueue,r)}Ga(e){const t=Vm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new Nm(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,TI(),hd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new EI}}class $I extends Ym{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Nf&&(this.sharedClientState.syncEngine={no:nD.bind(null,t),ro:iD.bind(null,t),io:oD.bind(null,t),Qi:sD.bind(null,t),eo:tD.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await rD(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=TI();if(!Nf.D(t))throw new he(H.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Vm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Nf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vi{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>p_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xk.bind(null,this.syncEngine),await Pp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Vk}()}createDatastore(e){const t=nc(e.databaseInfo.databaseId),r=function(i){return new vk(i)}(e.databaseInfo);return function(i,o,a,l){return new bk(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new Ik(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>p_(this.syncEngine,t,0),function(){return l_.D()?new l_:new pk}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,d){const f=new jk(s,i,o,a,l,c);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=Ee(s);de("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await al(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Vi.provider={build:()=>new Vi};function g_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):sn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new In,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new Lk(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new he(H.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=Ee(s),a={documents:i.map(f=>ku(o.serializer,f))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,it.emptyPath(),a,i.length),c=new Map;l.forEach(f=>{const g=SC(o.serializer,f);c.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=c.get(f.toString());Ce(!!g),d.push(g)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ol(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=Ae.fromPath(r);this.mutations.push(new Im(s,this.precondition(s)))}),await async function(r,s){const i=Ee(r),o={writes:s.map(a=>Du(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,it.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Re();t=Me.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new he(H.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Me.min())?Kt.exists(!1):Kt.updateTime(t):Kt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Me.min()))throw new he(H.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Kt.updateTime(t)}return Kt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new Lm(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new cD(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!Qu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Uw(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=wn.UNAUTHENTICATED,this.clientId=Yb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{de("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(de("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new In;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=cl(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Of(n,e){n.asyncQueue.verifyOperationInProgress(),de("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await vI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function v_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Xm(n);de("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>u_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>u_(e.remoteStore,s)),n._onlineComponents=e}async function Xm(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){de("FirestoreClient","Using user provided OfflineComponentProvider");try{await Of(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;xr("Error using user provided cache. Falling back to memory cache: "+t),await Of(n,new Ni)}}else de("FirestoreClient","Using default OfflineComponentProvider"),await Of(n,new Ni);return n._offlineComponents}async function Rh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(de("FirestoreClient","Using user provided OnlineComponentProvider"),await v_(n,n._uninitializedComponentsProvider._online)):(de("FirestoreClient","Using default OnlineComponentProvider"),await v_(n,new Vi))),n._onlineComponents}function UI(n){return Xm(n).then(e=>e.persistence)}function dl(n){return Xm(n).then(e=>e.localStore)}function jI(n){return Rh(n).then(e=>e.remoteStore)}function Zm(n){return Rh(n).then(e=>e.syncEngine)}function BI(n){return Rh(n).then(e=>e.datastore)}async function Wa(n){const e=await Rh(n),t=e.eventManager;return t.onListen=Bk.bind(null,e.syncEngine),t.onUnlisten=zk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Kk.bind(null,e.syncEngine),t}function fD(n){return n.asyncQueue.enqueue(async()=>{const e=await UI(n),t=await jI(n);return e.setNetworkEnabled(!0),function(s){const i=Ee(s);return i.L_.delete(0),rc(i)}(t)})}function pD(n){return n.asyncQueue.enqueue(async()=>{const e=await UI(n),t=await jI(n);return e.setNetworkEnabled(!1),async function(s){const i=Ee(s);i.L_.add(0),await al(i),i.q_.set("Offline")}(t)})}function mD(n,e){const t=new In;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,d){const f=Ee(c);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new he(H.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=cl(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await dl(n),e,t)),t.promise}function qI(n,e,t={}){const r=new In;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new Ph({next:g=>{d.Za(),o.enqueueAndForget(()=>qm(i,f));const y=g.docs.has(a);!y&&g.fromCache?c.reject(new he(H.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&l&&l.source==="server"?c.reject(new he(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Km(sl(a.path),d,{includeMetadataChanges:!0,_a:!0});return Bm(i,f)}(await Wa(n),n.asyncQueue,e,t,r)),r.promise}function gD(n,e){const t=new In;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await Bd(s,i,!0),l=new VI(i,a.Ts),c=l.ma(a.documents),d=l.applyChanges(c,!1);o.resolve(d.snapshot)}catch(a){const l=cl(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await dl(n),e,t)),t.promise}function zI(n,e,t={}){const r=new In;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new Ph({next:g=>{d.Za(),o.enqueueAndForget(()=>qm(i,f)),g.fromCache&&l.source==="server"?c.reject(new he(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Km(a,d,{includeMetadataChanges:!0,_a:!0});return Bm(i,f)}(await Wa(n),n.asyncQueue,e,t,r)),r.promise}function vD(n,e,t){const r=new In;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await BI(n);r.resolve(async function(o,a,l){var c;const d=Ee(o),{request:f,ut:g,parent:y}=Xw(d.serializer,Ew(a),l);d.connection.Fo||delete f.parent;const T=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,y,f,1)).filter(P=>!!P.result);Ce(T.length===1);const A=(c=T[0].result)===null||c===void 0?void 0:c.aggregateFields;return Object.keys(A).reduce((P,U)=>(P[g[U]]=A[U],P),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function yD(n,e){const t=new Ph(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){Ee(s).Y_.add(i),i.next()}(await Wa(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){Ee(s).Y_.delete(i)}(await Wa(n),t))}}function _D(n,e,t,r){const s=function(o,a){let l;return l=typeof o=="string"?Bw().encode(o):o,function(d,f){return new uD(d,f)}(function(d,f){if(d instanceof Uint8Array)return g_(d,f);if(d instanceof ArrayBuffer)return g_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,nc(e));n.asyncQueue.enqueueAndForget(async()=>{aD(await Zm(n),s,r)})}function bD(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=Ee(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await dl(n),e))}function wD(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=Ee(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(c=>function(f,g,y,T,A){f=[...f],g=[...g],f.sort(y),g.sort(y);const P=f.length,U=g.length;let q=0,M=0;for(;q<U&&M<P;){const z=y(f[M],g[q]);z<0?A(f[M++]):z>0?T(g[q++]):(q++,M++)}for(;q<U;)T(g[q++]);for(;M<P;)A(f[M++])}(c,s,xR,d=>{a.push(o.addFieldIndex(l,d))},d=>{a.push(o.deleteFieldIndex(l,d))})).next(()=>G.waitFor(a)))}(await dl(n),e))}function ID(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){Ee(r).ss.zi=s}(await dl(n),e))}function ED(n){return n.asyncQueue.enqueue(async()=>function(t){const r=Ee(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await dl(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(n,e,t){if(!t)throw new he(H.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function TD(n,e,t,r){if(e===!0&&r===!0)throw new he(H.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function __(n){if(!Ae.isDocumentKey(n))throw new he(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function b_(n){if(Ae.isDocumentKey(n))throw new he(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ch(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re()}function rt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new he(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ch(n);throw new he(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function GI(n,e){if(e<=0)throw new he(H.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new he(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new he(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new he(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new he(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new he(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sc{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new w_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new w_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new vR;switch(r.type){case"firstParty":return new wR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new he(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=y_.get(t);r&&(de("ComponentProvider","Removing Datastore"),y_.delete(t),r.terminate())}(this),Promise.resolve()}}function xD(n,e,t,r={}){var s;const i=(n=rt(n,sc))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=wn.MOCK_USER;else{a=H1(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new he(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new wn(c)}n._authCredentials=new yR(new Qb(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Rn(this.firestore,e,this._query)}}class ln{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ts(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ln(this.firestore,e,this._key)}}class ts extends Rn{constructor(e,t,r){super(e,t,sl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ln(this.firestore,null,new Ae(e))}withConverter(e){return new ts(this.firestore,e,this._path)}}function Je(n,e,...t){if(n=Ne(n),eg("collection","path",e),n instanceof sc){const r=it.fromString(e,...t);return b_(r),new ts(n,null,r)}{if(!(n instanceof ln||n instanceof ts))throw new he(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(it.fromString(e,...t));return b_(r),new ts(n.firestore,null,r)}}function _j(n,e){if(n=rt(n,sc),eg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new he(H.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rn(n,null,function(r){return new Ls(it.emptyPath(),r)}(e))}function xe(n,e,...t){if(n=Ne(n),arguments.length===1&&(e=Yb.newId()),eg("doc","path",e),n instanceof sc){const r=it.fromString(e,...t);return __(r),new ln(n,null,new Ae(r))}{if(!(n instanceof ln||n instanceof ts))throw new he(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(it.fromString(e,...t));return __(r),new ln(n.firestore,n instanceof ts?n.converter:null,new Ae(r))}}function bj(n,e){return n=Ne(n),e=Ne(e),(n instanceof ln||n instanceof ts)&&(e instanceof ln||e instanceof ts)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function HI(n,e){return n=Ne(n),e=Ne(e),n instanceof Rn&&e instanceof Rn&&n.firestore===e.firestore&&Yu(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lm(this,"async_queue_retry"),this.Vu=()=>{const r=hd();r&&de("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=hd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=hd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new In;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!$i(e))throw e;de("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw sn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=jm.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Re()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function kp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class AD{constructor(){this._progressObserver={},this._taskCompletionResolver=new In,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj=-1;class Ct extends sc{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new I_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new I_(e),this._firestoreClient=void 0,await e}}}function Ij(n,e,t){t||(t="(default)");const r=Li(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(Si(i,e))return s;throw new he(H.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new he(H.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new he(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function SD(n,e){const t=typeof n=="object"?n:fm(),r=typeof n=="string"?n:e||"(default)",s=Li(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=K1("firestore");i&&xD(s,...i)}return s}function Jt(n){if(n._terminated)throw new he(H.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||WI(n),n._firestoreClient}function WI(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,d){return new YR(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,KI(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new hD(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function PD(n,e){xr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return QI(n,Vi.provider,{build:r=>new Ym(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function Ej(n){xr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();QI(n,Vi.provider,{build:t=>new $I(t,e.cacheSizeBytes)})}function QI(n,e,t){if((n=rt(n,Ct))._firestoreClient||n._terminated)throw new he(H.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new he(H.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},WI(n)}function Tj(n){if(n._initialized&&!n._terminated)throw new he(H.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new In;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Zr.D())return Promise.resolve();const s=r+"main";await Zr.delete(s)}(Vm(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function xj(n){return function(t){const r=new In;return t.asyncQueue.enqueueAndForget(async()=>Jk(await Zm(t),r)),r.promise}(Jt(n=rt(n,Ct)))}function Aj(n){return fD(Jt(n=rt(n,Ct)))}function Sj(n){return pD(Jt(n=rt(n,Ct)))}function Pj(n){return rR(n.app,"firestore",n._databaseId.database),n._delete()}function Rj(n,e){const t=Jt(n=rt(n,Ct)),r=new AD;return _D(t,n._databaseId,e,r),r}function Cj(n,e){return bD(Jt(n=rt(n,Ct)),e).then(t=>t?new Rn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class RD{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vo(en.fromBase64String(e))}catch(t){throw new he(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vo(en.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function kj(){return new $o("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD=/^__.*__$/;class kD{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new $s(e,this.data,this.fieldMask,t,this.fieldTransforms):new il(e,this.data,t,this.fieldTransforms)}}class JI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new $s(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function YI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re()}}class Dh{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Dh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Gd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(YI(this.Cu)&&CD.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class DD{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||nc(e)}Qu(e,t,r,s=!1){return new Dh({Cu:e,methodName:t,qu:r,path:zt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jo(n){const e=n._freezeSettings(),t=nc(n._databaseId);return new DD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Nh(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);lg("Data must be an object, but it was:",o,r);const a=eE(r,o);let l,c;if(i.merge)l=new ar(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=Vu(e,f,t);if(!o.contains(g))throw new he(H.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);nE(d,g)||d.push(g)}l=new ar(d),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new kD(new Pn(a),l,c)}class ic extends Uo{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ic}}function XI(n,e,t){return new Dh({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ng extends Uo{_toFieldTransform(e){return new Zu(e.path,new Ua)}isEqual(e){return e instanceof ng}}class rg extends Uo{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=XI(this,e,!0),r=this.Ku.map(i=>Bo(i,t)),s=new Ro(r);return new Zu(e.path,s)}isEqual(e){return e instanceof rg&&Si(this.Ku,e.Ku)}}class sg extends Uo{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=XI(this,e,!0),r=this.Ku.map(i=>Bo(i,t)),s=new Co(r);return new Zu(e.path,s)}isEqual(e){return e instanceof sg&&Si(this.Ku,e.Ku)}}class ig extends Uo{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new ja(e.serializer,Dw(e.serializer,this.$u));return new Zu(e.path,t)}isEqual(e){return e instanceof ig&&this.$u===e.$u}}function og(n,e,t,r){const s=n.Qu(1,e,t);lg("Data must be an object, but it was:",s,r);const i=[],o=Pn.empty();Ui(r,(l,c)=>{const d=Vh(e,l,t);c=Ne(c);const f=s.Nu(d);if(c instanceof ic)i.push(d);else{const g=Bo(c,f);g!=null&&(i.push(d),o.set(d,g))}});const a=new ar(i);return new JI(o,a,s.fieldTransforms)}function ag(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[Vu(e,r,t)],l=[s];if(i.length%2!=0)throw new he(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(Vu(e,i[g])),l.push(i[g+1]);const c=[],d=Pn.empty();for(let g=a.length-1;g>=0;--g)if(!nE(c,a[g])){const y=a[g];let T=l[g];T=Ne(T);const A=o.Nu(y);if(T instanceof ic)c.push(y);else{const P=Bo(T,A);P!=null&&(c.push(y),d.set(y,P))}}const f=new ar(c);return new JI(d,f,o.fieldTransforms)}function ZI(n,e,t,r=!1){return Bo(t,n.Qu(r?4:3,e))}function Bo(n,e){if(tE(n=Ne(n)))return lg("Unsupported field value:",e,n),eE(n,e);if(n instanceof Uo)return function(r,s){if(!YI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Bo(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Ne(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Dw(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Qt.fromDate(r);return{timestampValue:Ba(s.serializer,i)}}if(r instanceof Qt){const i=new Qt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ba(s.serializer,i)}}if(r instanceof tg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vo)return{bytesValue:Kw(s.serializer,r._byteString)};if(r instanceof ln){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Sm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof kh)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return wm(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Ch(r)}`)}(n,e)}function eE(n,e){const t={};return cw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ui(n,(r,s)=>{const i=Bo(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function tE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Qt||n instanceof tg||n instanceof Vo||n instanceof ln||n instanceof Uo||n instanceof kh)}function lg(n,e,t){if(!tE(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Ch(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Vu(n,e,t){if((e=Ne(e))instanceof $o)return e._internalPath;if(typeof e=="string")return Vh(n,e);throw Gd("Field path arguments must be of type string or ",n,!1,void 0,t)}const ND=new RegExp("[~\\*/\\[\\]]");function Vh(n,e,t){if(e.search(ND)>=0)throw Gd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new $o(...e.split("."))._internalPath}catch{throw Gd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gd(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new he(H.INVALID_ARGUMENT,a+n+l)}function nE(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ln(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Oh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class VD extends Ou{data(){return super.data()}}function Oh(n,e){return typeof e=="string"?Vh(n,e):e instanceof $o?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new he(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ug{}class oc extends ug{}function Mu(n,e,...t){let r=[];e instanceof ug&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof hl).length,a=i.filter(l=>l instanceof ac).length;if(o>1||o>0&&a>0)throw new he(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class ac extends oc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ac(e,t,r)}_apply(e){const t=this._parse(e);return iE(e._query,t),new Rn(e.firestore,e.converter,_p(e._query,t))}_parse(e){const t=jo(e.firestore);return function(i,o,a,l,c,d,f){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new he(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){T_(f,d);const y=[];for(const T of f)y.push(E_(l,i,T));g={arrayValue:{values:y}}}else g=E_(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||T_(f,d),g=ZI(a,o,f,d==="in"||d==="not-in");return ot.create(c,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Hd(n,e,t){const r=e,s=Oh("where",n);return ac._create(s,r,t)}class hl extends ug{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new hl(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Tt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)iE(o,l),o=_p(o,l)}(e._query,t),new Rn(e.firestore,e.converter,_p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Dj(...n){return n.forEach(e=>oE("or",e)),hl._create("or",n)}function Nj(...n){return n.forEach(e=>oE("and",e)),hl._create("and",n)}class cg extends oc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cg(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new he(H.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new he(H.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cu(i,o)}(e._query,this._field,this._direction);return new Rn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Ls(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function OD(n,e="asc"){const t=e,r=Oh("orderBy",n);return cg._create(r,t)}class Mh extends oc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Mh(e,t,r)}_apply(e){return new Rn(e.firestore,e.converter,Md(e._query,this._limit,this._limitType))}}function Vj(n){return GI("limit",n),Mh._create("limit",n,"F")}function Oj(n){return GI("limitToLast",n),Mh._create("limitToLast",n,"L")}class Lh extends oc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Lh(e,t,r)}_apply(e){const t=sE(e,this.type,this._docOrFields,this._inclusive);return new Rn(e.firestore,e.converter,function(s,i){return new Ls(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function Mj(...n){return Lh._create("startAt",n,!0)}function Lj(...n){return Lh._create("startAfter",n,!1)}class Fh extends oc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Fh(e,t,r)}_apply(e){const t=sE(e,this.type,this._docOrFields,this._inclusive);return new Rn(e.firestore,e.converter,function(s,i){return new Ls(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function Fj(...n){return Fh._create("endBefore",n,!1)}function $j(...n){return Fh._create("endAt",n,!0)}function sE(n,e,t,r){if(t[0]=Ne(t[0]),t[0]instanceof Ou)return function(i,o,a,l,c){if(!l)throw new he(H.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of xa(i))if(f.field.isKeyField())d.push(So(o,l.key));else{const g=l.data.field(f.field);if(vh(g))throw new he(H.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const y=f.field.canonicalString();throw new he(H.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new ki(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=jo(n.firestore);return function(o,a,l,c,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new he(H.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let T=0;T<d.length;T++){const A=d[T];if(g[T].field.isKeyField()){if(typeof A!="string")throw new he(H.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof A}`);if(!_m(o)&&A.indexOf("/")!==-1)throw new he(H.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${A}' contains a slash.`);const P=o.path.child(it.fromString(A));if(!Ae.isDocumentKey(P))throw new he(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const U=new Ae(P);y.push(So(a,U))}else{const P=ZI(l,c,A);y.push(P)}}return new ki(y,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function E_(n,e,t){if(typeof(t=Ne(t))=="string"){if(t==="")throw new he(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_m(e)&&t.indexOf("/")!==-1)throw new he(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(it.fromString(t));if(!Ae.isDocumentKey(r))throw new he(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return So(n,new Ae(r))}if(t instanceof ln)return So(n,t._key);throw new he(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ch(t)}.`)}function T_(n,e){if(!Array.isArray(n)||n.length===0)throw new he(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iE(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new he(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function oE(n,e){if(!(e instanceof ac||e instanceof hl))throw new he(H.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class aE{convertValue(e,t="none"){switch(Ri(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ds(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Re()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ui(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>qt(o.doubleValue));return new kh(i)}convertGeoPoint(e){return new tg(qt(e.latitude),qt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=yh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Su(e));default:return null}}convertTimestamp(e){const t=ks(e);return new Qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=it.fromString(e);Ce(nI(r));const s=new Ao(r.get(1),r.get(3)),i=new Ae(r.popFirst(5));return s.isEqual(t)||sn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class MD extends aE{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ln(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uj(n){return new Nu("sum",Vu("sum",n))}function jj(n){return new Nu("avg",Vu("average",n))}function LD(){return new Nu("count")}function Bj(n,e){var t,r;return n instanceof Nu&&e instanceof Nu&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function qj(n,e){return HI(n.query,e.query)&&Si(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qa extends Ou{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Oh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class fd extends Qa{data(e={}){return super.data(e)}}class Ja{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new yo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new fd(this._firestore,this._userDataWriter,r.key,r,new yo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new fd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new yo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new fd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new yo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:FD(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function FD(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re()}}function zj(n,e){return n instanceof Qa&&e instanceof Qa?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ja&&e instanceof Ja&&n._firestore===e._firestore&&HI(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(n){n=rt(n,ln);const e=rt(n.firestore,Ct);return qI(Jt(e),n._key).then(t=>dg(e,n,t))}class Bi extends aE{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ln(this.firestore,null,t)}}function Kj(n){n=rt(n,ln);const e=rt(n.firestore,Ct),t=Jt(e),r=new Bi(e);return mD(t,n._key).then(s=>new Qa(e,r,n._key,s,new yo(s!==null&&s.hasLocalMutations,!0),n.converter))}function Gj(n){n=rt(n,ln);const e=rt(n.firestore,Ct);return qI(Jt(e),n._key,{source:"server"}).then(t=>dg(e,n,t))}function wt(n){n=rt(n,Rn);const e=rt(n.firestore,Ct),t=Jt(e),r=new Bi(e);return rE(n._query),zI(t,n._query).then(s=>new Ja(e,r,n,s))}function Hj(n){n=rt(n,Rn);const e=rt(n.firestore,Ct),t=Jt(e),r=new Bi(e);return gD(t,n._query).then(s=>new Ja(e,r,n,s))}function Wj(n){n=rt(n,Rn);const e=rt(n.firestore,Ct),t=Jt(e),r=new Bi(e);return zI(t,n._query,{source:"server"}).then(s=>new Ja(e,r,n,s))}function Zt(n,e,t){n=rt(n,ln);const r=rt(n.firestore,Ct),s=$h(n.converter,e,t);return lc(r,[Nh(jo(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Kt.none())])}function fl(n,e,t,...r){n=rt(n,ln);const s=rt(n.firestore,Ct),i=jo(s);let o;return o=typeof(e=Ne(e))=="string"||e instanceof $o?ag(i,"updateDoc",n._key,e,t,r):og(i,"updateDoc",n._key,e),lc(s,[o.toMutation(n._key,Kt.exists(!0))])}function Ya(n){return lc(rt(n.firestore,Ct),[new ol(n._key,Kt.none())])}function pl(n,e){const t=rt(n.firestore,Ct),r=xe(n),s=$h(n.converter,e);return lc(t,[Nh(jo(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Kt.exists(!1))]).then(()=>r)}function Qj(n,...e){var t,r,s;n=Ne(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||kp(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(kp(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,d;if(n instanceof ln)c=rt(n.firestore,Ct),d=sl(n._key.path),l={next:f=>{e[o]&&e[o](dg(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=rt(n,Rn);c=rt(f.firestore,Ct),d=f._query;const g=new Bi(c);l={next:y=>{e[o]&&e[o](new Ja(c,g,f,y))},error:e[o+1],complete:e[o+2]},rE(n._query)}return function(g,y,T,A){const P=new Ph(A),U=new Km(y,P,T);return g.asyncQueue.enqueueAndForget(async()=>Bm(await Wa(g),U)),()=>{P.Za(),g.asyncQueue.enqueueAndForget(async()=>qm(await Wa(g),U))}}(Jt(c),d,a,l)}function Jj(n,e){return yD(Jt(n=rt(n,Ct)),kp(e)?e:{next:e})}function lc(n,e){return function(r,s){const i=new In;return r.asyncQueue.enqueueAndForget(async()=>Gk(await Zm(r),s,i)),i.promise}(Jt(n),e)}function dg(n,e,t){const r=t.docs.get(e._key),s=new Bi(n);return new Qa(n,s,e._key,r,new yo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(n){return $D(n,{count:LD()})}function $D(n,e){const t=rt(n.firestore,Ct),r=Jt(t),s=uw(e,(i,o)=>new $w(o,i.aggregateType,i._internalFieldPath));return vD(r,n._query,s).then(i=>function(a,l,c){const d=new Bi(a);return new RD(l,d,c)}(t,n,i))}class UD{constructor(e){this.kind="memory",this._onlineComponentProvider=Vi.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=Ni.provider}toJSON(){return{kind:this.kind}}}class jD{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=GD(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class BD{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Ni.provider}toJSON(){return{kind:this.kind}}}class qD{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new lD(e)}}toJSON(){return{kind:this.kind}}}function Xj(){return new BD}function Zj(n){return new qD(n==null?void 0:n.cacheSizeBytes)}function eB(n){return new UD(n)}function tB(n){return new jD(n)}class zD{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Vi.provider,this._offlineComponentProvider={build:t=>new Ym(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class KD{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Vi.provider,this._offlineComponentProvider={build:t=>new $I(t,e==null?void 0:e.cacheSizeBytes)}}}function GD(n){return new zD(n==null?void 0:n.forceOwnership)}function nB(){return new KD}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=jo(e)}set(e,t,r){this._verifyNotCommitted();const s=fi(e,this._firestore),i=$h(s.converter,t,r),o=Nh(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Kt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=fi(e,this._firestore);let o;return o=typeof(t=Ne(t))=="string"||t instanceof $o?ag(this._dataReader,"WriteBatch.update",i._key,t,r,s):og(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=fi(e,this._firestore);return this._mutations=this._mutations.concat(new ol(t._key,Kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(H.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fi(n,e){if((n=Ne(n)).firestore!==e)throw new he(H.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=jo(t)}get(t){const r=fi(t,this._firestore),s=new MD(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return Re();const o=i[0];if(o.isFoundDocument())return new Ou(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new Ou(this._firestore,s,r._key,null,r.converter);throw Re()})}set(t,r,s){const i=fi(t,this._firestore),o=$h(i.converter,r,s),a=Nh(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=fi(t,this._firestore);let a;return a=typeof(r=Ne(r))=="string"||r instanceof $o?ag(this._dataReader,"Transaction.update",o._key,r,s,i):og(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=fi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=fi(e,this._firestore),r=new Bi(this._firestore);return super.get(e).then(s=>new Qa(this._firestore,r,t._key,s._document,new yo(!1,!1),t.converter))}}function sB(n,e,t){n=rt(n,Ct);const r=Object.assign(Object.assign({},HD),t);return function(i){if(i.maxAttempts<1)throw new he(H.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new In;return i.asyncQueue.enqueueAndForget(async()=>{const c=await BI(i);new dD(i.asyncQueue,c,a,o,l).au()}),l.promise}(Jt(n),s=>e(new QD(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iB(){return new ic("deleteField")}function qi(){return new ng("serverTimestamp")}function JD(...n){return new rg("arrayUnion",n)}function oB(...n){return new sg("arrayRemove",n)}function aB(n){return new ig("increment",n)}function lB(n){return new kh(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n){return Jt(n=rt(n,Ct)),new WD(n,e=>lc(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uB(n,e){const t=Jt(n=rt(n,Ct));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return xr("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(c){try{return JSON.parse(c)}catch(d){throw new he(H.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const c=x_(l,"collectionGroup"),d=[];if(Array.isArray(l.fields))for(const f of l.fields){const g=Vh("setIndexConfiguration",x_(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new Eo(g,2)):f.order==="ASCENDING"?d.push(new Eo(g,0)):f.order==="DESCENDING"&&d.push(new Eo(g,1))}a.push(new Ma(Ma.UNKNOWN_ID,c,d,La.empty()))}return a}(e);return wD(t,r)}function x_(n,e){if(typeof n[e]!="string")throw new he(H.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function cB(n){var e;n=rt(n,Ct);const t=A_.get(n);if(t)return t;if(((e=Jt(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new YD(n);return A_.set(n,r),r}function dB(n){lE(n,!0)}function hB(n){lE(n,!1)}function fB(n){ED(Jt(n._firestore)).then(e=>de("deleting all persistent cache indexes succeeded")).catch(e=>xr("deleting all persistent cache indexes failed",e))}function lE(n,e){ID(Jt(n._firestore),e).then(t=>de(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>xr(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const A_=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pB(n){var e;const t=(e=Jt(rt(n.firestore,Ct))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Ih(t,Bn(n._query))._t}function mB(n,e){var t;const r=uw(e,(i,o)=>new $w(o,i.aggregateType,i._internalFieldPath)),s=(t=Jt(rt(n.firestore,Ct))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:Xw(s,Ew(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return fg.instance.onExistenceFilterMismatch(e)}}class fg{constructor(){this.Uu=new Map}static get instance(){return Qc||(Qc=new fg,function(t){if(Ld)throw new Error("a TestingHooksSpi instance is already set");Ld=t}(Qc)),Qc}et(e){this.Uu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let Qc=null;(function(e,t=!0){(function(s){rl=s})(nl),ss(new $r("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Ct(new _R(r.getProvider("auth-internal")),new IR(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new he(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ao(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Er(my,"4.7.3",e),Er(my,"4.7.3","esm2017")})();function pg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB={PHONE:"phone",TOTP:"totp"},yB={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},_B={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},bB={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},wB={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function uE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IB=XD,ZD=uE,cE=new Fo("auth","Firebase",uE()),EB={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=new dm("@firebase/auth");function e2(n,...e){Wd.logLevel<=st.WARN&&Wd.warn(`Auth (${nl}): ${n}`,...e)}function pd(n,...e){Wd.logLevel<=st.ERROR&&Wd.error(`Auth (${nl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(n,...e){throw gg(n,...e)}function Zn(n,...e){return gg(n,...e)}function mg(n,e,t){const r=Object.assign(Object.assign({},ZD()),{[e]:t});return new Fo("auth","Firebase",r).create(e,{appName:n.name})}function En(n){return mg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ml(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ur(n,"argument-error"),mg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function gg(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return cE.create(n,...e)}function we(n,e,...t){if(!n)throw gg(e,...t)}function Yr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw pd(e),new Error(e)}function Ns(n,e){n||Yr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function vg(){return S_()==="http:"||S_()==="https:"}function S_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vg()||Y1()||"connection"in navigator)?navigator.onLine:!0}function n2(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ns(t>e,"Short delay should be less than long delay!"),this.isMobile=W1()||X1()}get(){return t2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n,e){Ns(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=new uc(3e4,6e4);function Ut(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function jt(n,e,t,r,s={}){return hE(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=tl(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return J1()||(c.referrerPolicy="no-referrer"),dE.fetch()(fE(n,n.config.apiHost,t,a),c)})}async function hE(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},r2),e);try{const s=new o2(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Zl(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zl(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Zl(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Zl(n,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw mg(n,d,c);ur(n,d)}}catch(s){if(s instanceof os)throw s;ur(n,"network-request-failed",{message:String(s)})}}async function js(n,e,t,r,s={}){const i=await jt(n,e,t,r,s);return"mfaPendingCredential"in i&&ur(n,"multi-factor-auth-required",{_serverResponse:i}),i}function fE(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?yg(n.config,s):`${n.config.apiScheme}://${s}`}function i2(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class o2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Zn(this.auth,"network-request-failed")),s2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Zl(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Zn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(n){return n!==void 0&&n.getResponse!==void 0}function R_(n){return n!==void 0&&n.enterprise!==void 0}class pE{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return i2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a2(n){return(await jt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function mE(n,e){return jt(n,"GET","/v2/recaptchaConfig",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l2(n,e){return jt(n,"POST","/v1/accounts:delete",e)}async function u2(n,e){return jt(n,"POST","/v1/accounts:update",e)}async function gE(n,e){return jt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TB(n,e=!1){return Ne(n).getIdToken(e)}async function c2(n,e=!1){const t=Ne(n),r=await t.getIdToken(e),s=Uh(r);we(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:mu(Mf(s.auth_time)),issuedAtTime:mu(Mf(s.iat)),expirationTime:mu(Mf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Mf(n){return Number(n)*1e3}function Uh(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return pd("JWT malformed, contained fewer than 3 sections"),null;try{const s=Db(t);return s?JSON.parse(s):(pd("Failed to decode base64 JWT payload"),null)}catch(s){return pd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function C_(n){const e=Uh(n);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof os&&d2(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function d2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mu(this.lastLoginAt),this.creationTime=mu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fu(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Vs(n,gE(t,{idToken:r}));we(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?vE(i.providerUserInfo):[],a=p2(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Dp(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function f2(n){const e=Ne(n);await Fu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function p2(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function vE(n){return n.map(e=>{var{providerId:t}=e,r=pg(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2(n,e){const t=await hE(n,{},async()=>{const r=tl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=fE(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",dE.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function g2(n,e){return jt(n,"POST","/v2/accounts:revokeToken",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):C_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){we(e.length!==0,"internal-error");const t=C_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await m2(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Sa;return r&&(we(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(we(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(we(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sa,this.toJSON())}_performRefresh(){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(n,e){we(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Is{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=pg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new h2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Dp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Vs(this,this.stsTokenManager.getToken(this.auth,e));return we(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return c2(this,e)}reload(){return f2(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Is(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Fu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(on(this.auth.app))return Promise.reject(En(this.auth));const e=await this.getIdToken();return await Vs(this,l2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(s=t.email)!==null&&s!==void 0?s:void 0,y=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,T=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,U=(c=t.createdAt)!==null&&c!==void 0?c:void 0,q=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:M,emailVerified:z,isAnonymous:fe,providerData:me,stsTokenManager:x}=t;we(M&&x,e,"internal-error");const I=Sa.fromJSON(this.name,x);we(typeof M=="string",e,"internal-error"),oi(f,e.name),oi(g,e.name),we(typeof z=="boolean",e,"internal-error"),we(typeof fe=="boolean",e,"internal-error"),oi(y,e.name),oi(T,e.name),oi(A,e.name),oi(P,e.name),oi(U,e.name),oi(q,e.name);const w=new Is({uid:M,auth:e,email:g,emailVerified:z,displayName:f,isAnonymous:fe,photoURL:T,phoneNumber:y,tenantId:A,stsTokenManager:I,createdAt:U,lastLoginAt:q});return me&&Array.isArray(me)&&(w.providerData=me.map(C=>Object.assign({},C))),P&&(w._redirectEventId=P),w}static async _fromIdTokenResponse(e,t,r=!1){const s=new Sa;s.updateFromServerResponse(t);const i=new Is({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Fu(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];we(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?vE(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Sa;a.updateFromIdToken(r);const l=new Is({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Dp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_=new Map;function Es(n){Ns(n instanceof Function,"Expected a class definition");let e=k_.get(n);return e?(Ns(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,k_.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}yE.type="NONE";const D_=yE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(n,e,t){return`firebase:${n}:${e}:${t}`}class Pa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=md(this.userKey,s.apiKey,i),this.fullPersistenceKey=md("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Is._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Pa(Es(D_),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Es(D_);const o=md(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){const f=Is._fromJSON(e,d);c!==i&&(a=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Pa(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Pa(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(IE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_E(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TE(e))return"Blackberry";if(xE(e))return"Webos";if(bE(e))return"Safari";if((e.includes("chrome/")||wE(e))&&!e.includes("edge/"))return"Chrome";if(EE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function _E(n=vn()){return/firefox\//i.test(n)}function bE(n=vn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wE(n=vn()){return/crios\//i.test(n)}function IE(n=vn()){return/iemobile/i.test(n)}function EE(n=vn()){return/android/i.test(n)}function TE(n=vn()){return/blackberry/i.test(n)}function xE(n=vn()){return/webos/i.test(n)}function _g(n=vn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function v2(n=vn()){var e;return _g(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function y2(){return Z1()&&document.documentMode===10}function AE(n=vn()){return _g(n)||EE(n)||xE(n)||TE(n)||/windows phone/i.test(n)||IE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(n,e=[]){let t;switch(n){case"Browser":t=N_(vn());break;case"Worker":t=`${N_(vn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${nl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b2(n,e={}){return jt(n,"GET","/v2/passwordPolicy",Ut(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=6;class I2{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:w2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new V_(this),this.idTokenSubscription=new V_(this),this.beforeStateQueue=new _2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Es(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Pa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await gE(this,{idToken:e}),r=await Is._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(on(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Fu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(on(this.app))return Promise.reject(En(this));const t=e?Ne(e):null;return t&&we(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return on(this.app)?Promise.reject(En(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return on(this.app)?Promise.reject(En(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Es(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await b2(this),t=new I2(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await g2(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Es(e)||this._popupRedirectResolver;we(t,this,"argument-error"),this.redirectPersistenceManager=await Pa.create(this,[Es(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=SE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&e2(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function tn(n){return Ne(n)}class V_{constructor(e){this.auth=e,this.observer=null,this.addObserver=iP(t=>this.observer=t)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function T2(n){cc=n}function bg(n){return cc.loadJS(n)}function x2(){return cc.recaptchaV2Script}function A2(){return cc.recaptchaEnterpriseScript}function S2(){return cc.gapiScript}function PE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const P2="recaptcha-enterprise",R2="NO_RECAPTCHA";class RE{constructor(e){this.type=P2,this.auth=tn(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{mE(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new pE(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;R_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(R2)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&R_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=A2();l.length!==0&&(l+=a),bg(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function O_(n,e,t,r=!1){const s=new RE(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function $u(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await O_(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await O_(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}async function C2(n){const e=tn(n),t=await mE(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new pE(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new RE(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(n,e){const t=Li(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Si(i,e??{}))return s;ur(s,"already-initialized")}return t.initialize({options:e})}function D2(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Es);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function N2(n,e,t){const r=tn(n);we(r._canInitEmulator,r,"emulator-config-failed"),we(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=CE(e),{host:o,port:a}=V2(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||O2()}function CE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function V2(n){const e=CE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:M_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:M_(o)}}}function M_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function O2(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Yr("not implemented")}_getIdTokenResponse(e){return Yr("not implemented")}_linkToIdToken(e,t){return Yr("not implemented")}_getReauthenticationResolver(e){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kE(n,e){return jt(n,"POST","/v1/accounts:resetPassword",Ut(n,e))}async function M2(n,e){return jt(n,"POST","/v1/accounts:update",e)}async function L2(n,e){return jt(n,"POST","/v1/accounts:signUp",e)}async function F2(n,e){return jt(n,"POST","/v1/accounts:update",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $2(n,e){return js(n,"POST","/v1/accounts:signInWithPassword",Ut(n,e))}async function jh(n,e){return jt(n,"POST","/v1/accounts:sendOobCode",Ut(n,e))}async function U2(n,e){return jh(n,e)}async function j2(n,e){return jh(n,e)}async function B2(n,e){return jh(n,e)}async function q2(n,e){return jh(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z2(n,e){return js(n,"POST","/v1/accounts:signInWithEmailLink",Ut(n,e))}async function K2(n,e){return js(n,"POST","/v1/accounts:signInWithEmailLink",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu extends dc{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Uu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Uu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $u(e,t,"signInWithPassword",$2);case"emailLink":return z2(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $u(e,r,"signUpPassword",L2);case"emailLink":return K2(e,{idToken:t,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ss(n,e){return js(n,"POST","/v1/accounts:signInWithIdp",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2="http://localhost";class Os extends dc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Os(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ur("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=pg(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Os(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ss(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ss(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ss(e,t)}buildRequest(){const e={requestUri:G2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(n,e){return jt(n,"POST","/v1/accounts:sendVerificationCode",Ut(n,e))}async function W2(n,e){return js(n,"POST","/v1/accounts:signInWithPhoneNumber",Ut(n,e))}async function Q2(n,e){const t=await js(n,"POST","/v1/accounts:signInWithPhoneNumber",Ut(n,e));if(t.temporaryProof)throw Zl(n,"account-exists-with-different-credential",t);return t}const J2={USER_NOT_FOUND:"user-not-found"};async function Y2(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return js(n,"POST","/v1/accounts:signInWithPhoneNumber",Ut(n,t),J2)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To extends dc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new To({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new To({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return W2(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return Q2(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Y2(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new To({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X2(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Z2(n){const e=Hl(Wl(n)).link,t=e?Hl(Wl(e)).deep_link_id:null,r=Hl(Wl(n)).deep_link_id;return(r?Hl(Wl(r)).link:null)||r||t||e||n}class hc{constructor(e){var t,r,s,i,o,a;const l=Hl(Wl(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=X2((s=l.mode)!==null&&s!==void 0?s:null);we(c&&d&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=Z2(e);try{return new hc(t)}catch{return null}}}function xB(n){return hc.parseLink(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(){this.providerId=qo.PROVIDER_ID}static credential(e,t){return Uu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=hc.parseLink(t);return we(r,"argument-error"),Uu._fromEmailAndCode(e,r.code,r.tenantId)}}qo.PROVIDER_ID="password";qo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";qo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl extends Bs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class gd extends gl{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return we("providerId"in t&&"signInMethod"in t,"argument-error"),Os._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return we(e.idToken||e.accessToken,"argument-error"),Os._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return gd.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return gd.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new gd(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends gl{constructor(){super("facebook.com")}static credential(e){return Os._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.FACEBOOK_SIGN_IN_METHOD="facebook.com";pi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends gl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Os._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return mi.credential(t,r)}catch{return null}}}mi.GOOGLE_SIGN_IN_METHOD="google.com";mi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends gl{constructor(){super("github.com")}static credential(e){return Os._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gi.credential(e.oauthAccessToken)}catch{return null}}}gi.GITHUB_SIGN_IN_METHOD="github.com";gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN="http://localhost";class ju extends dc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Ss(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ss(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ss(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new ju(r,i)}static _create(e,t){return new ju(e,t)}buildRequest(){return{requestUri:eN,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN="saml.";class Np extends Bs{constructor(e){we(e.startsWith(tN),"argument-error"),super(e)}static credentialFromResult(e){return Np.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Np.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=ju.fromJSON(e);return we(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return ju._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends gl{constructor(){super("twitter.com")}static credential(e,t){return Os._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return vi.credential(t,r)}catch{return null}}}vi.TWITTER_SIGN_IN_METHOD="twitter.com";vi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DE(n,e){return js(n,"POST","/v1/accounts:signUp",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Is._fromIdTokenResponse(e,r,s),o=L_(r);return new Ar({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=L_(r);return new Ar({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function L_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nN(n){var e;if(on(n.app))return Promise.reject(En(n));const t=tn(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ar({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await DE(t,{returnSecureToken:!0}),s=await Ar._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd extends os{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Qd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Qd(e,t,r,s)}}function NE(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Qd._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(n,e){const t=Ne(n);await Bh(!0,t,e);const{providerUserInfo:r}=await u2(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=VE(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function wg(n,e,t=!1){const r=await Vs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ar._forOperation(n,"link",r)}async function Bh(n,e,t){await Fu(e);const r=VE(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";we(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OE(n,e,t=!1){const{auth:r}=n;if(on(r.app))return Promise.reject(En(r));const s="reauthenticate";try{const i=await Vs(n,NE(r,s,e,n),t);we(i.idToken,r,"internal-error");const o=Uh(i.idToken);we(o,r,"internal-error");const{sub:a}=o;return we(n.uid===a,r,"user-mismatch"),Ar._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ME(n,e,t=!1){if(on(n.app))return Promise.reject(En(n));const r="signIn",s=await NE(n,r,e),i=await Ar._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function Ig(n,e){return ME(tn(n),e)}async function rN(n,e){const t=Ne(n);return await Bh(!1,t,e.providerId),wg(t,e)}async function sN(n,e){return OE(Ne(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(n,e){return js(n,"POST","/v1/accounts:signInWithCustomToken",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SB(n,e){if(on(n.app))return Promise.reject(En(n));const t=tn(n),r=await iN(t,{token:e,returnSecureToken:!0}),s=await Ar._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Eg._fromServerResponse(e,t):"totpInfo"in t?Tg._fromServerResponse(e,t):ur(e,"internal-error")}}class Eg extends fc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Eg(t)}}class Tg extends fc{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Tg(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(n,e,t){var r;we(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),we(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(we(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(we(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xg(n){const e=tn(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function oN(n,e,t){const r=tn(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&qh(r,s,t),await $u(r,s,"getOobCode",j2)}async function aN(n,e,t){await kE(Ne(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&xg(n),r})}async function PB(n,e){await F2(Ne(n),{oobCode:e})}async function lN(n,e){const t=Ne(n),r=await kE(t,{oobCode:e}),s=r.requestType;switch(we(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":we(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":we(r.mfaInfo,t,"internal-error");default:we(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=fc._fromServerResponse(tn(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function RB(n,e){const{data:t}=await lN(Ne(n),e);return t.email}async function uN(n,e,t){if(on(n.app))return Promise.reject(En(n));const r=tn(n),o=await $u(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",DE).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&xg(n),l}),a=await Ar._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function cN(n,e,t){return on(n.app)?Promise.reject(En(n)):Ig(Ne(n),qo.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&xg(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CB(n,e,t){const r=tn(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){we(a.handleCodeInApp,r,"argument-error"),a&&qh(r,o,a)}i(s,t),await $u(r,s,"getOobCode",B2)}function kB(n,e){const t=hc.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function DB(n,e,t){if(on(n.app))return Promise.reject(En(n));const r=Ne(n),s=qo.credentialWithLink(e,t||Lu());return we(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ig(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dN(n,e){return jt(n,"POST","/v1/accounts:createAuthUri",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NB(n,e){const t=vg()?Lu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await dN(Ne(n),r);return s||[]}async function VB(n,e){const t=Ne(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&qh(t.auth,s,e);const{email:i}=await U2(t.auth,s);i!==n.email&&await n.reload()}async function OB(n,e,t){const r=Ne(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&qh(r.auth,i,t);const{email:o}=await q2(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hN(n,e){return jt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MB(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Ne(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Vs(r,hN(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function fN(n,e){const t=Ne(n);return on(t.auth.app)?Promise.reject(En(t.auth)):LE(t,e,null)}function pN(n,e){return LE(Ne(n),null,e)}async function LE(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await Vs(n,M2(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(n){var e,t;if(!n)return null;const{providerId:r}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=Uh(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new Ra(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new gN(i,s);case"github.com":return new vN(i,s);case"google.com":return new yN(i,s);case"twitter.com":return new _N(i,s,n.screenName||null);case"custom":case"anonymous":return new Ra(i,null);default:return new Ra(i,r,s)}}class Ra{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class FE extends Ra{constructor(e,t,r,s){super(e,t,r),this.username=s}}class gN extends Ra{constructor(e,t){super(e,"facebook.com",t)}}class vN extends FE{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class yN extends Ra{constructor(e,t){super(e,"google.com",t)}}class _N extends FE{constructor(e,t,r){super(e,"twitter.com",t,r)}}function LB(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:mN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(n,e){return Ne(n).setPersistence(e)}function FB(n){return C2(n)}async function $B(n,e){return tn(n).validatePassword(e)}function wN(n,e,t,r){return Ne(n).onIdTokenChanged(e,t,r)}function IN(n,e,t){return Ne(n).beforeAuthStateChanged(e,t)}function EN(n,e,t,r){return Ne(n).onAuthStateChanged(e,t,r)}function UB(n){Ne(n).useDeviceLanguage()}function jB(n,e){return Ne(n).updateCurrentUser(e)}function TN(n){return Ne(n).signOut()}function BB(n,e){return tn(n).revokeAccessToken(e)}async function qB(n){return Ne(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new _o("enroll",e,t)}static _fromMfaPendingCredential(e){return new _o("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return _o._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return _o._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=tn(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>fc._fromServerResponse(r,a));we(s.mfaPendingCredential,r,"internal-error");const o=_o._fromMfaPendingCredential(s.mfaPendingCredential);return new Ag(o,i,async a=>{const l=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const c=Object.assign(Object.assign({},s),{idToken:l.idToken,refreshToken:l.refreshToken});switch(t.operationType){case"signIn":const d=await Ar._fromIdTokenResponse(r,t.operationType,c);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return we(t.user,r,"internal-error"),Ar._forOperation(t.user,t.operationType,c);default:ur(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function zB(n,e){var t;const r=Ne(n),s=e;return we(e.customData.operationType,r,"argument-error"),we((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Ag._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:start",Ut(n,e))}function AN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ut(n,e))}function SN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:start",Ut(n,e))}function PN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ut(n,e))}function RN(n,e){return jt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ut(n,e))}class Sg{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>fc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Sg(e)}async getSession(){return _o._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await Vs(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Vs(this.user,RN(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const Lf=new WeakMap;function KB(n){const e=Ne(n);return Lf.has(e)||Lf.set(e,Sg._fromUser(e)),Lf.get(e)}const Jd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jd,"1"),this.storage.removeItem(Jd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN=1e3,kN=10;class UE extends $E{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=AE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);y2()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,kN):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},CN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}UE.type="LOCAL";const jE=UE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE extends $E{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}BE.type="SESSION";const qE=BE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new zh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await DN(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=Kh("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(){return window}function VN(n){mn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(){return typeof mn().WorkerGlobalScope<"u"&&typeof mn().importScripts=="function"}async function ON(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function LN(){return Pg()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="firebaseLocalStorageDb",FN=1,Yd="firebaseLocalStorage",KE="fbase_key";class pc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gh(n,e){return n.transaction([Yd],e?"readwrite":"readonly").objectStore(Yd)}function $N(){const n=indexedDB.deleteDatabase(zE);return new pc(n).toPromise()}function Vp(){const n=indexedDB.open(zE,FN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Yd,{keyPath:KE})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Yd)?e(r):(r.close(),await $N(),e(await Vp()))})})}async function F_(n,e,t){const r=Gh(n,!0).put({[KE]:e,value:t});return new pc(r).toPromise()}async function UN(n,e){const t=Gh(n,!1).get(e),r=await new pc(t).toPromise();return r===void 0?null:r.value}function $_(n,e){const t=Gh(n,!0).delete(e);return new pc(t).toPromise()}const jN=800,BN=3;class GE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>BN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zh._getInstance(LN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await ON(),!this.activeServiceWorker)return;this.sender=new NN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vp();return await F_(e,Jd,"1"),await $_(e,Jd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>F_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>UN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Gh(s,!1).getAll();return new pc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}GE.type="LOCAL";const qN=GE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(n,e){return jt(n,"POST","/v2/accounts/mfaSignIn:start",Ut(n,e))}function KN(n,e){return jt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ut(n,e))}function GN(n,e){return jt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ut(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=500,WN=6e4,Jc=1e12;class QN{constructor(e){this.auth=e,this.counter=Jc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new JN(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Jc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Jc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Jc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class JN{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;we(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=YN(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},WN)},HN))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function YN(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff=PE("rcb"),XN=new uc(3e4,6e4);class ZN{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=mn().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return we(eV(t),e,"argument-error"),this.shouldResolveImmediately(t)&&P_(mn().grecaptcha)?Promise.resolve(mn().grecaptcha):new Promise((r,s)=>{const i=mn().setTimeout(()=>{s(Zn(e,"network-request-failed"))},XN.get());mn()[Ff]=()=>{mn().clearTimeout(i),delete mn()[Ff];const a=mn().grecaptcha;if(!a||!P_(a)){s(Zn(e,"internal-error"));return}const l=a.render;a.render=(c,d)=>{const f=l(c,d);return this.counter++,f},this.hostLanguage=t,r(a)};const o=`${x2()}?${tl({onload:Ff,render:"explicit",hl:t})}`;bg(o).catch(()=>{clearTimeout(i),s(Zn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=mn().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function eV(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class tV{async load(e){return new QN(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="recaptcha",nV={theme:"light",type:"image"};class GB{constructor(e,t,r=Object.assign({},nV)){this.parameters=r,this.type=HE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=tn(e),this.isInvisible=this.parameters.size==="invisible",we(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;we(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new tV:new ZN,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){we(!this.parameters.sitekey,this.auth,"argument-error"),we(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),we(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=mn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){we(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){we(vg()&&!Pg(),this.auth,"internal-error"),await rV(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await a2(this.auth);we(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return we(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function rV(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=To._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function HB(n,e,t){if(on(n.app))return Promise.reject(En(n));const r=tn(n),s=await Hh(r,e,Ne(t));return new Rg(s,i=>Ig(r,i))}async function WB(n,e,t){const r=Ne(n);await Bh(!1,r,"phone");const s=await Hh(r.auth,e,Ne(t));return new Rg(s,i=>rN(r,i))}async function QB(n,e,t){const r=Ne(n);if(on(r.auth.app))return Promise.reject(En(r.auth));const s=await Hh(r.auth,e,Ne(t));return new Rg(s,i=>sN(r,i))}async function Hh(n,e,t){var r;const s=await t.verify();try{we(typeof s=="string",n,"argument-error"),we(t.type===HE,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return we(o.type==="enroll",n,"internal-error"),(await xN(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{we(o.type==="signin",n,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return we(a,n,"missing-multi-factor-info"),(await zN(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await H2(n,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{t._reset()}}async function JB(n,e){const t=Ne(n);if(on(t.auth.app))return Promise.reject(En(t.auth));await wg(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this.providerId=Ca.PROVIDER_ID,this.auth=tn(e)}verifyPhoneNumber(e,t){return Hh(this.auth,e,Ne(t))}static credential(e,t){return To._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ca.credentialFromTaggedObject(t)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?To._fromTokenResponse(t,r):null}}Ca.PROVIDER_ID="phone";Ca.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(n,e){return e?Es(e):(we(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg extends dc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ss(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ss(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ss(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function sV(n){return ME(n.auth,new Cg(n),n.bypassAuthState)}function iV(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),OE(t,new Cg(n),n.bypassAuthState)}async function oV(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),wg(t,new Cg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sV;case"linkViaPopup":case"linkViaRedirect":return oV;case"reauthViaPopup":case"reauthViaRedirect":return iV;default:ur(this.auth,"internal-error")}}resolve(e){Ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=new uc(2e3,1e4);async function YB(n,e,t){if(on(n.app))return Promise.reject(Zn(n,"operation-not-supported-in-this-environment"));const r=tn(n);ml(n,e,Bs);const s=zo(r,t);return new Ts(r,"signInViaPopup",e,s).executeNotNull()}async function XB(n,e,t){const r=Ne(n);if(on(r.auth.app))return Promise.reject(Zn(r.auth,"operation-not-supported-in-this-environment"));ml(r.auth,e,Bs);const s=zo(r.auth,t);return new Ts(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function ZB(n,e,t){const r=Ne(n);ml(r.auth,e,Bs);const s=zo(r.auth,t);return new Ts(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Ts extends WE{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ts.currentPopupAction&&Ts.currentPopupAction.cancel(),Ts.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Ns(this.filter.length===1,"Popup operations only handle one event");const e=Kh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ts.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,aV.get())};e()}}Ts.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lV="pendingRedirect",vd=new Map;class uV extends WE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=vd.get(this.auth._key());if(!e){try{const r=await cV(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}vd.set(this.auth._key(),e)}return this.bypassAuthState||vd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cV(n,e){const t=JE(e),r=QE(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function kg(n,e){return QE(n)._set(JE(e),"true")}function dV(n,e){vd.set(n._key(),e)}function QE(n){return Es(n._redirectPersistence)}function JE(n){return md(lV,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(n,e,t){return hV(n,e,t)}async function hV(n,e,t){if(on(n.app))return Promise.reject(En(n));const r=tn(n);ml(n,e,Bs),await r._initializationPromise;const s=zo(r,t);return await kg(s,r),s._openRedirect(r,e,"signInViaRedirect")}function tq(n,e,t){return fV(n,e,t)}async function fV(n,e,t){const r=Ne(n);if(ml(r.auth,e,Bs),on(r.auth.app))return Promise.reject(En(r.auth));await r.auth._initializationPromise;const s=zo(r.auth,t);await kg(s,r.auth);const i=await XE(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function nq(n,e,t){return pV(n,e,t)}async function pV(n,e,t){const r=Ne(n);ml(r.auth,e,Bs),await r.auth._initializationPromise;const s=zo(r.auth,t);await Bh(!1,r,e.providerId),await kg(s,r.auth);const i=await XE(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function rq(n,e){return await tn(n)._initializationPromise,YE(n,e,!1)}async function YE(n,e,t=!1){if(on(n.app))return Promise.reject(En(n));const r=tn(n),s=zo(r,e),o=await new uV(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function XE(n){const e=Kh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV=10*60*1e3;class gV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vV(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!ZE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Zn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=mV&&this.cachedEventUids.clear(),this.cachedEventUids.has(U_(e))}saveEventToCache(e){this.cachedEventUids.add(U_(e)),this.lastProcessedEventTime=Date.now()}}function U_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ZE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vV(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yV(n,e={}){return jt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bV=/^https?/;async function wV(n){if(n.config.emulator)return;const{authorizedDomains:e}=await yV(n);for(const t of e)try{if(IV(t))return}catch{}ur(n,"unauthorized-domain")}function IV(n){const e=Lu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!bV.test(t))return!1;if(_V.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV=new uc(3e4,6e4);function j_(){const n=mn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function TV(n){return new Promise((e,t)=>{var r,s,i;function o(){j_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{j_(),t(Zn(n,"network-request-failed"))},timeout:EV.get()})}if(!((s=(r=mn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=mn().gapi)===null||i===void 0)&&i.load)o();else{const a=PE("iframefcb");return mn()[a]=()=>{gapi.load?o():t(Zn(n,"network-request-failed"))},bg(`${S2()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw yd=null,e})}let yd=null;function xV(n){return yd=yd||TV(n),yd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV=new uc(5e3,15e3),SV="__/auth/iframe",PV="emulator/auth/iframe",RV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kV(n){const e=n.config;we(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yg(e,PV):`https://${n.config.authDomain}/${SV}`,r={apiKey:e.apiKey,appName:n.name,v:nl},s=CV.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${tl(r).slice(1)}`}async function DV(n){const e=await xV(n),t=mn().gapi;return we(t,n,"internal-error"),e.open({where:document.body,url:kV(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RV,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Zn(n,"network-request-failed"),a=mn().setTimeout(()=>{i(o)},AV.get());function l(){mn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VV=500,OV=600,MV="_blank",LV="http://localhost";class B_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FV(n,e,t,r=VV,s=OV){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},NV),{width:r.toString(),height:s.toString(),top:i,left:o}),c=vn().toLowerCase();t&&(a=wE(c)?MV:t),_E(c)&&(e=e||LV,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[y,T])=>`${g}${y}=${T},`,"");if(v2(c)&&a!=="_self")return $V(e||"",a),new B_(null);const f=window.open(e||"",a,d);we(f,n,"popup-blocked");try{f.focus()}catch{}return new B_(f)}function $V(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV="__/auth/handler",jV="emulator/auth/handler",BV=encodeURIComponent("fac");async function q_(n,e,t,r,s,i){we(n.config.authDomain,n,"auth-domain-config-required"),we(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:nl,eventId:s};if(e instanceof Bs){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",sP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof gl){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),c=l?`#${BV}=${encodeURIComponent(l)}`:"";return`${qV(n)}?${tl(a).slice(1)}${c}`}function qV({config:n}){return n.emulator?yg(n,jV):`https://${n.authDomain}/${UV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f="webStorageSupport";class zV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qE,this._completeRedirectFn=YE,this._overrideRedirectResult=dV}async _openPopup(e,t,r,s){var i;Ns((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await q_(e,t,r,Lu(),s);return FV(e,o,Kh())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await q_(e,t,r,Lu(),s);return VN(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Ns(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await DV(e),r=new gV(e);return t.register("authEvent",s=>(we(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($f,{type:$f},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[$f];o!==void 0&&t(!!o),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=wV(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return AE()||bE()||_g()}}const KV=zV;class eT{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Yr("unexpected MultiFactorSessionType")}}}class Dg extends eT{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Dg(e)}_finalizeEnroll(e,t,r){return AN(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return KN(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class GV{constructor(){}static assertion(e){return Dg._fromCredential(e)}}GV.FACTOR_ID="phone";class HV{static assertionForEnrollment(e,t){return Bu._fromSecret(e,t)}static assertionForSignIn(e,t){return Bu._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const r=e;we(typeof((t=r.user)===null||t===void 0?void 0:t.auth)<"u","internal-error");const s=await SN(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return Ng._fromStartTotpMfaEnrollmentResponse(s,r.user.auth)}}HV.FACTOR_ID="totp";class Bu extends eT{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new Bu(t,void 0,e)}static _fromEnrollmentId(e,t){return new Bu(t,e)}async _finalizeEnroll(e,t,r){return we(typeof this.secret<"u",e,"argument-error"),PN(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){we(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return GN(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class Ng{constructor(e,t,r,s,i,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new Ng(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let s=!1;return(Yc(e)||Yc(t))&&(s=!0),s&&(Yc(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),Yc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Yc(n){return typeof n>"u"||(n==null?void 0:n.length)===0}var z_="@firebase/auth",K_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JV(n){ss(new $r("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:SE(n)},c=new E2(r,s,i,l);return D2(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ss(new $r("auth-internal",e=>{const t=tn(e.getProvider("auth").getImmediate());return(r=>new WV(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Er(z_,K_,QV(n)),Er(z_,K_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=5*60,XV=Ob("authIdTokenMaxAge")||YV;let G_=null;const ZV=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>XV)return;const s=t==null?void 0:t.token;G_!==s&&(G_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function eO(n=fm()){const e=Li(n,"auth");if(e.isInitialized())return e.getImmediate();const t=k2(n,{popupRedirectResolver:KV,persistence:[qN,jE,qE]}),r=Ob("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=ZV(i.toString());IN(t,o,()=>o(t.currentUser)),wN(t,a=>o(a))}}const s=Nb("auth");return s&&N2(t,`http://${s}`),t}function tO(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}T2({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Zn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",tO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JV("Browser");const nO={apiKey:"AIzaSyDCqJRmxKiIzuAhgXsmXICCx_O65aujNa0",authDomain:"impro-selector.firebaseapp.com",projectId:"impro-selector",storageBucket:"impro-selector.appspot.com",messagingSenderId:"730278491306",appId:"1:730278491306:web:c966af1179221e91118cd3",measurementId:"G-3NB062D088"},Wh=Ub(nO),ae=SD(Wh),gt=eO(Wh);try{PD(ae)}catch{}try{bN(gt,jE)}catch{}EN(gt,n=>{n||nN(gt)});async function rO(n,e){try{return(await uN(gt,n,e)).user}catch(t){throw t}}async function tT(n,e){try{return(await cN(gt,n,e)).user}catch(t){throw t}}async function nT(n){try{await oN(gt,n)}catch(e){throw e}}async function sO(n){try{const e=gt.currentUser;if(e)await pN(e,n);else throw new Error("Aucun utilisateur connect")}catch(e){throw e}}const Ii=Object.freeze(Object.defineProperty({__proto__:null,app:Wh,auth:gt,createPlayerAccount:rO,db:ae,resetPlayerPassword:nT,signInPlayer:tT,updatePlayerPassword:sO},Symbol.toStringTag,{value:"Module"})),vl="seasons";async function iO(n,e,t){return await pl(Je(ae,vl),{name:n,slug:e,pinCode:t,createdAt:qi()})}async function oO(n){return await Ya(xe(ae,vl,n))}async function _d(){const n=Mu(Je(ae,vl),OD("createdAt","desc"));return(await wt(n)).docs.map(t=>({id:t.id,...t.data()}))}async function Xd(n,e){const t=await Gt(xe(ae,vl,n));return t.exists()?t.data().pinCode===e:!1}async function Op(n){const e=await Gt(xe(ae,vl,n));return e.exists()?e.data().pinCode:null}async function zl(n,e){const t=xe(ae,vl,n);await fl(t,{sortOrder:e})}const aO=["pin","pinCode","password","motdepasse","mdp","token","oobCode","apiKey","apikey","key","secret","authorization","auth","bearer"];function lO(){var t,r,s,i;const n=((r=(t=import.meta)==null?void 0:t.env)==null?void 0:r.MODE)==="development"?"debug":"warn";return((i=(s=import.meta)==null?void 0:s.env)==null?void 0:i.VITE_LOG_LEVEL)||n}function rT(n){switch(n){case"debug":return 10;case"info":return 20;case"warn":return 30;case"error":return 40;case"silent":return 100;default:return 30}}function uO(n){return typeof n!="string"?n:n.length<=2?"":n.length>=8?`${n.slice(0,2)}${n.slice(-2)}`:""}function sT(n){if(!n)return!1;const e=String(n).toLowerCase();return aO.some(t=>e.includes(t.toLowerCase()))}function Mp(n){if(n==null)return n;if(typeof n=="string"){if(n.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){const[r,s]=n.split("@"),i=r.length<=2?"":`${r.slice(0,2)}`,o=s.split("."),a=o[0].length<=2?"":`${o[0].slice(0,2)}`;return`${i}@${a}.${o.slice(1).join(".")}`}return n.length>=12&&!/\s/.test(n)?uO(n):n}if(typeof n=="number"){const e=String(n);return/^\d{4,6}$/.test(e)?"":n}if(Array.isArray(n))return n.map(e=>Mp(e));if(typeof n=="object"){const e={};for(const[t,r]of Object.entries(n))e[t]=sT(t)?"":Mp(r);return e}return n}function cO(n){const e=[];for(let t=0;t<n.length;t+=1){const r=n[t],s=t>0?n[t-1]:null;if(typeof s=="string"&&sT(s)&&(typeof r=="string"||typeof r=="number")){e.push("");continue}e.push(Mp(r))}return e}const dO=rT(lO());function Xc(n,e){const t=rT(n);return(...r)=>{if(t<dO)return;const s=cO(r);console[e](...s)}}const le={debug:Xc("debug","log"),info:Xc("info","info"),warn:Xc("warn","warn"),error:Xc("error","error")},Vg="lastVisitedSeason",iT="lastVisitedSeasonTimestamp";async function hO(n){if(n)try{const e=gt.currentUser,t=e==null?void 0:e.email;try{localStorage.setItem(Vg,n),localStorage.setItem(iT,Date.now().toString())}catch(r){le.warn("Erreur lors de la sauvegarde localStorage",r)}if(t)try{const r=xe(ae,"userPreferences",t);await Zt(r,{lastVisitedSeason:n,lastVisitedSeasonTimestamp:Date.now()},{merge:!0}),le.debug("Prfrence de saison sauvegarde dans Firebase",{seasonSlug:n,userEmail:t})}catch(r){le.warn("Erreur lors de la sauvegarde Firebase",r)}}catch(e){le.error("Erreur lors de la mmorisation de la saison",e)}}async function fO(){try{const n=gt.currentUser,e=n==null?void 0:n.email;if(e)try{const t=xe(ae,"userPreferences",e),r=await Gt(t);if(r.exists()){const s=r.data();if(s.lastVisitedSeason)return le.debug("Prfrence de saison rcupre depuis Firebase",{seasonSlug:s.lastVisitedSeason}),s.lastVisitedSeason}}catch(t){le.warn("Erreur lors de la rcupration Firebase",t)}try{const t=localStorage.getItem(Vg);if(t)return le.debug("Prfrence de saison rcupre depuis localStorage",{seasonSlug:t}),t}catch(t){le.warn("Erreur lors de la lecture localStorage",t)}return null}catch(n){return le.error("Erreur lors de la rcupration de la dernire saison",n),null}}async function pO(n=null){var e;try{const t=n||((e=gt.currentUser)==null?void 0:e.email);try{localStorage.removeItem(Vg),localStorage.removeItem(iT)}catch(r){le.warn("Erreur lors du nettoyage localStorage",r)}if(t)try{const r=xe(ae,"userPreferences",t);await Zt(r,{lastVisitedSeason:null,lastVisitedSeasonTimestamp:null},{merge:!0}),le.debug("Prfrence de saison nettoye dans Firebase",{userEmail:t})}catch(r){le.warn("Erreur lors du nettoyage Firebase",r)}}catch(t){le.error("Erreur lors du nettoyage des prfrences",t)}}function mO(n,e){return!n||!e||!Array.isArray(e)?!1:e.some(t=>t.slug===n)}const gO={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center"},vO={class:"text-center"},yO={class:"text-white text-lg"},_O={__name:"SeasonResolver",setup(n){const e=Za(),t=k("Chargement...");return Xn(async()=>{try{t.value="Vrification de votre session...",await new Promise(o=>{const a=gt.onAuthStateChanged(l=>{a(),o(l)})});const r=gt.currentUser,s=r==null?void 0:r.email;if(!s){le.info("Utilisateur non connect, redirection vers /seasons"),e.replace("/seasons");return}t.value="Rcupration de vos prfrences...";const i=await fO();if(!i){le.info("Aucune saison mmorise, redirection vers /seasons"),e.replace("/seasons");return}t.value="Vrification de la saison...";try{const o=await _d();if(!mO(i,o)){le.info("Saison mmorise n'existe plus, redirection vers /seasons"),await pO(s),e.replace("/seasons");return}}catch(o){le.error("Erreur lors de la vrification des saisons",o),e.replace("/seasons");return}le.info("Redirection vers la saison mmorise",{seasonSlug:i}),e.replace(`/season/${i}`)}catch(r){le.error("Erreur lors de la rsolution de la saison",r),e.replace("/seasons")}}),(r,s)=>(L(),F("div",gO,[h("div",vO,[s[0]||(s[0]=h("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-4"},null,-1)),h("p",yO,ce(t.value),1)])]))}},Uf=7*24*60*60*1e3,Kl="impro_selector_pin_session";class bO{constructor(){this.sessionData=this.loadSession()}loadSession(){try{const e=localStorage.getItem(Kl);if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<Uf){try{t.timestamp=Date.now(),localStorage.setItem(Kl,JSON.stringify(t))}catch{}return t}else this.clearSession()}}catch{console.error("Erreur lors du chargement de la session PIN")}return null}saveSession(e,t){try{const r={seasonId:e,pinCode:t,timestamp:Date.now()};localStorage.setItem(Kl,JSON.stringify(r)),this.sessionData=r}catch{console.error("Erreur lors de la sauvegarde de la session PIN")}}isPinCached(e){if(!this.sessionData)return!1;const t=this.sessionData.seasonId===e&&this.sessionData.timestamp&&Date.now()-this.sessionData.timestamp<Uf;if(t)try{this.sessionData.timestamp=Date.now(),localStorage.setItem(Kl,JSON.stringify(this.sessionData))}catch{}return t}getCachedPin(e){return this.isPinCached(e)?this.sessionData.pinCode:null}clearSession(){try{localStorage.removeItem(Kl),this.sessionData=null}catch{console.error("Erreur lors de la suppression de la session PIN")}}getTimeRemaining(){if(!this.sessionData||!this.sessionData.timestamp)return 0;const e=Date.now()-this.sessionData.timestamp,t=Uf-e;return Math.max(0,Math.ceil(t/(60*1e3)))}isExpiringSoon(){return this.getTimeRemaining()<=2}}const xn=new bO,wO={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},IO={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},EO={class:"text-center mb-6"},TO={class:"text-gray-300"},xO={key:0,class:"mt-2 p-2 bg-green-900/20 border border-green-500/30 rounded-lg"},AO={class:"text-sm text-green-400"},SO={class:"mb-6"},PO={class:"mb-4"},RO={key:0,class:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-center"},CO={class:"flex justify-end space-x-3"},kO=["disabled"],oT={__name:"PinModal",props:{show:{type:Boolean,default:!1},message:{type:String,default:"Veuillez saisir le code PIN  4 chiffres"},error:{type:String,default:""},sessionInfo:{type:Object,default:null}},emits:["submit","cancel"],setup(n,{emit:e}){const t=n,r=e,s=k(""),i=k(""),o=k(null);At(()=>t.show,d=>{d&&(s.value="",i.value="",pn(()=>{var f;(f=o.value)==null||f.focus()}))});function a(){s.value=s.value.replace(/[^0-9]/g,""),s.value.length>4&&(s.value=s.value.slice(0,4))}function l(){s.value.length===4&&r("submit",s.value)}function c(){r("cancel")}return(d,f)=>n.show?(L(),F("div",wO,[h("div",IO,[h("div",EO,[f[1]||(f[1]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),f[2]||(f[2]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Code d'accs requis",-1)),h("p",TO,ce(n.message),1),n.sessionInfo?(L(),F("div",xO,[h("p",AO," Session active : "+ce(n.sessionInfo.timeRemaining)+" min restantes ",1)])):ve("",!0)]),h("div",SO,[h("div",PO,[f[3]||(f[3]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN",-1)),nt(h("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g),type:"password",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-4 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-center text-2xl font-mono tracking-widest",placeholder:"",onInput:a,onKeydown:[Mn(l,["enter"]),Mn(c,["escape"])],ref_key:"pinInput",ref:o},null,544),[[Dt,s.value]])]),f[4]||(f[4]=h("p",{class:"text-xs text-gray-400 text-center"},"Tapez directement votre code PIN  4 chiffres",-1))]),i.value||t.error?(L(),F("div",RO,ce(i.value||t.error),1)):ve("",!0),h("div",CO,[h("button",{onClick:c,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:l,disabled:s.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Valider ",8,kO)])])])):ve("",!0)}},DO={class:"relative p-6 pb-4 border-b border-white/10"},NO={class:"sticky bottom-0 p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex justify-end"},aT={__name:"AppHelpModal",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=e;return(r,s)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[95] p-0 md:p-4",onClick:s[3]||(s[3]=i=>t("close"))},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:s[2]||(s[2]=Ft(()=>{},["stop"]))},[h("div",DO,[h("button",{onClick:s[0]||(s[0]=i=>t("close")),title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),s[4]||(s[4]=h("div",{class:"flex items-center gap-3"},[h("div",{class:"w-12 h-12 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-2xl"},""),h("div",null,[h("h2",{class:"text-xl md:text-2xl font-bold text-white"},"Kezako ?"),h("p",{class:"text-sm text-purple-300"},"L'appli pour slectionner les joueurs d'impro de manire simple et apaise")])],-1))]),s[5]||(s[5]=Jn('<div class="px-4 md:px-6 py-4 md:py-6 overflow-y-auto space-y-4 text-gray-200"><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-3"><h3 class="text-white font-semibold">C&#39;est quoi ?</h3><p> Tu joues quand ? est une appli conue pour faciliter <span class="text-white">la slection des joueurs d&#39;impro</span> pour les spectacles. L&#39;ide est ne au sein de <span class="text-purple-300">La Malice</span> pour <span class="text-white">dpersonnaliser une tche dlicate</span> qui crait des tensions depuis des annes. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-3"><h3 class="text-white font-semibold">Comment a marche</h3><p> L&#39;asso dclare ses dates et le nombre de personnes ncessaires. Les joueurs indiquent leurs disponibilits. L&#39;appli propose des slections. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Slection auto ou manuelle</h3><p> Le <span class="text-white">mode slection auto</span> s&#39;appuie sur le hasard (pondr) pour simplifier la vie. Vous pouvez aussi repasser en mode <span class="text-white">manuel</span> si besoin. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Pense mobile  Libre d&#39;utilisation</h3><p> L&#39;appli est <span class="text-white">pense pour le mobile</span> et peut tre utilise librement par La Malice ou <span class="text-white">toute autre troupe</span>. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2"><h3 class="text-white font-semibold">Comptes (facultatif)</h3><p> Les joueurs qui le souhaitent peuvent crer un compte via leur email pour <span class="text-white">recevoir des notifications</span>, <span class="text-white">protger leurs saisies</span> et bnficier d&#39;un meilleur confort d&#39;utilisation. </p></div><div class="bg-white/5 border border-white/10 rounded-lg p-4 space-y-2 text-sm"><h3 class="text-white font-semibold">Statut &amp; licence</h3><p> Application <span class="text-white">en cours de dveloppement</span>, <span class="text-white">sans garanties</span>  ce stade. Licence libre <span class="text-white">MIT</span>. </p><p>Contact &amp; retours : <a href="mailto:impropick@gmail.com" class="text-blue-300 underline">impropick@gmail.com</a></p></div></div>',1)),h("div",NO,[h("button",{onClick:s[1]||(s[1]=i=>t("close")),class:"h-10 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600"},"Compris")])])])):ve("",!0)}};let qn="mock",Ei=[{id:"p1",name:"Alice"},{id:"p2",name:"Bob"},{id:"p3",name:"Charlie"},{id:"p4",name:"David"},{id:"p5",name:"Eva"},{id:"p6",name:"Fanny"},{id:"p7",name:"Georges"},{id:"p8",name:"Hlne"},{id:"p9",name:"Ismal"},{id:"p10",name:"Jade"},{id:"p11",name:"Karim"},{id:"p12",name:"La"},{id:"p13",name:"Marc"},{id:"p14",name:"Nina"},{id:"p15",name:"Oscar"}],Oo=[{id:"event1",title:"Aprock Septembre",date:"2025-09-08",description:"Soire apro-rock avec ambiance festive"},{id:"event2",title:"Match  Cambo",date:"2025-11-25",description:"Match d'improvisation comptitif  Cambo-les-Bains"},{id:"event3",title:"Impro des Familles",date:"2025-12-02",description:"Spectacle d'improvisation pour toute la famille"},{id:"event4",title:"Cabaret Surprise",date:"2026-01-20",description:"Cabaret avec des surprises et des performances uniques"},{id:"event5",title:"Impro Plage",date:"2026-03-10",description:"Improvisation en plein air avec vue sur la plage"}];function lT(n){qn=n}async function VO(){if(qn!=="firebase"||!(await wt(Je(ae,"seasons"))).empty)return;const e=xe(Je(ae,"seasons"));await Zt(e,{name:"Malice 2025-2026",slug:"malice-2025-2026",createdAt:qi()});const t=await wt(Je(ae,"players"));for(const o of t.docs)await Zt(xe(e,"players",o.id),o.data());const r=await wt(Je(ae,"events"));for(const o of r.docs)await Zt(xe(e,"events",o.id),o.data());const s=await wt(Je(ae,"availability"));for(const o of s.docs)await Zt(xe(e,"availability",o.id),o.data());const i=await wt(Je(ae,"selections"));for(const o of i.docs)await Zt(xe(e,"selections",o.id),o.data())}async function OO(){qn==="firebase"&&await VO()}async function Lp(n=null){return(qn==="firebase"?n?(await wt(Je(ae,"seasons",n,"events"))).docs.map(t=>({id:t.id,...t.data()})):(await wt(Je(ae,"events"))).docs.map(t=>({id:t.id,...t.data()})):Oo).sort((t,r)=>{const s=c=>{if(!c)return null;if(c instanceof Date)return c;if(typeof(c==null?void 0:c.toDate)=="function")return c.toDate();const d=new Date(c);return isNaN(d.getTime())?null:d},i=s(t.date),o=s(r.date),a=i?i.getTime():Number.POSITIVE_INFINITY,l=o?o.getTime():Number.POSITIVE_INFINITY;return a!==l?a-l:(t.title||"").localeCompare(r.title||"","fr",{sensitivity:"base"})})}async function bd(n=null){return(qn==="firebase"?n?(await wt(Je(ae,"seasons",n,"players"))).docs.map(t=>({id:t.id,...t.data()})):(await wt(Je(ae,"players"))).docs.map(t=>({id:t.id,...t.data()})):Ei).sort((t,r)=>t.order<r.order?-1:t.order>r.order?1:t.name.localeCompare(r.name))}async function uT(n,e=null){if(qn==="firebase"){const t=xe(e?Je(ae,"seasons",e,"players"):Je(ae,"players"));return await Zt(t,{name:n}),t.id}else{const t=`p${Ei.length+1}`;return Ei.push({id:t,name:n}),t}}async function MO(n,e=null){if(qn==="firebase"){const t=e?xe(ae,"seasons",e,"players",n):xe(ae,"players",n);await Ya(t);const r=e?await wt(Je(ae,"seasons",e,"availability")):await wt(Je(ae,"availability")),s=hg(ae);r.forEach(i=>{const o=i.data();if(o[n]!==void 0){const a={...o};delete a[n],s.update(i.ref,a)}}),await s.commit()}else Ei=Ei.filter(t=>t.id!==n)}async function LO(n,e,t=null){if(qn==="firebase"){const r=t?xe(ae,"seasons",t,"players",n):xe(ae,"players",n),s=await Gt(r),i=s.exists()&&s.data().name||null;if(await Zt(r,{name:e},{merge:!0}),i&&i!==e){const o=hg(ae);try{const a=t?xe(ae,"seasons",t,"availability",i):xe(ae,"availability",i),l=await Gt(a);if(l.exists()){const c=l.data()||{},d=t?xe(ae,"seasons",t,"availability",e):xe(ae,"availability",e);o.set(d,c,{merge:!0}),o.delete(a)}}catch{}try{const a=t?Je(ae,"seasons",t,"selections"):Je(ae,"selections");(await wt(a)).forEach(c=>{var f;const d=Array.isArray((f=c.data())==null?void 0:f.players)?c.data().players:[];if(d.includes(i)){const g=d.map(y=>y===i?e:y);o.update(c.ref,{players:g})}})}catch{}await o.commit()}}else{const r=Ei.findIndex(s=>s.id===n);r!==-1&&(Ei[r]={...Ei[r],name:e})}}async function ho(n,e,t=null){if(qn==="firebase"){const r=t?await wt(Je(ae,"seasons",t,"availability")):await wt(Je(ae,"availability")),s={};return r.forEach(i=>{s[i.id]=i.data()}),s}else{const r={};return n.forEach(s=>{r[s.name]={},e.forEach(i=>{r[s.name][i.id]=void 0})}),e.forEach(s=>{const i=[...n].sort(()=>.5-Math.random());i.slice(0,4).forEach(o=>{r[o.name][s.id]=!0}),i.slice(4).forEach(o=>{const a=Math.random();r[o.name][s.id]=a<.4?!0:a<.8?!1:void 0})}),r}}async function fo(n=null){if(qn==="firebase"){const e=n?await wt(Je(ae,"seasons",n,"selections")):await wt(Je(ae,"selections")),t={};return e.forEach(r=>{t[r.id]=r.data().players||[]}),t}else return{}}async function H_(n,e,t=null){if(qn==="firebase"){const r=t?xe(ae,"seasons",t,"availability",n):xe(ae,"availability",n);await Zt(r,e)}}async function FO({seasonId:n,playerName:e,eventId:t,value:r}){if(qn!=="firebase")return;const s=n?xe(ae,"seasons",n,"availability",e):xe(ae,"availability",e),i=await Gt(s),a={...i.exists()?i.data():{}};r===void 0?delete a[t]:a[t]=r,await Zt(s,a)}async function W_(n,e,t=null){if(qn==="firebase"){const r=t?xe(ae,"seasons",t,"selections",n):xe(ae,"selections",n);await Zt(r,{players:e})}}async function $O(n,e=null){if(le.info("Suppression de l'vnement",{eventId:n}),qn==="firebase")try{le.debug("Suppression de l'vnement dans Firestore");const t=e?xe(ae,"seasons",e,"events",n):xe(ae,"events",n);await Ya(t),le.debug("Suppression de la slection associe");const r=e?xe(ae,"seasons",e,"selections",n):xe(ae,"selections",n);await Ya(r),le.debug("Suppression des disponibilits");const s=e?await wt(Je(ae,"seasons",e,"availability")):await wt(Je(ae,"availability")),i=hg(ae);s.forEach(o=>{const a=o.data();if(a[n]!==void 0){le.debug("Mise  jour de la disponibilit pour un joueur");const l={...a};delete l[n],i.update(o.ref,l)}}),await i.commit(),le.info("Oprations de suppression termines avec succs")}catch(t){throw le.error("Erreur lors de la suppression",t),t}else Oo=Oo.filter(t=>t.id!==n)}async function UO(n,e=null){if(qn==="firebase"){const t=xe(e?Je(ae,"seasons",e,"events"):Je(ae,"events"));return await Zt(t,n),t.id}else{const t=`event${Oo.length+1}`;return Oo.push({id:t,...n}),t}}async function Q_(n,e,t=null){if(qn==="firebase"){const r=t?xe(ae,"seasons",t,"events",n):xe(ae,"events",n);await Zt(r,e,{merge:!0})}else{const r=Oo.findIndex(s=>s.id===n);r!==-1&&(Oo[r]={id:n,...e})}}const jO={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},BO={class:"text-center py-16 px-4 relative"},qO=["aria-busy"],zO={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto animate-pulse"},KO={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 max-w-7xl mx-auto"},GO=["onClick"],HO={class:"text-2xl font-bold text-white mb-4 group-hover:text-purple-300 transition-colors"},WO={class:"absolute top-4 right-4"},QO=["onClick","aria-expanded"],JO={key:0,class:"absolute right-0 mt-2 w-44 bg-gray-900 border border-white/10 rounded-lg shadow-xl py-1 z-10",role:"menu"},YO=["onClick"],XO=["onClick"],ZO=["onClick"],eM=["onClick"],tM={key:2,class:"flex justify-center mt-12"},nM={key:3,class:"text-center py-16"},rM={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},sM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},iM={class:"mb-6"},oM={class:"mb-6"},aM={class:"mb-6"},lM={class:"flex justify-end space-x-3"},uM=["disabled"],cM={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},dM={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},hM={class:"text-center mb-6"},fM={class:"text-gray-300"},pM={__name:"Seasons",setup(n){const e=k([]),t=k(!0),r=Za(),s=k(null),i=k(!1),o=k(!1),a=k(""),l=k(""),c=k(""),d=k(null),f=k(!1),g=k(null),y=k(""),T=k(!1);Xn(async()=>{var D;try{e.value=await _d(),le.info("Saisons charges",{count:((D=e.value)==null?void 0:D.length)||0}),M().catch($=>le.error("Migration sortOrder choue",$))}finally{t.value=!1}});const A=Oe(()=>[...e.value].sort((D,$)=>{var E,S;const X=typeof D.sortOrder=="number"?D.sortOrder:Number.MAX_SAFE_INTEGER,se=typeof $.sortOrder=="number"?$.sortOrder:Number.MAX_SAFE_INTEGER;if(X!==se)return X-se;const ke=(E=D.createdAt)!=null&&E.toMillis?D.createdAt.toMillis():0,$e=(S=$.createdAt)!=null&&S.toMillis?$.createdAt.toMillis():0;return ke!==$e?$e-ke:(D.name||"").localeCompare($.name||"")}));function P(D){r.push(`/season/${D}`)}function U(D){s.value=s.value===D?null:D}function q(){s.value=null}async function M(){if(!e.value.length)return;const D=e.value.map(X=>typeof X.sortOrder=="number"?X.sortOrder:null).filter(X=>X!==null);let $=D.length?Math.max(...D):0;for(const X of e.value)if(typeof X.sortOrder!="number"){$+=1;try{await zl(X.id,$),X.sortOrder=$}catch(se){le.error("Erreur migration sortOrder",{seasonName:X==null?void 0:X.name,error:se})}}}async function z(D){try{if(!(D!=null&&D.id)){alert("Saison introuvable");return}const[$,X]=await Promise.all([Lp(D.id),bd(D.id)]),[se,ke]=await Promise.all([ho(X,$,D.id),fo(D.id)]),$e=["Joueur",...$.map(ye=>me(ye))],E=[];for(const ye of X){const _e=(ye==null?void 0:ye.name)||"",pe=(se==null?void 0:se[_e])||{},Se=[_e,...$.map(Te=>V(pe[Te.id],ke==null?void 0:ke[Te.id],_e))];E.push(Se)}const S=I([$e,...E]),O=new Blob(["\uFEFF"+S],{type:"text/csv;charset=utf-8;"}),oe=(D==null?void 0:D.name)||(D==null?void 0:D.slug)||"saison",Z=`${C(oe)}-disponibilites.csv`,ue=URL.createObjectURL(O),be=document.createElement("a");be.href=ue,be.download=Z,document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(ue),le.info("Export CSV saison",{seasonId:D.id,events:$.length,players:X.length})}catch($){le.error("Erreur export CSV",$),alert("Erreur lors de l'export CSV. Veuillez ressayer.")}}function fe(D){if(!D)return null;if(D instanceof Date)return D;if(typeof(D==null?void 0:D.toDate)=="function")return D.toDate();if(typeof D=="string"||typeof D=="number"){const $=new Date(D);return isNaN($.getTime())?null:$}return null}function me(D){const $=fe(D==null?void 0:D.date),X=$?`${$.getFullYear()}-${String($.getMonth()+1).padStart(2,"0")}-${String($.getDate()).padStart(2,"0")}`:"",se=(D==null?void 0:D.title)||"Sans titre";return`${X}  ${se}`.trim()}function x(D){return D===!0||D==="oui"?"disponible":D===!1||D==="non"?"non disponible":""}function I(D){return D.map($=>$.map(w).join(",")).join(`
`)}function w(D){const $=String(D??"");return/[",\n\r]/.test($)?'"'+$.replace(/"/g,'""')+'"':$}function C(D){return String(D||"").normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\-_. ]+/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$|^\.+|\.+$/g,"")||"fichier"}function V(D,$,X){return Array.isArray($)&&$.includes(X)?D===!1||D==="non"?"non disponible":"slectionn":x(D)}async function B(D){if(q(),D<=0)return;const $=[...A.value],X=$[D],se=$[D-1],ke=X.sortOrder;X.sortOrder=se.sortOrder,se.sortOrder=ke;try{await Promise.all([zl(X.id,X.sortOrder),zl(se.id,se.sortOrder)])}catch($e){le.error("Erreur lors du dplacement vers le haut",$e)}}async function R(D){q();const $=[...A.value];if(D>=$.length-1)return;const X=$[D],se=$[D+1],ke=X.sortOrder;X.sortOrder=se.sortOrder,se.sortOrder=ke;try{await Promise.all([zl(X.id,X.sortOrder),zl(se.id,se.sortOrder)])}catch($e){le.error("Erreur lors du dplacement vers le bas",$e)}}function It(){a.value&&(l.value=a.value.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}function vt(){c.value=c.value.replace(/[^0-9]/g,""),c.value.length>4&&(c.value=c.value.slice(0,4))}async function Y(){if(!a.value.trim()||!l.value.trim()||!c.value.trim()){alert("Veuillez remplir tous les champs, y compris le code PIN  4 chiffres");return}if(c.value.length!==4){alert("Le code PIN doit contenir exactement 4 chiffres");return}try{await iO(a.value.trim(),l.value.trim(),c.value.trim()),e.value=await _d(),await M(),j()}catch(D){le.error("Erreur lors de la cration de la saison",D),alert("Erreur lors de la cration de la saison. Veuillez ressayer.")}}function j(){i.value=!1,a.value="",l.value="",c.value=""}function ne(D){d.value=D,o.value=!0}async function Ke(){o.value=!1,await re({type:"deleteSeason",data:{seasonId:d.value.id,seasonName:d.value.name}})}function Be(){o.value=!1,d.value=null}function Ge(){return g.value?{deleteSeason:"Suppression de saison - Code PIN requis"}[g.value.type]||"Code PIN requis":"Veuillez saisir le code PIN  4 chiffres"}async function re(D){if(xn.isPinCached(d.value.id)){const $=xn.getCachedPin(d.value.id);if(le.debug("PIN en cache trouv, utilisation automatique"),await Xd(d.value.id,$)){await ht(D);return}else xn.clearSession()}g.value=D,f.value=!0}async function ee(D){var $,X,se,ke;le.debug("PIN soumis pour l'opration",{operationType:($=g.value)==null?void 0:$.type});try{const $e=((se=(X=g.value)==null?void 0:X.data)==null?void 0:se.seasonId)||((ke=d.value)==null?void 0:ke.id),E=await Xd($e,D);if(le.debug("PIN valid",{valid:E}),E){xn.saveSession($e,D),le.debug("PIN correct, fermeture de la modal et excution de l'opration"),f.value=!1;const S=g.value;g.value=null,le.debug("Appel de executePendingOperation",{operationType:S==null?void 0:S.type}),await ht(S)}else y.value="Code PIN incorrect",setTimeout(()=>{y.value=""},3e3)}catch($e){le.error("Erreur lors de la vrification du PIN",$e),y.value="Erreur lors de la vrification du code PIN"}}function je(){f.value=!1,g.value=null,y.value=""}function Xe(){return d.value&&xn.isPinCached(d.value.id)?{timeRemaining:xn.getTimeRemaining(),isExpiringSoon:xn.isExpiringSoon()}:null}async function ht(D){var se;if(le.debug("executePendingOperation appel",{hasOperation:!!D}),!D){le.warn("Aucune opration  excuter");return}const{type:$,data:X}=D;le.info("Excution de l'opration",{type:$});try{switch($){case"deleteSeason":le.info("Suppression de la saison",{seasonId:X.seasonId}),await oO(X.seasonId),le.info("Saison supprime, rechargement de la liste"),e.value=await _d(),le.info("Liste des saisons recharge",{count:((se=e.value)==null?void 0:se.length)||0});break;default:le.warn("Type d'opration non reconnu",{type:$})}}catch(ke){le.error("Erreur lors de l'excution de l'opration",ke),alert("Erreur lors de l'opration. Veuillez ressayer.")}}return(D,$)=>{var X;return L(),F("div",jO,[h("div",BO,[h("button",{onClick:$[0]||($[0]=se=>T.value=!0),class:"absolute right-4 top-4 text-white/90 hover:text-white p-2 rounded-full hover:bg-white/10",title:"Kezako ?","aria-label":"Kezako ?"},$[8]||($[8]=[h("span",{class:"text-2xl"},"",-1)])),$[9]||($[9]=h("h1",{class:"text-6xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent animate-pulse"}," Tu joues quand ? ",-1)),$[10]||($[10]=h("p",{class:"text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed"},"Arrtez de vous prendre la tte pour savoir qui sera sur scne quand. Laissez chacun indiquer ses dispos et le hasard choisir pour vous !",-1))]),h("div",{class:"container mx-auto px-4 pb-16","aria-busy":t.value},[t.value?(L(),F("div",zO,[(L(),F(dt,null,wr(8,se=>h("div",{key:"skeleton-"+se,class:"bg-gradient-to-br from-white/10 to-white/5 border border-white/10 rounded-2xl p-8"},$[11]||($[11]=[h("div",{class:"w-16 h-16 bg-white/10 rounded-full mx-auto mb-6"},null,-1),h("div",{class:"h-6 bg-white/10 rounded mb-4 w-2/3 mx-auto"},null,-1),h("div",{class:"h-px bg-white/10 mb-4"},null,-1),h("div",{class:"h-4 bg-white/10 rounded w-1/2 mx-auto"},null,-1)]))),64))])):e.value.length>0?(L(),F("div",KO,[(L(!0),F(dt,null,wr(A.value,(se,ke)=>(L(),F("div",{key:se.id,class:"group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm border border-white/20 rounded-2xl p-8 transition-all duration-300 hover:shadow-2xl hover:shadow-purple-500/20"},[h("div",{onClick:$e=>P(se.slug),class:"text-center cursor-pointer"},[$[12]||($[12]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg"},[h("span",{class:"text-2xl"},"")],-1)),h("h2",HO,ce(se.name),1),$[13]||($[13]=h("div",{class:"w-full bg-gradient-to-r from-transparent via-white/20 to-transparent h-px mb-4"},null,-1)),$[14]||($[14]=h("p",{class:"text-gray-300 text-sm"}," Cliquez pour accder ",-1))],8,GO),h("div",WO,[h("div",{class:"relative",onClick:$[1]||($[1]=Ft(()=>{},["stop"]))},[h("button",{onClick:$e=>U(ke),class:"p-1 rounded-full text-gray-300 hover:text-white hover:bg-white/10","aria-expanded":s.value===ke,"aria-haspopup":"true",title:"Options"},$[15]||($[15]=[h("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.75a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0 7.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"})],-1)]),8,QO),s.value===ke?(L(),F("div",JO,[h("button",{onClick:$e=>{z(se),q()},class:"w-full text-left px-4 py-2 text-sm text-emerald-300 hover:bg-white/10",role:"menuitem"}," Exporter CSV ",8,YO),$[16]||($[16]=h("div",{class:"border-t border-white/10 my-1"},null,-1)),h("button",{onClick:$e=>B(ke),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Monter ",8,XO),h("button",{onClick:$e=>R(ke),class:"w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-white/10",role:"menuitem"}," Descendre ",8,ZO),$[17]||($[17]=h("div",{class:"border-t border-white/10 my-1"},null,-1)),h("button",{onClick:$e=>ne(se),class:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-red-500/10",role:"menuitem"}," Supprimer ",8,eM)])):ve("",!0)])])]))),128))])):ve("",!0),!t.value&&e.value.length>0?(L(),F("div",tM,[h("button",{onClick:$[2]||($[2]=se=>i.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-2xl hover:shadow-pink-500/25 transition-all duration-300 transform hover:scale-105"},"  Nouvelle saison ")])):ve("",!0),!t.value&&e.value.length===0?(L(),F("div",nM,[$[18]||($[18]=h("div",{class:"w-24 h-24 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[h("span",{class:"text-4xl"},"")],-1)),$[19]||($[19]=h("h3",{class:"text-2xl font-bold text-white mb-4"},"Aucune saison cre",-1)),$[20]||($[20]=h("p",{class:"text-gray-300 mb-8"},"Commencez par crer votre premire saison de spectacles !",-1)),h("button",{onClick:$[3]||($[3]=se=>i.value=!0),class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-xl hover:shadow-pink-500/25 transition-all duration-300"}," Crer ma premire saison ")])):ve("",!0)],8,qO),i.value?(L(),F("div",rM,[h("div",sM,[$[25]||($[25]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Nouvelle saison",-1)),h("div",iM,[$[21]||($[21]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom de la saison",-1)),nt(h("input",{"onUpdate:modelValue":$[4]||($[4]=se=>a.value=se),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: La Malice 2025-2026",onInput:It},null,544),[[Dt,a.value]])]),h("div",oM,[$[22]||($[22]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Slug (URL)",-1)),nt(h("input",{"onUpdate:modelValue":$[5]||($[5]=se=>l.value=se),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: malice-2025-2026"},null,512),[[Dt,l.value]])]),h("div",aM,[$[23]||($[23]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Code PIN (4 chiffres)",-1)),nt(h("input",{"onUpdate:modelValue":$[6]||($[6]=se=>c.value=se),type:"text",inputmode:"numeric",maxlength:"4",pattern:"[0-9]{4}",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"1234",onInput:vt},null,544),[[Dt,c.value]]),$[24]||($[24]=h("p",{class:"text-xs text-gray-400 mt-1"},"Ce code protgera les oprations sensibles (suppressions, slections)",-1))]),h("div",lM,[h("button",{onClick:j,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Y,disabled:!a.value.trim()||!l.value.trim()||!c.value.trim()||c.value.length!==4,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Crer ",8,uM)])])])):ve("",!0),o.value?(L(),F("div",cM,[h("div",dM,[h("div",hM,[$[26]||($[26]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),$[27]||($[27]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Confirmation",-1)),h("p",fM,'tes-vous sr de vouloir supprimer la saison "'+ce((X=d.value)==null?void 0:X.name)+'" ?',1)]),$[28]||($[28]=h("p",{class:"mb-6 text-sm text-red-400 bg-red-900/20 p-3 rounded-lg border border-red-500/20"},"  Cette action est irrversible et supprimera toutes les donnes de cette saison. ",-1)),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:Be,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Ke,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):ve("",!0),ct(oT,{show:f.value,message:Ge(),error:y.value,"session-info":Xe(),onSubmit:ee,onCancel:je},null,8,["show","message","error","session-info"]),ct(aT,{show:T.value,onClose:$[7]||($[7]=se=>T.value=!1)},null,8,["show"]),$[29]||($[29]=Jn('<footer class="mt-16 border-t border-white/10"><div class="container mx-auto px-4 py-6 text-center text-xs text-gray-400"><span> Patrice Lamarque 2025</span><span class="mx-2"></span><span>Licence MIT</span><span class="mx-2"></span><a href="https://github.com/plamarque/impro-selector" target="_blank" rel="noopener noreferrer" class="underline decoration-white/20 hover:decoration-white/40 hover:text-gray-200">GitHub</a></div></footer>',1))])}}},Qh="magicLinks";function Jh({seasonId:n,playerId:e,eventId:t,action:r}){return`${n}__${e}__${t}__${r}`}function Og(n=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let r=0;r<n;r++)t+=e[Math.floor(Math.random()*e.length)];return t}async function Fp({seasonId:n,playerId:e,eventId:t,action:r}){const s=Jh({seasonId:n,playerId:e,eventId:t,action:r}),i=Og(40),o=xe(ae,Qh,s),a=Date.now()+1e3*60*60*24*7;await Zt(o,{seasonId:n,playerId:e,eventId:t,token:i,action:r,expiresAt:a});const c=`${window.location.origin+"/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&eid=${encodeURIComponent(t)}&t=${encodeURIComponent(i)}&a=${encodeURIComponent(r)}`;return{id:s,token:i,url:c}}async function cT({seasonId:n,playerId:e,email:t}){const r="protection",s="verify_email",i=Jh({seasonId:n,playerId:e,eventId:r,action:s}),o=Og(40),a=xe(ae,Qh,i),l=Date.now()+1e3*60*60*24*7;await Zt(a,{seasonId:n,playerId:e,eventId:r,token:o,action:s,email:t,expiresAt:l});const d=`${window.location.origin+"/"}magic?sid=${encodeURIComponent(n)}&pid=${encodeURIComponent(e)}&t=${encodeURIComponent(o)}&a=${encodeURIComponent(s)}`;return{id:i,token:o,url:d}}async function dT({seasonId:n,playerId:e,eventId:t,token:r,action:s}){const i=Jh({seasonId:n,playerId:e,eventId:t,action:s}),o=xe(ae,Qh,i),a=await Gt(o);if(!a.exists())return{valid:!1,reason:"not_found"};const l=a.data();return l.token!==r?{valid:!1,reason:"token_mismatch"}:l.action!==s?{valid:!1,reason:"action_mismatch"}:typeof l.expiresAt=="number"&&Date.now()>l.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:l}}async function $p({seasonId:n,playerId:e,eventId:t,action:r}){const s=Jh({seasonId:n,playerId:e,eventId:t,action:r}),i=xe(ae,Qh,s);await Ya(i)}const Mg="accountMagicLinks";function Yh(n){return`account__${n}`}async function hT({currentEmail:n,newEmail:e}){const t=Og(40),r=Yh(t),s=xe(ae,Mg,r),i=Date.now()+1e3*60*60*24*7;await Zt(s,{token:t,currentEmail:n,newEmail:e,action:"account_email_update",expiresAt:i});const a=`${window.location.origin+"/"}magic?a=account_email_update&t=${encodeURIComponent(t)}`;return{id:r,token:t,url:a}}async function fT({token:n}){const e=Yh(n),t=xe(ae,Mg,e),r=await Gt(t);if(!r.exists())return{valid:!1,reason:"not_found"};const s=r.data();return s.token!==n?{valid:!1,reason:"token_mismatch"}:typeof s.expiresAt=="number"&&Date.now()>s.expiresAt?{valid:!1,reason:"expired"}:{valid:!0,data:s}}async function pT({token:n}){const e=Yh(n),t=xe(ae,Mg,e);await Ya(t)}const mM=Object.freeze(Object.defineProperty({__proto__:null,buildAccountId:Yh,consumeAccountEmailUpdateLink:pT,consumeMagicLink:$p,createAccountEmailUpdateLink:hT,createEmailVerificationLink:cT,createMagicLink:Fp,verifyAccountEmailUpdateLink:fT,verifyMagicLink:dT},Symbol.toStringTag,{value:"Module"})),J_="impro_selector_trusted_players",Y_=180*24*60*60*1e3;class gM{constructor(){this.trustedMap=this.load()}load(){try{const e=localStorage.getItem(J_);if(!e)return{};const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}}persist(){try{localStorage.setItem(J_,JSON.stringify(this.trustedMap))}catch{}}isPasswordCached(e){if(!e)return!1;const t=this.trustedMap[e];if(!t)return!1;const r=Date.now(),s=r-t<Y_;return s?(this.trustedMap[e]=r,this.persist()):(delete this.trustedMap[e],this.persist()),s}getCachedPassword(e){return null}saveSession(e,t){e&&(this.trustedMap[e]=Date.now(),this.persist())}clearSession(e){e&&(delete this.trustedMap[e],this.persist())}clearExpiredSessions(){const e=Date.now();let t=!1;for(const[r,s]of Object.entries(this.trustedMap))e-s>Y_&&(delete this.trustedMap[r],t=!0);t&&this.persist()}clearAllSessions(){this.trustedMap={},this.persist()}}const Oi=new gM;function Lg(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return e.toString()}function mT(n){return`seasonPreferredPlayer:${n||"global"}`}function Up(n,e){try{const t=mT(n),r=localStorage.getItem(t);if(!r){localStorage.setItem(t,JSON.stringify([e]));return}if(r.startsWith("[")){const s=JSON.parse(r);s.includes(e)||(s.push(e),localStorage.setItem(t,JSON.stringify(s)))}else r!==e&&localStorage.setItem(t,JSON.stringify([r,e]))}catch{}}function vM(n,e){try{const t=mT(n),r=localStorage.getItem(t);if(!r)return;if(r.startsWith("[")){const s=JSON.parse(r).filter(i=>i!==e);s.length===0?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(s))}else r===e&&localStorage.removeItem(t)}catch{}}async function gT(n,e,t,r=null){try{le.info("Dbut protectPlayer",{playerId:n,seasonId:r});const s=await yl(n,r);if(s&&s.isProtected)throw new Error("Ce joueur est dj protg");const{collection:i,query:o,where:a,getDocs:l}=await Xt(()=>import("./index.esm-10fc9d63.js"),[]),{db:c}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0),d=r?i(c,"seasons",r,"playerProtection"):i(c,"playerProtection"),f=o(d,a("email","==",e)),g=await l(f);if(!g.empty&&g.docs.find(M=>M.id!==n))throw new Error("Cette adresse email est dj utilise par un autre joueur");le.debug("Cration du compte Firebase Auth...");const{createUserWithEmailAndPassword:y}=await Xt(()=>import("./index.esm-cd268918.js"),[]),{auth:T}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0),A=await y(T,e,t);le.info("Compte Firebase Auth cr",{uid:A.user.uid});const P=Lg(t),U=r?xe(c,"seasons",r,"playerProtection",n):xe(c,"playerProtection",n);return await Zt(U,{playerId:n,email:e,passwordHash:P,firebaseUid:A.user.uid,isProtected:!0,createdAt:new Date}),le.info("Protection sauvegarde dans Firestore"),r&&Up(r,n),{success:!0}}catch(s){throw le.error("Erreur lors de la protection du joueur",s),s}}async function vT({playerId:n,email:e,seasonId:t=null}){const r=t?xe(ae,"seasons",t,"playerProtection",n):xe(ae,"playerProtection",n);(await Gt(r)).exists()?await fl(r,{email:e,updatedAt:new Date}):await Zt(r,{playerId:n,email:e,isProtected:!1,createdAt:new Date});const{url:i}=await cT({seasonId:t,playerId:n,email:e});return{success:!0,url:i}}async function yT({playerId:n,seasonId:e=null}){const t=e?xe(ae,"seasons",e,"playerProtection",n):xe(ae,"playerProtection",n);if(!(await Gt(t)).exists())throw new Error("Protection introuvable");return await fl(t,{emailVerifiedAt:new Date}),{success:!0}}async function _T({playerId:n,seasonId:e=null}){const t=e?xe(ae,"seasons",e,"playerProtection",n):xe(ae,"playerProtection",n);return await fl(t,{emailVerifiedAt:null}),{success:!0}}async function bT(n,e=null){try{const t=e?xe(ae,"seasons",e,"playerProtection",n):xe(ae,"playerProtection",n);return await Zt(t,{playerId:n,email:"",isProtected:!1,emailVerifiedAt:null,updatedAt:new Date}),e&&vM(e,n),{success:!0,email:""}}catch(t){throw le.error("Erreur lors de la suppression de la protection",t),t}}async function Ti(n,e=null){try{const t=e?xe(ae,"seasons",e,"playerProtection",n):xe(ae,"playerProtection",n),r=await Gt(t);return r.exists()?r.data().isProtected===!0:!1}catch(t){return le.error("Erreur lors de la vrification de protection",t),!1}}async function yl(n,e=null){try{const t=e?xe(ae,"seasons",e,"playerProtection",n):xe(ae,"playerProtection",n),r=await Gt(t);return r.exists()?r.data():null}catch(t){return le.error("Erreur lors de la rcupration des donnes de protection",t),null}}async function wT(n,e=null){try{const t=await yl(n,e);return(t==null?void 0:t.email)||""}catch(t){return le.error("Erreur lors de la rcupration de l'email",t),""}}async function jp(n=null){try{const e=n?Je(ae,"seasons",n,"playerProtection"):Je(ae,"playerProtection");return(await wt(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return le.error("Erreur lors du chargement des protections",e),[]}}async function Fg(n){try{const e=[],t=Mu(Je(ae,"playerProtection"),Hd("email","==",n));(await wt(t)).forEach(i=>{const o=i.data();o!=null&&o.isProtected&&e.push({seasonId:null,playerId:i.id,...o})});const s=await wt(Je(ae,"seasons"));for(const i of s.docs){const o=i.id,a=Mu(Je(ae,"seasons",o,"playerProtection"),Hd("email","==",n));(await wt(a)).forEach(c=>{var f;const d=c.data();d!=null&&d.isProtected&&e.push({seasonId:o,seasonName:(f=i.data())==null?void 0:f.name,playerId:c.id,...d})})}return e}catch(e){return le.error("Erreur listAssociationsForEmail",e),[]}}async function IT(n,e,t=null){try{const r=await yl(n,t);if(!r||!r.isProtected)return!1;if(r.email){le.debug("Vrification avec Firebase Auth");try{const{signInWithEmailAndPassword:s}=await Xt(()=>import("./index.esm-cd268918.js"),[]),{auth:i}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0);return await s(i,r.email,e),le.debug("Mot de passe Firebase Auth valide"),Oi.saveSession(n),t&&Up(t,n),!0}catch(s){return le.debug("Mot de passe Firebase Auth invalide",{code:s.code}),!1}}else{le.debug("Vrification avec hash local");const s=Lg(e),i=r.passwordHash===s;return i&&(Oi.saveSession(n),t&&Up(t,n)),i}}catch(r){return le.error("Erreur lors de la vrification du mot de passe",r),!1}}async function ET({playerId:n,seasonId:e=null}){const t=e?xe(ae,"seasons",e,"playerProtection",n):xe(ae,"playerProtection",n),r=await Gt(t);if(!r.exists())throw new Error("Protection introuvable");const s=r.data();if(s!=null&&s.email)return await fl(t,{isProtected:!0,updatedAt:new Date}),{success:!0};throw new Error("Email non dfini pour cette protection")}function xo(n){return Oi.isPasswordCached(n)}function yM(n){return null}async function TT(n,e=null){try{le.info("Dbut sendPasswordResetEmail",{playerId:n,seasonId:e});const t=await yl(n,e);if(le.debug("Protection data disponible"),!t||!t.isProtected)throw new Error("Joueur non protg");if(le.debug("Email  utiliser (masqu)"),t.firebaseUid){le.debug("Utilisation du compte Firebase Auth existant");const{sendPasswordResetEmail:r}=await Xt(()=>import("./index.esm-cd268918.js"),[]),{auth:s}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0);le.debug("Tentative d'envoi d'email"),await r(s,t.email),le.info("Email envoy avec succs via Firebase Auth")}else{le.debug("Pas de compte Firebase Auth, cration temporaire...");const{createUserWithEmailAndPassword:r,sendPasswordResetEmail:s}=await Xt(()=>import("./index.esm-cd268918.js"),[]),{auth:i}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0),o=Math.random().toString(36).slice(-8)+"A1!";try{const a=await r(i,t.email,o);le.info("Compte temporaire cr",{uid:a.user.uid}),await s(i,t.email),le.info("Email envoy avec succs");const{updateDoc:l}=await Xt(()=>import("./index.esm-10fc9d63.js"),[]),{db:c}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0),d=e?xe(c,"seasons",e,"playerProtection",n):xe(c,"playerProtection",n);await l(d,{firebaseUid:a.user.uid})}catch(a){if(a.code==="auth/email-already-in-use")le.debug("Email dj utilis, tentative d'envoi direct..."),await s(i,t.email),le.info("Email envoy avec succs");else throw a}}return{success:!0,message:"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}}catch(t){throw le.error("Erreur lors de l'envoi de l'email de rinitialisation",{error:t}),t.code==="auth/user-not-found"?new Error("Aucun compte trouv avec cette adresse email"):t.code==="auth/too-many-requests"?new Error("Trop de tentatives. Veuillez ressayer plus tard"):t.code==="auth/invalid-email"?new Error("Adresse email invalide"):new Error(`Erreur lors de l'envoi de l'email: ${t.message}`)}}async function _M(n,e,t=null){try{const r=Lg(e),s=t?xe(ae,"seasons",t,"playerProtection",n):xe(ae,"playerProtection",n);return await fl(s,{passwordHash:r,updatedAt:new Date}),{success:!0}}catch(r){throw le.error("Erreur lors de la mise  jour du mot de passe",r),r}}async function bM(n){return new Promise((e,t)=>{le.debug("Demande de mot de passe pour disponibilit"),t(new Error("Gestion de mot de passe  implmenter ct composant"))})}const mc=Object.freeze(Object.defineProperty({__proto__:null,clearEmailVerificationForProtection:_T,finalizeProtectionAfterVerification:ET,getCachedPlayerPassword:yM,getPlayerEmail:wT,getPlayerProtectionData:yl,isPlayerPasswordCached:xo,isPlayerProtected:Ti,listAssociationsForEmail:Fg,listProtectedPlayers:jp,markEmailVerifiedForProtection:yT,protectPlayer:gT,requirePlayerPasswordForAvailability:bM,sendPasswordResetEmail:TT,startEmailVerificationForProtection:vT,unprotectPlayer:bT,updatePlayerPasswordInFirestore:_M,verifyPlayerPassword:IT},Symbol.toStringTag,{value:"Module"}));async function gc({toEmail:n,title:e,body:t,data:r={},reason:s="generic"}){if(!n)return{success:!1,error:"missing_toEmail"};const i={to:n,title:e,body:t,data:r,reason:s,createdAt:qi()};return await pl(Je(ae,"pushQueue"),i),{success:!0}}async function wM({toEmail:n,playerName:e,eventTitle:t,eventDate:r,yesUrl:s,noUrl:i,eventUrl:o=void 0,reason:a="new_event",fromEmail:l=void 0}){try{const g=xe(ae,"userPreferences",n),y=await Gt(g);if(y.exists()){const T=y.data();if((T==null?void 0:T.notifyAvailability)===!1)return{success:!0,skipped:!0}}}catch{}const c=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <p><strong>Nouvel vnement programm!</strong></p>
      <p style="margin: 12px 0 2px 0; font-weight: 600;">${t}</p>
      <p style="margin: 0 0 16px 0; color:#374151;">${r}</p>
      <p>Nous avons besoin de savoir si tu es disponible.</p>
      <p style="margin-top: 12px;">
        <a href="${s}" style="display:inline-block;padding:10px 12px;margin-right:8px;border:2px solid #16a34a;color:#16a34a;border-radius:8px;text-decoration:none;"> Dispo</a>
        <a href="${i}" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;"> Pas dispo</a>
      </p>
      <p style="margin-top: 16px;">Merci!!</p>
    </div>
  `,d=`${a==="reminder"?"Rappel: ":""}${t} (${r})`,f={to:n,message:{subject:d,html:c},createdAt:qi(),meta:{reason:a,eventTitle:t,eventDate:r,playerName:e}};l&&(f.from=l,f.replyTo=l),await pl(Je(ae,"mail"),f);try{const g=xe(ae,"userPreferences",n),y=await Gt(g),T=y.exists()?y.data():{};if((T==null?void 0:T.notifyAvailabilityPush)!==!1){const A=`${a==="reminder"?"Rappel: ":""}${t} (${r})`,P=`${e}, t'es dispo ?`;await gc({toEmail:n,title:A,body:P,data:{url:o||window.location.origin,yesUrl:s,noUrl:i,reason:a},reason:a==="reminder"?"availability_reminder":"availability_request"})}}catch{}return{success:!0}}async function xT({toEmail:n,verifyUrl:e,purpose:t="player_protection",displayName:r="utilisateur",fromEmail:s=void 0}){const i=t==="account_email_update",o=i?"Vrification de votre nouvelle adresse email":"Vrification de votre email",a=`Bonjour ${r},`,l=i?"Pour scuriser votre compte, merci de confirmer que vous avez accs  cette nouvelle adresse email.":"Pour scuriser votre joueur, merci de confirmer que vous avez accs  cette adresse email.",c=i?"Confirmer mon adresse email":"Vrifier mon email",d=i?"Confirmez votre nouvelle adresse email":"Confirmez votre email pour activer la protection",f=`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2>${o}</h2>
      <p>${a}</p>
      <p>${l}</p>
      <p>
        <a href="${e}" style="display:inline-block;padding:10px 16px;background:#3b82f6;color:#fff;border-radius:8px;text-decoration:none;">${c}</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Ce lien expirera dans 7 jours.</p>
    </div>
  `,g={to:n,message:{subject:d,html:f},createdAt:qi(),meta:{reason:t,displayName:r}};s&&(g.from=s,g.replyTo=s),await pl(Je(ae,"mail"),g)}async function IM({toEmail:n,playerName:e,verifyUrl:t,fromEmail:r=void 0}){return xT({toEmail:n,verifyUrl:t,purpose:"player_protection",displayName:e,fromEmail:r})}async function EM({toEmail:n,playerName:e,eventTitle:t,eventDate:r,eventUrl:s,html:i=void 0,subject:o=void 0,fromEmail:a=void 0}){try{const f=xe(ae,"userPreferences",n),g=await Gt(f);if(g.exists()){const y=g.data();if((y==null?void 0:y.notifySelection)===!1)return{success:!0,skipped:!0}}}catch{}le.debug("queueSelectionEmail",{forPlayer:e,hasCustomHtml:!!i,hasCustomSubject:!!o});const l=i||`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <p>Bonjour ${e},</p>
      <p>Flicitations ! Tu as t slectionn(e) pour <strong>${t}</strong> (${r}).</p>
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 12px;border:2px solid #8b5cf6;color:#8b5cf6;border-radius:8px;text-decoration:none;">Afficher les Dtails</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Tu recevras bientt plus d'informations sur l'organisation.</p>
    </div>
  `,c=o||` Slection confirme  ${t}`;le.debug("queueSelectionEmail html/subject ready");const d={to:n,message:{subject:c,html:l},createdAt:qi(),meta:{reason:"selection",eventTitle:t,eventDate:r,playerName:e}};a&&(d.from=a,d.replyTo=a),le.debug("queueSelectionEmail firestore payload ready");try{await pl(Je(ae,"mail"),d);try{const f=xe(ae,"userPreferences",n),g=await Gt(f),y=g.exists()?g.data():{};(y==null?void 0:y.notifySelectionPush)!==!1&&await gc({toEmail:n,title:" Slection confirme",body:`${e}, tu as t slectionn(e) pour ${t} (${r}) `,data:{url:s||window.location.origin},reason:"selection"})}catch{}return le.info("Email ajout  la queue Firestore",{playerName:e}),{success:!0}}catch(f){throw le.error("Erreur lors de l'ajout  Firestore",{playerName:e,error:f}),f}}async function TM({toEmail:n,playerName:e,eventTitle:t,eventDate:r,eventUrl:s,newSelectedPlayers:i=[],html:o=void 0,subject:a=void 0,fromEmail:l=void 0}){try{const y=xe(ae,"userPreferences",n),T=await Gt(y);if(T.exists()){const A=T.data();if((A==null?void 0:A.notifySelection)===!1)return{success:!0,skipped:!0}}}catch{}const c=Array.isArray(i)?i.join(", "):"",d=o||`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <h2> Slection mise  jour</h2>
      <p>Bonjour ${e},</p>
      <p>La slection pour <strong>${t}</strong> (${r}) a t mise  jour et tu n'en fais plus partie .</p>
      ${c?`<p>Nouvelle slection: <strong>${c}</strong>.</p>`:""}
      <p>
        <a href="${s}" style="display:inline-block;padding:10px 16px;background:#6b7280;color:#fff;border-radius:8px;text-decoration:none;">Voir les dtails de l'vnement</a>
      </p>
      <p style="font-size:12px;color:#6b7280;">Motif: mise  jour de slection (relance auto ou ajustement manuel).</p>
    </div>
  `,f=a||` Tu n'es plus dans la slection  ${t}`,g={to:n,message:{subject:f,html:d},createdAt:qi(),meta:{reason:"deselection",eventTitle:t,eventDate:r,playerName:e,newSelectedPlayers:i}};l&&(g.from=l,g.replyTo=l),await pl(Je(ae,"mail"),g);try{const y=xe(ae,"userPreferences",n),T=await Gt(y),A=T.exists()?T.data():{};(A==null?void 0:A.notifySelectionPush)!==!1&&await gc({toEmail:n,title:" Slection mise  jour",body:`${e}, tu n'es plus slectionn(e) pour ${t} (${r}) `,data:{url:s||window.location.origin,noUrl:s&&s.includes("/event/")?s.replace("/event/","/magic?auto=no&event="):void 0},reason:"deselection"})}catch{}return{success:!0}}async function xM({eventId:n,eventData:e,selectedPlayers:t,seasonId:r,seasonSlug:s,players:i}){if(le.info("sendSelectionEmailsForEvent",{eventId:n,seasonId:r,seasonSlug:s,playersCount:i==null?void 0:i.length,selectedCount:t==null?void 0:t.length}),!e||!t||t.length===0)throw new Error("Donnes manquantes pour l'envoi des emails de slection");const{getPlayerEmail:o}=await Xt(()=>Promise.resolve().then(()=>mc),void 0),{createMagicLink:a}=await Xt(()=>Promise.resolve().then(()=>mM),void 0),l=`${window.location.origin}/season/${s}/event/${n}`;t.join(", ");const c=` Slection confirme  ${e.title}`,d=[];for(const f of t){le.debug("Traitement du joueur",{playerName:f});try{const g=i==null?void 0:i.find(q=>q.name===f);if(!g){le.warn("Joueur non trouv",{playerName:f});continue}le.debug("Joueur trouv");const y=await o(g.id,r);if(!y){le.warn("Pas d'email pour le joueur",{playerName:f});continue}le.debug("Email trouv pour joueur");const A=`${(await a({seasonId:r,playerId:g.id,eventId:n,action:"no"})).url}&slug=${encodeURIComponent(s)}`,P=`
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
          <p>Bonjour <strong>${f}</strong>,</p>
          <p>Tu as t slectionn(e) pour <strong>${e.title}</strong> (${Zd(e.date)}).</p>
          <p>Un imprvu ?</p>
          <p>
            <a href="${A}" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;margin-right:8px;"> Plus dispo</a>
            <a href="${l}" style="display:inline-block;padding:10px 12px;border:2px solid #8b5cf6;color:#8b5cf6;border-radius:8px;text-decoration:none;">Afficher les Dtails</a>
          </p>
        </div>
      `;le.debug("HTML gnr pour joueur");const U=EM({toEmail:y,playerName:f,eventTitle:e.title,eventDate:Zd(e.date),eventUrl:l,html:P,subject:c});d.push(U),le.info("Email ajout  la queue",{playerName:f})}catch(g){le.error("Erreur lors de l'envoi de l'email de slection",{playerName:f,error:g})}}return le.info("Nombre total d'emails  envoyer",{count:d.length}),await Promise.all(d),le.info("Tous les emails ont t envoys avec succs"),{success:!0,count:d.length}}async function AM({eventId:n,eventData:e,removedPlayers:t,newSelectedPlayers:r,seasonId:s,seasonSlug:i,players:o}){if(le.info("sendDeselectionEmailsForEvent",{eventId:n,seasonId:s,removedCount:t==null?void 0:t.length}),!e||!t||t.length===0)return{success:!0,count:0};const{getPlayerEmail:a}=await Xt(()=>Promise.resolve().then(()=>mc),void 0),l=`${window.location.origin}/season/${i}/event/${n}`,c=[],d=Array.isArray(r)?r.join(", "):"";for(const f of t)try{const g=o==null?void 0:o.find(A=>A.name===f);if(!g){le.warn("Joueur retir non trouv",{playerName:f});continue}const y=await a(g.id,s);if(!y){le.warn("Pas d'email pour le joueur retir",{playerName:f});continue}const T=`
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
          <h2> Slection mise  jour</h2>
          <p>Bonjour <strong>${f}</strong>,</p>
          <p>Tu n'es plus slectionn(e) pour <strong>${e.title}</strong> (${Zd(e.date)}) .</p>
          ${d?`<p>Nouvelle slection: <strong>${d}</strong>.</p>`:""}
          <p>
            <a href="${l}" style="display:inline-block;padding:10px 12px;border:2px solid #6b7280;color:#6b7280;border-radius:8px;text-decoration:none;">Voir les dtails de l'vnement</a>
          </p>
        </div>
      `;c.push(TM({toEmail:y,playerName:f,eventTitle:e.title,eventDate:Zd(e.date),eventUrl:l,newSelectedPlayers:r,html:T}))}catch(g){le.error("Erreur lors de l'envoi de l'email de dslection",{playerName:f,error:g})}return await Promise.all(c),le.info("Emails de dslection envoys",{count:c.length}),{success:!0,count:c.length}}function Zd(n){var t;return n?(typeof n=="string"?new Date(n):((t=n.toDate)==null?void 0:t.call(n))||n).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function SM({reason:n,recipientName:e,eventTitle:t,eventDate:r,urls:s={},prefs:i={},extra:o={}}){const a={email:null,push:null};if(n==="availability_request"||n==="availability_reminder"){const l=(i==null?void 0:i.notifyAvailability)!==!1,c=(i==null?void 0:i.notifyAvailabilityPush)!==!1;a.email={enabled:l,subject:n==="availability_reminder"?`Rappel disponibilit  ${t} (${r})`:`Disponibilit demande  ${t} (${r})`},a.push={enabled:c,title:n==="availability_reminder"?" Rappel disponibilit":" Disponibilit demande",body:`${e}, ${t} (${r})`,data:{url:s.eventUrl,yesUrl:s.yesUrl,noUrl:s.noUrl,reason:n}}}if(n==="selection"){const l=(i==null?void 0:i.notifySelection)!==!1,c=(i==null?void 0:i.notifySelectionPush)!==!1;a.email={enabled:l,subject:` Slection confirme  ${t}`},a.push={enabled:c,title:" Slection confirme",body:`${e}, tu as t slectionn(e) pour ${t} (${r}) `,data:{url:s.eventUrl}}}return a}async function PM({reason:n,recipientEmail:e,recipientName:t,eventTitle:r,eventDate:s,urls:i={},extra:o={}}){if(!e)return{success:!1,skipped:!0,reason:"missing_email"};const a=await Gt(xe(ae,"userPreferences",e)).catch(()=>null),l=a!=null&&a.exists()?a.data():{},c=SM({reason:n,recipientName:t,eventTitle:r,eventDate:s,urls:i,prefs:l,extra:o}),d=[];return c.email&&c.email.enabled&&(n==="availability_request"||n==="availability_reminder"?await wM({toEmail:e,playerName:t,eventTitle:r,eventDate:s,yesUrl:i.yesUrl,noUrl:i.noUrl,eventUrl:i.eventUrl,reason:n==="availability_reminder"?"reminder":"new_event"}).then(()=>d.push({channel:"email",success:!0})).catch(g=>{le.error("notifyRecipientAcrossChannels email error",g),d.push({channel:"email",success:!1})}):n==="selection"&&d.push({channel:"email",success:!0,skipped:!0,note:"batch_handled_elsewhere"})),c.push&&c.push.enabled&&await gc({toEmail:e,title:c.push.title,body:c.push.body,data:c.push.data||{},reason:n}).then(()=>d.push({channel:"push",success:!0})).catch(g=>{le.error("notifyRecipientAcrossChannels push error",g),d.push({channel:"push",success:!1})}),{success:d.some(g=>g.success),results:d}}async function X_({eventId:n,eventData:e,players:t,seasonId:r,seasonSlug:s,createMagicLink:i,reminder:o=!1,getAvailabilityForEvent:a=null}){const l=[],c=`${window.location.origin}/season/${s}/event/${n}`;for(const d of t)try{if(o&&typeof a=="function"){const y=await Promise.resolve(a(d.name,n));if(y===!0||y===!1)continue}const f={};if(typeof i=="function"){const y=await i({seasonId:r,playerId:d.id,eventId:n,action:"yes"}),T=await i({seasonId:r,playerId:d.id,eventId:n,action:"no"});f.yesUrl=`${y.url}&slug=${encodeURIComponent(s)}`,f.noUrl=`${T.url}&slug=${encodeURIComponent(s)}`}f.eventUrl=c,(await PM({reason:o?"availability_reminder":"availability_request",recipientEmail:d.email,recipientName:d.name,eventTitle:e.title,eventDate:RM(e.date),urls:f})).success||l.push(d.id)}catch{l.push(d.id)}return{success:!0,failures:l}}async function Z_(n){return xM(n)}function RM(n){var t;return n?(typeof n=="string"?new Date(n):((t=n.toDate)==null?void 0:t.call(n))||n).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}const CM="/icons/manifest-icon-192.maskable.png",kM={class:"relative p-5 pb-4 border-b border-white/10"},DM={class:"text-xl md:text-2xl font-bold text-white pr-10 flex items-center gap-2"},NM={key:0,class:"text-sm text-purple-300 mt-1"},VM={class:"px-4 md:px-6 py-4 md:py-6 space-y-6 overflow-y-auto"},OM={class:"space-y-4"},MM={class:"inline-flex bg-gray-800 rounded-lg overflow-hidden border border-gray-700 mb-3"},LM={class:"text-sm text-gray-300"},FM={class:"text-sm text-gray-300"},$M={class:"text-sm text-gray-300"},UM=["innerHTML"],jM=["value"],BM={class:"mt-3"},qM={class:"text-lg font-semibold leading-snug"},zM={class:"mt-2 text-base whitespace-pre-line text-white/90"},KM={class:"mt-4 flex items-center gap-4 text-base"},GM={key:1,class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-gray-100 text-gray-900 border border-white/20"},HM={class:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-200 rounded-md p-3 text-sm mb-2"},WM=["value"],QM={class:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2"},JM={key:0,class:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 mb-3"},YM={class:"bg-gray-800 border border-gray-600 rounded-lg p-3"},XM={key:0,class:"space-y-2"},ZM={class:"flex flex-wrap gap-2"},eL=["onClick","title"],tL={key:1,class:"text-amber-400 text-sm"},nL={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},rL={class:"flex items-center gap-2 w-full"},sL=["disabled"],iL={key:0},oL={key:1,class:"inline-flex items-center gap-2"},aL=["title"],lL={key:0},uL={key:1},AT={__name:"EventAnnounceModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},players:{type:Array,default:()=>[]},mode:{type:String,default:"event",validator:n=>["event","selection"].includes(n)},selectedPlayers:{type:Array,default:()=>[]},sending:{type:Boolean,default:!1},availabilityByPlayer:{type:Object,default:()=>({})}},emits:["close","notifications-sent","send-notifications"],setup(n,{emit:e}){const t=n,r=e;k("notify");const s=k(!1),i=k("Copier le message"),o=k(!1),a=Oe(()=>t.sending||o.value),l=k(!1),c=k("email"),d=Oe(()=>!t.event||!t.seasonSlug?"":`${window.location.origin}/season/${t.seasonSlug}/event/${t.event.id}`),f=Oe(()=>{if(!t.event)return"";if(c.value==="push"){const j=P.value,ne=U.value;if(t.mode==="event"){const Ke=`

Lien direct: ${d.value}`;return`${j}
${ne}
 Dispo
 Pas dispo${Ke}`}return`${j}
${ne}
Ouvrir`}const Y=`

Lien direct: ${d.value}`;return`Objet: ${g.value}

${A.value}${Y}`}),g=Oe(()=>{var j,ne,Ke;const Y=B((j=t.event)==null?void 0:j.date);return t.mode==="event"?`${(ne=t.event)==null?void 0:ne.title} (${Y})`:` Slection confirme  ${(Ke=t.event)==null?void 0:Ke.title}`}),y=Oe(()=>"impropick@gmail.com"),T=Oe(()=>{var ne,Ke,Be,Ge,re,ee,je;const Y=((ne=z.value)==null?void 0:ne.id)==="ALL"?"<joueur>":((Ke=z.value)==null?void 0:Ke.name)||"[Nom du joueur]",j=B((Be=t.event)==null?void 0:Be.date);return z.value&&z.value.id&&z.value.id!=="ALL"&&!((Ge=me.value.find(Xe=>Xe.id===z.value.id))!=null&&Ge.hasContact)?`
      <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
        <p><strong>${Y}</strong> n'a pas configur d'email. Utilise la fonction  Copier le message  et envoie-lui ces informations par un autre canal.</p>
        <p style="margin-top: 8px; font-weight: 600;">${(re=t.event)==null?void 0:re.title}</p>
        <p style="color:#374151;">${j}</p>
        <p style="margin-top: 8px;">Lien direct : ${d.value}</p>
      </div>
    `:t.mode==="event"?`
      <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
        <p><strong>${Y}</strong>, un nouvel vnement est prvu.</p>
        <p style="margin: 12px 0 2px 0; font-weight: 600;">${(ee=t.event)==null?void 0:ee.title}</p>
        <p style="margin: 0 0 16px 0; color:#374151;">${j}</p>
        <p>Nous avons besoin de savoir si tu es disponible.</p>
        <p style="margin-top: 12px;">
          <a href="#yes" style="display:inline-block;padding:10px 12px;margin-right:8px;border:2px solid #16a34a;color:#16a34a;border-radius:8px;text-decoration:none;"> Dispo</a>
          <a href="#no" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;"> Pas dispo</a>
        </p>
        <p style="margin-top: 16px;">Merci!!</p>
      </div>
    `:`
    <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height:1.5;">
      <p>Bonjour ${Y},</p>
      <p>Tu as t slectionn(e) pour <strong>${(je=t.event)==null?void 0:je.title}</strong> (${j}).</p>
      <p>Un imprvu ?</p>
      <p>
        <a href="#no" style="display:inline-block;padding:10px 12px;border:2px solid #dc2626;color:#dc2626;border-radius:8px;text-decoration:none;margin-right:8px;"> Plus dispo</a>
        <a href="#event" style="display:inline-block;padding:10px 12px;border:2px solid #8b5cf6;color:#8b5cf6;border-radius:8px;text-decoration:none;">Afficher les Dtails</a>
      </p>
    </div>
  `}),A=Oe(()=>T.value.replace(/<\/?div[^>]*>/g,`
`).replace(/<\/?p[^>]*>/g,`
`).replace(/<br\s*\/?>(\n)?/g,`
`).replace(/<[^>]+>/g,"").replace(/\n{3,}/g,`

`).trim()),P=Oe(()=>{var Y,j;return t.mode==="event"?`${(Y=t.event)==null?void 0:Y.title} (${B((j=t.event)==null?void 0:j.date)})`:" Slection confirme"}),U=Oe(()=>{var Be,Ge,re,ee,je,Xe;const Y=B((Be=t.event)==null?void 0:Be.date),j=((Ge=z.value)==null?void 0:Ge.id)==="ALL"?"<joueur>":((re=z.value)==null?void 0:re.name)||"[Nom du joueur]",ne=z.value&&z.value.id&&z.value.id!=="ALL",Ke=ne?!!((ee=me.value.find(ht=>ht.id===z.value.id))!=null&&ee.hasContact):!0;return ne&&!Ke?`${j} n'a pas install l'appli. Envoie-lui ce message manuellement.
${(je=t.event)==null?void 0:je.title} (${Y})
Lien: ${d.value}`:t.mode==="event"?`${j}, t'es dispo ?`:`${j}, tu as t slectionn(e) pour ${(Xe=t.event)==null?void 0:Xe.title} (${Y}) `}),q=k([]),M=k([]),z=k(null),fe=k([]),me=Oe(()=>{const Y=M.value.map(ne=>({...ne,hasContact:ne.id!=="ALL",missingReason:""})),j=fe.value.map(ne=>({...ne,hasContact:!1,missingReason:"Aucun canal actif"}));return[{id:"ALL",name:"Tous",hasContact:!0},...Y.filter(ne=>ne.id!=="ALL"),...j]}),x=Oe(()=>{if(!z.value||z.value.id==="ALL")return!0;const Y=me.value.find(j=>(j.id||j.name)===(z.value.id||z.value.name));return!!(Y!=null&&Y.hasContact)}),I=Oe(()=>{var ne,Ke,Be,Ge,re;const Y=((ne=z.value)==null?void 0:ne.id)==="ALL"?"<joueur>":((Ke=z.value)==null?void 0:Ke.name)||"[Nom du joueur]",j=B((Be=t.event)==null?void 0:Be.date);return t.mode==="selection"?`Bonjour ${Y},
Tu as t slectionn(e) pour ${(Ge=t.event)==null?void 0:Ge.title} (${j})
Un imprvu ? ${w.value}
Dtails : ${d.value}`:`Bonjour ${Y},
${(re=t.event)==null?void 0:re.title} (${j})
Peux-tu indiquer ta disponibilit ?
Lien : ${d.value}`}),w=Oe(()=>{var Y,j;try{const ne=(Y=z.value)!=null&&Y.id&&z.value.id!=="ALL"?t.players.find(Ke=>Ke.id===z.value.id):null;return!ne||!((j=t.event)!=null&&j.id)||!t.seasonId?"[lien dsistement]":`${window.location.origin}/magic?auto=no&season=${encodeURIComponent(t.seasonId)}&player=${encodeURIComponent(ne.id)}&event=${encodeURIComponent(t.event.id)}&slug=${encodeURIComponent(t.seasonSlug||"")}`}catch{return"[lien dsistement]"}});async function C(){if(!t.seasonId)return;let Y=[];t.mode==="selection"?Y=t.players.filter(Be=>t.selectedPlayers.includes(Be.name)):Y=t.players.filter(Be=>{var re;return typeof((re=t.availabilityByPlayer)==null?void 0:re[Be.name])>"u"});const j=[];for(const Be of Y)try{const{getPlayerEmail:Ge}=await Xt(()=>Promise.resolve().then(()=>mc),void 0),re=await Ge(Be.id,t.seasonId);re&&j.push({...Be,email:re})}catch(Ge){console.warn(`Impossible de charger l'email pour ${Be.name}:`,Ge)}q.value=j;const ne={id:"ALL",name:"Tous"};M.value=[ne,...j];const Ke=Y.filter(Be=>!j.find(Ge=>Ge.id===Be.id)).map(Be=>({id:Be.id,name:Be.name}));fe.value=Ke,z.value||(z.value=ne)}function V(){r("close")}function B(Y){var ne;return Y?(typeof Y=="string"?new Date(Y):((ne=Y.toDate)==null?void 0:ne.call(Y))||Y).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function R(){const Y=f.value;navigator.clipboard.writeText(Y).then(()=>{s.value=!0,i.value="Copi !",setTimeout(()=>{s.value=!1,i.value="Copier le message"},2e3)}).catch(j=>{console.warn("Erreur lors de la copie du texte"),alert("Impossible de copier le message.")})}function It(Y){z.value=Y}async function vt(){if(!(!t.event||M.value.length===0)){o.value=!0;try{const Y=z.value&&z.value.id!=="ALL"?"single":"all",j=Y==="single"?{id:z.value.id,name:z.value.name,email:z.value.email}:null;t.mode==="selection"?r("send-notifications",{eventId:t.event.id,eventData:t.event,reason:"selection",selectedPlayers:t.selectedPlayers,scope:Y,recipient:j}):r("send-notifications",{eventId:t.event.id,eventData:t.event,reason:"manual",scope:Y,recipient:j})}catch{console.error("Erreur lors de l'envoi des notifications"),alert("Erreur lors de l'envoi des notifications. Veuillez ressayer.")}}}return Xn(()=>{t.show&&C()}),At(()=>t.show,Y=>{Y&&C()}),At(()=>t.selectedPlayers,()=>{t.show&&t.mode==="selection"&&C()}),At(()=>t.availabilityByPlayer,()=>{t.show&&t.mode==="event"&&C()},{deep:!0}),At(()=>t.sending,Y=>{Y||(o.value=!1)}),(Y,j)=>{var ne,Ke,Be,Ge,re;return n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:V},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-3xl max-h-[92vh] flex flex-col",onClick:j[3]||(j[3]=Ft(()=>{},["stop"]))},[h("div",kM,[h("button",{onClick:V,title:"Fermer",class:"absolute right-2.5 top-2.5 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),h("h2",DM,[h("span",null,ce(n.mode==="selection"?"":""),1),h("span",null,ce(n.mode==="selection"?"Annoncer la slection":"Annoncer l'vnement"),1)]),n.event?(L(),F("p",NM,ce(n.event.title)+"  "+ce(B(n.event.date)),1)):ve("",!0)]),h("div",VM,[h("div",OM,[h("div",null,[j[11]||(j[11]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Prvisualisation du message :",-1)),h("div",MM,[h("button",{class:xt(["px-3 py-2 text-sm transition-colors",c.value==="email"?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"]),onClick:j[0]||(j[0]=ee=>c.value="email"),title:"Prvisualiser l'email"},"",2),h("button",{class:xt(["px-3 py-2 text-sm transition-colors",c.value==="push"?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"]),onClick:j[1]||(j[1]=ee=>c.value="push"),title:"Prvisualiser la notification push"},"",2)]),c.value==="email"?(L(),F("div",{key:0,class:xt(x.value||((ne=z.value)==null?void 0:ne.id)==="ALL"?"bg-gray-800 border border-gray-600 rounded-lg p-4 text-white space-y-3":"space-y-3")},[x.value||((Ke=z.value)==null?void 0:Ke.id)==="ALL"?(L(),F(dt,{key:0},[h("div",LM,[j[4]||(j[4]=h("span",{class:"font-semibold"},"De:",-1)),Nt(" "+ce(y.value),1)]),h("div",FM,[j[5]||(j[5]=h("span",{class:"font-semibold"},":",-1)),Nt(" "+ce(((Be=z.value)==null?void 0:Be.id)==="ALL"?"<joueur>":((Ge=z.value)==null?void 0:Ge.name)||"[Nom du joueur]"),1)]),h("div",$M,[j[6]||(j[6]=h("span",{class:"font-semibold"},"Objet:",-1)),Nt(" "+ce(g.value),1)]),h("div",{class:"bg-white text-black rounded-md p-4",innerHTML:T.value},null,8,UM)],64)):(L(),F(dt,{key:1},[j[7]||(j[7]=h("div",{class:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-200 rounded-md p-3 text-sm"}," Ce joueur n'a pas configur d'email. Utilise la fonction  Copier le message  et envoie-lui ces informations par un autre canal. ",-1)),h("textarea",{class:"w-full mt-2 p-3 bg-gray-900 border border-gray-700 rounded-md text-white text-sm",value:I.value,rows:"5",readonly:""},null,8,jM)],64))],2)):(L(),F("div",{key:1,class:xt(z.value&&z.value.id!=="ALL"&&!x.value?"text-white":"bg-gray-900 border border-gray-700 rounded-xl p-4 text-white")},[z.value&&z.value.id!=="ALL"&&!x.value?(L(),F(dt,{key:1},[h("div",HM,ce((re=z.value)==null?void 0:re.name)+" n'a pas install l'appli. Envoie-lui ce message manuellement. ",1),h("textarea",{class:"w-full p-3 bg-gray-800 border border-gray-700 rounded-md text-white text-sm",value:I.value,rows:"5",readonly:""},null,8,WM)],64)):(L(),F(dt,{key:0},[j[10]||(j[10]=Jn('<div class="flex items-center justify-between text-xs text-white/70"><div class="flex items-center gap-2 min-w-0"><div class="w-6 h-6 rounded-full bg-white/10 flex items-center justify-center"></div><div class="truncate">Impropick</div><span class="opacity-60"></span><span>il y a 1 min</span></div><img src="'+CM+'" alt="App icon" class="w-10 h-10 rounded-full shadow"></div>',1)),h("div",BM,[h("div",qM,ce(P.value),1),h("div",zM,ce(U.value),1)]),h("div",KM,[t.mode==="event"?(L(),F(dt,{key:0},[j[8]||(j[8]=h("span",{class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-green-600/20 text-green-300 border border-green-600/40"}," Dispo",-1)),j[9]||(j[9]=h("span",{class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-red-600/20 text-red-300 border border-red-600/40"}," Pas dispo",-1))],64)):(L(),F("span",GM,"Ouvrir"))])],64))],2))]),h("div",null,[h("label",QM,[j[12]||(j[12]=Nt(" Destinataires ")),h("button",{onClick:j[2]||(j[2]=ee=>l.value=!l.value),class:"text-blue-400 hover:text-blue-300 text-lg cursor-help",title:"Cliquer pour plus d'information"}," ? ")]),l.value?(L(),F("div",JM,j[13]||(j[13]=[h("p",{class:"text-blue-200 text-sm"},[Nt(" Cette liste montre tous les joueurs cibls: "),h("span",{class:"text-purple-300"}," Tous "),Nt(", "),h("span",{class:"text-gray-200"},"ceux notifiables (email/push actifs)"),Nt(" et "),h("span",{class:"text-yellow-300"},"ceux en jaune sans canal actif"),Nt(". Les joueurs en jaune ne peuvent pas tre notifis automatiquement. Utilise  Copier le message  pour leur crire via un autre moyen (l'URL de l'vnement est incluse). ")],-1)]))):ve("",!0),h("div",YM,[me.value.length>0?(L(),F("div",XM,[h("div",ZM,[(L(!0),F(dt,null,wr(me.value,ee=>(L(),F("button",{key:ee.id||ee.name,type:"button",onClick:je=>It(ee),class:xt(["px-3 py-1 rounded text-sm border transition-colors",z.value&&z.value.id===ee.id?"bg-purple-600 border-purple-500 text-white":ee.hasContact?"bg-gray-700 border-gray-600 text-white hover:bg-gray-600":"bg-yellow-900/20 border-yellow-600/40 text-yellow-200 hover:bg-yellow-900/30 opacity-75 cursor-not-allowed"]),title:ee.hasContact?"Prvisualiser pour "+ee.name:ee.missingReason||"Aucun canal actif"},ce(ee.name),11,eL))),128))])])):(L(),F("div",tL,"  Aucun destinataire disponible. "))])])])]),h("div",nL,[h("div",rL,[h("button",{onClick:vt,disabled:M.value.length===0||a.value||z.value&&z.value.id!=="ALL"&&!x.value,class:"h-12 px-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600 flex-1"},[a.value?(L(),F("span",oL,j[14]||(j[14]=[h("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[h("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),h("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),Nt(" Envoi en cours... ")]))):(L(),F("span",iL,[z.value&&z.value.id!=="ALL"?(L(),F("span",{key:0,class:xt(x.value?"":"opacity-60")}," Notifier "+ce(z.value.name),3)):(L(),F(dt,{key:1},[Nt(" Envoyer les notifications")],64))]))],8,sL),h("button",{onClick:R,class:"h-12 px-6 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300",title:i.value},[s.value?(L(),F("span",uL," Copi")):(L(),F("span",lL," Copier le message"))],8,aL)]),h("button",{onClick:V,class:"h-12 px-4 bg-gray-700 text-white rounded-lg"}," Fermer ")])])])):ve("",!0)}}},cL={class:"text-center mb-6"},dL={class:"text-lg text-gray-300"},hL={class:"mb-6"},fL={class:"space-y-4"},pL={class:"flex items-center gap-2 text-gray-300 text-sm"},mL=["disabled"],gL={key:0,class:"animate-spin"},vL={key:1},yL={class:"mb-6 text-center"},_L={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},bL={class:"text-red-300 text-sm"},wL={class:"text-center mb-6"},IL={class:"text-lg text-gray-300"},EL={class:"mb-6"},TL=["disabled"],xL={key:0,class:"animate-spin"},AL={key:1},SL={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},PL={class:"text-red-300 text-sm"},RL={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},CL={class:"text-green-300 text-sm"},kL={class:"flex justify-center"},$g={__name:"PasswordVerificationModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","verified"],setup(n,{emit:e}){const t=n,r=e,s=k(""),i=k(!1),o=k(""),a=k(!1),l=k(""),c=k(""),d=k(null),f=k(!0);async function g(){if(s.value){i.value=!0,o.value="";try{const A=await Op(t.seasonId);if(s.value===A){if(f.value)try{Oi.saveSession(t.player.id)}catch{}r("verified",{type:"season_pin"}),T();return}if(await IT(t.player.id,s.value,t.seasonId)){if(f.value)try{Oi.saveSession(t.player.id)}catch{}r("verified",{type:"player_password"}),T()}else o.value="Mot de passe incorrect. Veuillez ressayer."}catch(A){le.error("Erreur lors de la vrification",A),o.value="Erreur lors de la vrification. Veuillez ressayer."}finally{i.value=!1}}}async function y(){i.value=!0,l.value="",c.value="";try{const A=await TT(t.player.id,t.seasonId);c.value=A.message||"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}catch(A){le.error("Erreur lors de l'envoi de l'email",A),l.value="Erreur lors de l'envoi de l'email. Veuillez ressayer."}finally{i.value=!1}}function T(){r("close"),s.value="",o.value="",a.value=!1,l.value="",c.value=""}return At(()=>t.show,A=>{A&&pn(()=>{d.value&&d.value.focus()})}),(A,P)=>{var U,q;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4",onClick:T},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:P[3]||(P[3]=Ft(()=>{},["stop"]))},[h("div",cL,[P[7]||(P[7]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),P[8]||(P[8]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Vrification requise",-1)),h("p",dL,ce((U=n.player)==null?void 0:U.name),1),P[9]||(P[9]=h("p",{class:"text-sm text-gray-400 mt-2"},"Ce joueur est protg par mot de passe",-1))]),h("div",hL,[h("div",fL,[h("div",null,[P[10]||(P[10]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),nt(h("input",{"onUpdate:modelValue":P[0]||(P[0]=M=>s.value=M),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:Mn(g,["enter"]),ref_key:"passwordInput",ref:d},null,544),[[Dt,s.value]])]),h("div",pL,[nt(h("input",{id:"staySignedIn",type:"checkbox","onUpdate:modelValue":P[1]||(P[1]=M=>f.value=M),class:"w-4 h-4"},null,512),[[yi,f.value]]),P[11]||(P[11]=h("label",{for:"staySignedIn"},"Rester connect sur cet appareil",-1))])]),h("button",{onClick:g,disabled:!s.value||i.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(L(),F("span",gL,"")):(L(),F("span",vL,"")),h("span",null,ce(i.value?"Vrification...":"Vrifier"),1)],8,mL)]),h("div",yL,[h("button",{onClick:P[2]||(P[2]=M=>a.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oubli ? ")]),o.value?(L(),F("div",_L,[h("div",bL,ce(o.value),1)])):ve("",!0),h("div",{class:"flex justify-center"},[h("button",{onClick:T,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):ve("",!0),a.value?(L(),F("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:P[6]||(P[6]=M=>a.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:P[5]||(P[5]=Ft(()=>{},["stop"]))},[h("div",wL,[P[12]||(P[12]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),P[13]||(P[13]=h("h2",{class:"text-2xl font-bold text-white mb-2"},"Mot de passe oubli",-1)),h("p",IL,ce((q=n.player)==null?void 0:q.name),1)]),h("div",EL,[P[14]||(P[14]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de rinitialisation sera envoy  l'adresse associe  ce joueur. ",-1)),h("button",{onClick:y,disabled:i.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[i.value?(L(),F("span",xL,"")):(L(),F("span",AL,"")),h("span",null,ce(i.value?"Envoi...":"Envoyer l'email"),1)],8,TL)]),l.value?(L(),F("div",SL,[h("div",PL,ce(l.value),1)])):ve("",!0),c.value?(L(),F("div",RL,[h("div",CL,ce(c.value),1)])):ve("",!0),h("div",kL,[h("button",{onClick:P[4]||(P[4]=M=>a.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ve("",!0)],64)}}},DL={class:"text-center mb-6"},NL={class:"text-sm text-gray-300"},VL={key:0,class:"space-y-4"},OL={key:0,class:"p-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-200 text-sm flex items-center gap-2"},ML={key:1,class:"space-y-4"},LL=["disabled"],FL={key:0,class:"animate-spin"},$L={key:1},UL={key:2,class:"mt-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm"},jL={class:"mt-6 flex justify-center gap-3"},BL=["disabled"],qL={key:0,class:"animate-spin"},zL={key:1},ST={__name:"AccountClaimModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null}},emits:["close","success"],setup(n,{emit:e}){const t=n,r=e,s=k(1),i=k(""),o=k(""),a=k(""),l=k(!1),c=k(""),d=k(!1),f=el(),g=Oe(()=>i.value&&i.value.includes("@")),y=Oe(()=>o.value&&a.value&&o.value===a.value&&o.value.length>=6);async function T(){var q,M,z;if(!(!g.value||!((q=t.player)!=null&&q.id))){l.value=!0,c.value="";try{const fe=await vT({playerId:t.player.id,email:i.value.trim(),seasonId:t.seasonId}),me=(M=f.params)==null?void 0:M.slug,x=`${fe.url}${me?`&slug=${encodeURIComponent(me)}`:""}&player=${encodeURIComponent(t.player.id)}&open=protection`;await IM({toEmail:i.value,playerName:((z=t.player)==null?void 0:z.name)||"joueur",verifyUrl:x}),d.value=!0}catch{c.value="Impossible d'envoyer l'email de vrification"}finally{l.value=!1}}}async function A(){try{await _T({playerId:t.player.id,seasonId:t.seasonId})}catch{}s.value=1,d.value=!1,i.value="",o.value="",a.value=""}async function P(){var q;try{const M=await yl((q=t.player)==null?void 0:q.id,t.seasonId);M!=null&&M.email&&(M!=null&&M.emailVerifiedAt)?s.value=2:s.value=1}catch{s.value=1}}Xn(()=>{P()}),At(()=>t.show,q=>{q&&P()});async function U(){if(y.value){l.value=!0,c.value="";try{await gT(t.player.id,i.value.trim(),o.value,t.seasonId),r("success")}catch(q){c.value=(q==null?void 0:q.message)||"Erreur lors de l'association"}finally{l.value=!1}}}return(q,M)=>{var z;return n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[160] p-4",onClick:M[6]||(M[6]=fe=>q.$emit("close"))},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-md",onClick:M[5]||(M[5]=Ft(()=>{},["stop"]))},[h("button",{onClick:M[0]||(M[0]=fe=>q.$emit("close")),class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},"  "),h("div",DL,[M[7]||(M[7]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),M[8]||(M[8]=h("h2",{class:"text-2xl font-bold text-white mb-1"},"Associer un compte",-1)),h("p",NL,"Pour scuriser les saisies de "+ce((z=n.player)==null?void 0:z.name),1)]),s.value===1?(L(),F("div",VL,[h("div",null,[M[9]||(M[9]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Adresse email",-1)),nt(h("input",{"onUpdate:modelValue":M[1]||(M[1]=fe=>i.value=fe),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[Dt,i.value]])]),d.value?(L(),F("div",OL,[M[10]||(M[10]=h("span",null,"",-1)),h("span",null,"Un email a t envoy  "+ce(i.value)+". Cliquez sur le lien contenu dans l'email pour continuer.",1)])):ve("",!0)])):s.value===2?(L(),F("div",ML,[h("div",{class:"p-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-200 text-sm flex items-center gap-2"},[M[11]||(M[11]=h("span",null,"",-1)),M[12]||(M[12]=h("span",null,"Adresse email vrifie",-1)),h("button",{type:"button",onClick:A,title:"Changer d'adresse email",class:"ml-auto px-2 py-1 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 text-white/80 hover:text-white transition-colors"},"")]),h("div",null,[M[13]||(M[13]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":M[2]||(M[2]=fe=>o.value=fe),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe scuris (min. 6 caractres)"},null,512),[[Dt,o.value]])]),h("div",null,[M[14]||(M[14]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":M[3]||(M[3]=fe=>a.value=fe),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe"},null,512),[[Dt,a.value]])]),h("button",{onClick:U,disabled:!y.value||l.value,class:"w-full px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(L(),F("span",FL,"")):(L(),F("span",$L,"")),h("span",null,ce(l.value?"Association...":"Associer ce joueur"),1)],8,LL)])):ve("",!0),c.value?(L(),F("div",UL,ce(c.value),1)):ve("",!0),h("div",jL,[h("button",{onClick:M[4]||(M[4]=fe=>q.$emit("close")),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer"),s.value===1?(L(),F("button",{key:0,onClick:T,disabled:!g.value||l.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(L(),F("span",qL,"")):(L(),F("span",zL,"")),h("span",null,ce(l.value?"Envoi...":"Envoyer le lien de vrification"),1)],8,BL)):ve("",!0)])])])):ve("",!0)}}},KL={class:"mt-4"},GL={key:0,class:"mt-2 p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg text-sm text-gray-300 space-y-2"},PT={__name:"AccountBenefitsHint",setup(n){const e=k(!1);return(t,r)=>(L(),F("div",KL,[h("button",{onClick:r[0]||(r[0]=s=>e.value=!e.value),class:"w-full p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-all duration-200 flex items-center justify-between"},[r[1]||(r[1]=h("h3",{class:"text-sm font-semibold text-blue-300"}," A quoi sert un compte ?",-1)),h("span",{class:xt(["text-blue-300 transition-transform duration-200",{"rotate-180":e.value}])},"",2)]),e.value?(L(),F("div",GL,r[2]||(r[2]=[h("div",{class:"text-gray-300"},"a fonctionne trs bien sans compte. Mais si vous en crez un, vous aurez quelques trucs sympas en plus :",-1),h("div",null,[Nt(" "),h("span",{class:"text-blue-300"},"Protgez vos saisies :"),Nt(" vous tes sr que personne n'a chang vos dispos car vous tes le seul  pouvoir les modifier")],-1),h("div",null,[Nt(" "),h("span",{class:"text-blue-300"},"Notifications :"),Nt(" nouveaux spectacles, disponibilits et slections dans votre boite mail")],-1),h("div",null,[Nt(" "),h("span",{class:"text-blue-300"},"Saisie simplifie :"),Nt(" votre joueur reste toujours en haut de la liste")],-1)]))):ve("",!0)]))}},HL={class:"text-center mb-6"},WL={class:"text-2xl font-bold text-white mb-2"},QL={class:"text-lg text-gray-300"},JL={class:"mb-6"},YL={class:"flex items-center space-x-3"},XL={class:"text-2xl"},ZL={class:"font-semibold text-white"},eF={class:"text-sm text-gray-300"},tF={key:0,class:"mb-6"},nF={key:1,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},rF={class:"text-red-300 text-sm"},sF={key:2,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},iF={class:"text-green-300 text-sm"},oF={class:"flex justify-center gap-3"},aF=["disabled"],lF={__name:"PlayerClaimModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},seasonId:{type:String,default:null},onboarding:{type:Boolean,default:!1}},emits:["close","update","onboarding-finished"],setup(n,{emit:e}){const t=n,r=e,s=k(!1),i=k(!1),o=k(!1),a=k(""),l=k(""),c=k(!1);el();const d=k(!1);Oe(()=>!1),Oe(()=>!1);function f(){l.value="Compte cr et joueur associ !",s.value=!0,c.value=!1,r("update")}async function g(){var U;if((U=t.player)!=null&&U.id){s.value=await Ti(t.player.id,t.seasonId);try{const{isPlayerPasswordCached:q}=await Xt(()=>Promise.resolve().then(()=>mc),void 0);i.value=q(t.player.id)}catch{i.value=!1}}}function y(){var U;a.value="";try{if((U=t.player)!=null&&U.id&&xo(t.player.id)){T();return}}catch{}d.value=!0}async function T(){o.value=!0,a.value="",l.value="";try{const U=await bT(t.player.id,t.seasonId);l.value="Joueur dverrouill!",s.value=!1,U.email&&(email.value=U.email),r("update")}catch(U){logger.error("Erreur lors de la dsactivation de la protection",U),a.value="Erreur lors de la dsactivation de la protection. Veuillez ressayer."}finally{o.value=!1}}function A(){d.value=!1,T()}function P(){r("close")}return At(()=>t.player,()=>{t.show&&t.player&&g()},{immediate:!0}),At(()=>t.show,U=>{U&&t.player&&(a.value="",l.value="",d.value=!1,g(),t.onboarding&&pn(()=>{}))}),(U,q)=>{var M;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4",onClick:P},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:q[1]||(q[1]=Ft(()=>{},["stop"]))},[h("button",{onClick:P,class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},"  "),h("div",HL,[q[4]||(q[4]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),h("h2",WL,ce(s.value?"Dverrouiller ce joueur":"Verrouiller ce joueur"),1),h("p",QL,ce((M=n.player)==null?void 0:M.name),1)]),h("div",JL,[h("div",{class:xt(["flex items-center justify-between p-4 rounded-lg",s.value?"bg-green-500/20 border border-green-500/30":"bg-gray-500/20 border border-gray-500/30"])},[h("div",YL,[h("span",XL,ce(s.value?"":""),1),h("div",null,[h("div",ZL,ce(s.value?i.value?"Joueur associ  votre compte":"Ce joueur est associ  un compte utilisateur":"Joueur sans compte"),1),h("div",eF,ce(s.value?i.value?"Seul vous pouvez modifier":"Seul le titulaire peut modifier les disponibilits":"Tout le monde peut modifier les disponibilits"),1)])])],2)]),s.value?ve("",!0):(L(),F("div",tF,q[5]||(q[5]=[h("div",{class:"text-sm text-gray-300"},"Vous pouvez protger vos saisies de disponibilits avec un compte utilisateur.",-1)]))),a.value?(L(),F("div",nF,[h("div",rF,ce(a.value),1)])):ve("",!0),l.value?(L(),F("div",sF,[h("div",iF,ce(l.value),1)])):ve("",!0),h("div",oF,[h("button",{onClick:P,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer "),s.value?(L(),F("button",{key:1,onClick:y,disabled:o.value,class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"  Dissocier ",8,aF)):(L(),F("button",{key:0,onClick:q[0]||(q[0]=z=>c.value=!0),class:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300"}," Associer un compte "))]),s.value?ve("",!0):(L(),Sd(PT,{key:3}))])])):ve("",!0),ct(ST,{show:c.value,player:n.player,"season-id":n.seasonId,onClose:q[2]||(q[2]=z=>c.value=!1),onSuccess:f},null,8,["show","player","season-id"]),ct($g,{show:d.value,player:n.player,seasonId:n.seasonId,onClose:q[3]||(q[3]=z=>d.value=!1),onVerified:A},null,8,["show","player","seasonId"])],64)}}};const uF=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},cF={class:"relative text-center p-6 pb-4 border-b border-white/10"},dF={class:"text-2xl md:text-3xl font-bold text-white mb-1"},hF={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},fF={class:"grid grid-cols-3 gap-3 md:gap-4"},pF={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},mF={class:"text-xl md:text-2xl font-bold text-white"},gF={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},vF={class:"text-xl md:text-2xl font-bold text-white"},yF={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-3 md:p-4 rounded-lg border border-green-500/30"},_F={class:"text-xl md:text-2xl font-bold text-white"},bF={class:"hidden md:flex justify-center flex-wrap gap-3 mt-6"},wF={key:0,class:"md:hidden mt-3 space-y-2"},IF={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},EF={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},TF={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},xF={class:"mb-6"},AF={__name:"PlayerModal",props:{show:{type:Boolean,default:!1},player:{type:Object,default:null},stats:{type:Object,default:()=>({availability:0,selection:0,ratio:0})},seasonId:{type:String,default:null},onboardingStep:{type:Number,default:0},onboardingPlayerId:{type:[String,null],default:null}},emits:["close","update","delete","refresh","advance-onboarding"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=k(!1),o=k(""),a=k(null),l=k(!1),c=k(!1),d=k(null),f=k(!1),g=k(!1),y=k(!1);function T(){s("close")}function A(){var I;o.value=((I=r.player)==null?void 0:I.name)||"",i.value=!0,pn(()=>{a.value&&a.value.focus()})}function P(){i.value=!1,o.value=""}async function U(){var w,C;if(!o.value.trim())return;if(await Ti((w=r.player)==null?void 0:w.id,r.seasonId)){xo((C=r.player)==null?void 0:C.id)?q():(d.value="update",c.value=!0);return}q()}function q(){var I;s("update",{playerId:(I=r.player)==null?void 0:I.id,newName:o.value.trim()}),i.value=!1,o.value=""}async function M(){var w,C;if(await Ti((w=r.player)==null?void 0:w.id,r.seasonId)){xo((C=r.player)==null?void 0:C.id)?z():(d.value="delete",c.value=!0);return}z()}function z(){var I;s("delete",(I=r.player)==null?void 0:I.id)}function fe(){s("refresh")}function me(I){d.value==="update"?q():d.value==="delete"&&z(),d.value=null}At(()=>r.show,I=>{var w;I||(i.value=!1,o.value="",d.value=null,l.value=!1),I&&((w=r.player)!=null&&w.id)&&(Ti(r.player.id,r.seasonId).then(C=>{g.value=!!C}),Xt(()=>Promise.resolve().then(()=>mc),void 0).then(C=>{try{y.value=!!C.isPlayerPasswordCached(r.player.id)}catch{y.value=!1}}))}),e({openProtection(){l.value=!0}});const x=k({position:null});return At(()=>r.show,I=>{I&&r.onboardingStep===4?pn(()=>{const w=document.querySelectorAll("button");let C=null;if(w.forEach(V=>{!C&&V.textContent&&V.textContent.includes("Protection")&&(C=V)}),C){const V=C.getBoundingClientRect();x.value.position={x:Math.round(V.right+8),y:Math.round(V.top+window.scrollY-4)}}}):I||(x.value.position=null)}),(I,w)=>{var C;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:T},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:w[5]||(w[5]=Ft(()=>{},["stop"]))},[h("div",cF,[h("button",{onClick:T,class:"absolute right-3 top-3 text-white/80 hover:text-white"},""),w[10]||(w[10]=h("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[h("span",{class:"text-2xl md:text-3xl"},"")],-1)),h("h2",dF,ce((C=n.player)==null?void 0:C.name),1)]),h("div",hF,[h("div",null,[h("div",fF,[h("div",pF,[h("div",mF,ce(r.stats.availability),1),w[11]||(w[11]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibilits",-1))]),h("div",gF,[h("div",vF,ce(r.stats.selection),1),w[12]||(w[12]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Slections",-1))]),h("div",yF,[h("div",_F,ce(r.stats.ratio),1),w[13]||(w[13]=h("div",{class:"text-xs md:text-sm text-gray-300"},"% de slection",-1))])])]),h("div",bF,[h("button",{onClick:A,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},w[14]||(w[14]=[h("span",null,"",-1),h("span",null,"Renommer",-1)])),h("button",{onClick:w[0]||(w[0]=V=>l.value=!0),class:"px-5 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2"},[h("span",null,ce(g.value?"":""),1),h("span",null,ce(g.value?"Dverrouiller":"Verrouiller"),1)]),h("button",{onClick:M,class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},w[15]||(w[15]=[h("span",null,"",-1),h("span",null,"Supprimer",-1)])),h("button",{onClick:T,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")]),f.value?(L(),F("div",wF,[h("button",{onClick:w[1]||(w[1]=V=>{A(),f.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"},"  Renommer "),h("button",{onClick:w[2]||(w[2]=V=>{M(),f.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"},"  Supprimer ")])):ve("",!0)]),h("div",IF,[h("button",{onClick:w[3]||(w[3]=V=>l.value=!0),class:"h-12 px-4 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 flex-[1.4]"},ce(g.value?" Dverrouiller":" Verrouiller"),1),h("button",{onClick:T,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"}," Fermer "),h("button",{onClick:w[4]||(w[4]=V=>f.value=!f.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"},"  ")])])])):ve("",!0),i.value?(L(),F("div",EF,[h("div",TF,[w[17]||(w[17]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Renommer le joueur",-1)),h("div",xF,[w[16]||(w[16]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),nt(h("input",{"onUpdate:modelValue":w[6]||(w[6]=V=>o.value=V),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Mn(P,["esc"]),Mn(U,["enter"])],ref_key:"editNameInput",ref:a},null,544),[[Dt,o.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:P,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:U,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):ve("",!0),ct(lF,{show:l.value,player:n.player,seasonId:n.seasonId,onboarding:n.onboardingStep===4,onClose:w[7]||(w[7]=V=>l.value=!1),onUpdate:fe,onOnboardingFinished:w[8]||(w[8]=V=>I.$emit("advance-onboarding",5))},null,8,["show","player","seasonId","onboarding"]),ct($g,{show:c.value,player:n.player,seasonId:n.seasonId,onClose:w[9]||(w[9]=V=>c.value=!1),onVerified:me},null,8,["show","player","seasonId"])],64)}}},SF=uF(AF,[["__scopeId","data-v-731bb3fb"]]),PF={class:"relative p-6 pb-4 border-b border-white/10"},RF={class:"sticky bottom-0 p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex justify-end"},CF={__name:"HowItWorksModal",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=e;return(r,s)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[90] p-0 md:p-4",onClick:s[3]||(s[3]=i=>t("close"))},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:s[2]||(s[2]=Ft(()=>{},["stop"]))},[h("div",PF,[h("button",{onClick:s[0]||(s[0]=i=>t("close")),title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),s[4]||(s[4]=h("div",{class:"flex items-center gap-3"},[h("div",{class:"w-12 h-12 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-2xl"},""),h("div",null,[h("h2",{class:"text-xl md:text-2xl font-bold text-white"},"Comment fonctionne la slection automatique ?"),h("p",{class:"text-sm text-blue-300"},"Tirage au sort pondr pour favoriser l'quit")])],-1))]),s[5]||(s[5]=Jn('<div class="px-4 md:px-6 py-4 md:py-6 overflow-y-auto space-y-4 text-gray-200"><div class="bg-white/5 border border-white/10 rounded-lg p-4"><h3 class="text-white font-semibold mb-2">En bref</h3><p>On tire au sort uniquement parmi les joueurs <span class="text-green-300">disponibles</span>. Ceux qui ont <span class="text-purple-300">moins jou</span> ont plus de chances d&#39;tre tirs.  long terme, tout le monde joue  peu prs autant.</p></div><div class="space-y-3"><h3 class="text-white font-semibold">Dtails du tirage</h3><ol class="list-decimal list-inside space-y-2 text-gray-300"><li><span class="text-white">Qui participe ?</span> Tous les joueurs marqus  Disponible pour lvnement.</li><li><span class="text-white">Un coup de pouce aux moins jous</span>: si vous avez moins jou rcemment, le tirage vous favorise un peu plus.</li><li><span class="text-white">Comment se fait le tirage ?</span> On tire un nom au hasard en tenant compte de cet avantage, on le met de ct, puis on recommence jusqu avoir assez de joueurs.</li><li><span class="text-white">Si on relance</span>: on garde les joueurs encore disponibles et on complte seulement les places manquantes.</li><li><span class="text-white">Indisponibles</span>: ils ne sont jamais tirs au sort.</li></ol></div><div class="space-y-2"><h3 class="text-white font-semibold">Estimation des chances</h3><p>Lapplication peut afficher un pourcentage indicatif pour aider  comprendre: si Alice a moins jou que Bob, elle aura un pourcentage plus lev. Cest une indication, pas une promesse: deux tirages peuvent donner des rsultats diffrents.</p></div><div class="space-y-2"><h3 class="text-white font-semibold">Pourquoi cest juste</h3><ul class="list-disc list-inside space-y-1 text-gray-300"><li>Ceux qui ont moins jou ont automatiquement plus de chances.</li><li>Aprs une slection, vos chances diminuent un peu pour laisser la place aux autres.</li><li>Sur la dure, les slections s<span class="text-green-300">quilibrent naturellement</span>.</li></ul></div><div class="space-y-2"><h3 class="text-white font-semibold">Exemples rapides</h3><p>  Alice na encore jamais t slectionne, Bob a t slectionn une fois, Charlie plusieurs fois. Pour 1 place, on aura environ: Alice 57%, Bob 29%, Charlie 14%.<br>  Sil y a 2 places, les chances de chacun augmentent, mais lordre reste alatoire: un tirage peut donner Alice + Bob, un autre Alice + Charlie. </p></div><div class="text-xs text-gray-400"> Remarque: lalgorithme favorise lquit  long terme, mais <span class="text-gray-300">nassure pas</span> une rotation parfaite  chaque vnement. </div></div>',1)),h("div",RF,[h("button",{onClick:s[1]||(s[1]=i=>t("close")),class:"h-10 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600"},"Compris")])])])):ve("",!0)}},kF={class:"relative text-center p-6 pb-4 border-b border-white/10"},DF={class:"text-2xl md:text-3xl font-bold text-white mb-1"},NF={class:"text-sm md:text-base text-purple-300"},VF={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},OF={class:"mb-3"},MF={class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-0"},LF={key:0,class:"flex items-center justify-between gap-2"},FF=["title"],$F={key:0,class:"text-purple-400 mr-2"},UF={key:1,class:"text-green-400 mr-2"},jF={key:2,class:"text-red-400 mr-2"},BF={key:3,class:"text-gray-400 mr-2"},qF=["onClick"],zF={key:1,class:"flex items-center justify-center"},KF=["onChange"],GF=["value"],HF=["onClick"],WF={key:0,class:"mb-3"},QF={class:"grid grid-cols-3 gap-2 md:gap-3 mb-3"},JF={class:"p-3 md:p-3 rounded-lg border border-yellow-500/30 bg-yellow-500/10 text-center"},YF={class:"text-yellow-300 text-lg md:text-xl font-semibold"},XF={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},ZF={class:"text-green-400 text-lg md:text-xl font-semibold"},e4={class:"p-3 md:p-3 rounded-lg border border-white/10 bg-white/5 text-center"},t4={class:"text-purple-400 text-lg md:text-xl font-semibold"},n4={key:1,class:"mb-3"},r4={class:"flex items-center space-x-3 p-3 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/20"},s4={class:"flex-1"},i4={class:"text-blue-300 text-sm font-medium"},o4={class:"sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},a4=["disabled","title"],l4=["disabled"],u4=["disabled"],c4={__name:"SelectionModal",props:{show:{type:Boolean,default:!1},event:{type:Object,default:null},currentSelection:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},selectedCount:{type:Number,default:0},playerAvailability:{type:Object,default:()=>({})},seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},players:{type:Array,default:()=>[]}},emits:["close","selection","perfect","send-notifications","update-selection"],setup(n,{expose:e,emit:t}){const r=n,s=t,i=k(!1),o=k("Copier le message"),a=k(!1),l=k(!1),c=k(""),d=k(!1),f=k(!1),g=Oe(()=>{var re;return((re=r.event)==null?void 0:re.playerCount)||6}),y=k([]),T=k(null),A=Oe(()=>Array.from({length:g.value},(ee,je)=>{var Xe;return((Xe=r.currentSelection)==null?void 0:Xe[je])||null})),P=Oe(()=>JSON.stringify(y.value)!==JSON.stringify(A.value)),U=Oe(()=>(r.players||[]).map(re=>re.name).filter(re=>{var ee;return((ee=r.playerAvailability)==null?void 0:ee[re])===!0}).sort((re,ee)=>re.localeCompare(ee,"fr",{sensitivity:"base"})));function q(re){const ee=new Set(y.value.filter(Boolean)),je=y.value[re];return je&&ee.delete(je),U.value.filter(Xe=>!ee.has(Xe))}function M(re){T.value=re}function z(){T.value=null}function fe(re,ee){var Xe;const je=((Xe=re==null?void 0:re.target)==null?void 0:Xe.value)||"";je&&(y.value[ee]=je),T.value=null}function me(re){y.value[re]=null}Oe(()=>(q(-1).length<g.value,""));const x=Oe(()=>r.currentSelection&&r.currentSelection.length>0),I=Oe(()=>{var Xe;if(!x.value)return!1;const re=r.currentSelection.some(ht=>!Y(ht)),ee=((Xe=r.event)==null?void 0:Xe.playerCount)||6,je=r.availableCount<ee;return re||je});Oe(()=>{var je;if(!I.value)return"";const re=r.currentSelection.filter(Xe=>!Y(Xe)),ee=((je=r.event)==null?void 0:je.playerCount)||6;return re.length>0?re.length===1?`${re[0]} n'est plus disponible. Veuillez relancer la slection.`:`${re.length} joueurs ne sont plus disponibles. Veuillez relancer la slection.`:r.availableCount<ee?`Seulement ${r.availableCount} joueurs disponibles pour ${ee} requis. Veuillez attendre plus de disponibilits ou ajuster le nombre de joueurs  slectionner.`:"Slection incomplte"}),Oe(()=>{if(!r.event||!x.value)return"";const re=w(r.event.date),ee=r.currentSelection.join(", ");return`Slection pour ${r.event.title} du ${re} : ${ee}`}),At(()=>r.show,re=>{if(re){i.value=!1,o.value="Copier le message",l.value=!1,c.value="",d.value=!1,a.value=!1;const ee=Array.isArray(r.currentSelection)?[...r.currentSelection]:[],je=g.value;y.value=Array.from({length:je},(Xe,ht)=>ee[ht]||null),T.value=null}}),At([g,()=>r.currentSelection,()=>{var re;return(re=r.event)==null?void 0:re.id}],()=>{if(!r.show)return;const re=Array.isArray(r.currentSelection)?[...r.currentSelection]:[],ee=g.value,je=Array.from({length:ee},(Xe,ht)=>re[ht]||y.value[ht]||null);y.value=je.slice(0,ee)});function w(re){var je;return re?(typeof re=="string"?new Date(re):((je=re.toDate)==null?void 0:je.call(re))||re).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function C(){s("selection")}function V(){s("perfect")}function B(){var ee;if(!((ee=r.event)!=null&&ee.id))return;const re=y.value.filter(Boolean);s("update-selection",{eventId:r.event.id,players:re})}function R(){s("close")}function It(){a.value=!0}function vt(){f.value=!0}function Y(re){return r.playerAvailability[re]===!0}function j(re){return r.playerAvailability[re]===!1}function ne(re){return r.currentSelection.includes(re)&&Y(re)}function Ke(re=!1,ee=!1){if(d.value=re,re){const je=w(r.event.date),Xe=r.currentSelection.join(", ");ee?c.value=`Slection mise  jour pour ${r.event.title} du ${je} : ${Xe}`:c.value=`Nouvelle slection pour ${r.event.title} du ${je} : ${Xe}`}else c.value="Slection effectue avec succs !";l.value=!0,setTimeout(()=>{l.value=!1},8e3)}function Be(){l.value=!1}e({showSuccess:Ke});function Ge(re){s("send-notifications",re)}return(re,ee)=>{var je,Xe,ht;return L(),F(dt,null,[n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:R},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:ee[1]||(ee[1]=Ft(()=>{},["stop"]))},[h("div",kF,[h("button",{onClick:R,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),ee[5]||(ee[5]=h("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-3xl"},"")],-1)),h("h2",DF,"Slection pour "+ce((je=n.event)==null?void 0:je.title),1),h("p",NF,ce(w((Xe=n.event)==null?void 0:Xe.date)),1),h("div",{class:"mt-3"},[h("button",{onClick:vt,class:"inline-flex items-center gap-2 text-sm text-blue-300 hover:text-blue-200"},ee[4]||(ee[4]=[h("span",null,"",-1),Nt(),h("span",null,"Kezako ?",-1)]))])]),h("div",VF,[h("div",OF,[ee[8]||(ee[8]=h("h3",{class:"text-base md:text-lg font-semibold text-white mb-2"},"Joueurs slectionns",-1)),h("div",MF,[(L(!0),F(dt,null,wr(y.value,(D,$)=>(L(),F("div",{key:"sel-slot-"+$,class:xt(["relative p-3 rounded-lg border text-center transition-colors",D?["bg-gradient-to-r",j(D)?"from-yellow-500/20 to-orange-500/20 border-yellow-500/30":Y(D)?"from-green-500/20 to-emerald-500/20 border-green-500/30":"from-red-500/20 to-red-600/20 border-red-500/30"]:"border-dashed border-white/20 hover:border-white/40 bg-white/5"])},[D?(L(),F("div",LF,[h("div",{class:"flex-1 text-white font-medium truncate",title:D},[ne(D)?(L(),F("span",$F,"")):Y(D)?(L(),F("span",UF,"")):j(D)?(L(),F("span",jF,"")):(L(),F("span",BF,"")),Nt(" "+ce(D),1)],8,FF),h("button",{onClick:X=>me($),class:"text-white/80 hover:text-white rounded-full hover:bg-white/10 px-2 py-1",title:"Retirer ce joueur"},"  ",8,qF)])):(L(),F("div",zF,[T.value===$?(L(),F("select",{key:0,class:"w-full bg-gray-800 text-white rounded-md p-2 border border-white/20 focus:outline-none",onChange:X=>fe(X,$),onBlur:ee[0]||(ee[0]=X=>z())},[ee[6]||(ee[6]=h("option",{value:""}," Choisir ",-1)),(L(!0),F(dt,null,wr(q($),X=>(L(),F("option",{key:X,value:X},ce(X),9,GF))),128))],40,KF)):(L(),F("button",{key:1,onClick:X=>M($),class:"flex items-center gap-2 text-white/80 hover:text-white px-2 py-1 rounded-md hover:bg-white/10",title:"Ajouter un joueur"},ee[7]||(ee[7]=[h("span",{class:"text-lg"},"",-1),h("span",{class:"text-sm"},"Ajouter",-1)]),8,HF))]))],2))),128))])]),I.value?(L(),F("div",WF,ee[9]||(ee[9]=[h("div",{class:"flex items-center space-x-2 p-3 bg-yellow-500/10 rounded-lg border border-yellow-500/20"},[h("div",{class:"text-yellow-400"},""),h("div",{class:"text-yellow-200 text-sm"},"Slection incomplte. Vrifie ci-dessous.")],-1)]))):ve("",!0),h("div",QF,[h("div",JF,[h("div",YF,ce(Math.max((((ht=n.event)==null?void 0:ht.playerCount)||6)-n.selectedCount,0)),1),ee[10]||(ee[10]=h("div",{class:"text-xs md:text-sm text-yellow-300"},"manquants",-1))]),h("div",XF,[h("div",ZF,ce(n.availableCount),1),ee[11]||(ee[11]=h("div",{class:"text-xs md:text-sm text-gray-400"},"Disponibles",-1))]),h("div",e4,[h("div",t4,ce(n.selectedCount),1),ee[12]||(ee[12]=h("div",{class:"text-xs md:text-sm text-gray-400"},"Slectionns",-1))])]),l.value?(L(),F("div",n4,[h("div",r4,[ee[14]||(ee[14]=h("div",{class:"text-blue-400 text-xl"},"",-1)),h("div",s4,[h("p",i4,ce(c.value),1)]),h("button",{onClick:Be,class:"text-blue-400 hover:text-blue-300 transition-colors",title:"Fermer le message"},ee[13]||(ee[13]=[h("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):ve("",!0)]),h("div",o4,[h("button",{onClick:C,disabled:n.availableCount===0,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex-1 whitespace-nowrap",title:n.availableCount===0?"Aucun joueur disponible":x.value?"Relancer la slection automatique":"Lancer la slection automatique"},ee[15]||(ee[15]=[Nt("  "),h("span",{class:"hidden sm:inline"},"Slection Auto",-1),h("span",{class:"sm:hidden"},"Auto",-1)]),8,a4),h("button",{onClick:B,disabled:!P.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",title:"Enregistrer cette composition manuelle"},ee[16]||(ee[16]=[Nt("  "),h("span",{class:"hidden sm:inline"},"Enregistrer",-1),h("span",{class:"sm:hidden"},"Save",-1)]),8,l4),h("button",{onClick:It,disabled:!x.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex-1 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed"},ee[17]||(ee[17]=[Nt("  "),h("span",{class:"hidden sm:inline"},"Annoncer",-1)]),8,u4),x.value?(L(),F("button",{key:0,onClick:V,class:"h-12 px-3 md:px-4 bg-gray-700 text-white rounded-lg flex-1 whitespace-nowrap"},ee[18]||(ee[18]=[Nt("  "),h("span",{class:"hidden sm:inline"},"Fermer",-1)]))):ve("",!0)])])])):ve("",!0),ct(AT,{show:a.value,event:n.event,"season-id":n.seasonId,"season-slug":n.seasonSlug,players:n.players,mode:"selection","selected-players":n.currentSelection,onClose:ee[2]||(ee[2]=D=>a.value=!1),onSendNotifications:Ge},null,8,["show","event","season-id","season-slug","players","selected-players"]),ct(CF,{show:f.value,onClose:ee[3]||(ee[3]=D=>f.value=!1)},null,8,["show"])],64)}}},d4={class:"flex items-center justify-center gap-2"},h4=["title"],f4=["title"],p4=["title"],m4=["title"],g4=["title"],e0={__name:"AvailabilityCell",props:{playerName:{type:String,required:!0},compact:{type:Boolean,default:!1},eventId:{type:String,required:!0},isAvailable:{type:Boolean,default:null},isSelected:{type:Boolean,default:!1},chancePercent:{type:Number,default:null},showSelectedChance:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(n,{emit:e}){const t=n,r=e,s=k(!1),i=Oe(()=>!(t.chancePercent==null||t.isAvailable!==!0||t.isSelected&&!t.showSelectedChance)),o=Oe(()=>t.disabled?"vnement archiv  dsarchivez pour modifier":t.isSelected&&t.isAvailable===!0?i.value?`${t.playerName} est slectionn pour cet vnement  avait ~${t.chancePercent}% de chances`:`${t.playerName} est slectionn pour cet vnement`:t.isAvailable===!0?t.chancePercent!=null?`${t.playerName} est disponible  ~${t.chancePercent}% de chances d'tre slectionn`:`${t.playerName} est disponible`:t.isAvailable===!1?`${t.playerName} n'est pas disponible`:`Cliquer pour indiquer la disponibilit de ${t.playerName}`);function a(){t.disabled||r("toggle",t.playerName,t.eventId)}return(l,c)=>(L(),F("div",{class:xt(["flex items-center justify-center transition-all duration-200",[n.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-white/10",n.compact?"min-h-0 p-1 md:p-2":"min-h-20 p-3 md:p-5"]]),onClick:a,onMouseenter:c[0]||(c[0]=d=>s.value=!0),onMouseleave:c[1]||(c[1]=d=>s.value=!1)},[h("div",d4,[i.value&&s.value?(L(),F("span",{key:0,class:"text-[11px] md:text-xs px-2 py-0.5 rounded-full bg-emerald-500/15 border border-emerald-400/40 text-emerald-200",title:o.value},ce(n.chancePercent)+"% ",9,h4)):(L(),F(dt,{key:1},[n.isSelected&&n.isAvailable===!0?(L(),F("span",{key:0,class:xt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value},"  ",10,f4)):n.isAvailable===!0?(L(),F("span",{key:1,class:xt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value},"  ",10,p4)):n.isAvailable===!1?(L(),F("span",{key:2,class:xt([n.compact?"text-xl md:text-2xl":"text-2xl md:text-3xl","hover:scale-110 transition-transform duration-200"]),title:o.value},"  ",10,m4)):(L(),F("span",{key:3,class:xt(["text-gray-500 transition-colors duration-200",[n.compact?"text-base md:text-lg":"text-xl md:text-2xl",n.disabled?"":"hover:text-white"]]),title:o.value},"  ",10,g4))],64))])],34))}},v4={key:0,class:"fixed inset-0 z-[130] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4"},y4={class:"w-full max-w-xl bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl text-center"},_4={class:"text-2xl md:text-3xl font-bold text-white mb-3"},b4={class:"text-gray-300 mb-6"},w4={class:"flex flex-col items-stretch justify-center gap-3"},I4=["value"],E4={__name:"CreatorOnboardingModal",props:{seasonId:{type:String,default:""},seasonSlug:{type:String,default:""},playersCount:{type:Number,default:0},eventsCount:{type:Number,default:0},onboardingDone:{type:Boolean,default:!1}},emits:["create-event","add-player","copy-link","dismissed"],setup(n,{emit:e}){const t=n,r=e,s=window.location.origin,i=Oe(()=>`${s}/season/${t.seasonSlug}`),o=k(!1);try{t.seasonId&&(o.value=!!localStorage.getItem(`dismissCreatorOnboarding:${t.seasonId}`))}catch{}const a=Oe(()=>t.onboardingDone?0:t.eventsCount===0&&t.playersCount===0?1:t.eventsCount>0&&t.playersCount===0?2:t.eventsCount>0&&t.playersCount>0&&!o.value?3:0),l=Oe(()=>a.value>0),c=k(l.value);At(a,P=>{c.value=P>0});const d=Oe(()=>{switch(a.value){case 1:return"Commenons par crer votre premier vnement";case 2:return"Super ! Ajoutez votre premier joueur";case 3:return"Vous y tes presque! Maintenant, invitez vos joueurs.";default:return""}}),f=Oe(()=>{switch(a.value){case 1:return"Un titre, une date... et cest parti.";case 2:return"Ajoutez au moins un joueur pour commencer  saisir des disponibilits.";case 3:return"Laissez vos membres sinscrire eux-mme et indiquer leurs disponibilits en leur envoyant le lien direct.";default:return""}});function g(){c.value=!1,r("create-event")}function y(){c.value=!1,r("add-player")}function T(){var P;try{(P=navigator.clipboard)==null||P.writeText(i.value)}catch{}r("copy-link")}async function A(){try{if(t.seasonId){const{db:P}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0),{doc:U,updateDoc:q}=await Xt(()=>import("./index.esm-10fc9d63.js"),[]);await q(U(P,"seasons",t.seasonId),{onboardingCreatorDone:!0})}else localStorage.setItem("dismissCreatorOnboarding","1")}catch{}o.value=!0,c.value=!1,r("dismissed")}return(P,U)=>l.value&&c.value?(L(),F("div",v4,[h("div",y4,[U[1]||(U[1]=h("div",{class:"w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-6 flex items-center justify-center"},[h("span",{class:"text-3xl"},"")],-1)),h("h2",_4,ce(d.value),1),h("p",b4,ce(f.value),1),h("div",w4,[a.value===1?(L(),F("button",{key:0,onClick:g,class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all"},"  Crer un vnement ")):a.value===2?(L(),F("button",{key:1,onClick:y,class:"px-5 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all"},"  Ajouter un joueur ")):a.value===3?(L(),F(dt,{key:2},[h("input",{value:i.value,type:"text",readonly:"",class:"w-full px-3 py-2 bg-gray-800 border border-white/20 rounded-lg text-white text-sm select-all",onFocus:U[0]||(U[0]=q=>q.target.select())},null,40,I4),h("div",{class:"flex gap-3 justify-center"},[h("button",{onClick:T,class:"px-5 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-all"},"  Copier le lien "),h("button",{onClick:A,class:"px-5 py-3 bg-transparent text-gray-300 border border-white/20 rounded-lg hover:bg-white/10 transition-all"}," Jai compris ")])],64)):ve("",!0)])])])):ve("",!0)}},RT="@firebase/installations",Ug="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=1e4,kT=`w:${Ug}`,DT="FIS_v2",T4="https://firebaseinstallations.googleapis.com/v1",x4=60*60*1e3,A4="installations",S4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Mo=new Fo(A4,S4,P4);function NT(n){return n instanceof os&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT({projectId:n}){return`${T4}/projects/${n}/installations`}function OT(n){return{token:n.token,requestStatus:2,expiresIn:C4(n.expiresIn),creationTime:Date.now()}}async function MT(n,e){const r=(await e.json()).error;return Mo.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function LT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function R4(n,{refreshToken:e}){const t=LT(n);return t.append("Authorization",k4(e)),t}async function FT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function C4(n){return Number(n.replace("s","000"))}function k4(n){return`${DT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=VT(n),s=LT(n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:t,authVersion:DT,appId:n.appId,sdkVersion:kT},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await FT(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:OT(c.authToken)}}else throw await MT("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N4(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4=/^[cdef][\w-]{21}$/,Bp="";function O4(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=M4(n);return V4.test(t)?t:Bp}catch{return Bp}}function M4(n){return N4(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT=new Map;function jT(n,e){const t=Xh(n);BT(t,e),L4(t,e)}function BT(n,e){const t=UT.get(n);if(t)for(const r of t)r(e)}function L4(n,e){const t=F4();t&&t.postMessage({key:n,fid:e}),$4()}let bo=null;function F4(){return!bo&&"BroadcastChannel"in self&&(bo=new BroadcastChannel("[Firebase] FID Change"),bo.onmessage=n=>{BT(n.data.key,n.data.fid)}),bo}function $4(){UT.size===0&&bo&&(bo.close(),bo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U4="firebase-installations-database",j4=1,Lo="firebase-installations-store";let jf=null;function jg(){return jf||(jf=mh(U4,j4,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Lo)}}})),jf}async function eh(n,e){const t=Xh(n),s=(await jg()).transaction(Lo,"readwrite"),i=s.objectStore(Lo),o=await i.get(t);return await i.put(e,t),await s.done,(!o||o.fid!==e.fid)&&jT(n,e.fid),e}async function qT(n){const e=Xh(n),r=(await jg()).transaction(Lo,"readwrite");await r.objectStore(Lo).delete(e),await r.done}async function Zh(n,e){const t=Xh(n),s=(await jg()).transaction(Lo,"readwrite"),i=s.objectStore(Lo),o=await i.get(t),a=e(o);return a===void 0?await i.delete(t):await i.put(a,t),await s.done,a&&(!o||o.fid!==a.fid)&&jT(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bg(n){let e;const t=await Zh(n.appConfig,r=>{const s=B4(r),i=q4(n,s);return e=i.registrationPromise,i.installationEntry});return t.fid===Bp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function B4(n){const e=n||{fid:O4(),registrationStatus:0};return zT(e)}function q4(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Mo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=z4(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:K4(n)}:{installationEntry:e}}async function z4(n,e){try{const t=await D4(n,e);return eh(n.appConfig,t)}catch(t){throw NT(t)&&t.customData.serverCode===409?await qT(n.appConfig):await eh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function K4(n){let e=await t0(n.appConfig);for(;e.registrationStatus===1;)await $T(100),e=await t0(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await Bg(n);return r||t}return e}function t0(n){return Zh(n,e=>{if(!e)throw Mo.create("installation-not-found");return zT(e)})}function zT(n){return G4(n)?{fid:n.fid,registrationStatus:0}:n}function G4(n){return n.registrationStatus===1&&n.registrationTime+CT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4({appConfig:n,heartbeatServiceProvider:e},t){const r=W4(n,t),s=R4(n,t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:kT,appId:n.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await FT(()=>fetch(r,a));if(l.ok){const c=await l.json();return OT(c)}else throw await MT("Generate Auth Token",l)}function W4(n,{fid:e}){return`${VT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qg(n,e=!1){let t;const r=await Zh(n.appConfig,i=>{if(!KT(i))throw Mo.create("not-registered");const o=i.authToken;if(!e&&Y4(o))return i;if(o.requestStatus===1)return t=Q4(n,e),i;{if(!navigator.onLine)throw Mo.create("app-offline");const a=Z4(i);return t=J4(n,a),a}});return t?await t:r.authToken}async function Q4(n,e){let t=await n0(n.appConfig);for(;t.authToken.requestStatus===1;)await $T(100),t=await n0(n.appConfig);const r=t.authToken;return r.requestStatus===0?qg(n,e):r}function n0(n){return Zh(n,e=>{if(!KT(e))throw Mo.create("not-registered");const t=e.authToken;return e3(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function J4(n,e){try{const t=await H4(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await eh(n.appConfig,r),t}catch(t){if(NT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await qT(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await eh(n.appConfig,r)}throw t}}function KT(n){return n!==void 0&&n.registrationStatus===2}function Y4(n){return n.requestStatus===2&&!X4(n)}function X4(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+x4}function Z4(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function e3(n){return n.requestStatus===1&&n.requestTime+CT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t3(n){const e=n,{installationEntry:t,registrationPromise:r}=await Bg(e);return r?r.catch(console.error):qg(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n3(n,e=!1){const t=n;return await r3(t),(await qg(t,e)).token}async function r3(n){const{registrationPromise:e}=await Bg(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s3(n){if(!n||!n.options)throw Bf("App Configuration");if(!n.name)throw Bf("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Bf(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Bf(n){return Mo.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="installations",i3="installations-internal",o3=n=>{const e=n.getProvider("app").getImmediate(),t=s3(e),r=Li(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},a3=n=>{const e=n.getProvider("app").getImmediate(),t=Li(e,GT).getImmediate();return{getId:()=>t3(t),getToken:s=>n3(t,s)}};function l3(){ss(new $r(GT,o3,"PUBLIC")),ss(new $r(i3,a3,"PRIVATE"))}l3();Er(RT,Ug);Er(RT,Ug,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3="/firebase-messaging-sw.js",c3="/firebase-cloud-messaging-push-scope",HT="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",d3="https://fcmregistrations.googleapis.com/v1",WT="google.c.a.c_id",h3="google.c.a.c_l",f3="google.c.a.ts",p3="google.c.a.e";var r0;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(r0||(r0={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var qu;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(qu||(qu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function m3(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf="fcm_token_details_db",g3=5,s0="fcm_token_object_Store";async function v3(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(qf))return null;let e=null;return(await mh(qf,g3,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(s0))return;const l=o.objectStore(s0),c=await l.index("fcmSenderId").get(n);if(await l.clear(),!!c){if(s===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:vs(d.vapidKey)}}}else if(s===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:vs(d.auth),p256dh:vs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:vs(d.vapidKey)}}}else if(s===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:vs(d.auth),p256dh:vs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:vs(d.vapidKey)}}}}}})).close(),await Sf(qf),await Sf("fcm_vapid_details_db"),await Sf("undefined"),y3(e)?e:null}function y3(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3="firebase-messaging-database",b3=1,zu="firebase-messaging-store";let zf=null;function QT(){return zf||(zf=mh(_3,b3,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(zu)}}})),zf}async function w3(n){const e=JT(n),r=await(await QT()).transaction(zu).objectStore(zu).get(e);if(r)return r;{const s=await v3(n.appConfig.senderId);if(s)return await zg(n,s),s}}async function zg(n,e){const t=JT(n),s=(await QT()).transaction(zu,"readwrite");return await s.objectStore(zu).put(e,t),await s.done,e}function JT({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},er=new Fo("messaging","Messaging",I3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E3(n,e){const t=await Gg(n),r=YT(e),s={method:"POST",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(Kg(n.appConfig),s)).json()}catch(o){throw er.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw er.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw er.create("token-subscribe-no-token");return i.token}async function T3(n,e){const t=await Gg(n),r=YT(e.subscriptionOptions),s={method:"PATCH",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${Kg(n.appConfig)}/${e.token}`,s)).json()}catch(o){throw er.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw er.create("token-update-failed",{errorInfo:o})}if(!i.token)throw er.create("token-update-no-token");return i.token}async function x3(n,e){const r={method:"DELETE",headers:await Gg(n)};try{const i=await(await fetch(`${Kg(n.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw er.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw er.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function Kg({projectId:n}){return`${d3}/projects/${n}/registrations`}async function Gg({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function YT({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const s={web:{endpoint:t,auth:e,p256dh:n}};return r!==HT&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=7*24*60*60*1e3;async function S3(n){const e=await R3(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:vs(e.getKey("auth")),p256dh:vs(e.getKey("p256dh"))},r=await w3(n.firebaseDependencies);if(r){if(C3(r.subscriptionOptions,t))return Date.now()>=r.createTime+A3?P3(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await x3(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return i0(n.firebaseDependencies,t)}else return i0(n.firebaseDependencies,t)}async function P3(n,e){try{const t=await T3(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return await zg(n.firebaseDependencies,r),t}catch(t){throw t}}async function i0(n,e){const r={token:await E3(n,e),createTime:Date.now(),subscriptionOptions:e};return await zg(n,r),r.token}async function R3(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:m3(e)})}function C3(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,s=e.auth===n.auth,i=e.p256dh===n.p256dh;return t&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return k3(e,n),D3(e,n),N3(e,n),e}function k3(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const s=e.notification.image;s&&(n.notification.image=s);const i=e.notification.icon;i&&(n.notification.icon=i)}function D3(n,e){e.data&&(n.data=e.data)}function N3(n,e){var t,r,s,i,o;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(n.fcmOptions.link=a);const l=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;l&&(n.fcmOptions.analyticsLabel=l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(n){return typeof n=="object"&&!!n&&WT in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */O3("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function O3(n,e){const t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M3(n){if(!n||!n.options)throw Kf("App Configuration Object");if(!n.name)throw Kf("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw Kf(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Kf(n){return er.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=M3(e);this.firebaseDependencies={app:e,appConfig:s,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F3(n){try{n.swRegistration=await navigator.serviceWorker.register(u3,{scope:c3}),n.swRegistration.update().catch(()=>{})}catch(e){throw er.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $3(n,e){if(!e&&!n.swRegistration&&await F3(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw er.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U3(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=HT)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XT(n,e){if(!navigator)throw er.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw er.create("permission-blocked");return await U3(n,e==null?void 0:e.vapidKey),await $3(n,e==null?void 0:e.serviceWorkerRegistration),S3(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j3(n,e,t){const r=B3(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[WT],message_name:t[h3],message_time:t[f3],message_device_time:Math.floor(Date.now()/1e3)})}function B3(n){switch(n){case qu.NOTIFICATION_CLICKED:return"notification_open";case qu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q3(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===qu.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(o0(t)):n.onMessageHandler.next(o0(t)));const r=t.data;V3(r)&&r[p3]==="1"&&await j3(n,t.messageType,r)}const a0="@firebase/messaging",l0="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=n=>{const e=new L3(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>q3(e,t)),e},K3=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>XT(e,r)}};function G3(){ss(new $r("messaging",z3,"PUBLIC")),ss(new $r("messaging-internal",K3,"PRIVATE")),Er(a0,l0),Er(a0,l0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZT(){try{await Lb()}catch{return!1}return typeof window<"u"&&cm()&&eP()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H3(n=fm()){return ZT().then(e=>{if(!e)throw er.create("unsupported-browser")},e=>{throw er.create("indexed-db-unsupported")}),Li(Ne(n),"messaging").getImmediate()}async function W3(n,e){return n=Ne(n),XT(n,e)}G3();const u0="BCp_LGds4qlhPqneNocMDmN2dv6iF11IVY3ZfS-3PxrkVbLzPR_Sm3v8aiiNzKhOSRFM_BpncKbxum9M333w-N8";async function ex(){try{return await ZT()}catch{return!1}}async function Q3(){if(typeof navigator>"u"||!navigator.serviceWorker)return null;const n=await navigator.serviceWorker.ready;if(n!=null&&n.active&&n.active.state==="activated")return n;const e=(n==null?void 0:n.installing)||(n==null?void 0:n.waiting);return!e||e.state==="activated"||await new Promise(t=>{const r=()=>{e.state==="activated"&&(e.removeEventListener("statechange",r),t())};e.addEventListener("statechange",r)}),n}async function J3(n){var i;if(!await ex()||await Notification.requestPermission()!=="granted")return null;const t=H3(Wh);let r=n||await Q3();const s=await W3(t,r?{vapidKey:u0,serviceWorkerRegistration:r}:{vapidKey:u0});try{const o=((i=gt==null?void 0:gt.currentUser)==null?void 0:i.email)||"anonymous";o&&s&&await Zt(xe(ae,"userPushTokens",o),{tokens:JD(s),lastToken:s,email:o,updatedAt:qi(),userAgent:navigator.userAgent},{merge:!0})}catch{}return s}const Y3={class:"flex justify-center gap-2 mb-4"},X3={class:"space-y-3"},Z3={key:0},e$={key:0,class:"text-sm text-gray-400"},t$={key:1,class:"space-y-2"},n$={class:"flex items-center justify-between gap-3"},r$={class:"truncate"},s$={class:"text-white font-semibold"},i$={class:"text-gray-400 text-xs"},o$=["onClick"],a$={key:1,class:"text-sm text-gray-300 space-y-3"},l$={class:"p-3 rounded-lg border border-white/10 bg-white/5 space-y-3"},u$={class:"flex items-center justify-between"},c$={class:"flex items-center gap-2"},d$={class:"flex items-center justify-between"},h$={class:"flex items-center gap-2"},f$={class:"p-3 rounded-lg border border-white/10 bg-white/5 space-y-3"},p$={class:"flex items-center justify-between"},m$={class:"flex items-center gap-2"},g$={class:"flex items-center justify-between"},v$={class:"flex items-center gap-2"},y$={class:"flex items-center justify-between pt-2 border-t border-white/10"},_$=["disabled"],b$={key:1,class:"inline-flex items-center text-xs text-gray-300"},w$={class:"flex items-center justify-between pt-2"},I$=["disabled"],E$={key:0,class:"text-xs text-green-300"},T$={key:1,class:"text-xs text-red-300"},x$={key:2,class:"text-[10px] text-gray-400 break-all"},A$={class:"text-[10px] text-gray-500"},S$={class:"text-right"},P$=["disabled"],R$={key:0,class:"text-xs text-red-300"},C$={key:1,class:"text-xs text-green-300"},k$={key:2,class:"flex flex-col gap-3"},D$={class:"p-3 rounded-lg border border-white/10 bg-white/5 text-sm text-gray-300"},N$={class:"flex items-center gap-2"},V$=["disabled"],O$={key:0,class:"mt-2 text-xs text-red-300"},M$={key:1,class:"mt-2 text-xs text-green-300"},L$={__name:"AccountMenu",props:{show:{type:Boolean,default:!1},seasonId:{type:String,default:null}},emits:["close","manage-player","change-password","logout-device","delete-account"],setup(n,{emit:e}){const t=n,r=e,s=k(""),i=k([]),o=k("players");function a(Y){return["px-4 py-2 rounded-full text-sm transition-colors",o.value===Y?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10"]}function l(Y){return`${Y.seasonId||"global"}__${Y.playerId}`}async function c(){var Y;try{s.value=((Y=gt==null?void 0:gt.currentUser)==null?void 0:Y.email)||""}catch{}try{const j=s.value?await Fg(s.value):[],ne=[];for(const Ke of j){let Be=Ke.playerId;try{if(Ke.seasonId){const Ge=xe(ae,"seasons",Ke.seasonId,"players",Ke.playerId),re=await Gt(Ge);re.exists()&&(Be=re.data().name||Be)}}catch{}ne.push({...Ke,playerName:Be})}i.value=ne}catch{i.value=[]}}function d(){r("close")}At(()=>t.show,Y=>{Y&&(c(),B())}),Xn(()=>{t.show&&(c(),B())});const f=k(""),g=k(!1),y=k(""),T=k(""),A=k(!1);At(s,Y=>{f.value=Y||""}),At(f,Y=>{A.value=!!Y&&Y.includes("@")&&Y!==s.value});async function P(){if(A.value){g.value=!0,y.value="",T.value="";try{const Y=await hT({currentEmail:s.value,newEmail:f.value.trim()});await xT({toEmail:f.value.trim(),verifyUrl:Y.url,purpose:"account_email_update",displayName:"utilisateur"}),T.value=`Un email de vrification a t envoy  ${f.value.trim()}. Cliquez sur le lien pour confirmer le changement.`}catch(Y){y.value=(Y==null?void 0:Y.code)==="auth/requires-recent-login"?"Veuillez vous reconnecter pour modifier votre email":"Impossible de mettre  jour l'email"}finally{g.value=!1}}}const U=k({notifyAvailability:!0,notifySelection:!0,notifySelectionPush:!0,notifyAvailabilityPush:!0}),q=k(!1),M=k(""),z=k(""),fe=k(!1),me=k(""),x=k(""),I=k(!1),w=k(localStorage.getItem("fcmToken")||""),C=k(!1),V=function(j){try{return j?j.length>20?j.slice(0,8)+""+j.slice(-6):j:""}catch{return""}}("BCp_LGds4qlhPqneNocMDmN2dv6iF11IVY3ZfS-3PxrkVbLzPR_Sm3v8aiiNzKhOSRFM_BpncKbxum9M333w-N8");async function B(){try{if(!s.value)return;const Y=xe(ae,"userPreferences",s.value),j=await Gt(Y);if(j.exists()){const ne=j.data()||{};U.value.notifyAvailability=ne.notifyAvailability!==!1,U.value.notifySelection=ne.notifySelection!==!1,U.value.notifySelectionPush=ne.notifySelectionPush!==!1,U.value.notifyAvailabilityPush=ne.notifyAvailabilityPush!==!1}else U.value={notifyAvailability:!0,notifySelection:!0,notifySelectionPush:!0,notifyAvailabilityPush:!0}}catch{}}async function R(){if(s.value){fe.value=!0,x.value="",me.value="";try{await gc({toEmail:s.value,title:"Test Impro Selector",body:"Ceci est un test de notification",data:{url:"/"},reason:"manual_test"}),me.value="OK"}catch{x.value="chec de l'envoi du test"}finally{fe.value=!1}}}async function It(){try{if(I.value=!0,!await ex()){x.value="Push non support sur cet appareil";return}const j=window.__swReg,ne=await J3(j);if(ne){w.value=ne;try{localStorage.setItem("fcmToken",ne)}catch{}C.value=!0}}catch(Y){const j=typeof Notification<"u"?Notification.permission:"unknown",ne=Y&&(Y.message||Y.code)?` (${Y.message||Y.code})`:"";x.value=`Activation impossible  permission: ${j}${ne}`}finally{I.value=!1}}Xn(()=>{try{C.value=typeof Notification<"u"&&Notification.permission==="granted"&&!!localStorage.getItem("fcmToken")}catch{C.value=!1}});async function vt(){if(s.value){q.value=!0,M.value="",z.value="";try{const Y=xe(ae,"userPreferences",s.value);await Zt(Y,{...U.value},{merge:!0}),z.value="Prfrences sauvegardes"}catch{M.value="Impossible de sauvegarder vos prfrences"}finally{q.value=!1}}}return(Y,j)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[150] p-4",onClick:d},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-xl",onClick:j[11]||(j[11]=Ft(()=>{},["stop"]))},[h("button",{onClick:d,class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},""),j[25]||(j[25]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-indigo-400 to-cyan-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-1">Mon compte</h2><p class="text-sm text-gray-300">Grez votre compte et vos prfrences</p></div>',1)),h("div",Y3,[h("button",{onClick:j[0]||(j[0]=ne=>o.value="manage"),class:xt(a("manage"))},"Grer",2),h("button",{onClick:j[1]||(j[1]=ne=>o.value="notifications"),class:xt(a("notifications"))},"Notifications",2),h("button",{onClick:j[2]||(j[2]=ne=>o.value="players"),class:xt(a("players"))},"Joueurs",2)]),h("div",X3,[o.value==="players"?(L(),F("div",Z3,[j[12]||(j[12]=h("h3",{class:"text-white font-semibold mb-2"},"Mes joueurs associs",-1)),i.value.length===0?(L(),F("div",e$,"Aucun joueur associ pour le moment.")):(L(),F("ul",t$,[(L(!0),F(dt,null,wr(i.value,ne=>(L(),F("li",{key:l(ne),class:"p-3 rounded-lg border border-white/10 bg-white/5 text-sm text-gray-300"},[h("div",n$,[h("div",r$,[h("div",s$,ce(ne.seasonName||ne.seasonId||""),1),h("div",i$,"Joueur : "+ce(ne.playerName||""),1)]),h("button",{onClick:Ke=>Y.$emit("manage-player",ne),class:"px-3 py-2 rounded-lg bg-gray-700 text-white hover:bg-gray-600 text-xs"},"Grer",8,o$)])]))),128))]))])):o.value==="notifications"?(L(),F("div",a$,[h("div",l$,[j[15]||(j[15]=h("div",{class:"text-white font-semibold text-sm mb-1"},"Emails",-1)),h("div",u$,[h("label",c$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[3]||(j[3]=ne=>U.value.notifyAvailability=ne),class:"w-4 h-4"},null,512),[[yi,U.value.notifyAvailability]]),j[13]||(j[13]=h("span",null,"M'envoyer un email lorsqu'un vnement a besoin de joueurs",-1))])]),h("div",d$,[h("label",h$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[4]||(j[4]=ne=>U.value.notifySelection=ne),class:"w-4 h-4"},null,512),[[yi,U.value.notifySelection]]),j[14]||(j[14]=h("span",null,"M'envoyer un email lorsque je suis concern par une slection",-1))])])]),h("div",f$,[j[21]||(j[21]=h("div",{class:"text-white font-semibold text-sm mb-1"},"Push (exprimental)",-1)),j[22]||(j[22]=h("div",{class:"text-xs text-emerald-200 mb-1"},"Fonctionnalit en test: activable uniquement ici.",-1)),h("div",p$,[h("label",m$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[5]||(j[5]=ne=>U.value.notifySelectionPush=ne),class:"w-4 h-4"},null,512),[[yi,U.value.notifySelectionPush]]),j[16]||(j[16]=h("span",null,"Me notifier lorsque je suis concern par une slection",-1))])]),h("div",g$,[h("label",v$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":j[6]||(j[6]=ne=>U.value.notifyAvailabilityPush=ne),class:"w-4 h-4"},null,512),[[yi,U.value.notifyAvailabilityPush]]),j[17]||(j[17]=h("span",null,"Me notifier lorsqu'un vnement a besoin de joueurs",-1))])]),h("div",y$,[j[19]||(j[19]=h("div",{class:"text-xs text-gray-400"},"Notifications sur cet appareil",-1)),C.value?(L(),F("span",b$,j[18]||(j[18]=[h("span",{class:"mr-1 text-emerald-400"},"",-1),Nt(" Actif ")]))):(L(),F("button",{key:0,onClick:It,disabled:I.value,class:"px-3 py-1 rounded bg-emerald-600 text-white text-xs hover:bg-emerald-500 disabled:opacity-50"},ce(I.value?"...":"Activer"),9,_$))]),h("div",w$,[j[20]||(j[20]=h("div",{class:"text-xs text-gray-400"},"Test de notification push",-1)),h("button",{onClick:R,disabled:fe.value||!s.value,class:"px-3 py-1 rounded bg-emerald-600 text-white text-xs hover:bg-emerald-500 disabled:opacity-50"},ce(fe.value?"Envoi":"Envoyer un test"),9,I$)]),me.value?(L(),F("div",E$,"Notification test envoye (vrifiez votre appareil)")):ve("",!0),x.value?(L(),F("div",T$,ce(x.value),1)):ve("",!0),w.value?(L(),F("div",x$,"FCM token: "+ce(w.value),1)):ve("",!0),h("div",A$,"VAPID: "+ce(Xr(V)||"indisponible"),1)]),h("div",S$,[h("button",{onClick:vt,disabled:q.value,class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-500 disabled:opacity-50"},ce(q.value?"":"Sauvegarder"),9,P$)]),M.value?(L(),F("div",R$,ce(M.value),1)):ve("",!0),z.value?(L(),F("div",C$,ce(z.value),1)):ve("",!0)])):(L(),F("div",k$,[h("div",D$,[j[23]||(j[23]=h("label",{class:"block text-xs text-gray-400 mb-2"},"Email",-1)),h("div",N$,[nt(h("input",{"onUpdate:modelValue":j[7]||(j[7]=ne=>f.value=ne),type:"email",class:"flex-1 p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"nouvel@email.com"},null,512),[[Dt,f.value]]),h("button",{onClick:P,disabled:!A.value||g.value,class:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},ce(g.value?"":"Mettre  jour"),9,V$)]),y.value?(L(),F("div",O$,ce(y.value),1)):ve("",!0),T.value?(L(),F("div",M$,ce(T.value),1)):ve("",!0)]),j[24]||(j[24]=h("div",{class:"text-sm text-gray-400"},"Vous pouvez changer votre mot de passe pour scuriser vos oprations sensibles.",-1)),h("button",{onClick:j[8]||(j[8]=ne=>Y.$emit("change-password")),class:"w-full px-4 py-3 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500"},"Changer de mot de passe"),h("button",{onClick:j[9]||(j[9]=ne=>Y.$emit("logout-device")),class:"w-full px-4 py-3 rounded-lg bg-gray-700 text-white hover:bg-gray-600"},"Dconnexion de cet appareil"),h("button",{onClick:j[10]||(j[10]=ne=>Y.$emit("delete-account")),class:"w-full px-4 py-3 rounded-lg bg-red-600 text-white hover:bg-red-500"},"Supprimer mon compte")]))]),h("div",{class:"mt-6 text-center"},[h("button",{onClick:d,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800"},"Fermer")])])])):ve("",!0)}},F$={class:"space-y-4"},$$={class:"flex items-center justify-between"},U$={class:"flex items-center gap-2 text-gray-300 text-sm"},j$={key:0,class:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm"},B$={key:1,class:"p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm"},q$={class:"flex justify-center gap-3 mt-2"},z$=["disabled"],K$={key:0,class:"animate-spin"},G$={key:1},H$={__name:"AccountLoginModal",props:{show:{type:Boolean,default:!1}},emits:["close","success"],setup(n,{emit:e}){const t=e,r=k(""),s=k(""),i=k(!1),o=k(""),a=k(""),l=k(!0),c=Oe(()=>!!r.value&&r.value.includes("@")&&!!s.value);async function d(){if(c.value){i.value=!0,o.value="",a.value="";try{if(await tT(r.value.trim(),s.value),l.value)try{Oi.saveSession(r.value.trim())}catch{}t("success")}catch{o.value="Email ou mot de passe incorrect"}finally{i.value=!1}}}async function f(){if(!r.value||!r.value.includes("@")){o.value="Saisissez votre email pour recevoir un lien de rinitialisation",setTimeout(()=>{o.value=""},2500);return}i.value=!0,o.value="",a.value="";try{await nT(r.value.trim()),a.value="Email de rinitialisation envoy"}catch{o.value="Impossible d'envoyer l'email de rinitialisation"}finally{i.value=!1}}return(g,y)=>n.show?(L(),F("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[170] p-4",onClick:y[6]||(y[6]=T=>g.$emit("close"))},[h("div",{class:"relative bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl w-full max-w-md",onClick:y[5]||(y[5]=Ft(()=>{},["stop"]))},[h("button",{onClick:y[0]||(y[0]=T=>g.$emit("close")),class:"absolute right-3 top-3 text-white/80 hover:text-white","aria-label":"Fermer",title:"Fermer"},""),y[10]||(y[10]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-1">Mon compte</h2><p class="text-sm text-gray-300">Connectez-vous pour grer votre compte et vos prfrences</p></div>',1)),h("div",F$,[ct(PT),h("div",null,[y[7]||(y[7]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Email",-1)),nt(h("input",{"onUpdate:modelValue":y[1]||(y[1]=T=>r.value=T),type:"email",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"votre@email.com"},null,512),[[Dt,r.value]])]),h("div",null,[y[8]||(y[8]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":y[2]||(y[2]=T=>s.value=T),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Mot de passe"},null,512),[[Dt,s.value]])]),h("div",$$,[h("label",U$,[nt(h("input",{type:"checkbox","onUpdate:modelValue":y[3]||(y[3]=T=>l.value=T),class:"w-4 h-4"},null,512),[[yi,l.value]]),y[9]||(y[9]=h("span",null,"Rester connect sur cet appareil",-1))]),h("button",{onClick:f,class:"text-sm text-blue-400 hover:text-blue-300 underline"},"Mot de passe oubli ?")]),o.value?(L(),F("div",j$,ce(o.value),1)):ve("",!0),a.value?(L(),F("div",B$,ce(a.value),1)):ve("",!0),h("div",q$,[h("button",{onClick:y[4]||(y[4]=T=>g.$emit("close")),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer"),h("button",{onClick:d,disabled:!c.value||i.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},[i.value?(L(),F("span",K$,"")):(L(),F("span",G$,"Se connecter"))],8,z$)])])])])):ve("",!0)}};const W$={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},Q$={ref:"pageHeaderRef",class:"sticky top-0 z-[60] text-center py-4 md:py-6 px-4 relative bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900/95 backdrop-blur-sm border-b border-white/10"},J$={class:"text-4xl font-bold text-white mb-0 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},Y$={class:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2"},X$={class:"hidden md:flex items-center gap-2"},Z$={class:"w-full px-0 md:px-0 pb-0 pt-[72px] md:pt-[80px] -mt-[72px] md:-mt-[80px] bg-gray-900"},e6={class:"flex items-stretch relative"},t6={key:0,class:"col-left flex-shrink-0 p-3 md:p-4 sticky left-0 z-[81] bg-gray-900 h-full"},n6={class:"flex-1 overflow-hidden"},r6=["data-event-id","onClick"],s6=["title"],i6=["title"],o6={key:0,class:"mt-1 text-xs text-gray-400"},a6=["title","onClick"],l6=["title","onClick"],u6=["title","aria-label"],c6={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},d6={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3l18 18"},h6={key:0,class:"pointer-events-none"},f6={class:"flex items-center justify-between"},p6={key:1,class:"pointer-events-none"},m6={id:"coachmark-avail",class:"coachmark pointer-events-auto max-w-sm bg-gray-900 border border-pink-500/40 rounded-xl shadow-2xl p-3 text-white relative"},g6={class:"flex items-center justify-between"},v6={key:2,class:"pointer-events-none"},y6={id:"coachmark-name",class:"coachmark pointer-events-auto max-w-sm bg-gray-900 border border-yellow-500/40 rounded-xl shadow-2xl p-3 text-white relative"},_6={class:"flex items-center justify-between"},b6={class:"table-auto border-separate border-spacing-0 table-fixed w-auto min-w-max"},w6=["data-player-id"],I6={class:"px-0 py-4 md:py-5 font-medium text-white relative group text-xl md:text-2xl sticky left-0 z-40 bg-gray-900 left-col-td"},E6={class:"px-4 md:px-5 font-bold text-xl md:text-2xl flex items-center w-full min-w-0"},T6={key:0,class:"text-yellow-400 mr-1 text-sm",title:"Mon joueur"},x6={key:1,class:"text-yellow-400 mr-1 text-sm",title:"Joueur protg par mot de passe"},A6=["onClick","title"],S6=["data-event-id"],P6={class:"border-t border-white/10"},R6={class:"px-0 py-4 md:py-5 sticky left-0 z-40 bg-gray-900 left-col-td"},C6={class:"px-4 md:px-5 flex items-center"},k6=["data-event-id"],D6={key:0,class:"fixed inset-0 z-[120] flex items-center justify-center bg-gray-950/80 backdrop-blur-sm"},N6={class:"text-center"},V6={class:"text-white text-lg"},O6={class:"mt-3 w-64 h-2 bg-white/10 rounded-full overflow-hidden"},M6={class:"text-white/60 text-xs mt-2"},L6={key:3,class:"fixed bottom-4 left-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-2xl border border-green-400/30 backdrop-blur-sm z-[200]"},F6={class:"flex items-center space-x-2"},$6={key:4,class:"fixed bottom-4 left-4 bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-xl shadow-2xl border border-red-400/30 backdrop-blur-sm z-[200]"},U6={class:"flex items-center space-x-2"},j6={key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},B6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},q6={class:"mb-6"},z6={class:"mb-6"},K6={class:"mb-6"},G6={class:"mb-6 flex items-center gap-3"},H6={class:"mb-6"},W6={key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] p-4"},Q6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},J6={class:"mb-6"},Y6={class:"flex justify-end space-x-3"},X6={key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},Z6={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},eU={class:"flex justify-end space-x-3"},tU={key:8,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4"},nU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},rU={class:"flex justify-end space-x-3"},sU={key:9,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[95] p-4"},iU={class:"relative text-center p-6 pb-4 border-b border-white/10"},oU={class:"text-2xl md:text-3xl font-bold text-white mb-1"},aU={class:"text-sm md:text-base text-purple-300"},lU={class:"px-4 md:px-6 py-4 md:py-6 overflow-y-auto"},uU={key:0,class:"mb-4 md:mb-6"},cU={class:"text-gray-300 bg-gray-800/50 p-4 rounded-lg border border-gray-600/50"},dU={class:"grid grid-cols-3 gap-3 md:gap-4 mb-2 md:mb-4"},hU={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 md:p-4 rounded-lg border border-purple-500/30"},fU={class:"text-xl md:text-2xl font-bold text-white"},pU={class:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 p-3 md:p-4 rounded-lg border border-cyan-500/30"},mU={class:"text-xl md:text-2xl font-bold text-white"},gU={class:"p-3 md:p-4 rounded-lg border border-yellow-500/30 bg-yellow-500/10 text-center"},vU={class:"text-xl md:text-2xl font-bold text-yellow-300"},yU={key:1,class:"mb-4 md:mb-6"},_U={class:"mb-3 flex items-center"},bU=["title"],wU={class:"truncate"},IU={class:"space-y-0.5"},EU={class:"flex items-center min-w-0 gap-1.5"},TU={key:0,class:"text-yellow-400 mr-1 text-xs",title:"Mon joueur"},xU={key:1,class:"text-yellow-400 mr-1 text-xs",title:"Joueur protg par mot de passe"},AU=["title"],SU={class:"flex-0 p-0"},PU={class:"hidden md:flex justify-center flex-wrap gap-3 mt-4"},RU=["disabled","title"],CU=["title"],kU={key:2,class:"md:hidden mt-3 space-y-2"},DU=["disabled","title"],NU={class:"md:hidden sticky bottom-0 w-full p-3 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2"},VU={key:11,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},OU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},MU={class:"mb-6"},LU={class:"mb-6"},FU={class:"mb-6"},$U={class:"mb-6 flex items-center gap-3"},UU={class:"mb-6"},jU={key:12,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[110] p-4"},BU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},qU={class:"mb-6"},zU={class:"space-y-4"},KU=["disabled"],GU={key:0,class:"animate-spin"},HU={key:1},WU={class:"mb-6 text-center"},QU={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},JU={class:"text-red-300 text-sm"},YU={key:13,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[110] p-0 md:p-4"},XU={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 shadow-2xl w-full max-w-md rounded-t-2xl md:rounded-2xl flex flex-col max-h-[90vh]"},ZU={class:"px-4 pt-3 pb-16 md:px-6 md:pt-4 md:pb-20 overflow-y-auto"},e5={class:"space-y-4"},t5={class:"mt-2 text-center"},n5={key:0,class:"mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},r5={class:"text-red-300 text-sm"},s5={class:"sticky bottom-0 w-full p-3 md:p-4 bg-gray-900/95 border-t border-white/10 backdrop-blur-sm flex items-center gap-2 pb-[env(safe-area-inset-bottom)]"},i5=["disabled"],o5={key:0,class:"animate-spin"},a5={key:1},l5={class:"mb-6"},u5=["disabled"],c5={key:0,class:"animate-spin"},d5={key:1},h5={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},f5={class:"text-red-300 text-sm"},p5={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},m5={class:"text-green-300 text-sm"},g5={class:"flex justify-center"},v5={class:"mb-6"},y5=["disabled"],_5={key:0,class:"animate-spin"},b5={key:1},w5={key:0,class:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},I5={class:"text-red-300 text-sm"},E5={key:1,class:"mb-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},T5={class:"text-green-300 text-sm"},x5={class:"flex justify-center"},A5={key:16,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[90] p-4"},S5={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-6 rounded-2xl shadow-2xl max-w-md"},P5={class:"flex gap-3"},c0={__name:"GridBoard",props:{slug:{type:String,required:!0},eventId:{type:String,required:!1}},setup(n){const e=n,t=Za(),r=el(),s=e.slug,i=k(""),o=k(""),a=k({}),l=k(!1),c=k(null),d=k(null),f=k(""),g=k(""),y=k(6),T=k(!1),A=k(""),P=k(null),U=k(null),q=k(null),M=k({position:null,side:null}),z=k({position:null}),fe=k({position:null}),me=k(!1),x=k(null),I=k(!1),w=k(null),C=k(null),V=k(!1),B=k(null),R=k(""),It=k(!1),vt=k(null),Y=k(""),j=k(""),ne=k(!1),Ke=k(null),Be=k(!1),Ge=k(null),re=k(""),ee=k(""),je=k(!1),Xe=k(null),ht=k(!1),D=k(!1),$=k(""),X=k(""),se=k(!1),ke=k(!1),$e=k(""),E=k(""),S=k(!1),O=k(null),oe=k(""),Z=k(!1),ue=k(!1),be=k(!1),ye=k(null),_e=k(null),pe=k(null),Se=k(0);function Te(){var _;try{if(!o.value||!a.value||a.value.onboardingCreatorDone!==!0||qe.value.length===0)return;const m=localStorage.getItem(`playerTourCompleted:${o.value}`);try{const J=((_=gt==null?void 0:gt.currentUser)==null?void 0:_.email)||"";J&&Fg(J).then(async ie=>{const te=ie.filter(ge=>ge.seasonId===o.value);if(te.length>0){const ge=`seasonPreferredPlayer:${o.value}`,Ve=localStorage.getItem(ge);let We=[];if(Ve)if(Ve.startsWith("["))try{We=JSON.parse(Ve)||[]}catch{}else We=[Ve];const tt=new Set(We);te.forEach(Wt=>tt.add(Wt.playerId));const mt=Array.from(tt);localStorage.setItem(ge,JSON.stringify(mt))}}).catch(()=>{})}catch{}const N=localStorage.getItem(`startPlayerTour:${o.value}`);!m&&N&&(Se.value=1,localStorage.removeItem(`startPlayerTour:${o.value}`),pn(()=>{const J=document.querySelector('button[data-onboarding="add-player"]');if(J){J.scrollIntoView({behavior:"smooth",block:"end"});const ie=J.getBoundingClientRect(),te=document.getElementById("coachmark-add"),ge=280,Ve=100,We=(te==null?void 0:te.offsetWidth)||ge,tt=(te==null?void 0:te.offsetHeight)||Ve,mt=Math.round(ie.right+12);if(mt+We<=window.innerWidth-12){const rn=ie.top+ie.height/2-tt/2,ut=-14,Nn=12,dr=window.innerHeight-tt-12,Vr=Math.max(Nn,Math.min(Math.round(rn+ut),dr));M.value={position:{x:mt,y:Vr},side:"right"}}else{const rn=Math.round(ie.left+ie.width/2-We/2),ut=Math.round(ie.top-tt-8),Nn=8,dr=window.innerWidth-We-8;M.value={position:{x:Math.max(Nn,Math.min(rn,dr)),y:ut},side:null}}}}))}catch{}}const Pe=k(!1),De=k(null),Le=k(null),He=k(!1),Ze=k(null),Yt=k(!1),Bt=k(null),_n=k(!1),Mt=k(!1),mr=k(!1),Ur=k(!1),cn=k(null);function Cn(){Mt.value=!1}function zi(){try{const _=gt==null?void 0:gt.currentUser;if(!_||_.isAnonymous){let m=null;if(Js.value&&Js.value.size>0){const N=Js.value.values().next().value;m=et.value.find(J=>J.id===N)||null}m||(m=et.value[0]||null),Ur.value=!0,m&&(cn.value=m);return}}catch{}Mt.value=!0}async function _l(){var _;try{const m=(_=gt==null?void 0:gt.currentUser)==null?void 0:_.email;if(!m)return;const{resetPlayerPassword:N}=await Xt(()=>Promise.resolve().then(()=>Ii),void 0);await N(m),Fe.value=!0,pt.value="Email de rinitialisation envoy.",setTimeout(()=>{Fe.value=!1},3e3)}catch{yr.value=!0,Ji.value="Impossible d'envoyer l'email de rinitialisation.",setTimeout(()=>{yr.value=!1},3e3)}}async function vc(){try{await TN(gt),Cn(),Fe.value=!0,pt.value="Dconnect de cet appareil.",setTimeout(()=>{Fe.value=!1},2500)}catch{yr.value=!0,Ji.value="Dconnexion impossible.",setTimeout(()=>{yr.value=!1},3e3)}}async function yc(){alert("Suppression de compte: contactez l'organisateur pour dissocier vos joueurs. Fonction complte  venir.")}async function Ki(_){var m;Cn();try{if(_.seasonId&&_.seasonId!==o.value){const N=xe(ae,"seasons",_.seasonId),ie=(await wt(Je(ae,"seasons"))).docs.find(ge=>ge.id===_.seasonId),te=(m=ie==null?void 0:ie.data())==null?void 0:m.slug;if(te){t.push(`/season/${te}?player=${encodeURIComponent(_.playerId)}&open=protection`);return}}else{const N=et.value.find(J=>J.id===_.playerId);if(N){hn(N);return}t.push(`?player=${encodeURIComponent(_.playerId)}&open=protection`)}}catch{}}Xn(()=>{try{o.value&&localStorage.getItem(`dismissCreatorOnboarding:${o.value}`)&&(onboardingDismissedShare.value=!0)}catch{}});function bl(){pn(()=>{Il()})}const Sr=k(new Set),tr=k(!0),Pr=k(0),Rr=k("Prparation de la grille"),Cr=k(e.eventId||null),qs=k(!1),Gi=k(null);At(()=>e.eventId,_=>{if(_)if(Cr.value=_,qe.value.length>0)Jg(_);else{const m=At(qe,N=>{N.length>0&&(Jg(_),m())},{immediate:!0})}});const nn=Oe(()=>et.value.map(_=>({..._,isProtected:Sr.value.has(_.id),email:null}))),_c=Oe(()=>Cr.value?Dn.value.findIndex(_=>_.id===Cr.value):-1);Oe(()=>{if(!Cr.value||_c.value===-1)return!1;if(window.innerWidth<=768){const _=document.querySelector(`[data-event-id="${Cr.value}"]`);if(_){const m=_.getBoundingClientRect();return m.left>=0&&m.right<=window.innerWidth}}return!0});const kn=k(null),zs=k(!1),bc=k(!1),wl=k(0),Ks=k(null),zn=k(null),Ko=k(null);function Kn(){const _=kn.value;if(!_)return;const{scrollLeft:m,scrollWidth:N,clientWidth:J}=_;zs.value=m>2,bc.value=m<N-J-2}function Il(){var _;try{Kn(),wl.value=((_=kn.value)==null?void 0:_.scrollLeft)||0}catch{}}function Go(_){const m=kn.value;if(!m)return;let N=0;const J=m.querySelector("tbody tr td[data-event-id]");if(J)N=J.getBoundingClientRect().width;else if(zn!=null&&zn.value){const te=zn.value.querySelector(".col-event");te&&(N=te.getBoundingClientRect().width)}(!N||!isFinite(N))&&(N=m.clientWidth*.6);const ie=m.scrollLeft+_*N;m.scrollTo({left:ie,behavior:"smooth"})}const jr=k(null);k(0);const nr=k(!1),Hi=k(!1),as=k(0);function Ho(_,m){m&&typeof m.preventDefault=="function"&&m.preventDefault(),gr(),Go(_)}function Gs(_,m){if(m&&typeof m.preventDefault=="function"&&m.preventDefault(),nr.value)return;nr.value=!0,as.value=_,Hi.value=!1;const N=kn.value;if(!N)return;let J=0;const ie=N.querySelector("tbody tr td[data-event-id]");if(ie)J=ie.getBoundingClientRect().width;else if(zn!=null&&zn.value){const We=zn.value.querySelector(".col-event");We&&(J=We.getBoundingClientRect().width)}(!J||!isFinite(J))&&(J=N.clientWidth*.6);const te=J/6,ge=120,Ve=()=>{if(!nr.value||as.value===0)return;Hi.value||(Hi.value=!0);const We=N.scrollLeft+as.value*te;N.scrollTo({left:We,behavior:"auto"}),jr.value=window.setTimeout(Ve,ge)};jr.value=window.setTimeout(Ve,250)}function gr(_){_&&typeof _.preventDefault=="function"&&_.preventDefault();const m=nr.value,N=Hi.value;if(nr.value=!1,jr.value&&(clearTimeout(jr.value),jr.value=null),_&&typeof _.type=="string"&&_.type.startsWith("touch")&&!N){const J=as.value||0;J!==0&&Go(J),as.value=0;return}as.value=0,m&&N&&wc()}function wc(){const _=kn.value;if(!_)return;let m=0;const N=_.querySelector("tbody tr td[data-event-id]");if(N)m=N.getBoundingClientRect().width;else if(zn!=null&&zn.value){const ge=zn.value.querySelector(".col-event");ge&&(m=ge.getBoundingClientRect().width)}if(!m||!isFinite(m)||m<=0)return;const J=_.scrollLeft,te=Math.round(J/m)*m;_.scrollTo({left:te,behavior:"smooth"})}function ef(_){P.value=_;const m=document.querySelector(`[data-player-id="${_}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"center"}),Fe.value=!0,pt.value="Nouveau joueur ajout !",setTimeout(()=>{Fe.value=!1},3e3)}function Wo(){if(Se.value!==1)return;const _=document.querySelector('button[data-onboarding="add-player"]');if(!_)return;const m=_.getBoundingClientRect(),N=document.getElementById("coachmark-add"),J=280,ie=100,te=N!=null&&N.offsetWidth&&N.offsetWidth>0?N.offsetWidth:J,ge=N!=null&&N.offsetHeight&&N.offsetHeight>0?N.offsetHeight:ie,Ve=Math.round(m.right+12);if(Ve+te<=window.innerWidth-12){const tt=m.top+m.height/2-ge/2,Wt=El(tt+-14,ge);M.value={position:{x:Ve,y:Wt},side:"right"}}else{const tt=Math.round(m.left+m.width/2-te/2),mt=El(m.top-ge-8,ge),Wt=8,rn=window.innerWidth-te-8;M.value={position:{x:Math.max(Wt,Math.min(tt,rn)),y:mt},side:null}}}function El(_,m){const N=pageHeaderRef==null?void 0:pageHeaderRef.value,J=N?Math.max(0,Math.round(N.getBoundingClientRect().height||0)):0,ie=Math.max(12,J+8),te=window.innerHeight-m-12;return Math.max(ie,Math.min(Math.round(_),te))}const vr=k(!1),ls=k(null),Br=k(null),Qo=k({position:"fixed",top:"0px",right:"0px"});function Tl(){try{const _=ls.value;if(!_)return;const m=_.getBoundingClientRect(),N=8,J=Math.max(N,Math.round(m.bottom+N)),ie=Math.max(N,Math.round(window.innerWidth-m.right));Qo.value={position:"fixed",top:`${J}px`,right:`${ie}px`,zIndex:400}}catch{}}function Ic(){vr.value=!vr.value,vr.value&&pn(()=>Tl())}function Jo(){vr.value=!1}function xl(_){if(!vr.value)return;const m=ls.value,N=Br.value,J=m&&m.contains(_.target),ie=N&&N.contains(_.target);!J&&!ie&&(vr.value=!1)}function Yo(_){_.key==="Escape"&&Jo()}function Hs(){vr.value&&Tl()}Xn(()=>{document.addEventListener("click",xl),document.addEventListener("keydown",Yo),window.addEventListener("scroll",Hs,{passive:!0}),window.addEventListener("resize",Hs)}),_a(()=>{document.removeEventListener("click",xl),document.removeEventListener("keydown",Yo),window.removeEventListener("scroll",Hs),window.removeEventListener("resize",Hs)});function Wi(){var _;Se.value===1&&((_=M.value)!=null&&_.position)&&Wo()}Xn(()=>{window.addEventListener("scroll",Wi,{passive:!0}),window.addEventListener("resize",Wi)}),_a(()=>{window.removeEventListener("scroll",Wi),window.removeEventListener("resize",Wi)});function Qi(_){return Sr.value.has(_)}async function Al(){if(o.value)try{const _=await jp(o.value),m=new Set;_.forEach(N=>{N.isProtected&&m.add(N.playerId||N.id)}),Sr.value=m}catch{const m=new Set;for(const N of et.value)await Ti(N.id,o.value)&&m.add(N.id);Sr.value=m}}const Fe=k(!1),pt=k(""),yr=k(!1),Ji=k("");function us(){try{const _=`${window.location.origin}/season/${s}`;navigator.clipboard.writeText(_),Fe.value=!0,pt.value="Lien copi dans le presse-papiers",setTimeout(()=>{Fe.value=!1},2500)}catch{yr.value=!0,Ji.value="Impossible de copier le lien",setTimeout(()=>{yr.value=!1},2500)}}async function _r(_){await Zs({type:"deleteEvent",data:{eventId:_}})}async function Xo(_=null){const m=_||c.value;if(console.debug("deleteEventConfirmed"),!m){console.error("Aucun vnement  supprimer");return}try{await $O(m,o.value),qe.value=qe.value.filter(N=>N.id!==m),await Promise.all([Lp(o.value),ho(et.value,qe.value,o.value),fo(o.value)]).then(([N,J,ie])=>{qe.value=N,Ht.value=J,at.value=ie}),l.value=!1,c.value=null,Fe.value=!0,pt.value="vnement supprim avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la suppression de l'vnement"),alert("Erreur lors de la suppression de l'vnement. Veuillez ressayer.")}}function Zo(){l.value=!1,c.value=null}async function ea(){if(!d.value||!f.value.trim()||!g.value)return;const _=parseInt(y.value);if(isNaN(_)||_<1||_>20){alert("Le nombre de joueurs doit tre un nombre entier entre 1 et 20");return}try{const m={title:f.value.trim(),date:g.value,description:oe.value.trim()||"",playerCount:_,archived:!!Z.value};await Q_(d.value,m,o.value),!m.archived&&et.value.length>0&&Sr.value.size>0&&(Bt.value={id:d.value,...m},Yt.value=!0),await Promise.all([Lp(o.value),ho(et.value,qe.value,o.value),fo(o.value)]).then(([N,J,ie])=>{qe.value=N,Ht.value=J,at.value=ie}),d.value=null,f.value="",g.value="",oe.value="",y.value=6,Z.value=!1,Fe.value=!0,pt.value="vnement mis  jour avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de l'dition de l'vnement"),alert("Erreur lors de l'dition de l'vnement. Veuillez ressayer.")}}async function Pt(){if(A.value.trim())try{const _=A.value.trim(),m=await uT(_,o.value);await Promise.all([bd(o.value),ho(et.value,qe.value,o.value),fo(o.value)]).then(([N,J,ie])=>{et.value=N,Ht.value=J,at.value=ie,Al();const te=et.value.find(Ve=>Ve.id===m);ef(m),U.value=m,q.value=Dn.value&&Dn.value[0]&&Dn.value[0].id?Dn.value[0].id:null;try{o.value&&localStorage.setItem(`lastAddedPlayerId:${o.value}`,m)}catch{}try{typeof Se<"u"&&(Se.value=2)}catch{}const ge=document.querySelector(`[data-player-id="${m}"]`);ge&&ge.scrollIntoView({behavior:"smooth",block:"center"}),pn(()=>{const Ve=`[data-player-id="${U.value}"] td[data-event-id="${q.value}"]`,We=document.querySelector(Ve);if(We){const tt=We.getBoundingClientRect();z.value.position={x:Math.round(tt.left),y:Math.round(tt.top+window.scrollY-48)}}}),Fe.value=!0,pt.value="Joueur ajout avec succs ! Vous pouvez maintenant indiquer sa disponibilit.",setTimeout(()=>{Fe.value=!1},3e3),setTimeout(()=>{Fe.value=!1,pt.value=""},5e3)}),T.value=!1,A.value=""}catch{console.error("Erreur lors de l'ajout du joueur"),alert("Erreur lors de l'ajout du joueur. Veuillez ressayer.")}}function qr(){d.value=null,f.value="",g.value="",oe.value="",y.value=6}k(null);const zr=k(!1),br=k(""),Ws=k(""),Qs=k(""),Yi=k(6),ta=k(!1);async function tf(){if(!br.value.trim()||!Ws.value){alert("Veuillez remplir le titre et la date de l'vnement");return}const _=parseInt(Yi.value);if(isNaN(_)||_<1||_>20){alert("Le nombre de joueurs doit tre un nombre entier entre 1 et 20");return}const m={title:br.value.trim(),date:Ws.value,description:Qs.value.trim()||"",playerCount:_,archived:!!ta.value};await nf(m)}async function nf(_){try{const m=await UO(_,o.value);qe.value=[...qe.value,{id:m,..._}];const N={};for(const J of et.value)N[J.name]=Ht.value[J.name]||{},N[J.name][m]=null,await H_(J.name,N[J.name],o.value);br.value="",Ws.value="",Qs.value="",Yi.value=6,ta.value=!1,zr.value=!1,await Promise.resolve(),Fe.value=!0,pt.value="vnement cr avec succs !",!_.archived&&et.value.length>0&&Sr.value.size>0&&(Bt.value={id:m,..._},Yt.value=!0),setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la cration de l'vnement"),alert("Erreur lors de la cration de l'vnement. Veuillez ressayer.")}}function Xi(){br.value="",Ws.value="",Qs.value="",Yi.value=6,zr.value=!1}async function kr(){await Zs({type:"addEvent",data:{}})}const qe=k([]),et=k([]),Ht=k({}),at=k({}),rf=k({}),Sl=k({});At([()=>qe.value.length,()=>et.value.length,tr],()=>{tr.value||pn(()=>{Il()})}),At([()=>et.value.length,()=>qe.value.length,o],()=>{Te()}),Xn(async()=>{lT("firebase"),await OO();const _=Mu(Je(ae,"seasons"),Hd("slug","==",e.slug)),m=await wt(_);if(m.empty){t.push("/seasons");return}else{const te=m.docs[0];o.value=te.id;const ge=te.data();i.value=ge.name,a.value=ge,document.title=`Saison : ${i.value}`,hO(e.slug)}if(o.value){Rr.value="Chargement des vnements de la saison",Pr.value=20;const te=await wt(Je(ae,"seasons",o.value,"events"));qe.value=te.docs.map(ut=>({id:ut.id,...ut.data(),playerCount:ut.data().playerCount||6})),Rr.value="Chargement des joueurs",Pr.value=45;const ge=await wt(Je(ae,"seasons",o.value,"players"));et.value=ge.docs.map(ut=>({id:ut.id,...ut.data()})),Rr.value="Chargement des disponibilits",Pr.value=70;const Ve=await wt(Je(ae,"seasons",o.value,"availability")),We={};Ve.docs.forEach(ut=>{const Nn=ut.data(),dr={};Object.keys(Nn).forEach(Vr=>{const ni=Nn[Vr];dr[Vr]=ni==="oui"?!0:ni==="non"?!1:ni}),We[ut.id]=dr}),Ht.value=We,Rr.value="Chargement des slections",Pr.value=85;const tt=await wt(Je(ae,"seasons",o.value,"selections")),mt={};tt.docs.forEach(ut=>{mt[ut.id]=ut.data().players||[]}),at.value=mt;const Wt=await jp(o.value),rn=new Set;Array.isArray(Wt)&&Wt.forEach(ut=>{ut.isProtected&&rn.add(ut.playerId||ut.id)}),Sr.value=rn}const N=te=>{typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>te()):setTimeout(te,0)};Rr.value="Prparation de l'interface",Pr.value=95,N(()=>{Rc(),ia()}),console.debug("players (deduplicated)"),console.debug("availability loaded"),await pn(),Pr.value=100,tr.value=!1,pn(()=>{Kn(),requestAnimationFrame(()=>Kn()),setTimeout(()=>Kn(),250);const te=kn.value;te&&(te.addEventListener("scroll",ge=>{Kn(),wl.value=te.scrollLeft||0},{passive:!0}),window.addEventListener("resize",Kn),typeof ResizeObserver<"u"&&(Ko.value=new ResizeObserver(()=>{Kn()}),Ko.value.observe(te)))});const J=r.query.event;if(J&&qe.value.length>0){const te=qe.value.find(ge=>ge.id===J);te?(console.debug("vnement trouv depuis l'URL"),await uf(J,te)):(console.warn("vnement non trouv avec l'ID"),yr.value=!0,Ji.value="vnement non trouv",setTimeout(()=>{yr.value=!1},3e3))}const ie=r.query.player;if(ie&&et.value.length>0){const te=et.value.find(ge=>ge.id===ie);te&&(hn(te),await pn(),r.query.verified==="1"&&(Fe.value=!0,pt.value="Joueur associ  votre compte.",setTimeout(()=>{Fe.value=!1},2500)))}}),At(()=>r.params.eventId,_=>{if(_){const m=()=>{const N=qe.value.find(J=>J.id===_);return N?(v(N),!0):!1};if(qe.value.length>0)m();else{const N=At(qe,J=>{J.length>0&&m()&&N()},{immediate:!0})}}},{immediate:!0});function Ec(_){if(!_)return null;if(_ instanceof Date)return _;if(typeof(_==null?void 0:_.toDate)=="function")return _.toDate();if(typeof _=="string"||typeof _=="number"){const m=new Date(_);return isNaN(m.getTime())?null:m}return null}const Gn=Oe(()=>{let _=null;try{o.value&&(_=localStorage.getItem(`seasonPreferredPlayer:${o.value}`))}catch{}const m=[...et.value].sort((ge,Ve)=>(ge.name||"").localeCompare(Ve.name||"","fr",{sensitivity:"base"}));if(!_)return m;let N=[];try{_.startsWith("[")?N=JSON.parse(_):_&&(N=[_])}catch{N=[]}const J=new Set(N);if(J.size===0)return m;const ie=m.filter(ge=>J.has(ge.id)),te=m.filter(ge=>!J.has(ge.id));return[...ie,...te]}),Js=Oe(()=>{try{if(o.value){const _=localStorage.getItem(`seasonPreferredPlayer:${o.value}`);if(!_)return new Set;if(_.startsWith("[")){const m=JSON.parse(_);return new Set(Array.isArray(m)?m:[])}return new Set([_])}}catch{}return new Set}),sf=Oe(()=>[...qe.value].sort((_,m)=>{const N=Ec(_.date),J=Ec(m.date),ie=N?N.getTime():Number.POSITIVE_INFINITY,te=J?J.getTime():Number.POSITIVE_INFINITY;return ie!==te?ie-te:(_.title||"").localeCompare(m.title||"","fr",{sensitivity:"base"})})),Dr=k(!1),Dn=Oe(()=>{const _=sf.value;return Dr.value?_:_.filter(m=>!m.archived)});function Tc(){Dr.value=!Dr.value}const cs=k("selected"),Zi=Oe(()=>{var N;if(!O.value)return Gn.value;const _=O.value.id,m=new Set(((N=at.value)==null?void 0:N[_])||[]);return Gn.value.filter(J=>{var Ve;const ie=J.name,te=(Ve=Ht.value[ie])==null?void 0:Ve[_],ge=m.has(ie);switch(cs.value){case"selected":return ge;case"available":return te===!0&&!ge;case"unavailable":return te===!1;case"unknown":return te!==!0&&te!==!1;case"all":default:return!0}})}),xc=Oe(()=>O.value?fs(O.value.id):null),Pl=Oe(()=>{if(!O.value)return!1;const _=fs(O.value.id);return _.type==="incomplete"||_.type==="insufficient"}),Lt=Oe(()=>O.value?of(O.value.id):"");async function na(_,m){const N=et.value.find(te=>te.name===_);if(!N){console.error("Joueur non trouv");return}const J=qe.value.find(te=>te.id===m);if(!J){console.error("vnement non trouv");return}if(J.archived){Fe.value=!0,pt.value="vnement archiv  dsarchivez pour modifier",setTimeout(()=>{Fe.value=!1},3e3);return}if(Qi(N.id)){const te=xo(N.id),ge=pe.value===N.id;console.debug("Joueur protg:",{playerId:N.id,hasCachedPassword:te,wasRecentlyVerified:ge,recentlyVerifiedPlayer:pe.value}),te||ge?(console.debug("Session active ou joueur rcemment vrifi, procder au toggle"),ge&&(console.debug("Nettoyage du flag recentlyVerifiedPlayer"),pe.value=null),Rl(N,m)):(console.debug("Pas de session, affichage de la modal de vrification"),_e.value={playerName:_,eventId:m},ye.value=N,be.value=!0);return}Rl(N,m)}function Rl(_,m){var ie,te,ge;const N=(ie=Ht.value[_.name])==null?void 0:ie[m];console.debug("toggleAvailability");let J;N===!0?J=!1:N===!1?J=void 0:J=!0,J===void 0?Ht.value[_.name]&&delete Ht.value[_.name][m]:(Ht.value[_.name]||(Ht.value[_.name]={}),Ht.value[_.name][m]=J);try{typeof Se<"u"&&Se.value===1&&_.id===(U.value||((te=Gn.value[0])==null?void 0:te.id))&&m===(q.value||((ge=Dn.value[0])==null?void 0:ge.id))&&(Se.value=3,pn(()=>{const We=document.querySelector(`[data-player-id="${_.id}"]`);if(We){const tt=We.querySelector(".player-name");if(tt){const mt=tt.getBoundingClientRect();fe.value.position={x:Math.round(mt.right+8),y:Math.round(mt.top+window.scrollY-4)}}}}),_a(()=>{try{window.removeEventListener("resize",Kn)}catch{}try{Ko.value&&Ko.value.disconnect()}catch{}}))}catch{}H_(_.name,Ht.value[_.name],o.value).then(async()=>{await pn(),ia(),Fe.value=!0,pt.value="Disponibilit mise  jour avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}).catch(Ve=>{console.error("Erreur lors de la mise  jour de la disponibilit"),alert("Erreur lors de la mise  jour de la disponibilit. Veuillez ressayer.")})}function rr(_,m){var N;return(N=Ht.value[_])==null?void 0:N[m]}function Ac(_,m){var ie;const N=at.value[m]||[],J=(ie=Ht.value[_])==null?void 0:ie[m];return N.includes(_)&&J===!0}async function Sc(_,m=6){const N=qe.value.find(ge=>ge.id===_),J=(N==null?void 0:N.playerCount)||6,ie=at.value[_]||[];if(ie.length>0&&ie.every(ge=>rr(ge,_))){console.debug("Tous les joueurs slectionns sont disponibles, nouveau tirage complet");const Ve=et.value.filter(mt=>rr(mt.name,_)).map(mt=>{const Wt=Ys(mt.name);return{name:mt.name,weight:1/(1+Wt)}}),We=[],tt=[...Ve];for(;We.length<J&&tt.length>0;){const mt=tt.reduce((ut,Nn)=>ut+Nn.weight,0);let Wt=Math.random()*mt;const rn=tt.findIndex(ut=>(Wt-=ut.weight,Wt<=0));rn>=0&&(We.push(tt[rn].name),tt.splice(rn,1))}at.value[_]=We}else{const ge=ie.filter(We=>rr(We,_)),Ve=J-ge.length;if(Ve<=0)at.value[_]=ge;else{const We=new Set(ge),mt=et.value.filter(ut=>rr(ut.name,_)&&!We.has(ut.name)).map(ut=>{const Nn=Ys(ut.name);return{name:ut.name,weight:1/(1+Nn)}}),Wt=[],rn=[...mt];for(;Wt.length<Ve&&rn.length>0;){const ut=rn.reduce((Vr,ni)=>Vr+ni.weight,0);let Nn=Math.random()*ut;const dr=rn.findIndex(Vr=>(Nn-=Vr.weight,Nn<=0));dr>=0&&(Wt.push(rn[dr].name),rn.splice(dr,1))}at.value[_]=[...ge,...Wt]}}await W_(_,at.value[_],o.value),Rc(),ia()}async function eo(_,m=6){var ge,Ve;console.debug("tirerProtected appel"),console.debug("etat modal selection avant");const N=Pe.value,J=(ge=De.value)==null?void 0:ge.id,ie=at.value[_]&&at.value[_].length>0,te=ie?[...at.value[_]]:[];if(await Sc(_,m),console.debug("etat modal selection apres"),N&&!Pe.value&&(console.debug("Restauration de la popin de slection..."),Pe.value=!0,De.value=qe.value.find(We=>We.id===J)),Pe.value&&((Ve=De.value)==null?void 0:Ve.id)===_)if(console.debug("Popin de slection ouverte, mise  jour..."),await pn(),Le.value&&Le.value.showSuccess){console.debug("Appel de showSuccess sur la popin de slection");const We=at.value[_]||[],tt=te.filter(Wt=>We.includes(Wt)),mt=tt.length>0&&tt.length<te.length;Le.value.showSuccess(ie,mt)}else console.debug("showSuccess indisponible");else console.debug("Popin de slection ferme, affichage message global"),Fe.value=!0,qe.value.find(We=>We.id===_),at.value[_],ie?pt.value="Slection mise  jour avec succs !":pt.value="Slection effectue avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}function ra(_){_===0?M.value.position=null:_===1?z.value.position=null:_===2&&(fe.value.position=null)}function Nr(_){var N;return _?(typeof _=="string"?new Date(_):((N=_.toDate)==null?void 0:N.call(_))||_).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):""}function Cl(_){var N;return _?(typeof _=="string"?new Date(_):((N=_.toDate)==null?void 0:N.call(_))||_).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}function Ys(_){return Object.values(at.value).filter(m=>m.includes(_)).length}function ds(_){const m=Ht.value[_]||{};return Object.values(m).filter(N=>N===!0).length}function to(_){return _?Object.values(Ht.value).filter(m=>m[_]===!0).length:0}function Xs(_){return _?(at.value[_]||[]).length:0}function no(_){const m=qe.value.find(J=>J.id===_),N=(m==null?void 0:m.playerCount)||6;return Xs(_)>=N}function Pc(_){const m=ds(_),N=Ys(_);return m===0?0:N/m}function sa(_){rf.value[_]={availability:ds(_),selection:Ys(_),ratio:Pc(_)}}function Rc(){et.value.forEach(_=>sa(_.name))}function ia(){const _={};qe.value.forEach(m=>{const N=m.playerCount||6,ie=et.value.filter(ge=>rr(ge.name,m.id)===!0).map(ge=>{const Ve=Ys(ge.name);return{name:ge.name,weight:1/(1+Ve)}}),te=ie.reduce((ge,Ve)=>ge+Ve.weight,0);ie.forEach(ge=>{const Ve=Math.min(1,ge.weight/te*N);_[ge.name]||(_[ge.name]={}),_[ge.name][m.id]=Math.round(Ve*100)})}),Sl.value=_}const Kr=k(null),ro=k(!1);async function Cc(_=null){const m=_||Kr.value;if(!m){console.error("Aucun joueur  supprimer");return}try{await MO(m,o.value),et.value=et.value.filter(N=>N.id!==m),ro.value=!1,Kr.value=null,Fe.value=!0,pt.value="Joueur supprim avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la suppression du joueur"),alert("Erreur lors de la suppression du joueur. Veuillez ressayer.")}}function kl(){ro.value=!1,Kr.value=null}async function Dl(_){gn(),await Ti(_,o.value)?await hs({type:"deletePlayer",data:{playerId:_}}):await Zs({type:"deletePlayer",data:{playerId:_}})}async function kc(){if(x.value){const _=qe.value.find(N=>N.id===x.value),m=(_==null?void 0:_.playerCount)||6;await eo(x.value,m),me.value=!1,x.value=null}}function oa(){me.value=!1,x.value=null}function Dc(){return B.value?{deleteEvent:"Suppression d'vnement - Code PIN requis",addEvent:"Ajout d'vnement - Code PIN requis",deletePlayer:"Suppression de joueur - Code PIN requis",launchSelection:"Lancement de slection - Code PIN requis",toggleArchive:"Archivage d'vnement - Code PIN requis",updateSelection:"Mise  jour de slection - Code PIN requis"}[B.value.type]||"Code PIN requis":"Veuillez saisir le code PIN  4 chiffres"}async function Zs(_){if(xn.isPinCached(o.value)){const m=xn.getCachedPin(o.value);if(console.debug("PIN en cache trouv, utilisation automatique"),await Xd(o.value,m)){await u(_);return}else xn.clearSession()}B.value=_,V.value=!0}async function hs(_){const m=_.data.playerId;try{if(xn.isPinCached(o.value)){console.debug("PIN de saison en cache  saut de la demande de mot de passe joueur"),await u(_);return}}catch{}if(xo(m)){console.debug("Mot de passe du joueur en cache trouv, utilisation automatique"),await u(_);return}vt.value=_,It.value=!0}async function Nc(_){try{if(await Xd(o.value,_)){xn.saveSession(o.value,_),V.value=!1;const N=B.value;B.value=null,await u(N)}else R.value="Code PIN incorrect",setTimeout(()=>{R.value=""},3e3)}catch{console.error("Erreur lors de la vrification du PIN"),R.value="Erreur lors de la vrification du code PIN"}}function Vc(){V.value=!1,B.value=null,R.value=""}async function Nl(_){if(_){ne.value=!0,Y.value="";try{const m=vt.value.data.playerId,N=await Op(o.value);if(_===N){try{xn.saveSession(o.value,_)}catch{}try{Oi.saveSession(vt.value.data.playerId)}catch{}It.value=!1;const ie=vt.value;vt.value=null,j.value="",await u(ie);return}if(await verifyPlayerPassword(m,_,o.value)){It.value=!1;const ie=vt.value;vt.value=null,j.value="",await u(ie)}else Y.value="Mot de passe incorrect",setTimeout(()=>{Y.value=""},3e3)}catch{console.error("Erreur lors de la vrification du mot de passe"),Y.value="Erreur lors de la vrification du mot de passe"}finally{ne.value=!1}}}function Oc(){It.value=!1,vt.value=null,Y.value="",j.value="",ne.value=!1}async function so(_){if(_){je.value=!0,re.value="";try{const m=Ge.value.data.player,N=await Op(o.value);if(_===N){try{xn.saveSession(o.value,_)}catch{}try{Oi.saveSession(Ge.value.data.player.id)}catch{}Be.value=!1;const ie=Ge.value;Ge.value=null,ee.value="",await u(ie);return}if(await verifyPlayerPassword(m.id,_,o.value)){Be.value=!1;const ie=Ge.value;Ge.value=null,ee.value="",await u(ie)}else re.value="Mot de passe incorrect",setTimeout(()=>{re.value=""},3e3)}catch{console.error("Erreur lors de la vrification du mot de passe"),re.value="Erreur lors de la vrification du mot de passe"}finally{je.value=!1}}}function Hn(){Be.value=!1,Ge.value=null,re.value="",ee.value="",je.value=!1}async function Mc(){D.value=!0,$.value="",X.value="";try{const _=Ge.value.data.player,m=await sendPasswordResetEmail(_.id,o.value);X.value=m.message||"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}catch{console.error("Erreur lors de l'envoi de l'email"),$.value="Erreur lors de l'envoi de l'email. Veuillez ressayer."}finally{D.value=!1}}async function Lc(){ke.value=!0,$e.value="",E.value="";try{const _=vt.value.data.playerId,m=await sendPasswordResetEmail(_,o.value);E.value=m.message||"Email de rinitialisation envoy ! Vrifiez votre bote de rception."}catch{console.error("Erreur lors de l'envoi de l'email"),$e.value="Erreur lors de l'envoi de l'email. Veuillez ressayer."}finally{ke.value=!1}}function ei(){return xn.isPinCached(o.value)?{timeRemaining:xn.getTimeRemaining(),isExpiringSoon:xn.isExpiringSoon()}:null}async function u(_){var J;if(!_)return;const{type:m,data:N}=_;try{switch(m){case"deleteEvent":console.debug("executePendingOperation - data.eventId reu"),c.value=N.eventId,l.value=!0;break;case"addEvent":zr.value=!0;break;case"deletePlayer":Kr.value=N.playerId,ro.value=!0;break;case"launchSelection":at.value[N.eventId]&&at.value[N.eventId].length>0?(x.value=N.eventId,me.value=!0,S.value=!1):(await eo(N.eventId,N.count),S.value=!1);break;case"toggleAvailability":Rl(N.player,N.eventId);break;case"toggleArchive":await setEventArchived(N.eventId,N.archived,o.value);{const ie=qe.value.findIndex(te=>te.id===N.eventId);ie!==-1&&(qe.value[ie]={...qe.value[ie],archived:!!N.archived}),Z.value=!!N.archived}break;case"updateSelection":{const{eventId:ie,players:te}=N,ge=[...at.value[ie]||[]],Ve=Array.isArray(te)?te:[];await W_(ie,Ve,o.value),at.value[ie]=Ve;try{const We=ge.filter(tt=>!Ve.includes(tt));if(We.length>0){const tt=qe.value.find(mt=>mt.id===ie);await AM({eventId:ie,eventData:tt,removedPlayers:We,newSelectedPlayers:Ve,seasonId:o.value,seasonSlug:s,players:nn.value})}}catch{}try{(J=Le.value)==null||J.showSuccess(!0,!0)}catch{}}break}}catch{console.error("Erreur lors de l'excution de l'opration"),Fe.value=!0,pt.value="Erreur lors de l'opration. Veuillez ressayer.",setTimeout(()=>{Fe.value=!1},3e3)}}function p(){t.push("/seasons")}_a(()=>{const _=kn.value;_&&_.removeEventListener("scroll",Kn),window.removeEventListener("resize",Kn)});async function v(_){O.value=_,oe.value=_.description||"",Z.value=!!_.archived;try{const[m,N]=await Promise.all([ho(et.value,qe.value,o.value),fo(o.value)]);Ht.value=m,at.value=N}catch(m){console.warn("Impossible de rafrachir les donnes avant ouverture des dtails:",m)}S.value=!0}function b(){S.value=!1,O.value=null,oe.value="",ue.value=!1}function K(){b(),r.params.eventId&&t.push(`/season/${e.slug}`)}async function W(_,m){console.debug("handleAvailabilityToggle appel");const N=et.value.find(te=>te.name===_);if(!N){console.error("Joueur non trouv");return}const J=qe.value.find(te=>te.id===m);if(J!=null&&J.archived){Fe.value=!0,pt.value="vnement archiv  dsarchivez pour modifier",setTimeout(()=>{Fe.value=!1},3e3);return}console.debug("Joueur trouv");const ie=Qi(N.id);if(console.debug("Joueur protg"),ie){xo(N.id)?(console.debug("Session active, procder au toggle"),await na(_,m)):(console.debug("Demande du mot de passe pour joueur protg"),_e.value={playerName:_,eventId:m},ye.value=N,be.value=!0);return}console.debug("Joueur non protg, procder au toggle"),await na(_,m)}function Ie(_,m){return(at.value[m]||[]).includes(_)}async function Et(_){if(console.debug("Mot de passe vrifi"),ye.value&&(pe.value=ye.value.id,console.debug("Joueur marqu comme rcemment vrifi")),_e.value){const{playerName:m,eventId:N}=_e.value;console.debug("Excution de l'action en attente"),await na(m,N),_e.value=null}else console.debug("Aucune action en attente trouve");be.value=!1,ye.value=null}function dn(){d.value=O.value.id,f.value=O.value.title,g.value=O.value.date,oe.value=O.value.description||"",y.value=O.value.playerCount||6,S.value=!1}async function lt(){if(O.value)try{const _=!O.value.archived,m={...O.value,archived:_};await Q_(O.value.id,m,o.value),O.value.archived=_;const N=qe.value.findIndex(J=>J.id===O.value.id);N!==-1&&(qe.value[N].archived=_),Fe.value=!0,pt.value=_?"vnement archiv avec succs !":"vnement dsarchiv avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de la modification de l'archivage"),alert("Erreur lors de la modification de l'archivage. Veuillez ressayer.")}}function hn(_){w.value=_,I.value=!0;try{typeof Se<"u"&&Se.value}catch{}}function gn(){I.value=!1,w.value=null}async function ti({playerId:_,newName:m}){try{await LO(_,m,o.value),await Promise.all([bd(o.value),ho(et.value,qe.value,o.value),fo(o.value)]).then(([N,J,ie])=>{if(et.value=N,Ht.value=J,at.value=ie,Al(),w.value&&w.value.id===_){const te=N.find(ge=>ge.id===_);te&&(w.value=te)}}),Fe.value=!0,pt.value="Joueur mis  jour avec succs !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors de l'dition du joueur"),alert("Erreur lors de l'dition du joueur. Veuillez ressayer.")}}async function cr(){try{await Promise.all([bd(o.value),ho(et.value,qe.value,o.value),fo(o.value)]).then(([_,m,N])=>{if(et.value=_,Ht.value=m,at.value=N,Al(),w.value){const J=_.find(ie=>ie.id===w.value.id);J&&(w.value=J)}}),Fe.value=!0,pt.value="Donnes mises  jour !",setTimeout(()=>{Fe.value=!1},3e3)}catch{console.error("Erreur lors du rafrachissement")}}function aa(_){if(!_)return{availability:0,selection:0,ratio:0};const m=ds(_.name),N=Ys(_.name),J=m===0?0:Math.round(N/m*100);return{availability:m,selection:N,ratio:J}}function fs(_){const m=at.value[_]||[],N=qe.value.find(te=>te.id===_),J=(N==null?void 0:N.playerCount)||6,ie=to(_);if(m.length>0){const te=m.some(Ve=>!rr(Ve,_)),ge=ie<J;if(te||ge)return{type:"incomplete",hasUnavailablePlayers:te,hasInsufficientPlayers:ge,unavailablePlayers:m.filter(Ve=>!rr(Ve,_)),availableCount:ie,requiredCount:J}}return ie<J?{type:"insufficient",availableCount:ie,requiredCount:J}:m.length===0?{type:"ready",availableCount:ie,requiredCount:J}:{type:"complete",availableCount:ie,requiredCount:J}}function nx(_){const m=fs(_);return m.type==="incomplete"||m.type==="insufficient"}function of(_){const m=fs(_);switch(m.type){case"incomplete":return m.hasUnavailablePlayers?m.unavailablePlayers.length===1?`Slection incomplte : ${m.unavailablePlayers[0]} n'est plus disponible`:`Slection incomplte : ${m.unavailablePlayers.length} joueurs ne sont plus disponibles`:`Slection incomplte : ${m.availableCount} joueurs disponibles pour ${m.requiredCount} requis`;case"insufficient":return`Pas assez de joueurs : ${m.availableCount} disponibles pour ${m.requiredCount} requis`;case"ready":return`Prt pour la slection : ${m.availableCount} joueurs disponibles`;case"complete":return`Slection complte : ${m.availableCount} joueurs disponibles`;default:return""}}async function rx(){const _=[];for(const m of et.value){if(!await Ti(m.id,o.value))continue;const J=await wT(m.id,o.value);J&&_.push({...m,email:J})}return _}function Fc(_){if(_!=null&&_.archived){Fe.value=!0,pt.value="Impossible d'annoncer un vnement archiv",setTimeout(()=>{Fe.value=!1},3e3);return}Hg(),Ze.value=_,He.value=!0;try{const m=new URLSearchParams(window.location.search);m.set("modal","announce"),m.set("event",(_==null?void 0:_.id)||""),history.replaceState(null,"",`${window.location.pathname}?${m.toString()}`)}catch{}}function sx(){He.value=!1,Ze.value=null;try{const _=new URLSearchParams(window.location.search);_.get("modal")==="announce"&&(_.delete("modal"),_.delete("event"),history.replaceState(null,"",`${window.location.pathname}?${_.toString()}`))}catch{}}function Hg(){Yt.value=!1,Bt.value=null}const af=k(!1);async function Wg({eventId:_,eventData:m,reason:N,selectedPlayers:J,scope:ie="all",recipient:te=null}){af.value=!0;try{N==="selection"?(ie==="single"&&(te!=null&&te.email)?await Z_({eventId:_,eventData:m,selectedPlayers:[te.name],seasonId:o.value,seasonSlug:s,players:nn.value}):await Z_({eventId:_,eventData:m,selectedPlayers:J,seasonId:o.value,seasonSlug:s,players:nn.value}),Fe.value=!0,pt.value=ie==="single"?`Notification envoye  ${(te==null?void 0:te.name)||"1 joueur"}`:"Notifications de slection envoyes  tous les joueurs slectionns !",setTimeout(()=>{Fe.value=!1},3e3)):(ie==="single"&&(te!=null&&te.email)?await X_({eventId:_,eventData:m,players:[te],seasonId:o.value,seasonSlug:s,createMagicLink:Fp,reminder:!1,getAvailabilityForEvent:(ge,Ve)=>rr(ge,Ve)}):await X_({eventId:_,eventData:m,players:await rx(),seasonId:o.value,seasonSlug:s,createMagicLink:Fp,reminder:!1,getAvailabilityForEvent:(ge,Ve)=>rr(ge,Ve)}),Fe.value=!0,pt.value=ie==="single"?`Notification envoye  ${(te==null?void 0:te.name)||"1 joueur"}`:"Notifications envoyes  tous les joueurs protgs !",setTimeout(()=>{Fe.value=!1},3e3))}catch{console.error("Erreur lors de l'envoi des notifications"),Fe.value=!0,pt.value="Erreur lors de l'envoi des notifications",setTimeout(()=>{Fe.value=!1},3e3)}af.value=!1}function lf(_){if(!_)return{};const m={};return et.value.forEach(N=>{m[N.name]=rr(N.name,_)}),m}function Vl(_){if(_!=null&&_.archived){Fe.value=!0,pt.value="Impossible d'ouvrir la slection sur un vnement archiv",setTimeout(()=>{Fe.value=!1},3e3);return}De.value=_,Pe.value=!0;try{const m=new URLSearchParams(window.location.search);m.set("modal","selection"),m.set("event",(_==null?void 0:_.id)||""),history.replaceState(null,"",`${window.location.pathname}?${m.toString()}`)}catch{}}function Qg(){Pe.value=!1,De.value=null;try{const _=new URLSearchParams(window.location.search);_.get("modal")==="selection"&&(_.delete("modal"),_.delete("event"),history.replaceState(null,"",`${window.location.pathname}?${_.toString()}`))}catch{}}async function ix(){if(!De.value)return;const _=De.value.id,m=De.value.playerCount||6;if(to(_)===0){Fe.value=!0,pt.value="Aucun joueur disponible pour cet vnement",setTimeout(()=>{Fe.value=!1},3e3);return}await Zs({type:"launchSelection",data:{eventId:_,count:m}})}function ox(){Qg(),Fe.value=!0,pt.value="Slection valide !",setTimeout(()=>{Fe.value=!1},3e3)}async function ax(_){if(!_||!_.eventId)return;const{eventId:m,players:N}=_;await Zs({type:"updateSelection",data:{eventId:m,players:N}})}async function uf(_,m){if(!_||!m)return;Yg(),Cr.value=_,qs.value=!0,await pn();const N=document.querySelector(`[data-event-id="${_}"]`);if(!N){console.warn("lment vnement non trouv dans le DOM");return}document.querySelectorAll(".focused-event-highlight").forEach(ge=>{ge.classList.remove("focused-event-highlight")});const J=document.querySelectorAll(`[data-event-id="${_}"]`);J.forEach(ge=>{ge.classList.add("focused-event-highlight")});const ie=J[0],te=J[J.length-1];ie&&ie.classList.add("focused-event-column-start"),te&&te.classList.add("focused-event-column-end"),await lx(N),Fe.value=!0,pt.value=`vnement cibl : ${m.title}`,setTimeout(()=>{Fe.value=!1},4e3),Gi.value=setTimeout(()=>{Yg()},8e3)}function Jg(_){if(!_)return;const m=qe.value.find(N=>N.id===_);if(!m){console.warn("vnement non trouv dans la liste des vnements"),setTimeout(()=>{const N=qe.value.find(J=>J.id===_);N?uf(_,N):console.error("vnement toujours introuvable aprs retry")},500);return}uf(_,m)}At(qe,_=>{try{const m=new URLSearchParams(window.location.search),N=m.get("modal"),J=m.get("event");if(!N||!J)return;const ie=_.find(te=>te.id===J);if(!ie)return;N==="announce"&&Fc(ie),N==="selection"&&Vl(ie)}catch{}},{immediate:!0});async function lx(_){if(!_)return;if(await new Promise(N=>setTimeout(N,100)),window.innerWidth<=768){const N=kn.value;if(N){const J=_.offsetLeft,ie=_.offsetWidth,te=N.clientWidth,ge=J-te/2+ie/2,Ve=N.scrollWidth-te,We=Math.max(0,Math.min(ge,Ve));N.scrollTo({left:We,behavior:"smooth"}),setTimeout(()=>{const tt=_.getBoundingClientRect();if(tt.left<0||tt.right>window.innerWidth){const mt=J-20;N.scrollTo({left:Math.max(0,mt),behavior:"smooth"})}},500)}}else _.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});const m=kn.value;m&&setTimeout(()=>{const N=document.querySelector(`[data-event-id="${Cr.value}"]`);if(N&&N.closest("tbody")){const J=N.offsetLeft,ie=N.offsetWidth,te=m.clientWidth,ge=J-te/2+ie/2,Ve=m.scrollWidth-te,We=Math.max(0,Math.min(ge,Ve));m.scrollTo({left:We,behavior:"smooth"})}},300)}function Yg(){Gi.value&&(clearTimeout(Gi.value),Gi.value=null),Cr.value=null,qs.value=!1,document.querySelectorAll(".focused-event-highlight").forEach(_=>{_.classList.remove("focused-event-highlight")}),document.querySelectorAll(".focused-event-column-start, .focused-event-column-end").forEach(_=>{_.classList.remove("focused-event-column-start","focused-event-column-end")})}return(_,m)=>{var N,J,ie,te,ge,Ve,We,tt,mt,Wt,rn,ut,Nn,dr,Vr,ni,Xg,Zg,ev,tv,nv,rv;return L(),F(dt,null,[h("div",W$,[h("div",Q$,[h("button",{onClick:p,class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Retour aux saisons"},m[70]||(m[70]=[h("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),h("h1",J$,ce(i.value?i.value:"Chargement..."),1),h("div",Y$,[h("div",X$,[h("button",{onClick:zi,class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Mon compte","aria-label":"Mon compte"},m[71]||(m[71]=[h("span",{class:"text-2xl"},"",-1)])),h("button",{onClick:m[0]||(m[0]=Q=>_n.value=!0),class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Kezako ?","aria-label":"Kezako ?"},m[72]||(m[72]=[h("span",{class:"text-2xl"},"",-1)]))]),h("div",{class:"relative md:hidden",ref_key:"headerMenuRef",ref:ls},[h("button",{onClick:m[1]||(m[1]=Ft(Q=>{Ic(),Tl()},["stop"])),class:"text-white hover:text-purple-300 transition-colors duration-200 p-2 rounded-full hover:bg-white/10",title:"Menu","aria-label":"Menu"},m[73]||(m[73]=[h("span",{class:"text-2xl"},"",-1)]))],512),(L(),Sd(tA,{to:"body"},[vr.value?(L(),F("div",{key:0,ref_key:"headerMenuDropdownRef",ref:Br,class:"w-48 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[400] overflow-hidden",style:ys(Qo.value)},[h("button",{onClick:m[2]||(m[2]=Q=>{zi(),Jo()}),class:"w-full text-left px-4 py-3 text-white hover:bg-white/10 flex items-center gap-2"},m[74]||(m[74]=[h("span",null,"",-1),h("span",{class:"text-sm"},"Mon compte",-1)])),h("button",{onClick:m[3]||(m[3]=Q=>{_n.value=!0,Jo()}),class:"w-full text-left px-4 py-3 text-white hover:bg-white/10 flex items-center gap-2"},m[75]||(m[75]=[h("span",null,"",-1),h("span",{class:"text-sm"},"Kezako ?",-1)]))],4)):ve("",!0)]))])],512),h("div",Z$,[h("div",{ref_key:"headerBarRef",ref:Ks,class:"sticky top-0 z-[80] bg-gray-900 overflow-hidden"},[h("div",e6,[qe.value.length===0&&et.value.length===0?ve("",!0):(L(),F("div",t6,[h("div",{class:"flex items-center justify-center h-full gap-2"},[h("button",{onClick:kr,class:"flex items-center space-x-2 px-3 py-2 md:px-4 md:py-2 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl text-sm md:text-base font-medium",title:"Ajouter un nouvel vnement"},m[76]||(m[76]=[h("span",{class:"text-lg"},"",-1),h("span",{class:"hidden sm:inline"},"Ajouter un vnement",-1),h("span",{class:"sm:hidden"},"vnement",-1)]))])])),h("div",n6,[h("div",{ref_key:"headerEventsRef",ref:zn,class:"flex relative z-[60]",style:ys({transform:`translateX(-${wl.value}px)`})},[(L(!0),F(dt,null,wr(Dn.value,Q=>(L(),F("div",{key:"h-"+Q.id,"data-event-id":Q.id,class:xt(["col-event flex-shrink-0 p-3 text-center cursor-pointer",{"archived-header":Q.archived}]),onClick:Vn=>v(Q)},[h("div",{class:"header-date text-[16px] md:text-base text-gray-300",title:Cl(Q.date)},ce(Nr(Q.date)),9,s6),h("div",{class:"header-title text-[22px] md:text-2xl leading-snug text-white text-center clamp-2",title:Q.title},ce(Q.title||"Sans titre"),9,i6),Q.archived?(L(),F("div",o6,"(Archiv)")):ve("",!0),nx(Q.id)?(L(),F("div",{key:1,class:"mt-1 w-4 h-4 bg-yellow-500 rounded-full mx-auto flex items-center justify-center hover:bg-yellow-400 transition-colors duration-200",title:of(Q.id)+" - Cliquez pour ouvrir la slection",onClick:Ft(Vn=>Vl(Q),["stop"])},m[77]||(m[77]=[h("span",{class:"text-xs text-white font-bold"},"",-1)]),8,a6)):fs(Q.id).type==="ready"?(L(),F("div",{key:2,class:"mt-1 w-4 h-4 bg-green-500 rounded-full mx-auto flex items-center justify-center hover:bg-green-400 transition-colors duration-200",title:of(Q.id)+" - Cliquez pour ouvrir la slection",onClick:Ft(Vn=>Vl(Q),["stop"])},m[78]||(m[78]=[h("span",{class:"text-xs text-white font-bold"},"",-1)]),8,l6)):ve("",!0)],10,r6))),128))],4)]),m[81]||(m[81]=h("div",{class:"col-right flex-shrink-0 p-3 sticky right-0 z-[81] bg-gray-900 h-full"},null,-1)),h("button",{onClick:Tc,class:"absolute right-2 top-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[86] backdrop-blur-sm",title:Dr.value?"Masquer les vnements archivs":"Afficher les vnements archivs","aria-label":Dr.value?"Masquer les vnements archivs":"Afficher les vnements archivs"},[(L(),F("svg",c6,[m[79]||(m[79]=h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.25 12c1.5-4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z"},null,-1)),m[80]||(m[80]=h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)),Dr.value?ve("",!0):(L(),F("path",d6))]))],8,u6),nt(h("button",{onClick:m[4]||(m[4]=Ft(Q=>Ho(-1,Q),["prevent"])),onMousedown:m[5]||(m[5]=Ft(Q=>Gs(-1,Q),["prevent"])),onMouseup:m[6]||(m[6]=Q=>gr(Q)),onMouseleave:m[7]||(m[7]=Q=>gr(Q)),onTouchstart:m[8]||(m[8]=Ft(Q=>Gs(-1,Q),["prevent"])),onTouchend:m[9]||(m[9]=Q=>gr(Q)),onTouchcancel:m[10]||(m[10]=Q=>gr(Q)),class:"absolute left-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"vnements prcdents  cliquez pour dfiler"},"  ",544),[[yf,zs.value]]),nt(h("button",{onClick:m[11]||(m[11]=Ft(Q=>Ho(1,Q),["prevent"])),onMousedown:m[12]||(m[12]=Ft(Q=>Gs(1,Q),["prevent"])),onMouseup:m[13]||(m[13]=Q=>gr(Q)),onMouseleave:m[14]||(m[14]=Q=>gr(Q)),onTouchstart:m[15]||(m[15]=Ft(Q=>Gs(1,Q),["prevent"])),onTouchend:m[16]||(m[16]=Q=>gr(Q)),onTouchcancel:m[17]||(m[17]=Q=>gr(Q)),class:"absolute right-2 bottom-2 w-9 h-9 rounded-full border border-white/30 bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-[85] backdrop-blur-sm",title:"vnements suivants  cliquez pour dfiler"},"  ",544),[[yf,bc.value]])])],512),nt(h("div",{ref_key:"gridboardRef",ref:kn,class:"gridboard overflow-x-auto bg-gradient-to-br from-blue-900/50 via-purple-900/50 to-indigo-900/50"},[Se.value===1?(L(),F("div",h6,[M.value.position?(L(),F("div",{key:0,class:"fixed z-[400]",style:ys({left:M.value.position.x+"px",top:M.value.position.y+"px"})},[h("div",{id:"coachmark-add",class:xt(["coachmark pointer-events-auto max-w-sm bg-gray-900 border border-purple-500/40 rounded-xl shadow-2xl p-3 text-white relative",{"coachmark-right":M.value.side==="right","coachmark-left":M.value.side==="left"}])},[m[83]||(m[83]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Ajoutez votre nom",-1)),m[84]||(m[84]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},'Cliquez sur "Ajouter un joueur" pour vous inscrire',-1)),h("div",f6,[m[82]||(m[82]=h("span",{class:"text-purple-300 text-base md:text-sm"},"tape 1/4",-1)),h("button",{onClick:m[18]||(m[18]=Q=>ra(0)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant >")])],2)],4)):ve("",!0)])):ve("",!0),Se.value===2&&U.value&&q.value?(L(),F("div",p6,[z.value.position?(L(),F("div",{key:0,class:"fixed z-[400]",style:ys({position:"absolute",left:z.value.position.x+"px",top:z.value.position.y+"px"})},[h("div",m6,[m[86]||(m[86]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Indiquez vos disponibilits",-1)),m[87]||(m[87]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},"Cliquez cette case pour alterner Oui / Non / Vide",-1)),h("div",g6,[m[85]||(m[85]=h("span",{class:"text-pink-300 text-base md:text-sm"},"tape 2/4",-1)),h("button",{onClick:m[19]||(m[19]=Q=>ra(1)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant")])])],4)):ve("",!0)])):ve("",!0),Se.value===3&&U.value?(L(),F("div",v6,[fe.value.position?(L(),F("div",{key:0,class:"fixed z-[400]",style:ys({position:"absolute",left:fe.value.position.x+"px",top:fe.value.position.y+"px"})},[h("div",y6,[m[89]||(m[89]=h("div",{class:"text-lg md:text-base font-semibold mb-1"},"Ouvrez votre fiche",-1)),m[90]||(m[90]=h("div",{class:"text-base md:text-sm text-gray-300 mb-2"},"Cliquez sur votre nom pour voir les dtails et la protection",-1)),h("div",_6,[m[88]||(m[88]=h("span",{class:"text-yellow-300 text-base md:text-sm"},"tape 3/4",-1)),h("button",{onClick:m[20]||(m[20]=Q=>ra(2)),class:"text-base md:text-sm text-white/80 hover:text-white"},"Suivant")])])],4)):ve("",!0)])):ve("",!0),h("table",b6,[h("colgroup",null,[m[91]||(m[91]=h("col",{class:"col-left"},null,-1)),(L(!0),F(dt,null,wr(Dn.value,(Q,Vn)=>(L(),F("col",{key:"c"+Vn,class:"col-event"}))),128)),m[92]||(m[92]=h("col",{class:"col-right"},null,-1))]),m[96]||(m[96]=h("thead",{class:"hidden"},null,-1)),h("tbody",null,[(L(!0),F(dt,null,wr(Gn.value,Q=>{var Vn;return L(),F("tr",{key:Q.id,class:xt(["border-b border-white/10 hover:bg-white/5 transition-all duration-200",{"highlighted-player":Q.id===P.value,"preferred-player":Js.value.has(Q.id)}]),"data-player-id":Q.id},[h("td",I6,[h("div",E6,[Js.value.has(Q.id)?(L(),F("span",T6,"  ")):Qi(Q.id)?(L(),F("span",x6,"  ")):ve("",!0),h("span",{onClick:sr=>hn(Q),class:xt(["player-name hover:border-b-2 hover:border-dashed hover:border-purple-400 cursor-pointer transition-colors duration-200 text-[22px] md:text-2xl leading-tight block truncate max-w-full flex-1 min-w-0",{"inline-block rounded px-1 ring-2 ring-yellow-400 animate-pulse":Se.value===3&&Q.id===(U.value||((Vn=Gn.value[0])==null?void 0:Vn.id))}]),title:"Cliquez pour voir les dtails : "+Q.name},ce(Q.name),11,A6)])]),(L(!0),F(dt,null,wr(Dn.value,sr=>{var sv,iv,ov;return L(),F("td",{key:sr.id,"data-event-id":sr.id,class:xt(["p-0",sr.archived?"archived-col":"",{"relative ring-2 ring-pink-400 rounded-md animate-pulse":Se.value===2&&Q.id===(U.value||((sv=Gn.value[0])==null?void 0:sv.id))&&sr.id===(q.value||((iv=Dn.value[0])==null?void 0:iv.id))}])},[ct(e0,{"player-name":Q.name,"event-id":sr.id,"is-available":rr(Q.name,sr.id),"is-selected":Ac(Q.name,sr.id),"chance-percent":((ov=Sl.value[Q.name])==null?void 0:ov[sr.id])??null,"show-selected-chance":no(sr.id),disabled:sr.archived===!0,onToggle:na},null,8,["player-name","event-id","is-available","is-selected","chance-percent","show-selected-chance","disabled"])],10,S6)}),128)),m[93]||(m[93]=h("td",{class:"p-3 md:p-4"},null,-1))],10,w6)}),128)),h("tr",P6,[h("td",R6,[h("div",C6,[h("button",{onClick:m[21]||(m[21]=Q=>T.value=!0),class:"w-full md:w-auto flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 text-sm md:text-base font-medium",title:"Ajouter un nouveau joueur","data-onboarding":"add-player"},m[94]||(m[94]=[h("span",{class:"text-lg"},"",-1),h("span",{class:"hidden sm:inline"},"Ajouter un joueur",-1),h("span",{class:"sm:hidden"},"Joueur",-1)]))])]),(L(!0),F(dt,null,wr(Dn.value,Q=>(L(),F("td",{key:"add-row-"+Q.id,"data-event-id":Q.id,class:xt(["p-3 md:p-5",Q.archived?"archived-col":""])},null,10,k6))),128)),m[95]||(m[95]=h("td",{class:"p-3 md:p-4"},null,-1))])])])],512),[[yf,!tr.value]])])]),tr.value?(L(),F("div",D6,[h("div",N6,[m[97]||(m[97]=h("div",{class:"w-20 h-20 rounded-full bg-gradient-to-br from-pink-500 to-purple-600 animate-pulse mx-auto mb-6 flex items-center justify-center shadow-2xl"},[h("span",{class:"text-3xl"},"")],-1)),h("p",V6,ce(Rr.value)+"",1),h("div",O6,[h("div",{class:"h-full bg-gradient-to-r from-pink-500 to-purple-600 transition-all duration-300",style:ys({width:Pr.value+"%"})},null,4)]),h("p",M6,ce(Pr.value)+"%",1)])])):ve("",!0),tr.value?ve("",!0):(L(),Sd(E4,{key:1,"season-id":o.value,"season-slug":Xr(s),"players-count":et.value.length,"events-count":qe.value.length,"onboarding-done":((N=a.value)==null?void 0:N.onboardingCreatorDone)===!0,onCreateEvent:kr,onAddPlayer:m[22]||(m[22]=()=>{T.value=!0}),onCopyLink:us,onDismissed:bl},null,8,["season-id","season-slug","players-count","events-count","onboarding-done"])),ve("",!0),Fe.value?(L(),F("div",L6,[h("div",F6,[m[98]||(m[98]=h("span",{class:"text-xl"},"",-1)),h("span",null,ce(pt.value),1)])])):ve("",!0),yr.value?(L(),F("div",$6,[h("div",U6,[m[99]||(m[99]=h("span",{class:"text-xl"},"",-1)),h("span",null,ce(Ji.value),1)])])):ve("",!0),zr.value?(L(),F("div",j6,[h("div",B6,[m[105]||(m[105]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Nouvel vnement",-1)),h("div",q6,[m[100]||(m[100]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),nt(h("input",{"onUpdate:modelValue":m[23]||(m[23]=Q=>br.value=Q),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Titre de l'vnement"},null,512),[[Dt,br.value]])]),h("div",z6,[m[101]||(m[101]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),nt(h("input",{"onUpdate:modelValue":m[24]||(m[24]=Q=>Ws.value=Q),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white"},null,512),[[Dt,Ws.value]])]),h("div",K6,[m[102]||(m[102]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),nt(h("textarea",{"onUpdate:modelValue":m[25]||(m[25]=Q=>Qs.value=Q),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'vnement (optionnel)"},null,512),[[Dt,Qs.value]])]),h("div",G6,[nt(h("input",{id:"new-archived",type:"checkbox","onUpdate:modelValue":m[26]||(m[26]=Q=>ta.value=Q),class:"w-4 h-4"},null,512),[[yi,ta.value]]),m[103]||(m[103]=h("label",{for:"new-archived",class:"text-sm font-medium text-gray-300"},"Crer comme archiv",-1))]),h("div",H6,[m[104]||(m[104]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs  slectionner",-1)),nt(h("input",{"onUpdate:modelValue":m[27]||(m[27]=Q=>Yi.value=Q),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",placeholder:"6"},null,512),[[Dt,Yi.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:Xi,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:tf,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Crer ")])])])):ve("",!0),T.value?(L(),F("div",W6,[h("div",Q6,[m[107]||(m[107]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Nouveau joueur",-1)),h("div",J6,[m[106]||(m[106]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nom",-1)),nt(h("input",{"onUpdate:modelValue":m[28]||(m[28]=Q=>A.value=Q),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nom du joueur"},null,512),[[Dt,A.value]])]),h("div",Y6,[h("button",{onClick:m[29]||(m[29]=Q=>T.value=!1),class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:Pt,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ajouter ")])])])):ve("",!0),l.value?(L(),F("div",X6,[h("div",Z6,[m[108]||(m[108]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">tes-vous sr de vouloir supprimer cet vnement ?</p></div>',1)),h("div",eU,[h("button",{onClick:Zo,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:m[30]||(m[30]=()=>Xo()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"}," Supprimer ")])])])):ve("",!0),ro.value?(L(),F("div",tU,[h("div",nU,[m[109]||(m[109]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">tes-vous sr de vouloir supprimer ce joueur ?</p></div>',1)),h("div",rU,[h("button",{onClick:kl,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{onClick:m[31]||(m[31]=()=>Cc()),class:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300"},"Supprimer")])])])):ve("",!0),me.value?(L(),F("div",sU,[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},[m[110]||(m[110]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Confirmation</h2><p class="text-gray-300">Attention, toute la slection sera refaite en fonction des disponibilits actuelles.</p></div><p class="mb-6 text-sm text-yellow-400 bg-yellow-900/20 p-3 rounded-lg border border-yellow-500/20">  Pensez  prvenir les gens du changement ! </p>',2)),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:oa,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{onClick:kc,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"},"Confirmer")])])])):ve("",!0),S.value?(L(),F("div",{key:10,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-end md:items-center justify-center z-[80] p-0 md:p-4",onClick:b},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[92vh] flex flex-col",onClick:m[42]||(m[42]=Ft(()=>{},["stop"]))},[h("div",iU,[h("button",{onClick:b,title:"Fermer",class:"absolute right-3 top-3 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10"},""),m[111]||(m[111]=h("div",{class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"},[h("span",{class:"text-2xl md:text-3xl"},"")],-1)),h("h2",oU,ce((J=O.value)==null?void 0:J.title),1),h("p",aU,ce(Cl((ie=O.value)==null?void 0:ie.date)),1)]),h("div",lU,[(te=O.value)!=null&&te.description?(L(),F("div",uU,[h("p",cU,ce(O.value.description),1)])):ve("",!0),h("div",dU,[h("div",hU,[h("div",fU,ce(to((ge=O.value)==null?void 0:ge.id)),1),m[112]||(m[112]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Disponibles",-1))]),h("div",pU,[h("div",mU,ce(Xs((Ve=O.value)==null?void 0:Ve.id)),1),m[113]||(m[113]=h("div",{class:"text-xs md:text-sm text-gray-300"},"Slectionns",-1))]),h("div",gU,[h("div",vU,ce(Math.max((((We=O.value)==null?void 0:We.playerCount)||6)-Xs((tt=O.value)==null?void 0:tt.id),0)),1),m[114]||(m[114]=h("div",{class:"text-xs md:text-sm text-yellow-300"},"manquants",-1))])]),O.value?(L(),F("div",yU,[h("div",_U,[Pl.value?(L(),F("div",{key:0,class:xt(["flex items-center gap-2 px-2 py-1 rounded-md border text-[11px] md:text-xs max-w-[70%] truncate",((mt=xc.value)==null?void 0:mt.type)==="incomplete"?"bg-yellow-500/10 border-yellow-500/30 text-yellow-200":"bg-orange-500/10 border-orange-500/30 text-orange-200"]),title:Lt.value},[m[115]||(m[115]=h("span",null,"",-1)),h("span",wU,ce(Lt.value),1)],10,bU)):ve("",!0),nt(h("select",{"onUpdate:modelValue":m[32]||(m[32]=Q=>cs.value=Q),class:"ml-auto bg-gray-800 text-white rounded-md px-3 py-2 border border-white/10 focus:outline-none text-sm",title:"Filtrer les joueurs par statut"},m[116]||(m[116]=[Jn('<option value="selected">Slectionns</option><option value="available">Disponibles</option><option value="unavailable">Non Disponibles</option><option value="unknown">Pas de rponse</option><option value="all">Tous</option>',5)]),512),[[IS,cs.value]])]),h("div",IU,[(L(!0),F(dt,null,wr(Zi.value,Q=>{var Vn,sr;return L(),F("div",{key:Q.id,class:"flex items-center justify-between px-2 py-1.5 rounded-md hover:bg-gray-800/40 transition-colors"},[h("div",EU,[Js.value.has(Q.id)?(L(),F("span",TU,"  ")):Qi(Q.id)?(L(),F("span",xU,"  ")):ve("",!0),h("span",{class:"text-white text-sm md:text-base block truncate max-w-full flex-1 min-w-0",title:Q.name},ce(Q.name),9,AU)]),h("div",SU,[ct(e0,{"player-name":Q.name,"event-id":O.value.id,"is-available":lf(O.value.id)[Q.name],"is-selected":Ie(Q.name,O.value.id),"chance-percent":((Vn=Sl.value[Q.name])==null?void 0:Vn[O.value.id])??null,"show-selected-chance":no(O.value.id),disabled:((sr=O.value)==null?void 0:sr.archived)===!0,compact:!0,onToggle:W},null,8,["player-name","event-id","is-available","is-selected","chance-percent","show-selected-chance","disabled"])])])}),128))])])):ve("",!0),h("div",PU,[h("button",{onClick:dn,class:"px-5 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center gap-2"},m[117]||(m[117]=[h("span",null,"",-1),h("span",null,"Modifier",-1)])),h("button",{onClick:m[33]||(m[33]=Q=>Fc(O.value)),disabled:(Wt=O.value)==null?void 0:Wt.archived,class:"px-5 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-lg hover:from-amber-600 hover:to-orange-700 transition-all duration-300 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600",title:(rn=O.value)!=null&&rn.archived?"Impossible d'annoncer un vnement archiv":"Annoncer l'vnement aux joueurs (email, copie, WhatsApp)"},m[118]||(m[118]=[h("span",null,"",-1),h("span",null,"Annoncer",-1)]),8,RU),h("button",{onClick:lt,class:"px-5 py-3 bg-gradient-to-r from-indigo-500 to-blue-600 text-white rounded-lg hover:from-indigo-600 hover:to-blue-700 transition-all duration-300 flex items-center gap-2",title:(ut=O.value)!=null&&ut.archived?"Dsarchiver cet vnement":"Archiver cet vnement"},[h("span",null,ce((Nn=O.value)!=null&&Nn.archived?"":""),1),h("span",null,ce((dr=O.value)!=null&&dr.archived?"Dsarchiver":"Archiver"),1)],8,CU),h("button",{onClick:m[34]||(m[34]=Q=>Vl(O.value)),class:"px-5 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex items-center gap-2",title:"Grer la slection"},m[119]||(m[119]=[h("span",null,"",-1),h("span",null,"Slectionner",-1)])),h("button",{onClick:m[35]||(m[35]=Q=>{var Vn;return _r((Vn=O.value)==null?void 0:Vn.id)}),class:"px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center gap-2"},m[120]||(m[120]=[h("span",null,"",-1),h("span",null,"Supprimer",-1)])),h("button",{onClick:K,class:"px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"},"Fermer")]),ue.value?(L(),F("div",kU,[h("button",{onClick:m[36]||(m[36]=Q=>{dn(),ue.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10"}," Modifier"),h("button",{onClick:m[37]||(m[37]=Q=>{Fc(O.value),ue.value=!1}),disabled:(Vr=O.value)==null?void 0:Vr.archived,class:"w-full px-4 py-3 rounded-lg bg-amber-600/20 text-amber-200 border border-amber-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-500 disabled:to-gray-600",title:(ni=O.value)!=null&&ni.archived?"Impossible d'annoncer un vnement archiv":"Annoncer l'vnement aux joueurs (email, copie, WhatsApp)"},m[121]||(m[121]=[h("span",null,"",-1),h("span",null,"Annoncer",-1)]),8,DU),h("button",{onClick:m[38]||(m[38]=Q=>{lt(),ue.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-indigo-600/20 text-indigo-200 border border-indigo-500/30"},ce((Xg=O.value)!=null&&Xg.archived?" Dsarchiver":" Archiver"),1),h("button",{onClick:m[39]||(m[39]=Q=>{var Vn;_r((Vn=O.value)==null?void 0:Vn.id),ue.value=!1}),class:"w-full px-4 py-3 rounded-lg bg-red-600/20 text-red-200 border border-red-500/30"}," Supprimer")])):ve("",!0)]),h("div",NU,[h("button",{onClick:m[40]||(m[40]=Q=>Vl(O.value)),class:"h-12 px-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 flex-[1.4]"}," Slectionner"),h("button",{onClick:K,class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex-1"},"Fermer"),h("button",{onClick:m[41]||(m[41]=Q=>ue.value=!ue.value),class:"h-12 px-4 bg-gray-700 text-white rounded-lg flex items-center justify-center w-12"},"")])])])):ve("",!0),ct($g,{show:be.value,player:ye.value,seasonId:o.value,onClose:m[43]||(m[43]=Q=>be.value=!1),onVerified:Et},null,8,["show","player","seasonId"]),d.value?(L(),F("div",VU,[h("div",OU,[m[127]||(m[127]=h("h2",{class:"text-2xl font-bold mb-6 text-white text-center"}," Modifier l'vnement",-1)),h("div",MU,[m[122]||(m[122]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Titre",-1)),nt(h("input",{"onUpdate:modelValue":m[44]||(m[44]=Q=>f.value=Q),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",onKeydown:[Mn(qr,["esc"]),Mn(ea,["enter"])],ref:"editTitleInput"},null,544),[[Dt,f.value]])]),h("div",LU,[m[123]||(m[123]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Date",-1)),nt(h("input",{"onUpdate:modelValue":m[45]||(m[45]=Q=>g.value=Q),type:"date",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:[Mn(qr,["esc"]),Mn(ea,["enter"])]},null,544),[[Dt,g.value]])]),h("div",FU,[m[124]||(m[124]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),nt(h("textarea",{"onUpdate:modelValue":m[46]||(m[46]=Q=>oe.value=Q),class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",rows:"3",placeholder:"Description de l'vnement (optionnel)",onKeydown:Mn(qr,["esc"])},null,544),[[Dt,oe.value]])]),h("div",$U,[nt(h("input",{id:"edit-archived",type:"checkbox","onUpdate:modelValue":m[47]||(m[47]=Q=>Z.value=Q),class:"w-4 h-4"},null,512),[[yi,Z.value]]),m[125]||(m[125]=h("label",{for:"edit-archived",class:"text-sm font-medium text-gray-300"},"Archiver cet vnement",-1))]),h("div",UU,[m[126]||(m[126]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nombre de joueurs  slectionner",-1)),nt(h("input",{"onUpdate:modelValue":m[48]||(m[48]=Q=>y.value=Q),type:"number",min:"1",max:"20",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white",onKeydown:Mn(qr,["esc"])},null,544),[[Dt,y.value]])]),h("div",{class:"flex justify-end space-x-3"},[h("button",{onClick:qr,class:"px-6 py-3 text-gray-300 hover:text-white transition-colors"}," Annuler "),h("button",{onClick:ea,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Sauvegarder ")])])])):ve("",!0),ct(oT,{show:V.value,message:Dc(),error:R.value,"session-info":ei(),onSubmit:Nc,onCancel:Vc},null,8,["show","message","error","session-info"]),It.value?(L(),F("div",jU,[h("div",BU,[m[129]||(m[129]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Vrification requise</h2><p class="text-lg text-gray-300">Suppression de joueur protg</p><p class="text-sm text-gray-400 mt-2">Ce joueur est protg par mot de passe</p></div>',1)),h("div",qU,[h("div",zU,[h("div",null,[m[128]||(m[128]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),nt(h("input",{"onUpdate:modelValue":m[49]||(m[49]=Q=>j.value=Q),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:m[50]||(m[50]=Mn(Q=>Nl(j.value),["enter"])),ref_key:"playerPasswordInputRef",ref:Ke},null,544),[[Dt,j.value]])])]),h("button",{onClick:m[51]||(m[51]=Q=>Nl(j.value)),disabled:!j.value||ne.value,class:"w-full mt-4 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[ne.value?(L(),F("span",GU,"")):(L(),F("span",HU,"")),h("span",null,ce(ne.value?"Vrification...":"Vrifier et supprimer"),1)],8,KU)]),h("div",WU,[h("button",{onClick:m[52]||(m[52]=Q=>se.value=!0),class:"text-sm text-red-400 hover:text-red-300 transition-colors underline"}," Mot de passe oubli ? ")]),Y.value?(L(),F("div",QU,[h("div",JU,ce(Y.value),1)])):ve("",!0),h("div",{class:"flex justify-center"},[h("button",{onClick:Oc,class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Annuler ")])])])):ve("",!0),Be.value?(L(),F("div",YU,[h("div",XU,[m[132]||(m[132]=Jn('<div class="text-center p-6 pb-4 border-b border-white/10"><div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-1">Vrification requise</h2><p class="text-base text-gray-300">Modification de disponibilit</p><p class="text-sm text-gray-400 mt-1">Ce joueur est protg par mot de passe</p></div>',1)),h("div",ZU,[h("div",e5,[h("div",null,[m[130]||(m[130]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Mot de passe du joueur",-1)),nt(h("input",{"onUpdate:modelValue":m[53]||(m[53]=Q=>ee.value=Q),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Entrez le mot de passe",onKeydown:m[54]||(m[54]=Mn(Q=>so(ee.value),["enter"])),ref_key:"availabilityPasswordInputRef",ref:Xe},null,544),[[Dt,ee.value]])])]),h("div",t5,[h("button",{onClick:m[55]||(m[55]=Q=>ht.value=!0),class:"text-sm text-blue-400 hover:text-blue-300 transition-colors underline"}," Mot de passe oubli ? ")]),re.value?(L(),F("div",n5,[h("div",r5,ce(re.value),1)])):ve("",!0)]),h("div",s5,[h("button",{onClick:Hn,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300 flex-1 text-sm md:text-base whitespace-nowrap"}," Annuler "),h("button",{onClick:m[56]||(m[56]=Q=>so(ee.value)),disabled:!ee.value||je.value,class:"h-12 px-3 md:px-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 flex-1 text-sm md:text-base whitespace-nowrap"},[je.value?(L(),F("span",o5,"")):(L(),F("span",a5,"")),h("span",null,[Nt(ce(je.value?"Vrification...":"Vrifier"),1),m[131]||(m[131]=h("span",{class:"hidden sm:inline"}," et modifier",-1))])],8,i5)])])])):ve("",!0),ht.value?(L(),F("div",{key:14,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:m[59]||(m[59]=Q=>ht.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:m[58]||(m[58]=Ft(()=>{},["stop"]))},[m[134]||(m[134]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oubli</h2><p class="text-lg text-gray-300">Modification de disponibilit</p></div>',1)),h("div",l5,[m[133]||(m[133]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de rinitialisation sera envoy  l'adresse associe  ce joueur. ",-1)),h("button",{onClick:Mc,disabled:D.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[D.value?(L(),F("span",c5,"")):(L(),F("span",d5,"")),h("span",null,ce(D.value?"Envoi...":"Envoyer l'email"),1)],8,u5)]),$.value?(L(),F("div",h5,[h("div",f5,ce($.value),1)])):ve("",!0),X.value?(L(),F("div",p5,[h("div",m5,ce(X.value),1)])):ve("",!0),h("div",g5,[h("button",{onClick:m[57]||(m[57]=Q=>ht.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ve("",!0),se.value?(L(),F("div",{key:15,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[120] p-4",onClick:m[62]||(m[62]=Q=>se.value=!1)},[h("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md",onClick:m[61]||(m[61]=Ft(()=>{},["stop"]))},[m[136]||(m[136]=Jn('<div class="text-center mb-6"><div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-2xl"></span></div><h2 class="text-2xl font-bold text-white mb-2">Mot de passe oubli</h2><p class="text-lg text-gray-300">Suppression de joueur protg</p></div>',1)),h("div",v5,[m[135]||(m[135]=h("p",{class:"text-sm text-gray-300 mb-4"}," Un email de rinitialisation sera envoy  l'adresse associe  ce joueur. ",-1)),h("button",{onClick:Lc,disabled:ke.value,class:"w-full px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[ke.value?(L(),F("span",_5,"")):(L(),F("span",b5,"")),h("span",null,ce(ke.value?"Envoi...":"Envoyer l'email"),1)],8,y5)]),$e.value?(L(),F("div",w5,[h("div",I5,ce($e.value),1)])):ve("",!0),E.value?(L(),F("div",E5,[h("div",T5,ce(E.value),1)])):ve("",!0),h("div",x5,[h("button",{onClick:m[60]||(m[60]=Q=>se.value=!1),class:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-300"}," Fermer ")])])])):ve("",!0),ct(SF,{ref_key:"playerModalRef",ref:C,show:I.value,player:w.value,stats:aa(w.value),seasonId:o.value,"onboarding-step":Se.value,"onboarding-player-id":U.value,onClose:gn,onUpdate:ti,onDelete:Dl,onRefresh:cr,onAdvanceOnboarding:m[63]||(m[63]=Q=>{try{typeof Se.value<"u"&&(Se.value.value=Q)}catch{}})},null,8,["show","player","stats","seasonId","onboarding-step","onboarding-player-id"]),ct(c4,{ref_key:"selectionModalRef",ref:Le,show:Pe.value,event:De.value,"current-selection":at.value[(Zg=De.value)==null?void 0:Zg.id]||[],"available-count":to((ev=De.value)==null?void 0:ev.id),"selected-count":Xs((tv=De.value)==null?void 0:tv.id),"player-availability":lf((nv=De.value)==null?void 0:nv.id),"season-id":o.value,"season-slug":Xr(s),players:nn.value,onClose:Qg,onSelection:ix,onPerfect:ox,onSendNotifications:Wg,onUpdateSelection:ax},null,8,["show","event","current-selection","available-count","selected-count","player-availability","season-id","season-slug","players"]),ct(AT,{show:He.value,event:Ze.value,"season-id":o.value,"season-slug":Xr(s),players:nn.value,sending:af.value,"availability-by-player":lf((rv=Ze.value)==null?void 0:rv.id),onClose:sx,onSendNotifications:Wg},null,8,["show","event","season-id","season-slug","players","sending","availability-by-player"]),ct(aT,{show:_n.value,onClose:m[64]||(m[64]=Q=>_n.value=!1)},null,8,["show"]),ct(L$,{show:Mt.value,"season-id":o.value,onClose:Cn,onManagePlayer:Ki,onChangePassword:_l,onLogoutDevice:vc,onDeleteAccount:yc},null,8,["show","season-id"]),ct(ST,{show:mr.value,player:cn.value,"season-id":o.value,onClose:m[65]||(m[65]=Q=>mr.value=!1),onSuccess:m[66]||(m[66]=()=>{mr.value=!1,Mt.value=!0})},null,8,["show","player","season-id"]),ct(H$,{show:Ur.value,onClose:m[67]||(m[67]=Q=>Ur.value=!1),onSuccess:m[68]||(m[68]=()=>{Ur.value=!1,Mt.value=!0})},null,8,["show"]),Yt.value?(L(),F("div",A5,[h("div",S5,[m[137]||(m[137]=h("h3",{class:"text-xl font-bold text-white mb-4 text-center"},"Voulez-vous annoncer cet vnement ?",-1)),m[138]||(m[138]=h("p",{class:"text-gray-300 text-center mb-6"},"Envoyer des notifications aux joueurs pour qu'ils indiquent leur disponibilit",-1)),h("div",P5,[h("button",{onClick:m[69]||(m[69]=Q=>Fc(Bt.value)),class:"flex-1 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300"},"  Oui "),h("button",{onClick:Hg,class:"flex-1 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all duration-300"}," Plus tard ")])])])):ve("",!0)],64)}}},R5={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},C5={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md"},k5={key:0,class:"text-center py-8"},D5={key:1,class:"text-center py-8"},N5={class:"text-gray-300 mb-6"},V5={key:2,class:"space-y-6"},O5={class:"text-center"},M5={class:"text-gray-300"},L5={class:"font-semibold text-white"},F5={class:"space-y-4"},$5=["disabled"],U5={key:0,class:"animate-spin"},j5={key:1},B5={key:0,class:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg"},q5={class:"text-red-300 text-sm"},z5={key:1,class:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg"},K5={class:"text-green-300 text-sm"},G5={__name:"PasswordReset",setup(n){const e=el(),t=Za(),r=k(!0),s=k(""),i=k(""),o=k(""),a=k(""),l=k(""),c=k(!1),d=k(""),f=k(""),g=Oe(()=>a.value&&l.value&&a.value===l.value&&a.value.length>=6);Xn(async()=>{try{const{oobCode:A}=e.query;if(le.debug("Token reu (masqu)"),!A){s.value="Lien de rinitialisation incomplet",r.value=!1;return}o.value=A,i.value="patrice.lamarque+ron@gmail.com",r.value=!1}catch(A){le.error("Erreur lors de la vrification du lien",A),s.value="Erreur lors de la vrification du lien",r.value=!1}});async function y(){if(g.value){c.value=!0,d.value="",f.value="";try{le.debug("Dbut rinitialisation avec token (masqu)"),await aN(gt,o.value,a.value),le.info("Mot de passe Firebase Auth mis  jour"),le.info("Rinitialisation termine avec Firebase Auth"),f.value="Mot de passe rinitialis avec succs ! Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.",setTimeout(()=>{T()},3e3)}catch(A){le.error("Erreur lors de la rinitialisation",A),A.code==="auth/weak-password"?d.value="Le mot de passe doit contenir au moins 6 caractres":A.code==="auth/invalid-action-code"?d.value="Lien de rinitialisation invalide ou expir":d.value="Erreur lors de la rinitialisation. Veuillez ressayer."}finally{c.value=!1}}}function T(){t.push("/seasons")}return(A,P)=>(L(),F("div",R5,[h("div",C5,[P[8]||(P[8]=Jn('<div class="text-center mb-6"><div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full mx-auto mb-4 flex items-center justify-center"><span class="text-3xl"></span></div><h1 class="text-3xl font-bold text-white mb-2">Rinitialisation</h1><p class="text-lg text-gray-300">Nouveau mot de passe</p></div>',1)),r.value?(L(),F("div",k5,P[2]||(P[2]=[h("div",{class:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),h("p",{class:"text-gray-300"},"Vrification du lien...",-1)]))):s.value?(L(),F("div",D5,[P[3]||(P[3]=h("div",{class:"w-16 h-16 bg-gradient-to-br from-red-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center"},[h("span",{class:"text-2xl"},"")],-1)),P[4]||(P[4]=h("h2",{class:"text-xl font-bold text-white mb-2"},"Lien invalide",-1)),h("p",N5,ce(s.value),1),h("button",{onClick:T,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300"}," Retour  l'accueil ")])):i.value?(L(),F("div",V5,[h("div",O5,[h("p",M5,[P[5]||(P[5]=Nt("Email : ")),h("span",L5,ce(i.value),1)])]),h("div",F5,[h("div",null,[P[6]||(P[6]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Nouveau mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":P[0]||(P[0]=U=>a.value=U),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Nouveau mot de passe",onKeydown:Mn(y,["enter"])},null,544),[[Dt,a.value]])]),h("div",null,[P[7]||(P[7]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Confirmer le mot de passe",-1)),nt(h("input",{"onUpdate:modelValue":P[1]||(P[1]=U=>l.value=U),type:"password",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Confirmer le mot de passe",onKeydown:Mn(y,["enter"])},null,544),[[Dt,l.value]])])]),h("button",{onClick:y,disabled:!g.value||c.value,class:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[c.value?(L(),F("span",U5,"")):(L(),F("span",j5,"")),h("span",null,ce(c.value?"Rinitialisation...":"Rinitialiser le mot de passe"),1)],8,$5),d.value?(L(),F("div",B5,[h("div",q5,ce(d.value),1)])):ve("",!0),f.value?(L(),F("div",z5,[h("div",K5,ce(f.value),1)])):ve("",!0)])):ve("",!0)])]))}},H5={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4"},W5={class:"bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center"},Q5={class:"text-3xl"},J5={class:"text-2xl font-bold text-white mb-2"},Y5={class:"text-gray-300 mb-6"},X5={__name:"MagicLink",setup(n){const e=el(),t=Za(),r=k("loading"),s=k("Traitement en cours..."),i=k("Merci de patienter pendant la validation du lien."),o=Oe(()=>r.value==="loading"?"":r.value==="ok"?"":"");function a(){const l=e.query.slug;l?t.push(`/season/${l}`):t.push("/seasons")}return Xn(async()=>{var l;try{lT("firebase");const c=String(e.query.sid||""),d=String(e.query.pid||"");let f=String(e.query.eid||"");const g=String(e.query.t||""),y=String(e.query.a||""),T=String(e.query.slug||"");if(!g||!y){r.value="error",s.value="Lien invalide",i.value="Paramtres manquants.";return}if(y==="account_email_update"){const z=await fT({token:g});if(!z.valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expir.";return}try{await fN(gt.currentUser,z.data.newEmail),await pT({token:g}),r.value="ok",s.value="Email mis  jour",i.value="Votre adresse email a t mise  jour avec succs."}catch{r.value="error",s.value="Action impossible",i.value="Veuillez vous reconnecter puis ressayer."}return}if(y==="verify_email"&&(f="protection"),!(await dT({seasonId:c,playerId:d,eventId:f,token:g,action:y})).valid){r.value="error",s.value="Lien invalide",i.value="Le lien est invalide ou expir.";return}if(y==="verify_email"){await yT({playerId:d,seasonId:c});try{await ET({playerId:d,seasonId:c})}catch{}await $p({seasonId:c,playerId:d,eventId:"protection",action:y}),r.value="ok",s.value="Email vrifi",i.value="Merci ! Vous pouvez maintenant dfinir votre mot de passe.",setTimeout(T?()=>t.push(`/season/${T}?player=${encodeURIComponent(d)}&verified=1`):()=>t.push("/seasons"),800);return}const P=xe(ae,"seasons",c,"players",d),U=await Gt(P),q=U.exists()&&U.data().name||"";if(!q){r.value="error",s.value="Lien invalide",i.value="Joueur introuvable.";return}if(await FO({seasonId:c,playerName:q,eventId:f,value:y==="yes"}),y==="no")try{const z=xe(ae,"seasons",c,"selections",f),fe=await Gt(z);if(fe.exists()){const me=Array.isArray((l=fe.data())==null?void 0:l.players)?fe.data().players:[],x=me.filter(I=>I!==q);x.length!==me.length&&await setDoc(z,{players:x},{merge:!0})}}catch{}await $p({seasonId:c,playerId:d,eventId:f,action:y}),r.value="ok",s.value="Merci !",i.value=y==="yes"?"Votre disponibilit a t enregistre: Disponible.":"Votre disponibilit a t enregistre: Non disponible. (Si vous tiez slectionn(e), vous avez t retir(e) de la slection.)",setTimeout(T?()=>t.push(`/season/${T}/event/${f}`):()=>t.push("/seasons"),1200)}catch(c){le.error("Magic link error",c),r.value="error",s.value="Erreur",i.value="Impossible de traiter votre lien."}}),(l,c)=>(L(),F("div",H5,[h("div",W5,[h("div",{class:xt(["w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center",r.value==="ok"?"bg-green-500":r.value==="loading"?"bg-blue-500":"bg-red-500"])},[h("span",Q5,ce(o.value),1)],2),h("h1",J5,ce(s.value),1),h("p",Y5,ce(i.value),1),h("button",{onClick:a,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300"}," Ouvrir la saison ")])]))}},Z5={class:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900"},ej={class:"text-center py-12 px-4"},tj={class:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-pink-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"},nj={class:"container mx-auto px-4 pb-16"},rj={class:"max-w-xl mx-auto bg-gradient-to-br from-gray-900 to-gray-800 border border-white/20 p-8 rounded-2xl shadow-2xl"},sj={class:"space-y-5"},ij=["onKeydown"],oj={class:"flex items-center justify-end gap-3 pt-2"},aj=["disabled"],lj={key:0,class:"mt-6 text-sm text-gray-200"},uj={__name:"JoinSeason",setup(n){const e=el(),t=Za(),r=e.params.slug,s=k(""),i=k(""),o=k(""),a=k(!1),l=k("");Xn(async()=>{const f=Mu(Je(ae,"seasons"),Hd("slug","==",r)),g=await wt(f);if(g.empty)l.value="Saison introuvable";else{const y=g.docs[0];s.value=y.id,i.value=y.data().name,document.title=`Rejoindre : ${i.value}`}});function c(){t.push(`/season/${r}`)}async function d(){if(!(!o.value.trim()||!s.value)){a.value=!0,l.value="";try{await uT(o.value.trim(),s.value),l.value="Inscription russie. Vous pouvez maintenant indiquer vos disponibilits.";try{localStorage.setItem(`startPlayerTour:${s.value}`,"1"),localStorage.setItem(`dismissCreatorOnboarding:${s.value}`,"1")}catch{}setTimeout(()=>{c()},600)}catch(f){le.error("Erreur inscription",f),l.value=`Erreur lors de l'inscription: ${(f==null?void 0:f.message)||"Veuillez ressayer"}`}finally{a.value=!1}}}return(f,g)=>(L(),F("div",Z5,[h("div",ej,[h("h1",tj,ce(i.value||"Rejoindre la saison"),1),g[1]||(g[1]=h("p",{class:"text-gray-300"},"Inscrivez-vous pour indiquer vos disponibilits aux vnements",-1))]),h("div",nj,[h("div",rj,[g[3]||(g[3]=h("h2",{class:"text-2xl font-bold text-white mb-6 text-center"},"Je rejoins la saison",-1)),h("div",sj,[h("div",null,[g[2]||(g[2]=h("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Votre nom",-1)),nt(h("input",{"onUpdate:modelValue":g[0]||(g[0]=y=>o.value=y),type:"text",class:"w-full p-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white placeholder-gray-400",placeholder:"Ex: Marie Dupont",onKeydown:Mn(Ft(d,["prevent"]),["enter"])},null,40,ij),[[Dt,o.value]])]),h("div",oj,[h("button",{onClick:c,class:"px-5 py-3 text-gray-300 hover:text-white transition-colors"},"Annuler"),h("button",{disabled:!o.value.trim()||a.value,onClick:d,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300"}," Rejoindre ",8,aj)])]),l.value?(L(),F("div",lj,ce(l.value),1)):ve("",!0)])])]))}};{const n=()=>{};console.debug=n,console.log=n,console.info=n}const cj=[{path:"/",component:_O},{path:"/seasons",component:pM},{path:"/season/:slug",component:c0,props:!0},{path:"/season/:slug/event/:eventId",component:c0,props:!0},{path:"/season/:slug/join",component:uj,props:!0},{path:"/reset-password",component:G5},{path:"/magic",component:X5}],dj=N1({history:l1("/"),routes:cj}),tx=PS(kS);tx.use(dj);tx.mount("#app");L1({immediate:!0,onRegistered(n){window.__swReg=n}});export{Je as $,aE as A,Vo as B,ts as C,ln as D,mB as E,$o as F,tg as G,pB as H,gj as I,xr as J,TD as K,AD as L,pl as M,Bj as N,qj as O,YD as P,Rn as Q,Nj as R,wj as S,Qt as T,oB as U,kh as V,WD as W,JD as X,jj as Y,Tj as Z,Yb as _,Nu as a,hc as a$,_j as a0,xD as a1,LD as a2,fB as a3,Ya as a4,iB as a5,Sj as a6,hB as a7,xe as a8,kj as a9,Cj as aA,Qj as aB,Jj as aC,Dj as aD,OD as aE,tB as aF,nB as aG,GD as aH,Mu as aI,HI as aJ,bj as aK,sB as aL,qi as aM,Zt as aN,uB as aO,hj as aP,zj as aQ,Lj as aR,Mj as aS,Uj as aT,Pj as aU,fl as aV,lB as aW,xj as aX,Hd as aY,hg as aZ,wB as a_,PD as aa,Ej as ab,Aj as ac,dB as ad,$j as ae,Fj as af,Jt as ag,lc as ah,$D as ai,Yj as aj,Gt as ak,Kj as al,Gj as am,wt as an,Hj as ao,Wj as ap,SD as aq,cB as ar,aB as as,Ij as at,Vj as au,Oj as av,Rj as aw,Xj as ax,eB as ay,Zj as az,RD as b,nN as b$,dc as b0,EB as b1,Uu as b2,qo as b3,pi as b4,vB as b5,gi as b6,mi as b7,Os as b8,gd as b9,c2 as bA,zB as bB,rq as bC,D_ as bD,qN as bE,k2 as bF,FB as bG,kB as bH,rN as bI,WB as bJ,ZB as bK,nq as bL,KB as bM,EN as bN,wN as bO,xB as bP,ZD as bQ,sN as bR,QB as bS,XB as bT,tq as bU,f2 as bV,BB as bW,VB as bX,oN as bY,CB as bZ,bN as b_,bB as ba,To as bb,Ca as bc,GV as bd,yB as be,GB as bf,Np as bg,_B as bh,HV as bi,Ng as bj,vi as bk,PB as bl,IN as bm,jE as bn,KV as bo,qE as bp,lN as bq,aN as br,N2 as bs,uN as bt,IB as bu,qB as bv,NB as bw,LB as bx,eO as by,TB as bz,Qa as c,Ig as c0,SB as c1,cN as c2,DB as c3,HB as c4,YB as c5,eq as c6,TN as c7,AB as c8,jB as c9,fN as ca,pN as cb,JB as cc,MB as cd,UB as ce,$B as cf,OB as cg,RB as ch,Uo as d,Ct as e,he as f,hl as g,oc as h,fd as i,Fh as j,ac as k,Mh as l,cg as m,Ja as n,Lh as o,yo as p,QD as q,en as r,Ao as s,Ae as t,pj as u,vR as v,zt as w,gB as x,rt as y,fj as z};
